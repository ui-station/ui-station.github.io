{"pageProps":{"post":{"title":"ì‹¤ì‹œê°„ ë°ì´í„° íŒŒì´í”„ë¼ì¸ êµ¬ì¶•í•˜ê¸°","description":"","date":"2024-05-20 18:45","slug":"2024-05-20-BuildingaReal-TimeDataPipeline","content":"\n\n## ì¹´í”„ì¹´(Kafka), í´ë¼ìŠ¤(Polars), ë¸íƒ€ ë ˆì´í¬(Delta Lake)ë¥¼ í™œìš©í•œ ì‹¤ì‹œê°„ ë¶„ì„\n\në°ì´í„° ì—”ì§€ë‹ˆì–´ë¼ë©´ ì–¸ì  ê°€ëŠ” ì‹¤ì‹œê°„ ë°ì´í„°ì— ëŒ€í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­ì„ ì§ë©´í•´ì•¼ í•  ê²ƒì…ë‹ˆë‹¤. ì´ëŠ” ë¹¨ë¦¬ ì˜¤ê² ë‹¤ëŠ” ê²ƒì´ í™•ì‹¤í•©ë‹ˆë‹¤. ì‹¤ì‹œê°„ ë°ì´í„° ì²˜ë¦¬ëŠ” ê¸°ì—…ì´ ì‹ ì†í•˜ê²Œ ì •ë³´ ê¸°ë°˜ ê²°ì •ì„ ë‚´ë¦´ ìˆ˜ ìˆë„ë¡ í•„ìˆ˜ì ìœ¼ë¡œ ì¤‘ìš”í•´ì§€ê³  ìˆìœ¼ë©°, ì•„íŒŒì¹˜ ì¹´í”„ì¹´ëŠ” í™•ì¥ ê°€ëŠ¥í•˜ê³  ì˜¤ë¥˜ í—ˆìš©ì„± ìˆëŠ” ì‹¤ì‹œê°„ ë°ì´í„° íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•˜ê¸° ìœ„í•œ ì¸ê¸° ìˆëŠ” í”Œë«í¼ìœ¼ë¡œ ë¶€ìƒí–ˆìŠµë‹ˆë‹¤.\n\nì´ ê¸°ì‚¬ì—ì„œëŠ” ì¹´í”„ì¹´, í´ë¼ìŠ¤, ë¸íƒ€ ë ˆì´í¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹¤ì‹œê°„ ë°ì´í„° íŒŒì´í”„ë¼ì¸ì„ ë§Œë“œëŠ” ë°©ë²•ì„ ì‹¤ì œë¡œ ë³´ì—¬ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ê·¸ë¦¬ ì–´ë µì§€ ì•ŠìŠµë‹ˆë‹¤! ìì‹ ë„ ì´ë¥¼ ì‹œë„í•  ìˆ˜ ìˆëŠ” ì½”ë“œëŠ” ì—¬ê¸°ì—ì„œ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìœ ìš©í•˜ë‹¤ê³  ëŠë¼ì‹ ë‹¤ë©´ â­ï¸ì„ ì£¼ì„¸ìš”.\n\nê¸°ìˆ ì ì¸ ê¸°ì‚¬ê°€ ë  ì˜ˆì •ì´ë‹ˆ, ì½”ë“œ ìŠ¤ë‹ˆí«ì´ ë§ì´ í¬í•¨ë  ê²ƒì…ë‹ˆë‹¤.\n\n<div class=\"content-ad\"></div>\n\n# ë”°ë¼ì˜¤ê¸° ì‹œì‘í•˜ê¸° ìœ„í•´ ì„¤ì •í•´ì•¼ í•  ì‚¬í•­\n\nì‹œì‘í•˜ê¸° ìœ„í•´ ëª‡ ê°€ì§€ êµ¬ì„± ìš”ì†Œë¥¼ ì„¤ì •í•´ ë‘ì—ˆìŠµë‹ˆë‹¤:\n\nKafka ë¸Œë¡œì»¤: Docker Composeë¥¼ ì‚¬ìš©í•˜ì—¬ Kafkaì™€ Zookeeper ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í–ˆìŠµë‹ˆë‹¤. docker-compose.yml íŒŒì¼ì—ëŠ” í•„ìš”í•œ ì„œë¹„ìŠ¤ì™€ êµ¬ì„±ì´ ì •ì˜ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ì— ëŒ€í•´ ìì„¸íˆ ë‹¤ë£¨ì§€ëŠ” ì•Šê² ìŠµë‹ˆë‹¤. ì´ íŒŒì¼ì€ ì–´ë””ì—ì„œë“  ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆëŠ” ê¸°ë³¸ì ì¸ docker-compose.ymlì…ë‹ˆë‹¤. ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ íŒ€ì´ Kafka í™˜ê²½ì„ ê´€ë¦¬í•˜ëŠ” ê²ƒìœ¼ë¡œ ê°„ì£¼í•˜ì§€ ì•Šê² ìŠµë‹ˆë‹¤. ë‹¹ì‹ ì´ ë‹´ë‹¹í•˜ê³  ìˆëŠ” í”Œë«í¼ ë˜ëŠ” ë°ë¸Œì˜µìŠ¤ íŒ€ì´ ê·¸ ì—­í• ì„ ë§¡ê³  ìˆì„ ê²ƒì´ë¼ê³  ê°€ì •í•˜ê² ìŠµë‹ˆë‹¤.\n\në°œí–‰ì: Python ìŠ¤í¬ë¦½íŠ¸ì¸ publisher.pyë¥¼ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤. ì´ ìŠ¤í¬ë¦½íŠ¸ëŠ” ì¼ë ¨ì˜ csv íŒŒì¼ì— ì €ì¥ëœ ìƒ˜í”Œ ë°ì´í„°ë¥¼ Kafka ì£¼ì œì— ë°œí–‰í•©ë‹ˆë‹¤.\n\n<div class=\"content-ad\"></div>\n\nêµ¬ë…ìë‹˜: ìƒˆë¡œìš´ Python ìŠ¤í¬ë¦½íŠ¸ì¸ subscriber.pyë¥¼ ë§Œë“¤ì—ˆì–´ìš”. ì´ ìŠ¤í¬ë¦½íŠ¸ëŠ” Kafka í† í”½ì—ì„œ ë©”ì‹œì§€ë¥¼ ê°€ì ¸ì™€ Polarsë¥¼ ì‚¬ìš©í•˜ì—¬ Delta í…Œì´ë¸”ì— ì“°ëŠ” ì—­í• ì„ í•´ìš”.\n\nì§ˆë¬¸: ì¶”ê°€ì ìœ¼ë¡œ í•œ ê°€ì§€ ë”, query.pyë¼ëŠ” ë§ˆì§€ë§‰ Python ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë§Œë“¤ì—ˆì–´ìš”. ì´ ìŠ¤í¬ë¦½íŠ¸ëŠ” Delta í…Œì´ë¸”ì— í¬í•¨ëœ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ ì¡°ì¸í•˜ê³ , ì¡°ì¸ëœ ë°ì´í„°ë¥¼ í¬í•¨í•œ ë°ì´í„°í”„ë ˆì„ì„ í™”ë©´ì— ì¶œë ¥í•©ë‹ˆë‹¤.\n\në§¤ê°œë³€ìˆ˜: Python ìŠ¤í¬ë¦½íŠ¸ ë‚´ì— ì„¤ì • ë§¤ê°œë³€ìˆ˜ë¥¼ ì €ì¥í•˜ëŠ” ëŒ€ì‹  toml íŒŒì¼ì„ ì‚¬ìš©í–ˆì–´ìš”. ì´ë ‡ê²Œ í•˜ë©´ ë§¤ê°œë³€ìˆ˜ë¥¼ ë³€ê²½í•˜ê³  ì‹¶ì–´ë„ ì½”ë“œë¥¼ ì†ëŒ€ì§€ ì•Šì•„ë„ ë¼ìš”.\n\n# ë‹¨ìˆœíˆ ì‹¤í–‰ë§Œ í•˜ë ¤ë©´\n\n<div class=\"content-ad\"></div>\n\nì›í•˜ëŠ” ë¶€ë¶„ìœ¼ë¡œ ê±´ë„ˆë›°ê³  ì‹¶ìœ¼ì„¸ìš”? ì•Œê² ì–´ìš”! ì—¬ê¸° ì‹¤í–‰í•˜ëŠ” ìˆœì„œì…ë‹ˆë‹¤:\n\në¨¼ì € Kafka ë¸Œë¡œì»¤ë¥¼ ì‹¤í–‰í•˜ë ¤ë©´ Dockerê°€ ì„¤ì¹˜ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤. ë©”ì¸ í´ë” ë‚´ì—ì„œ docker-compose upì„ ì‹¤í–‰í•  ìˆ˜ ìˆì–´ìš”. ë¨¼ì € ëª‡ ê°€ì§€ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•´ì•¼ í•˜ë©°, ê·¸ í›„ì— í”„ë¡œì„¸ìŠ¤ë“¤ì´ ì‹œì‘ë˜ë©´ í™”ë©´ì— ë§ì€ í…ìŠ¤íŠ¸ê°€ í‘œì‹œë  ê±°ì˜ˆìš”:\n\n![ì´ë¯¸ì§€](/assets/img/2024-05-20-BuildingaReal-TimeDataPipeline_0.png)\n\nê·¸ ë‹¤ìŒìœ¼ë¡œ, publisherìš© ìƒˆ í„°ë¯¸ë„ ì„¸ì…˜ì„ ì—´ê³ , subscriberìš© ë˜ ë‹¤ë¥¸ í„°ë¯¸ë„ ì„¸ì…˜ì„ ì—´ì–´ ë³´ì„¸ìš”. Docker ì»¨í…Œì´ë„ˆë¥¼ ì„¤ì •í•˜ì§€ëŠ” ì•Šì•˜ì§€ë§Œ, ì´ë“¤ì„ ë…ë¦½ì ì¸ Docker ì»¨í…Œì´ë„ˆë¡œ ì„¤ì •í•  ë°©ë²•ì— ëŒ€í•´ ì•Œì•„ë³´ê³  ì‹¶ë‹¤ë©´ ì´ ê¸°ì‚¬ë¥¼ í™•ì¸í•´ ë³´ì„¸ìš”. ëŒ€ì‹ , ìƒˆë¡œìš´ ê°€ìƒ Python í™˜ê²½ì„ ë§Œë“¤ì–´ì„œ ê·¸ ì•ˆì— ì„¤ì¹˜í•  ê±¸ ê¶Œì¥ë“œë ¤ìš”. python3 -m venv venvë¡œ ê°€ìƒ í™˜ê²½ì„ ìƒì„±í•œ ë‹¤ìŒ venv/bin/activateë¥¼ ì…ë ¥í•˜ì—¬ ìƒˆë¡œìš´ ê°€ìƒ í™˜ê²½ìœ¼ë¡œ ì „í™˜í•˜ê³ , requirements.txtì— ì •ì˜ëœ í•„ìˆ˜ íŒ¨í‚¤ì§€ë¥¼ pip install -rë¡œ ì„¤ì¹˜í•˜ì‹œë©´ ë©ë‹ˆë‹¤.\n\n<div class=\"content-ad\"></div>\n\nëª¨ë“  ì¤€ë¹„ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë¨¼ì € í„°ë¯¸ë„ ì°½ì—ì„œ subscriber.pyë¥¼ ì‹¤í–‰í•œ í›„, ì¤€ë¹„ê°€ ë˜ë©´ publisher.pyë¥¼ ì‹¤í–‰í•˜ì„¸ìš”. publisherì—ì„œ ì „ì†¡ëœ ë§ˆì´í¬ë¡œ ë°°ì¹˜ë¥¼ ë³¼ ìˆ˜ ìˆìœ¼ë©°, ë™ì‹œì— subscriberê°€ ì‹¤ì‹œê°„ìœ¼ë¡œ ìˆ˜ì‹ í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆì„ ê²ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ subscriberì™€ publisherë¥¼ ì˜¬ë°”ë¥¸ ìˆœì„œë¡œ ë¡œë“œí•´ì•¼ í•©ë‹ˆë‹¤. subscriberê°€ ì¤€ë¹„ë˜ê¸° ì „ì— publisherê°€ ëª¨ë‘ ë³´ë‚´ë²„ë¦¬ëŠ” ì¼ì´ ì—†ë„ë¡ ì£¼ì˜í•˜ì„¸ìš”. ì´ ê²½ëŸ‰ ë°ëª¨ì—ì„œëŠ” ë³´ê´€ ê¸°ê°„ì„ ì„¤ì •í•˜ì§€ ì•Šì•˜ìœ¼ë‹ˆ ì£¼ì˜í•´ì£¼ì„¸ìš”.\n\nì•„ë˜ ìŠ¤í¬ë¦°ìƒ·ì„ ë³´ë©´, ì™¼ìª½ì— publisherê°€ ìˆê³  ì˜¤ë¥¸ìª½ì— subscriberê°€ ìˆëŠ” ë¶„í•  ëœ í„°ë¯¸ë„ì´ ìˆìŠµë‹ˆë‹¤. ì™¼ìª½ì—ì„œ ì „ì†¡ë˜ëŠ” ì¼ê´„ì²˜ë¦¬ëœ ë°ì´í„°ë¥¼ ë³´ê³ , ì˜¤ë¥¸ìª½ì—ì„œëŠ” ê°œë³„ ë ˆì½”ë“œê°€ ì²˜ë¦¬ë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n![Publisher ë° Subscriber ìŠ¤í¬ë¦°ìƒ·](/assets/img/2024-05-20-BuildingaReal-TimeDataPipeline_1.png)\n\nëª¨ë“  ë ˆì½”ë“œê°€ ì „ì†¡ëœ í›„ì—ëŠ” publisherê°€ ì—°ê²°ì„ ì¢…ë£Œí•  ê²ƒì…ë‹ˆë‹¤. subscriberëŠ” í”„ë¡œì„¸ìŠ¤ê°€ ì¢…ë£Œë  ë•Œê¹Œì§€ ê³„ì† ìˆ˜ì‹  ëŒ€ê¸° ìƒíƒœì— ë¨¸ë¬´ë¥¼ ê²ƒì…ë‹ˆë‹¤.\n\n<div class=\"content-ad\"></div>\n\në§ˆì§€ë§‰ ë‹¨ê³„ëŠ” query.py íŒŒì¼ì„ ì‹¤í–‰í•˜ì—¬ ë‹¤ë¥¸ í™”ë©´ì„ ë¡œë“œí•˜ê³  ì¿¼ë¦¬ ê²°ê³¼ë¥¼ í™•ì¸í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. í™”ë©´ì— DataFrameì´ ì¶œë ¥ë˜ëŠ”ë°, ì´ê²‡ì´ ìš°ë¦¬ì˜ ì‘ì—… ê²°ê³¼ì…ë‹ˆë‹¤. ì´ëŸ¬í•œ csv íŒŒì¼ ê°ê°ì´ Kafkaë¥¼ í†µí•´ Delta í…Œì´ë¸”ë¡œ ì´ë™ë˜ì—ˆìœ¼ë©°, ì´ì œ ì˜¬ë°”ë¥¸ ë°ì´í„° ìœ í˜•ê³¼ í•„ë“œ ì´ë¦„ì„ ê°€ì§„ ë‹¨ì¼ DataFrameìœ¼ë¡œ ë³€í™˜ë˜ì—ˆìŠµë‹ˆë‹¤. í•„ìš”í•˜ë‹¤ë©´, ë°œí–‰ë¬¼ì„ ì‹œì‘í•˜ëŠ” ë™ì‹œì— ì‹¤í–‰í•  ìˆ˜ ìˆìœ¼ë©°, ì—¬ëŸ¬ ë²ˆ ì‹¤í–‰í•˜ë©´ ë°ì´í„°ê°€ íë¥´ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n![ì´ë¯¸ì§€](/assets/img/2024-05-20-BuildingaReal-TimeDataPipeline_2.png)\n\nì—¬ê¸°ê¹Œì§€ì…ë‹ˆë‹¤! ëª‡ ê°œì˜ csv íŒŒì¼ì„ Kafkaë¥¼ í†µí•´ ë§ˆì´í¬ë¡œ ë°°ì¹˜ë¡œ ë¡œë“œí•œ ë‹¤ìŒ ì´ë¥¼ Delta í…Œì´ë¸”ë¡œ ë‹¤ìš´ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ ìŠ¤íŠ¸ë¦¬ë°í–ˆìŠµë‹ˆë‹¤. ê·¸ í›„ ë°ì´í„°ë¥¼ ì¿¼ë¦¬í•˜ê³  ë³€í™˜í•˜ì—¬ ì§ì›, ë¶€ì„œ, ê³ ê°, íŒë§¤ ì¼ì, íŒë§¤ ì§€ì—­ ë° íŒë§¤ ê¸ˆì•¡ì„ ëª¨ë‘ í¬í•¨í•œ ë‹¨ì¼ DataFrameìœ¼ë¡œ í†µí•©í–ˆìŠµë‹ˆë‹¤.\n\në§Œì•½ ê¶ê¸ˆí•˜ì‹œë‹¤ë©´, ê° í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ë¥¼ ê¸°ë°˜ìœ¼ë¡œ íŒŒì¼ì„ ë¡œë“œí•˜ê¸° ìœ„í•´ ë³‘í•© í”„ë¡œì„¸ìŠ¤ë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ë°ì´í„°ë¥¼ ë³€ê²½í•˜ê³  ë‹¤ì‹œë¡œë“œí•˜ë©´ Delta í…Œì´ë¸”ì—ì„œ ë°ì´í„°ë¥¼ ìš°ì•„í•˜ê²Œ ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ì—ì„œ csvì—ì„œ Finance ë¶€ì„œ ë ˆì½”ë“œë¥¼ FinTechë¡œ ë³€ê²½í•˜ê³  ë‘ ë²ˆì§¸ë¡œ ì‹¤í–‰í–ˆë”ë‹ˆ ì–´ë–»ê²Œ ë³€ê²½ë˜ëŠ”ì§€ í™•ì¸í•´ë³´ì„¸ìš”:\n\n<div class=\"content-ad\"></div>\n\n![ì´ë¯¸ì§€](/assets/img/2024-05-20-BuildingaReal-TimeDataPipeline_3.png)\n\nê³„ì† ì½ì–´ ë³´ë©´ ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ì§€ ì•Œ ìˆ˜ ìˆì–´ìš”...\n\n# ë°œí–‰ì\n\në°œí–‰ì ìŠ¤í¬ë¦½íŠ¸ëŠ” ë°ì´í„°ë¥¼ Kafkaë¡œ ë³´ë‚´ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. ì „ì²´ íŒŒì¼ì€ ì—¬ê¸°ì—ì„œ ì°¾ì„ ìˆ˜ ìˆì–´ìš”. ì¼ë¶€ êµ¬ì„±ì„ ì„¤ì •í•œ í›„, íŒŒì¼ì„ ì‹œì‘í•˜ëŠ” ì§€ì ì¸ ì•„ë˜ìª½ì—ì„œ ì—¬ì •ì„ ì‹œì‘í•´ìš”:\n\n<div class=\"content-ad\"></div>\n\n```js\nif __name__ == \"__main()\":\n    producer = create_producer(bootstrap_servers)\n    \n    try:\n        process_files_and_send(producer, topics, batch_size)\n    finally:\n        producer.close()\n```\n\nì¹´í”„ì¹´ í”„ë¡œë“€ì„œë¥¼ producerë¡œ ì¸ìŠ¤í„´ìŠ¤í™”í•˜ê³  ì„œë²„ ì„¸ë¶€ ì •ë³´ë¥¼ ì „ë‹¬í–ˆìŠµë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ íŒŒì¼ì„ ì²˜ë¦¬í•˜ë ¤ê³  ì‹œë„í•˜ê³  ì™„ë£Œë˜ë©´ ì—°ê²°ì„ ë‹«ìŠµë‹ˆë‹¤. ê°„ë‹¨í•˜ì£ ! ì´ì œ íŒŒì¼ì˜ ë§¨ ìœ„ë¡œ ëŒì•„ê°€ì„œ ê° í•¨ìˆ˜ë¥¼ í•˜ë‚˜ì”© ì‘ì—…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n## create_producer\n\n```js\ndef create_producer(bootstrap_servers):\n    return KafkaProducer(\n        bootstrap_servers=bootstrap_servers,\n        value_serializer=lambda v: json.dumps(v).encode(\"utf-8\")\n    )\n```\n\n<div class=\"content-ad\"></div>\n\nì—¬ê¸°ì—ëŠ” ê·¸ë‹¤ì§€ ë§ì€ ë‚´ìš©ì´ ì—†ì–´ìš”. ì €ëŠ” ë‹¨ìˆœíˆ KafkaProducerë¥¼ í•¨ìˆ˜ë¡œ ë˜í•‘í•˜ì—¬ ì œ ê°œì¸ì ì¸ ê²ƒìœ¼ë¡œ ë§Œë“¤ì—ˆì–´ìš”. ì„œë²„ ì„¸ë¶€ ì •ë³´ë¥¼ ì „ë‹¬í•˜ê³ , ë§¤ê°œë³€ìˆ˜ì¸ vë¥¼ ì·¨í•˜ê³  í•´ë‹¹ ë§¤ê°œë³€ìˆ˜ë¡œ ì „ë‹¬ëœ ë‚´ìš©ì„ JSONìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ëŒë‹¤ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í–ˆì–´ìš”. ê·¸ JSONì€ UTF-8ë¡œ ì¸ì½”ë”©ë˜ì–´ìš”. ë§ì€ ë°ì´í„° ì²˜ë¦¬ í•¨ìˆ˜ê°€ ë¬¸ìì—´ ëŒ€ì‹  ë°”ì´íŠ¸ í˜•ì‹ì˜ ë°ì´í„°ë¥¼ ì˜ˆìƒí•˜ê¸° ë•Œë¬¸ì— ì´ê²ƒì€ í•„ìˆ˜ì ì…ë‹ˆë‹¤.\n\n## send_messages\n\n```js\ndef send_messages(producer, topic, messages):\n    try:\n        for message in messages:\n            producer.send(topic, value=message)\n        producer.flush()\n        logging.info(f\"Batch of messages sent to topic '{topic}'.\")\n    except Exception as e:\n        logging.error(f\"Failed to send messages to topic '{topic}'. Error: {e}\")\n```\n\nì €ëŠ” ì•„ì§ í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— ë‹¤ìŒì— ì´ê²ƒì„ ì„¤ì •í•˜ê³  ìˆì–´ìš”. ì‹¤ì œë¡œ ì‚¬ìš©ë  ë•Œ ë¯¸ë¦¬ ë¡œë“œë˜ê³  ì¤€ë¹„ë˜ì–´ ìˆì–´ì•¼ í•´ìš”. ì—¬ê¸°ì„œëŠ” Kafkaë¡œ ë°ì´í„°ë¥¼ ì „ì†¡í•˜ë ¤ê³  ë…¸ë ¥í•´ìš”. ê° ë©”ì‹œì§€ë§ˆë‹¤ Kafka Producerë¥¼ ì‚¬ìš©í•˜ê³  ë©”ì‹œì§€ë¥¼ ì£¼ì œë¡œ ë³´ë‚´ìš”. ê·¸ëŸ° ë‹¤ìŒ ë³´ë‚¸ ê²ƒì„ ê¸°ë¡í•˜ê±°ë‚˜ í•„ìš”í•œ ê²½ìš° ë°œìƒí•œ ì˜¤ë¥˜ë¥¼ ê¸°ë¡í•´ ë‚´ìš©ì´ ì˜ëª»ëëŠ”ì§€ ì¡°ì‚¬í•  ìˆ˜ ìˆì–´ìš”.\n\n<div class=\"content-ad\"></div>\n\n## process_files_and_send\n\n```js\ndef process_files_and_send(producer, topics, batch_size):\n    for topic in topics:\n        try:\n            with open(f\"{raw_path}/{topic}.csv\", encoding=\"utf-8-sig\") as csvfile:\n                csvreader = csv.DictReader(csvfile)\n                batch = []\n\n                for rows in csvreader:\n                    batch.append(rows)\n                    if len(batch) >= batch_size:\n                        send_messages(producer, topic, batch)\n                        batch = []\n\n                # Send any remaining messages in the last batch\n                if batch:\n                    send_messages(producer, topic, batch)\n\n        except FileNotFoundError:\n            logging.error(f\"File not found: {raw_path}/{topic}.csv\")\n        except Exception as e:\n            logging.error(f\"Error processing file for topic '{topic}': {e}\")\n```\n\nì—¬ê¸°ê°€ ë²ˆì¡í•œ ë¶€ë¶„ì´ê³ , ë°ì´í„°ë¥¼ ë³´ë‚´ëŠ” ì‘ì—…ì„ ë§ˆì¹˜ê²Œ ë  ê±°ì•¼.\n\nì œê°€ í”„ë¡œë“€ì„œë¥¼ ë§¨ ì²˜ìŒì— ì¸ìŠ¤í„´ìŠ¤í™”í•  ë•Œ ì „ë‹¬í•˜ê³ , í† í”½ë“¤ë„ í•¨ê»˜ ì „ë‹¬í•´ì£¼ëŠ” í•¨ìˆ˜ë¥¼ ë§Œë“¤ì—ˆì–´ìš”. ê·¸ëŸ° ë‹¤ìŒ ê° í† í”½ì„ ìˆœíšŒí•˜ë©´ì„œ ì²˜ë¦¬í•´ìš”. ê° í† í”½ì€ csv íŒŒì¼ê³¼ ê´€ë ¨ì´ ìˆê¸° ë•Œë¬¸ì—, ë¨¼ì € íŒŒì¼ì„ ì—´ë ¤ê³  ì‹œë„í•˜ëŠ” ê±°ì£ .\n\n<div class=\"content-ad\"></div>\n\në°°ì¹˜ í¬ê¸°ë¥¼ ì…ë ¥ ë§¤ê°œë³€ìˆ˜ë¡œ ì •ì˜í–ˆë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆì„ ê²ë‹ˆë‹¤. ì´ê±´ ì •ë§ í•„ìˆ˜ì ì¸ ê²ƒì€ ì•„ë‹ˆì§€ë§Œ, csv íŒŒì¼ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ëŒ€ì‹ ì— ì›¹í˜ì´ì§€ë‚˜ ë‹¤ë¥¸ ìŠ¤íŠ¸ë¦¬ë° ì„œë¹„ìŠ¤ì—ì„œ ê°€ì ¸ì˜¤ëŠ” ê²ƒì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì—, ë©”ì‹œì§€ë¥¼ ë°°ì¹˜ë¡œ ë¬¶ì–´ì„œ ê·¸ë£¹ìœ¼ë¡œ ë³´ë‚´ê³  ì‹¶ì—ˆìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ì‘ì—…ì´ ë¹¨ë¼ì§‘ë‹ˆë‹¤. ì €ëŠ” toml íŒŒì¼ ë‚´ì—ì„œ ë°°ì¹˜ í¬ê¸°ë¥¼ 10ìœ¼ë¡œ ì„¤ì •í–ˆëŠ”ë°, ì´ëŠ” ì‚¬ì‹¤ìƒ í•œ ë²ˆì— csv íŒŒì¼ì˜ 10ì¤„ì— í•´ë‹¹í•©ë‹ˆë‹¤.\n\nê·¸ëŸ° ë‹¤ìŒ ê° í–‰ì„ ë°°ì¹˜ì— ì¶”ê°€í•˜ë©´ì„œ ë°°ì¹˜ í•œë„ì— ë„ë‹¬í•  ë•Œê¹Œì§€ ì‘ì—…ì„ ìˆ˜í–‰í•œ í›„ ë°ì´í„°ë¥¼ ì „ì†¡í•˜ê³  ë°°ì¹˜ë¥¼ ë¹„ì›ë‹ˆë‹¤. ì‘ì—…ì„ ë§ˆì¹˜ë©´ ë§ˆì§€ë§‰ ë©”ì‹œì§€ë¡œ ë°°ì¹˜ë¥¼ ì •ë¦¬í•©ë‹ˆë‹¤ (ë‚¨ì€ ë ˆì½”ë“œê°€ 5ê°œë§Œ ë‚¨ì•˜ì„ ìˆ˜ ìˆì§€ë§Œ, ê·¸ë˜ë„ ëª¨ë‘ ë³´ë‚´ê³  ì‹¶ìŠµë‹ˆë‹¤).\n\në§ˆì§€ë§‰ìœ¼ë¡œ, raw íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ëŠ” ê²½ìš°ë‚˜ ë°œìƒí•  ìˆ˜ ìˆëŠ” ê¸°íƒ€ ì¼ë°˜ì ì¸ ì˜¤ë¥˜ì— ëŒ€í•œ ì˜¤ë¥˜ ì²˜ë¦¬ê°€ ìˆìŠµë‹ˆë‹¤.\n\nì´ê²ƒì´ publisher.py íŒŒì¼ì˜ ë‚´ìš©ì…ë‹ˆë‹¤. ì´í•´ê°€ ë˜ì‹œê² ë‚˜ìš”? ì´ì œ subscriber.py íŒŒì¼ë¡œ ë„˜ì–´ê°€ ë´…ì‹œë‹¤!\n\n<div class=\"content-ad\"></div>\n\n# êµ¬ë…ì\n\nêµ¬ë…ìëŠ” Kafka ì£¼ì œë¥¼ ì²­ì·¨í•˜ê³ , ìƒˆ ë ˆì½”ë“œë¥¼ ë°œê²¬í–ˆì„ ë•Œ íŠ¹ì • ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. ì´ ê²½ìš°, í•´ë‹¹ ë ˆì½”ë“œì˜ ë‚´ìš©ì„ ê°€ì ¸ì™€ Delta í…Œì´ë¸”ì— ì €ì¥í•©ë‹ˆë‹¤. ì—¬ê¸°ì„œ ì „ì²´ ì½”ë“œë¥¼ ì°¾ì„ ìˆ˜ ìˆëŠ” ì½”ë“œë¥¼ í†µí•´ ì½”ë“œë¥¼ í•˜ë‚˜ì”© ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\n\n```js\nif __name__ == \"__main__\":\n    consumer = create_consumer(topics, bootstrap_servers)\n    for message in consumer:\n        process_message(message.topic, message.value)\n```\n\në°œí–‰ìì™€ ë¹„ìŠ·í•˜ê²Œ, ì²« ë²ˆì§¸ë¡œ í•˜ëŠ” ì¼ì€ ì£¼ì œ ë° ì„œë²„ ì„¸ë¶€ ì •ë³´ë¥¼ êµ¬ì„± ë³€ìˆ˜ë¡œ ì œê³µí•˜ê³ , ì´ë¥¼ ì „ë‹¬í•˜ì—¬ ì†Œë¹„ìë¥¼ ì¸ìŠ¤í„´ìŠ¤í™”í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ ì†Œë¹„í•œ ê° ë©”ì‹œì§€ë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤. ê°„ë‹¨í•˜ì§€ìš”. í•˜ì§€ë§Œ í•¨ìˆ˜ë³„ë¡œ ì¢€ ë” ìì„¸íˆ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\n\n<div class=\"content-ad\"></div>\n\n## ì†Œë¹„ì ìƒì„±\n\n```js\ndef create_consumer(topics, bootstrap_servers):\n    return KafkaConsumer(\n        *topics,\n        bootstrap_servers = bootstrap_servers,\n        value_deserializer = lambda v: json.loads(v.decode(\"utf-8\"))\n```\n\nìš°ë¦¬ Pythonì˜ ì§„ì…ì ì—ì„œ ì²« ë²ˆì§¸ ì¤„ì€ ì†Œë¹„ìë¥¼ ì¸ìŠ¤í„´ìŠ¤í™”í•˜ëŠ” ê²ƒì´ì—ˆìŠµë‹ˆë‹¤. ì´ê²ƒì€ ê¸°ë³¸ì ìœ¼ë¡œ KafkaConsumerì˜ ë˜í¼ì¼ ë¿ì…ë‹ˆë‹¤. í¼ë¸”ë¦¬ì…”ì™€ ë‹¤ë¥¸ ê²ƒì€ ì•„ë¬´ ê²ƒë„ í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\n\n## ë©”ì‹œì§€ ì²˜ë¦¬\n\n<div class=\"content-ad\"></div>\n\n```python\ndef process_message(topic, data):\n    df = pl.from_records([data])\n    delta_table_path = f\"{delta_path}/{topic}\"\n    if not os.path.exists(delta_table_path):\n        write_delta_table(df, delta_table_path, \"insert\")\n    else:\n        merge_into_delta_table(df, delta_table_path)\n``` \n\në©”ì‹œì§€ë¥¼ ë°›ì„ ë•Œë§ˆë‹¤ ê·¸ê²ƒì„ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ì•¼ í•©ë‹ˆë‹¤. ì €ëŠ” ì—¬ê¸°ì„œ ë‘ ê°€ì§€ ë°©ë²•ì„ ì„ íƒí–ˆìŠµë‹ˆë‹¤. ë¨¼ì € Delta í…Œì´ë¸”ì´ ì €ì¥ëœ ê²½ë¡œë¥¼ ê°€ì ¸ì™€ í•´ë‹¹ ê²½ë¡œê°€ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤. ê²½ë¡œê°€ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ ìƒˆ ë ˆì½”ë“œë¥¼ ì‚½ì…í•˜ê¸° ìœ„í•´ insert ë§¤ê°œë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ write_delta_table í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ê²½ë¡œê°€ ì´ë¯¸ ì¡´ì¬í•œë‹¤ë©´, merge_into_delta_table í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ì—¬ëŸ¬ ë²ˆë¡œë“œí•  ìˆ˜ ìˆê²Œ í•˜ë©´ì„œ ë‹¨ìˆœíˆ í…Œì´ë¸”ì„ ì ì  ë” í¬ê²Œ ë§Œë“¤ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ë¯¸ ë³€ê²½ëœ ê¸°ì¡´ í•­ëª©ì„ ì—…ë°ì´íŠ¸í•˜ê³  ìƒˆ ë ˆì½”ë“œë§Œ ì¶”ê°€í•©ë‹ˆë‹¤.\n\nì´ëŸ¬í•œ í•¨ìˆ˜ë“¤ì„ ì¢€ ë” ìì„¸íˆ ì‚´í´ë´…ì‹œë‹¤.\n\n## write_delta_table\n  \n\n<div class=\"content-ad\"></div>\n\n```python\ndef write_delta_table(df, path, mode):\n    try:\n        df.write_delta(target=path, mode=mode)\n        logging.info(f\"{mode.capitalize()}ed message to Delta table: {df}\")\n    except Exception as e:\n        logging.error(f\"Failed to {mode} message to Delta table: {df}\")\n        logging.error(f\"Error: {e}\")\n```\n\ní…Œì´ë¸” íƒœê·¸ë¥¼ ë§ˆí¬ë‹¤ìš´ í˜•ì‹ìœ¼ë¡œ ë³€ê²½í•´ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.\n\nì—¬ê¸°ì„œëŠ” DataFrame, ì£¼ì œ ê²½ë¡œ, ê·¸ë¦¬ê³  ëª¨ë“œ(ì‚½ì…)ë¥¼ ê°„ë‹¨íˆ ì „ë‹¬í•˜ê³  ë„¤ì´í‹°ë¸Œ Polars ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì—¬ Delta í…Œì´ë¸”ì— ì‘ì„±í•©ë‹ˆë‹¤. ì‘ì—…ì´ ì„±ê³µí–ˆìŒì„ ë¡œê·¸ì— ë‚¨ê¸°ê±°ë‚˜ ì‹¤íŒ¨í–ˆì„ ë•Œ ì˜¤ë¥˜ë¥¼ ìº¡ì²˜í•˜ì—¬ ì¡°ì‚¬í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.\n\n## merge_into_delta_table\n\nì—¬ê¸°ì—ëŠ” ì¡°ê¸ˆ ë” ìˆìŠµë‹ˆë‹¤.\n\n\n<div class=\"content-ad\"></div>\n\n```python\ndef merge_into_delta_table(df, path):\n    try:\n        df.write_delta(\n            target=path, mode=\"merge\",\n            delta_merge_options={\n                \"predicate\": \"s.id = t.id\",\n                \"source_alias\": \"s\",\n                \"target_alias\": \"t\",\n            }\n        ).when_matched_update_all().when_not_matched_insert_all().execute()\n        logging.info(f\"Merged message to Delta table: {df}\")\n    except Exception as e:\n        logging.error(f\"Failed to merge message to Delta table: {df}\")\n        logging.error(f\"Error: {e}\")\n```\n\nì—¬ê¸°ì—ì„œ ëª¨ë“œë¥¼ ì „ë‹¬í•˜ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤. ì™œëƒí•˜ë©´ ëª¨ë“œê°€ \"merge\"ë¡œ ì„¤ì •ë  ê²ƒì´ë¼ëŠ” ê²ƒì„ ì•Œê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ì œ ëª¨ë“  í…Œì´ë¸”ì—ëŠ” idë¼ëŠ” ë™ì¼í•œ ì´ë¦„ì„ ê°€ì§„ ê¸°ë³¸ í‚¤ê°€ ìˆìœ¼ë¯€ë¡œ í•œ ë²ˆ ì •ì˜í•˜ê³  ì´ í•¨ìˆ˜ë¥¼ ì™„ì „íˆ ì¬ì‚¬ìš©í•˜ê¸° ì‰½ìŠµë‹ˆë‹¤. ì¼ì¹˜í•˜ëŠ” ê²½ìš° ë°ì´í„°ê°€ ì—…ë°ì´íŠ¸ë˜ê³ , ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ê²½ìš° ë°ì´í„°ê°€ ì‚½ì…ë©ë‹ˆë‹¤. ì´ê²ƒì´ ê¸°ë³¸ì ìœ¼ë¡œ upsertì…ë‹ˆë‹¤. ì„±ê³µê³¼ ì‹¤íŒ¨ë¥¼ ì—¬ì „íˆ ê¸°ë¡í–ˆìŠµë‹ˆë‹¤.\n\nì—¬ê¸°ê°€ íŒŒì´í”„ë¼ì¸ì˜ ì „ë¶€ì…ë‹ˆë‹¤. ì •ë§ ê°„ë‹¨í•©ë‹ˆë‹¤. ë°ì´í„°ë¥¼ ê²Œì‹œí•˜ê³  ë°ì´í„°ë¥¼ êµ¬ë…í•˜ì—¬ ë””ìŠ¤í¬ì— ì €ì¥í•©ë‹ˆë‹¤. ë‹¤ìŒì—ëŠ” í•´ë‹¹ ë°ì´í„°ë¥¼ ì¿¼ë¦¬í•˜ê³  ëª¨ë“  ê²ƒì„ í•¨ê»˜ ê°€ì ¸ì˜¤ëŠ” DataFrameì„ ê°€ì ¸ì˜¤ëŠ” ë°©ë²•ì„ ì‚´í´ë³¼ ê²ƒì…ë‹ˆë‹¤.\n\n# ì¿¼ë¦¬\n\n\n<div class=\"content-ad\"></div>\n\nì´ ì‹œì ì—ì„œ KafkaëŠ” ë” ì´ìƒ ì‚¬ìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ëª¨ë“  ê²ƒì´ Delta í…Œì´ë¸”ì— ìˆìœ¼ë©° ì¿¼ë¦¬ë§Œ í•„ìš”í•©ë‹ˆë‹¤. ì „ì²´ ì½”ë“œëŠ” ì—¬ê¸°ì— ìˆìŠµë‹ˆë‹¤. Delta í…Œì´ë¸”ì„ ê°ê° ë°ì´í„°í”„ë ˆì„ ì§‘í•©ìœ¼ë¡œ ë¶ˆëŸ¬ì˜¤ê¸° ì‹œì‘í–ˆìŠµë‹ˆë‹¤:\n\n```js\nclient = pl.read_delta(f\"{delta_path}/client\")\ndepartment = pl.read_delta(f\"{delta_path}/department\")\nemployee = pl.read_delta(f\"{delta_path}/employee\")\nsale = pl.read_delta(f\"{delta_path}/sale\")\n```\n\nclientì™€ employee ë°ì´í„°í”„ë ˆì„ì—ëŠ” first_nameê³¼ last_name ì†ì„±ì´ ê°™ìŠµë‹ˆë‹¤. ë°ì´í„°í”„ë ˆì„ ì´ë¦„ ì™¸ì—ëŠ” êµ¬ë³„í•  ìš”ì†Œê°€ ì—†ìŠµë‹ˆë‹¤. ê°ê°ì— first_nameê³¼ last_nameì„ ë¶™ì—¬ ê³µë°±ì„ êµ¬ë¶„ìë¡œ ì‚¬ìš©í•œ ìƒˆë¡œìš´ ì†ì„±ì„ ì¶”ê°€í•˜ê³  ì ì ˆíˆ ì´ë¦„ì„ ì§€ì—ˆìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ë‘ ë°ì´í„°í”„ë ˆì„ì„ í•˜ë‚˜ì˜ ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ê²°í•©í•  ë•Œ ë¬´ì—‡ì´ ë¬´ì—‡ì¸ì§€ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n```js\nclient = client.with_columns(\n    pl.concat_str([\"first_name\", \"last_name\"], separator = \" \").alias(\"client_name\")\n    )\n\nemployee = employee.with_columns(\n    pl.concat_str([\"first_name\", \"last_name\"], separator = \" \").alias(\"employee_name\")\n    )\n```\n\n<div class=\"content-ad\"></div>\n\nì§ì› DataFrameì—ëŠ” department_idë¼ëŠ” ì¶”ê°€ ì†ì„±ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ì‚¬ìš©í•˜ì—¬ ì§ì›ê³¼ ë¶€ì„œë¥¼ í•¨ê»˜ ê²°í•©í•œ ìƒˆ DataFrameì„ ìƒì„±í•  ìˆ˜ ìˆì–´ìš”:\n\n```js\nemployee_dept = employee.join(\n        department, \n        left_on = \"department_id\", \n        right_on = \"id\", \n        how = \"inner\").select(\n                [\"id\", \"employee_name\", \"department_id\", \"department\"]\n                )\n```\n\nì§ì› DataFrameì„ ê¸°ë°˜ìœ¼ë¡œ, ë¶€ì„œ DataFrameê³¼ ì¡°ì¸ì„ ìƒì„±í–ˆëŠ”ë°, ì§ì› DataFrameì˜ department_idì™€ ë¶€ì„œ DataFrameì˜ idë¥¼ ì¼ì¹˜í•˜ëŠ” ì¡°ì¸ ì¡°ê±´ìœ¼ë¡œ ì§€ì •í–ˆì–´ìš”. ëª¨ë“  ì§ì›ì´ ë¶€ì„œë¥¼ ê°€ì ¸ì•¼ í•˜ê¸° ë•Œë¬¸ì— INNER JOINì„ ì¡°ì¸ ìœ í˜•ìœ¼ë¡œ ì„ íƒí–ˆê³ , ì´í›„ ìœ ì§€í•  ì†ì„±ì„ ì„ íƒí–ˆì–´ìš”.\n\në§ˆì§€ë§‰ìœ¼ë¡œ, í•œ ë§ˆì§€ë§‰ ë¬¸ì¥ìœ¼ë¡œ ëª¨ë‘ í•¨ê»˜ ê²°í•©í•  ìˆ˜ ìˆì–´ìš”:\n\n<div class=\"content-ad\"></div>\n\n```js\ncomplete = sale.join(\n        employee_dept,\n        left_on = \"employee_id\", \n        right_on = \"id\", \n        ).join(\n                client, \n                left_on = \"client_id\", \n                right_on = \"id\", \n                how = \"inner\"\n                ).select(\n                        pl.col(\"id\").str.to_integer(),\n                        pl.col(\"employee_name\"), \n                        pl.col(\"department\"), \n                        pl.col(\"client_name\"), \n                        pl.col(\"date\").str.to_date(\"%d/%m/%Y\"), \n                        pl.col(\"region\"), \n                        pl.col(\"sale\").str.to_decimal(2),\n                        )\n```\n\nì €ëŠ” sale DataFrameì—ì„œ ì‹œì‘í•˜ì—¬ ë°©ê¸ˆ ìƒì„±í•œ employee_dept DataFrameì— ì¡°ì¸ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. ì´ì œ ì´ëŠ” sale, employee ë° departmentë¥¼ ê²°í•©í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ client DataFrameì„ ë‹¤ì‹œ ì¡°ì¸í•œ ë‹¤ìŒ ì›í•˜ëŠ” ì†ì„±ì„ ì„ íƒí•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì´ ê²½ìš° ë°ì´í„° ìœ í˜•ì„ ë³€ê²½í–ˆìŠµë‹ˆë‹¤. ë°ì´í„°ëŠ” csvë¥¼ í†µí•´ ê°€ì ¸ì˜¨ ê²ƒì´ê¸° ë•Œë¬¸ì— ì›ë˜ ë°ì´í„° ìœ í˜•ì´ ì—†ì—ˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ idëŠ” ì •ìˆ˜ì´ì–´ì•¼ í•œë‹¤ê³  ì§€ì •í–ˆìŠµë‹ˆë‹¤. ë‚ ì§œëŠ” ë‚ ì§œ ìœ í˜•ì´ì–´ì•¼ í•˜ë©°, í˜•ì‹ì„ ì§€ì •í–ˆìœ¼ë©°, sale ì†ì„±ì´ ë‘ ìë¦¬ ì†Œìˆ˜ì (ë‹¬ëŸ¬ ë° ì„¼íŠ¸)ì¸ ê²ƒì„ ì§€ì •í–ˆìŠµë‹ˆë‹¤.\n\në§ˆì§€ë§‰ ë‹¨ê³„ëŠ” ê²°ê³¼ë¥¼ ì¶œë ¥í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤:\n\n<img src=\"/assets/img/2024-05-20-BuildingaReal-TimeDataPipeline_4.png\" />\n\n\n<div class=\"content-ad\"></div>\n\n# ê²°ë¡ \n\në³¸ ê¸€ì—ì„œëŠ” Kafka, Polars, ê·¸ë¦¬ê³  Delta Lakeë¥¼ í™œìš©í•˜ì—¬ ì‹¤ì‹œê°„ ë°ì´í„° íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•˜ëŠ” ë°©ë²•ì„ ì‚´í´ë³´ì•˜ìŠµë‹ˆë‹¤. ë©”ì‹œì§€ ìŠ¤íŠ¸ë¦¬ë°ì„ ìœ„í•´ Kafkaë¥¼ í™œìš©í•˜ê³ , ë°ì´í„° ì²˜ë¦¬ë¥¼ ìœ„í•´ Polarsë¥¼ ì‚¬ìš©í•˜ë©°, ì•ˆì •ì ì¸ ì €ì¥ì†Œë¡œ Delta Lakeë¥¼ í™œìš©í•˜ì—¬ í™•ì¥ ê°€ëŠ¥í•˜ê³  ì˜¤ë¥˜ í—ˆìš©ì„± ìˆëŠ” ë°ì´í„° íŒŒì´í”„ë¼ì¸ì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nì €ì¥ì†Œì˜ ì½”ë“œ ìƒ˜í”Œì€ íŒŒì´í”„ë¼ì¸ì˜ ê¸°ë³¸ ì„¤ì •ê³¼ ê¸°ëŠ¥ì„ ë³´ì—¬ì¤ë‹ˆë‹¤. ë°ì´í„° ë³´ì¡´ ì •ì±… êµ¬ì„±, S3 ê°ì²´ ì €ì¥ì†Œì— ë°ì´í„° ë³´ê´€, ë‹¤ë¥¸ ì‹œìŠ¤í…œê³¼ í†µí•©í•˜ëŠ” ë“± íŠ¹ì • ìš”êµ¬ ì‚¬í•­ì— ë§ê²Œ ì½”ë“œë¥¼ í™•ì¥í•˜ê³  ì‚¬ìš©ìí™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nì´ ì•„í‚¤í…ì²˜ë¥¼ ì±„íƒí•¨ìœ¼ë¡œì¨ ê¸°ì—…ì€ ì‹¤ì‹œê°„ ë°ì´í„°ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ê³  ë¶„ì„í•˜ì—¬ ë°ì´í„° ê¸°ë°˜ ê²°ì •ì„ ë‚´ë¦¬ê³  ì‹ ì†í•˜ê²Œ ë³€í™”ì— ëŒ€ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n<div class=\"content-ad\"></div>\n\nì´ ê¸€ì´ ìœ ìš©í–ˆê¸¸ ë°”ëë‹ˆë‹¤. ë§Œì•½ ê·¸ë ‡ë‹¤ë©´ ğŸ‘ í•œ ë²ˆ ëˆŒëŸ¬ì£¼ì‹œê² ì–´ìš”? ê·¸ë¦¬ê³  ë” ë³´ê³  ì‹¶ìœ¼ë©´ êµ¬ë…í•´ì£¼ì„¸ìš”. ë§¤ì£¼ í•œ ë‘ í¸ì˜ ê¸€ì„ ì—…ë¡œë“œí•˜ê³  ìˆì–´ìš”.","ogImage":{"url":"/assets/img/2024-05-20-BuildingaReal-TimeDataPipeline_0.png"},"coverImage":"/assets/img/2024-05-20-BuildingaReal-TimeDataPipeline_0.png","tag":["Tech"],"readingTime":13},"content":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    h2: \"h2\",\n    p: \"p\",\n    h1: \"h1\",\n    img: \"img\",\n    pre: \"pre\",\n    code: \"code\",\n    span: \"span\"\n  }, _provideComponents(), props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.h2, {\n      children: \"ì¹´í”„ì¹´(Kafka), í´ë¼ìŠ¤(Polars), ë¸íƒ€ ë ˆì´í¬(Delta Lake)ë¥¼ í™œìš©í•œ ì‹¤ì‹œê°„ ë¶„ì„\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ë°ì´í„° ì—”ì§€ë‹ˆì–´ë¼ë©´ ì–¸ì  ê°€ëŠ” ì‹¤ì‹œê°„ ë°ì´í„°ì— ëŒ€í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­ì„ ì§ë©´í•´ì•¼ í•  ê²ƒì…ë‹ˆë‹¤. ì´ëŠ” ë¹¨ë¦¬ ì˜¤ê² ë‹¤ëŠ” ê²ƒì´ í™•ì‹¤í•©ë‹ˆë‹¤. ì‹¤ì‹œê°„ ë°ì´í„° ì²˜ë¦¬ëŠ” ê¸°ì—…ì´ ì‹ ì†í•˜ê²Œ ì •ë³´ ê¸°ë°˜ ê²°ì •ì„ ë‚´ë¦´ ìˆ˜ ìˆë„ë¡ í•„ìˆ˜ì ìœ¼ë¡œ ì¤‘ìš”í•´ì§€ê³  ìˆìœ¼ë©°, ì•„íŒŒì¹˜ ì¹´í”„ì¹´ëŠ” í™•ì¥ ê°€ëŠ¥í•˜ê³  ì˜¤ë¥˜ í—ˆìš©ì„± ìˆëŠ” ì‹¤ì‹œê°„ ë°ì´í„° íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•˜ê¸° ìœ„í•œ ì¸ê¸° ìˆëŠ” í”Œë«í¼ìœ¼ë¡œ ë¶€ìƒí–ˆìŠµë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì´ ê¸°ì‚¬ì—ì„œëŠ” ì¹´í”„ì¹´, í´ë¼ìŠ¤, ë¸íƒ€ ë ˆì´í¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹¤ì‹œê°„ ë°ì´í„° íŒŒì´í”„ë¼ì¸ì„ ë§Œë“œëŠ” ë°©ë²•ì„ ì‹¤ì œë¡œ ë³´ì—¬ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ê·¸ë¦¬ ì–´ë µì§€ ì•ŠìŠµë‹ˆë‹¤! ìì‹ ë„ ì´ë¥¼ ì‹œë„í•  ìˆ˜ ìˆëŠ” ì½”ë“œëŠ” ì—¬ê¸°ì—ì„œ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìœ ìš©í•˜ë‹¤ê³  ëŠë¼ì‹ ë‹¤ë©´ â­ï¸ì„ ì£¼ì„¸ìš”.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ê¸°ìˆ ì ì¸ ê¸°ì‚¬ê°€ ë  ì˜ˆì •ì´ë‹ˆ, ì½”ë“œ ìŠ¤ë‹ˆí«ì´ ë§ì´ í¬í•¨ë  ê²ƒì…ë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"ë”°ë¼ì˜¤ê¸° ì‹œì‘í•˜ê¸° ìœ„í•´ ì„¤ì •í•´ì•¼ í•  ì‚¬í•­\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì‹œì‘í•˜ê¸° ìœ„í•´ ëª‡ ê°€ì§€ êµ¬ì„± ìš”ì†Œë¥¼ ì„¤ì •í•´ ë‘ì—ˆìŠµë‹ˆë‹¤:\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Kafka ë¸Œë¡œì»¤: Docker Composeë¥¼ ì‚¬ìš©í•˜ì—¬ Kafkaì™€ Zookeeper ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í–ˆìŠµë‹ˆë‹¤. docker-compose.yml íŒŒì¼ì—ëŠ” í•„ìš”í•œ ì„œë¹„ìŠ¤ì™€ êµ¬ì„±ì´ ì •ì˜ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ì— ëŒ€í•´ ìì„¸íˆ ë‹¤ë£¨ì§€ëŠ” ì•Šê² ìŠµë‹ˆë‹¤. ì´ íŒŒì¼ì€ ì–´ë””ì—ì„œë“  ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆëŠ” ê¸°ë³¸ì ì¸ docker-compose.ymlì…ë‹ˆë‹¤. ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ íŒ€ì´ Kafka í™˜ê²½ì„ ê´€ë¦¬í•˜ëŠ” ê²ƒìœ¼ë¡œ ê°„ì£¼í•˜ì§€ ì•Šê² ìŠµë‹ˆë‹¤. ë‹¹ì‹ ì´ ë‹´ë‹¹í•˜ê³  ìˆëŠ” í”Œë«í¼ ë˜ëŠ” ë°ë¸Œì˜µìŠ¤ íŒ€ì´ ê·¸ ì—­í• ì„ ë§¡ê³  ìˆì„ ê²ƒì´ë¼ê³  ê°€ì •í•˜ê² ìŠµë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ë°œí–‰ì: Python ìŠ¤í¬ë¦½íŠ¸ì¸ publisher.pyë¥¼ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤. ì´ ìŠ¤í¬ë¦½íŠ¸ëŠ” ì¼ë ¨ì˜ csv íŒŒì¼ì— ì €ì¥ëœ ìƒ˜í”Œ ë°ì´í„°ë¥¼ Kafka ì£¼ì œì— ë°œí–‰í•©ë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"êµ¬ë…ìë‹˜: ìƒˆë¡œìš´ Python ìŠ¤í¬ë¦½íŠ¸ì¸ subscriber.pyë¥¼ ë§Œë“¤ì—ˆì–´ìš”. ì´ ìŠ¤í¬ë¦½íŠ¸ëŠ” Kafka í† í”½ì—ì„œ ë©”ì‹œì§€ë¥¼ ê°€ì ¸ì™€ Polarsë¥¼ ì‚¬ìš©í•˜ì—¬ Delta í…Œì´ë¸”ì— ì“°ëŠ” ì—­í• ì„ í•´ìš”.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì§ˆë¬¸: ì¶”ê°€ì ìœ¼ë¡œ í•œ ê°€ì§€ ë”, query.pyë¼ëŠ” ë§ˆì§€ë§‰ Python ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë§Œë“¤ì—ˆì–´ìš”. ì´ ìŠ¤í¬ë¦½íŠ¸ëŠ” Delta í…Œì´ë¸”ì— í¬í•¨ëœ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ ì¡°ì¸í•˜ê³ , ì¡°ì¸ëœ ë°ì´í„°ë¥¼ í¬í•¨í•œ ë°ì´í„°í”„ë ˆì„ì„ í™”ë©´ì— ì¶œë ¥í•©ë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ë§¤ê°œë³€ìˆ˜: Python ìŠ¤í¬ë¦½íŠ¸ ë‚´ì— ì„¤ì • ë§¤ê°œë³€ìˆ˜ë¥¼ ì €ì¥í•˜ëŠ” ëŒ€ì‹  toml íŒŒì¼ì„ ì‚¬ìš©í–ˆì–´ìš”. ì´ë ‡ê²Œ í•˜ë©´ ë§¤ê°œë³€ìˆ˜ë¥¼ ë³€ê²½í•˜ê³  ì‹¶ì–´ë„ ì½”ë“œë¥¼ ì†ëŒ€ì§€ ì•Šì•„ë„ ë¼ìš”.\"\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"ë‹¨ìˆœíˆ ì‹¤í–‰ë§Œ í•˜ë ¤ë©´\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì›í•˜ëŠ” ë¶€ë¶„ìœ¼ë¡œ ê±´ë„ˆë›°ê³  ì‹¶ìœ¼ì„¸ìš”? ì•Œê² ì–´ìš”! ì—¬ê¸° ì‹¤í–‰í•˜ëŠ” ìˆœì„œì…ë‹ˆë‹¤:\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ë¨¼ì € Kafka ë¸Œë¡œì»¤ë¥¼ ì‹¤í–‰í•˜ë ¤ë©´ Dockerê°€ ì„¤ì¹˜ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤. ë©”ì¸ í´ë” ë‚´ì—ì„œ docker-compose upì„ ì‹¤í–‰í•  ìˆ˜ ìˆì–´ìš”. ë¨¼ì € ëª‡ ê°€ì§€ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•´ì•¼ í•˜ë©°, ê·¸ í›„ì— í”„ë¡œì„¸ìŠ¤ë“¤ì´ ì‹œì‘ë˜ë©´ í™”ë©´ì— ë§ì€ í…ìŠ¤íŠ¸ê°€ í‘œì‹œë  ê±°ì˜ˆìš”:\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/img/2024-05-20-BuildingaReal-TimeDataPipeline_0.png\",\n        alt: \"ì´ë¯¸ì§€\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ê·¸ ë‹¤ìŒìœ¼ë¡œ, publisherìš© ìƒˆ í„°ë¯¸ë„ ì„¸ì…˜ì„ ì—´ê³ , subscriberìš© ë˜ ë‹¤ë¥¸ í„°ë¯¸ë„ ì„¸ì…˜ì„ ì—´ì–´ ë³´ì„¸ìš”. Docker ì»¨í…Œì´ë„ˆë¥¼ ì„¤ì •í•˜ì§€ëŠ” ì•Šì•˜ì§€ë§Œ, ì´ë“¤ì„ ë…ë¦½ì ì¸ Docker ì»¨í…Œì´ë„ˆë¡œ ì„¤ì •í•  ë°©ë²•ì— ëŒ€í•´ ì•Œì•„ë³´ê³  ì‹¶ë‹¤ë©´ ì´ ê¸°ì‚¬ë¥¼ í™•ì¸í•´ ë³´ì„¸ìš”. ëŒ€ì‹ , ìƒˆë¡œìš´ ê°€ìƒ Python í™˜ê²½ì„ ë§Œë“¤ì–´ì„œ ê·¸ ì•ˆì— ì„¤ì¹˜í•  ê±¸ ê¶Œì¥ë“œë ¤ìš”. python3 -m venv venvë¡œ ê°€ìƒ í™˜ê²½ì„ ìƒì„±í•œ ë‹¤ìŒ venv/bin/activateë¥¼ ì…ë ¥í•˜ì—¬ ìƒˆë¡œìš´ ê°€ìƒ í™˜ê²½ìœ¼ë¡œ ì „í™˜í•˜ê³ , requirements.txtì— ì •ì˜ëœ í•„ìˆ˜ íŒ¨í‚¤ì§€ë¥¼ pip install -rë¡œ ì„¤ì¹˜í•˜ì‹œë©´ ë©ë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ëª¨ë“  ì¤€ë¹„ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë¨¼ì € í„°ë¯¸ë„ ì°½ì—ì„œ subscriber.pyë¥¼ ì‹¤í–‰í•œ í›„, ì¤€ë¹„ê°€ ë˜ë©´ publisher.pyë¥¼ ì‹¤í–‰í•˜ì„¸ìš”. publisherì—ì„œ ì „ì†¡ëœ ë§ˆì´í¬ë¡œ ë°°ì¹˜ë¥¼ ë³¼ ìˆ˜ ìˆìœ¼ë©°, ë™ì‹œì— subscriberê°€ ì‹¤ì‹œê°„ìœ¼ë¡œ ìˆ˜ì‹ í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆì„ ê²ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ subscriberì™€ publisherë¥¼ ì˜¬ë°”ë¥¸ ìˆœì„œë¡œ ë¡œë“œí•´ì•¼ í•©ë‹ˆë‹¤. subscriberê°€ ì¤€ë¹„ë˜ê¸° ì „ì— publisherê°€ ëª¨ë‘ ë³´ë‚´ë²„ë¦¬ëŠ” ì¼ì´ ì—†ë„ë¡ ì£¼ì˜í•˜ì„¸ìš”. ì´ ê²½ëŸ‰ ë°ëª¨ì—ì„œëŠ” ë³´ê´€ ê¸°ê°„ì„ ì„¤ì •í•˜ì§€ ì•Šì•˜ìœ¼ë‹ˆ ì£¼ì˜í•´ì£¼ì„¸ìš”.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì•„ë˜ ìŠ¤í¬ë¦°ìƒ·ì„ ë³´ë©´, ì™¼ìª½ì— publisherê°€ ìˆê³  ì˜¤ë¥¸ìª½ì— subscriberê°€ ìˆëŠ” ë¶„í•  ëœ í„°ë¯¸ë„ì´ ìˆìŠµë‹ˆë‹¤. ì™¼ìª½ì—ì„œ ì „ì†¡ë˜ëŠ” ì¼ê´„ì²˜ë¦¬ëœ ë°ì´í„°ë¥¼ ë³´ê³ , ì˜¤ë¥¸ìª½ì—ì„œëŠ” ê°œë³„ ë ˆì½”ë“œê°€ ì²˜ë¦¬ë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/img/2024-05-20-BuildingaReal-TimeDataPipeline_1.png\",\n        alt: \"Publisher ë° Subscriber ìŠ¤í¬ë¦°ìƒ·\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ëª¨ë“  ë ˆì½”ë“œê°€ ì „ì†¡ëœ í›„ì—ëŠ” publisherê°€ ì—°ê²°ì„ ì¢…ë£Œí•  ê²ƒì…ë‹ˆë‹¤. subscriberëŠ” í”„ë¡œì„¸ìŠ¤ê°€ ì¢…ë£Œë  ë•Œê¹Œì§€ ê³„ì† ìˆ˜ì‹  ëŒ€ê¸° ìƒíƒœì— ë¨¸ë¬´ë¥¼ ê²ƒì…ë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ë§ˆì§€ë§‰ ë‹¨ê³„ëŠ” query.py íŒŒì¼ì„ ì‹¤í–‰í•˜ì—¬ ë‹¤ë¥¸ í™”ë©´ì„ ë¡œë“œí•˜ê³  ì¿¼ë¦¬ ê²°ê³¼ë¥¼ í™•ì¸í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. í™”ë©´ì— DataFrameì´ ì¶œë ¥ë˜ëŠ”ë°, ì´ê²‡ì´ ìš°ë¦¬ì˜ ì‘ì—… ê²°ê³¼ì…ë‹ˆë‹¤. ì´ëŸ¬í•œ csv íŒŒì¼ ê°ê°ì´ Kafkaë¥¼ í†µí•´ Delta í…Œì´ë¸”ë¡œ ì´ë™ë˜ì—ˆìœ¼ë©°, ì´ì œ ì˜¬ë°”ë¥¸ ë°ì´í„° ìœ í˜•ê³¼ í•„ë“œ ì´ë¦„ì„ ê°€ì§„ ë‹¨ì¼ DataFrameìœ¼ë¡œ ë³€í™˜ë˜ì—ˆìŠµë‹ˆë‹¤. í•„ìš”í•˜ë‹¤ë©´, ë°œí–‰ë¬¼ì„ ì‹œì‘í•˜ëŠ” ë™ì‹œì— ì‹¤í–‰í•  ìˆ˜ ìˆìœ¼ë©°, ì—¬ëŸ¬ ë²ˆ ì‹¤í–‰í•˜ë©´ ë°ì´í„°ê°€ íë¥´ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/img/2024-05-20-BuildingaReal-TimeDataPipeline_2.png\",\n        alt: \"ì´ë¯¸ì§€\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì—¬ê¸°ê¹Œì§€ì…ë‹ˆë‹¤! ëª‡ ê°œì˜ csv íŒŒì¼ì„ Kafkaë¥¼ í†µí•´ ë§ˆì´í¬ë¡œ ë°°ì¹˜ë¡œ ë¡œë“œí•œ ë‹¤ìŒ ì´ë¥¼ Delta í…Œì´ë¸”ë¡œ ë‹¤ìš´ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ ìŠ¤íŠ¸ë¦¬ë°í–ˆìŠµë‹ˆë‹¤. ê·¸ í›„ ë°ì´í„°ë¥¼ ì¿¼ë¦¬í•˜ê³  ë³€í™˜í•˜ì—¬ ì§ì›, ë¶€ì„œ, ê³ ê°, íŒë§¤ ì¼ì, íŒë§¤ ì§€ì—­ ë° íŒë§¤ ê¸ˆì•¡ì„ ëª¨ë‘ í¬í•¨í•œ ë‹¨ì¼ DataFrameìœ¼ë¡œ í†µí•©í–ˆìŠµë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ë§Œì•½ ê¶ê¸ˆí•˜ì‹œë‹¤ë©´, ê° í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ë¥¼ ê¸°ë°˜ìœ¼ë¡œ íŒŒì¼ì„ ë¡œë“œí•˜ê¸° ìœ„í•´ ë³‘í•© í”„ë¡œì„¸ìŠ¤ë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ë°ì´í„°ë¥¼ ë³€ê²½í•˜ê³  ë‹¤ì‹œë¡œë“œí•˜ë©´ Delta í…Œì´ë¸”ì—ì„œ ë°ì´í„°ë¥¼ ìš°ì•„í•˜ê²Œ ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ì—ì„œ csvì—ì„œ Finance ë¶€ì„œ ë ˆì½”ë“œë¥¼ FinTechë¡œ ë³€ê²½í•˜ê³  ë‘ ë²ˆì§¸ë¡œ ì‹¤í–‰í–ˆë”ë‹ˆ ì–´ë–»ê²Œ ë³€ê²½ë˜ëŠ”ì§€ í™•ì¸í•´ë³´ì„¸ìš”:\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/img/2024-05-20-BuildingaReal-TimeDataPipeline_3.png\",\n        alt: \"ì´ë¯¸ì§€\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ê³„ì† ì½ì–´ ë³´ë©´ ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ì§€ ì•Œ ìˆ˜ ìˆì–´ìš”...\"\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"ë°œí–‰ì\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ë°œí–‰ì ìŠ¤í¬ë¦½íŠ¸ëŠ” ë°ì´í„°ë¥¼ Kafkaë¡œ ë³´ë‚´ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. ì „ì²´ íŒŒì¼ì€ ì—¬ê¸°ì—ì„œ ì°¾ì„ ìˆ˜ ìˆì–´ìš”. ì¼ë¶€ êµ¬ì„±ì„ ì„¤ì •í•œ í›„, íŒŒì¼ì„ ì‹œì‘í•˜ëŠ” ì§€ì ì¸ ì•„ë˜ìª½ì—ì„œ ì—¬ì •ì„ ì‹œì‘í•´ìš”:\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" __name__ == \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"__main()\\\"\"\n        }), \":\\n    producer = \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"create_producer\"\n        }), \"(bootstrap_servers)\\n    \\n    \", _jsx(_components.span, {\n          className: \"hljs-attr\",\n          children: \"try\"\n        }), \":\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"process_files_and_send\"\n        }), \"(producer, topics, batch_size)\\n    \", _jsx(_components.span, {\n          className: \"hljs-attr\",\n          children: \"finally\"\n        }), \":\\n        producer.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"close\"\n        }), \"()\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì¹´í”„ì¹´ í”„ë¡œë“€ì„œë¥¼ producerë¡œ ì¸ìŠ¤í„´ìŠ¤í™”í•˜ê³  ì„œë²„ ì„¸ë¶€ ì •ë³´ë¥¼ ì „ë‹¬í–ˆìŠµë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ íŒŒì¼ì„ ì²˜ë¦¬í•˜ë ¤ê³  ì‹œë„í•˜ê³  ì™„ë£Œë˜ë©´ ì—°ê²°ì„ ë‹«ìŠµë‹ˆë‹¤. ê°„ë‹¨í•˜ì£ ! ì´ì œ íŒŒì¼ì˜ ë§¨ ìœ„ë¡œ ëŒì•„ê°€ì„œ ê° í•¨ìˆ˜ë¥¼ í•˜ë‚˜ì”© ì‘ì—…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"create_producer\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"create_producer\"\n        }), \"(bootstrap_servers):\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"KafkaProducer\"\n        }), \"(\\n        bootstrap_servers=bootstrap_servers,\\n        value_serializer=lambda \", _jsx(_components.span, {\n          className: \"hljs-attr\",\n          children: \"v\"\n        }), \": json.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"dumps\"\n        }), \"(v).\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"encode\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"utf-8\\\"\"\n        }), \")\\n    )\\n\"]\n      })\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì—¬ê¸°ì—ëŠ” ê·¸ë‹¤ì§€ ë§ì€ ë‚´ìš©ì´ ì—†ì–´ìš”. ì €ëŠ” ë‹¨ìˆœíˆ KafkaProducerë¥¼ í•¨ìˆ˜ë¡œ ë˜í•‘í•˜ì—¬ ì œ ê°œì¸ì ì¸ ê²ƒìœ¼ë¡œ ë§Œë“¤ì—ˆì–´ìš”. ì„œë²„ ì„¸ë¶€ ì •ë³´ë¥¼ ì „ë‹¬í•˜ê³ , ë§¤ê°œë³€ìˆ˜ì¸ vë¥¼ ì·¨í•˜ê³  í•´ë‹¹ ë§¤ê°œë³€ìˆ˜ë¡œ ì „ë‹¬ëœ ë‚´ìš©ì„ JSONìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ëŒë‹¤ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í–ˆì–´ìš”. ê·¸ JSONì€ UTF-8ë¡œ ì¸ì½”ë”©ë˜ì–´ìš”. ë§ì€ ë°ì´í„° ì²˜ë¦¬ í•¨ìˆ˜ê°€ ë¬¸ìì—´ ëŒ€ì‹  ë°”ì´íŠ¸ í˜•ì‹ì˜ ë°ì´í„°ë¥¼ ì˜ˆìƒí•˜ê¸° ë•Œë¬¸ì— ì´ê²ƒì€ í•„ìˆ˜ì ì…ë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"send_messages\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"send_messages\"\n        }), \"(producer, topic, messages):\\n    \", _jsx(_components.span, {\n          className: \"hljs-attr\",\n          children: \"try\"\n        }), \":\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" message \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"in\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-attr\",\n          children: \"messages\"\n        }), \":\\n            producer.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"send\"\n        }), \"(topic, value=message)\\n        producer.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"flush\"\n        }), \"()\\n        logging.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"info\"\n        }), \"(f\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"Batch of messages sent to topic '{topic}'.\\\"\"\n        }), \")\\n    except \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Exception\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"as\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-attr\",\n          children: \"e\"\n        }), \":\\n        logging.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"error\"\n        }), \"(f\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"Failed to send messages to topic '{topic}'. Error: {e}\\\"\"\n        }), \")\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì €ëŠ” ì•„ì§ í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— ë‹¤ìŒì— ì´ê²ƒì„ ì„¤ì •í•˜ê³  ìˆì–´ìš”. ì‹¤ì œë¡œ ì‚¬ìš©ë  ë•Œ ë¯¸ë¦¬ ë¡œë“œë˜ê³  ì¤€ë¹„ë˜ì–´ ìˆì–´ì•¼ í•´ìš”. ì—¬ê¸°ì„œëŠ” Kafkaë¡œ ë°ì´í„°ë¥¼ ì „ì†¡í•˜ë ¤ê³  ë…¸ë ¥í•´ìš”. ê° ë©”ì‹œì§€ë§ˆë‹¤ Kafka Producerë¥¼ ì‚¬ìš©í•˜ê³  ë©”ì‹œì§€ë¥¼ ì£¼ì œë¡œ ë³´ë‚´ìš”. ê·¸ëŸ° ë‹¤ìŒ ë³´ë‚¸ ê²ƒì„ ê¸°ë¡í•˜ê±°ë‚˜ í•„ìš”í•œ ê²½ìš° ë°œìƒí•œ ì˜¤ë¥˜ë¥¼ ê¸°ë¡í•´ ë‚´ìš©ì´ ì˜ëª»ëëŠ”ì§€ ì¡°ì‚¬í•  ìˆ˜ ìˆì–´ìš”.\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"process_files_and_send\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"process_files_and_send\"\n        }), \"(producer, topics, batch_size):\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" topic \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"in\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-attr\",\n          children: \"topics\"\n        }), \":\\n        \", _jsx(_components.span, {\n          className: \"hljs-attr\",\n          children: \"try\"\n        }), \":\\n            \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"with\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"open\"\n        }), \"(f\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"{raw_path}/{topic}.csv\\\"\"\n        }), \", encoding=\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"utf-8-sig\\\"\"\n        }), \") \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"as\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-attr\",\n          children: \"csvfile\"\n        }), \":\\n                csvreader = csv.\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"DictReader\"\n        }), \"(csvfile)\\n                batch = []\\n\\n                \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" rows \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"in\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-attr\",\n          children: \"csvreader\"\n        }), \":\\n                    batch.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"append\"\n        }), \"(rows)\\n                    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"len\"\n        }), \"(batch) >= \", _jsx(_components.span, {\n          className: \"hljs-attr\",\n          children: \"batch_size\"\n        }), \":\\n                        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"send_messages\"\n        }), \"(producer, topic, batch)\\n                        batch = []\\n\\n                # \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Send\"\n        }), \" any remaining messages \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"in\"\n        }), \" the last batch\\n                \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-attr\",\n          children: \"batch\"\n        }), \":\\n                    \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"send_messages\"\n        }), \"(producer, topic, batch)\\n\\n        except \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"FileNotFoundError\"\n        }), \":\\n            logging.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"error\"\n        }), \"(f\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"File not found: {raw_path}/{topic}.csv\\\"\"\n        }), \")\\n        except \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Exception\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"as\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-attr\",\n          children: \"e\"\n        }), \":\\n            logging.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"error\"\n        }), \"(f\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"Error processing file for topic '{topic}': {e}\\\"\"\n        }), \")\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì—¬ê¸°ê°€ ë²ˆì¡í•œ ë¶€ë¶„ì´ê³ , ë°ì´í„°ë¥¼ ë³´ë‚´ëŠ” ì‘ì—…ì„ ë§ˆì¹˜ê²Œ ë  ê±°ì•¼.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì œê°€ í”„ë¡œë“€ì„œë¥¼ ë§¨ ì²˜ìŒì— ì¸ìŠ¤í„´ìŠ¤í™”í•  ë•Œ ì „ë‹¬í•˜ê³ , í† í”½ë“¤ë„ í•¨ê»˜ ì „ë‹¬í•´ì£¼ëŠ” í•¨ìˆ˜ë¥¼ ë§Œë“¤ì—ˆì–´ìš”. ê·¸ëŸ° ë‹¤ìŒ ê° í† í”½ì„ ìˆœíšŒí•˜ë©´ì„œ ì²˜ë¦¬í•´ìš”. ê° í† í”½ì€ csv íŒŒì¼ê³¼ ê´€ë ¨ì´ ìˆê¸° ë•Œë¬¸ì—, ë¨¼ì € íŒŒì¼ì„ ì—´ë ¤ê³  ì‹œë„í•˜ëŠ” ê±°ì£ .\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ë°°ì¹˜ í¬ê¸°ë¥¼ ì…ë ¥ ë§¤ê°œë³€ìˆ˜ë¡œ ì •ì˜í–ˆë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆì„ ê²ë‹ˆë‹¤. ì´ê±´ ì •ë§ í•„ìˆ˜ì ì¸ ê²ƒì€ ì•„ë‹ˆì§€ë§Œ, csv íŒŒì¼ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ëŒ€ì‹ ì— ì›¹í˜ì´ì§€ë‚˜ ë‹¤ë¥¸ ìŠ¤íŠ¸ë¦¬ë° ì„œë¹„ìŠ¤ì—ì„œ ê°€ì ¸ì˜¤ëŠ” ê²ƒì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì—, ë©”ì‹œì§€ë¥¼ ë°°ì¹˜ë¡œ ë¬¶ì–´ì„œ ê·¸ë£¹ìœ¼ë¡œ ë³´ë‚´ê³  ì‹¶ì—ˆìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ì‘ì—…ì´ ë¹¨ë¼ì§‘ë‹ˆë‹¤. ì €ëŠ” toml íŒŒì¼ ë‚´ì—ì„œ ë°°ì¹˜ í¬ê¸°ë¥¼ 10ìœ¼ë¡œ ì„¤ì •í–ˆëŠ”ë°, ì´ëŠ” ì‚¬ì‹¤ìƒ í•œ ë²ˆì— csv íŒŒì¼ì˜ 10ì¤„ì— í•´ë‹¹í•©ë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ê·¸ëŸ° ë‹¤ìŒ ê° í–‰ì„ ë°°ì¹˜ì— ì¶”ê°€í•˜ë©´ì„œ ë°°ì¹˜ í•œë„ì— ë„ë‹¬í•  ë•Œê¹Œì§€ ì‘ì—…ì„ ìˆ˜í–‰í•œ í›„ ë°ì´í„°ë¥¼ ì „ì†¡í•˜ê³  ë°°ì¹˜ë¥¼ ë¹„ì›ë‹ˆë‹¤. ì‘ì—…ì„ ë§ˆì¹˜ë©´ ë§ˆì§€ë§‰ ë©”ì‹œì§€ë¡œ ë°°ì¹˜ë¥¼ ì •ë¦¬í•©ë‹ˆë‹¤ (ë‚¨ì€ ë ˆì½”ë“œê°€ 5ê°œë§Œ ë‚¨ì•˜ì„ ìˆ˜ ìˆì§€ë§Œ, ê·¸ë˜ë„ ëª¨ë‘ ë³´ë‚´ê³  ì‹¶ìŠµë‹ˆë‹¤).\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ë§ˆì§€ë§‰ìœ¼ë¡œ, raw íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ëŠ” ê²½ìš°ë‚˜ ë°œìƒí•  ìˆ˜ ìˆëŠ” ê¸°íƒ€ ì¼ë°˜ì ì¸ ì˜¤ë¥˜ì— ëŒ€í•œ ì˜¤ë¥˜ ì²˜ë¦¬ê°€ ìˆìŠµë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì´ê²ƒì´ publisher.py íŒŒì¼ì˜ ë‚´ìš©ì…ë‹ˆë‹¤. ì´í•´ê°€ ë˜ì‹œê² ë‚˜ìš”? ì´ì œ subscriber.py íŒŒì¼ë¡œ ë„˜ì–´ê°€ ë´…ì‹œë‹¤!\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"êµ¬ë…ì\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"êµ¬ë…ìëŠ” Kafka ì£¼ì œë¥¼ ì²­ì·¨í•˜ê³ , ìƒˆ ë ˆì½”ë“œë¥¼ ë°œê²¬í–ˆì„ ë•Œ íŠ¹ì • ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. ì´ ê²½ìš°, í•´ë‹¹ ë ˆì½”ë“œì˜ ë‚´ìš©ì„ ê°€ì ¸ì™€ Delta í…Œì´ë¸”ì— ì €ì¥í•©ë‹ˆë‹¤. ì—¬ê¸°ì„œ ì „ì²´ ì½”ë“œë¥¼ ì°¾ì„ ìˆ˜ ìˆëŠ” ì½”ë“œë¥¼ í†µí•´ ì½”ë“œë¥¼ í•˜ë‚˜ì”© ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" __name__ == \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"__main__\\\"\"\n        }), \":\\n    consumer = \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"create_consumer\"\n        }), \"(topics, bootstrap_servers)\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"for\"\n        }), \" message \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"in\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-attr\",\n          children: \"consumer\"\n        }), \":\\n        \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"process_message\"\n        }), \"(message.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"topic\"\n        }), \", message.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"value\"\n        }), \")\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ë°œí–‰ìì™€ ë¹„ìŠ·í•˜ê²Œ, ì²« ë²ˆì§¸ë¡œ í•˜ëŠ” ì¼ì€ ì£¼ì œ ë° ì„œë²„ ì„¸ë¶€ ì •ë³´ë¥¼ êµ¬ì„± ë³€ìˆ˜ë¡œ ì œê³µí•˜ê³ , ì´ë¥¼ ì „ë‹¬í•˜ì—¬ ì†Œë¹„ìë¥¼ ì¸ìŠ¤í„´ìŠ¤í™”í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ ì†Œë¹„í•œ ê° ë©”ì‹œì§€ë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤. ê°„ë‹¨í•˜ì§€ìš”. í•˜ì§€ë§Œ í•¨ìˆ˜ë³„ë¡œ ì¢€ ë” ìì„¸íˆ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"ì†Œë¹„ì ìƒì„±\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"def \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"create_consumer\"\n        }), \"(topics, bootstrap_servers):\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"KafkaConsumer\"\n        }), \"(\\n        *topics,\\n        bootstrap_servers = bootstrap_servers,\\n        value_deserializer = lambda \", _jsx(_components.span, {\n          className: \"hljs-attr\",\n          children: \"v\"\n        }), \": json.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"loads\"\n        }), \"(v.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"decode\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"utf-8\\\"\"\n        }), \"))\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ìš°ë¦¬ Pythonì˜ ì§„ì…ì ì—ì„œ ì²« ë²ˆì§¸ ì¤„ì€ ì†Œë¹„ìë¥¼ ì¸ìŠ¤í„´ìŠ¤í™”í•˜ëŠ” ê²ƒì´ì—ˆìŠµë‹ˆë‹¤. ì´ê²ƒì€ ê¸°ë³¸ì ìœ¼ë¡œ KafkaConsumerì˜ ë˜í¼ì¼ ë¿ì…ë‹ˆë‹¤. í¼ë¸”ë¦¬ì…”ì™€ ë‹¤ë¥¸ ê²ƒì€ ì•„ë¬´ ê²ƒë„ í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"ë©”ì‹œì§€ ì²˜ë¦¬\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-python\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"def\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"process_message\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"topic, data\"\n        }), \"):\\n    df = pl.from_records([data])\\n    delta_table_path = \", _jsxs(_components.span, {\n          className: \"hljs-string\",\n          children: [\"f\\\"\", _jsx(_components.span, {\n            className: \"hljs-subst\",\n            children: \"{delta_path}\"\n          }), \"/\", _jsx(_components.span, {\n            className: \"hljs-subst\",\n            children: \"{topic}\"\n          }), \"\\\"\"]\n        }), \"\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"not\"\n        }), \" os.path.exists(delta_table_path):\\n        write_delta_table(df, delta_table_path, \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"insert\\\"\"\n        }), \")\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"else\"\n        }), \":\\n        merge_into_delta_table(df, delta_table_path)\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ë©”ì‹œì§€ë¥¼ ë°›ì„ ë•Œë§ˆë‹¤ ê·¸ê²ƒì„ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ì•¼ í•©ë‹ˆë‹¤. ì €ëŠ” ì—¬ê¸°ì„œ ë‘ ê°€ì§€ ë°©ë²•ì„ ì„ íƒí–ˆìŠµë‹ˆë‹¤. ë¨¼ì € Delta í…Œì´ë¸”ì´ ì €ì¥ëœ ê²½ë¡œë¥¼ ê°€ì ¸ì™€ í•´ë‹¹ ê²½ë¡œê°€ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤. ê²½ë¡œê°€ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ ìƒˆ ë ˆì½”ë“œë¥¼ ì‚½ì…í•˜ê¸° ìœ„í•´ insert ë§¤ê°œë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ write_delta_table í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ê²½ë¡œê°€ ì´ë¯¸ ì¡´ì¬í•œë‹¤ë©´, merge_into_delta_table í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ì—¬ëŸ¬ ë²ˆë¡œë“œí•  ìˆ˜ ìˆê²Œ í•˜ë©´ì„œ ë‹¨ìˆœíˆ í…Œì´ë¸”ì„ ì ì  ë” í¬ê²Œ ë§Œë“¤ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ë¯¸ ë³€ê²½ëœ ê¸°ì¡´ í•­ëª©ì„ ì—…ë°ì´íŠ¸í•˜ê³  ìƒˆ ë ˆì½”ë“œë§Œ ì¶”ê°€í•©ë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì´ëŸ¬í•œ í•¨ìˆ˜ë“¤ì„ ì¢€ ë” ìì„¸íˆ ì‚´í´ë´…ì‹œë‹¤.\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"write_delta_table\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-python\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"def\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"write_delta_table\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"df, path, mode\"\n        }), \"):\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"try\"\n        }), \":\\n        df.write_delta(target=path, mode=mode)\\n        logging.info(\", _jsxs(_components.span, {\n          className: \"hljs-string\",\n          children: [\"f\\\"\", _jsx(_components.span, {\n            className: \"hljs-subst\",\n            children: \"{mode.capitalize()}\"\n          }), \"ed message to Delta table: \", _jsx(_components.span, {\n            className: \"hljs-subst\",\n            children: \"{df}\"\n          }), \"\\\"\"]\n        }), \")\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"except\"\n        }), \" Exception \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"as\"\n        }), \" e:\\n        logging.error(\", _jsxs(_components.span, {\n          className: \"hljs-string\",\n          children: [\"f\\\"Failed to \", _jsx(_components.span, {\n            className: \"hljs-subst\",\n            children: \"{mode}\"\n          }), \" message to Delta table: \", _jsx(_components.span, {\n            className: \"hljs-subst\",\n            children: \"{df}\"\n          }), \"\\\"\"]\n        }), \")\\n        logging.error(\", _jsxs(_components.span, {\n          className: \"hljs-string\",\n          children: [\"f\\\"Error: \", _jsx(_components.span, {\n            className: \"hljs-subst\",\n            children: \"{e}\"\n          }), \"\\\"\"]\n        }), \")\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"í…Œì´ë¸” íƒœê·¸ë¥¼ ë§ˆí¬ë‹¤ìš´ í˜•ì‹ìœ¼ë¡œ ë³€ê²½í•´ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì—¬ê¸°ì„œëŠ” DataFrame, ì£¼ì œ ê²½ë¡œ, ê·¸ë¦¬ê³  ëª¨ë“œ(ì‚½ì…)ë¥¼ ê°„ë‹¨íˆ ì „ë‹¬í•˜ê³  ë„¤ì´í‹°ë¸Œ Polars ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì—¬ Delta í…Œì´ë¸”ì— ì‘ì„±í•©ë‹ˆë‹¤. ì‘ì—…ì´ ì„±ê³µí–ˆìŒì„ ë¡œê·¸ì— ë‚¨ê¸°ê±°ë‚˜ ì‹¤íŒ¨í–ˆì„ ë•Œ ì˜¤ë¥˜ë¥¼ ìº¡ì²˜í•˜ì—¬ ì¡°ì‚¬í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"merge_into_delta_table\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì—¬ê¸°ì—ëŠ” ì¡°ê¸ˆ ë” ìˆìŠµë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-python\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"def\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"merge_into_delta_table\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"df, path\"\n        }), \"):\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"try\"\n        }), \":\\n        df.write_delta(\\n            target=path, mode=\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"merge\\\"\"\n        }), \",\\n            delta_merge_options={\\n                \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"predicate\\\"\"\n        }), \": \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"s.id = t.id\\\"\"\n        }), \",\\n                \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"source_alias\\\"\"\n        }), \": \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"s\\\"\"\n        }), \",\\n                \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"target_alias\\\"\"\n        }), \": \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"t\\\"\"\n        }), \",\\n            }\\n        ).when_matched_update_all().when_not_matched_insert_all().execute()\\n        logging.info(\", _jsxs(_components.span, {\n          className: \"hljs-string\",\n          children: [\"f\\\"Merged message to Delta table: \", _jsx(_components.span, {\n            className: \"hljs-subst\",\n            children: \"{df}\"\n          }), \"\\\"\"]\n        }), \")\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"except\"\n        }), \" Exception \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"as\"\n        }), \" e:\\n        logging.error(\", _jsxs(_components.span, {\n          className: \"hljs-string\",\n          children: [\"f\\\"Failed to merge message to Delta table: \", _jsx(_components.span, {\n            className: \"hljs-subst\",\n            children: \"{df}\"\n          }), \"\\\"\"]\n        }), \")\\n        logging.error(\", _jsxs(_components.span, {\n          className: \"hljs-string\",\n          children: [\"f\\\"Error: \", _jsx(_components.span, {\n            className: \"hljs-subst\",\n            children: \"{e}\"\n          }), \"\\\"\"]\n        }), \")\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì—¬ê¸°ì—ì„œ ëª¨ë“œë¥¼ ì „ë‹¬í•˜ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤. ì™œëƒí•˜ë©´ ëª¨ë“œê°€ \\\"merge\\\"ë¡œ ì„¤ì •ë  ê²ƒì´ë¼ëŠ” ê²ƒì„ ì•Œê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ì œ ëª¨ë“  í…Œì´ë¸”ì—ëŠ” idë¼ëŠ” ë™ì¼í•œ ì´ë¦„ì„ ê°€ì§„ ê¸°ë³¸ í‚¤ê°€ ìˆìœ¼ë¯€ë¡œ í•œ ë²ˆ ì •ì˜í•˜ê³  ì´ í•¨ìˆ˜ë¥¼ ì™„ì „íˆ ì¬ì‚¬ìš©í•˜ê¸° ì‰½ìŠµë‹ˆë‹¤. ì¼ì¹˜í•˜ëŠ” ê²½ìš° ë°ì´í„°ê°€ ì—…ë°ì´íŠ¸ë˜ê³ , ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ê²½ìš° ë°ì´í„°ê°€ ì‚½ì…ë©ë‹ˆë‹¤. ì´ê²ƒì´ ê¸°ë³¸ì ìœ¼ë¡œ upsertì…ë‹ˆë‹¤. ì„±ê³µê³¼ ì‹¤íŒ¨ë¥¼ ì—¬ì „íˆ ê¸°ë¡í–ˆìŠµë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì—¬ê¸°ê°€ íŒŒì´í”„ë¼ì¸ì˜ ì „ë¶€ì…ë‹ˆë‹¤. ì •ë§ ê°„ë‹¨í•©ë‹ˆë‹¤. ë°ì´í„°ë¥¼ ê²Œì‹œí•˜ê³  ë°ì´í„°ë¥¼ êµ¬ë…í•˜ì—¬ ë””ìŠ¤í¬ì— ì €ì¥í•©ë‹ˆë‹¤. ë‹¤ìŒì—ëŠ” í•´ë‹¹ ë°ì´í„°ë¥¼ ì¿¼ë¦¬í•˜ê³  ëª¨ë“  ê²ƒì„ í•¨ê»˜ ê°€ì ¸ì˜¤ëŠ” DataFrameì„ ê°€ì ¸ì˜¤ëŠ” ë°©ë²•ì„ ì‚´í´ë³¼ ê²ƒì…ë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"ì¿¼ë¦¬\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì´ ì‹œì ì—ì„œ KafkaëŠ” ë” ì´ìƒ ì‚¬ìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ëª¨ë“  ê²ƒì´ Delta í…Œì´ë¸”ì— ìˆìœ¼ë©° ì¿¼ë¦¬ë§Œ í•„ìš”í•©ë‹ˆë‹¤. ì „ì²´ ì½”ë“œëŠ” ì—¬ê¸°ì— ìˆìŠµë‹ˆë‹¤. Delta í…Œì´ë¸”ì„ ê°ê° ë°ì´í„°í”„ë ˆì„ ì§‘í•©ìœ¼ë¡œ ë¶ˆëŸ¬ì˜¤ê¸° ì‹œì‘í–ˆìŠµë‹ˆë‹¤:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"client = pl.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"read_delta\"\n        }), \"(f\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"{delta_path}/client\\\"\"\n        }), \")\\ndepartment = pl.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"read_delta\"\n        }), \"(f\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"{delta_path}/department\\\"\"\n        }), \")\\nemployee = pl.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"read_delta\"\n        }), \"(f\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"{delta_path}/employee\\\"\"\n        }), \")\\nsale = pl.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"read_delta\"\n        }), \"(f\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"{delta_path}/sale\\\"\"\n        }), \")\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"clientì™€ employee ë°ì´í„°í”„ë ˆì„ì—ëŠ” first_nameê³¼ last_name ì†ì„±ì´ ê°™ìŠµë‹ˆë‹¤. ë°ì´í„°í”„ë ˆì„ ì´ë¦„ ì™¸ì—ëŠ” êµ¬ë³„í•  ìš”ì†Œê°€ ì—†ìŠµë‹ˆë‹¤. ê°ê°ì— first_nameê³¼ last_nameì„ ë¶™ì—¬ ê³µë°±ì„ êµ¬ë¶„ìë¡œ ì‚¬ìš©í•œ ìƒˆë¡œìš´ ì†ì„±ì„ ì¶”ê°€í•˜ê³  ì ì ˆíˆ ì´ë¦„ì„ ì§€ì—ˆìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ë‘ ë°ì´í„°í”„ë ˆì„ì„ í•˜ë‚˜ì˜ ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ê²°í•©í•  ë•Œ ë¬´ì—‡ì´ ë¬´ì—‡ì¸ì§€ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"client = client.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"with_columns\"\n        }), \"(\\n    pl.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"concat_str\"\n        }), \"([\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"first_name\\\"\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"last_name\\\"\"\n        }), \"], separator = \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\" \\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"alias\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"client_name\\\"\"\n        }), \")\\n    )\\n\\nemployee = employee.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"with_columns\"\n        }), \"(\\n    pl.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"concat_str\"\n        }), \"([\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"first_name\\\"\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"last_name\\\"\"\n        }), \"], separator = \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\" \\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"alias\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"employee_name\\\"\"\n        }), \")\\n    )\\n\"]\n      })\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì§ì› DataFrameì—ëŠ” department_idë¼ëŠ” ì¶”ê°€ ì†ì„±ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ì‚¬ìš©í•˜ì—¬ ì§ì›ê³¼ ë¶€ì„œë¥¼ í•¨ê»˜ ê²°í•©í•œ ìƒˆ DataFrameì„ ìƒì„±í•  ìˆ˜ ìˆì–´ìš”:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"employee_dept = employee.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"join\"\n        }), \"(\\n        department, \\n        left_on = \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"department_id\\\"\"\n        }), \", \\n        right_on = \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"id\\\"\"\n        }), \", \\n        how = \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"inner\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"select\"\n        }), \"(\\n                [\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"id\\\"\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"employee_name\\\"\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"department_id\\\"\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"department\\\"\"\n        }), \"]\\n                )\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì§ì› DataFrameì„ ê¸°ë°˜ìœ¼ë¡œ, ë¶€ì„œ DataFrameê³¼ ì¡°ì¸ì„ ìƒì„±í–ˆëŠ”ë°, ì§ì› DataFrameì˜ department_idì™€ ë¶€ì„œ DataFrameì˜ idë¥¼ ì¼ì¹˜í•˜ëŠ” ì¡°ì¸ ì¡°ê±´ìœ¼ë¡œ ì§€ì •í–ˆì–´ìš”. ëª¨ë“  ì§ì›ì´ ë¶€ì„œë¥¼ ê°€ì ¸ì•¼ í•˜ê¸° ë•Œë¬¸ì— INNER JOINì„ ì¡°ì¸ ìœ í˜•ìœ¼ë¡œ ì„ íƒí–ˆê³ , ì´í›„ ìœ ì§€í•  ì†ì„±ì„ ì„ íƒí–ˆì–´ìš”.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ë§ˆì§€ë§‰ìœ¼ë¡œ, í•œ ë§ˆì§€ë§‰ ë¬¸ì¥ìœ¼ë¡œ ëª¨ë‘ í•¨ê»˜ ê²°í•©í•  ìˆ˜ ìˆì–´ìš”:\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"complete = sale.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"join\"\n        }), \"(\\n        employee_dept,\\n        left_on = \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"employee_id\\\"\"\n        }), \", \\n        right_on = \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"id\\\"\"\n        }), \", \\n        ).\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"join\"\n        }), \"(\\n                client, \\n                left_on = \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"client_id\\\"\"\n        }), \", \\n                right_on = \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"id\\\"\"\n        }), \", \\n                how = \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"inner\\\"\"\n        }), \"\\n                ).\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"select\"\n        }), \"(\\n                        pl.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"col\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"id\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"str\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"to_integer\"\n        }), \"(),\\n                        pl.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"col\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"employee_name\\\"\"\n        }), \"), \\n                        pl.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"col\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"department\\\"\"\n        }), \"), \\n                        pl.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"col\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"client_name\\\"\"\n        }), \"), \\n                        pl.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"col\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"date\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"str\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"to_date\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"%d/%m/%Y\\\"\"\n        }), \"), \\n                        pl.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"col\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"region\\\"\"\n        }), \"), \\n                        pl.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"col\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"sale\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"str\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"to_decimal\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \"),\\n                        )\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì €ëŠ” sale DataFrameì—ì„œ ì‹œì‘í•˜ì—¬ ë°©ê¸ˆ ìƒì„±í•œ employee_dept DataFrameì— ì¡°ì¸ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. ì´ì œ ì´ëŠ” sale, employee ë° departmentë¥¼ ê²°í•©í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ client DataFrameì„ ë‹¤ì‹œ ì¡°ì¸í•œ ë‹¤ìŒ ì›í•˜ëŠ” ì†ì„±ì„ ì„ íƒí•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì´ ê²½ìš° ë°ì´í„° ìœ í˜•ì„ ë³€ê²½í–ˆìŠµë‹ˆë‹¤. ë°ì´í„°ëŠ” csvë¥¼ í†µí•´ ê°€ì ¸ì˜¨ ê²ƒì´ê¸° ë•Œë¬¸ì— ì›ë˜ ë°ì´í„° ìœ í˜•ì´ ì—†ì—ˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ idëŠ” ì •ìˆ˜ì´ì–´ì•¼ í•œë‹¤ê³  ì§€ì •í–ˆìŠµë‹ˆë‹¤. ë‚ ì§œëŠ” ë‚ ì§œ ìœ í˜•ì´ì–´ì•¼ í•˜ë©°, í˜•ì‹ì„ ì§€ì •í–ˆìœ¼ë©°, sale ì†ì„±ì´ ë‘ ìë¦¬ ì†Œìˆ˜ì (ë‹¬ëŸ¬ ë° ì„¼íŠ¸)ì¸ ê²ƒì„ ì§€ì •í–ˆìŠµë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ë§ˆì§€ë§‰ ë‹¨ê³„ëŠ” ê²°ê³¼ë¥¼ ì¶œë ¥í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤:\"\n    }), \"\\n\", _jsx(\"img\", {\n      src: \"/assets/img/2024-05-20-BuildingaReal-TimeDataPipeline_4.png\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"ê²°ë¡ \"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ë³¸ ê¸€ì—ì„œëŠ” Kafka, Polars, ê·¸ë¦¬ê³  Delta Lakeë¥¼ í™œìš©í•˜ì—¬ ì‹¤ì‹œê°„ ë°ì´í„° íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•˜ëŠ” ë°©ë²•ì„ ì‚´í´ë³´ì•˜ìŠµë‹ˆë‹¤. ë©”ì‹œì§€ ìŠ¤íŠ¸ë¦¬ë°ì„ ìœ„í•´ Kafkaë¥¼ í™œìš©í•˜ê³ , ë°ì´í„° ì²˜ë¦¬ë¥¼ ìœ„í•´ Polarsë¥¼ ì‚¬ìš©í•˜ë©°, ì•ˆì •ì ì¸ ì €ì¥ì†Œë¡œ Delta Lakeë¥¼ í™œìš©í•˜ì—¬ í™•ì¥ ê°€ëŠ¥í•˜ê³  ì˜¤ë¥˜ í—ˆìš©ì„± ìˆëŠ” ë°ì´í„° íŒŒì´í”„ë¼ì¸ì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì €ì¥ì†Œì˜ ì½”ë“œ ìƒ˜í”Œì€ íŒŒì´í”„ë¼ì¸ì˜ ê¸°ë³¸ ì„¤ì •ê³¼ ê¸°ëŠ¥ì„ ë³´ì—¬ì¤ë‹ˆë‹¤. ë°ì´í„° ë³´ì¡´ ì •ì±… êµ¬ì„±, S3 ê°ì²´ ì €ì¥ì†Œì— ë°ì´í„° ë³´ê´€, ë‹¤ë¥¸ ì‹œìŠ¤í…œê³¼ í†µí•©í•˜ëŠ” ë“± íŠ¹ì • ìš”êµ¬ ì‚¬í•­ì— ë§ê²Œ ì½”ë“œë¥¼ í™•ì¥í•˜ê³  ì‚¬ìš©ìí™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì´ ì•„í‚¤í…ì²˜ë¥¼ ì±„íƒí•¨ìœ¼ë¡œì¨ ê¸°ì—…ì€ ì‹¤ì‹œê°„ ë°ì´í„°ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ê³  ë¶„ì„í•˜ì—¬ ë°ì´í„° ê¸°ë°˜ ê²°ì •ì„ ë‚´ë¦¬ê³  ì‹ ì†í•˜ê²Œ ë³€í™”ì— ëŒ€ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ì´ ê¸€ì´ ìœ ìš©í–ˆê¸¸ ë°”ëë‹ˆë‹¤. ë§Œì•½ ê·¸ë ‡ë‹¤ë©´ ğŸ‘ í•œ ë²ˆ ëˆŒëŸ¬ì£¼ì‹œê² ì–´ìš”? ê·¸ë¦¬ê³  ë” ë³´ê³  ì‹¶ìœ¼ë©´ êµ¬ë…í•´ì£¼ì„¸ìš”. ë§¤ì£¼ í•œ ë‘ í¸ì˜ ê¸€ì„ ì—…ë¡œë“œí•˜ê³  ìˆì–´ìš”.\"\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{}}},"__N_SSG":true}