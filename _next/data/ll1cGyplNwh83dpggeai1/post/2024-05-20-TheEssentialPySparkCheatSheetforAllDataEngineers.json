{"pageProps":{"post":{"title":"모든 데이터 엔지니어를 위한 필수 PySpark 차트 시트","description":"","date":"2024-05-20 16:59","slug":"2024-05-20-TheEssentialPySparkCheatSheetforAllDataEngineers","content":"\n\n## 모든 Pyspark 스크립트 작성을 수정하고, 시간을 절약한 상태로 현명하게 연습하세요.\n\n\"일을 맹목적으로 끝내는 것보다는 최적의 효율성과 효과적인 방법으로 실행하는 것이 중요합니다.\"\n\n여기 제공된 치트 시트는 PySpark의 주요 측면을 신속하게 검토하고, 인터뷰 준비 또는 Databricks나 Python 기반 코딩 환경과 같은 다양한 플랫폼에서 데이터 분석 작업에 대비할 수 있게 돕습니다.\n\n이 도구를 이용하면 PySpark 및 관련 프레임워크에 필수적인 중요한 변환 기술 및 데이터 분석 방법론을 신속하게 검토할 수 있습니다.\n\n<div class=\"content-ad\"></div>\n\n## 시작해봅시다\n\nPySpark를 사용하여 변환 작업이나 데이터 분석 작업을 시작하기 전에 Spark 세션을 설정하는 것이 중요합니다. 이 초기 단계는 Spark 프레임워크 내에서 코드 실행의 기반을 제공합니다. 더 중요한 것은 후속 작업을 위한 기반을 구축하고 Spark 기능과 원활하게 상호 작용할 수 있도록 합니다.\n\n먼저 의도한 작업에 필요한 모듈을 가져와야 하며, 모든 중요한 구성 요소가 사용 가능하도록 보장해야 합니다. 이 기본 절차를 준수함으로써 개발자와 데이터 전문가는 PySpark의 강력한 기능을 활용하여 데이터 처리와 분석 작업을 원활하게 수행할 수 있습니다.\n\n## 시작해봅시다!!\n\n<div class=\"content-ad\"></div>\n\n```md\nfrom pyspark.sql import SparkSession\nfrom pyspark.sql import types\nfrom pyspark.sql.types import SparkType, StructField, StringType, IntegerType, DataType\nfrom pyspark.sql.functions import col, date, year, time, sum, avg, upper, count, Broadcast, expr\nfrom pyspark.sql import window\nfrom pyspark.sql import functions as F\n```\n\n```md\nspark = SparkSession.builder.appName(\"application\").getOrCreate()\n# read any file as given either csv, excel, parquet, or Avro any format of data\ndata = spark.read.csv(\"filePath\", header=True, inferschema=True) # if we want given data types as it is\nschema = StructType([StructField(\"id\", IntegerType), StructField(\"name\", StringType),\nStructField(\"dept\", StringType)]) # if we want our required data types then we use this \n# also for better performance of executions we will be using our custom schema rather depending on inferschema\n```\n\nLet’s kickstart our PySpark application by first creating a Spark Session, the entry point to PySpark functionality.\n\nWe’ll then proceed with performing various transformations and analyses on sample data.\n\n\n<div class=\"content-ad\"></div>\n\n```js\n데이터 = [(1, 'mahi', 100), (2, 'mahendra', 200), (3, 'harish', 300), (4, 'desh', 400)]\n\n스키마 = ['id', 'name', 'salary']\n# 데이터 프레임 생성\ndf = spark.createDataFrame(data, schema)\ndf.head()\ndf.show()\ndisplay(df)\n```\n\n![image](/assets/img/2024-05-20-TheEssentialPySparkCheatSheetforAllDataEngineers_0.png)\n\nPySpark에서 윈도우 함수를 사용하여 급여의 누적 합을 계산할 수 있습니다.\n\n```js\na = Window().orderBy('id')\n누적_합 = df.withColumn(\"cumulative_sum\", sum(\"salary\").over(a))\n결과 = cumulative_sum.orderBy('id')\n결과.show()\n```\n\n<div class=\"content-ad\"></div>\n\n```python\na = Window().orderBy('id')\n누적합 = df.withColumn(\"누적합\", avg(\"salary\").over(a))\n결과 = 누적합.orderBy('id')\n결과.show()\n```\n\n![이미지](/assets/img/2024-05-20-TheEssentialPySparkCheatSheetforAllDataEngineers_1.png)\n\n```python\nemp=[(1,'마히', 100,1),(2,'마헨드라', 200,2),(3,'하리쉬',300,3),\n(4,'데시',400,4)]\n\n스키마=['id', 'name', 'salary', 'dept_id']\n# 데이터 프레임 생성\ndf=spark.createDataFrame(data,schema)\ndf.head()\ndf.show()\ndisplay(df)\n\ndept=[(1,'인사'),(2,'영업'),(3,'데이터 분석'),(4,'IT')]\n스키마=['dept_id', 'department']\n부서=spark.createDataFrame(dept,schema)\ndisplay(부서)\n```\n\n![이미지](/assets/img/2024-05-20-TheEssentialPySparkCheatSheetforAllDataEngineers_2.png)\n\n\n<div class=\"content-ad\"></div>\n\n공통 속성인 dept_id를 사용하여 두 개의 데이터 프레임을 결합해 봅시다. 예시를 들어보겠습니다:\n\n```js\ndf=employee.join(department, \"dept_id\", \"inner\").select('id','name','salary','department')\ndisplay(df)\n```\n\n```js\ndf=employee.join(department, \"dept_id\", \"right\").select('name','department')\ndisplay(df)\n```\n\n<img src=\"/assets/img/2024-05-20-TheEssentialPySparkCheatSheetforAllDataEngineers_3.png\" />\n\n<div class=\"content-ad\"></div>\n\n위에서는 다양한 PySpark 변환, 액션 및 기능에 대해 상세히 설명하겠습니다. 실행 가능한 코드 예제와 함께 다룰 예정이에요.\n\n기본적인 변환인 필터링 및 그룹화부터 창 함수와 같은 고급 기술까지 다양한 작업을 다룰 거에요.\n\n각 코드 조각은 개념을 포괄적으로 이해할 수 있도록 설명하는 문장과 함께 제공됩니다.\n\n데이터 조작 작업부터 시작하여 PySpark 데이터 프레임을 사용하여 데이터 필터링, 선택 및 집계를 살펴보겠습니다. 그 후에는 조인, 정렬 및 창 함수와 같은 변환을 통해 다수의 테이블에서 데이터를 조작하고 분석하는 방법을 살펴볼 것입니다.\n\n<div class=\"content-ad\"></div>\n\n또한, 우리는 샘플 데이터셋을 활용하여 모델 학습과 평가를 통해 머신러닝 작업을 지원하는 Pyspark을 소개할 것입니다.\n\n이 치트 시트를 통해 각 코드 스니펫은 해당 개념의 실제 시연을 제공하여 빠른 참고와 이해를 돕게 됩니다.\n\n이 예제를 따라가며 사용자들은 Pyspark 능력을 향상시키고 데이터 엔지니어링 및 데이터 과학 인터뷰나 실제 데이터 처리 작업에 대비할 수 있습니다.\n\n## 필터링, 선택, 집계, 그룹화 및 정렬 조건:\n\n<div class=\"content-ad\"></div>\n\n```js\ndf = orders.join(products, \"order_id\", \"inner\") # 어떤 조인 적용\ndf.join(df2, '공통 열').groupBy('표시할 열').count().orderBy(desc('count'))\n\n\ndf1=df.groupBy(\"cust_id\").agg(sum(\"amount\").alias(\"bill\")) # 그룹화 함수 적용 및 집계 조건을 지정\n\ndf.groupBy(\"col1\").agg(count(\"col2\").alias(\"count\"), \n                          sum(\"col2\").alias(\"sum\"),\n                          max(\"col2\").alias(\"maximum\"),\n                          min(\"col2\").alias(\"minimum\"), \n                          avg(\"col2\").alias(\"average\")).show()\n\n\ndf.drop(\"column_name1\", \"column_name2\", \"column_name3\") # 열 삭제\ndf.drop(col(\"column_name\")) # 다른 열 삭제 방법\n\ndf.createOrReplaceTempView(\"원하는 이름 지정\") # 데이터 프레임을 테이블로 변환\n\ndf.orderBy(F.desc(\"column_name\")).first() # 특정 열(예: 급여)의 내림차순 첫 번째 행 반환\ndf.orderBy(col(\"column_name\").desc()).first() # 가장 높은 값을 반환하는 또 다른 방법\ndf.orderBy(col(\"column_name\").desc()).limit(5) # 상위 5개의 값을 반환\n\n# 원하는 열에 필터 적용\ndf.filter(df.column_name==값).show()\n\n# 필터링된 결과와 함께 필요한 열 선택\ndf.select(\"column1\", \"column2\", \"column3\").where(col(\"any column\")==\"any value\")\ndf.select(\"column1\").where(col(\"column1\")> 값).show(5)\ndf.sort(\"원하는 열 이름\")\n\n# 열 이름 변경\ndf.withcolumn Renamed(\"기존 열 이름\", \"원하는 열 이름으로 변경\")\n```\n\nPySpark는 데이터 프레임 내에서 날짜 속성을 추출하고 조작하는 편리한 방법을 제공하며, 사용자가 연도, 월, 일과 같은 다양한 기준으로 통찰력을 얻을 수 있도록 합니다.\n\n또한, 이러한 속성들은 오름차순이나 내림차순으로 정렬하여 분석과 시각화를 용이하게 할 수 있습니다.\n\n## 날짜 열에서 일, 월, 연도 추출하기: \n\n<div class=\"content-ad\"></div>\n\n\n# 데이터 프레임에서 연도, 월, 일 세부 정보 추출하기\ndf.select(year(\"date column\").distinct().orderBy(year(\"date column\")).show()\ndf.select(month(\"date column\").distinct().orderBy(month(\"date column\")).show()\ndf.select(day(\"date column\").distinct().orderBy(day(\"date column\")).show()\n\ndf.withColumn(\"orderyear\", year(\"df.date column\"))\ndf.withColumn(\"ordermonth\", month(\"df.date column\"))\ndf.withColumn(\"orderday\", day(\"df.date column\"))\ndf.withColumn(\"orderquarter\", quarter(\"df.date column\"))\n\n\n특정 열에서 null 값을 필터링하고 그 다음에 지정된 순서로 그룹화 작업을 수행하기 위해 조건을 적용할 수 있습니다.\n\n\ndf.select(\"column name we want to retrieve\").where(col(\"column name we want to retrieve\").isNotNull())\\\n.groupBy(\"column name we want to retrieve\").count().orderBy(\"count\", ascending=False).show(10)\n\n\n## 함수 작성하기:```\n\n<div class=\"content-ad\"></div>\n\n```js\ndf.write.format(\"CSV\").mode(\"overwrite\").save(\"원하는 파일 저장 경로\")\ndf.write.format(\"CSV\").mode(\"append\").save(\"원하는 파일 저장 경로\")\ndf.write.format(\"Parquet\").mode(\"overwrite\").save(\"원하는 파일 저장 경로\")\ndf.write.format(\"parquet\").mode(\"append\").save(\"원하는 파일 저장 경로\")\n```\n\n## 윈도우 함수:\n\n```js\nwind_a=Window.partitionBy(\"col1\").orderBy(\"col2\").rangeBetween(Window.unboundedpreceeding, 0)\n\ndf_w_coloumn= df.withColumn(\"col_sum\", F.sum(\"salary\").over(wind_a) #롤링 합계 또는 누적 합계:\n\n\n#행 번호\na=Window.orderBy(\"date_column\") #예시로 날짜 열을 고려하였지만 원하는 열을 선택할 수 있습니다\nsales_data=df.withColumn(\"row_number\", row_number().over(a))\n\n#순위\nb=Window.partitionBy(\"date\").orderBy(\"sales\")\nsales_data=df.withColumn(\"sales_rank\", rank() over(b))\n\n#조밀한 순위\nb=Window.partitionBy(\"date\").orderBy(\"sales\")\nsales_data=df.withColumn(\"sales_dense_rank\", desne_rank() over(b))\n\n\n#지연\nc=Window.partitionBy(\"Item\").orderBy(\"date\") #예시 열을 고려하여 원하는 열을 선택할 수 있습니다\nsales_data=df.withColumn(\"pre_sales\", lag(col(\"sales\"),1).over(c))\n\n\n#리드\nd=Window.partitionBy(\"Item\").orderBy(\"date\") #예시 열을 고려하여 원하는 열을 선택할 수 있습니다\nsales_data=df.withColumn(\"next_sales\", lead(col(\"sales\"),1).over(d))\n```\n\n<div class=\"content-ad\"></div>\n\n이 기사는 데이터 엔지니어링 면접에 대비하는 개인들에게 가치 있는 도구로 작용하며, Databricks 플랫폼을 위해 구체적으로 맞춘 PySpark 함수와 수식들에 대한 간결하면서 포괄적인 요람을 제공합니다.\n\n구조화된 레이아웃과 각 예제와 함께 제공되는 자세한 설명으로, 본 자료는 독자들이 10분만 투자하여 주요 개념들을 효율적으로 검토하고 숙지할 수 있도록 도와줍니다.\n\n이러한 기본 기능들을 숙달함으로써 희망하는 데이터 엔지니어들은 자신감을 키우고 다양한 면접 상황을 쉽게 해결할 수 있는 준비를 갖추게 되며, 이를 통해 더욱 흥미로운 데이터 엔지니어링 직무를 얻을 성공 기회를 극대화할 수 있습니다.\n\n![이미지](/assets/img/2024-05-20-TheEssentialPySparkCheatSheetforAllDataEngineers_4.png)\n\n<div class=\"content-ad\"></div>\n\n아래에서 데이터 엔지니어 인터뷰를 준비하는 데 도움이 되는 몇 가지 더 많은 기사를 찾을 수 있습니다.\n\n- SQL 사용 사례 - 데이터 엔지니어 인터뷰\n- 데이터 엔지니어 인터뷰에서 가장 일반적으로 묻는 빅데이터(Apache Spark) 개념\n- 데이터 엔지니어 인터뷰를 위한 Python 코딩 문제 제1부 (쉬운 난이도)\n\n<div class=\"content-ad\"></div>\n\n제 소중한 내용을 더 많이 공유할 수 있도록 함성 소리로 응원해주신다면 감사하겠습니다. \n\n저를 팔로우하고 구독하여 제 소식을 즉시 받아보세요. \n\n감사합니다 :)","ogImage":{"url":"/assets/img/2024-05-20-TheEssentialPySparkCheatSheetforAllDataEngineers_0.png"},"coverImage":"/assets/img/2024-05-20-TheEssentialPySparkCheatSheetforAllDataEngineers_0.png","tag":["Tech"],"readingTime":9},"content":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    h2: \"h2\",\n    p: \"p\",\n    pre: \"pre\",\n    code: \"code\",\n    span: \"span\",\n    img: \"img\",\n    h1: \"h1\",\n    br: \"br\",\n    ul: \"ul\",\n    li: \"li\"\n  }, _provideComponents(), props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.h2, {\n      children: \"모든 Pyspark 스크립트 작성을 수정하고, 시간을 절약한 상태로 현명하게 연습하세요.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"\\\"일을 맹목적으로 끝내는 것보다는 최적의 효율성과 효과적인 방법으로 실행하는 것이 중요합니다.\\\"\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"여기 제공된 치트 시트는 PySpark의 주요 측면을 신속하게 검토하고, 인터뷰 준비 또는 Databricks나 Python 기반 코딩 환경과 같은 다양한 플랫폼에서 데이터 분석 작업에 대비할 수 있게 돕습니다.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"이 도구를 이용하면 PySpark 및 관련 프레임워크에 필수적인 중요한 변환 기술 및 데이터 분석 방법론을 신속하게 검토할 수 있습니다.\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"시작해봅시다\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"PySpark를 사용하여 변환 작업이나 데이터 분석 작업을 시작하기 전에 Spark 세션을 설정하는 것이 중요합니다. 이 초기 단계는 Spark 프레임워크 내에서 코드 실행의 기반을 제공합니다. 더 중요한 것은 후속 작업을 위한 기반을 구축하고 Spark 기능과 원활하게 상호 작용할 수 있도록 합니다.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"먼저 의도한 작업에 필요한 모듈을 가져와야 하며, 모든 중요한 구성 요소가 사용 가능하도록 보장해야 합니다. 이 기본 절차를 준수함으로써 개발자와 데이터 전문가는 PySpark의 강력한 기능을 활용하여 데이터 처리와 분석 작업을 원활하게 수행할 수 있습니다.\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"시작해봅시다!!\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"hljs language-md\",\n        children: \"from pyspark.sql import SparkSession\\nfrom pyspark.sql import types\\nfrom pyspark.sql.types import SparkType, StructField, StringType, IntegerType, DataType\\nfrom pyspark.sql.functions import col, date, year, time, sum, avg, upper, count, Broadcast, expr\\nfrom pyspark.sql import window\\nfrom pyspark.sql import functions as F\\n\"\n      })\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-md\",\n        children: [\"spark = SparkSession.builder.appName(\\\"application\\\").getOrCreate()\\n\", _jsx(_components.span, {\n          className: \"hljs-section\",\n          children: \"# read any file as given either csv, excel, parquet, or Avro any format of data\"\n        }), \"\\ndata = spark.read.csv(\\\"filePath\\\", header=True, inferschema=True) # if we want given data types as it is\\nschema = StructType([StructField(\\\"id\\\", IntegerType), StructField(\\\"name\\\", StringType),\\nStructField(\\\"dept\\\", StringType)]) # if we want our required data types then we use this \\n\", _jsx(_components.span, {\n          className: \"hljs-section\",\n          children: \"# also for better performance of executions we will be using our custom schema rather depending on inferschema\"\n        }), \"\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Let’s kickstart our PySpark application by first creating a Spark Session, the entry point to PySpark functionality.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"We’ll then proceed with performing various transformations and analyses on sample data.\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"데이터 = [(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'mahi'\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"100\"\n        }), \"), (\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'mahendra'\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"200\"\n        }), \"), (\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'harish'\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"300\"\n        }), \"), (\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"4\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'desh'\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"400\"\n        }), \")]\\n\\n스키마 = [\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'id'\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'name'\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'salary'\"\n        }), \"]\\n# 데이터 프레임 생성\\ndf = spark.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"createDataFrame\"\n        }), \"(data, schema)\\ndf.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"head\"\n        }), \"()\\ndf.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"show\"\n        }), \"()\\n\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"display\"\n        }), \"(df)\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/img/2024-05-20-TheEssentialPySparkCheatSheetforAllDataEngineers_0.png\",\n        alt: \"image\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"PySpark에서 윈도우 함수를 사용하여 급여의 누적 합을 계산할 수 있습니다.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"a = \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Window\"\n        }), \"().\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"orderBy\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'id'\"\n        }), \")\\n누적_합 = df.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"withColumn\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"cumulative_sum\\\"\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"sum\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"salary\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"over\"\n        }), \"(a))\\n결과 = cumulative_sum.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"orderBy\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'id'\"\n        }), \")\\n결과.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"show\"\n        }), \"()\\n\"]\n      })\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-python\",\n        children: [\"a = Window().orderBy(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'id'\"\n        }), \")\\n누적합 = df.withColumn(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"누적합\\\"\"\n        }), \", avg(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"salary\\\"\"\n        }), \").over(a))\\n결과 = 누적합.orderBy(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'id'\"\n        }), \")\\n결과.show()\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/img/2024-05-20-TheEssentialPySparkCheatSheetforAllDataEngineers_1.png\",\n        alt: \"이미지\"\n      })\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-python\",\n        children: [\"emp=[(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \",\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'마히'\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"100\"\n        }), \",\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \"),(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \",\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'마헨드라'\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"200\"\n        }), \",\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \"),(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3\"\n        }), \",\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'하리쉬'\"\n        }), \",\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"300\"\n        }), \",\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3\"\n        }), \"),\\n(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"4\"\n        }), \",\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'데시'\"\n        }), \",\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"400\"\n        }), \",\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"4\"\n        }), \")]\\n\\n스키마=[\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'id'\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'name'\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'salary'\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'dept_id'\"\n        }), \"]\\n\", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"# 데이터 프레임 생성\"\n        }), \"\\ndf=spark.createDataFrame(data,schema)\\ndf.head()\\ndf.show()\\ndisplay(df)\\n\\ndept=[(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \",\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'인사'\"\n        }), \"),(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \",\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'영업'\"\n        }), \"),(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3\"\n        }), \",\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'데이터 분석'\"\n        }), \"),(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"4\"\n        }), \",\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'IT'\"\n        }), \")]\\n스키마=[\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'dept_id'\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'department'\"\n        }), \"]\\n부서=spark.createDataFrame(dept,schema)\\ndisplay(부서)\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/img/2024-05-20-TheEssentialPySparkCheatSheetforAllDataEngineers_2.png\",\n        alt: \"이미지\"\n      })\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"공통 속성인 dept_id를 사용하여 두 개의 데이터 프레임을 결합해 봅시다. 예시를 들어보겠습니다:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"df=employee.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"join\"\n        }), \"(department, \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"dept_id\\\"\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"inner\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"select\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'id'\"\n        }), \",\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'name'\"\n        }), \",\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'salary'\"\n        }), \",\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'department'\"\n        }), \")\\n\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"display\"\n        }), \"(df)\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"df=employee.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"join\"\n        }), \"(department, \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"dept_id\\\"\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"right\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"select\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'name'\"\n        }), \",\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'department'\"\n        }), \")\\n\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"display\"\n        }), \"(df)\\n\"]\n      })\n    }), \"\\n\", _jsx(\"img\", {\n      src: \"/assets/img/2024-05-20-TheEssentialPySparkCheatSheetforAllDataEngineers_3.png\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"위에서는 다양한 PySpark 변환, 액션 및 기능에 대해 상세히 설명하겠습니다. 실행 가능한 코드 예제와 함께 다룰 예정이에요.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"기본적인 변환인 필터링 및 그룹화부터 창 함수와 같은 고급 기술까지 다양한 작업을 다룰 거에요.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"각 코드 조각은 개념을 포괄적으로 이해할 수 있도록 설명하는 문장과 함께 제공됩니다.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"데이터 조작 작업부터 시작하여 PySpark 데이터 프레임을 사용하여 데이터 필터링, 선택 및 집계를 살펴보겠습니다. 그 후에는 조인, 정렬 및 창 함수와 같은 변환을 통해 다수의 테이블에서 데이터를 조작하고 분석하는 방법을 살펴볼 것입니다.\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"또한, 우리는 샘플 데이터셋을 활용하여 모델 학습과 평가를 통해 머신러닝 작업을 지원하는 Pyspark을 소개할 것입니다.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"이 치트 시트를 통해 각 코드 스니펫은 해당 개념의 실제 시연을 제공하여 빠른 참고와 이해를 돕게 됩니다.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"이 예제를 따라가며 사용자들은 Pyspark 능력을 향상시키고 데이터 엔지니어링 및 데이터 과학 인터뷰나 실제 데이터 처리 작업에 대비할 수 있습니다.\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"필터링, 선택, 집계, 그룹화 및 정렬 조건:\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"df = orders.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"join\"\n        }), \"(products, \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"order_id\\\"\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"inner\\\"\"\n        }), \") # 어떤 조인 적용\\ndf.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"join\"\n        }), \"(df2, \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'공통 열'\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"groupBy\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'표시할 열'\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"count\"\n        }), \"().\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"orderBy\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"desc\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"'count'\"\n        }), \"))\\n\\n\\ndf1=df.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"groupBy\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"cust_id\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"agg\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"sum\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"amount\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"alias\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"bill\\\"\"\n        }), \")) # 그룹화 함수 적용 및 집계 조건을 지정\\n\\ndf.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"groupBy\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"col1\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"agg\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"count\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"col2\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"alias\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"count\\\"\"\n        }), \"), \\n                          \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"sum\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"col2\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"alias\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"sum\\\"\"\n        }), \"),\\n                          \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"max\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"col2\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"alias\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"maximum\\\"\"\n        }), \"),\\n                          \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"min\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"col2\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"alias\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"minimum\\\"\"\n        }), \"), \\n                          \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"avg\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"col2\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"alias\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"average\\\"\"\n        }), \")).\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"show\"\n        }), \"()\\n\\n\\ndf.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"drop\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"column_name1\\\"\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"column_name2\\\"\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"column_name3\\\"\"\n        }), \") # 열 삭제\\ndf.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"drop\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"col\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"column_name\\\"\"\n        }), \")) # 다른 열 삭제 방법\\n\\ndf.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"createOrReplaceTempView\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"원하는 이름 지정\\\"\"\n        }), \") # 데이터 프레임을 테이블로 변환\\n\\ndf.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"orderBy\"\n        }), \"(F.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"desc\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"column_name\\\"\"\n        }), \")).\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"first\"\n        }), \"() # 특정 열(예: 급여)의 내림차순 첫 번째 행 반환\\ndf.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"orderBy\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"col\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"column_name\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"desc\"\n        }), \"()).\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"first\"\n        }), \"() # 가장 높은 값을 반환하는 또 다른 방법\\ndf.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"orderBy\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"col\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"column_name\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"desc\"\n        }), \"()).\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"limit\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"5\"\n        }), \") # 상위 \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"5\"\n        }), \"개의 값을 반환\\n\\n# 원하는 열에 필터 적용\\ndf.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"filter\"\n        }), \"(df.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"column_name\"\n        }), \"==값).\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"show\"\n        }), \"()\\n\\n# 필터링된 결과와 함께 필요한 열 선택\\ndf.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"select\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"column1\\\"\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"column2\\\"\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"column3\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"where\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"col\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"any column\\\"\"\n        }), \")==\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"any value\\\"\"\n        }), \")\\ndf.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"select\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"column1\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"where\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"col\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"column1\\\"\"\n        }), \")> 값).\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"show\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"5\"\n        }), \")\\ndf.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"sort\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"원하는 열 이름\\\"\"\n        }), \")\\n\\n# 열 이름 변경\\ndf.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"withcolumn\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Renamed\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"기존 열 이름\\\"\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"원하는 열 이름으로 변경\\\"\"\n        }), \")\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"PySpark는 데이터 프레임 내에서 날짜 속성을 추출하고 조작하는 편리한 방법을 제공하며, 사용자가 연도, 월, 일과 같은 다양한 기준으로 통찰력을 얻을 수 있도록 합니다.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"또한, 이러한 속성들은 오름차순이나 내림차순으로 정렬하여 분석과 시각화를 용이하게 할 수 있습니다.\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"날짜 열에서 일, 월, 연도 추출하기:\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"데이터 프레임에서 연도, 월, 일 세부 정보 추출하기\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"df.select(year(\\\"date column\\\").distinct().orderBy(year(\\\"date column\\\")).show()\\ndf.select(month(\\\"date column\\\").distinct().orderBy(month(\\\"date column\\\")).show()\\ndf.select(day(\\\"date column\\\").distinct().orderBy(day(\\\"date column\\\")).show()\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"df.withColumn(\\\"orderyear\\\", year(\\\"df.date column\\\"))\\ndf.withColumn(\\\"ordermonth\\\", month(\\\"df.date column\\\"))\\ndf.withColumn(\\\"orderday\\\", day(\\\"df.date column\\\"))\\ndf.withColumn(\\\"orderquarter\\\", quarter(\\\"df.date column\\\"))\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"특정 열에서 null 값을 필터링하고 그 다음에 지정된 순서로 그룹화 작업을 수행하기 위해 조건을 적용할 수 있습니다.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"df.select(\\\"column name we want to retrieve\\\").where(col(\\\"column name we want to retrieve\\\").isNotNull())\", _jsx(_components.br, {}), \"\\n\", \".groupBy(\\\"column name we want to retrieve\\\").count().orderBy(\\\"count\\\", ascending=False).show(10)\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"함수 작성하기:```\"\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"df.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"write\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"format\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"CSV\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"mode\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"overwrite\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"save\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"원하는 파일 저장 경로\\\"\"\n        }), \")\\ndf.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"write\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"format\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"CSV\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"mode\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"append\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"save\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"원하는 파일 저장 경로\\\"\"\n        }), \")\\ndf.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"write\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"format\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"Parquet\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"mode\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"overwrite\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"save\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"원하는 파일 저장 경로\\\"\"\n        }), \")\\ndf.\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"write\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"format\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"parquet\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"mode\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"append\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"save\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"원하는 파일 저장 경로\\\"\"\n        }), \")\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"윈도우 함수:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-js\",\n        children: [\"wind_a=\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Window\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"partitionBy\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"col1\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"orderBy\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"col2\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"rangeBetween\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Window\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-property\",\n          children: \"unboundedpreceeding\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \")\\n\\ndf_w_coloumn= df.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"withColumn\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"col_sum\\\"\"\n        }), \", F.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"sum\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"salary\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"over\"\n        }), \"(wind_a) #롤링 합계 또는 누적 합계:\\n\\n\\n#행 번호\\na=\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Window\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"orderBy\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"date_column\\\"\"\n        }), \") #예시로 날짜 열을 고려하였지만 원하는 열을 선택할 수 있습니다\\nsales_data=df.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"withColumn\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"row_number\\\"\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"row_number\"\n        }), \"().\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"over\"\n        }), \"(a))\\n\\n#순위\\nb=\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Window\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"partitionBy\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"date\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"orderBy\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"sales\\\"\"\n        }), \")\\nsales_data=df.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"withColumn\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"sales_rank\\\"\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"rank\"\n        }), \"() \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"over\"\n        }), \"(b))\\n\\n#조밀한 순위\\nb=\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Window\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"partitionBy\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"date\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"orderBy\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"sales\\\"\"\n        }), \")\\nsales_data=df.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"withColumn\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"sales_dense_rank\\\"\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"desne_rank\"\n        }), \"() \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"over\"\n        }), \"(b))\\n\\n\\n#지연\\nc=\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Window\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"partitionBy\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"Item\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"orderBy\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"date\\\"\"\n        }), \") #예시 열을 고려하여 원하는 열을 선택할 수 있습니다\\nsales_data=df.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"withColumn\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"pre_sales\\\"\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"lag\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"col\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"sales\\\"\"\n        }), \"),\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"over\"\n        }), \"(c))\\n\\n\\n#리드\\nd=\", _jsx(_components.span, {\n          className: \"hljs-title class_\",\n          children: \"Window\"\n        }), \".\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"partitionBy\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"Item\\\"\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"orderBy\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"date\\\"\"\n        }), \") #예시 열을 고려하여 원하는 열을 선택할 수 있습니다\\nsales_data=df.\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"withColumn\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"next_sales\\\"\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"lead\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"col\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"sales\\\"\"\n        }), \"),\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \").\", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"over\"\n        }), \"(d))\\n\"]\n      })\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"이 기사는 데이터 엔지니어링 면접에 대비하는 개인들에게 가치 있는 도구로 작용하며, Databricks 플랫폼을 위해 구체적으로 맞춘 PySpark 함수와 수식들에 대한 간결하면서 포괄적인 요람을 제공합니다.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"구조화된 레이아웃과 각 예제와 함께 제공되는 자세한 설명으로, 본 자료는 독자들이 10분만 투자하여 주요 개념들을 효율적으로 검토하고 숙지할 수 있도록 도와줍니다.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"이러한 기본 기능들을 숙달함으로써 희망하는 데이터 엔지니어들은 자신감을 키우고 다양한 면접 상황을 쉽게 해결할 수 있는 준비를 갖추게 되며, 이를 통해 더욱 흥미로운 데이터 엔지니어링 직무를 얻을 성공 기회를 극대화할 수 있습니다.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/img/2024-05-20-TheEssentialPySparkCheatSheetforAllDataEngineers_4.png\",\n        alt: \"이미지\"\n      })\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"아래에서 데이터 엔지니어 인터뷰를 준비하는 데 도움이 되는 몇 가지 더 많은 기사를 찾을 수 있습니다.\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"SQL 사용 사례 - 데이터 엔지니어 인터뷰\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"데이터 엔지니어 인터뷰에서 가장 일반적으로 묻는 빅데이터(Apache Spark) 개념\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"데이터 엔지니어 인터뷰를 위한 Python 코딩 문제 제1부 (쉬운 난이도)\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(\"div\", {\n      class: \"content-ad\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"제 소중한 내용을 더 많이 공유할 수 있도록 함성 소리로 응원해주신다면 감사하겠습니다.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"저를 팔로우하고 구독하여 제 소식을 즉시 받아보세요.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"감사합니다 :)\"\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{}}},"__N_SSG":true}