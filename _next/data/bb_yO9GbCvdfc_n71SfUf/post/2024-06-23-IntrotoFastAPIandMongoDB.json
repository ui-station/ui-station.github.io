{"pageProps":{"post":{"title":"FastAPIì™€ MongoDB ì†Œê°œ ì²« ê±¸ìŒë¶€í„° ì‹œì‘í•˜ê¸°","description":"","date":"2024-06-23 22:46","slug":"2024-06-23-IntrotoFastAPIandMongoDB","content":"\nì´ íŠœí† ë¦¬ì–¼ì—ì„œëŠ” FastAPIì— ì˜ì¡´í•˜ëŠ” ê°„ë‹¨í•œ íŒŒì´ì¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ êµ¬ì¶•í•˜ëŠ” ë°©ë²•ì„ ë°°ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ MongoDBë¡œ ìš”ì²­ì„ ë³´ë‚´ëŠ” ê¸°ëŠ¥ì„ ê°–ì¶”ê³  ìˆìŠµë‹ˆë‹¤.\n\ní”„ë¡œê·¸ë¨ì´ ëª¨ë“  ì¥ì¹˜ì—ì„œ ì‹¤í–‰ë  ìˆ˜ ìˆë„ë¡ í•˜ê¸° ìœ„í•´, ì´ íŠœí† ë¦¬ì–¼ì€ ë³´í¸ì ì¸ ì ‘ê·¼ ë°©ì‹ì„ ì·¨í•˜ë©° Docker Composeë¥¼ ì‚¬ìš©í•˜ì—¬ ì½”ë“œë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.\n\në˜í•œ ë³´ì•ˆê³¼ í™•ì¥ì„±ì— ëŒ€í•œ ë‚´ìš©ì— ëŒ€í•´ì„œëŠ” ì´ PoCì—ì„œëŠ” ì¤‘ì ì„ ë‘ì§€ ì•Šì•˜ìŒì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤. í•´ë‹¹ ì •ë³´ì— ëŒ€í•´ì„œëŠ” FastAPI ë³´ì•ˆ ë¬¸ì„œë¥¼ í™•ì¸í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.\n\n## ì‚¬ì „ ìš”êµ¬ ì‚¬í•­\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\nì¹œêµ¬ì•¼, ê¸°ê¸°ì— ë‹¤ìŒ ì†Œí”„íŠ¸ì›¨ì–´ê°€ ìˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.\n\n- Git\n- Docker Desktop\n- Python\n- MongoDB Compass ë˜ëŠ” Mongosh\n\n## PoC ì‹¤í–‰ ë°©ë²•\n\nì €ì¥ì†Œë¥¼ ë³µì œ(clone)í•˜ê¸° ì „ì—, ëª¨ë“  ì„ í–‰ ìš”êµ¬ ì‚¬í•­ì´ ì¶©ì¡±ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n```js\ngit clone https://github.com/raduul/FastMongo.git\n```\n\nDocker Desktopì„ ì¼œê³ , ë°ì´í„°ê°€ ìœ ì§€ë  ë³¼ë¥¨ì„ êµ¬ì„±í•˜ì„¸ìš”.\n\n```js\nDocker Desktop > Settings > Resources > File Sharing > ì›í•˜ëŠ” ìœ„ì¹˜ ì„ íƒ\n```\n\nì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•œ í›„, ë³µì œí•œ ì €ì¥ì†Œë¡œ ì´ë™í•´ì„œ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”:\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n```js\ndocker compose -f deployment/docker-compose-fastapi.yaml up --build\n```\n\në¡œì»¬ì—ì„œ ì‹¤í–‰ ì¤‘ì¸ MongoDBì— ìƒ˜í”Œ ë°ì´í„°ë¥¼ ë³´ë‚´ë ¤ë©´ Swagger UI(localhost:8000/docs)ì— ì•¡ì„¸ìŠ¤í•˜ì‹­ì‹œì˜¤.\n\nâ€˜send_dataâ€™ë¥¼ ì—´ì–´ì„œ â€œTry it outâ€ì„ ì„ íƒí•œ í›„ â€œExecuteâ€ë¥¼ ì„ íƒí•˜ì—¬ ë°ì´í„°ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ë¡œ ë³´ë‚´ì„¸ìš”.\n\n<img src=\"/assets/img/2024-06-23-IntrotoFastAPIandMongoDB_0.png\" />\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\nì´í›„ì—ëŠ” \"ì‹¤í–‰\" ë²„íŠ¼ ì•„ë˜ì— ìš”ì²­ ìƒíƒœê°€ í‘œì‹œë©ë‹ˆë‹¤. ìƒíƒœ ì½”ë“œ 200ì€ ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŒì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤!\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-23-IntrotoFastAPIandMongoDB_1.png)\n\në°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ë©´ MongoDB Compassë¡œ ì´ë™í•˜ì—¬ ì¶”ê°€ëœ ë°ì´í„°ê°€ ìˆëŠ” ë°ì´í„°ë² ì´ìŠ¤ ë° ì»¬ë ‰ì…˜ì— ì•¡ì„¸ìŠ¤í•˜ì‹­ì‹œì˜¤.\nì—°ê²° ë¬¸ìì—´ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:\n\n```js\nmongodb://root:example@localhost:27017/fast-api?authSource=admin\n```\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n<img src=\"/assets/img/2024-06-23-IntrotoFastAPIandMongoDB_2.png\" />\n\nì´ì œ ë°ì´í„°ë¥¼ MongoDBì— ì„±ê³µì ìœ¼ë¡œ ë³´ëƒˆìŠµë‹ˆë‹¤. ì½”ë“œë¥¼ ì‹¤í—˜í•˜ê³  MongoDB ë°ì´í„°ë² ì´ìŠ¤ì— ì¶”ê°€ ê²½ë¡œì™€ ì»¬ë ‰ì…˜ì„ ìƒì„±í•´ë³´ì„¸ìš”. ì¶•í•˜í•©ë‹ˆë‹¤ ğŸ¥³ğŸŠ\n\n## ì½”ë“œ ì†Œê°œ\n\nì´ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•˜ëŠ” ë° í•„ìš”í•œ ì½”ë“œëŠ” ë§¤ìš° ê°„ë‹¨í•©ë‹ˆë‹¤! ì„¸ ê°œì˜ ê·¸ë£¹ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n- FastAPI â€” ë°ì´í„°ë¥¼ ì „ì†¡í•˜ëŠ” API Endpointë¥¼ êµ¬ì¶•í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.\n- MongoDB â€” FastAPIì—ì„œ ì „ì†¡ëœ ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.\n- Docker Compose â€” FastAPI ë° MongoDBì˜ ì»¨í…Œì´ë„ˆí™”ëœ ì´ë¯¸ì§€ë¥¼ ì‹¤í–‰í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.\n\n## FastAPI\n\nì´ ì½”ë“œëŠ” ì—¬ëŸ¬ ê°œì˜ íŒŒì´ì¬ íŒŒì¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆì§€ë§Œ, ê°€ì¥ ì¤‘ìš”í•œ ë‘ ê°œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:\n\n- ë¨¼ì € MongoDB ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°ì´ ì„¤ì •ë©ë‹ˆë‹¤: (database.py)\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n```js\nimport logging\nfrom motor.motor_asyncio import AsyncIOMotorClient\nimport os\n\nlogging.basicConfig(level=logging.INFO, format='%(asctime)s - %(levelname)s - %(message)s')\n\nclient: AsyncIOMotorClient = None\n\ndef startup_db_client():\n    global client\n    try:\n        mongo_uri = os.getenv('MONGO_URL')\n        client = AsyncIOMotorClient(mongo_uri)\n        logging.info(\"Connected to MongoDB successfully.\")\n    except Exception as e:\n        logging.error(f\"Failed to connect to MongoDB: {e}\")\n    return client['fast-api']\n\ndef shutdown_db_client():\n    client.close()\n    logging.info(\"MongoDB connection closed.\")\n\ndef get_database():\n    return startup_db_client()\n```\n\në‘˜ì§¸ë¡œ, ì—°ê²°ì´ ì„¤ì •ë˜ë©´ ë°ì´í„°ë¥¼ ë³´ë‚¼ ë•Œ ìœ ì¶”í•©ë‹ˆë‹¤ (main.py)\n\n```js\nfrom fastapi import FastAPI, Depends\nfrom database import startup_db_client, shutdown_db_client, get_database\n\napp = FastAPI()\n\napp.add_event_handler(\"startup\", startup_db_client)\napp.add_event_handler(\"shutdown\", shutdown_db_client)\n\n@app.post(\"/send_data\")\nasync def insert_sample_data(sample_data: dict, db=Depends(get_database)):\n    try:\n        collection = db['sample-users']\n        result = await collection.insert_one(sample_data)\n        return {\"id of inserted record\": str(result.inserted_id)}\n    except Exception as e:\n        return {\"error\": str(e)}\n```\n\n## MongoDB\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\nMongoDB êµ¬ì„±ì€ PoCë¥¼ ì´í•´í•˜ê¸° ì‰½ê²Œ ë§Œë“¤ê¸° ìœ„í•´ ê°„ë‹¨í•˜ê²Œ ìœ ì§€ë˜ì—ˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ êµ¬ì„±ì€ ìˆœì „íˆ ê¸°ë³¸ ì„¤ì •ì…ë‹ˆë‹¤. MongoDBì˜ ë‘ ê°€ì§€ ì£¼ìš” íŒŒì¼ì€ \"deployment/docker-compose-fastapi.yaml\" ë° \"deployment/init-mongo.js\"ì…ë‹ˆë‹¤.\n\n- docker-compose-fastapi.yaml â€” MongoDBë¥¼ ìœ„í•œ ê¸°ë³¸ ë°°í¬ êµ¬ì„±ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\n- deployment/init-mongo.js â€” Docker Composeì— ì˜í•´ MongoDBê°€ ë°°í¬ë  ë•Œ PoCë¥¼ ìœ„í•´ ìƒì„±ë  ìŠ¤í‚¤ë§ˆì— ëŒ€í•œ ì •ë³´ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\n\n## Docker Compose\n\nDocker Composeì€ ì´ PoCì—ì„œ ì‚¬ìš©ë˜ëŠ” ì´ë¯¸ì§€ ì¤‘ ë‘ ê°œë¥¼ ì‹¤í–‰í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. êµ¬ì„±ì€ \"deployment/docker-compose-fastapi.yaml\"ì—ì„œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n- fastapi ì„œë¹„ìŠ¤ëŠ” ë£¨íŠ¸ì— ìœ„ì¹˜í•œ Dockerfileì„ ì°¸ì¡°í•˜ë©° FastAPI ì•±ì„ ë¹Œë“œí•˜ê³  ë¹Œë“œëœ í›„ì— ì‹¤í–‰í•˜ëŠ” ë°©ë²•ì— ëŒ€í•œ êµ¬ì„±ì„ í¬í•¨í•©ë‹ˆë‹¤.\n- mongo ì„œë¹„ìŠ¤ëŠ” MongoDB ì´ë¯¸ì§€ë¥¼ ì°¸ì¡°í•©ë‹ˆë‹¤. \"docker compose down\" í›„ì—ë„ ë°ì´í„°ê°€ ìœ ì§€ë˜ë„ë¡ ë³´ì¥í•˜ê¸° ìœ„í•´ ë³¼ë¥¨ì´ ìƒì„±ë˜ì–´ ë°ì´í„°ë¥¼ ë³´ê´€í•©ë‹ˆë‹¤. ì‚¬ìš© ì¤‘ì¸ íŠ¹ì • ì´ë¯¸ì§€ëŠ” OS/ARCH Amd64 ë° Arm64ì™€ í˜¸í™˜ë©ë‹ˆë‹¤.\n\nLinkedInì—ì„œ ì–¸ì œë“ ì§€ ì—°ë½ ì£¼ì„¸ìš”.\n","ogImage":{"url":"/assets/img/2024-06-23-IntrotoFastAPIandMongoDB_0.png"},"coverImage":"/assets/img/2024-06-23-IntrotoFastAPIandMongoDB_0.png","tag":["Tech"],"readingTime":7},"content":"<!doctype html>\n<html lang=\"en\">\n<head>\n<meta charset=\"utf-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n</head>\n<body>\n<p>ì´ íŠœí† ë¦¬ì–¼ì—ì„œëŠ” FastAPIì— ì˜ì¡´í•˜ëŠ” ê°„ë‹¨í•œ íŒŒì´ì¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ êµ¬ì¶•í•˜ëŠ” ë°©ë²•ì„ ë°°ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ MongoDBë¡œ ìš”ì²­ì„ ë³´ë‚´ëŠ” ê¸°ëŠ¥ì„ ê°–ì¶”ê³  ìˆìŠµë‹ˆë‹¤.</p>\n<p>í”„ë¡œê·¸ë¨ì´ ëª¨ë“  ì¥ì¹˜ì—ì„œ ì‹¤í–‰ë  ìˆ˜ ìˆë„ë¡ í•˜ê¸° ìœ„í•´, ì´ íŠœí† ë¦¬ì–¼ì€ ë³´í¸ì ì¸ ì ‘ê·¼ ë°©ì‹ì„ ì·¨í•˜ë©° Docker Composeë¥¼ ì‚¬ìš©í•˜ì—¬ ì½”ë“œë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.</p>\n<p>ë˜í•œ ë³´ì•ˆê³¼ í™•ì¥ì„±ì— ëŒ€í•œ ë‚´ìš©ì— ëŒ€í•´ì„œëŠ” ì´ PoCì—ì„œëŠ” ì¤‘ì ì„ ë‘ì§€ ì•Šì•˜ìŒì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤. í•´ë‹¹ ì •ë³´ì— ëŒ€í•´ì„œëŠ” FastAPI ë³´ì•ˆ ë¬¸ì„œë¥¼ í™•ì¸í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.</p>\n<h2>ì‚¬ì „ ìš”êµ¬ ì‚¬í•­</h2>\n<p></p>\n<p>ì¹œêµ¬ì•¼, ê¸°ê¸°ì— ë‹¤ìŒ ì†Œí”„íŠ¸ì›¨ì–´ê°€ ìˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.</p>\n<ul>\n<li>Git</li>\n<li>Docker Desktop</li>\n<li>Python</li>\n<li>MongoDB Compass ë˜ëŠ” Mongosh</li>\n</ul>\n<h2>PoC ì‹¤í–‰ ë°©ë²•</h2>\n<p>ì €ì¥ì†Œë¥¼ ë³µì œ(clone)í•˜ê¸° ì „ì—, ëª¨ë“  ì„ í–‰ ìš”êµ¬ ì‚¬í•­ì´ ì¶©ì¡±ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.</p>\n<p></p>\n<pre><code class=\"hljs language-js\">git clone <span class=\"hljs-attr\">https</span>:<span class=\"hljs-comment\">//github.com/raduul/FastMongo.git</span>\n</code></pre>\n<p>Docker Desktopì„ ì¼œê³ , ë°ì´í„°ê°€ ìœ ì§€ë  ë³¼ë¥¨ì„ êµ¬ì„±í•˜ì„¸ìš”.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-title class_\">Docker</span> <span class=\"hljs-title class_\">Desktop</span> > <span class=\"hljs-title class_\">Settings</span> > <span class=\"hljs-title class_\">Resources</span> > <span class=\"hljs-title class_\">File</span> <span class=\"hljs-title class_\">Sharing</span> > ì›í•˜ëŠ” ìœ„ì¹˜ ì„ íƒ\n</code></pre>\n<p>ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•œ í›„, ë³µì œí•œ ì €ì¥ì†Œë¡œ ì´ë™í•´ì„œ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”:</p>\n<p></p>\n<pre><code class=\"hljs language-js\">docker compose -f deployment/docker-compose-fastapi.<span class=\"hljs-property\">yaml</span> up --build\n</code></pre>\n<p>ë¡œì»¬ì—ì„œ ì‹¤í–‰ ì¤‘ì¸ MongoDBì— ìƒ˜í”Œ ë°ì´í„°ë¥¼ ë³´ë‚´ë ¤ë©´ Swagger UI(localhost:8000/docs)ì— ì•¡ì„¸ìŠ¤í•˜ì‹­ì‹œì˜¤.</p>\n<p>â€˜send_dataâ€™ë¥¼ ì—´ì–´ì„œ â€œTry it outâ€ì„ ì„ íƒí•œ í›„ â€œExecuteâ€ë¥¼ ì„ íƒí•˜ì—¬ ë°ì´í„°ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ë¡œ ë³´ë‚´ì„¸ìš”.</p>\n<p></p>\n<p>ì´í›„ì—ëŠ” \"ì‹¤í–‰\" ë²„íŠ¼ ì•„ë˜ì— ìš”ì²­ ìƒíƒœê°€ í‘œì‹œë©ë‹ˆë‹¤. ìƒíƒœ ì½”ë“œ 200ì€ ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŒì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤!</p>\n<p><img src=\"/assets/img/2024-06-23-IntrotoFastAPIandMongoDB_1.png\" alt=\"ì´ë¯¸ì§€\"></p>\n<p>ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ë©´ MongoDB Compassë¡œ ì´ë™í•˜ì—¬ ì¶”ê°€ëœ ë°ì´í„°ê°€ ìˆëŠ” ë°ì´í„°ë² ì´ìŠ¤ ë° ì»¬ë ‰ì…˜ì— ì•¡ì„¸ìŠ¤í•˜ì‹­ì‹œì˜¤.\nì—°ê²° ë¬¸ìì—´ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-attr\">mongodb</span>:<span class=\"hljs-comment\">//root:example@localhost:27017/fast-api?authSource=admin</span>\n</code></pre>\n<p></p>\n<p>ì´ì œ ë°ì´í„°ë¥¼ MongoDBì— ì„±ê³µì ìœ¼ë¡œ ë³´ëƒˆìŠµë‹ˆë‹¤. ì½”ë“œë¥¼ ì‹¤í—˜í•˜ê³  MongoDB ë°ì´í„°ë² ì´ìŠ¤ì— ì¶”ê°€ ê²½ë¡œì™€ ì»¬ë ‰ì…˜ì„ ìƒì„±í•´ë³´ì„¸ìš”. ì¶•í•˜í•©ë‹ˆë‹¤ ğŸ¥³ğŸŠ</p>\n<h2>ì½”ë“œ ì†Œê°œ</h2>\n<p>ì´ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•˜ëŠ” ë° í•„ìš”í•œ ì½”ë“œëŠ” ë§¤ìš° ê°„ë‹¨í•©ë‹ˆë‹¤! ì„¸ ê°œì˜ ê·¸ë£¹ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p>\n<p></p>\n<ul>\n<li>FastAPI â€” ë°ì´í„°ë¥¼ ì „ì†¡í•˜ëŠ” API Endpointë¥¼ êµ¬ì¶•í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.</li>\n<li>MongoDB â€” FastAPIì—ì„œ ì „ì†¡ëœ ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.</li>\n<li>Docker Compose â€” FastAPI ë° MongoDBì˜ ì»¨í…Œì´ë„ˆí™”ëœ ì´ë¯¸ì§€ë¥¼ ì‹¤í–‰í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.</li>\n</ul>\n<h2>FastAPI</h2>\n<p>ì´ ì½”ë“œëŠ” ì—¬ëŸ¬ ê°œì˜ íŒŒì´ì¬ íŒŒì¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆì§€ë§Œ, ê°€ì¥ ì¤‘ìš”í•œ ë‘ ê°œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:</p>\n<ul>\n<li>ë¨¼ì € MongoDB ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°ì´ ì„¤ì •ë©ë‹ˆë‹¤: (database.py)</li>\n</ul>\n<p></p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">import</span> logging\n<span class=\"hljs-keyword\">from</span> motor.<span class=\"hljs-property\">motor_asyncio</span> <span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">AsyncIOMotorClient</span>\n<span class=\"hljs-keyword\">import</span> os\n\nlogging.<span class=\"hljs-title function_\">basicConfig</span>(level=logging.<span class=\"hljs-property\">INFO</span>, format=<span class=\"hljs-string\">'%(asctime)s - %(levelname)s - %(message)s'</span>)\n\n<span class=\"hljs-attr\">client</span>: <span class=\"hljs-title class_\">AsyncIOMotorClient</span> = <span class=\"hljs-title class_\">None</span>\n\ndef <span class=\"hljs-title function_\">startup_db_client</span>():\n    <span class=\"hljs-variable language_\">global</span> client\n    <span class=\"hljs-attr\">try</span>:\n        mongo_uri = os.<span class=\"hljs-title function_\">getenv</span>(<span class=\"hljs-string\">'MONGO_URL'</span>)\n        client = <span class=\"hljs-title class_\">AsyncIOMotorClient</span>(mongo_uri)\n        logging.<span class=\"hljs-title function_\">info</span>(<span class=\"hljs-string\">\"Connected to MongoDB successfully.\"</span>)\n    except <span class=\"hljs-title class_\">Exception</span> <span class=\"hljs-keyword\">as</span> <span class=\"hljs-attr\">e</span>:\n        logging.<span class=\"hljs-title function_\">error</span>(f<span class=\"hljs-string\">\"Failed to connect to MongoDB: {e}\"</span>)\n    <span class=\"hljs-keyword\">return</span> client[<span class=\"hljs-string\">'fast-api'</span>]\n\ndef <span class=\"hljs-title function_\">shutdown_db_client</span>():\n    client.<span class=\"hljs-title function_\">close</span>()\n    logging.<span class=\"hljs-title function_\">info</span>(<span class=\"hljs-string\">\"MongoDB connection closed.\"</span>)\n\ndef <span class=\"hljs-title function_\">get_database</span>():\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title function_\">startup_db_client</span>()\n</code></pre>\n<p>ë‘˜ì§¸ë¡œ, ì—°ê²°ì´ ì„¤ì •ë˜ë©´ ë°ì´í„°ë¥¼ ë³´ë‚¼ ë•Œ ìœ ì¶”í•©ë‹ˆë‹¤ (main.py)</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">from</span> fastapi <span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">FastAPI</span>, <span class=\"hljs-title class_\">Depends</span>\n<span class=\"hljs-keyword\">from</span> database <span class=\"hljs-keyword\">import</span> startup_db_client, shutdown_db_client, get_database\n\napp = <span class=\"hljs-title class_\">FastAPI</span>()\n\napp.<span class=\"hljs-title function_\">add_event_handler</span>(<span class=\"hljs-string\">\"startup\"</span>, startup_db_client)\napp.<span class=\"hljs-title function_\">add_event_handler</span>(<span class=\"hljs-string\">\"shutdown\"</span>, shutdown_db_client)\n\n@app.<span class=\"hljs-title function_\">post</span>(<span class=\"hljs-string\">\"/send_data\"</span>)\n<span class=\"hljs-keyword\">async</span> def <span class=\"hljs-title function_\">insert_sample_data</span>(<span class=\"hljs-attr\">sample_data</span>: dict, db=<span class=\"hljs-title class_\">Depends</span>(get_database)):\n    <span class=\"hljs-attr\">try</span>:\n        collection = db[<span class=\"hljs-string\">'sample-users'</span>]\n        result = <span class=\"hljs-keyword\">await</span> collection.<span class=\"hljs-title function_\">insert_one</span>(sample_data)\n        <span class=\"hljs-keyword\">return</span> {<span class=\"hljs-string\">\"id of inserted record\"</span>: <span class=\"hljs-title function_\">str</span>(result.<span class=\"hljs-property\">inserted_id</span>)}\n    except <span class=\"hljs-title class_\">Exception</span> <span class=\"hljs-keyword\">as</span> <span class=\"hljs-attr\">e</span>:\n        <span class=\"hljs-keyword\">return</span> {<span class=\"hljs-string\">\"error\"</span>: <span class=\"hljs-title function_\">str</span>(e)}\n</code></pre>\n<h2>MongoDB</h2>\n<p></p>\n<p>MongoDB êµ¬ì„±ì€ PoCë¥¼ ì´í•´í•˜ê¸° ì‰½ê²Œ ë§Œë“¤ê¸° ìœ„í•´ ê°„ë‹¨í•˜ê²Œ ìœ ì§€ë˜ì—ˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ êµ¬ì„±ì€ ìˆœì „íˆ ê¸°ë³¸ ì„¤ì •ì…ë‹ˆë‹¤. MongoDBì˜ ë‘ ê°€ì§€ ì£¼ìš” íŒŒì¼ì€ \"deployment/docker-compose-fastapi.yaml\" ë° \"deployment/init-mongo.js\"ì…ë‹ˆë‹¤.</p>\n<ul>\n<li>docker-compose-fastapi.yaml â€” MongoDBë¥¼ ìœ„í•œ ê¸°ë³¸ ë°°í¬ êµ¬ì„±ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</li>\n<li>deployment/init-mongo.js â€” Docker Composeì— ì˜í•´ MongoDBê°€ ë°°í¬ë  ë•Œ PoCë¥¼ ìœ„í•´ ìƒì„±ë  ìŠ¤í‚¤ë§ˆì— ëŒ€í•œ ì •ë³´ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</li>\n</ul>\n<h2>Docker Compose</h2>\n<p>Docker Composeì€ ì´ PoCì—ì„œ ì‚¬ìš©ë˜ëŠ” ì´ë¯¸ì§€ ì¤‘ ë‘ ê°œë¥¼ ì‹¤í–‰í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. êµ¬ì„±ì€ \"deployment/docker-compose-fastapi.yaml\"ì—ì„œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p></p>\n<ul>\n<li>fastapi ì„œë¹„ìŠ¤ëŠ” ë£¨íŠ¸ì— ìœ„ì¹˜í•œ Dockerfileì„ ì°¸ì¡°í•˜ë©° FastAPI ì•±ì„ ë¹Œë“œí•˜ê³  ë¹Œë“œëœ í›„ì— ì‹¤í–‰í•˜ëŠ” ë°©ë²•ì— ëŒ€í•œ êµ¬ì„±ì„ í¬í•¨í•©ë‹ˆë‹¤.</li>\n<li>mongo ì„œë¹„ìŠ¤ëŠ” MongoDB ì´ë¯¸ì§€ë¥¼ ì°¸ì¡°í•©ë‹ˆë‹¤. \"docker compose down\" í›„ì—ë„ ë°ì´í„°ê°€ ìœ ì§€ë˜ë„ë¡ ë³´ì¥í•˜ê¸° ìœ„í•´ ë³¼ë¥¨ì´ ìƒì„±ë˜ì–´ ë°ì´í„°ë¥¼ ë³´ê´€í•©ë‹ˆë‹¤. ì‚¬ìš© ì¤‘ì¸ íŠ¹ì • ì´ë¯¸ì§€ëŠ” OS/ARCH Amd64 ë° Arm64ì™€ í˜¸í™˜ë©ë‹ˆë‹¤.</li>\n</ul>\n<p>LinkedInì—ì„œ ì–¸ì œë“ ì§€ ì—°ë½ ì£¼ì„¸ìš”.</p>\n</body>\n</html>\n"},"__N_SSG":true}