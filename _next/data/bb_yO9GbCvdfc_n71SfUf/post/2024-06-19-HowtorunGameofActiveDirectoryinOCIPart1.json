{"pageProps":{"post":{"title":"OCIì—ì„œ Active Directory ê²Œì„ì„ ì‹¤í–‰í•˜ëŠ” ë°©ë²•  1ë¶€","description":"","date":"2024-06-19 13:32","slug":"2024-06-19-HowtorunGameofActiveDirectoryinOCIPart1","content":"\nì œê°€ ì •ë§ ì¦ê²ê²Œ ì¦ê²¼ë˜ í”„ë¡œì íŠ¸ ì¤‘ í•˜ë‚˜ëŠ” GOADì…ë‹ˆë‹¤. ê²Œì„ ì˜¤ë¸Œ ìŠ¤ë¡œìš´ì¦ˆ íŒ¬ìœ¼ë¡œì„œ ì‚¬ì´ë²„ ì§€ì‹ì„ ì‹œí—˜í•˜ê³  ë™ì‹œì— ì¦ê¸¸ ìˆ˜ ìˆëŠ” ìˆ˜ë‹¨ì´ì—ˆìŠµë‹ˆë‹¤. ë§Œì•½ ì—¬ëŸ¬ë¶„ì´ ìŠ¤ë¡œìš´ì¦ˆì˜ íŒ¬ì´ë¼ë©´, ì´ Windows/AD/SCCM ë©ì€ ì—¬ëŸ¬ë¶„ì„ ìœ„í•œ ê²ƒì…ë‹ˆë‹¤.\n\nì²˜ìŒì—ëŠ” ì¤‘ì²© ê°€ìƒí™” ì„œë²„ë¥¼ ë§Œë“¤ë ¤ê³  í–ˆëŠ”ë°, í…Œë¼í¼ê³¼ ì•¤ì„œë¸” ì§€ì‹ì´ ê±°ì˜ ì—†ì–´ì„œ ì–´ë ¤ì›€ì„ ê²ªì—ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì €ëŠ” ìë™í™”ë¡œ ë‚˜ì•„ê°€ê¸°ë¡œ ê²°ì •í–ˆìŠµë‹ˆë‹¤. ì¼ìƒì ì¸ ì‘ì—…ì—ì„œ ì‹œê°„ì„ ì ˆì•½í•˜ê³ , ì˜¬ë°”ë¥´ê²Œ êµ¬í˜„ëœë‹¤ë©´ ì¸ê°„ ì—ëŸ¬ë¥¼ ì¤„ì¼ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ìë™í™”ê°€ ë§ì€ ë„ì›€ì´ ëœë‹¤ëŠ” ì ì— ë™ì˜í•©ë‹ˆë‹¤.\n\n`Game of Active Directory (GOAD)` í”„ë¡œì íŠ¸ëŠ” í˜„ì‹¤ì ì´ê³  ì‹¤ìš©ì ì¸ ê²½í—˜ì„ í†µí•´ ì‚¬ì´ë²„ ë³´ì•ˆ ê¸°ìˆ ì„ í–¥ìƒì‹œí‚¤ëŠ” í¬ê´„ì ì¸ ë© í™˜ê²½ì…ë‹ˆë‹¤. Oracle Cloud Infrastructure (OCI)ì—ì„œ í˜¸ìŠ¤íŒ…ë˜ë©°, ë‹¤ì–‘í•œ OCI ì„œë¹„ìŠ¤ì™€ í†µí•©í•˜ì—¬ í˜„ì‹¤ ì„¸ê³„ì˜ ë³´ì•ˆ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ëª¨ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nhttps://github.com/adibirzu/GOAD/blob/main/docs/install_with_oci.md\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\në© í™˜ê²½ìœ¼ë¡œì„œ VCN ë³´ì•ˆ ëª©ë¡ì—ì„œ ì—„ê²©í•œ ACLì„ êµ¬í˜„í•˜ì§€ëŠ” ì•Šì•˜ì–´ìš”. ê·¸ëŸ¬ë‚˜ ëª¨ë“  í¬íŠ¸ì—ì„œ 192.168.0.0/16ì—ì„œì˜ ì•¡ì„¸ìŠ¤ëŠ” í—ˆìš©í–ˆì–´ìš”.\n\n1- ìš°ë¦¬ëŠ” OCIì˜ Windows Server/Ubuntu ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•  ê±°ì—ìš”. ì´ ì„ íƒì€ PAYG ìš”ê¸ˆì œë¥¼ ì‚¬ìš©í•´. Windows Server í‰ê°€íŒì„ ì‚¬ìš©í•  ê³„íšì´ë¼ë©´, ìì²´ ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•˜ê³  í…Œë¼í¼ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©ì ì •ì˜ ì´ë¯¸ì§€ OCIDë¡œ ì„¤ì •í•´ì•¼ í•´ìš”:\n\nOracle Cloud Infrastructure ì´ë¯¸ì§€\n\n2- í…Œë¼í¼ ìŠ¤í¬ë¦½íŠ¸ì™€ PowerShell ìŠ¤í¬ë¦½íŠ¸ëŠ” ad â†’GOAD â†’providers â†’OCI í•˜ìœ„ì— ì¶”ê°€ëì–´ìš”.\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n![Screenshot](/assets/img/2024-06-19-HowtorunGameofActiveDirectoryinOCIPart1_0.png)\n\n```js\n./goad.sh -t check -l GOAD -p oci -m local\n```\n\n3- ì„œë¡œ ë‹¤ë¥¸ ê³µê¸‰ì—…ì²´ì—ì„œ ì‚¬ìš©ìë“¤ì´ ì•Œê³  ìˆëŠ” ë™ì¼í•œ ì›Œí¬í”Œë¡œë¥¼ ì œê³µí•˜ê¸° ìœ„í•´ goad.sh ìŠ¤í¬ë¦½íŠ¸ì— ì œê³µìë¡œ ocië¥¼ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.\n\n![Screenshot](/assets/img/2024-06-19-HowtorunGameofActiveDirectoryinOCIPart1_1.png)\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\nOCIì—ì„œ ìš°ë¶„íˆ¬ì˜ ê¸°ë³¸ ì‚¬ìš©ìëŠ” ubuntuì´ë¯€ë¡œ goad.shì˜ ëª¨ë“  ì°¸ì¡°ëŠ” ubuntu ì‚¬ìš©ìë¥¼ ì‚¬ìš©í•  ê²ƒì…ë‹ˆë‹¤:\n\n![2024-06-19-HowtorunGameofActiveDirectoryinOCIPart1_2](/assets/img/2024-06-19-HowtorunGameofActiveDirectoryinOCIPart1_2.png)\n\n4. ìŠ¤í¬ë¦½íŠ¸ ì•„ë˜ì—, ì €ëŠ” ì„¤ì¹˜ í›„ ìš°ë¶„íˆ¬ ì„œë²„ì˜ ì„ í–‰ ì¡°ê±´ì„ ì„¤ì¹˜í•˜ê¸° ìœ„í•´ setup_oci.sh ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.\n\n![2024-06-19-HowtorunGameofActiveDirectoryinOCIPart1_3](/assets/img/2024-06-19-HowtorunGameofActiveDirectoryinOCIPart1_3.png)\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n5- ì˜¤ë¼í´ í´ë¼ìš°ë“œ ì¸í”„ë¼ì—ì„œ ë©ì„ í”„ë¡œë¹„ì €ë‹í•˜ëŠ” ë°©ë²•ì„ ì„¤ëª…í•˜ëŠ” docs/install_with_oci.mdë¥¼ ì—…ë°ì´íŠ¸í–ˆìŠµë‹ˆë‹¤.\n\n6- ad â†’GOAD â†’providers â†’oci â†’ssh_keys â†’ubuntu-jumpox.pemì— ê°œì¸ í‚¤ë¥¼ ë°°ì¹˜í•˜ì—¬ Ubuntu ì¸ìŠ¤í„´ìŠ¤ì— ì—°ê²°ì„ í…ŒìŠ¤íŠ¸í–ˆìŠµë‹ˆë‹¤.\n\n!!!! ì´ í‚¤ë¥¼ ë§¤ìš° ì£¼ì˜í•´ì„œ ë‹¤ë£¨ê³ , gitì— ê³µê°œí•˜ì§€ ë§ˆì„¸ìš”.\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-19-HowtorunGameofActiveDirectoryinOCIPart1_4.png)\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\ní…Œì´ë¸” íƒœê·¸ë¥¼ ë§ˆí¬ë‹¤ìš´ í˜•ì‹ìœ¼ë¡œ ë³€ê²½í•˜ì˜€ìŠµë‹ˆë‹¤.\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n9- ad â†’ GOAD â†’ providers â†’ oci â†’ terraform í´ë”ì— Terraform/PowerShell íŒŒì¼ì„ ë§Œë“¤ì–´ì£¼ì„¸ìš”:\n\n- windows_cloud_init.ps1\n\n```powershell\n# ë³€ìˆ˜\n$adminUsername = â€œansibleâ€\n$adminPassword = ConvertTo-SecureString â€œYourSecurePassword123!â€ -AsPlainText -Force\n\n# ansible ì‚¬ìš©ì ìƒì„±\nNew-LocalUser $adminUsername -Password $adminPassword -FullName $adminUsername -Description â€œAnsible admin userâ€\nAdd-LocalGroupMember -Group â€œAdministratorsâ€ -Member $adminUsername\n\n# WinRM í™œì„±í™”\nwinrm quickconfig -q\nwinrm set winrm/config/service/auth @{Basic=â€trueâ€}\nwinrm set winrm/config/service @{AllowUnencrypted=â€trueâ€}\nwinrm set winrm/config/service @{EnableCompatibilityHttpsListener=â€trueâ€}\nwinrm set winrm/config/service @{EnableCompatibilityHttpListener=â€trueâ€}\n$cert = New-SelfSignedCertificate -DnsName $(hostname) -CertStoreLocation Cert:\\LocalMachine\\My\nwinrm create winrm/config/Listener?Address=*+Transport=HTTPS @{Hostname=$(hostname); CertificateThumbprint=$($cert.Thumbprint)}\nSet-Service -Name winrm -StartupType Automatic\nStart-Service -Name winrm\n\n# WinRMì„ ìœ„í•œ ê¸°ë³¸ ì¸ì¦ ë° ì•”í˜¸í™” íŠ¸ë˜í”½ í™œì„±í™”\nSet-Item -Path WSMan:\\localhost\\Service\\Auth\\Basic -Value $true\nSet-Item -Path WSMan:\\localhost\\Service\\AllowUnencrypted -Value $true\n\n# WinRM ë°©í™”ë²½ ì˜ˆì™¸ ì„¤ì •\nNew-NetFirewallRule -Name \"WinRM-HTTP\" -DisplayName \"WinRM (HTTP-In)\" -Protocol TCP -LocalPort 5985 -Action Allow -Enabled True\nNew-NetFirewallRule -Name \"WinRM-HTTPS\" -DisplayName \"WinRM (HTTPS-In)\" -Protocol TCP -LocalPort 5986 -Action Allow -Enabled True\n\n# TLS 1.2 í”„ë¡œí† ì½œ ì„¤ì •\n[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12\n\n# NuGet ê³µê¸‰ì ì„¤ì¹˜ ë° PowerShellGet ì—…ë°ì´íŠ¸\nInstall-PackageProvider -Name NuGet -Force -Confirm:$false\nUpdate-Module -Name PowerShellGet -Force -AllowClobber -Confirm:$false\n```\n\n- profile.tf\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n```js\nprovider \"oci\" {\n  tenancy_ocid      = var.tenancy_ocid\n  user_ocid         = var.user_ocid\n  fingerprint       = var.fingerprint\n  private_key_path  = var.private_key_path\n  region            = var.region\n}\n```\n\nvariables.tf\n\n```js\nvariable \"tenancy_ocid\" {\n  description = \"The OCID of your tenancy.\"\n  type        = string\n}\n\nvariable \"user_ocid\" {\n  description = \"The OCID of the user calling the API.\"\n  type        = string\n}\n\nvariable \"fingerprint\" {\n  description = \"The fingerprint of the API key.\"\n  type        = string\n}\n\nvariable \"private_key_path\" {\n  description = \"The path to the private key.\"\n  type        = string\n  default     = \"/Users/abirzu/.ssh/newpemkey.pem\"\n}\n\nvariable \"region\" {\n  description = \"The region to use.\"\n  type        = string\n  default     = \"eu-frankfurt-1\"\n}\n\nvariable \"compartment_ocid\" {\n  description = \"The OCID of the compartment to use.\"\n  type        = string\n}\n\nvariable \"availability_domain\" {\n  description = \"The availability domain to use.\"\n  type        = string\n  default     = \"NoEK:EU-FRANKFURT-1-AD-1\"\n}\n\nvariable \"shape\" {\n  description = \"The shape of the instance to be created.\"\n  type        = string\n  default     = \"VM.Standard.E5.Flex\"\n}\n\nvariable \"ocpus\" {\n  description = \"The number of OCPUs to allocate.\"\n  type        = number\n  default     = 1\n}\n\nvariable \"memory_in_gbs\" {\n  description = \"The amount of memory in GBs.\"\n  type        = number\n  default     = 12\n}\n\nvariable \"ssh_authorized_keys\" {\n  description = \"The public key for SSH access to the instances.\"\n  type        = string\n}\n\nvariable \"image_ocid\" {\n  description = \"The OCID of the image to use.\"\n  type        = string\n}\n\nvariable \"windows2016_image_ocid\" {\n  description = \"The OCID of the Windows Server 2016 image.\"\n  type        = string\n}\n\nvariable \"windows2019_image_ocid\" {\n  description = \"The OCID of the Windows Server 2019 image.\"\n  type        = string\n}\n```\n\nnetwork.tf\n\n```js\n\n```\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n```js\nresource â€œoci_core_vcnâ€ â€œgenerated_oci_core_vcnâ€ {\n cidr_block = â€œ192.168.0.0/16â€\n compartment_id = var.compartment_ocid\n display_name = â€œgoad-virtual-networkâ€\n dns_label = â€œgoadvcnâ€\n}\nresource â€œoci_core_subnetâ€ â€œpublic_subnetâ€ {\n cidr_block = â€œ192.168.57.0/24â€\n compartment_id = var.compartment_ocid\n display_name = â€œpublic-subnetâ€\n dns_label = â€œpublicsubnetâ€\n vcn_id = oci_core_vcn.generated_oci_core_vcn.id\n route_table_id = oci_core_route_table.public_route_table.id\n}\nresource â€œoci_core_subnetâ€ â€œprivate_subnetâ€ {\n cidr_block = â€œ192.168.56.0/24â€\n compartment_id = var.compartment_ocid\n display_name = â€œprivate-subnetâ€\n dns_label = â€œprivatesubnetâ€\n vcn_id = oci_core_vcn.generated_oci_core_vcn.id\n route_table_id = oci_core_route_table.private_route_table.id\n prohibit_internet_ingress = true\n prohibit_public_ip_on_vnic = true\n security_list_ids = [oci_core_security_list.winrm_rdp_security_list.id]\n}\nresource â€œoci_core_internet_gatewayâ€ â€œgenerated_oci_core_internet_gatewayâ€ {\n compartment_id = var.compartment_ocid\n display_name = â€œInternet Gateway goad-virtual-networkâ€\n enabled = true\n vcn_id = oci_core_vcn.generated_oci_core_vcn.id\n}\nresource â€œoci_core_nat_gatewayâ€ â€œgenerated_oci_core_nat_gatewayâ€ {\n compartment_id = var.compartment_ocid\n display_name = â€œNAT Gateway goad-virtual-networkâ€\n vcn_id = oci_core_vcn.generated_oci_core_vcn.id\n}\nresource â€œoci_core_route_tableâ€ â€œpublic_route_tableâ€ {\n compartment_id = var.compartment_ocid\n vcn_id = oci_core_vcn.generated_oci_core_vcn.id\n display_name = â€œpublic-route-tableâ€\nroute_rules {\n destination = â€œ0.0.0.0/0â€\n destination_type = â€œCIDR_BLOCKâ€\n network_entity_id = oci_core_internet_gateway.generated_oci_core_internet_gateway.id\n }\n}\nresource â€œoci_core_route_tableâ€ â€œprivate_route_tableâ€ {\n compartment_id = var.compartment_ocid\n vcn_id = oci_core_vcn.generated_oci_core_vcn.id\n display_name = â€œprivate-route-tableâ€\nroute_rules {\n destination = â€œ0.0.0.0/0â€\n destination_type = â€œCIDR_BLOCKâ€\n network_entity_id = oci_core_nat_gateway.generated_oci_core_nat_gateway.id\n }\n}\n  options {\n    type                  = \"DomainNameServer\"\n    server_type           = \"CustomDnsServer\"\n    custom_dns_servers    = [\"192.168.56.10\",\"8.8.8.8\"]\n  }\n options {\n        type = \"SearchDomain\"\n        search_domain_names = [ \"sevenkingdoms.local\" ]\n    }\n}\nresource â€œoci_core_security_listâ€ â€œwinrm_rdp_security_listâ€ {\n compartment_id = var.compartment_ocid\n vcn_id = oci_core_vcn.generated_oci_core_vcn.id\n display_name = â€œwinrm_rdp_security_listâ€\negress_security_rules {\n protocol = â€œallâ€\n destination = â€œ0.0.0.0/0â€\n stateless = false\n }\ningress_security_rules {\n protocol = â€œallâ€\n source = â€œ192.168.0.0/16â€\n stateless = false\n }\n}\n```\n\n```js\nresource â€œoci_core_default_dhcp_optionsâ€ â€œdefault_dhcp_optionsâ€ {\n manage_default_resource_id = oci_core_vcn.generated_oci_core_vcn.default_dhcp_options_id\noptions {\n type = â€œDomainNameServerâ€\n server_type = â€œCustomDnsServerâ€\n custom_dns_servers = [â€œ192.168.56.10â€]\n search_domain_names = [â€œsevenkingdoms.localâ€]\n }\n```\n\nThe DHCP configuration part is essential, as if itâ€™s not properly configured, it will result in the failure of the ansible jobs. If the terraform variable will not add the search domain, you need to do this manually:\n\nGo to the VCN â†’ DHCP Options:\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n<img src=\"/assets/img/2024-06-19-HowtorunGameofActiveDirectoryinOCIPart1_7.png\" />\n\ní™”ë©´ ì˜¤ë¥¸ìª½ ìƒë‹¨ì— ìˆëŠ” 3 ì ì„ í´ë¦­í•œ í›„ í¸ì§‘ì„ ì„ íƒí•˜ì„¸ìš”. ì—¬ê¸°ì—ì„œ ì™¸ë¶€ DNS ì„œë²„ë¥¼ ì¶”ê°€í•˜ê³  ì‚¬ìš©ì ì •ì˜ ê²€ìƒ‰ ë„ë©”ì¸ì¸ Seven Kingdomsë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n<img src=\"/assets/img/2024-06-19-HowtorunGameofActiveDirectoryinOCIPart1_8.png\" />\n\nì´ ë¶€ë¶„ì—ì„œ DNS ë¬¸ì œë¥¼ í•´ê²°í•´ì•¼í•©ë‹ˆë‹¤.\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n```js\noptions {\ntype = \"ë„ë©”ì¸ ë„¤ì„ ì„œë²„\"\nserver_type = \"ì‚¬ìš©ì ì •ì˜ DNS ì„œë²„\"\ncustom_dns_servers = [\"192.168.56.10\",\"8.8.8.8\"]\n}\noptions {\ntype = \"ê²€ìƒ‰ ë„ë©”ì¸\"\nsearch_domain_names = [\"seven kingdoms.local\"]\n}\n```\n\njumpbox.tf\n\n```js\nresource \"oci_core_instance\" \"jumpbox\" {\n availability_domain = var.availability_domain\n compartment_id = var.compartment_ocid\n display_name = \"jumpbox\"\n shape = var.shape\nshape_config {\n baseline_ocpu_utilization = \"BASELINE_1_1\"\n memory_in_gbs = var.memory_in_gbs\n ocpus = var.ocpus\n }\nsource_details {\n source_id = var.image_ocid\n source_type = \"ì´ë¯¸ì§€\"\n }\n#ì´ë¯¸ì§€ OCIDâ€™S https://docs.oracle.com/en-us/iaas/images/image/bd616d0a-fae4-490e-bd31-a9406095b844/\n create_vnic_details {\n assign_ipv6ip = false\n assign_private_dns_record = true\n assign_public_ip = true\n subnet_id = oci_core_subnet.public_subnet.id\n }\nmetadata = {\n ssh_authorized_keys = var.ssh_authorized_keys\n }\nagent_config {\n is_management_disabled = false\n is_monitoring_disabled = false\nplugins_config {\n desired_state = \"ì‚¬ìš© ì•ˆ í•¨\"\n name = \"ì·¨ì•½ì  ìŠ¤ìºë‹\"\n }\n plugins_config {\n desired_state = \"ì‚¬ìš© ì•ˆ í•¨\"\n name = \"ê´€ë¦¬ ì—ì´ì „íŠ¸\"\n }\n plugins_config {\n desired_state = \"ì‚¬ìš©í•¨\"\n name = \"ì‚¬ìš©ì ì§€ì • ë¡œê·¸ ëª¨ë‹ˆí„°ë§\"\n }\n plugins_config {\n desired_state = \"ì‚¬ìš© ì•ˆ í•¨\"\n name = \"ì»´í“¨íŒ… RDMA GPU ëª¨ë‹ˆí„°ë§\"\n }\n plugins_config {\n desired_state = \"ì‚¬ìš©í•¨\"\n name = \"ì»´í“¨íŒ… ì¸ìŠ¤í„´ìŠ¤ ëª¨ë‹ˆí„°ë§\"\n }\n plugins_config {\n desired_state = \"ì‚¬ìš© ì•ˆ í•¨\"\n name = \"ì»´í“¨íŒ… HPC RDMA ìë™ êµ¬ì„±\"\n }\n plugins_config {\n desired_state = \"ì‚¬ìš© ì•ˆ í•¨\"\n name = \"ì»´í“¨íŒ… HPC RDMA ì¸ì¦\"\n }\n plugins_config {\n desired_state = \"ì‚¬ìš©í•¨\"\n name = \"í´ë¼ìš°ë“œ ê°€ë“œ ì›Œí¬ë¡œë“œ ë³´í˜¸\"\n }\n plugins_config {\n desired_state = \"ì‚¬ìš© ì•ˆ í•¨\"\n name = \"ë¸”ë¡ ë³¼ë¥¨ ê´€ë¦¬\"\n }\n plugins_config {\n desired_state = \"ì‚¬ìš© ì•ˆ í•¨\"\n name = \"ë°”ìŠ¤ì²œ\"\n }\n }\navailability_config {\n is_live_migration_preferred = true\n recovery_action = \"ì¸ìŠ¤í„´ìŠ¤ ë³µì›\"\n }\nplatform_config {\n is_symmetric_multi_threading_enabled = true\n type = \"AMD_VM\"\n }\ninstance_options {\n are_legacy_imds_endpoints_disabled = false\n }\n}\n```\n\nwindowsvm.tf\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n```js\në¦¬ì†ŒìŠ¤ \"oci_core_instance\" \"windows_instance\" {\n for_each = {\n kingslanding = {\n name = \"kingslanding\"\n private_ip_address = \"192.168.56.10\"\n admin_username = \"ansible\"\n admin_password = \"8dCT-DJjgScp\"\n image_ocid = var.windows2019_image_ocid\n }\n winterfell = {\n name = \"winterfell\"\n private_ip_address = \"192.168.56.11\"\n admin_username = \"ansible\"\n admin_password = \"NgtI75cKV+Pu\"\n image_ocid = var.windows2019_image_ocid\n }\n castelblack = {\n name = \"castelblack\"\n private_ip_address = \"192.168.56.22\"\n admin_username = \"ansible\"\n admin_password = \"NgtI75cKV+Pu\"\n image_ocid = var.windows2019_image_ocid\n }\n meereen = {\n name = \"meereen\"\n private_ip_address = \"192.168.56.12\"\n admin_username = \"ansible\"\n admin_password = \"Ufe-bVXSx9rk\"\n image_ocid = var.windows2016_image_ocid\n }\n braavos = {\n name = \"braavos\"\n private_ip_address = \"192.168.56.23\"\n admin_username = \"ansible\"\n admin_password = \"978i2pF43UJ-\"\n image_ocid = var.windows2016_image_ocid\n }\n }\navailability_domain = var.availability_domain\n compartment_id = var.compartment_ocid\n display_name = each.value.name\n shape = \"VM.Standard.E5.Flex\"\nshape_config {\n ocpus = 2\n memory_in_gbs = 32\n }\nsource_details {\n source_id = each.value.image_ocid\n source_type = \"image\"\n }\ncreate_vnic_details {\n assign_ipv6ip = false\n assign_private_dns_record = true\n assign_public_ip = false\n subnet_id = oci_core_subnet.private_subnet.id\n hostname_label = each.value.name\n private_ip = each.value.private_ip_address\n }\nmetadata = {\n user_data = base64encode(file(\"${path.module}/windows_cloud_init.ps1\"))\n admin_password = each.value.admin_password\n }\n}\n```\n\noutputs.tf\n\n```js\noutput \"ubuntu_jumpbox_ip\" {\n value = oci_core_instance.jumpbox.public_ip\n}\noutput \"windows_instance_opc_passwords\" {\n value = { for k, v in oci_core_instance.windows_instance : k => v.metadata.admin_password }\n sensitive = true\n}\n```\n\ní”„ë¡œë¹„ì €ë‹ ì¤‘ ë°œìƒí•œ ì¼ë°˜ì ì¸ ì˜¤ë¥˜ì…ë‹ˆë‹¤.\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\në‹¤ìŒê³¼ ê°™ì´ Markdown í˜•ì‹ì— ë§ê²Œ í‘œ íƒœê·¸ë¥¼ ë³€ê²½í•˜ì‹­ì‹œì˜¤.\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-19-HowtorunGameofActiveDirectoryinOCIPart1_9.png)\n\nëª¨ë“  TFê°€ ìƒì„±ëœ í›„, GOAD git ì €ì¥ì†Œê°€ ì •ìƒì ìœ¼ë¡œ ë™ê¸°í™”ëœ ê²½ìš° ë‹¤ìŒì„ ì‹¤í–‰í•´ì•¼ í•©ë‹ˆë‹¤:\n\nabirzu@abirzu-mac GOAD % ./goad.sh -t destroy -l GOAD -p oci -m local\n\nëª¨ë“  ì„œë²„ê°€ ê°€ë™ë˜ê³  ì‘ë™ ì¤‘ì¸ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n<img src=\"/assets/img/2024-06-19-HowtorunGameofActiveDirectoryinOCIPart1_10.png\" />\n\nì¶•í•˜í•©ë‹ˆë‹¤! í™˜ê²½ì´ ì‘ë™ ì¤‘ì— ìˆìŠµë‹ˆë‹¤.\n\n# ì„œë²„\n\nì´ ë©ì€ ì‹¤ì œë¡œ ë‹¤ì„¯ ê°œì˜ ê°€ìƒ ë¨¸ì‹ ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤:\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n- kingslanding: DC01ëŠ” Windows Server 2019ì—ì„œ ì‹¤í–‰ ì¤‘ì…ë‹ˆë‹¤(ê¸°ë³¸ìœ¼ë¡œ windefenderê°€ í™œì„±í™”ë¨)\n- winterfell: DC02ëŠ” Windows Server 2019ì—ì„œ ì‹¤í–‰ ì¤‘ì…ë‹ˆë‹¤(ê¸°ë³¸ìœ¼ë¡œ windefenderê°€ í™œì„±í™”ë¨)\n- castelblack: SRV02ëŠ” Windows Server 2019ì—ì„œ ì‹¤í–‰ ì¤‘ì…ë‹ˆë‹¤(windefenderê°€ ê¸°ë³¸ì ìœ¼ë¡œ ë¹„í™œì„±í™”ë¨)\n- meereen: DC03ì€ Windows Server 2016ì—ì„œ ì‹¤í–‰ ì¤‘ì…ë‹ˆë‹¤(ê¸°ë³¸ìœ¼ë¡œ windefenderê°€ í™œì„±í™”ë¨)\n- braavos: SRV03ì€ Windows Server 2016ì—ì„œ ì‹¤í–‰ ì¤‘ì…ë‹ˆë‹¤(ê¸°ë³¸ìœ¼ë¡œ windefenderê°€ í™œì„±í™”ë¨)\n\në„ë©”ì¸: north.sevenkingdoms.local\n\n- winterfell: DC01\n- castelblack: SRV02: MSSQL / IIS\n\në„ë©”ì¸: sevenkingdoms.local\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n- kingslanding: DC02\n- castelrock: SRV01 (ìì› ë¶€ì¡±ìœ¼ë¡œ ë¹„í™œì„±í™”ë¨)\n\n# ë„ë©”ì¸: essos.local\n\n- braavos: DC03\n- meeren: SRV03: MSSQL / ADCS\n\nì¸í„°ë„·ì—ì„œ ëª‡ ê°€ì§€ ê°€ì´ë“œë¥¼ ë”°ë¥´ê±°ë‚˜ ìì‹ ë§Œì˜ ë°©ë²•ì„ ì°¾ì•„ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\nAD | Mayfly (mayfly277.github.io)\n\nSolving Game of Active Directory (GOAD) by Orange Cyberdefense Part-1 | by n00ğŸ”‘ | Medium\n\nì œ1ë¶€ì—ì„œëŠ” OCIì—ì„œ GOAD ë©ì„ ë§Œë“œëŠ” ë°©ë²•ì„ ì†Œê°œí–ˆê³ , ë‹¤ìŒ ë¶€ë¶„ì—ì„œëŠ” ë‹¤ìŒì— ì´ˆì ì„ ë§ì¶œ ê²ƒì…ë‹ˆë‹¤:\n\nOCI í†µí•©:\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n1. OCI Management Agent:\n\n- ì„¤ëª…: í´ë¼ìš°ë“œ ì‘ì—…ì„ ìë™í™”í•˜ê³  ëª¨ë‹ˆí„°ë§í•©ë‹ˆë‹¤.\n- í†µí•©: GOAD í™˜ê²½ ë‚´ ìì›ì˜ ë°°í¬ ë° ê´€ë¦¬ë¥¼ ê°„ì†Œí™”í•©ë‹ˆë‹¤.\n\n2. Sysmon ë° ë¡œê¹… ë¶„ì„:\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\nâ€¢ ì„¤ëª…: Sysmonì€ ì‹œìŠ¤í…œ í™œë™ì„ ê¸°ë¡í•˜ì—¬ ì¹¨ì… íƒì§€ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.\n\nâ€¢ í†µí•©: Sysmon ì´ë²¤íŠ¸ë¥¼ ìˆ˜ì§‘í•˜ê³  OCI Logging Analyticsë¡œ ì „ì†¡í•˜ì—¬ ê³ ê¸‰ ë¡œê·¸ ë¶„ì„ ë° ì‹œê°í™”ë¥¼ ì§€ì›í•©ë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ ì—¬ê¸°ì—ì„œ í™•ì¸í•˜ì„¸ìš”.\n\n3. Arkime í†µí•©:\n\nâ€¢ ì„¤ëª…: Arkimeì€ ì˜¤í”ˆ ì†ŒìŠ¤ íŒ¨í‚· ìº¡ì²˜ ë° ê²€ìƒ‰ ë„êµ¬ì…ë‹ˆë‹¤.\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\nâ€¢ í†µí•©: íš¨ìœ¨ì ì¸ ë°ì´í„° ìƒ‰ì¸ ë° ê²€ìƒ‰ì„ ìœ„í•´ OCI OpenSearchë¥¼ í™œìš©í•©ë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ ì—¬ê¸°ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n4. í´ë¼ìš°ë“œ ê°€ë“œ ì¸ìŠ¤í„´ìŠ¤ ë³´ì•ˆ:\n\nâ€¢ ì„¤ëª…: í´ë¼ìš°ë“œ ê°€ë“œëŠ” í¬ê´„ì ì¸ í´ë¼ìš°ë“œ ë³´ì•ˆ ê´€ë¦¬ë¥¼ ì œê³µí•©ë‹ˆë‹¤.\n\nâ€¢ í†µí•©: ë¡œê¹… ë¶„ì„ì„ í™œìš©í•˜ì—¬ ì¸ìŠ¤í„´ìŠ¤ ë³´ì•ˆì„ ê°•í™”í•˜ë©° ì‹¤ì‹œê°„ ìœ„í˜‘ ê°ì§€ ë° ëŒ€ì‘ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ë” ë§ì€ ì •ë³´ëŠ” ì—¬ê¸°ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n","ogImage":{"url":"/assets/img/2024-06-19-HowtorunGameofActiveDirectoryinOCIPart1_0.png"},"coverImage":"/assets/img/2024-06-19-HowtorunGameofActiveDirectoryinOCIPart1_0.png","tag":["Tech"],"readingTime":20},"content":"<!doctype html>\n<html lang=\"en\">\n<head>\n<meta charset=\"utf-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n</head>\n<body>\n<p>ì œê°€ ì •ë§ ì¦ê²ê²Œ ì¦ê²¼ë˜ í”„ë¡œì íŠ¸ ì¤‘ í•˜ë‚˜ëŠ” GOADì…ë‹ˆë‹¤. ê²Œì„ ì˜¤ë¸Œ ìŠ¤ë¡œìš´ì¦ˆ íŒ¬ìœ¼ë¡œì„œ ì‚¬ì´ë²„ ì§€ì‹ì„ ì‹œí—˜í•˜ê³  ë™ì‹œì— ì¦ê¸¸ ìˆ˜ ìˆëŠ” ìˆ˜ë‹¨ì´ì—ˆìŠµë‹ˆë‹¤. ë§Œì•½ ì—¬ëŸ¬ë¶„ì´ ìŠ¤ë¡œìš´ì¦ˆì˜ íŒ¬ì´ë¼ë©´, ì´ Windows/AD/SCCM ë©ì€ ì—¬ëŸ¬ë¶„ì„ ìœ„í•œ ê²ƒì…ë‹ˆë‹¤.</p>\n<p>ì²˜ìŒì—ëŠ” ì¤‘ì²© ê°€ìƒí™” ì„œë²„ë¥¼ ë§Œë“¤ë ¤ê³  í–ˆëŠ”ë°, í…Œë¼í¼ê³¼ ì•¤ì„œë¸” ì§€ì‹ì´ ê±°ì˜ ì—†ì–´ì„œ ì–´ë ¤ì›€ì„ ê²ªì—ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì €ëŠ” ìë™í™”ë¡œ ë‚˜ì•„ê°€ê¸°ë¡œ ê²°ì •í–ˆìŠµë‹ˆë‹¤. ì¼ìƒì ì¸ ì‘ì—…ì—ì„œ ì‹œê°„ì„ ì ˆì•½í•˜ê³ , ì˜¬ë°”ë¥´ê²Œ êµ¬í˜„ëœë‹¤ë©´ ì¸ê°„ ì—ëŸ¬ë¥¼ ì¤„ì¼ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ìë™í™”ê°€ ë§ì€ ë„ì›€ì´ ëœë‹¤ëŠ” ì ì— ë™ì˜í•©ë‹ˆë‹¤.</p>\n<p><code>Game of Active Directory (GOAD)</code> í”„ë¡œì íŠ¸ëŠ” í˜„ì‹¤ì ì´ê³  ì‹¤ìš©ì ì¸ ê²½í—˜ì„ í†µí•´ ì‚¬ì´ë²„ ë³´ì•ˆ ê¸°ìˆ ì„ í–¥ìƒì‹œí‚¤ëŠ” í¬ê´„ì ì¸ ë© í™˜ê²½ì…ë‹ˆë‹¤. Oracle Cloud Infrastructure (OCI)ì—ì„œ í˜¸ìŠ¤íŒ…ë˜ë©°, ë‹¤ì–‘í•œ OCI ì„œë¹„ìŠ¤ì™€ í†µí•©í•˜ì—¬ í˜„ì‹¤ ì„¸ê³„ì˜ ë³´ì•ˆ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ëª¨ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p><a href=\"https://github.com/adibirzu/GOAD/blob/main/docs/install_with_oci.md\" rel=\"nofollow\" target=\"_blank\">https://github.com/adibirzu/GOAD/blob/main/docs/install_with_oci.md</a></p>\n<p></p>\n<p>ë© í™˜ê²½ìœ¼ë¡œì„œ VCN ë³´ì•ˆ ëª©ë¡ì—ì„œ ì—„ê²©í•œ ACLì„ êµ¬í˜„í•˜ì§€ëŠ” ì•Šì•˜ì–´ìš”. ê·¸ëŸ¬ë‚˜ ëª¨ë“  í¬íŠ¸ì—ì„œ 192.168.0.0/16ì—ì„œì˜ ì•¡ì„¸ìŠ¤ëŠ” í—ˆìš©í–ˆì–´ìš”.</p>\n<p>1- ìš°ë¦¬ëŠ” OCIì˜ Windows Server/Ubuntu ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•  ê±°ì—ìš”. ì´ ì„ íƒì€ PAYG ìš”ê¸ˆì œë¥¼ ì‚¬ìš©í•´. Windows Server í‰ê°€íŒì„ ì‚¬ìš©í•  ê³„íšì´ë¼ë©´, ìì²´ ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•˜ê³  í…Œë¼í¼ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©ì ì •ì˜ ì´ë¯¸ì§€ OCIDë¡œ ì„¤ì •í•´ì•¼ í•´ìš”:</p>\n<p>Oracle Cloud Infrastructure ì´ë¯¸ì§€</p>\n<p>2- í…Œë¼í¼ ìŠ¤í¬ë¦½íŠ¸ì™€ PowerShell ìŠ¤í¬ë¦½íŠ¸ëŠ” ad â†’GOAD â†’providers â†’OCI í•˜ìœ„ì— ì¶”ê°€ëì–´ìš”.</p>\n<p></p>\n<p><img src=\"/assets/img/2024-06-19-HowtorunGameofActiveDirectoryinOCIPart1_0.png\" alt=\"Screenshot\"></p>\n<pre><code class=\"hljs language-js\">./goad.<span class=\"hljs-property\">sh</span> -t check -l <span class=\"hljs-variable constant_\">GOAD</span> -p oci -m local\n</code></pre>\n<p>3- ì„œë¡œ ë‹¤ë¥¸ ê³µê¸‰ì—…ì²´ì—ì„œ ì‚¬ìš©ìë“¤ì´ ì•Œê³  ìˆëŠ” ë™ì¼í•œ ì›Œí¬í”Œë¡œë¥¼ ì œê³µí•˜ê¸° ìœ„í•´ goad.sh ìŠ¤í¬ë¦½íŠ¸ì— ì œê³µìë¡œ ocië¥¼ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.</p>\n<p><img src=\"/assets/img/2024-06-19-HowtorunGameofActiveDirectoryinOCIPart1_1.png\" alt=\"Screenshot\"></p>\n<p></p>\n<p>OCIì—ì„œ ìš°ë¶„íˆ¬ì˜ ê¸°ë³¸ ì‚¬ìš©ìëŠ” ubuntuì´ë¯€ë¡œ goad.shì˜ ëª¨ë“  ì°¸ì¡°ëŠ” ubuntu ì‚¬ìš©ìë¥¼ ì‚¬ìš©í•  ê²ƒì…ë‹ˆë‹¤:</p>\n<p><img src=\"/assets/img/2024-06-19-HowtorunGameofActiveDirectoryinOCIPart1_2.png\" alt=\"2024-06-19-HowtorunGameofActiveDirectoryinOCIPart1_2\"></p>\n<ol start=\"4\">\n<li>ìŠ¤í¬ë¦½íŠ¸ ì•„ë˜ì—, ì €ëŠ” ì„¤ì¹˜ í›„ ìš°ë¶„íˆ¬ ì„œë²„ì˜ ì„ í–‰ ì¡°ê±´ì„ ì„¤ì¹˜í•˜ê¸° ìœ„í•´ setup_oci.sh ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.</li>\n</ol>\n<p><img src=\"/assets/img/2024-06-19-HowtorunGameofActiveDirectoryinOCIPart1_3.png\" alt=\"2024-06-19-HowtorunGameofActiveDirectoryinOCIPart1_3\"></p>\n<p></p>\n<p>5- ì˜¤ë¼í´ í´ë¼ìš°ë“œ ì¸í”„ë¼ì—ì„œ ë©ì„ í”„ë¡œë¹„ì €ë‹í•˜ëŠ” ë°©ë²•ì„ ì„¤ëª…í•˜ëŠ” docs/install_with_oci.mdë¥¼ ì—…ë°ì´íŠ¸í–ˆìŠµë‹ˆë‹¤.</p>\n<p>6- ad â†’GOAD â†’providers â†’oci â†’ssh_keys â†’ubuntu-jumpox.pemì— ê°œì¸ í‚¤ë¥¼ ë°°ì¹˜í•˜ì—¬ Ubuntu ì¸ìŠ¤í„´ìŠ¤ì— ì—°ê²°ì„ í…ŒìŠ¤íŠ¸í–ˆìŠµë‹ˆë‹¤.</p>\n<p>!!!! ì´ í‚¤ë¥¼ ë§¤ìš° ì£¼ì˜í•´ì„œ ë‹¤ë£¨ê³ , gitì— ê³µê°œí•˜ì§€ ë§ˆì„¸ìš”.</p>\n<p><img src=\"/assets/img/2024-06-19-HowtorunGameofActiveDirectoryinOCIPart1_4.png\" alt=\"ì´ë¯¸ì§€\"></p>\n<p></p>\n<p>í…Œì´ë¸” íƒœê·¸ë¥¼ ë§ˆí¬ë‹¤ìš´ í˜•ì‹ìœ¼ë¡œ ë³€ê²½í•˜ì˜€ìŠµë‹ˆë‹¤.</p>\n<p></p>\n<p>9- ad â†’ GOAD â†’ providers â†’ oci â†’ terraform í´ë”ì— Terraform/PowerShell íŒŒì¼ì„ ë§Œë“¤ì–´ì£¼ì„¸ìš”:</p>\n<ul>\n<li>windows_cloud_init.ps1</li>\n</ul>\n<pre><code class=\"hljs language-powershell\"><span class=\"hljs-comment\"># ë³€ìˆ˜</span>\n<span class=\"hljs-variable\">$adminUsername</span> = â€œansibleâ€\n<span class=\"hljs-variable\">$adminPassword</span> = <span class=\"hljs-built_in\">ConvertTo-SecureString</span> â€œYourSecurePassword123!â€ <span class=\"hljs-literal\">-AsPlainText</span> <span class=\"hljs-literal\">-Force</span>\n\n<span class=\"hljs-comment\"># ansible ì‚¬ìš©ì ìƒì„±</span>\n<span class=\"hljs-built_in\">New-LocalUser</span> <span class=\"hljs-variable\">$adminUsername</span> <span class=\"hljs-literal\">-Password</span> <span class=\"hljs-variable\">$adminPassword</span> <span class=\"hljs-literal\">-FullName</span> <span class=\"hljs-variable\">$adminUsername</span> <span class=\"hljs-literal\">-Description</span> â€œAnsible admin userâ€\n<span class=\"hljs-built_in\">Add-LocalGroupMember</span> <span class=\"hljs-literal\">-Group</span> â€œAdministratorsâ€ <span class=\"hljs-literal\">-Member</span> <span class=\"hljs-variable\">$adminUsername</span>\n\n<span class=\"hljs-comment\"># WinRM í™œì„±í™”</span>\nwinrm quickconfig <span class=\"hljs-literal\">-q</span>\nwinrm <span class=\"hljs-built_in\">set</span> winrm/config/service/auth <span class=\"hljs-selector-tag\">@</span>{Basic=â€trueâ€}\nwinrm <span class=\"hljs-built_in\">set</span> winrm/config/service <span class=\"hljs-selector-tag\">@</span>{AllowUnencrypted=â€trueâ€}\nwinrm <span class=\"hljs-built_in\">set</span> winrm/config/service <span class=\"hljs-selector-tag\">@</span>{EnableCompatibilityHttpsListener=â€trueâ€}\nwinrm <span class=\"hljs-built_in\">set</span> winrm/config/service <span class=\"hljs-selector-tag\">@</span>{EnableCompatibilityHttpListener=â€trueâ€}\n<span class=\"hljs-variable\">$cert</span> = <span class=\"hljs-built_in\">New-SelfSignedCertificate</span> <span class=\"hljs-literal\">-DnsName</span> <span class=\"hljs-variable\">$</span>(hostname) <span class=\"hljs-literal\">-CertStoreLocation</span> Cert:\\LocalMachine\\My\nwinrm create winrm/config/Listener?Address=*+Transport=HTTPS <span class=\"hljs-selector-tag\">@</span>{Hostname=<span class=\"hljs-variable\">$</span>(hostname); CertificateThumbprint=<span class=\"hljs-variable\">$</span>(<span class=\"hljs-variable\">$cert</span>.Thumbprint)}\n<span class=\"hljs-built_in\">Set-Service</span> <span class=\"hljs-literal\">-Name</span> winrm <span class=\"hljs-literal\">-StartupType</span> Automatic\n<span class=\"hljs-built_in\">Start-Service</span> <span class=\"hljs-literal\">-Name</span> winrm\n\n<span class=\"hljs-comment\"># WinRMì„ ìœ„í•œ ê¸°ë³¸ ì¸ì¦ ë° ì•”í˜¸í™” íŠ¸ë˜í”½ í™œì„±í™”</span>\n<span class=\"hljs-built_in\">Set-Item</span> <span class=\"hljs-literal\">-Path</span> WSMan:\\localhost\\Service\\Auth\\Basic <span class=\"hljs-literal\">-Value</span> <span class=\"hljs-variable\">$true</span>\n<span class=\"hljs-built_in\">Set-Item</span> <span class=\"hljs-literal\">-Path</span> WSMan:\\localhost\\Service\\AllowUnencrypted <span class=\"hljs-literal\">-Value</span> <span class=\"hljs-variable\">$true</span>\n\n<span class=\"hljs-comment\"># WinRM ë°©í™”ë²½ ì˜ˆì™¸ ì„¤ì •</span>\n<span class=\"hljs-built_in\">New-NetFirewallRule</span> <span class=\"hljs-literal\">-Name</span> <span class=\"hljs-string\">\"WinRM-HTTP\"</span> <span class=\"hljs-literal\">-DisplayName</span> <span class=\"hljs-string\">\"WinRM (HTTP-In)\"</span> <span class=\"hljs-literal\">-Protocol</span> TCP <span class=\"hljs-literal\">-LocalPort</span> <span class=\"hljs-number\">5985</span> <span class=\"hljs-literal\">-Action</span> Allow <span class=\"hljs-literal\">-Enabled</span> True\n<span class=\"hljs-built_in\">New-NetFirewallRule</span> <span class=\"hljs-literal\">-Name</span> <span class=\"hljs-string\">\"WinRM-HTTPS\"</span> <span class=\"hljs-literal\">-DisplayName</span> <span class=\"hljs-string\">\"WinRM (HTTPS-In)\"</span> <span class=\"hljs-literal\">-Protocol</span> TCP <span class=\"hljs-literal\">-LocalPort</span> <span class=\"hljs-number\">5986</span> <span class=\"hljs-literal\">-Action</span> Allow <span class=\"hljs-literal\">-Enabled</span> True\n\n<span class=\"hljs-comment\"># TLS 1.2 í”„ë¡œí† ì½œ ì„¤ì •</span>\n[<span class=\"hljs-type\">Net.ServicePointManager</span>]::SecurityProtocol = [<span class=\"hljs-type\">Net.SecurityProtocolType</span>]::Tls12\n\n<span class=\"hljs-comment\"># NuGet ê³µê¸‰ì ì„¤ì¹˜ ë° PowerShellGet ì—…ë°ì´íŠ¸</span>\n<span class=\"hljs-built_in\">Install-PackageProvider</span> <span class=\"hljs-literal\">-Name</span> NuGet <span class=\"hljs-literal\">-Force</span> <span class=\"hljs-literal\">-Confirm</span>:<span class=\"hljs-variable\">$false</span>\n<span class=\"hljs-built_in\">Update-Module</span> <span class=\"hljs-literal\">-Name</span> PowerShellGet <span class=\"hljs-literal\">-Force</span> <span class=\"hljs-literal\">-AllowClobber</span> <span class=\"hljs-literal\">-Confirm</span>:<span class=\"hljs-variable\">$false</span>\n</code></pre>\n<ul>\n<li>profile.tf</li>\n</ul>\n<p></p>\n<pre><code class=\"hljs language-js\">provider <span class=\"hljs-string\">\"oci\"</span> {\n  tenancy_ocid      = <span class=\"hljs-keyword\">var</span>.<span class=\"hljs-property\">tenancy_ocid</span>\n  user_ocid         = <span class=\"hljs-keyword\">var</span>.<span class=\"hljs-property\">user_ocid</span>\n  fingerprint       = <span class=\"hljs-keyword\">var</span>.<span class=\"hljs-property\">fingerprint</span>\n  private_key_path  = <span class=\"hljs-keyword\">var</span>.<span class=\"hljs-property\">private_key_path</span>\n  region            = <span class=\"hljs-keyword\">var</span>.<span class=\"hljs-property\">region</span>\n}\n</code></pre>\n<p>variables.tf</p>\n<pre><code class=\"hljs language-js\">variable <span class=\"hljs-string\">\"tenancy_ocid\"</span> {\n  description = <span class=\"hljs-string\">\"The OCID of your tenancy.\"</span>\n  type        = string\n}\n\nvariable <span class=\"hljs-string\">\"user_ocid\"</span> {\n  description = <span class=\"hljs-string\">\"The OCID of the user calling the API.\"</span>\n  type        = string\n}\n\nvariable <span class=\"hljs-string\">\"fingerprint\"</span> {\n  description = <span class=\"hljs-string\">\"The fingerprint of the API key.\"</span>\n  type        = string\n}\n\nvariable <span class=\"hljs-string\">\"private_key_path\"</span> {\n  description = <span class=\"hljs-string\">\"The path to the private key.\"</span>\n  type        = string\n  <span class=\"hljs-keyword\">default</span>     = <span class=\"hljs-string\">\"/Users/abirzu/.ssh/newpemkey.pem\"</span>\n}\n\nvariable <span class=\"hljs-string\">\"region\"</span> {\n  description = <span class=\"hljs-string\">\"The region to use.\"</span>\n  type        = string\n  <span class=\"hljs-keyword\">default</span>     = <span class=\"hljs-string\">\"eu-frankfurt-1\"</span>\n}\n\nvariable <span class=\"hljs-string\">\"compartment_ocid\"</span> {\n  description = <span class=\"hljs-string\">\"The OCID of the compartment to use.\"</span>\n  type        = string\n}\n\nvariable <span class=\"hljs-string\">\"availability_domain\"</span> {\n  description = <span class=\"hljs-string\">\"The availability domain to use.\"</span>\n  type        = string\n  <span class=\"hljs-keyword\">default</span>     = <span class=\"hljs-string\">\"NoEK:EU-FRANKFURT-1-AD-1\"</span>\n}\n\nvariable <span class=\"hljs-string\">\"shape\"</span> {\n  description = <span class=\"hljs-string\">\"The shape of the instance to be created.\"</span>\n  type        = string\n  <span class=\"hljs-keyword\">default</span>     = <span class=\"hljs-string\">\"VM.Standard.E5.Flex\"</span>\n}\n\nvariable <span class=\"hljs-string\">\"ocpus\"</span> {\n  description = <span class=\"hljs-string\">\"The number of OCPUs to allocate.\"</span>\n  type        = number\n  <span class=\"hljs-keyword\">default</span>     = <span class=\"hljs-number\">1</span>\n}\n\nvariable <span class=\"hljs-string\">\"memory_in_gbs\"</span> {\n  description = <span class=\"hljs-string\">\"The amount of memory in GBs.\"</span>\n  type        = number\n  <span class=\"hljs-keyword\">default</span>     = <span class=\"hljs-number\">12</span>\n}\n\nvariable <span class=\"hljs-string\">\"ssh_authorized_keys\"</span> {\n  description = <span class=\"hljs-string\">\"The public key for SSH access to the instances.\"</span>\n  type        = string\n}\n\nvariable <span class=\"hljs-string\">\"image_ocid\"</span> {\n  description = <span class=\"hljs-string\">\"The OCID of the image to use.\"</span>\n  type        = string\n}\n\nvariable <span class=\"hljs-string\">\"windows2016_image_ocid\"</span> {\n  description = <span class=\"hljs-string\">\"The OCID of the Windows Server 2016 image.\"</span>\n  type        = string\n}\n\nvariable <span class=\"hljs-string\">\"windows2019_image_ocid\"</span> {\n  description = <span class=\"hljs-string\">\"The OCID of the Windows Server 2019 image.\"</span>\n  type        = string\n}\n</code></pre>\n<p>network.tf</p>\n<pre><code class=\"hljs language-js\"></code></pre>\n<p></p>\n<pre><code class=\"hljs language-js\">resource â€œoci_core_vcnâ€ â€œgenerated_oci_core_vcnâ€ {\n cidr_block = â€œ<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.0</span>/<span class=\"hljs-number\">16</span>â€\n compartment_id = <span class=\"hljs-keyword\">var</span>.<span class=\"hljs-property\">compartment_ocid</span>\n display_name = â€œgoad-virtual-networkâ€\n dns_label = â€œgoadvcnâ€\n}\nresource â€œoci_core_subnetâ€ â€œpublic_subnetâ€ {\n cidr_block = â€œ<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.57</span><span class=\"hljs-number\">.0</span>/<span class=\"hljs-number\">24</span>â€\n compartment_id = <span class=\"hljs-keyword\">var</span>.<span class=\"hljs-property\">compartment_ocid</span>\n display_name = â€œpublic-subnetâ€\n dns_label = â€œpublicsubnetâ€\n vcn_id = oci_core_vcn.<span class=\"hljs-property\">generated_oci_core_vcn</span>.<span class=\"hljs-property\">id</span>\n route_table_id = oci_core_route_table.<span class=\"hljs-property\">public_route_table</span>.<span class=\"hljs-property\">id</span>\n}\nresource â€œoci_core_subnetâ€ â€œprivate_subnetâ€ {\n cidr_block = â€œ<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.0</span>/<span class=\"hljs-number\">24</span>â€\n compartment_id = <span class=\"hljs-keyword\">var</span>.<span class=\"hljs-property\">compartment_ocid</span>\n display_name = â€œprivate-subnetâ€\n dns_label = â€œprivatesubnetâ€\n vcn_id = oci_core_vcn.<span class=\"hljs-property\">generated_oci_core_vcn</span>.<span class=\"hljs-property\">id</span>\n route_table_id = oci_core_route_table.<span class=\"hljs-property\">private_route_table</span>.<span class=\"hljs-property\">id</span>\n prohibit_internet_ingress = <span class=\"hljs-literal\">true</span>\n prohibit_public_ip_on_vnic = <span class=\"hljs-literal\">true</span>\n security_list_ids = [oci_core_security_list.<span class=\"hljs-property\">winrm_rdp_security_list</span>.<span class=\"hljs-property\">id</span>]\n}\nresource â€œoci_core_internet_gatewayâ€ â€œgenerated_oci_core_internet_gatewayâ€ {\n compartment_id = <span class=\"hljs-keyword\">var</span>.<span class=\"hljs-property\">compartment_ocid</span>\n display_name = â€œ<span class=\"hljs-title class_\">Internet</span> <span class=\"hljs-title class_\">Gateway</span> goad-virtual-networkâ€\n enabled = <span class=\"hljs-literal\">true</span>\n vcn_id = oci_core_vcn.<span class=\"hljs-property\">generated_oci_core_vcn</span>.<span class=\"hljs-property\">id</span>\n}\nresource â€œoci_core_nat_gatewayâ€ â€œgenerated_oci_core_nat_gatewayâ€ {\n compartment_id = <span class=\"hljs-keyword\">var</span>.<span class=\"hljs-property\">compartment_ocid</span>\n display_name = â€œ<span class=\"hljs-variable constant_\">NAT</span> <span class=\"hljs-title class_\">Gateway</span> goad-virtual-networkâ€\n vcn_id = oci_core_vcn.<span class=\"hljs-property\">generated_oci_core_vcn</span>.<span class=\"hljs-property\">id</span>\n}\nresource â€œoci_core_route_tableâ€ â€œpublic_route_tableâ€ {\n compartment_id = <span class=\"hljs-keyword\">var</span>.<span class=\"hljs-property\">compartment_ocid</span>\n vcn_id = oci_core_vcn.<span class=\"hljs-property\">generated_oci_core_vcn</span>.<span class=\"hljs-property\">id</span>\n display_name = â€œpublic-route-tableâ€\nroute_rules {\n destination = â€œ<span class=\"hljs-number\">0.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.0</span>/<span class=\"hljs-number\">0</span>â€\n destination_type = â€œ<span class=\"hljs-variable constant_\">CIDR_BLOCK</span>â€\n network_entity_id = oci_core_internet_gateway.<span class=\"hljs-property\">generated_oci_core_internet_gateway</span>.<span class=\"hljs-property\">id</span>\n }\n}\nresource â€œoci_core_route_tableâ€ â€œprivate_route_tableâ€ {\n compartment_id = <span class=\"hljs-keyword\">var</span>.<span class=\"hljs-property\">compartment_ocid</span>\n vcn_id = oci_core_vcn.<span class=\"hljs-property\">generated_oci_core_vcn</span>.<span class=\"hljs-property\">id</span>\n display_name = â€œprivate-route-tableâ€\nroute_rules {\n destination = â€œ<span class=\"hljs-number\">0.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.0</span>/<span class=\"hljs-number\">0</span>â€\n destination_type = â€œ<span class=\"hljs-variable constant_\">CIDR_BLOCK</span>â€\n network_entity_id = oci_core_nat_gateway.<span class=\"hljs-property\">generated_oci_core_nat_gateway</span>.<span class=\"hljs-property\">id</span>\n }\n}\n  options {\n    type                  = <span class=\"hljs-string\">\"DomainNameServer\"</span>\n    server_type           = <span class=\"hljs-string\">\"CustomDnsServer\"</span>\n    custom_dns_servers    = [<span class=\"hljs-string\">\"192.168.56.10\"</span>,<span class=\"hljs-string\">\"8.8.8.8\"</span>]\n  }\n options {\n        type = <span class=\"hljs-string\">\"SearchDomain\"</span>\n        search_domain_names = [ <span class=\"hljs-string\">\"sevenkingdoms.local\"</span> ]\n    }\n}\nresource â€œoci_core_security_listâ€ â€œwinrm_rdp_security_listâ€ {\n compartment_id = <span class=\"hljs-keyword\">var</span>.<span class=\"hljs-property\">compartment_ocid</span>\n vcn_id = oci_core_vcn.<span class=\"hljs-property\">generated_oci_core_vcn</span>.<span class=\"hljs-property\">id</span>\n display_name = â€œwinrm_rdp_security_listâ€\negress_security_rules {\n protocol = â€œallâ€\n destination = â€œ<span class=\"hljs-number\">0.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.0</span>/<span class=\"hljs-number\">0</span>â€\n stateless = <span class=\"hljs-literal\">false</span>\n }\ningress_security_rules {\n protocol = â€œallâ€\n source = â€œ<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.0</span>/<span class=\"hljs-number\">16</span>â€\n stateless = <span class=\"hljs-literal\">false</span>\n }\n}\n</code></pre>\n<pre><code class=\"hljs language-js\">resource â€œoci_core_default_dhcp_optionsâ€ â€œdefault_dhcp_optionsâ€ {\n manage_default_resource_id = oci_core_vcn.<span class=\"hljs-property\">generated_oci_core_vcn</span>.<span class=\"hljs-property\">default_dhcp_options_id</span>\noptions {\n type = â€œ<span class=\"hljs-title class_\">DomainNameServer</span>â€\n server_type = â€œ<span class=\"hljs-title class_\">CustomDnsServer</span>â€\n custom_dns_servers = [â€œ<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.10</span>â€]\n search_domain_names = [â€œsevenkingdoms.<span class=\"hljs-property\">local</span>â€]\n }\n</code></pre>\n<p>The DHCP configuration part is essential, as if itâ€™s not properly configured, it will result in the failure of the ansible jobs. If the terraform variable will not add the search domain, you need to do this manually:</p>\n<p>Go to the VCN â†’ DHCP Options:</p>\n<p></p>\n<p>í™”ë©´ ì˜¤ë¥¸ìª½ ìƒë‹¨ì— ìˆëŠ” 3 ì ì„ í´ë¦­í•œ í›„ í¸ì§‘ì„ ì„ íƒí•˜ì„¸ìš”. ì—¬ê¸°ì—ì„œ ì™¸ë¶€ DNS ì„œë²„ë¥¼ ì¶”ê°€í•˜ê³  ì‚¬ìš©ì ì •ì˜ ê²€ìƒ‰ ë„ë©”ì¸ì¸ Seven Kingdomsë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p>ì´ ë¶€ë¶„ì—ì„œ DNS ë¬¸ì œë¥¼ í•´ê²°í•´ì•¼í•©ë‹ˆë‹¤.</p>\n<p></p>\n<pre><code class=\"hljs language-js\">options {\ntype = <span class=\"hljs-string\">\"ë„ë©”ì¸ ë„¤ì„ ì„œë²„\"</span>\nserver_type = <span class=\"hljs-string\">\"ì‚¬ìš©ì ì •ì˜ DNS ì„œë²„\"</span>\ncustom_dns_servers = [<span class=\"hljs-string\">\"192.168.56.10\"</span>,<span class=\"hljs-string\">\"8.8.8.8\"</span>]\n}\noptions {\ntype = <span class=\"hljs-string\">\"ê²€ìƒ‰ ë„ë©”ì¸\"</span>\nsearch_domain_names = [<span class=\"hljs-string\">\"seven kingdoms.local\"</span>]\n}\n</code></pre>\n<p>jumpbox.tf</p>\n<pre><code class=\"hljs language-js\">resource <span class=\"hljs-string\">\"oci_core_instance\"</span> <span class=\"hljs-string\">\"jumpbox\"</span> {\n availability_domain = <span class=\"hljs-keyword\">var</span>.<span class=\"hljs-property\">availability_domain</span>\n compartment_id = <span class=\"hljs-keyword\">var</span>.<span class=\"hljs-property\">compartment_ocid</span>\n display_name = <span class=\"hljs-string\">\"jumpbox\"</span>\n shape = <span class=\"hljs-keyword\">var</span>.<span class=\"hljs-property\">shape</span>\nshape_config {\n baseline_ocpu_utilization = <span class=\"hljs-string\">\"BASELINE_1_1\"</span>\n memory_in_gbs = <span class=\"hljs-keyword\">var</span>.<span class=\"hljs-property\">memory_in_gbs</span>\n ocpus = <span class=\"hljs-keyword\">var</span>.<span class=\"hljs-property\">ocpus</span>\n }\nsource_details {\n source_id = <span class=\"hljs-keyword\">var</span>.<span class=\"hljs-property\">image_ocid</span>\n source_type = <span class=\"hljs-string\">\"ì´ë¯¸ì§€\"</span>\n }\n#ì´ë¯¸ì§€ <span class=\"hljs-variable constant_\">OCID</span>â€™S <span class=\"hljs-attr\">https</span>:<span class=\"hljs-comment\">//docs.oracle.com/en-us/iaas/images/image/bd616d0a-fae4-490e-bd31-a9406095b844/</span>\n create_vnic_details {\n assign_ipv6ip = <span class=\"hljs-literal\">false</span>\n assign_private_dns_record = <span class=\"hljs-literal\">true</span>\n assign_public_ip = <span class=\"hljs-literal\">true</span>\n subnet_id = oci_core_subnet.<span class=\"hljs-property\">public_subnet</span>.<span class=\"hljs-property\">id</span>\n }\nmetadata = {\n ssh_authorized_keys = <span class=\"hljs-keyword\">var</span>.<span class=\"hljs-property\">ssh_authorized_keys</span>\n }\nagent_config {\n is_management_disabled = <span class=\"hljs-literal\">false</span>\n is_monitoring_disabled = <span class=\"hljs-literal\">false</span>\nplugins_config {\n desired_state = <span class=\"hljs-string\">\"ì‚¬ìš© ì•ˆ í•¨\"</span>\n name = <span class=\"hljs-string\">\"ì·¨ì•½ì  ìŠ¤ìºë‹\"</span>\n }\n plugins_config {\n desired_state = <span class=\"hljs-string\">\"ì‚¬ìš© ì•ˆ í•¨\"</span>\n name = <span class=\"hljs-string\">\"ê´€ë¦¬ ì—ì´ì „íŠ¸\"</span>\n }\n plugins_config {\n desired_state = <span class=\"hljs-string\">\"ì‚¬ìš©í•¨\"</span>\n name = <span class=\"hljs-string\">\"ì‚¬ìš©ì ì§€ì • ë¡œê·¸ ëª¨ë‹ˆí„°ë§\"</span>\n }\n plugins_config {\n desired_state = <span class=\"hljs-string\">\"ì‚¬ìš© ì•ˆ í•¨\"</span>\n name = <span class=\"hljs-string\">\"ì»´í“¨íŒ… RDMA GPU ëª¨ë‹ˆí„°ë§\"</span>\n }\n plugins_config {\n desired_state = <span class=\"hljs-string\">\"ì‚¬ìš©í•¨\"</span>\n name = <span class=\"hljs-string\">\"ì»´í“¨íŒ… ì¸ìŠ¤í„´ìŠ¤ ëª¨ë‹ˆí„°ë§\"</span>\n }\n plugins_config {\n desired_state = <span class=\"hljs-string\">\"ì‚¬ìš© ì•ˆ í•¨\"</span>\n name = <span class=\"hljs-string\">\"ì»´í“¨íŒ… HPC RDMA ìë™ êµ¬ì„±\"</span>\n }\n plugins_config {\n desired_state = <span class=\"hljs-string\">\"ì‚¬ìš© ì•ˆ í•¨\"</span>\n name = <span class=\"hljs-string\">\"ì»´í“¨íŒ… HPC RDMA ì¸ì¦\"</span>\n }\n plugins_config {\n desired_state = <span class=\"hljs-string\">\"ì‚¬ìš©í•¨\"</span>\n name = <span class=\"hljs-string\">\"í´ë¼ìš°ë“œ ê°€ë“œ ì›Œí¬ë¡œë“œ ë³´í˜¸\"</span>\n }\n plugins_config {\n desired_state = <span class=\"hljs-string\">\"ì‚¬ìš© ì•ˆ í•¨\"</span>\n name = <span class=\"hljs-string\">\"ë¸”ë¡ ë³¼ë¥¨ ê´€ë¦¬\"</span>\n }\n plugins_config {\n desired_state = <span class=\"hljs-string\">\"ì‚¬ìš© ì•ˆ í•¨\"</span>\n name = <span class=\"hljs-string\">\"ë°”ìŠ¤ì²œ\"</span>\n }\n }\navailability_config {\n is_live_migration_preferred = <span class=\"hljs-literal\">true</span>\n recovery_action = <span class=\"hljs-string\">\"ì¸ìŠ¤í„´ìŠ¤ ë³µì›\"</span>\n }\nplatform_config {\n is_symmetric_multi_threading_enabled = <span class=\"hljs-literal\">true</span>\n type = <span class=\"hljs-string\">\"AMD_VM\"</span>\n }\ninstance_options {\n are_legacy_imds_endpoints_disabled = <span class=\"hljs-literal\">false</span>\n }\n}\n</code></pre>\n<p>windowsvm.tf</p>\n<p></p>\n<pre><code class=\"hljs language-js\">ë¦¬ì†ŒìŠ¤ <span class=\"hljs-string\">\"oci_core_instance\"</span> <span class=\"hljs-string\">\"windows_instance\"</span> {\n for_each = {\n kingslanding = {\n name = <span class=\"hljs-string\">\"kingslanding\"</span>\n private_ip_address = <span class=\"hljs-string\">\"192.168.56.10\"</span>\n admin_username = <span class=\"hljs-string\">\"ansible\"</span>\n admin_password = <span class=\"hljs-string\">\"8dCT-DJjgScp\"</span>\n image_ocid = <span class=\"hljs-keyword\">var</span>.<span class=\"hljs-property\">windows2019_image_ocid</span>\n }\n winterfell = {\n name = <span class=\"hljs-string\">\"winterfell\"</span>\n private_ip_address = <span class=\"hljs-string\">\"192.168.56.11\"</span>\n admin_username = <span class=\"hljs-string\">\"ansible\"</span>\n admin_password = <span class=\"hljs-string\">\"NgtI75cKV+Pu\"</span>\n image_ocid = <span class=\"hljs-keyword\">var</span>.<span class=\"hljs-property\">windows2019_image_ocid</span>\n }\n castelblack = {\n name = <span class=\"hljs-string\">\"castelblack\"</span>\n private_ip_address = <span class=\"hljs-string\">\"192.168.56.22\"</span>\n admin_username = <span class=\"hljs-string\">\"ansible\"</span>\n admin_password = <span class=\"hljs-string\">\"NgtI75cKV+Pu\"</span>\n image_ocid = <span class=\"hljs-keyword\">var</span>.<span class=\"hljs-property\">windows2019_image_ocid</span>\n }\n meereen = {\n name = <span class=\"hljs-string\">\"meereen\"</span>\n private_ip_address = <span class=\"hljs-string\">\"192.168.56.12\"</span>\n admin_username = <span class=\"hljs-string\">\"ansible\"</span>\n admin_password = <span class=\"hljs-string\">\"Ufe-bVXSx9rk\"</span>\n image_ocid = <span class=\"hljs-keyword\">var</span>.<span class=\"hljs-property\">windows2016_image_ocid</span>\n }\n braavos = {\n name = <span class=\"hljs-string\">\"braavos\"</span>\n private_ip_address = <span class=\"hljs-string\">\"192.168.56.23\"</span>\n admin_username = <span class=\"hljs-string\">\"ansible\"</span>\n admin_password = <span class=\"hljs-string\">\"978i2pF43UJ-\"</span>\n image_ocid = <span class=\"hljs-keyword\">var</span>.<span class=\"hljs-property\">windows2016_image_ocid</span>\n }\n }\navailability_domain = <span class=\"hljs-keyword\">var</span>.<span class=\"hljs-property\">availability_domain</span>\n compartment_id = <span class=\"hljs-keyword\">var</span>.<span class=\"hljs-property\">compartment_ocid</span>\n display_name = each.<span class=\"hljs-property\">value</span>.<span class=\"hljs-property\">name</span>\n shape = <span class=\"hljs-string\">\"VM.Standard.E5.Flex\"</span>\nshape_config {\n ocpus = <span class=\"hljs-number\">2</span>\n memory_in_gbs = <span class=\"hljs-number\">32</span>\n }\nsource_details {\n source_id = each.<span class=\"hljs-property\">value</span>.<span class=\"hljs-property\">image_ocid</span>\n source_type = <span class=\"hljs-string\">\"image\"</span>\n }\ncreate_vnic_details {\n assign_ipv6ip = <span class=\"hljs-literal\">false</span>\n assign_private_dns_record = <span class=\"hljs-literal\">true</span>\n assign_public_ip = <span class=\"hljs-literal\">false</span>\n subnet_id = oci_core_subnet.<span class=\"hljs-property\">private_subnet</span>.<span class=\"hljs-property\">id</span>\n hostname_label = each.<span class=\"hljs-property\">value</span>.<span class=\"hljs-property\">name</span>\n private_ip = each.<span class=\"hljs-property\">value</span>.<span class=\"hljs-property\">private_ip_address</span>\n }\nmetadata = {\n user_data = <span class=\"hljs-title function_\">base64encode</span>(<span class=\"hljs-title function_\">file</span>(<span class=\"hljs-string\">\"${path.module}/windows_cloud_init.ps1\"</span>))\n admin_password = each.<span class=\"hljs-property\">value</span>.<span class=\"hljs-property\">admin_password</span>\n }\n}\n</code></pre>\n<p>outputs.tf</p>\n<pre><code class=\"hljs language-js\">output <span class=\"hljs-string\">\"ubuntu_jumpbox_ip\"</span> {\n value = oci_core_instance.<span class=\"hljs-property\">jumpbox</span>.<span class=\"hljs-property\">public_ip</span>\n}\noutput <span class=\"hljs-string\">\"windows_instance_opc_passwords\"</span> {\n value = { <span class=\"hljs-keyword\">for</span> k, v <span class=\"hljs-keyword\">in</span> oci_core_instance.<span class=\"hljs-property\">windows_instance</span> : <span class=\"hljs-function\"><span class=\"hljs-params\">k</span> =></span> v.<span class=\"hljs-property\">metadata</span>.<span class=\"hljs-property\">admin_password</span> }\n sensitive = <span class=\"hljs-literal\">true</span>\n}\n</code></pre>\n<p>í”„ë¡œë¹„ì €ë‹ ì¤‘ ë°œìƒí•œ ì¼ë°˜ì ì¸ ì˜¤ë¥˜ì…ë‹ˆë‹¤.</p>\n<p></p>\n<p>ë‹¤ìŒê³¼ ê°™ì´ Markdown í˜•ì‹ì— ë§ê²Œ í‘œ íƒœê·¸ë¥¼ ë³€ê²½í•˜ì‹­ì‹œì˜¤.</p>\n<p><img src=\"/assets/img/2024-06-19-HowtorunGameofActiveDirectoryinOCIPart1_9.png\" alt=\"ì´ë¯¸ì§€\"></p>\n<p>ëª¨ë“  TFê°€ ìƒì„±ëœ í›„, GOAD git ì €ì¥ì†Œê°€ ì •ìƒì ìœ¼ë¡œ ë™ê¸°í™”ëœ ê²½ìš° ë‹¤ìŒì„ ì‹¤í–‰í•´ì•¼ í•©ë‹ˆë‹¤:</p>\n<p>abirzu@abirzu-mac GOAD % ./goad.sh -t destroy -l GOAD -p oci -m local</p>\n<p>ëª¨ë“  ì„œë²„ê°€ ê°€ë™ë˜ê³  ì‘ë™ ì¤‘ì¸ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p></p>\n<p>ì¶•í•˜í•©ë‹ˆë‹¤! í™˜ê²½ì´ ì‘ë™ ì¤‘ì— ìˆìŠµë‹ˆë‹¤.</p>\n<h1>ì„œë²„</h1>\n<p>ì´ ë©ì€ ì‹¤ì œë¡œ ë‹¤ì„¯ ê°œì˜ ê°€ìƒ ë¨¸ì‹ ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤:</p>\n<p></p>\n<ul>\n<li>kingslanding: DC01ëŠ” Windows Server 2019ì—ì„œ ì‹¤í–‰ ì¤‘ì…ë‹ˆë‹¤(ê¸°ë³¸ìœ¼ë¡œ windefenderê°€ í™œì„±í™”ë¨)</li>\n<li>winterfell: DC02ëŠ” Windows Server 2019ì—ì„œ ì‹¤í–‰ ì¤‘ì…ë‹ˆë‹¤(ê¸°ë³¸ìœ¼ë¡œ windefenderê°€ í™œì„±í™”ë¨)</li>\n<li>castelblack: SRV02ëŠ” Windows Server 2019ì—ì„œ ì‹¤í–‰ ì¤‘ì…ë‹ˆë‹¤(windefenderê°€ ê¸°ë³¸ì ìœ¼ë¡œ ë¹„í™œì„±í™”ë¨)</li>\n<li>meereen: DC03ì€ Windows Server 2016ì—ì„œ ì‹¤í–‰ ì¤‘ì…ë‹ˆë‹¤(ê¸°ë³¸ìœ¼ë¡œ windefenderê°€ í™œì„±í™”ë¨)</li>\n<li>braavos: SRV03ì€ Windows Server 2016ì—ì„œ ì‹¤í–‰ ì¤‘ì…ë‹ˆë‹¤(ê¸°ë³¸ìœ¼ë¡œ windefenderê°€ í™œì„±í™”ë¨)</li>\n</ul>\n<p>ë„ë©”ì¸: north.sevenkingdoms.local</p>\n<ul>\n<li>winterfell: DC01</li>\n<li>castelblack: SRV02: MSSQL / IIS</li>\n</ul>\n<p>ë„ë©”ì¸: sevenkingdoms.local</p>\n<p></p>\n<ul>\n<li>kingslanding: DC02</li>\n<li>castelrock: SRV01 (ìì› ë¶€ì¡±ìœ¼ë¡œ ë¹„í™œì„±í™”ë¨)</li>\n</ul>\n<h1>ë„ë©”ì¸: essos.local</h1>\n<ul>\n<li>braavos: DC03</li>\n<li>meeren: SRV03: MSSQL / ADCS</li>\n</ul>\n<p>ì¸í„°ë„·ì—ì„œ ëª‡ ê°€ì§€ ê°€ì´ë“œë¥¼ ë”°ë¥´ê±°ë‚˜ ìì‹ ë§Œì˜ ë°©ë²•ì„ ì°¾ì•„ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!</p>\n<p></p>\n<p>AD | Mayfly (mayfly277.github.io)</p>\n<p>Solving Game of Active Directory (GOAD) by Orange Cyberdefense Part-1 | by n00ğŸ”‘ | Medium</p>\n<p>ì œ1ë¶€ì—ì„œëŠ” OCIì—ì„œ GOAD ë©ì„ ë§Œë“œëŠ” ë°©ë²•ì„ ì†Œê°œí–ˆê³ , ë‹¤ìŒ ë¶€ë¶„ì—ì„œëŠ” ë‹¤ìŒì— ì´ˆì ì„ ë§ì¶œ ê²ƒì…ë‹ˆë‹¤:</p>\n<p>OCI í†µí•©:</p>\n<p></p>\n<ol>\n<li>OCI Management Agent:</li>\n</ol>\n<ul>\n<li>ì„¤ëª…: í´ë¼ìš°ë“œ ì‘ì—…ì„ ìë™í™”í•˜ê³  ëª¨ë‹ˆí„°ë§í•©ë‹ˆë‹¤.</li>\n<li>í†µí•©: GOAD í™˜ê²½ ë‚´ ìì›ì˜ ë°°í¬ ë° ê´€ë¦¬ë¥¼ ê°„ì†Œí™”í•©ë‹ˆë‹¤.</li>\n</ul>\n<ol start=\"2\">\n<li>Sysmon ë° ë¡œê¹… ë¶„ì„:</li>\n</ol>\n<p></p>\n<p>â€¢ ì„¤ëª…: Sysmonì€ ì‹œìŠ¤í…œ í™œë™ì„ ê¸°ë¡í•˜ì—¬ ì¹¨ì… íƒì§€ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.</p>\n<p>â€¢ í†µí•©: Sysmon ì´ë²¤íŠ¸ë¥¼ ìˆ˜ì§‘í•˜ê³  OCI Logging Analyticsë¡œ ì „ì†¡í•˜ì—¬ ê³ ê¸‰ ë¡œê·¸ ë¶„ì„ ë° ì‹œê°í™”ë¥¼ ì§€ì›í•©ë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ ì—¬ê¸°ì—ì„œ í™•ì¸í•˜ì„¸ìš”.</p>\n<ol start=\"3\">\n<li>Arkime í†µí•©:</li>\n</ol>\n<p>â€¢ ì„¤ëª…: Arkimeì€ ì˜¤í”ˆ ì†ŒìŠ¤ íŒ¨í‚· ìº¡ì²˜ ë° ê²€ìƒ‰ ë„êµ¬ì…ë‹ˆë‹¤.</p>\n<p></p>\n<p>â€¢ í†µí•©: íš¨ìœ¨ì ì¸ ë°ì´í„° ìƒ‰ì¸ ë° ê²€ìƒ‰ì„ ìœ„í•´ OCI OpenSearchë¥¼ í™œìš©í•©ë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ ì—¬ê¸°ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<ol start=\"4\">\n<li>í´ë¼ìš°ë“œ ê°€ë“œ ì¸ìŠ¤í„´ìŠ¤ ë³´ì•ˆ:</li>\n</ol>\n<p>â€¢ ì„¤ëª…: í´ë¼ìš°ë“œ ê°€ë“œëŠ” í¬ê´„ì ì¸ í´ë¼ìš°ë“œ ë³´ì•ˆ ê´€ë¦¬ë¥¼ ì œê³µí•©ë‹ˆë‹¤.</p>\n<p>â€¢ í†µí•©: ë¡œê¹… ë¶„ì„ì„ í™œìš©í•˜ì—¬ ì¸ìŠ¤í„´ìŠ¤ ë³´ì•ˆì„ ê°•í™”í•˜ë©° ì‹¤ì‹œê°„ ìœ„í˜‘ ê°ì§€ ë° ëŒ€ì‘ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ë” ë§ì€ ì •ë³´ëŠ” ì—¬ê¸°ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n</body>\n</html>\n"},"__N_SSG":true}