{"pageProps":{"post":{"title":"ì„œë²„ë¦¬ìŠ¤ EventBridge Pipesë¡œ ì´ë²¤íŠ¸ ì²˜ë¦¬í•˜ëŠ” ë°©ë²• ìµœì‹  2024","description":"","date":"2024-06-23 22:26","slug":"2024-06-23-ServerlessEventBridgePipes","content":"\n<img src=\"/assets/img/2024-06-23-ServerlessEventBridgePipes_0.png\" />\n\n## ì•ˆë‚´\n\nâœ”ï¸ Amazon EventBridge Pipes ë° ê·¸ë“¤ì´ ë¬´ì—‡ì¸ì§€ì— ëŒ€í•´ ë…¼ì˜í•©ë‹ˆë‹¤.\nâœ”ï¸ Python ë° AWS CDKë¥¼ ì‚¬ìš©í•œ ì˜ˆì œë¥¼ í†µí•´ ì•ˆë‚´í•©ë‹ˆë‹¤.\n\n# ì†Œê°œ ğŸ‘‹ğŸ½\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\nì´ ê¸°ì‚¬ì—ì„œëŠ” AWS CDKì™€ Pythonì„ ì‚¬ìš©í•˜ì—¬ êµ¬ì¶•ëœ í—ˆêµ¬ì˜ ì¹˜ê³¼ ì•±ì„ ë§Œë“¤ì–´ê°€ë©´ì„œ Amazon EventBridge Pipesì— ëŒ€í•´ ë‹¤ë¤„ë³¼ ê²ƒì…ë‹ˆë‹¤.\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-23-ServerlessEventBridgePipes_1.png)\n\n'LJ ì¹˜ê³¼ ì˜ì‚¬' ì•±ì€ ì‚¬ëŒë“¤ì´ ê°€ì¥ ê°€ê¹Œìš´ ì¹˜ê³¼ ì˜ì‚¬ì™€ ì˜ˆì•½ì„ ì¡ì„ ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-23-ServerlessEventBridgePipes_2.png)\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\nê·¸ë“¤ì´ ì´ë¯¸ ë°©ë¬¸í•œ ì ì´ ìˆëŠ” ê²½ìš°ì—ëŠ” ì´ë©”ì¼, SMS ë˜ëŠ” í†µì‹  ì—†ìŒì„ ë³´ë‚´ê¸° ì „ì— ì„ í˜¸í•˜ëŠ” ì—°ë½ ë°©ë²•ì„ í™•ì¸í•©ë‹ˆë‹¤. ì´ ëª¨ë‘ëŠ” Amazon EventBridge Pipesë¥¼ ì‚¬ìš©í•˜ì—¬ ì²˜ë¦¬ë©ë‹ˆë‹¤.\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-23-ServerlessEventBridgePipes_3.png)\n\nì´ ê¸°ì‚¬ì˜ ì „ì²´ ì½”ë“œ ì˜ˆì œëŠ” ì—¬ê¸°ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n# ìš°ë¦¬ê°€ ë¬´ì—‡ì„ ë§Œë“¤ê³  ìˆë‚˜ìš”? ğŸ› ï¸\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\ní™˜ìë“¤ì´ ì˜¨ë¼ì¸ìœ¼ë¡œ ì§„ë£Œ ì˜ˆì•½ì„ í•  ìˆ˜ ìˆë„ë¡ ë‹¤ìŒ ì•„í‚¤í…ì²˜ë¥¼ ì‚¬ìš©í•  ì˜ˆì •ì…ë‹ˆë‹¤:\n\n![ì•„í‚¤í…ì²˜](/assets/img/2024-06-23-ServerlessEventBridgePipes_4.png)\n\ní™˜ìë“¤ì´ ë‹¤ìŒì„ ì‚¬ìš©í•˜ì—¬ ì§„ë£Œë¥¼ ì˜ˆì•½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n- Amazon API Gateway REST APIë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜¨ë¼ì¸ìœ¼ë¡œ ì§„ë£Œ ì˜ˆì•½ì„ í•©ë‹ˆë‹¤.\n- Lambda í•¨ìˆ˜ê°€ ì§„ë£Œ ìƒì„¸ ë‚´ìš©ì„ DynamoDB í…Œì´ë¸”ì— ê¸°ë¡í•©ë‹ˆë‹¤.\n- ìš°ë¦¬ëŠ” DynamoDB ìŠ¤íŠ¸ë¦¼ì„ ì‚¬ìš©í•˜ì—¬ í…Œì´ë¸”ì˜ ë³€ê²½ ì‚¬í•­ì„ ê°ì§€í•˜ê³  ë ˆì½”ë“œê°€ ìƒì„±ë˜ì—ˆì„ ê²½ìš°ì—ë§Œ í•„í„°ë§í•˜ì—¬ Amazon EventBridge Pipesë¥¼ í†µí•´ í•´ë‹¹ ìŠ¤íŠ¸ë¦¼ì„ ì†ŒìŠ¤ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.\n- ì¼ì¹˜í•˜ëŠ” ë ˆì½”ë“œê°€ ì—°ë½ì²˜ ì„ í˜¸ë„ í…Œì´ë¸”ì— ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” Lambda í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ ìŠ¤íŠ¸ë¦¼ ë ˆì½”ë“œì— ì„ í˜¸ë„ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.\n- ë§ˆì§€ë§‰ìœ¼ë¡œ, Amazon EventBridge Pipesì˜ ëŒ€ìƒì€ SQSë¡œ ì„¤ì •ë˜ì–´ ì§„ë£Œë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ì¤€ë¹„ëœ ì˜ˆì•½ì„ ì €ì¥í•©ë‹ˆë‹¤.\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\nğŸ‘‡ ë” ì§„ì „í•˜ê¸° ì „ì— â€” í–¥í›„ ë¸”ë¡œê·¸ ê²Œì‹œë¬¼ê³¼ ì„œë²„ë¦¬ìŠ¤ ë‰´ìŠ¤ë¥¼ ë§Œë‚˜ë³´ê¸° ìœ„í•´ LinkedInì— ì—°ë½í•´ ì£¼ì„¸ìš” https://www.linkedin.com/in/lee-james-gilmore/\n\n![ServerlessEventBridgePipes_5](/assets/img/2024-06-23-ServerlessEventBridgePipes_5.png)\n\n# Amazon EventBridge Pipesë€ ë¬´ì—‡ì¸ê°€ìš”?\n\nAmazon EventBridge PipesëŠ” ì˜µì…˜ ë³€í™˜, í•„í„° ë° í’ë¶€í•œ ë‹¨ê³„ë¥¼ í†µí•´ ì´ë²¤íŠ¸ ìƒì„±ìì™€ ì†Œë¹„ì ê°„ì˜ í¬ì¸íŠ¸ íˆ¬ í¬ì¸íŠ¸ í†µí•©ì„ ìƒì„±í•˜ëŠ” ë° ë„ì›€ì„ ì¤ë‹ˆë‹¤. EventBridge Pipesë¥¼ ì‚¬ìš©í•˜ë©´ ì´ë²¤íŠ¸ ì¤‘ì‹¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ êµ¬ì¶•í•  ë•Œ í•„ìš”í•œ í†µí•© ì½”ë“œ ì–‘ì„ ì¤„ì´ê³  ìœ ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ ë‹¤ì´ì–´ê·¸ë¨ì€ ìš°ë¦¬ ì˜ˆì‹œë¥¼ ìœ„í•´ ì´ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤:\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\nìœ„ ë‹¤ì´ì–´ê·¸ë¨ì—ì„œ ì•Œ ìˆ˜ ìˆë“¯ì´ ë‹¤ìŒì´ ìˆìŠµë‹ˆë‹¤:\n\n- ì†ŒìŠ¤ë¡œ DynamoDB ìŠ¤íŠ¸ë¦¼ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.\n- ìƒˆë¡œ ì‚½ì…ëœ ë ˆì½”ë“œë§Œ ë°›ë„ë¡ ì¶”ê°€ í•„í„°ë§ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤(ì˜ˆ: ì‚­ì œ ë˜ëŠ” ì—…ë°ì´íŠ¸ ì œì™¸).\n- ë³„ë„ì˜ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì—°ë½ì²˜ ì •ë³´ë¥¼ ì½ëŠ” enrichment Lambda í•¨ìˆ˜ë¥¼ í†µí•´ ìŠ¤íŠ¸ë¦¼ì—ì„œ ì•½ì† ë°ì´í„°ë¥¼ ì¶”ê°€ ì •ë³´ë¡œ í–¥ìƒì‹œí‚µë‹ˆë‹¤.\n- ìµœì¢…ì ìœ¼ë¡œ ì•½ì† ë ˆì½”ë“œë¥¼ ë” ì²˜ë¦¬í•˜ê¸° ìœ„í•´ SQS ëŒ€ê¸°ì—´ë¡œ ì„¤ì •ëœ ëŒ€ìƒì´ ìˆìŠµë‹ˆë‹¤.\n\nì°¸ê³ ë¡œ ì•„ë˜ì— í‘œì‹œëœ ë‹¤ì–‘í•œ ì„œë¹„ìŠ¤ì™€ êµ¬ì„±ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-23-ServerlessEventBridgePipes_6.png)\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n# ì£¼ìš” ì½”ë“œ ì„¤ëª…í•˜ê¸° ğŸ‘¨â€ğŸ’»\n\nì´ì œ ëª‡ ê°€ì§€ ì£¼ìš” ì½”ë“œì— ëŒ€í•´ ì´ì•¼ê¸°í•´ë´…ì‹œë‹¤.\n\nì•„ë˜ì—ì„œ ë³¼ ìˆ˜ ìˆëŠ”ëŒ€ë¡œ CDK ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìƒíƒœ(Stateful) ë° ìƒíƒœ ì—†ìŒ(Stateless) ë¦¬ì†ŒìŠ¤(ìŠ¤íƒ)ë¡œ ë¶„ë¦¬í•˜ê¸° ì‹œì‘í•©ë‹ˆë‹¤:\n\n```js\n#!/usr/bin/env python3\nimport os\n\nimport aws_cdk as cdk\nfrom stateful.stateful import DentistsStatefulStack\nfrom stateless.stateless import DentistsStatelessStack\n\napp = cdk.App()\n\n# ì•±ì„ ìƒíƒœ(Stateful) ë° ìƒíƒœ ì—†ìŒ(Stateless) ë¦¬ì†ŒìŠ¤ë¡œ ë¶„ë¦¬í•©ë‹ˆë‹¤\nDentistsStatefulStack(app, \"DentistsStatefulStack\")\nDentistsStatelessStack(app, \"DentistsStatelessStack\")\n\napp.synth()\n```\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\nStateful ìŠ¤íƒì„ ë¨¼ì € ì‚´í´ ë³´ë©´, ë‘ ê°œì˜ DynamoDB í…Œì´ë¸”ì„ ì„¤ì •í–ˆìŒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•˜ë‚˜ëŠ” ì•½ì†ì„, ë‹¤ë¥¸ í•˜ë‚˜ëŠ” ì„ í˜¸í•˜ëŠ” ì—°ë½ì²˜ ì„¸ë¶€ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” í…Œì´ë¸”ì…ë‹ˆë‹¤:\n\n```js\nfrom aws_cdk import CfnOutput, RemovalPolicy, Stack\nfrom aws_cdk import aws_dynamodb as dynamodb\nfrom constructs import Construct\n\nclass DentistsStatefulStack(Stack):\n\n    def __init__(self, scope: Construct, construct_id: str, **kwargs) -> None:\n        super().__init__(scope, construct_id, **kwargs)\n\n        # ì•½ì†ì„ ì €ì¥í•˜ëŠ” DynamoDB í…Œì´ë¸” ì¶”ê°€ ë° ìŠ¤íŠ¸ë¦¼ í™œì„±í™”\n        table = dynamodb.Table(\n            self, 'DentistTable',\n            billing_mode=dynamodb.BillingMode.PAY_PER_REQUEST,\n            table_name='DentistTable',\n            stream=dynamodb.StreamViewType.NEW_IMAGE,\n            removal_policy=RemovalPolicy.DESTROY,\n            partition_key=dynamodb.Attribute(\n                name='id',\n                type=dynamodb.AttributeType.STRING\n            )\n        )\n\n        # ì´ë©”ì¼ ì£¼ì†Œë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•˜ëŠ” ì—°ë½ ì„ í˜¸ë„ DynamoDB í…Œì´ë¸” ì¶”ê°€\n        contact_table = dynamodb.Table(\n            self, 'DentistContactsTable',\n            billing_mode=dynamodb.BillingMode.PAY_PER_REQUEST,\n            table_name='DentistContactsTable',\n            removal_policy=RemovalPolicy.DESTROY,\n            partition_key=dynamodb.Attribute(\n                name='id',\n                type=dynamodb.AttributeType.STRING\n            )\n        )\n\n        # í…Œì´ë¸” ì´ë¦„ì„ ìœ„í•œ ìŠ¤íƒ ì¶œë ¥ ì¶”ê°€\n        CfnOutput(\n            self, 'DentistDynamoDBTableName',\n            value=table.table_name,\n            description='DynamoDB í…Œì´ë¸” ì´ë¦„',\n            export_name='DentistDynamoDBTableName'\n        )\n\n        # ì—°ë½ì²˜ í…Œì´ë¸” ì´ë¦„ì„ ìœ„í•œ ìŠ¤íƒ ì¶œë ¥ ì¶”ê°€\n        CfnOutput(\n            self, 'DentistContactDynamoDBTableName',\n            value=contact_table.table_name,\n            description='ì—°ë½ ì„ í˜¸ë„ DynamoDB í…Œì´ë¸” ì´ë¦„',\n            export_name='DentistContactDynamoDBTableName'\n        )\n\n        # ì•½ì† í…Œì´ë¸”ì˜ í…Œì´ë¸” ìŠ¤íŠ¸ë¦¼ ARNì„ ìœ„í•œ ìŠ¤íƒ ì¶œë ¥ ì¶”ê°€\n        CfnOutput(\n            self, 'DentistDynamoDBTableStreamArn',\n            value=table.table_stream_arn,\n            description='DynamoDB í…Œì´ë¸” ìŠ¤íŠ¸ë¦¼ ARN',\n            export_name='DentistDynamoDBTableStreamArn'\n        )\n```\n\nì´ì œ Stateful ë¦¬ì†ŒìŠ¤ê°€ ì„¤ì •ëìœ¼ë¯€ë¡œ, Stateless ìŠ¤íƒì—ì„œ ë¨¼ì € ì•½ì†ì„ ìƒì„±í•˜ëŠ” ëŒë‹¤ í•¨ìˆ˜ë¥¼ ìƒì„±í•©ë‹ˆë‹¤:\n\n```js\n# ì•½ì†ì„ ìƒì„±í•˜ëŠ” ëŒë‹¤ í•¨ìˆ˜ ìƒì„±\ncreate_appointment_lambda = aws_lambda.Function(\n    self, 'CreateAppointment',\n    runtime=aws_lambda.Runtime.PYTHON_3_12,\n    handler='create_appointment.handler',\n    code=aws_lambda.Code.from_asset(os.path.join(DIRNAME, 'src')),\n    function_name='CreateAppointment',\n    environment={\n        'dynamodb_table': dynamodb_table_name,\n    },\n)\n```\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\nLambda í•¨ìˆ˜ì— ì¶”ê°€ì ìœ¼ë¡œ ë‘ ë²ˆì§¸ Lambda í•¨ìˆ˜ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤. ì´ í•¨ìˆ˜ëŠ” DynamoDB ìŠ¤íŠ¸ë¦¼ì´ ì œê³µí•˜ëŠ” ë°ì´í„°ë¥¼ í’ë¶€í•˜ê²Œ í•˜ëŠ” ë° ì‚¬ìš©ë  ê²ƒì…ë‹ˆë‹¤:\n\n```js\n# ì—°ë½ì²˜ ì„¸ë¶€ ì •ë³´ë¥¼ ê²€ìƒ‰í•˜ëŠ” ëŒë‹¤ í•¨ìˆ˜ ìƒì„±\nget_contact_details = aws_lambda.Function(\n    self, 'GetContactDetails',\n    runtime=aws_lambda.Runtime.PYTHON_3_12,\n    handler='get_contact_details.handler',\n    code=aws_lambda.Code.from_asset(os.path.join(DIRNAME, 'src')),\n    function_name='GetContactDetails',\n    environment={\n        'contacts_dynamodb_table': contacts_dynamodb_table_name,\n    },\n)\n```\n\në‹¤ìŒìœ¼ë¡œ, ìš°ë¦¬ì˜ íŒŒì´í”„ ëŒ€ìƒì´ ë  Amazon SQS ëŒ€ê¸°ì—´ì„ ì¶”ê°€í•©ë‹ˆë‹¤:\n\n```js\n# AppointmentsQueueë¡œ ë©”ì‹œì§€ë¥¼ ë³´ë‚¼ SQS ëŒ€ê¸°ì—´ ìƒì„±\nsqs_queue = sqs.Queue(\n    self, 'AppointmentsQueue',\n    queue_name='AppointmentsQueue',\n    removal_policy=RemovalPolicy.DESTROY\n)\n```\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\nê·¸ëŸ¼ Amazon EventBridge íŒŒì´í”„ ìì²´ì— ëŒ€í•œ IAM ì •ì±…ì„ ë§Œë“¤ì–´ì„œ ì›ë³¸, ë³´ê°• ë° ëŒ€ìƒ ìì›ê³¼ ì—°ê²°í•  ìˆ˜ ìˆë„ë¡í•©ë‹ˆë‹¤.\n\n```js\n# íŒŒì´í”„ ì›ë³¸(ë‹¤ì´ë‚˜ëª¨DB ìŠ¤íŠ¸ë¦¼)ìš© íŒŒì´í”„ ì •ì±…ê³¼ ì—­í•  ìƒì„±\npipe_source_policy = iam.PolicyStatement(\n    actions=[\n        'dynamodb:DescribeStream',\n        'dynamodb:GetRecords',\n        'dynamodb:GetShardIterator',\n        'dynamodb:ListStreams'\n    ],\n    resources=[stream_arn],\n    effect=iam.Effect.ALLOW\n)\n\n# íŒŒì´í”„ ëŒ€ìƒ(SQS)ìœ¼ë¡œ ë©”ì‹œì§€ë¥¼ ê²Œì‹œí•˜ëŠ” ê²ƒì„ í—ˆìš©í•˜ëŠ” ëŒ€ìƒ ì •ì±… ì‘ì„±\npipe_target_policy = iam.PolicyStatement(\n    actions=['sqs:SendMessage'],\n    resources=[sqs_queue.queue_arn],\n    effect=iam.Effect.ALLOW\n)\n\n# íŒŒì´í”„ê°€ ëŒë‹¤ ê¸°ëŠ¥ì„ í˜¸ì¶œí•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ë³´ê°• ì •ì±… ìƒì„±\npipe_enrichment_policy = iam.PolicyStatement(\n    actions=['lambda:InvokeFunction'],\n    resources=[get_contact_details.function_arn],\n    effect=iam.Effect.ALLOW\n)\n\n# íŒŒì´í”„ ì—­í•  ìƒì„±\npipe_role = iam.Role(self, 'PipeRole',\n    assumed_by=iam.ServicePrincipal('pipes.amazonaws.com'),\n)\n\n# ì—­í• ì— ì„¸ ê°€ì§€ ì •ì±… ì¶”ê°€\npipe_role.add_to_policy(pipe_source_policy)\npipe_role.add_to_policy(pipe_target_policy)\npipe_role.add_to_policy(pipe_enrichment_policy)\n```\n\nì´ì œ ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ íŒŒì´í”„ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n```js\n# ë‹¤ì´ë‚˜ëª¨DBì˜ ìƒˆ í•­ëª©ì— ëŒ€í•œ í•„í„°ê°€ ìˆëŠ” ì´ë²¤íŠ¸ë¸Œë¦¿ì§€ íŒŒì´í”„ ìƒì„±\npipe = pipes.CfnPipe(self, 'Pipe',\n    role_arn=pipe_role.role_arn,\n    source=stream_arn,\n    log_configuration=pipes.CfnPipe.PipeLogConfigurationProperty(\n        cloudwatch_logs_log_destination=pipes.CfnPipe.CloudwatchLogsLogDestinationProperty(\n            log_group_arn=log_group.log_group_arn\n        ),\n        level='INFO',\n    ),\n    name='DentistPipe',\n    source_parameters=pipes.CfnPipe.PipeSourceParametersProperty(\n        dynamo_db_stream_parameters=pipes.CfnPipe.PipeSourceDynamoDBStreamParametersProperty(\n            starting_position='LATEST',\n        ),\n        filter_criteria=pipes.CfnPipe.FilterCriteriaProperty(\n            filters=[pipes.CfnPipe.FilterProperty(\n                pattern=json.dumps({'eventName': [{ 'prefix': 'INSERT' }])\n            )]\n        ),\n    ),\n    enrichment=get_contact_details.function_arn,\n    target=sqs_queue.queue_arn,\n)\npipe.apply_removal_policy(RemovalPolicy.DESTROY)\n```\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\ní˜„ì¬ ì¸í”„ë¼ê°€ ëª¨ë‘ ì„¤ì •ë˜ì–´ ìˆì§€ë§Œ 'create_appointment.py' íŒŒì¼ì„ ì‹œì‘ìœ¼ë¡œ Lambda í•¨ìˆ˜ ì½”ë“œë¥¼ ê°„ë‹¨íˆ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\n\n```js\nimport json\nimport os\nimport uuid\nfrom http import HTTPStatus\n\nimport boto3\nfrom boto3.dynamodb.types import TypeSerializer\n\ndynamodb_table = os.getenv('dynamodb_table')\ndynamodb_client = boto3.client('dynamodb')\nserializer = TypeSerializer()\n\ndef handler(event, context):\n    try:\n        # ì´ë²¤íŠ¸ì—ì„œ ìš”ì²­ ë°ì´í„°ë¥¼ êµ¬ë¬¸ ë¶„ì„í•˜ê³  ë³¸ë¬¸ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.\n        request_data = json.loads(event['body'])\n\n        # uuidv4ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒˆë¡œìš´ ì•½ì† IDë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.\n        request_data['id'] = str(uuid.uuid4())\n\n        # í˜ì´ë¡œë“œë¥¼ dynamodb í˜•ì‹ìœ¼ë¡œ ì§ë ¬í™”í•©ë‹ˆë‹¤.\n        appointment_data = {k: serializer.serialize(v) for k, v in request_data.items()}\n\n        # í•­ëª©ì„ dynamodb í…Œì´ë¸”ì— ì¶”ê°€í•©ë‹ˆë‹¤.\n        dynamodb_client.put_item(TableName=dynamodb_table, Item=appointment_data)\n\n        body = {\n            'message': request_data,\n            'statusCode': HTTPStatus.CREATED,\n        }\n\n        # ì‘ë‹µì„ ì˜¬ë°”ë¥¸ í˜•ì‹ìœ¼ë¡œ API Gatewayë¡œ ì „ì†¡í•©ë‹ˆë‹¤.\n        response = {\n            'statusCode': HTTPStatus.CREATED,\n            'body': json.dumps(body, indent=2),\n            'headers': {\n                'content-type': 'application/json',\n            },\n        }\n\n    except Exception as e:\n        response = {\n            'statusCode': HTTPStatus.INTERNAL_SERVER_ERROR.value,\n            'body': f'Exception={e}',\n        }\n\n    return response\n```\n\nìœ„ ì½”ë“œì—ì„œ ë³¼ ìˆ˜ ìˆë“¯, API Gateway ì´ë²¤íŠ¸ì—ì„œ ì•½ì†ì„ ê°€ì ¸ì™€ ìƒˆë¡œìš´ ê³ ìœ  ID(uuid)ë¥¼ ì¶”ê°€í•˜ê³  ë ˆì½”ë“œë¥¼ ì•½ì† í…Œì´ë¸”ì— ê¸°ë¡í•˜ëŠ” ê¸°ë³¸ í•¨ìˆ˜ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.\n\ní…Œì´ë¸”ì— ë ˆì½”ë“œê°€ ì¶”ê°€ë˜ë©´ ìŠ¤íŠ¸ë¦¼ì´ í˜¸ì¶œë˜ì–´ ëª¨ë“  ë ˆì½”ë“œ ë³€ê²½ì— ëŒ€í•´ íŒŒì´í”„ê°€ ë³€ê²½ ì‚¬í•­ì„ ì†ŒìŠ¤ë¡œ ê°€ì ¸ì˜¬ ê²ƒì…ë‹ˆë‹¤.\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\nê·¸ ë‹¤ìŒìœ¼ë¡œ, íŒŒì´í”„ì˜ ì¼ë¶€ë¡œ í˜¸ì¶œë˜ëŠ” Enrichment ëŒë‹¤ í•¨ìˆ˜ë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤:\n\nìœ„ ì½”ë“œì—ì„œ ë³¼ ìˆ˜ ìˆë“¯ì´, ìŠ¤íŠ¸ë¦¼ ë ˆì½”ë“œì—ì„œ email_address ì†ì„±ì„ ê°€ì ¸ì™€ ìš°ë¦¬ê°€ ì„ í˜¸í•˜ëŠ” ì—°ë½ì²˜ DynamoDB í…Œì´ë¸”ì—ì„œ ì¡°íšŒí•©ë‹ˆë‹¤. ë ˆì½”ë“œê°€ ì¡´ì¬í•˜ë©´, ì„ í˜¸í•˜ëŠ” ë°©ë²•ì„ ê°€ì ¸ì™€ ì•½ì† ë ˆì½”ë“œì— ì¶”ê°€í•©ë‹ˆë‹¤. ì¼ì¹˜í•˜ëŠ” ë ˆì½”ë“œê°€ ì—†ìœ¼ë©´, preferredMethodë¥¼ 'none'ìœ¼ë¡œ ì¶”ê°€í•©ë‹ˆë‹¤.\n\nì—”ë“œ íˆ¬ ì—”ë“œë¡œ í…ŒìŠ¤íŠ¸í•˜ë ¤ë©´, ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë°°í¬í•˜ê³  Contacts DynamoDb í…Œì´ë¸”ì— ë‹¤ìŒ í•­ëª©ì„ ì¶”ê°€í•˜ë©´ preferredMethodë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n```json\n{\n  \"id\": \"john.doe@example.com\",\n  \"preferredMethod\": \"email\"\n}\n```\n\në§Œì•½ ë ˆì½”ë“œê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ ì´ì „ì— ì–¸ê¸‰í•œ ëŒ€ë¡œ 'none'ìœ¼ë¡œ ê¸°ë³¸ ì„¤ì •ë©ë‹ˆë‹¤.\n\n# ê²°ë¡ \n\nAmazon EventBridge íŒŒì´í”„ë¥¼ ì‚¬ìš©í•˜ëŠ” ì‹¤ì œ ì˜ˆì‹œë¡œ ì„œë²„ë¦¬ìŠ¤ ì†”ë£¨ì…˜ì—ì„œì˜ ì‚¬ìš©ë²•ì„ ë³´ì—¬ë“œë ¤ ìœ ìš©í•˜ê²Œ ì°¾ìœ¼ì…¨ê¸°ë¥¼ í¬ë§í•©ë‹ˆë‹¤. íŒŒì´í”„ë¥¼ ì‚¬ìš©í•˜ë©´ ì´ì „ì— ì‚¬ìš©í•´ì•¼ í–ˆë˜ ëŒë‹¤ ì ‘ì°© ì½”ë“œë¥¼ ì œê±°í•  ìˆ˜ ìˆê³  ì†ŒìŠ¤ì—ì„œ ë°ì´í„°ë¥¼ ì¶”ì¶œí•˜ì—¬ í•´ë‹¹ ë°ì´í„°ë¥¼ íƒ€ê¹ƒìœ¼ë¡œ ì „ë‹¬í•˜ëŠ” í›Œë¥­í•œ ë°©ë²•ì„ ì œê³µí•©ë‹ˆë‹¤.\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n# ë§ˆë¬´ë¦¬ ğŸ‘‹ğŸ½\n\nì´ ê¸€ì„ ì¦ê²ê²Œ ë³´ì•˜ìœ¼ë©´ ê³µìœ í•˜ê³  í”¼ë“œë°±ì„ ë‚¨ê²¨ì£¼ì„¸ìš”!\n\në¹„ìŠ·í•œ ì½˜í…ì¸ ë¥¼ ë” ë³´ì‹œë ¤ë©´ ì œ YouTube ì±„ë„ì„ êµ¬ë…í•´ì£¼ì„¸ìš”!\n\n<img src=\"/assets/img/2024-06-23-ServerlessEventBridgePipes_7.png\" />\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\në‹¹ì‹ ê³¼ ì–´ëŠ í•˜ë‚˜ë¼ë„ ë‹¤ìŒì—ì„œë„ ì—°ê²°í•˜ê³  ì‹¶ì–´ìš”:\n\n- [LinkedIn](https://www.linkedin.com/in/lee-james-gilmore/)\n- [Twitter](https://twitter.com/LeeJamesGilmore)\n\ní¬ìŠ¤íŠ¸ë¥¼ ì¦ê²¼ë‹¤ë©´ ì¶”ê°€ë¡œ í¬ìŠ¤íŠ¸/ì‹œë¦¬ì¦ˆë¥¼ ë³´ê¸° ìœ„í•´ ë‚´ í”„ë¡œí•„ Lee James Gilmoreë¥¼ íŒ”ë¡œìš°í•´ì£¼ì„¸ìš”. ê·¸ë¦¬ê³  ì¸ì‚¬ë¥¼ ê±´ë„¤ê³  ì‹¶ë‹¤ë©´ ì ˆëŒ€ ìŠì§€ ë§ê³  ì—°ë½í•´ì£¼ì„¸ìš” ğŸ‘‹\n\nì¢‹ì•˜ë‹¤ë©´ í¬ìŠ¤íŠ¸ í•˜ë‹¨ì— ìˆëŠ” 'ë°•ìˆ˜' ê¸°ëŠ¥ì„ ì‚¬ìš©í•´ì£¼ì„¸ìš”! (í•œ ë²ˆ ì´ìƒ ë°•ìˆ˜ë¥¼ ì¹  ìˆ˜ ìˆì–´ìš”!!)\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n# ì œ ì†Œê°œ\n\nì•ˆë…•í•˜ì„¸ìš”, ì €ëŠ” ì˜êµ­ì— ê±°ì£¼í•˜ê³  ìˆëŠ” AWS ì»¤ë®¤ë‹ˆí‹° ë¹Œë”ì´ì ë¸”ë¡œê±°ì¸ Leeì…ë‹ˆë‹¤. AWS ì¸ì¦ í´ë¼ìš°ë“œ ì•„í‚¤í…íŠ¸ì´ë©° City Electrical Factors (UK) ë° City Electric Supply (US)ì—ì„œ ê¸€ë¡œë²Œ ê¸°ìˆ  ë° ì•„í‚¤í…ì²˜ ì±…ì„ìë¡œ ì¼í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì§€ë‚œ 6ë…„ê°„ ì£¼ë¡œ AWSì—ì„œ í’€ìŠ¤íƒ JavaScriptë¥¼ ì‚¬ìš©í•´ ì™”ìŠµë‹ˆë‹¤.\n\nì €ëŠ” ì„œë²„ë¦¬ìŠ¤ë¥¼ ì§€ì§€í•˜ëŠ” ì‚¬ëŒìœ¼ë¡œ, AWS, í˜ì‹ , ì†Œí”„íŠ¸ì›¨ì–´ ì•„í‚¤í…ì²˜, ê¸°ìˆ ì— ëŒ€í•œ ì• ì •ì´ ìˆìŠµë‹ˆë‹¤.\n\n**_ ì œê³µëœ ì •ë³´ëŠ” ì œ ê°œì¸ì ì¸ ê²¬í•´ì´ë©° í•´ë‹¹ ì •ë³´ ì‚¬ìš©ì— ëŒ€í•œ ì±…ì„ì„ ì§€ì§€ ì•ŠìŠµë‹ˆë‹¤. _**\n\n<!-- ui-station ì‚¬ê°í˜• -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\nì•„ë˜ ë‚´ìš©ë„ ì°¸ê³ í•˜ì‹œë©´ ì¢‹ì„ ê²ƒ ê°™ì•„ìš”:\n","ogImage":{"url":"/assets/img/2024-06-23-ServerlessEventBridgePipes_0.png"},"coverImage":"/assets/img/2024-06-23-ServerlessEventBridgePipes_0.png","tag":["Tech"],"readingTime":16},"content":"<!doctype html>\n<html lang=\"en\">\n<head>\n<meta charset=\"utf-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n</head>\n<body>\n<h2>ì•ˆë‚´</h2>\n<p>âœ”ï¸ Amazon EventBridge Pipes ë° ê·¸ë“¤ì´ ë¬´ì—‡ì¸ì§€ì— ëŒ€í•´ ë…¼ì˜í•©ë‹ˆë‹¤.\nâœ”ï¸ Python ë° AWS CDKë¥¼ ì‚¬ìš©í•œ ì˜ˆì œë¥¼ í†µí•´ ì•ˆë‚´í•©ë‹ˆë‹¤.</p>\n<h1>ì†Œê°œ ğŸ‘‹ğŸ½</h1>\n<p></p>\n<p>ì´ ê¸°ì‚¬ì—ì„œëŠ” AWS CDKì™€ Pythonì„ ì‚¬ìš©í•˜ì—¬ êµ¬ì¶•ëœ í—ˆêµ¬ì˜ ì¹˜ê³¼ ì•±ì„ ë§Œë“¤ì–´ê°€ë©´ì„œ Amazon EventBridge Pipesì— ëŒ€í•´ ë‹¤ë¤„ë³¼ ê²ƒì…ë‹ˆë‹¤.</p>\n<p><img src=\"/assets/img/2024-06-23-ServerlessEventBridgePipes_1.png\" alt=\"ì´ë¯¸ì§€\"></p>\n<p>'LJ ì¹˜ê³¼ ì˜ì‚¬' ì•±ì€ ì‚¬ëŒë“¤ì´ ê°€ì¥ ê°€ê¹Œìš´ ì¹˜ê³¼ ì˜ì‚¬ì™€ ì˜ˆì•½ì„ ì¡ì„ ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.</p>\n<p><img src=\"/assets/img/2024-06-23-ServerlessEventBridgePipes_2.png\" alt=\"ì´ë¯¸ì§€\"></p>\n<p></p>\n<p>ê·¸ë“¤ì´ ì´ë¯¸ ë°©ë¬¸í•œ ì ì´ ìˆëŠ” ê²½ìš°ì—ëŠ” ì´ë©”ì¼, SMS ë˜ëŠ” í†µì‹  ì—†ìŒì„ ë³´ë‚´ê¸° ì „ì— ì„ í˜¸í•˜ëŠ” ì—°ë½ ë°©ë²•ì„ í™•ì¸í•©ë‹ˆë‹¤. ì´ ëª¨ë‘ëŠ” Amazon EventBridge Pipesë¥¼ ì‚¬ìš©í•˜ì—¬ ì²˜ë¦¬ë©ë‹ˆë‹¤.</p>\n<p><img src=\"/assets/img/2024-06-23-ServerlessEventBridgePipes_3.png\" alt=\"ì´ë¯¸ì§€\"></p>\n<p>ì´ ê¸°ì‚¬ì˜ ì „ì²´ ì½”ë“œ ì˜ˆì œëŠ” ì—¬ê¸°ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>\n<h1>ìš°ë¦¬ê°€ ë¬´ì—‡ì„ ë§Œë“¤ê³  ìˆë‚˜ìš”? ğŸ› ï¸</h1>\n<p></p>\n<p>í™˜ìë“¤ì´ ì˜¨ë¼ì¸ìœ¼ë¡œ ì§„ë£Œ ì˜ˆì•½ì„ í•  ìˆ˜ ìˆë„ë¡ ë‹¤ìŒ ì•„í‚¤í…ì²˜ë¥¼ ì‚¬ìš©í•  ì˜ˆì •ì…ë‹ˆë‹¤:</p>\n<p><img src=\"/assets/img/2024-06-23-ServerlessEventBridgePipes_4.png\" alt=\"ì•„í‚¤í…ì²˜\"></p>\n<p>í™˜ìë“¤ì´ ë‹¤ìŒì„ ì‚¬ìš©í•˜ì—¬ ì§„ë£Œë¥¼ ì˜ˆì•½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>\n<ul>\n<li>Amazon API Gateway REST APIë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜¨ë¼ì¸ìœ¼ë¡œ ì§„ë£Œ ì˜ˆì•½ì„ í•©ë‹ˆë‹¤.</li>\n<li>Lambda í•¨ìˆ˜ê°€ ì§„ë£Œ ìƒì„¸ ë‚´ìš©ì„ DynamoDB í…Œì´ë¸”ì— ê¸°ë¡í•©ë‹ˆë‹¤.</li>\n<li>ìš°ë¦¬ëŠ” DynamoDB ìŠ¤íŠ¸ë¦¼ì„ ì‚¬ìš©í•˜ì—¬ í…Œì´ë¸”ì˜ ë³€ê²½ ì‚¬í•­ì„ ê°ì§€í•˜ê³  ë ˆì½”ë“œê°€ ìƒì„±ë˜ì—ˆì„ ê²½ìš°ì—ë§Œ í•„í„°ë§í•˜ì—¬ Amazon EventBridge Pipesë¥¼ í†µí•´ í•´ë‹¹ ìŠ¤íŠ¸ë¦¼ì„ ì†ŒìŠ¤ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.</li>\n<li>ì¼ì¹˜í•˜ëŠ” ë ˆì½”ë“œê°€ ì—°ë½ì²˜ ì„ í˜¸ë„ í…Œì´ë¸”ì— ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” Lambda í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ ìŠ¤íŠ¸ë¦¼ ë ˆì½”ë“œì— ì„ í˜¸ë„ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.</li>\n<li>ë§ˆì§€ë§‰ìœ¼ë¡œ, Amazon EventBridge Pipesì˜ ëŒ€ìƒì€ SQSë¡œ ì„¤ì •ë˜ì–´ ì§„ë£Œë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ì¤€ë¹„ëœ ì˜ˆì•½ì„ ì €ì¥í•©ë‹ˆë‹¤.</li>\n</ul>\n<p></p>\n<p>ğŸ‘‡ ë” ì§„ì „í•˜ê¸° ì „ì— â€” í–¥í›„ ë¸”ë¡œê·¸ ê²Œì‹œë¬¼ê³¼ ì„œë²„ë¦¬ìŠ¤ ë‰´ìŠ¤ë¥¼ ë§Œë‚˜ë³´ê¸° ìœ„í•´ LinkedInì— ì—°ë½í•´ ì£¼ì„¸ìš” <a href=\"https://www.linkedin.com/in/lee-james-gilmore/\" rel=\"nofollow\" target=\"_blank\">https://www.linkedin.com/in/lee-james-gilmore/</a></p>\n<p><img src=\"/assets/img/2024-06-23-ServerlessEventBridgePipes_5.png\" alt=\"ServerlessEventBridgePipes_5\"></p>\n<h1>Amazon EventBridge Pipesë€ ë¬´ì—‡ì¸ê°€ìš”?</h1>\n<p>Amazon EventBridge PipesëŠ” ì˜µì…˜ ë³€í™˜, í•„í„° ë° í’ë¶€í•œ ë‹¨ê³„ë¥¼ í†µí•´ ì´ë²¤íŠ¸ ìƒì„±ìì™€ ì†Œë¹„ì ê°„ì˜ í¬ì¸íŠ¸ íˆ¬ í¬ì¸íŠ¸ í†µí•©ì„ ìƒì„±í•˜ëŠ” ë° ë„ì›€ì„ ì¤ë‹ˆë‹¤. EventBridge Pipesë¥¼ ì‚¬ìš©í•˜ë©´ ì´ë²¤íŠ¸ ì¤‘ì‹¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ êµ¬ì¶•í•  ë•Œ í•„ìš”í•œ í†µí•© ì½”ë“œ ì–‘ì„ ì¤„ì´ê³  ìœ ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ ë‹¤ì´ì–´ê·¸ë¨ì€ ìš°ë¦¬ ì˜ˆì‹œë¥¼ ìœ„í•´ ì´ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤:</p>\n<p></p>\n<p>ìœ„ ë‹¤ì´ì–´ê·¸ë¨ì—ì„œ ì•Œ ìˆ˜ ìˆë“¯ì´ ë‹¤ìŒì´ ìˆìŠµë‹ˆë‹¤:</p>\n<ul>\n<li>ì†ŒìŠ¤ë¡œ DynamoDB ìŠ¤íŠ¸ë¦¼ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.</li>\n<li>ìƒˆë¡œ ì‚½ì…ëœ ë ˆì½”ë“œë§Œ ë°›ë„ë¡ ì¶”ê°€ í•„í„°ë§ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤(ì˜ˆ: ì‚­ì œ ë˜ëŠ” ì—…ë°ì´íŠ¸ ì œì™¸).</li>\n<li>ë³„ë„ì˜ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì—°ë½ì²˜ ì •ë³´ë¥¼ ì½ëŠ” enrichment Lambda í•¨ìˆ˜ë¥¼ í†µí•´ ìŠ¤íŠ¸ë¦¼ì—ì„œ ì•½ì† ë°ì´í„°ë¥¼ ì¶”ê°€ ì •ë³´ë¡œ í–¥ìƒì‹œí‚µë‹ˆë‹¤.</li>\n<li>ìµœì¢…ì ìœ¼ë¡œ ì•½ì† ë ˆì½”ë“œë¥¼ ë” ì²˜ë¦¬í•˜ê¸° ìœ„í•´ SQS ëŒ€ê¸°ì—´ë¡œ ì„¤ì •ëœ ëŒ€ìƒì´ ìˆìŠµë‹ˆë‹¤.</li>\n</ul>\n<p>ì°¸ê³ ë¡œ ì•„ë˜ì— í‘œì‹œëœ ë‹¤ì–‘í•œ ì„œë¹„ìŠ¤ì™€ êµ¬ì„±ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>\n<p><img src=\"/assets/img/2024-06-23-ServerlessEventBridgePipes_6.png\" alt=\"ì´ë¯¸ì§€\"></p>\n<p></p>\n<h1>ì£¼ìš” ì½”ë“œ ì„¤ëª…í•˜ê¸° ğŸ‘¨â€ğŸ’»</h1>\n<p>ì´ì œ ëª‡ ê°€ì§€ ì£¼ìš” ì½”ë“œì— ëŒ€í•´ ì´ì•¼ê¸°í•´ë´…ì‹œë‹¤.</p>\n<p>ì•„ë˜ì—ì„œ ë³¼ ìˆ˜ ìˆëŠ”ëŒ€ë¡œ CDK ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìƒíƒœ(Stateful) ë° ìƒíƒœ ì—†ìŒ(Stateless) ë¦¬ì†ŒìŠ¤(ìŠ¤íƒ)ë¡œ ë¶„ë¦¬í•˜ê¸° ì‹œì‘í•©ë‹ˆë‹¤:</p>\n<pre><code class=\"hljs language-js\">#!<span class=\"hljs-regexp\">/usr/</span>bin/env python3\n<span class=\"hljs-keyword\">import</span> os\n\n<span class=\"hljs-keyword\">import</span> aws_cdk <span class=\"hljs-keyword\">as</span> cdk\n<span class=\"hljs-keyword\">from</span> stateful.<span class=\"hljs-property\">stateful</span> <span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">DentistsStatefulStack</span>\n<span class=\"hljs-keyword\">from</span> stateless.<span class=\"hljs-property\">stateless</span> <span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">DentistsStatelessStack</span>\n\napp = cdk.<span class=\"hljs-title class_\">App</span>()\n\n# ì•±ì„ ìƒíƒœ(<span class=\"hljs-title class_\">Stateful</span>) ë° ìƒíƒœ ì—†ìŒ(<span class=\"hljs-title class_\">Stateless</span>) ë¦¬ì†ŒìŠ¤ë¡œ ë¶„ë¦¬í•©ë‹ˆë‹¤\n<span class=\"hljs-title class_\">DentistsStatefulStack</span>(app, <span class=\"hljs-string\">\"DentistsStatefulStack\"</span>)\n<span class=\"hljs-title class_\">DentistsStatelessStack</span>(app, <span class=\"hljs-string\">\"DentistsStatelessStack\"</span>)\n\napp.<span class=\"hljs-title function_\">synth</span>()\n</code></pre>\n<p></p>\n<p>Stateful ìŠ¤íƒì„ ë¨¼ì € ì‚´í´ ë³´ë©´, ë‘ ê°œì˜ DynamoDB í…Œì´ë¸”ì„ ì„¤ì •í–ˆìŒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•˜ë‚˜ëŠ” ì•½ì†ì„, ë‹¤ë¥¸ í•˜ë‚˜ëŠ” ì„ í˜¸í•˜ëŠ” ì—°ë½ì²˜ ì„¸ë¶€ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” í…Œì´ë¸”ì…ë‹ˆë‹¤:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">from</span> aws_cdk <span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">CfnOutput</span>, <span class=\"hljs-title class_\">RemovalPolicy</span>, <span class=\"hljs-title class_\">Stack</span>\n<span class=\"hljs-keyword\">from</span> aws_cdk <span class=\"hljs-keyword\">import</span> aws_dynamodb <span class=\"hljs-keyword\">as</span> dynamodb\n<span class=\"hljs-keyword\">from</span> constructs <span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">Construct</span>\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">DentistsStatefulStack</span>(<span class=\"hljs-title class_\">Stack</span>):\n\n    def <span class=\"hljs-title function_\">__init__</span>(self, <span class=\"hljs-attr\">scope</span>: <span class=\"hljs-title class_\">Construct</span>, <span class=\"hljs-attr\">construct_id</span>: str, **kwargs) -> <span class=\"hljs-title class_\">None</span>:\n        <span class=\"hljs-variable language_\">super</span>().<span class=\"hljs-title function_\">__init__</span>(scope, construct_id, **kwargs)\n\n        # ì•½ì†ì„ ì €ì¥í•˜ëŠ” <span class=\"hljs-title class_\">DynamoDB</span> í…Œì´ë¸” ì¶”ê°€ ë° ìŠ¤íŠ¸ë¦¼ í™œì„±í™”\n        table = dynamodb.<span class=\"hljs-title class_\">Table</span>(\n            self, <span class=\"hljs-string\">'DentistTable'</span>,\n            billing_mode=dynamodb.<span class=\"hljs-property\">BillingMode</span>.<span class=\"hljs-property\">PAY_PER_REQUEST</span>,\n            table_name=<span class=\"hljs-string\">'DentistTable'</span>,\n            stream=dynamodb.<span class=\"hljs-property\">StreamViewType</span>.<span class=\"hljs-property\">NEW_IMAGE</span>,\n            removal_policy=<span class=\"hljs-title class_\">RemovalPolicy</span>.<span class=\"hljs-property\">DESTROY</span>,\n            partition_key=dynamodb.<span class=\"hljs-title class_\">Attribute</span>(\n                name=<span class=\"hljs-string\">'id'</span>,\n                type=dynamodb.<span class=\"hljs-property\">AttributeType</span>.<span class=\"hljs-property\">STRING</span>\n            )\n        )\n\n        # ì´ë©”ì¼ ì£¼ì†Œë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•˜ëŠ” ì—°ë½ ì„ í˜¸ë„ <span class=\"hljs-title class_\">DynamoDB</span> í…Œì´ë¸” ì¶”ê°€\n        contact_table = dynamodb.<span class=\"hljs-title class_\">Table</span>(\n            self, <span class=\"hljs-string\">'DentistContactsTable'</span>,\n            billing_mode=dynamodb.<span class=\"hljs-property\">BillingMode</span>.<span class=\"hljs-property\">PAY_PER_REQUEST</span>,\n            table_name=<span class=\"hljs-string\">'DentistContactsTable'</span>,\n            removal_policy=<span class=\"hljs-title class_\">RemovalPolicy</span>.<span class=\"hljs-property\">DESTROY</span>,\n            partition_key=dynamodb.<span class=\"hljs-title class_\">Attribute</span>(\n                name=<span class=\"hljs-string\">'id'</span>,\n                type=dynamodb.<span class=\"hljs-property\">AttributeType</span>.<span class=\"hljs-property\">STRING</span>\n            )\n        )\n\n        # í…Œì´ë¸” ì´ë¦„ì„ ìœ„í•œ ìŠ¤íƒ ì¶œë ¥ ì¶”ê°€\n        <span class=\"hljs-title class_\">CfnOutput</span>(\n            self, <span class=\"hljs-string\">'DentistDynamoDBTableName'</span>,\n            value=table.<span class=\"hljs-property\">table_name</span>,\n            description=<span class=\"hljs-string\">'DynamoDB í…Œì´ë¸” ì´ë¦„'</span>,\n            export_name=<span class=\"hljs-string\">'DentistDynamoDBTableName'</span>\n        )\n\n        # ì—°ë½ì²˜ í…Œì´ë¸” ì´ë¦„ì„ ìœ„í•œ ìŠ¤íƒ ì¶œë ¥ ì¶”ê°€\n        <span class=\"hljs-title class_\">CfnOutput</span>(\n            self, <span class=\"hljs-string\">'DentistContactDynamoDBTableName'</span>,\n            value=contact_table.<span class=\"hljs-property\">table_name</span>,\n            description=<span class=\"hljs-string\">'ì—°ë½ ì„ í˜¸ë„ DynamoDB í…Œì´ë¸” ì´ë¦„'</span>,\n            export_name=<span class=\"hljs-string\">'DentistContactDynamoDBTableName'</span>\n        )\n\n        # ì•½ì† í…Œì´ë¸”ì˜ í…Œì´ë¸” ìŠ¤íŠ¸ë¦¼ <span class=\"hljs-variable constant_\">ARN</span>ì„ ìœ„í•œ ìŠ¤íƒ ì¶œë ¥ ì¶”ê°€\n        <span class=\"hljs-title class_\">CfnOutput</span>(\n            self, <span class=\"hljs-string\">'DentistDynamoDBTableStreamArn'</span>,\n            value=table.<span class=\"hljs-property\">table_stream_arn</span>,\n            description=<span class=\"hljs-string\">'DynamoDB í…Œì´ë¸” ìŠ¤íŠ¸ë¦¼ ARN'</span>,\n            export_name=<span class=\"hljs-string\">'DentistDynamoDBTableStreamArn'</span>\n        )\n</code></pre>\n<p>ì´ì œ Stateful ë¦¬ì†ŒìŠ¤ê°€ ì„¤ì •ëìœ¼ë¯€ë¡œ, Stateless ìŠ¤íƒì—ì„œ ë¨¼ì € ì•½ì†ì„ ìƒì„±í•˜ëŠ” ëŒë‹¤ í•¨ìˆ˜ë¥¼ ìƒì„±í•©ë‹ˆë‹¤:</p>\n<pre><code class=\"hljs language-js\"># ì•½ì†ì„ ìƒì„±í•˜ëŠ” ëŒë‹¤ í•¨ìˆ˜ ìƒì„±\ncreate_appointment_lambda = aws_lambda.<span class=\"hljs-title class_\">Function</span>(\n    self, <span class=\"hljs-string\">'CreateAppointment'</span>,\n    runtime=aws_lambda.<span class=\"hljs-property\">Runtime</span>.<span class=\"hljs-property\">PYTHON_3_12</span>,\n    handler=<span class=\"hljs-string\">'create_appointment.handler'</span>,\n    code=aws_lambda.<span class=\"hljs-property\">Code</span>.<span class=\"hljs-title function_\">from_asset</span>(os.<span class=\"hljs-property\">path</span>.<span class=\"hljs-title function_\">join</span>(<span class=\"hljs-variable constant_\">DIRNAME</span>, <span class=\"hljs-string\">'src'</span>)),\n    function_name=<span class=\"hljs-string\">'CreateAppointment'</span>,\n    environment={\n        <span class=\"hljs-string\">'dynamodb_table'</span>: dynamodb_table_name,\n    },\n)\n</code></pre>\n<p></p>\n<p>Lambda í•¨ìˆ˜ì— ì¶”ê°€ì ìœ¼ë¡œ ë‘ ë²ˆì§¸ Lambda í•¨ìˆ˜ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤. ì´ í•¨ìˆ˜ëŠ” DynamoDB ìŠ¤íŠ¸ë¦¼ì´ ì œê³µí•˜ëŠ” ë°ì´í„°ë¥¼ í’ë¶€í•˜ê²Œ í•˜ëŠ” ë° ì‚¬ìš©ë  ê²ƒì…ë‹ˆë‹¤:</p>\n<pre><code class=\"hljs language-js\"># ì—°ë½ì²˜ ì„¸ë¶€ ì •ë³´ë¥¼ ê²€ìƒ‰í•˜ëŠ” ëŒë‹¤ í•¨ìˆ˜ ìƒì„±\nget_contact_details = aws_lambda.<span class=\"hljs-title class_\">Function</span>(\n    self, <span class=\"hljs-string\">'GetContactDetails'</span>,\n    runtime=aws_lambda.<span class=\"hljs-property\">Runtime</span>.<span class=\"hljs-property\">PYTHON_3_12</span>,\n    handler=<span class=\"hljs-string\">'get_contact_details.handler'</span>,\n    code=aws_lambda.<span class=\"hljs-property\">Code</span>.<span class=\"hljs-title function_\">from_asset</span>(os.<span class=\"hljs-property\">path</span>.<span class=\"hljs-title function_\">join</span>(<span class=\"hljs-variable constant_\">DIRNAME</span>, <span class=\"hljs-string\">'src'</span>)),\n    function_name=<span class=\"hljs-string\">'GetContactDetails'</span>,\n    environment={\n        <span class=\"hljs-string\">'contacts_dynamodb_table'</span>: contacts_dynamodb_table_name,\n    },\n)\n</code></pre>\n<p>ë‹¤ìŒìœ¼ë¡œ, ìš°ë¦¬ì˜ íŒŒì´í”„ ëŒ€ìƒì´ ë  Amazon SQS ëŒ€ê¸°ì—´ì„ ì¶”ê°€í•©ë‹ˆë‹¤:</p>\n<pre><code class=\"hljs language-js\"># <span class=\"hljs-title class_\">AppointmentsQueue</span>ë¡œ ë©”ì‹œì§€ë¥¼ ë³´ë‚¼ <span class=\"hljs-variable constant_\">SQS</span> ëŒ€ê¸°ì—´ ìƒì„±\nsqs_queue = sqs.<span class=\"hljs-title class_\">Queue</span>(\n    self, <span class=\"hljs-string\">'AppointmentsQueue'</span>,\n    queue_name=<span class=\"hljs-string\">'AppointmentsQueue'</span>,\n    removal_policy=<span class=\"hljs-title class_\">RemovalPolicy</span>.<span class=\"hljs-property\">DESTROY</span>\n)\n</code></pre>\n<p></p>\n<p>ê·¸ëŸ¼ Amazon EventBridge íŒŒì´í”„ ìì²´ì— ëŒ€í•œ IAM ì •ì±…ì„ ë§Œë“¤ì–´ì„œ ì›ë³¸, ë³´ê°• ë° ëŒ€ìƒ ìì›ê³¼ ì—°ê²°í•  ìˆ˜ ìˆë„ë¡í•©ë‹ˆë‹¤.</p>\n<pre><code class=\"hljs language-js\"># íŒŒì´í”„ ì›ë³¸(ë‹¤ì´ë‚˜ëª¨<span class=\"hljs-variable constant_\">DB</span> ìŠ¤íŠ¸ë¦¼)ìš© íŒŒì´í”„ ì •ì±…ê³¼ ì—­í•  ìƒì„±\npipe_source_policy = iam.<span class=\"hljs-title class_\">PolicyStatement</span>(\n    actions=[\n        <span class=\"hljs-string\">'dynamodb:DescribeStream'</span>,\n        <span class=\"hljs-string\">'dynamodb:GetRecords'</span>,\n        <span class=\"hljs-string\">'dynamodb:GetShardIterator'</span>,\n        <span class=\"hljs-string\">'dynamodb:ListStreams'</span>\n    ],\n    resources=[stream_arn],\n    effect=iam.<span class=\"hljs-property\">Effect</span>.<span class=\"hljs-property\">ALLOW</span>\n)\n\n# íŒŒì´í”„ ëŒ€ìƒ(<span class=\"hljs-variable constant_\">SQS</span>)ìœ¼ë¡œ ë©”ì‹œì§€ë¥¼ ê²Œì‹œí•˜ëŠ” ê²ƒì„ í—ˆìš©í•˜ëŠ” ëŒ€ìƒ ì •ì±… ì‘ì„±\npipe_target_policy = iam.<span class=\"hljs-title class_\">PolicyStatement</span>(\n    actions=[<span class=\"hljs-string\">'sqs:SendMessage'</span>],\n    resources=[sqs_queue.<span class=\"hljs-property\">queue_arn</span>],\n    effect=iam.<span class=\"hljs-property\">Effect</span>.<span class=\"hljs-property\">ALLOW</span>\n)\n\n# íŒŒì´í”„ê°€ ëŒë‹¤ ê¸°ëŠ¥ì„ í˜¸ì¶œí•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ë³´ê°• ì •ì±… ìƒì„±\npipe_enrichment_policy = iam.<span class=\"hljs-title class_\">PolicyStatement</span>(\n    actions=[<span class=\"hljs-string\">'lambda:InvokeFunction'</span>],\n    resources=[get_contact_details.<span class=\"hljs-property\">function_arn</span>],\n    effect=iam.<span class=\"hljs-property\">Effect</span>.<span class=\"hljs-property\">ALLOW</span>\n)\n\n# íŒŒì´í”„ ì—­í•  ìƒì„±\npipe_role = iam.<span class=\"hljs-title class_\">Role</span>(self, <span class=\"hljs-string\">'PipeRole'</span>,\n    assumed_by=iam.<span class=\"hljs-title class_\">ServicePrincipal</span>(<span class=\"hljs-string\">'pipes.amazonaws.com'</span>),\n)\n\n# ì—­í• ì— ì„¸ ê°€ì§€ ì •ì±… ì¶”ê°€\npipe_role.<span class=\"hljs-title function_\">add_to_policy</span>(pipe_source_policy)\npipe_role.<span class=\"hljs-title function_\">add_to_policy</span>(pipe_target_policy)\npipe_role.<span class=\"hljs-title function_\">add_to_policy</span>(pipe_enrichment_policy)\n</code></pre>\n<p>ì´ì œ ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ íŒŒì´í”„ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>\n<pre><code class=\"hljs language-js\"># ë‹¤ì´ë‚˜ëª¨<span class=\"hljs-variable constant_\">DB</span>ì˜ ìƒˆ í•­ëª©ì— ëŒ€í•œ í•„í„°ê°€ ìˆëŠ” ì´ë²¤íŠ¸ë¸Œë¦¿ì§€ íŒŒì´í”„ ìƒì„±\npipe = pipes.<span class=\"hljs-title class_\">CfnPipe</span>(self, <span class=\"hljs-string\">'Pipe'</span>,\n    role_arn=pipe_role.<span class=\"hljs-property\">role_arn</span>,\n    source=stream_arn,\n    log_configuration=pipes.<span class=\"hljs-property\">CfnPipe</span>.<span class=\"hljs-title class_\">PipeLogConfigurationProperty</span>(\n        cloudwatch_logs_log_destination=pipes.<span class=\"hljs-property\">CfnPipe</span>.<span class=\"hljs-title class_\">CloudwatchLogsLogDestinationProperty</span>(\n            log_group_arn=log_group.<span class=\"hljs-property\">log_group_arn</span>\n        ),\n        level=<span class=\"hljs-string\">'INFO'</span>,\n    ),\n    name=<span class=\"hljs-string\">'DentistPipe'</span>,\n    source_parameters=pipes.<span class=\"hljs-property\">CfnPipe</span>.<span class=\"hljs-title class_\">PipeSourceParametersProperty</span>(\n        dynamo_db_stream_parameters=pipes.<span class=\"hljs-property\">CfnPipe</span>.<span class=\"hljs-title class_\">PipeSourceDynamoDBStreamParametersProperty</span>(\n            starting_position=<span class=\"hljs-string\">'LATEST'</span>,\n        ),\n        filter_criteria=pipes.<span class=\"hljs-property\">CfnPipe</span>.<span class=\"hljs-title class_\">FilterCriteriaProperty</span>(\n            filters=[pipes.<span class=\"hljs-property\">CfnPipe</span>.<span class=\"hljs-title class_\">FilterProperty</span>(\n                pattern=json.<span class=\"hljs-title function_\">dumps</span>({<span class=\"hljs-string\">'eventName'</span>: [{ <span class=\"hljs-string\">'prefix'</span>: <span class=\"hljs-string\">'INSERT'</span> }])\n            )]\n        ),\n    ),\n    enrichment=get_contact_details.<span class=\"hljs-property\">function_arn</span>,\n    target=sqs_queue.<span class=\"hljs-property\">queue_arn</span>,\n)\npipe.<span class=\"hljs-title function_\">apply_removal_policy</span>(<span class=\"hljs-title class_\">RemovalPolicy</span>.<span class=\"hljs-property\">DESTROY</span>)\n</code></pre>\n<p></p>\n<p>í˜„ì¬ ì¸í”„ë¼ê°€ ëª¨ë‘ ì„¤ì •ë˜ì–´ ìˆì§€ë§Œ 'create_appointment.py' íŒŒì¼ì„ ì‹œì‘ìœ¼ë¡œ Lambda í•¨ìˆ˜ ì½”ë“œë¥¼ ê°„ë‹¨íˆ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">import</span> json\n<span class=\"hljs-keyword\">import</span> os\n<span class=\"hljs-keyword\">import</span> uuid\n<span class=\"hljs-keyword\">from</span> http <span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">HTTPStatus</span>\n\n<span class=\"hljs-keyword\">import</span> boto3\n<span class=\"hljs-keyword\">from</span> boto3.<span class=\"hljs-property\">dynamodb</span>.<span class=\"hljs-property\">types</span> <span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">TypeSerializer</span>\n\ndynamodb_table = os.<span class=\"hljs-title function_\">getenv</span>(<span class=\"hljs-string\">'dynamodb_table'</span>)\ndynamodb_client = boto3.<span class=\"hljs-title function_\">client</span>(<span class=\"hljs-string\">'dynamodb'</span>)\nserializer = <span class=\"hljs-title class_\">TypeSerializer</span>()\n\ndef <span class=\"hljs-title function_\">handler</span>(event, context):\n    <span class=\"hljs-attr\">try</span>:\n        # ì´ë²¤íŠ¸ì—ì„œ ìš”ì²­ ë°ì´í„°ë¥¼ êµ¬ë¬¸ ë¶„ì„í•˜ê³  ë³¸ë¬¸ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.\n        request_data = json.<span class=\"hljs-title function_\">loads</span>(event[<span class=\"hljs-string\">'body'</span>])\n\n        # uuidv4ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒˆë¡œìš´ ì•½ì† <span class=\"hljs-variable constant_\">ID</span>ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.\n        request_data[<span class=\"hljs-string\">'id'</span>] = <span class=\"hljs-title function_\">str</span>(uuid.<span class=\"hljs-title function_\">uuid4</span>())\n\n        # í˜ì´ë¡œë“œë¥¼ dynamodb í˜•ì‹ìœ¼ë¡œ ì§ë ¬í™”í•©ë‹ˆë‹¤.\n        appointment_data = {<span class=\"hljs-attr\">k</span>: serializer.<span class=\"hljs-title function_\">serialize</span>(v) <span class=\"hljs-keyword\">for</span> k, v <span class=\"hljs-keyword\">in</span> request_data.<span class=\"hljs-title function_\">items</span>()}\n\n        # í•­ëª©ì„ dynamodb í…Œì´ë¸”ì— ì¶”ê°€í•©ë‹ˆë‹¤.\n        dynamodb_client.<span class=\"hljs-title function_\">put_item</span>(<span class=\"hljs-title class_\">TableName</span>=dynamodb_table, <span class=\"hljs-title class_\">Item</span>=appointment_data)\n\n        body = {\n            <span class=\"hljs-string\">'message'</span>: request_data,\n            <span class=\"hljs-string\">'statusCode'</span>: <span class=\"hljs-title class_\">HTTPStatus</span>.<span class=\"hljs-property\">CREATED</span>,\n        }\n\n        # ì‘ë‹µì„ ì˜¬ë°”ë¥¸ í˜•ì‹ìœ¼ë¡œ <span class=\"hljs-variable constant_\">API</span> <span class=\"hljs-title class_\">Gateway</span>ë¡œ ì „ì†¡í•©ë‹ˆë‹¤.\n        response = {\n            <span class=\"hljs-string\">'statusCode'</span>: <span class=\"hljs-title class_\">HTTPStatus</span>.<span class=\"hljs-property\">CREATED</span>,\n            <span class=\"hljs-string\">'body'</span>: json.<span class=\"hljs-title function_\">dumps</span>(body, indent=<span class=\"hljs-number\">2</span>),\n            <span class=\"hljs-string\">'headers'</span>: {\n                <span class=\"hljs-string\">'content-type'</span>: <span class=\"hljs-string\">'application/json'</span>,\n            },\n        }\n\n    except <span class=\"hljs-title class_\">Exception</span> <span class=\"hljs-keyword\">as</span> <span class=\"hljs-attr\">e</span>:\n        response = {\n            <span class=\"hljs-string\">'statusCode'</span>: <span class=\"hljs-title class_\">HTTPStatus</span>.<span class=\"hljs-property\">INTERNAL_SERVER_ERROR</span>.<span class=\"hljs-property\">value</span>,\n            <span class=\"hljs-string\">'body'</span>: f<span class=\"hljs-string\">'Exception={e}'</span>,\n        }\n\n    <span class=\"hljs-keyword\">return</span> response\n</code></pre>\n<p>ìœ„ ì½”ë“œì—ì„œ ë³¼ ìˆ˜ ìˆë“¯, API Gateway ì´ë²¤íŠ¸ì—ì„œ ì•½ì†ì„ ê°€ì ¸ì™€ ìƒˆë¡œìš´ ê³ ìœ  ID(uuid)ë¥¼ ì¶”ê°€í•˜ê³  ë ˆì½”ë“œë¥¼ ì•½ì† í…Œì´ë¸”ì— ê¸°ë¡í•˜ëŠ” ê¸°ë³¸ í•¨ìˆ˜ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.</p>\n<p>í…Œì´ë¸”ì— ë ˆì½”ë“œê°€ ì¶”ê°€ë˜ë©´ ìŠ¤íŠ¸ë¦¼ì´ í˜¸ì¶œë˜ì–´ ëª¨ë“  ë ˆì½”ë“œ ë³€ê²½ì— ëŒ€í•´ íŒŒì´í”„ê°€ ë³€ê²½ ì‚¬í•­ì„ ì†ŒìŠ¤ë¡œ ê°€ì ¸ì˜¬ ê²ƒì…ë‹ˆë‹¤.</p>\n<p></p>\n<p>ê·¸ ë‹¤ìŒìœ¼ë¡œ, íŒŒì´í”„ì˜ ì¼ë¶€ë¡œ í˜¸ì¶œë˜ëŠ” Enrichment ëŒë‹¤ í•¨ìˆ˜ë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤:</p>\n<p>ìœ„ ì½”ë“œì—ì„œ ë³¼ ìˆ˜ ìˆë“¯ì´, ìŠ¤íŠ¸ë¦¼ ë ˆì½”ë“œì—ì„œ email_address ì†ì„±ì„ ê°€ì ¸ì™€ ìš°ë¦¬ê°€ ì„ í˜¸í•˜ëŠ” ì—°ë½ì²˜ DynamoDB í…Œì´ë¸”ì—ì„œ ì¡°íšŒí•©ë‹ˆë‹¤. ë ˆì½”ë“œê°€ ì¡´ì¬í•˜ë©´, ì„ í˜¸í•˜ëŠ” ë°©ë²•ì„ ê°€ì ¸ì™€ ì•½ì† ë ˆì½”ë“œì— ì¶”ê°€í•©ë‹ˆë‹¤. ì¼ì¹˜í•˜ëŠ” ë ˆì½”ë“œê°€ ì—†ìœ¼ë©´, preferredMethodë¥¼ 'none'ìœ¼ë¡œ ì¶”ê°€í•©ë‹ˆë‹¤.</p>\n<p>ì—”ë“œ íˆ¬ ì—”ë“œë¡œ í…ŒìŠ¤íŠ¸í•˜ë ¤ë©´, ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë°°í¬í•˜ê³  Contacts DynamoDb í…Œì´ë¸”ì— ë‹¤ìŒ í•­ëª©ì„ ì¶”ê°€í•˜ë©´ preferredMethodë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>\n<p></p>\n<pre><code class=\"hljs language-json\"><span class=\"hljs-punctuation\">{</span>\n  <span class=\"hljs-attr\">\"id\"</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">\"john.doe@example.com\"</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-attr\">\"preferredMethod\"</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">\"email\"</span>\n<span class=\"hljs-punctuation\">}</span>\n</code></pre>\n<p>ë§Œì•½ ë ˆì½”ë“œê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ ì´ì „ì— ì–¸ê¸‰í•œ ëŒ€ë¡œ 'none'ìœ¼ë¡œ ê¸°ë³¸ ì„¤ì •ë©ë‹ˆë‹¤.</p>\n<h1>ê²°ë¡ </h1>\n<p>Amazon EventBridge íŒŒì´í”„ë¥¼ ì‚¬ìš©í•˜ëŠ” ì‹¤ì œ ì˜ˆì‹œë¡œ ì„œë²„ë¦¬ìŠ¤ ì†”ë£¨ì…˜ì—ì„œì˜ ì‚¬ìš©ë²•ì„ ë³´ì—¬ë“œë ¤ ìœ ìš©í•˜ê²Œ ì°¾ìœ¼ì…¨ê¸°ë¥¼ í¬ë§í•©ë‹ˆë‹¤. íŒŒì´í”„ë¥¼ ì‚¬ìš©í•˜ë©´ ì´ì „ì— ì‚¬ìš©í•´ì•¼ í–ˆë˜ ëŒë‹¤ ì ‘ì°© ì½”ë“œë¥¼ ì œê±°í•  ìˆ˜ ìˆê³  ì†ŒìŠ¤ì—ì„œ ë°ì´í„°ë¥¼ ì¶”ì¶œí•˜ì—¬ í•´ë‹¹ ë°ì´í„°ë¥¼ íƒ€ê¹ƒìœ¼ë¡œ ì „ë‹¬í•˜ëŠ” í›Œë¥­í•œ ë°©ë²•ì„ ì œê³µí•©ë‹ˆë‹¤.</p>\n<p></p>\n<h1>ë§ˆë¬´ë¦¬ ğŸ‘‹ğŸ½</h1>\n<p>ì´ ê¸€ì„ ì¦ê²ê²Œ ë³´ì•˜ìœ¼ë©´ ê³µìœ í•˜ê³  í”¼ë“œë°±ì„ ë‚¨ê²¨ì£¼ì„¸ìš”!</p>\n<p>ë¹„ìŠ·í•œ ì½˜í…ì¸ ë¥¼ ë” ë³´ì‹œë ¤ë©´ ì œ YouTube ì±„ë„ì„ êµ¬ë…í•´ì£¼ì„¸ìš”!</p>\n<p></p>\n<p>ë‹¹ì‹ ê³¼ ì–´ëŠ í•˜ë‚˜ë¼ë„ ë‹¤ìŒì—ì„œë„ ì—°ê²°í•˜ê³  ì‹¶ì–´ìš”:</p>\n<ul>\n<li><a href=\"https://www.linkedin.com/in/lee-james-gilmore/\" rel=\"nofollow\" target=\"_blank\">LinkedIn</a></li>\n<li><a href=\"https://twitter.com/LeeJamesGilmore\" rel=\"nofollow\" target=\"_blank\">Twitter</a></li>\n</ul>\n<p>í¬ìŠ¤íŠ¸ë¥¼ ì¦ê²¼ë‹¤ë©´ ì¶”ê°€ë¡œ í¬ìŠ¤íŠ¸/ì‹œë¦¬ì¦ˆë¥¼ ë³´ê¸° ìœ„í•´ ë‚´ í”„ë¡œí•„ Lee James Gilmoreë¥¼ íŒ”ë¡œìš°í•´ì£¼ì„¸ìš”. ê·¸ë¦¬ê³  ì¸ì‚¬ë¥¼ ê±´ë„¤ê³  ì‹¶ë‹¤ë©´ ì ˆëŒ€ ìŠì§€ ë§ê³  ì—°ë½í•´ì£¼ì„¸ìš” ğŸ‘‹</p>\n<p>ì¢‹ì•˜ë‹¤ë©´ í¬ìŠ¤íŠ¸ í•˜ë‹¨ì— ìˆëŠ” 'ë°•ìˆ˜' ê¸°ëŠ¥ì„ ì‚¬ìš©í•´ì£¼ì„¸ìš”! (í•œ ë²ˆ ì´ìƒ ë°•ìˆ˜ë¥¼ ì¹  ìˆ˜ ìˆì–´ìš”!!)</p>\n<p></p>\n<h1>ì œ ì†Œê°œ</h1>\n<p>ì•ˆë…•í•˜ì„¸ìš”, ì €ëŠ” ì˜êµ­ì— ê±°ì£¼í•˜ê³  ìˆëŠ” AWS ì»¤ë®¤ë‹ˆí‹° ë¹Œë”ì´ì ë¸”ë¡œê±°ì¸ Leeì…ë‹ˆë‹¤. AWS ì¸ì¦ í´ë¼ìš°ë“œ ì•„í‚¤í…íŠ¸ì´ë©° City Electrical Factors (UK) ë° City Electric Supply (US)ì—ì„œ ê¸€ë¡œë²Œ ê¸°ìˆ  ë° ì•„í‚¤í…ì²˜ ì±…ì„ìë¡œ ì¼í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì§€ë‚œ 6ë…„ê°„ ì£¼ë¡œ AWSì—ì„œ í’€ìŠ¤íƒ JavaScriptë¥¼ ì‚¬ìš©í•´ ì™”ìŠµë‹ˆë‹¤.</p>\n<p>ì €ëŠ” ì„œë²„ë¦¬ìŠ¤ë¥¼ ì§€ì§€í•˜ëŠ” ì‚¬ëŒìœ¼ë¡œ, AWS, í˜ì‹ , ì†Œí”„íŠ¸ì›¨ì–´ ì•„í‚¤í…ì²˜, ê¸°ìˆ ì— ëŒ€í•œ ì• ì •ì´ ìˆìŠµë‹ˆë‹¤.</p>\n<p><strong>_ ì œê³µëœ ì •ë³´ëŠ” ì œ ê°œì¸ì ì¸ ê²¬í•´ì´ë©° í•´ë‹¹ ì •ë³´ ì‚¬ìš©ì— ëŒ€í•œ ì±…ì„ì„ ì§€ì§€ ì•ŠìŠµë‹ˆë‹¤. _</strong></p>\n<p></p>\n<p>ì•„ë˜ ë‚´ìš©ë„ ì°¸ê³ í•˜ì‹œë©´ ì¢‹ì„ ê²ƒ ê°™ì•„ìš”:</p>\n</body>\n</html>\n"},"__N_SSG":true}