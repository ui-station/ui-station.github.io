{"pageProps":{"post":{"title":"Flutter로 인물 및 가로 모드가 가능한 카메라 앱 만드는 방법","description":"","date":"2024-06-23 21:39","slug":"2024-06-23-HowtocreateacameraappbyflutterwithPortraitandLandscapemode","content":"\n![이미지](/assets/img/2024-06-23-HowtocreateacameraappbyflutterwithPortraitandLandscapemode_0.png)\n\n현재 모바일 애플리케이션 개발에서 가장 흔한 단어 중 하나인 Flutter 입니다. Flutter는 요즘 가장 편리하고 강력한 크로스 플랫폼 프레임워크 중 하나입니다. 놀라운 커뮤니티, 도구 및 라이브러리를 갖추고 있어 여러분이 원하는 모바일 애플리케이션을 만들 수 있습니다.\n\n지금은 Flutter 애플리케이션에 카메라와 같은 기능이 있는 것이 매우 흔합니다. 여러분의 애플리케이션이 CRM이든 E-commerce이든 소셜 플랫폼이든, 카메라 기능은 매우 일반적이고 유용합니다. 모든 이런 미리 튜토리얼 단어들로 지루하게 만드는 것은 하지 않겠습니다. 바로 개발에 들어가 봅시다...\n\n사용할 패키지:\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n우린 flutter.dev의 Camera 패키지를 사용할 거야.\n\n패키지 설치 방법:\n\n이것을 당신의 패키지의 pubspec.yaml 파일에 다음과 같은 줄을 추가할 거야 (그리고 암시적으로 flutter pub get을 실행할 거야):\n\n```js\ndependencies:\n  camera: ^0.10.5+2\n```\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n# 가져오기\n\n이제 당신의 Dart 코드에서 다음을 사용할 수 있습니다:\n\n```js\nimport \"package:camera/camera.dart\";\n```\n\n또한 이 링크를 클릭하여 패키지 설치를 확인할 수도 있습니다.\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n# 어떻게 구현하나요?\n\n나는 코드를 깔끔하게 작성하는 것을 선호해요. 모든 기능을 분리하고 모든 기능이나 기능이 재사용 가능하도록 만들려고 해요. 그래서 전체 카메라 기능을 분리하는 걸 좋아해요.\n아래에서 어떻게 할 수 있는지 알려드릴게요.\n단계 1: Stateful 위젯을 만드세요 (저는 CameraScreen이라고 이름 붙였어요).\n\n```js\nclass CameraScreen extends StatefulWidget\n```\n\n이제 List`CameraDescription` 유형의 변수를 취하세요. 메인 함수에서 초기화하려면 전역 변수로 만들 수도 있어요. 카메라 화면으로 이동하기 전에 사용 가능한 카메라 목록을 가져오는 것이 좋아요. 따라서 사용 가능한 카메라 목록을 가져오는 방법입니다. 메인 함수에서 사용 가능한 카메라 목록을 가져올 수도 있고, 카메라 화면으로 이동하기 전에 가져올 수도 있고, 카메라 컨트롤러를 초기화하기 전에 가져올 수도 있어요. 하지만 이렇게하여 사용 가능한 카메라를 가져올 수 있어요.\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n```dart\n// 여기에 코드를 넣어 주세요.\nList<CameraDescription> cameras = [];\nvoid getAvalaibleCamera() async {\n  try {\n    cameras = await availableCameras();\n  } catch (error, stackTrace) {\n    // 무언가를 처리합니다.\n  }\n}\n// 여기에 코드를 넣어 주세요.\n```\n\n단계 2: 이제 Init 함수를 정의합시다. Init 함수에서는 카메라에 필요한 모든 컨트롤러 및 기타 필요한 것들을 초기화할 것입니다. 다음과 같이 진행할 거에요.\n\n```dart\nlate CameraController _cameraController;\nlate CameraDescription backCamera, frontCamera;\n\n@override\nvoid initState() {\n  getAvailableCamera();\n\n  super.initState();\n}\n\n@override\nvoid dispose() {\n  _cameraController.dispose();\n  super.dispose();\n}\n\nvoid getAvailableCamera() async {\n  for (var i = 0; i < cameras.length; i++) {\n    var camera = cameras[i];\n    if (camera.lensDirection == CameraLensDirection.back) {\n      backCamera = camera;\n    }\n    if (camera.lensDirection == CameraLensDirection.front) {\n      frontCamera = camera;\n    }\n  }\n  if (backCamera == null) {\n    backCamera = cameras.first;\n  }\n  if (frontCamera == null) {\n    frontCamera = cameras.last;\n  }\n  _cameraController = CameraController(backCamera, ResolutionPreset.medium);\n\n  _cameraController.initialize().then((_) {\n    if (!mounted) {\n      return;\n    }\n    setState(() {});\n  });\n}\n```\n\n단계 3: 예스, 초기화하는 것에 관해 충분히 알겠죠. 이제 UI로 넘어갑시다.\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\nUI를 만들 때는 화면을 최대한 간단하게 유지하려고 노력하고 있어요. CameraView와 두 개의 버튼(한 개는 사진 촬영을 위한 것이고, 다른 한 개는 카메라 설정 변경을 위한 것)만 있는 정적 UI를 만들 계획이에요.\n\n여기서 빌드 함수를 확인해 볼게요.\n\n```js\n @override\n  Widget build(BuildContext context) {\n    if (!_cameraController.value.isInitialized) {\n      return Container();\n    }\n    return Scaffold(\n      backgroundColor: Colors.transparent,\n      body: CameraPreview(_cameraController),\n      floatingActionButtonLocation: FloatingActionButtonLocation.centerFloat,\n      floatingActionButton: Stack(\n        children: [\n          Align(\n            alignment: Alignment.bottomCenter,\n            child: FloatingActionButton(\n              backgroundColor: Colors.orange,\n              child: const Icon(Icons.camera_alt),\n              onPressed: () async {\n                XFile? image = await _cameraController.takePicture();\n                if(image != null){\n                  // todo: 여기에 코드를 추가해 주세요\n                }\n              },\n            ),\n          ),\n          Align(\n            alignment: Alignment.bottomRight,\n            child: Padding(\n              padding: EdgeInsets.only(right: 20),\n              child: FloatingActionButton(\n                backgroundColor: Colors.deepOrange,\n                child: const Icon(Icons.flip_camera_android),\n                onPressed: () {\n                  if (_cameraController.description.lensDirection == CameraLensDirection.back) {\n                    _cameraController = CameraController(frontCamera, ResolutionPreset.medium);\n                  } else {\n                    _cameraController = CameraController(backCamera, ResolutionPreset.medium);\n                  }\n\n                  _cameraController.initialize().then((_) {\n                    if (!mounted) {\n                      return;\n                    }\n                    setState(() {});\n                  });\n                },\n              ),\n            ),\n          ),\n        ],\n      ),\n    );\n  }\n```\n\n여기서 todo 섹션에서 작업할 거예요.\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n이 UI가 될 것입니다. 하지만 UI에 대해서는 걱정하지 마세요. 마음대로 UI를 만들면 됩니다.\n\n![이미지](/assets/img/2024-06-23-HowtocreateacameraappbyflutterwithPortraitandLandscapemode_1.png)\n\n단계 4: 여기까지는 모든 것이 카메라 패키지 설명서에 따라 괜찮아 보입니다. 하지만 이제 실제 문제가 발생합니다.\n\n\"자동 회전\" 모드를 끄고 이 사진처럼 가로 모드에서 사진을 찍고 싶을 때, 이미지가 90도 회전됩니다. 이 문제는 플러터 앱을 기본적으로 세로 모드로 설정하면서 발생합니다. 따라서 기기의 방향을 변경해도 앱이 방향에 따라 구성을 변경하지 않습니다.\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n응, 알았어. 이 문제는 단순히 기기의 자동 회전 모드를 켜는 것으로 쉽게 해결할 수 있어. 그런데 이미지나 비디오 파일을 편평화하기 위해 자동 회전 모드가 필요한 카메라 앱을 본 적이 없어. 이제 그런 문제가 생기면 어떻게 해야 할까?\n\n첫 번째 할 일은, 기기가 어느 방향을 향하고 있는지 감지하는 것인데, 자동 회전 모드가 켜져 있던 말던 상관없이 이 작업을 수행해야 해.\n\n기기의 자동 회전을 끈 채로 OrientationBuilder를 사용하여 이를 감지할 수 없어.\n\n이를 확인하려면 자이로 센서를 사용해야 해. 인터넷에 센서에 대한 많은 정보가 있으니 찾아보길 추천해. 기기의 다양한 움직임 등을 감지하는 다른 센서들도 있어. 많은 게임이 이러한 센서들을 사용하여 사용자에게 깨끗한 게임 경험을 제공해.\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n자이로 센서를 앱에 설치하려면 sensor_plus라는 이 패키지를 추가해야 합니다.\n\npubspec.ymal 파일에 패키지를 설치하고 사용하려는 페이지에 가져와야 합니다.\n\n```js\ndependencies:\n  sensors_plus: ^3.0.3\n```\n\n제가 밝혔듯이 OrientationBuilder는 기기의 자동 회전 모드가 꺼져 있거나 강제로 앱을 특정 방향으로 설정한 경우에는 작동하지 않습니다. 그래서 기기의 방향을 알기 위해 직접 OrientationBuilder를 작성해야 합니다.\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\nBuilder 위젯을 만들어 봅시다.\n\n```js\nimport 'dart:async';\n\nimport 'package:flutter/material.dart';\nimport 'package:flutter/services.dart';\nimport 'package:sensors_plus/sensors_plus.dart';\n\nclass CustomOrientationBuilder extends StatefulWidget {\n  const CustomOrientationBuilder({required this.builder, required this.isVideosRecording, super.key});\n  /// 이 빌더 함수는 콘텍스트와 방향(열거형)을 제공합니다.\n  final Widget Function(BuildContext, CustomOrientation) builder;\n  /// 이것은 비디오 녹화 중인지 여부를 나타내는 플래그입니다.\n  /// 녹화 중인 경우 방향 변경이 인식되지 않습니다. 이 논리는 제가 만들었지만 여러분은 변경할 수 있습니다.\n  final bool isVideosRecording;\n  @override\n  State<CustomOrientationBuilder> createState() => _CustomOrientationBuilderState();\n}\n\nclass _CustomOrientationBuilderState extends State<CustomOrientationBuilder> {\n  late StreamSubscription<AccelerometerEvent> accelerometerSubscription;\n  CustomOrientation cameraOrientation = CustomOrientation.portrait;\n\n  @override\n  void initState() {\n    super.initState();\n    orientation();\n  }\n  @override\n  Widget build(BuildContext context) {\n    return widget.builder(context, cameraOrientation);\n  }\n\n  orientation(){\n    try {\n      accelerometerSubscription = accelerometerEvents.listen((AccelerometerEvent event) {\n        if(!widget.isVideosRecording){\n          setState(() {\n            if (event.z < -8.0) {\n\n              cameraOrientation = CustomOrientation.portrait;\n            } else if (event.x > 5.0) {\n\n              cameraOrientation = CustomOrientation.rightLandScape;\n            } else if (event.x < -5.0) {\n\n              cameraOrientation = CustomOrientation.leftLandScape;\n            }\n            else{\n\n              cameraOrientation = CustomOrientation.portrait;\n            }\n\n          });\n\n        }\n\n\n\n      });\n    } on PlatformException catch (e) {\n      print(\"Error: $e\");\n    }\n  }\n  @override\n  void dispose() {\n    super.dispose();\n    /// 듣기자나 컨트롤러나 스트림 등의 청취자나 컨트롤러나 스트림을 해제하거나 취소하거나 제거하지 않도록 유의하세요.\n    accelerometerSubscription.cancel();\n  }\n}\n\n/// 방향 열거형\nenum CustomOrientation {portrait, leftLandScape, rightLandScape}\n```\n\n또는 사진을 찍기 전에 자이로 센서로 방향을 확인할 수 있습니다. 다음과 같이요.\n\n```js\nlate StreamSubscription<AccelerometerEvent> accelerometerSubscription;\n\nCustomOrientation getOrientation(){\n  CustomOrientation cameraOrientation = CustomOrientation.portrait;\n    try {\n      accelerometerSubscription = accelerometerEvents.listen((AccelerometerEvent event) {\n        if(!widget.isVideosRecording){\n          if (event.z < -8.0) {\n\n              cameraOrientation = CustomOrientation.portrait;\n            } else if (event.x > 5.0) {\n\n              cameraOrientation = CustomOrientation.rightLandScape;\n            } else if (event.x < -5.0) {\n\n              cameraOrientation = CustomOrientation.leftLandScape;\n            }\n            else{\n\n              cameraOrientation = CustomOrientation.portrait;\n            }\n\n        }\n\n      });\n    } on PlatformException catch (e) {\n      print(\"Error: $e\");\n    }\n    return cameraOrientation;\n}\n\n/// 여러분의 코드\ntakePhoto()async{\n  CustomOrientation orientation = getOrientation();\n  XFile? image =  await _cameraController.takePicture();\n\n  /// 여러분의 코드\n\n}\n/// 여러분의 코드\n```\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n지금은 당신의 선택입니다. 방향을 어떻게 설정할지 결정하세요.\n\n이제 이 빌더를 카메라 화면에 추가해 보겠습니다. 다음과 같이 보일 것입니다.\n\n```js\nimport 'package:camera/camera.dart';\nimport 'package:flutter/material.dart';\nimport 'package:prism_v2/global/global_variables.dart';\nimport 'package:sizer/sizer.dart';\n\nclass CameraScreen extends StatefulWidget {\n  static const routeName = '/camera';\n\n  const CameraScreen({Key? key}) : super(key: key);\n\n  @override\n  _CameraScreenState createState() => _CameraScreenState();\n}\n\nclass _CameraScreenState extends State<CameraScreen> {\n  late CameraController _cameraController;\n  late CameraDescription backCamera, frontCamera;\n\n  @override\n  void initState() {\n    getAvailableCamera();\n\n    super.initState();\n  }\n\n  @override\n  void dispose() {\n    _cameraController.dispose();\n    super.dispose();\n  }\n\n  void getAvailableCamera() async {\n    for (var i = 0; i < cameras.length; i++) {\n      var camera = cameras[i];\n      if (camera.lensDirection == CameraLensDirection.back) {\n        backCamera = camera;\n      }\n      if (camera.lensDirection == CameraLensDirection.front) {\n        frontCamera = camera;\n      }\n    }\n    if (backCamera == null) {\n      backCamera = cameras.first;\n    }\n    if (frontCamera == null) {\n      frontCamera = cameras.last;\n    }\n    _cameraController = CameraController(backCamera, ResolutionPreset.medium);\n\n    _cameraController.initialize().then((_) {\n      if (!mounted) {\n        return;\n      }\n      setState(() {});\n    });\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    if (!_cameraController.value.isInitialized) {\n      return Container();\n    }\n    return Scaffold(\n      backgroundColor: Colors.transparent,\n      body: CameraPreview(_cameraController),\n      floatingActionButtonLocation: FloatingActionButtonLocation.centerFloat,\n      floatingActionButton: Stack(\n        children: [\n          Align(\n            alignment: Alignment.bottomCenter,\n            /// here I have added this right on the take photo button\n            child: CustomOrientation(\n              builder: (context, orientation) {\n                return FloatingActionButton(\n                  backgroundColor: Colors.orange,\n                  child: const Icon(Icons.camera_alt),\n                  onPressed: () async {\n                    await _cameraController.takePicture().then((value) {\n                      Navigator.pop(context, value.path);\n                    });\n                  },\n                );\n              }\n            ),\n          ),\n          Align(\n            alignment: Alignment.bottomRight,\n            child: Padding(\n              padding: EdgeInsets.only(right: 5.0.w),\n              child: FloatingActionButton(\n                backgroundColor: Colors.deepOrange,\n                child: const Icon(Icons.flip_camera_android),\n                onPressed: () {\n                  if (_cameraController.description.lensDirection ==\n                      CameraLensDirection.back) {\n                    _cameraController =\n                        CameraController(frontCamera, ResolutionPreset.medium);\n                  } else {\n                    _cameraController =\n                        CameraController(backCamera, ResolutionPreset.medium);\n                  }\n\n                  _cameraController.initialize().then((_) {\n                    if (!mounted) {\n                      return;\n                    }\n                    setState(() {});\n                  });\n                },\n              ),\n            ),\n          ),\n        ],\n      ),\n    );\n  }\n}\n```\n\n이제 우리는 방향을 설정했습니다. 당신의 기기나 앱의 기본 방향에 대해 아무것도 할 필요가 없습니다. 문제는 기기의 방향을 변경할 때 발생할 것입니다.\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n해결하기 위해서는 디바이스의 현재 방향에 따라 이미지를 회전해야 합니다. 여기서는 takephoto 함수만 작성하고 있어요. 한번 봅시다...\n\n```dart\nimport 'package:image/image.dart' as img;\n\ntakePhoto(CustomOrientation orientation) async {\n\n  XFile? image = await _cameraController.takePicture();\n  List<int> rotatedBytes = [];\n  if (orientation != AppString.portrait) {\n    int angle = 90;\n    if (orientation == AppString.leftLandScape) {\n      angle = -90;\n    }\n    Uint8List byte = await File(rawImage!.path).readAsBytes();\n    img.Image? image = img.decodeImage(byte);\n    image = img.copyRotate(image!, angle.toInt());\n    rotatedBytes = img.encodeJpg(image);\n  }\n  File imageFile = rotatedBytes.isEmpty ? File(rawImage!.path) : await File(rawImage!.path).writeAsBytes(rotatedBytes);\n  /// 여기에 코드를 작성하세요\n\n}\n```\n\n요렇게요. 이제 원하는 대로 직립 사진을 찍을 수 있어요. 이제 카메라 방향이 OS 카메라 기능처럼 작동할 거에요.\n\n이제 비디오 파일을 회전시키고 싶다면! 가능해요. 그러나 해당 작업을 하려면 flutter_ffmpeg 패키지를 import해야 해요. 그걸 추천하진 않겠어요. 두 가지 이유가 있어서요.\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n- 비디오 녹화를 중지한 후, 비디오 처리에 너무 오랜 시간이 걸릴 수 있습니다. 녹화된 비디오의 방향에 따라 회전 처리를 하려면 많은 시간이 소요될 수 있습니다.\n- 특정 패키지를 가져오려면 minSdkVersion을 24로 증가해야 합니다. 그러면 앱 크기가 두 배가 됩니다. 그렇지 않길 바라겠네요.\n\n그러므로 가장 좋은 방법은 비디오를 서버로 전송하여 서버에서 비디오를 처리하도록 하는 것입니다.\n또는 사용자에게 비디오를 보여줄 때, RotatedBox를 사용하여 화면 방향에 따라 비디오 플레이어 위젯을 회전시킬 수 있습니다. 이렇게 하면 사용자가 비디오가 회전되었는지 여부를 이해하지 못할 것입니다.\nFlutter 여행에 도움이 되기를 바랍니다.\n\n즐거운 코딩하시고 ❤️\n","ogImage":{"url":"/assets/img/2024-06-23-HowtocreateacameraappbyflutterwithPortraitandLandscapemode_0.png"},"coverImage":"/assets/img/2024-06-23-HowtocreateacameraappbyflutterwithPortraitandLandscapemode_0.png","tag":["Tech"],"readingTime":17},"content":"<!doctype html>\n<html lang=\"en\">\n<head>\n<meta charset=\"utf-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n</head>\n<body>\n<p><img src=\"/assets/img/2024-06-23-HowtocreateacameraappbyflutterwithPortraitandLandscapemode_0.png\" alt=\"이미지\"></p>\n<p>현재 모바일 애플리케이션 개발에서 가장 흔한 단어 중 하나인 Flutter 입니다. Flutter는 요즘 가장 편리하고 강력한 크로스 플랫폼 프레임워크 중 하나입니다. 놀라운 커뮤니티, 도구 및 라이브러리를 갖추고 있어 여러분이 원하는 모바일 애플리케이션을 만들 수 있습니다.</p>\n<p>지금은 Flutter 애플리케이션에 카메라와 같은 기능이 있는 것이 매우 흔합니다. 여러분의 애플리케이션이 CRM이든 E-commerce이든 소셜 플랫폼이든, 카메라 기능은 매우 일반적이고 유용합니다. 모든 이런 미리 튜토리얼 단어들로 지루하게 만드는 것은 하지 않겠습니다. 바로 개발에 들어가 봅시다...</p>\n<p>사용할 패키지:</p>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>우린 flutter.dev의 Camera 패키지를 사용할 거야.</p>\n<p>패키지 설치 방법:</p>\n<p>이것을 당신의 패키지의 pubspec.yaml 파일에 다음과 같은 줄을 추가할 거야 (그리고 암시적으로 flutter pub get을 실행할 거야):</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-attr\">dependencies</span>:\n  <span class=\"hljs-attr\">camera</span>: ^<span class=\"hljs-number\">0.10</span><span class=\"hljs-number\">.5</span>+<span class=\"hljs-number\">2</span>\n</code></pre>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<h1>가져오기</h1>\n<p>이제 당신의 Dart 코드에서 다음을 사용할 수 있습니다:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">import</span> <span class=\"hljs-string\">\"package:camera/camera.dart\"</span>;\n</code></pre>\n<p>또한 이 링크를 클릭하여 패키지 설치를 확인할 수도 있습니다.</p>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<h1>어떻게 구현하나요?</h1>\n<p>나는 코드를 깔끔하게 작성하는 것을 선호해요. 모든 기능을 분리하고 모든 기능이나 기능이 재사용 가능하도록 만들려고 해요. 그래서 전체 카메라 기능을 분리하는 걸 좋아해요.\n아래에서 어떻게 할 수 있는지 알려드릴게요.\n단계 1: Stateful 위젯을 만드세요 (저는 CameraScreen이라고 이름 붙였어요).</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">CameraScreen</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_ inherited__\">StatefulWidget</span>\n</code></pre>\n<p>이제 List<code>CameraDescription</code> 유형의 변수를 취하세요. 메인 함수에서 초기화하려면 전역 변수로 만들 수도 있어요. 카메라 화면으로 이동하기 전에 사용 가능한 카메라 목록을 가져오는 것이 좋아요. 따라서 사용 가능한 카메라 목록을 가져오는 방법입니다. 메인 함수에서 사용 가능한 카메라 목록을 가져올 수도 있고, 카메라 화면으로 이동하기 전에 가져올 수도 있고, 카메라 컨트롤러를 초기화하기 전에 가져올 수도 있어요. 하지만 이렇게하여 사용 가능한 카메라를 가져올 수 있어요.</p>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<pre><code class=\"hljs language-dart\"><span class=\"hljs-comment\">// 여기에 코드를 넣어 주세요.</span>\n<span class=\"hljs-built_in\">List</span>&#x3C;CameraDescription> cameras = [];\n<span class=\"hljs-keyword\">void</span> getAvalaibleCamera() <span class=\"hljs-keyword\">async</span> {\n  <span class=\"hljs-keyword\">try</span> {\n    cameras = <span class=\"hljs-keyword\">await</span> availableCameras();\n  } <span class=\"hljs-keyword\">catch</span> (error, stackTrace) {\n    <span class=\"hljs-comment\">// 무언가를 처리합니다.</span>\n  }\n}\n<span class=\"hljs-comment\">// 여기에 코드를 넣어 주세요.</span>\n</code></pre>\n<p>단계 2: 이제 Init 함수를 정의합시다. Init 함수에서는 카메라에 필요한 모든 컨트롤러 및 기타 필요한 것들을 초기화할 것입니다. 다음과 같이 진행할 거에요.</p>\n<pre><code class=\"hljs language-dart\"><span class=\"hljs-keyword\">late</span> CameraController _cameraController;\n<span class=\"hljs-keyword\">late</span> CameraDescription backCamera, frontCamera;\n\n<span class=\"hljs-meta\">@override</span>\n<span class=\"hljs-keyword\">void</span> initState() {\n  getAvailableCamera();\n\n  <span class=\"hljs-keyword\">super</span>.initState();\n}\n\n<span class=\"hljs-meta\">@override</span>\n<span class=\"hljs-keyword\">void</span> dispose() {\n  _cameraController.dispose();\n  <span class=\"hljs-keyword\">super</span>.dispose();\n}\n\n<span class=\"hljs-keyword\">void</span> getAvailableCamera() <span class=\"hljs-keyword\">async</span> {\n  <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">var</span> i = <span class=\"hljs-number\">0</span>; i &#x3C; cameras.length; i++) {\n    <span class=\"hljs-keyword\">var</span> camera = cameras[i];\n    <span class=\"hljs-keyword\">if</span> (camera.lensDirection == CameraLensDirection.back) {\n      backCamera = camera;\n    }\n    <span class=\"hljs-keyword\">if</span> (camera.lensDirection == CameraLensDirection.front) {\n      frontCamera = camera;\n    }\n  }\n  <span class=\"hljs-keyword\">if</span> (backCamera == <span class=\"hljs-keyword\">null</span>) {\n    backCamera = cameras.first;\n  }\n  <span class=\"hljs-keyword\">if</span> (frontCamera == <span class=\"hljs-keyword\">null</span>) {\n    frontCamera = cameras.last;\n  }\n  _cameraController = CameraController(backCamera, ResolutionPreset.medium);\n\n  _cameraController.initialize().then((_) {\n    <span class=\"hljs-keyword\">if</span> (!mounted) {\n      <span class=\"hljs-keyword\">return</span>;\n    }\n    setState(() {});\n  });\n}\n</code></pre>\n<p>단계 3: 예스, 초기화하는 것에 관해 충분히 알겠죠. 이제 UI로 넘어갑시다.</p>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>UI를 만들 때는 화면을 최대한 간단하게 유지하려고 노력하고 있어요. CameraView와 두 개의 버튼(한 개는 사진 촬영을 위한 것이고, 다른 한 개는 카메라 설정 변경을 위한 것)만 있는 정적 UI를 만들 계획이에요.</p>\n<p>여기서 빌드 함수를 확인해 볼게요.</p>\n<pre><code class=\"hljs language-js\"> @override\n  <span class=\"hljs-title class_\">Widget</span> <span class=\"hljs-title function_\">build</span>(<span class=\"hljs-params\">BuildContext context</span>) {\n    <span class=\"hljs-keyword\">if</span> (!_cameraController.<span class=\"hljs-property\">value</span>.<span class=\"hljs-property\">isInitialized</span>) {\n      <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title class_\">Container</span>();\n    }\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title class_\">Scaffold</span>(\n      <span class=\"hljs-attr\">backgroundColor</span>: <span class=\"hljs-title class_\">Colors</span>.<span class=\"hljs-property\">transparent</span>,\n      <span class=\"hljs-attr\">body</span>: <span class=\"hljs-title class_\">CameraPreview</span>(_cameraController),\n      <span class=\"hljs-attr\">floatingActionButtonLocation</span>: <span class=\"hljs-title class_\">FloatingActionButtonLocation</span>.<span class=\"hljs-property\">centerFloat</span>,\n      <span class=\"hljs-attr\">floatingActionButton</span>: <span class=\"hljs-title class_\">Stack</span>(\n        <span class=\"hljs-attr\">children</span>: [\n          <span class=\"hljs-title class_\">Align</span>(\n            <span class=\"hljs-attr\">alignment</span>: <span class=\"hljs-title class_\">Alignment</span>.<span class=\"hljs-property\">bottomCenter</span>,\n            <span class=\"hljs-attr\">child</span>: <span class=\"hljs-title class_\">FloatingActionButton</span>(\n              <span class=\"hljs-attr\">backgroundColor</span>: <span class=\"hljs-title class_\">Colors</span>.<span class=\"hljs-property\">orange</span>,\n              <span class=\"hljs-attr\">child</span>: <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title class_\">Icon</span>(<span class=\"hljs-title class_\">Icons</span>.<span class=\"hljs-property\">camera_alt</span>),\n              <span class=\"hljs-attr\">onPressed</span>: () <span class=\"hljs-keyword\">async</span> {\n                <span class=\"hljs-title class_\">XFile</span>? image = <span class=\"hljs-keyword\">await</span> _cameraController.<span class=\"hljs-title function_\">takePicture</span>();\n                <span class=\"hljs-keyword\">if</span>(image != <span class=\"hljs-literal\">null</span>){\n                  <span class=\"hljs-comment\">// todo: 여기에 코드를 추가해 주세요</span>\n                }\n              },\n            ),\n          ),\n          <span class=\"hljs-title class_\">Align</span>(\n            <span class=\"hljs-attr\">alignment</span>: <span class=\"hljs-title class_\">Alignment</span>.<span class=\"hljs-property\">bottomRight</span>,\n            <span class=\"hljs-attr\">child</span>: <span class=\"hljs-title class_\">Padding</span>(\n              <span class=\"hljs-attr\">padding</span>: <span class=\"hljs-title class_\">EdgeInsets</span>.<span class=\"hljs-title function_\">only</span>(<span class=\"hljs-attr\">right</span>: <span class=\"hljs-number\">20</span>),\n              <span class=\"hljs-attr\">child</span>: <span class=\"hljs-title class_\">FloatingActionButton</span>(\n                <span class=\"hljs-attr\">backgroundColor</span>: <span class=\"hljs-title class_\">Colors</span>.<span class=\"hljs-property\">deepOrange</span>,\n                <span class=\"hljs-attr\">child</span>: <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title class_\">Icon</span>(<span class=\"hljs-title class_\">Icons</span>.<span class=\"hljs-property\">flip_camera_android</span>),\n                <span class=\"hljs-attr\">onPressed</span>: () {\n                  <span class=\"hljs-keyword\">if</span> (_cameraController.<span class=\"hljs-property\">description</span>.<span class=\"hljs-property\">lensDirection</span> == <span class=\"hljs-title class_\">CameraLensDirection</span>.<span class=\"hljs-property\">back</span>) {\n                    _cameraController = <span class=\"hljs-title class_\">CameraController</span>(frontCamera, <span class=\"hljs-title class_\">ResolutionPreset</span>.<span class=\"hljs-property\">medium</span>);\n                  } <span class=\"hljs-keyword\">else</span> {\n                    _cameraController = <span class=\"hljs-title class_\">CameraController</span>(backCamera, <span class=\"hljs-title class_\">ResolutionPreset</span>.<span class=\"hljs-property\">medium</span>);\n                  }\n\n                  _cameraController.<span class=\"hljs-title function_\">initialize</span>().<span class=\"hljs-title function_\">then</span>((_) {\n                    <span class=\"hljs-keyword\">if</span> (!mounted) {\n                      <span class=\"hljs-keyword\">return</span>;\n                    }\n                    <span class=\"hljs-title function_\">setState</span>(() {});\n                  });\n                },\n              ),\n            ),\n          ),\n        ],\n      ),\n    );\n  }\n</code></pre>\n<p>여기서 todo 섹션에서 작업할 거예요.</p>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>이 UI가 될 것입니다. 하지만 UI에 대해서는 걱정하지 마세요. 마음대로 UI를 만들면 됩니다.</p>\n<p><img src=\"/assets/img/2024-06-23-HowtocreateacameraappbyflutterwithPortraitandLandscapemode_1.png\" alt=\"이미지\"></p>\n<p>단계 4: 여기까지는 모든 것이 카메라 패키지 설명서에 따라 괜찮아 보입니다. 하지만 이제 실제 문제가 발생합니다.</p>\n<p>\"자동 회전\" 모드를 끄고 이 사진처럼 가로 모드에서 사진을 찍고 싶을 때, 이미지가 90도 회전됩니다. 이 문제는 플러터 앱을 기본적으로 세로 모드로 설정하면서 발생합니다. 따라서 기기의 방향을 변경해도 앱이 방향에 따라 구성을 변경하지 않습니다.</p>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>응, 알았어. 이 문제는 단순히 기기의 자동 회전 모드를 켜는 것으로 쉽게 해결할 수 있어. 그런데 이미지나 비디오 파일을 편평화하기 위해 자동 회전 모드가 필요한 카메라 앱을 본 적이 없어. 이제 그런 문제가 생기면 어떻게 해야 할까?</p>\n<p>첫 번째 할 일은, 기기가 어느 방향을 향하고 있는지 감지하는 것인데, 자동 회전 모드가 켜져 있던 말던 상관없이 이 작업을 수행해야 해.</p>\n<p>기기의 자동 회전을 끈 채로 OrientationBuilder를 사용하여 이를 감지할 수 없어.</p>\n<p>이를 확인하려면 자이로 센서를 사용해야 해. 인터넷에 센서에 대한 많은 정보가 있으니 찾아보길 추천해. 기기의 다양한 움직임 등을 감지하는 다른 센서들도 있어. 많은 게임이 이러한 센서들을 사용하여 사용자에게 깨끗한 게임 경험을 제공해.</p>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>자이로 센서를 앱에 설치하려면 sensor_plus라는 이 패키지를 추가해야 합니다.</p>\n<p>pubspec.ymal 파일에 패키지를 설치하고 사용하려는 페이지에 가져와야 합니다.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-attr\">dependencies</span>:\n  <span class=\"hljs-attr\">sensors_plus</span>: ^<span class=\"hljs-number\">3.0</span><span class=\"hljs-number\">.3</span>\n</code></pre>\n<p>제가 밝혔듯이 OrientationBuilder는 기기의 자동 회전 모드가 꺼져 있거나 강제로 앱을 특정 방향으로 설정한 경우에는 작동하지 않습니다. 그래서 기기의 방향을 알기 위해 직접 OrientationBuilder를 작성해야 합니다.</p>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>Builder 위젯을 만들어 봅시다.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">import</span> <span class=\"hljs-string\">'dart:async'</span>;\n\n<span class=\"hljs-keyword\">import</span> <span class=\"hljs-string\">'package:flutter/material.dart'</span>;\n<span class=\"hljs-keyword\">import</span> <span class=\"hljs-string\">'package:flutter/services.dart'</span>;\n<span class=\"hljs-keyword\">import</span> <span class=\"hljs-string\">'package:sensors_plus/sensors_plus.dart'</span>;\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">CustomOrientationBuilder</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_ inherited__\">StatefulWidget</span> {\n  <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title class_\">CustomOrientationBuilder</span>({required <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">builder</span>, required <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">isVideosRecording</span>, <span class=\"hljs-variable language_\">super</span>.<span class=\"hljs-property\">key</span>});\n  <span class=\"hljs-comment\">/// 이 빌더 함수는 콘텍스트와 방향(열거형)을 제공합니다.</span>\n  final <span class=\"hljs-title class_\">Widget</span> <span class=\"hljs-title class_\">Function</span>(<span class=\"hljs-title class_\">BuildContext</span>, <span class=\"hljs-title class_\">CustomOrientation</span>) builder;\n  <span class=\"hljs-comment\">/// 이것은 비디오 녹화 중인지 여부를 나타내는 플래그입니다.</span>\n  <span class=\"hljs-comment\">/// 녹화 중인 경우 방향 변경이 인식되지 않습니다. 이 논리는 제가 만들었지만 여러분은 변경할 수 있습니다.</span>\n  final bool isVideosRecording;\n  @override\n  <span class=\"hljs-title class_\">State</span>&#x3C;<span class=\"hljs-title class_\">CustomOrientationBuilder</span>> <span class=\"hljs-title function_\">createState</span>() => <span class=\"hljs-title function_\">_CustomOrientationBuilderState</span>();\n}\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">_CustomOrientationBuilderState</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_ inherited__\">State</span>&#x3C;<span class=\"hljs-title class_\">CustomOrientationBuilder</span>> {\n  late <span class=\"hljs-title class_\">StreamSubscription</span>&#x3C;<span class=\"hljs-title class_\">AccelerometerEvent</span>> accelerometerSubscription;\n  <span class=\"hljs-title class_\">CustomOrientation</span> cameraOrientation = <span class=\"hljs-title class_\">CustomOrientation</span>.<span class=\"hljs-property\">portrait</span>;\n\n  @override\n  <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">initState</span>(<span class=\"hljs-params\"></span>) {\n    <span class=\"hljs-variable language_\">super</span>.<span class=\"hljs-title function_\">initState</span>();\n    <span class=\"hljs-title function_\">orientation</span>();\n  }\n  @override\n  <span class=\"hljs-title class_\">Widget</span> <span class=\"hljs-title function_\">build</span>(<span class=\"hljs-params\">BuildContext context</span>) {\n    <span class=\"hljs-keyword\">return</span> widget.<span class=\"hljs-title function_\">builder</span>(context, cameraOrientation);\n  }\n\n  <span class=\"hljs-title function_\">orientation</span>(<span class=\"hljs-params\"></span>){\n    <span class=\"hljs-keyword\">try</span> {\n      accelerometerSubscription = accelerometerEvents.<span class=\"hljs-title function_\">listen</span>((<span class=\"hljs-title class_\">AccelerometerEvent</span> event) {\n        <span class=\"hljs-keyword\">if</span>(!widget.<span class=\"hljs-property\">isVideosRecording</span>){\n          <span class=\"hljs-title function_\">setState</span>(() {\n            <span class=\"hljs-keyword\">if</span> (event.<span class=\"hljs-property\">z</span> &#x3C; -<span class=\"hljs-number\">8.0</span>) {\n\n              cameraOrientation = <span class=\"hljs-title class_\">CustomOrientation</span>.<span class=\"hljs-property\">portrait</span>;\n            } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (event.<span class=\"hljs-property\">x</span> > <span class=\"hljs-number\">5.0</span>) {\n\n              cameraOrientation = <span class=\"hljs-title class_\">CustomOrientation</span>.<span class=\"hljs-property\">rightLandScape</span>;\n            } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (event.<span class=\"hljs-property\">x</span> &#x3C; -<span class=\"hljs-number\">5.0</span>) {\n\n              cameraOrientation = <span class=\"hljs-title class_\">CustomOrientation</span>.<span class=\"hljs-property\">leftLandScape</span>;\n            }\n            <span class=\"hljs-keyword\">else</span>{\n\n              cameraOrientation = <span class=\"hljs-title class_\">CustomOrientation</span>.<span class=\"hljs-property\">portrait</span>;\n            }\n\n          });\n\n        }\n\n\n\n      });\n    } on <span class=\"hljs-title class_\">PlatformException</span> <span class=\"hljs-keyword\">catch</span> (e) {\n      <span class=\"hljs-title function_\">print</span>(<span class=\"hljs-string\">\"Error: $e\"</span>);\n    }\n  }\n  @override\n  <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">dispose</span>(<span class=\"hljs-params\"></span>) {\n    <span class=\"hljs-variable language_\">super</span>.<span class=\"hljs-title function_\">dispose</span>();\n    <span class=\"hljs-comment\">/// 듣기자나 컨트롤러나 스트림 등의 청취자나 컨트롤러나 스트림을 해제하거나 취소하거나 제거하지 않도록 유의하세요.</span>\n    accelerometerSubscription.<span class=\"hljs-title function_\">cancel</span>();\n  }\n}\n\n<span class=\"hljs-comment\">/// 방향 열거형</span>\nenum <span class=\"hljs-title class_\">CustomOrientation</span> {portrait, leftLandScape, rightLandScape}\n</code></pre>\n<p>또는 사진을 찍기 전에 자이로 센서로 방향을 확인할 수 있습니다. 다음과 같이요.</p>\n<pre><code class=\"hljs language-js\">late <span class=\"hljs-title class_\">StreamSubscription</span>&#x3C;<span class=\"hljs-title class_\">AccelerometerEvent</span>> accelerometerSubscription;\n\n<span class=\"hljs-title class_\">CustomOrientation</span> <span class=\"hljs-title function_\">getOrientation</span>(<span class=\"hljs-params\"></span>){\n  <span class=\"hljs-title class_\">CustomOrientation</span> cameraOrientation = <span class=\"hljs-title class_\">CustomOrientation</span>.<span class=\"hljs-property\">portrait</span>;\n    <span class=\"hljs-keyword\">try</span> {\n      accelerometerSubscription = accelerometerEvents.<span class=\"hljs-title function_\">listen</span>((<span class=\"hljs-title class_\">AccelerometerEvent</span> event) {\n        <span class=\"hljs-keyword\">if</span>(!widget.<span class=\"hljs-property\">isVideosRecording</span>){\n          <span class=\"hljs-keyword\">if</span> (event.<span class=\"hljs-property\">z</span> &#x3C; -<span class=\"hljs-number\">8.0</span>) {\n\n              cameraOrientation = <span class=\"hljs-title class_\">CustomOrientation</span>.<span class=\"hljs-property\">portrait</span>;\n            } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (event.<span class=\"hljs-property\">x</span> > <span class=\"hljs-number\">5.0</span>) {\n\n              cameraOrientation = <span class=\"hljs-title class_\">CustomOrientation</span>.<span class=\"hljs-property\">rightLandScape</span>;\n            } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (event.<span class=\"hljs-property\">x</span> &#x3C; -<span class=\"hljs-number\">5.0</span>) {\n\n              cameraOrientation = <span class=\"hljs-title class_\">CustomOrientation</span>.<span class=\"hljs-property\">leftLandScape</span>;\n            }\n            <span class=\"hljs-keyword\">else</span>{\n\n              cameraOrientation = <span class=\"hljs-title class_\">CustomOrientation</span>.<span class=\"hljs-property\">portrait</span>;\n            }\n\n        }\n\n      });\n    } on <span class=\"hljs-title class_\">PlatformException</span> <span class=\"hljs-keyword\">catch</span> (e) {\n      <span class=\"hljs-title function_\">print</span>(<span class=\"hljs-string\">\"Error: $e\"</span>);\n    }\n    <span class=\"hljs-keyword\">return</span> cameraOrientation;\n}\n\n<span class=\"hljs-comment\">/// 여러분의 코드</span>\n<span class=\"hljs-title function_\">takePhoto</span>()<span class=\"hljs-keyword\">async</span>{\n  <span class=\"hljs-title class_\">CustomOrientation</span> orientation = <span class=\"hljs-title function_\">getOrientation</span>();\n  <span class=\"hljs-title class_\">XFile</span>? image =  <span class=\"hljs-keyword\">await</span> _cameraController.<span class=\"hljs-title function_\">takePicture</span>();\n\n  <span class=\"hljs-comment\">/// 여러분의 코드</span>\n\n}\n<span class=\"hljs-comment\">/// 여러분의 코드</span>\n</code></pre>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>지금은 당신의 선택입니다. 방향을 어떻게 설정할지 결정하세요.</p>\n<p>이제 이 빌더를 카메라 화면에 추가해 보겠습니다. 다음과 같이 보일 것입니다.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">import</span> <span class=\"hljs-string\">'package:camera/camera.dart'</span>;\n<span class=\"hljs-keyword\">import</span> <span class=\"hljs-string\">'package:flutter/material.dart'</span>;\n<span class=\"hljs-keyword\">import</span> <span class=\"hljs-string\">'package:prism_v2/global/global_variables.dart'</span>;\n<span class=\"hljs-keyword\">import</span> <span class=\"hljs-string\">'package:sizer/sizer.dart'</span>;\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">CameraScreen</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_ inherited__\">StatefulWidget</span> {\n  <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">const</span> routeName = <span class=\"hljs-string\">'/camera'</span>;\n\n  <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title class_\">CameraScreen</span>({<span class=\"hljs-title class_\">Key</span>? key}) : <span class=\"hljs-variable language_\">super</span>(<span class=\"hljs-attr\">key</span>: key);\n\n  @override\n  _CameraScreenState <span class=\"hljs-title function_\">createState</span>() => <span class=\"hljs-title function_\">_CameraScreenState</span>();\n}\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">_CameraScreenState</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_ inherited__\">State</span>&#x3C;<span class=\"hljs-title class_\">CameraScreen</span>> {\n  late <span class=\"hljs-title class_\">CameraController</span> _cameraController;\n  late <span class=\"hljs-title class_\">CameraDescription</span> backCamera, frontCamera;\n\n  @override\n  <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">initState</span>(<span class=\"hljs-params\"></span>) {\n    <span class=\"hljs-title function_\">getAvailableCamera</span>();\n\n    <span class=\"hljs-variable language_\">super</span>.<span class=\"hljs-title function_\">initState</span>();\n  }\n\n  @override\n  <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">dispose</span>(<span class=\"hljs-params\"></span>) {\n    _cameraController.<span class=\"hljs-title function_\">dispose</span>();\n    <span class=\"hljs-variable language_\">super</span>.<span class=\"hljs-title function_\">dispose</span>();\n  }\n\n  <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">getAvailableCamera</span>() <span class=\"hljs-keyword\">async</span> {\n    <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">var</span> i = <span class=\"hljs-number\">0</span>; i &#x3C; cameras.<span class=\"hljs-property\">length</span>; i++) {\n      <span class=\"hljs-keyword\">var</span> camera = cameras[i];\n      <span class=\"hljs-keyword\">if</span> (camera.<span class=\"hljs-property\">lensDirection</span> == <span class=\"hljs-title class_\">CameraLensDirection</span>.<span class=\"hljs-property\">back</span>) {\n        backCamera = camera;\n      }\n      <span class=\"hljs-keyword\">if</span> (camera.<span class=\"hljs-property\">lensDirection</span> == <span class=\"hljs-title class_\">CameraLensDirection</span>.<span class=\"hljs-property\">front</span>) {\n        frontCamera = camera;\n      }\n    }\n    <span class=\"hljs-keyword\">if</span> (backCamera == <span class=\"hljs-literal\">null</span>) {\n      backCamera = cameras.<span class=\"hljs-property\">first</span>;\n    }\n    <span class=\"hljs-keyword\">if</span> (frontCamera == <span class=\"hljs-literal\">null</span>) {\n      frontCamera = cameras.<span class=\"hljs-property\">last</span>;\n    }\n    _cameraController = <span class=\"hljs-title class_\">CameraController</span>(backCamera, <span class=\"hljs-title class_\">ResolutionPreset</span>.<span class=\"hljs-property\">medium</span>);\n\n    _cameraController.<span class=\"hljs-title function_\">initialize</span>().<span class=\"hljs-title function_\">then</span>((_) {\n      <span class=\"hljs-keyword\">if</span> (!mounted) {\n        <span class=\"hljs-keyword\">return</span>;\n      }\n      <span class=\"hljs-title function_\">setState</span>(() {});\n    });\n  }\n\n  @override\n  <span class=\"hljs-title class_\">Widget</span> <span class=\"hljs-title function_\">build</span>(<span class=\"hljs-params\">BuildContext context</span>) {\n    <span class=\"hljs-keyword\">if</span> (!_cameraController.<span class=\"hljs-property\">value</span>.<span class=\"hljs-property\">isInitialized</span>) {\n      <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title class_\">Container</span>();\n    }\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title class_\">Scaffold</span>(\n      <span class=\"hljs-attr\">backgroundColor</span>: <span class=\"hljs-title class_\">Colors</span>.<span class=\"hljs-property\">transparent</span>,\n      <span class=\"hljs-attr\">body</span>: <span class=\"hljs-title class_\">CameraPreview</span>(_cameraController),\n      <span class=\"hljs-attr\">floatingActionButtonLocation</span>: <span class=\"hljs-title class_\">FloatingActionButtonLocation</span>.<span class=\"hljs-property\">centerFloat</span>,\n      <span class=\"hljs-attr\">floatingActionButton</span>: <span class=\"hljs-title class_\">Stack</span>(\n        <span class=\"hljs-attr\">children</span>: [\n          <span class=\"hljs-title class_\">Align</span>(\n            <span class=\"hljs-attr\">alignment</span>: <span class=\"hljs-title class_\">Alignment</span>.<span class=\"hljs-property\">bottomCenter</span>,\n            <span class=\"hljs-comment\">/// here I have added this right on the take photo button</span>\n            <span class=\"hljs-attr\">child</span>: <span class=\"hljs-title class_\">CustomOrientation</span>(\n              <span class=\"hljs-attr\">builder</span>: (context, orientation) {\n                <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title class_\">FloatingActionButton</span>(\n                  <span class=\"hljs-attr\">backgroundColor</span>: <span class=\"hljs-title class_\">Colors</span>.<span class=\"hljs-property\">orange</span>,\n                  <span class=\"hljs-attr\">child</span>: <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title class_\">Icon</span>(<span class=\"hljs-title class_\">Icons</span>.<span class=\"hljs-property\">camera_alt</span>),\n                  <span class=\"hljs-attr\">onPressed</span>: () <span class=\"hljs-keyword\">async</span> {\n                    <span class=\"hljs-keyword\">await</span> _cameraController.<span class=\"hljs-title function_\">takePicture</span>().<span class=\"hljs-title function_\">then</span>((value) {\n                      <span class=\"hljs-title class_\">Navigator</span>.<span class=\"hljs-title function_\">pop</span>(context, value.<span class=\"hljs-property\">path</span>);\n                    });\n                  },\n                );\n              }\n            ),\n          ),\n          <span class=\"hljs-title class_\">Align</span>(\n            <span class=\"hljs-attr\">alignment</span>: <span class=\"hljs-title class_\">Alignment</span>.<span class=\"hljs-property\">bottomRight</span>,\n            <span class=\"hljs-attr\">child</span>: <span class=\"hljs-title class_\">Padding</span>(\n              <span class=\"hljs-attr\">padding</span>: <span class=\"hljs-title class_\">EdgeInsets</span>.<span class=\"hljs-title function_\">only</span>(<span class=\"hljs-attr\">right</span>: <span class=\"hljs-number\">5.0</span>.<span class=\"hljs-property\">w</span>),\n              <span class=\"hljs-attr\">child</span>: <span class=\"hljs-title class_\">FloatingActionButton</span>(\n                <span class=\"hljs-attr\">backgroundColor</span>: <span class=\"hljs-title class_\">Colors</span>.<span class=\"hljs-property\">deepOrange</span>,\n                <span class=\"hljs-attr\">child</span>: <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title class_\">Icon</span>(<span class=\"hljs-title class_\">Icons</span>.<span class=\"hljs-property\">flip_camera_android</span>),\n                <span class=\"hljs-attr\">onPressed</span>: () {\n                  <span class=\"hljs-keyword\">if</span> (_cameraController.<span class=\"hljs-property\">description</span>.<span class=\"hljs-property\">lensDirection</span> ==\n                      <span class=\"hljs-title class_\">CameraLensDirection</span>.<span class=\"hljs-property\">back</span>) {\n                    _cameraController =\n                        <span class=\"hljs-title class_\">CameraController</span>(frontCamera, <span class=\"hljs-title class_\">ResolutionPreset</span>.<span class=\"hljs-property\">medium</span>);\n                  } <span class=\"hljs-keyword\">else</span> {\n                    _cameraController =\n                        <span class=\"hljs-title class_\">CameraController</span>(backCamera, <span class=\"hljs-title class_\">ResolutionPreset</span>.<span class=\"hljs-property\">medium</span>);\n                  }\n\n                  _cameraController.<span class=\"hljs-title function_\">initialize</span>().<span class=\"hljs-title function_\">then</span>((_) {\n                    <span class=\"hljs-keyword\">if</span> (!mounted) {\n                      <span class=\"hljs-keyword\">return</span>;\n                    }\n                    <span class=\"hljs-title function_\">setState</span>(() {});\n                  });\n                },\n              ),\n            ),\n          ),\n        ],\n      ),\n    );\n  }\n}\n</code></pre>\n<p>이제 우리는 방향을 설정했습니다. 당신의 기기나 앱의 기본 방향에 대해 아무것도 할 필요가 없습니다. 문제는 기기의 방향을 변경할 때 발생할 것입니다.</p>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>해결하기 위해서는 디바이스의 현재 방향에 따라 이미지를 회전해야 합니다. 여기서는 takephoto 함수만 작성하고 있어요. 한번 봅시다...</p>\n<pre><code class=\"hljs language-dart\"><span class=\"hljs-keyword\">import</span> <span class=\"hljs-string\">'package:image/image.dart'</span> <span class=\"hljs-keyword\">as</span> img;\n\ntakePhoto(CustomOrientation orientation) <span class=\"hljs-keyword\">async</span> {\n\n  XFile? image = <span class=\"hljs-keyword\">await</span> _cameraController.takePicture();\n  <span class=\"hljs-built_in\">List</span>&#x3C;<span class=\"hljs-built_in\">int</span>> rotatedBytes = [];\n  <span class=\"hljs-keyword\">if</span> (orientation != AppString.portrait) {\n    <span class=\"hljs-built_in\">int</span> angle = <span class=\"hljs-number\">90</span>;\n    <span class=\"hljs-keyword\">if</span> (orientation == AppString.leftLandScape) {\n      angle = <span class=\"hljs-number\">-90</span>;\n    }\n    Uint8List byte = <span class=\"hljs-keyword\">await</span> File(rawImage!.path).readAsBytes();\n    img.Image? image = img.decodeImage(byte);\n    image = img.copyRotate(image!, angle.toInt());\n    rotatedBytes = img.encodeJpg(image);\n  }\n  File imageFile = rotatedBytes.isEmpty ? File(rawImage!.path) : <span class=\"hljs-keyword\">await</span> File(rawImage!.path).writeAsBytes(rotatedBytes);\n  <span class=\"hljs-comment\">/// <span class=\"markdown\">여기에 코드를 작성하세요</span></span>\n\n}\n</code></pre>\n<p>요렇게요. 이제 원하는 대로 직립 사진을 찍을 수 있어요. 이제 카메라 방향이 OS 카메라 기능처럼 작동할 거에요.</p>\n<p>이제 비디오 파일을 회전시키고 싶다면! 가능해요. 그러나 해당 작업을 하려면 flutter_ffmpeg 패키지를 import해야 해요. 그걸 추천하진 않겠어요. 두 가지 이유가 있어서요.</p>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<ul>\n<li>비디오 녹화를 중지한 후, 비디오 처리에 너무 오랜 시간이 걸릴 수 있습니다. 녹화된 비디오의 방향에 따라 회전 처리를 하려면 많은 시간이 소요될 수 있습니다.</li>\n<li>특정 패키지를 가져오려면 minSdkVersion을 24로 증가해야 합니다. 그러면 앱 크기가 두 배가 됩니다. 그렇지 않길 바라겠네요.</li>\n</ul>\n<p>그러므로 가장 좋은 방법은 비디오를 서버로 전송하여 서버에서 비디오를 처리하도록 하는 것입니다.\n또는 사용자에게 비디오를 보여줄 때, RotatedBox를 사용하여 화면 방향에 따라 비디오 플레이어 위젯을 회전시킬 수 있습니다. 이렇게 하면 사용자가 비디오가 회전되었는지 여부를 이해하지 못할 것입니다.\nFlutter 여행에 도움이 되기를 바랍니다.</p>\n<p>즐거운 코딩하시고 ❤️</p>\n</body>\n</html>\n"},"__N_SSG":true}