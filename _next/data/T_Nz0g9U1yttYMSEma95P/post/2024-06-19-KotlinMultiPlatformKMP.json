{"pageProps":{"post":{"title":"코틀린 멀티플랫폼 KMP","description":"","date":"2024-06-19 14:12","slug":"2024-06-19-KotlinMultiPlatformKMP","content":"\n이것은 안드로이드 및 iOS 플랫폼에서 작동하는 첫 번째 크로스 플랫폼 응용 프로그램을 만드는 단계별 안내서입니다.\n\n![이미지](/assets/img/2024-06-19-KotlinMultiPlatformKMP_0.png)\n\nKotlin Multiplatform 기술은 크로스 플랫폼 프로젝트의 개발을 간소화하며, 그 중요한 사용 사례 중 하나는 플랫폼 간에 응용 프로그램 로직 코드를 공유하는 것입니다.\n\nhttps://github.com/ZahraHeydari/Kotlin-MultiPlatform-Mobile\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n# 이 기사에서 배울 내용:\n\n- 환경 설정\n- 기본적인 KMM 프로젝트 생성\n- KMM 프로젝트 구조의 기초 이해\n- ViewModel\n- 네트워킹\n- iOS에서의 코루틴\n- 의존성 주입\n\n# 1. 환경 설정\n\n필요한 도구를 설치하세요:\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n- Android Studio\n- Xcode\n- JDK\n- Kotlin Multiplatform Mobile plugin\n- Kotlin plugin\n\n모든 것이 예상대로 작동되도록하려면 KDoctor 도구를 설치하고 실행하십시오.\n\n```js\nbrew install kdoctor\n```\n\n# 2. 기본 KMM 프로젝트 생성\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n안녕하세요! 안드로이드 스튜디오를 열고 새 프로젝트 템플릿에서 Kotlin Multiplatform App을 선택하세요. 그리고 '다음' 버튼을 클릭하세요.\n\n![이미지](/assets/img/2024-06-19-KotlinMultiPlatformKMP_1.png)\n\n다음 화면에서 애플리케이션의 이름과 프로젝트를 저장할 위치 등을 선택하세요. 그리고 다시 '다음' 버튼을 클릭하세요.\n\n![이미지](/assets/img/2024-06-19-KotlinMultiPlatformKMP_2.png)\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n마침내 iOS 앱에 대한 종속성 관리자를 선택하십시오. 기본적으로 Regular framework이 선택되어 있고, 그런 다음 '완료'를 눌러주세요.\n\n![이미지](/assets/img/2024-06-19-KotlinMultiPlatformKMP_3.png)\n\nGradle 동기화가 완료되면 툴바에서 실행 버튼을 사용하여 iOS 및 Android 앱을 모두 실행할 수 있습니다.\n\n![이미지](/assets/img/2024-06-19-KotlinMultiPlatformKMP_4.png)\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n안녕하세요! 안드로이드 에뮬레이터나 iOS 시뮬레이터에서 앱을 실행할 거예요.\n\n![이미지](/assets/img/2024-06-19-KotlinMultiPlatformKMP_5.png)\n\n# 3. KMM 프로젝트 구조 기초 이해\n\n각 Kotlin Multiplatform 프로젝트는 shared, androidApp, iosApp 세 가지 모듈을 포함하고 있어요.\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n<img src=\"/assets/img/2024-06-19-KotlinMultiPlatformKMP_6.png\" />\n\n- shared은 Android 및 iOS 애플리케이션 모두에 공통으로 포함된 로직을 포함하는 Kotlin 모듈입니다. 이것은 플랫폼 간에 공유하는 코드입니다. 빌드 프로세스를 자동화하기 위해 Gradle을 빌드 시스템으로 사용합니다.\n- androidApp은 Android 애플리케이션으로 빌드되는 Kotlin 모듈입니다. 빌드 시스템으로 Gradle을 사용합니다. androidApp 모듈은 공통 Android 라이브러리로 사용하기 위해 shared 모듈에 의존하고 사용합니다.\n- iosApp은 iOS 애플리케이션으로 빌드되는 Xcode 프로젝트입니다. 이는 shared 모듈에 의존하며 iOS 프레임워크로 사용합니다. 공유 모듈은 일반 프레임워크로 사용하거나 CocoaPods 종속성으로 사용할 수 있습니다.\n\n# 기대 및 실제 키워드\n\n기대 및 실제 선언을 통해 Kotlin Multiplatform 모듈에서 플랫폼별 API에 액세스할 수 있습니다. 공통 코드에서 플랫폼에 중립적인 API를 제공할 수 있습니다.\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n![Image](/assets/img/2024-06-19-KotlinMultiPlatformKMP_7.png)\n\n다음 규칙을 따라 예상 및 실제 선언을 정의합니다:\n\n- 공통 소스 세트에서 표준 코틀린 구조를 선언합니다. 이는 함수, 속성, 클래스, 인터페이스, 열거형 또는 주석일 수 있습니다.\n\n2. 이 구조물에 expect 키워드를 표시합니다. 이것이 예상 선언입니다. 이러한 선언은 공통 코드에서 사용할 수 있지만 구현은 포함하면 안 됩니다. 대신, 플랫폼별 코드가이 구현을 제공합니다.\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n3. 각 플랫폼별 소스 세트에서 동일한 구조물을 동일한 패키지에 선언하고 actual 키워드로 표시하세요. 이것이 여러분의 실제 선언입니다. 일반적으로 이 선언에는 플랫폼별 라이브러리를 사용하여 구현이 포함됩니다.\n\n![Kotlin Multiplatform](/assets/img/2024-06-19-KotlinMultiPlatformKMP_8.png)\n\n## 공통 코드\n\n공통 코드는 서로 다른 플랫폼 간에 공유되는 Kotlin 코드입니다.\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n간단한 예제를 살펴보겠습니다:\n\n```kotlin\nclass Greeting {\n    private val platform: Platform = getPlatform()\n\n    fun greet(): String {\n        return \"안녕, ${platform.name}!\"\n    }\n}\n```\n\n```kotlin\ninterface Platform {\n    val name: String\n}\n\nexpect fun getPlatform(): Platform\n```\n\n## 모든 플랫폼에서 코드 공유하기\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n만약 모든 플랫폼에 대해 공통인 비즈니스 로직이 있다면, 각 플랫폼에 동일한 코드를 작성할 필요가 없습니다. 그저 공통 소스 집합에서 공유하면 됩니다.\n\n![Image](/assets/img/2024-06-19-KotlinMultiPlatformKMP_9.png)\n\n보통 여러 네이티브 타겟을 생성해야 할 때가 많으며, 이러한 타겟들은 공통 로직과 써드파티 API를 재사용할 수 있습니다.\n\n이제 KMM 프로젝트에 viewModel을 추가할 시간입니다!\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n# 4. KMP 프로젝트의 ViewModel\n\nViewModel은 Activity 또는 Fragment를 위한 데이터를 준비하고 관리하는 클래스입니다.\n\n이 샘플 프로젝트에서 EmojiHubViewModel은 이모지 데이터를 준비하고 관리하며 UI에 노출하기 위해 사용되며, SharedViewModel은 여러 뷰모델의 기본 클래스입니다.\n\nSharedViewModel과 EmojiHubViewModel은 commonMain 모듈에 있습니다.\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n```kotlin\n// shared/commonMain/.../viewModel/SharedViewModel\nexpect open class SharedViewModel() {\n\n    val sharedViewModelScope: CoroutineScope\n\n    protected open fun onCleared()\n}\n```\n\nandroidMain 및 iosMain 소스 세트에서 actual 키워드를 사용하여 동일한 구조물을 표시하십시오. 일반적으로 이 actual 선언에는 플랫폼별 라이브러리를 사용한 구현이 포함됩니다.\n\nEmojiHubViewModel 선언이 공통 코드에 있고 iOS 및 Android 플랫폼 모두에서 사용할 수 있다는 점에 유의하십시오.\n\n```kotlin\nclass EmojiHubViewModel(private val repository: EmojiHubRepository) : SharedViewModel() {\n\n    ...\n\n    init {\n        sharedViewModelScope.launch {\n            ...\n        }\n    }\n}\n```\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n## 안드로이드 플랫폼의 ViewModel\n\n![image](/assets/img/2024-06-19-KotlinMultiPlatformKMP_10.png)\n\n```kotlin\n// shared/androidMain/.../viewModel/SharedViewModel\nactual open class SharedViewModel: ViewModel() {\n\n    actual val sharedViewModelScope: CoroutineScope = this.viewModelScope\n\n    actual override fun onCleared() {\n        super.onCleared()\n    }\n}\n```\n\n아래 코드 스니펫은 EmojiHubScreen에서 emojiHubViewModel을 사용하는 방법을 보여줍니다.\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n```kotlin\n@Composable\nfun EmojiHubScreen() {\n\n    val emojiHubViewModel: EmojiHubViewModel = koinViewModel()\n    val items by emojiHubViewModel.items.collectAsState()\n\n    Scaffold(topBar = {\n        TopAppBar(title = {\n            Text(text = \"EmojiHub\")\n        })\n    }, content = { paddingValues ->\n        LazyColumn(modifier = Modifier.padding(paddingValues)) {\n            items(items.size) { index ->\n                Item(items[index])\n            }\n        }\n    })\n}\n```\n\n저는 이 글에서 Ktor를 사용하여 데이터를 가져오고 Koin을 사용하여 종속성 주입하는 방법에 대해 설명하겠습니다! 그러니 지금은 건너뛰세요!\n\n## iOS 플랫폼의 ViewModel\n\n<img src=\"/assets/img/2024-06-19-KotlinMultiPlatformKMP_11.png\" />\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n```kotlin\n// shared/iosMain/.../viewModel/SharedViewModel\n실제 열린 클래스 SharedViewModel {\n\n    실제 val sharedViewModelScope = MainScope()\n\n    보호된 실제 기능 onCleared() {}\n\n    fun clear() {\n        onCleared()\n    }\n}\n```\n\n그리고 ContentView에서 emojiHubViewModel을 사용하는 방법입니다.\n\n```swift\nstruct ContentView: View {\n\n @StateObject\n var emojiHubViewModel: EmojiHubViewModel()\n\n var body: some View {\n     Text(String(\"EmojiHub\"))\n     List {\n          ForEach(iOSEmojiHubViewModel.items, id: \\.self) { item in\n              Item(emojiItem: item)\n          }\n     }\n  }\n}\n```\n\n# 5. 네트워킹\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\nKtor은 마이크로서비스부터 멀티플랫폼 HTTP 클라이언트 앱까지 다양한 용도로 사용됩니다. 이를 사용하려면 build.gradle.kts 파일에 아래와 같이 Ktor 종속성을 추가하면 됩니다.\n\n```kotlin\nval ktorVersion = \"3.4.3\"\n\n// shared/build.gradle.kts\nsourceSets {\n\n    val commonMain by getting {\n        dependencies {\n            implementation(\"io.ktor:ktor-client-core:$ktorVersion\")\n            implementation(\"io.ktor:ktor-client-logging:$ktorVersion\")\n            implementation(\"io.ktor:ktor-client-content-negotiation:$ktorVersion\")\n        }\n    }\n\n    val androidMain by getting {\n        dependsOn(commonMain)\n        dependencies {\n            // 다른 의존성 추가\n            implementation(\"io.ktor:ktor-client-okhttp:$ktorVersion\")\n        }\n    }\n\n    val iosMain by getting {\n        dependsOn(commonMain)\n        dependencies {\n            implementation(\"io.ktor:ktor-client-darwin:$ktorVersion\")\n        }\n    }\n}\n```\n\n공통 모듈인 commonMain에 HttpClient 파일을 아래와 같이 추가하세요:\n\n```kotlin\nexpect fun httpClient(config: HttpClientConfig<*>.() -> Unit): HttpClient\n```\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n안드로이드 메인에서 실제 키워드를 사용하여 httpClient를 선언하세요:\n\n```kotlin\nactual fun httpClient(config: HttpClientConfig<*>.() -> Unit): HttpClient = HttpClient(OkHttp) {\n    config()\n}\n```\n\n또한 iOS 메인에서도 실제 키워드를 사용하여 httpClient를 선언하세요:\n\n```kotlin\nactual fun httpClient(config: HttpClientConfig<*>.() -> Unit): HttpClient = HttpClient(Darwin) {\n    config()\n}\n```\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n이제 EmojiHubRepository에서 httpClient를 사용하여 원격 서버에서 이모지를 가져오세요.\n\n```kotlin\nclass EmojiHubRepository(private val httpClient: HttpClient) {\n\n    suspend fun getEmojis(): List<EmojiItem> {\n        return try {\n            httpClient.get(urlString = \"/api/all\").body()\n        } catch (e: Exception) {\n            e.printStackTrace()\n            emptyList()\n        }\n    }\n}\n```\n\n그리고 EmojiHubViewModel에서 EmojiHubRepository를 사용하여 원격 또는 로컬 소스에서 데이터를 가져오세요.\n\n```kotlin\nclass EmojiHubViewModel(private val repository: EmojiHubRepository) : SharedViewModel() {\n\n    private val _items = MutableStateFlow<List<EmojiItem>>(listOf())\n\n    @NativeCoroutinesState\n    val items = _items.asStateFlow()\n\n    init {\n        sharedViewModelScope.launch {\n            _items.update {\n                repository.getEmojis() // 저장소를 통해 데이터 가져오기\n            }\n        }\n    }\n}\n```\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n# 6. 아이폰에서의 코루틴\n\n프로젝트에 Kotlinx.Serialization을 추가하세요.\n\nKotlinx.Serialization은 사용자 정의 타입의 객체를 직렬화하고 역직렬화하는 데 사용됩니다.\n\n```js\nval kotlinxSerializationVersion = \"1.5.1\"\n\n// shared/build.gradle.kts\nsourceSets {\n\n    val commonMain by getting {\n        dependencies {\n            implementation(\"org.jetbrains.kotlinx:kotlinx-serialization-json:$kotlinxSerializationVersion\")\n            ...\n        }\n    }\n\n    val androidMain by getting {\n        dependsOn(commonMain)\n        dependencies {\n            ...\n        }\n    }\n\n    val iosMain by getting {\n        dependsOn(commonMain)\n        dependencies {\n            ...\n        }\n    }\n}\n```\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n## httpClient 재구성하기\n\n```kotlin\n// shared/commonMain/.../EmojiHubRepository\n    class EmojiHubRepository {\n        private val httpClient = httpClient {\n            ...\n            install(ContentNegotiation) {\n                json(\n                    Json {\n                        ignoreUnknownKeys = true\n                    }\n                )\n            }\n        }\n    }\n```\n\n서버에서 데이터를 가져와 Android 앱을 실행합니다.\n\n```kotlin\nsuspend fun getEmojis(): List<EmojiItem> {\n        return try {\n            httpClient.get(urlString = \"/api/all\").body()\n        } catch (e: Exception) {\n            e.printStackTrace()\n            emptyList()\n        }\n    }\n```\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n```kotlin\nclass EmojiHubViewModel(private val repository: EmojiHubRepository) : SharedViewModel() {\n\n    private val _items = MutableStateFlow<List<EmojiItem>>(listOf())\n\n    @NativeCoroutinesState\n    val items = _items.asStateFlow()\n\n    init {\n        sharedViewModelScope.launch {\n            _items.update {\n                repository.getEmojis()\n            }\n        }\n    }\n}\n```\n\n![Image](/assets/img/2024-06-19-KotlinMultiPlatformKMP_12.png)\n\n## KMP-NativeCoroutines\n\n```kotlin\n// commonMain/viewModel/EmojiHubViewModel\nclass EmojiHubViewModel(private val repository: EmojiHubRepository) : SharedViewModel() {\n\n    private val _items = MutableStateFlow<List<EmojiItem>>(listOf())\n\n    @NativeCoroutinesState\n    val items = _items.asStateFlow()\n\n    ...\n}\n```\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\nIOSEmojiHubViewModel은 iosApp 모듈에 있어요.\n\n<img src=\"/assets/img/2024-06-19-KotlinMultiPlatformKMP_13.png\" />\n\nIOSEmojiHubViewModel에서 KMPNativeCoroutinesAsync을 사용하여 데이터를 가져옵니다.\n\n```swift\n@MainActor\nclass IOSEmojiHubViewModel: ObservableObject {\n\n    private let githubViewModel = GithubViewModel()\n\n    @Published\n    var items = Array<EmojiItem>()\n\n    var task: Task<(), Never>? = nil\n\n    init() {\n        task = Task {\n            do {\n                let asyncItems = asyncSequence(for: emojiHubViewModel.itemsFlow)\n                for try await asyncItem in asyncItems {\n                    items = asyncItem\n                }\n            } catch {\n                print(\"Failed with error: \\(error)\")\n            }\n        }\n    }\n\n    func clear() {\n        task?.cancel()\n    }\n}\n```\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n```swift\nstruct ContentView: View {\n\n    @StateObject\n    var iOSEmojiHubViewModel = IOSEmojiHubViewModel()\n\n    var body: some View {\n        Text(String(\"EmojiHub\"))\n        List {\n            ForEach(iOSEmojiHubViewModel.items, id: \\.self) { item in\n                Item(emojiItem: item)\n            }\n        }\n    }\n}\n```\n\n# 7. 의존성 주입\n\n의존성 주입 패턴을 구현하기 위해 프로젝트에 Koin을 추가하세요.\n\n```js\nval koinVersion = \"3.4.3\"\n\n// shared/build.gradle.kts\nsourceSets {\n\n    val commonMain by getting {\n        dependencies {\n            implementation(\"io.insert-koin:koin-core:$koinVersion\")\n            ...\n        }\n    }\n\n    val androidMain by getting {\n        dependsOn(commonMain)\n        dependencies {\n            implementation(\"io.insert-koin:koin-android:$koinVersion\")\n            ...\n        }\n    }\n\n    val iosMain by getting {\n        dependsOn(commonMain)\n        dependencies {\n            ...\n        }\n    }\n}\n```\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\nEmojiHubRepository에 HttpClient을 주입해주세요.\n\n```kotlin\nclass EmojiHubRepository(private val httpClient: HttpClient) {\n\n    ...\n}\n```\n\n그리고 EmojiHubViewModel에서 EmojiHubRepository를 주입해주세요.\n\n```kotlin\n// commonMain/viewModel/EmojiHubViewModel\nclass EmojiHubViewModel(private val repository: EmojiHubRepository) : SharedViewModel() {\n\n    ...\n}\n```\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n아래와 같이 의존성을 정의하도록 모듈을 선언해보세요:\n\n```kotlin\nval appModule = module {\n    single {\n        httpClient {\n           ...\n        }\n    }\n\n    single {\n        EmojiHubRepository(get())\n    }\n\n    sharedViewModel {\n        EmojiHubViewModel(get())\n    }\n}\n```\n\n프로젝트 애플리케이션 클래스에 Koin을 시작하는 코드를 추가해보세요.\n\n```kotlin\n//androidApp/MainApplication\nclass MainApplication : Application() {\n\n    override fun onCreate() {\n        super.onCreate()\n\n        startKoin {\n            androidContext(this@MainApplication)\n            modules(appModule) // 앱 모듈\n        }\n    }\n}\n```\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\niOSMain 에서 Koin을 시작하려면 아래와 같이 시작하세요.\n\n```js\n// shared/iosMain/.../KoinStarter.kt\nfun startKoin() {\n    startKoin { modules(appModule) }\n}\n```\n\n<img src=\"/assets/img/2024-06-19-KotlinMultiPlatformKMP_14.png\" />\n\niOSApp에서 startKoin을 호출하세요.\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n@ main\n구조체 iOSApp: 앱 {\n\ninit() {\nKoinStarterKt.startKoin()\n}\n\n    var body: some Scene {\n       WindowGroup {\n           ContentView()\n       }\n    }\n\n}\n\n그리고 GithubViewModelHelper은 iOS에서 GithubViewModel을 주입하는 데 사용됩니다.\n\nclass EmojiHubViewModelHelper: KoinComponent {\n\n    private val emojiHubViewModel: EmojiHubViewModel = get()\n\n    @NativeCoroutinesState\n    val items = emojiHubViewModel.items\n\n}\n\n![이미지](/assets/img/2024-06-19-KotlinMultiPlatformKMP_15.png)\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n이제 Android 앱과 iOS 앱을 실행해보세요.\n\n![Kotlin Multiplatform](/assets/img/2024-06-19-KotlinMultiPlatformKMP_16.png)\n\n## 라이브러리 및 도구\n\n- KMP 플러그인\n- Kdoctor\n- Ktor\n- kotlinx.serialization\n- KMP-NativeCoroutines\n- Koin\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n간단한 KMP(Kotlin Multiplatform)를 사용한 예제 프로젝트입니다.\n\n[여기](https://github.com/ZahraHeydari/Kotlin-MultiPlatform-Mobile)를 클릭해주세요!\n\n이 이야기를 읽어 주셔서 감사합니다. 도움이 되셨으면 좋겠어요.\n\n의견이 있으시면 언제든지 남겨주세요. 감사합니다!\n\n<!-- ui-station 사각형 -->\n\n<ins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"></ins>\n\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n\n코딩을 즐기세요!\n","ogImage":{"url":"/assets/img/2024-06-19-KotlinMultiPlatformKMP_0.png"},"coverImage":"/assets/img/2024-06-19-KotlinMultiPlatformKMP_0.png","tag":["Tech"],"readingTime":22},"content":"<!doctype html>\n<html lang=\"en\">\n<head>\n<meta charset=\"utf-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n</head>\n<body>\n<p>이것은 안드로이드 및 iOS 플랫폼에서 작동하는 첫 번째 크로스 플랫폼 응용 프로그램을 만드는 단계별 안내서입니다.</p>\n<p><img src=\"/assets/img/2024-06-19-KotlinMultiPlatformKMP_0.png\" alt=\"이미지\"></p>\n<p>Kotlin Multiplatform 기술은 크로스 플랫폼 프로젝트의 개발을 간소화하며, 그 중요한 사용 사례 중 하나는 플랫폼 간에 응용 프로그램 로직 코드를 공유하는 것입니다.</p>\n<p><a href=\"https://github.com/ZahraHeydari/Kotlin-MultiPlatform-Mobile\" rel=\"nofollow\" target=\"_blank\">https://github.com/ZahraHeydari/Kotlin-MultiPlatform-Mobile</a></p>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<h1>이 기사에서 배울 내용:</h1>\n<ul>\n<li>환경 설정</li>\n<li>기본적인 KMM 프로젝트 생성</li>\n<li>KMM 프로젝트 구조의 기초 이해</li>\n<li>ViewModel</li>\n<li>네트워킹</li>\n<li>iOS에서의 코루틴</li>\n<li>의존성 주입</li>\n</ul>\n<h1>1. 환경 설정</h1>\n<p>필요한 도구를 설치하세요:</p>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<ul>\n<li>Android Studio</li>\n<li>Xcode</li>\n<li>JDK</li>\n<li>Kotlin Multiplatform Mobile plugin</li>\n<li>Kotlin plugin</li>\n</ul>\n<p>모든 것이 예상대로 작동되도록하려면 KDoctor 도구를 설치하고 실행하십시오.</p>\n<pre><code class=\"hljs language-js\">brew install kdoctor\n</code></pre>\n<h1>2. 기본 KMM 프로젝트 생성</h1>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>안녕하세요! 안드로이드 스튜디오를 열고 새 프로젝트 템플릿에서 Kotlin Multiplatform App을 선택하세요. 그리고 '다음' 버튼을 클릭하세요.</p>\n<p><img src=\"/assets/img/2024-06-19-KotlinMultiPlatformKMP_1.png\" alt=\"이미지\"></p>\n<p>다음 화면에서 애플리케이션의 이름과 프로젝트를 저장할 위치 등을 선택하세요. 그리고 다시 '다음' 버튼을 클릭하세요.</p>\n<p><img src=\"/assets/img/2024-06-19-KotlinMultiPlatformKMP_2.png\" alt=\"이미지\"></p>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>마침내 iOS 앱에 대한 종속성 관리자를 선택하십시오. 기본적으로 Regular framework이 선택되어 있고, 그런 다음 '완료'를 눌러주세요.</p>\n<p><img src=\"/assets/img/2024-06-19-KotlinMultiPlatformKMP_3.png\" alt=\"이미지\"></p>\n<p>Gradle 동기화가 완료되면 툴바에서 실행 버튼을 사용하여 iOS 및 Android 앱을 모두 실행할 수 있습니다.</p>\n<p><img src=\"/assets/img/2024-06-19-KotlinMultiPlatformKMP_4.png\" alt=\"이미지\"></p>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>안녕하세요! 안드로이드 에뮬레이터나 iOS 시뮬레이터에서 앱을 실행할 거예요.</p>\n<p><img src=\"/assets/img/2024-06-19-KotlinMultiPlatformKMP_5.png\" alt=\"이미지\"></p>\n<h1>3. KMM 프로젝트 구조 기초 이해</h1>\n<p>각 Kotlin Multiplatform 프로젝트는 shared, androidApp, iosApp 세 가지 모듈을 포함하고 있어요.</p>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<img src=\"/assets/img/2024-06-19-KotlinMultiPlatformKMP_6.png\">\n<ul>\n<li>shared은 Android 및 iOS 애플리케이션 모두에 공통으로 포함된 로직을 포함하는 Kotlin 모듈입니다. 이것은 플랫폼 간에 공유하는 코드입니다. 빌드 프로세스를 자동화하기 위해 Gradle을 빌드 시스템으로 사용합니다.</li>\n<li>androidApp은 Android 애플리케이션으로 빌드되는 Kotlin 모듈입니다. 빌드 시스템으로 Gradle을 사용합니다. androidApp 모듈은 공통 Android 라이브러리로 사용하기 위해 shared 모듈에 의존하고 사용합니다.</li>\n<li>iosApp은 iOS 애플리케이션으로 빌드되는 Xcode 프로젝트입니다. 이는 shared 모듈에 의존하며 iOS 프레임워크로 사용합니다. 공유 모듈은 일반 프레임워크로 사용하거나 CocoaPods 종속성으로 사용할 수 있습니다.</li>\n</ul>\n<h1>기대 및 실제 키워드</h1>\n<p>기대 및 실제 선언을 통해 Kotlin Multiplatform 모듈에서 플랫폼별 API에 액세스할 수 있습니다. 공통 코드에서 플랫폼에 중립적인 API를 제공할 수 있습니다.</p>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p><img src=\"/assets/img/2024-06-19-KotlinMultiPlatformKMP_7.png\" alt=\"Image\"></p>\n<p>다음 규칙을 따라 예상 및 실제 선언을 정의합니다:</p>\n<ul>\n<li>공통 소스 세트에서 표준 코틀린 구조를 선언합니다. 이는 함수, 속성, 클래스, 인터페이스, 열거형 또는 주석일 수 있습니다.</li>\n</ul>\n<ol start=\"2\">\n<li>이 구조물에 expect 키워드를 표시합니다. 이것이 예상 선언입니다. 이러한 선언은 공통 코드에서 사용할 수 있지만 구현은 포함하면 안 됩니다. 대신, 플랫폼별 코드가이 구현을 제공합니다.</li>\n</ol>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<ol start=\"3\">\n<li>각 플랫폼별 소스 세트에서 동일한 구조물을 동일한 패키지에 선언하고 actual 키워드로 표시하세요. 이것이 여러분의 실제 선언입니다. 일반적으로 이 선언에는 플랫폼별 라이브러리를 사용하여 구현이 포함됩니다.</li>\n</ol>\n<p><img src=\"/assets/img/2024-06-19-KotlinMultiPlatformKMP_8.png\" alt=\"Kotlin Multiplatform\"></p>\n<h2>공통 코드</h2>\n<p>공통 코드는 서로 다른 플랫폼 간에 공유되는 Kotlin 코드입니다.</p>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>간단한 예제를 살펴보겠습니다:</p>\n<pre><code class=\"hljs language-kotlin\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">Greeting</span> {\n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">val</span> platform: Platform = getPlatform()\n\n    <span class=\"hljs-function\"><span class=\"hljs-keyword\">fun</span> <span class=\"hljs-title\">greet</span><span class=\"hljs-params\">()</span></span>: String {\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">\"안녕, <span class=\"hljs-subst\">${platform.name}</span>!\"</span>\n    }\n}\n</code></pre>\n<pre><code class=\"hljs language-kotlin\"><span class=\"hljs-keyword\">interface</span> <span class=\"hljs-title class_\">Platform</span> {\n    <span class=\"hljs-keyword\">val</span> name: String\n}\n\n<span class=\"hljs-keyword\">expect</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">fun</span> <span class=\"hljs-title\">getPlatform</span><span class=\"hljs-params\">()</span></span>: Platform\n</code></pre>\n<h2>모든 플랫폼에서 코드 공유하기</h2>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>만약 모든 플랫폼에 대해 공통인 비즈니스 로직이 있다면, 각 플랫폼에 동일한 코드를 작성할 필요가 없습니다. 그저 공통 소스 집합에서 공유하면 됩니다.</p>\n<p><img src=\"/assets/img/2024-06-19-KotlinMultiPlatformKMP_9.png\" alt=\"Image\"></p>\n<p>보통 여러 네이티브 타겟을 생성해야 할 때가 많으며, 이러한 타겟들은 공통 로직과 써드파티 API를 재사용할 수 있습니다.</p>\n<p>이제 KMM 프로젝트에 viewModel을 추가할 시간입니다!</p>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<h1>4. KMP 프로젝트의 ViewModel</h1>\n<p>ViewModel은 Activity 또는 Fragment를 위한 데이터를 준비하고 관리하는 클래스입니다.</p>\n<p>이 샘플 프로젝트에서 EmojiHubViewModel은 이모지 데이터를 준비하고 관리하며 UI에 노출하기 위해 사용되며, SharedViewModel은 여러 뷰모델의 기본 클래스입니다.</p>\n<p>SharedViewModel과 EmojiHubViewModel은 commonMain 모듈에 있습니다.</p>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<pre><code class=\"hljs language-kotlin\"><span class=\"hljs-comment\">// shared/commonMain/.../viewModel/SharedViewModel</span>\n<span class=\"hljs-keyword\">expect</span> <span class=\"hljs-keyword\">open</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">SharedViewModel</span>() {\n\n    <span class=\"hljs-keyword\">val</span> sharedViewModelScope: CoroutineScope\n\n    <span class=\"hljs-keyword\">protected</span> <span class=\"hljs-keyword\">open</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">fun</span> <span class=\"hljs-title\">onCleared</span><span class=\"hljs-params\">()</span></span>\n}\n</code></pre>\n<p>androidMain 및 iosMain 소스 세트에서 actual 키워드를 사용하여 동일한 구조물을 표시하십시오. 일반적으로 이 actual 선언에는 플랫폼별 라이브러리를 사용한 구현이 포함됩니다.</p>\n<p>EmojiHubViewModel 선언이 공통 코드에 있고 iOS 및 Android 플랫폼 모두에서 사용할 수 있다는 점에 유의하십시오.</p>\n<pre><code class=\"hljs language-kotlin\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">EmojiHubViewModel</span>(<span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">val</span> repository: EmojiHubRepository) : SharedViewModel() {\n\n    ...\n\n    <span class=\"hljs-keyword\">init</span> {\n        sharedViewModelScope.launch {\n            ...\n        }\n    }\n}\n</code></pre>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<h2>안드로이드 플랫폼의 ViewModel</h2>\n<p><img src=\"/assets/img/2024-06-19-KotlinMultiPlatformKMP_10.png\" alt=\"image\"></p>\n<pre><code class=\"hljs language-kotlin\"><span class=\"hljs-comment\">// shared/androidMain/.../viewModel/SharedViewModel</span>\n<span class=\"hljs-keyword\">actual</span> <span class=\"hljs-keyword\">open</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">SharedViewModel</span>: <span class=\"hljs-type\">ViewModel</span>() {\n\n    <span class=\"hljs-keyword\">actual</span> <span class=\"hljs-keyword\">val</span> sharedViewModelScope: CoroutineScope = <span class=\"hljs-keyword\">this</span>.viewModelScope\n\n    <span class=\"hljs-keyword\">actual</span> <span class=\"hljs-keyword\">override</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">fun</span> <span class=\"hljs-title\">onCleared</span><span class=\"hljs-params\">()</span></span> {\n        <span class=\"hljs-keyword\">super</span>.onCleared()\n    }\n}\n</code></pre>\n<p>아래 코드 스니펫은 EmojiHubScreen에서 emojiHubViewModel을 사용하는 방법을 보여줍니다.</p>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<pre><code class=\"hljs language-kotlin\"><span class=\"hljs-meta\">@Composable</span>\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">fun</span> <span class=\"hljs-title\">EmojiHubScreen</span><span class=\"hljs-params\">()</span></span> {\n\n    <span class=\"hljs-keyword\">val</span> emojiHubViewModel: EmojiHubViewModel = koinViewModel()\n    <span class=\"hljs-keyword\">val</span> items <span class=\"hljs-keyword\">by</span> emojiHubViewModel.items.collectAsState()\n\n    Scaffold(topBar = {\n        TopAppBar(title = {\n            Text(text = <span class=\"hljs-string\">\"EmojiHub\"</span>)\n        })\n    }, content = { paddingValues ->\n        LazyColumn(modifier = Modifier.padding(paddingValues)) {\n            items(items.size) { index ->\n                Item(items[index])\n            }\n        }\n    })\n}\n</code></pre>\n<p>저는 이 글에서 Ktor를 사용하여 데이터를 가져오고 Koin을 사용하여 종속성 주입하는 방법에 대해 설명하겠습니다! 그러니 지금은 건너뛰세요!</p>\n<h2>iOS 플랫폼의 ViewModel</h2>\n<img src=\"/assets/img/2024-06-19-KotlinMultiPlatformKMP_11.png\">\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<pre><code class=\"hljs language-kotlin\"><span class=\"hljs-comment\">// shared/iosMain/.../viewModel/SharedViewModel</span>\n실제 열린 클래스 SharedViewModel {\n\n    실제 <span class=\"hljs-keyword\">val</span> sharedViewModelScope = MainScope()\n\n    보호된 실제 기능 onCleared() {}\n\n    <span class=\"hljs-function\"><span class=\"hljs-keyword\">fun</span> <span class=\"hljs-title\">clear</span><span class=\"hljs-params\">()</span></span> {\n        onCleared()\n    }\n}\n</code></pre>\n<p>그리고 ContentView에서 emojiHubViewModel을 사용하는 방법입니다.</p>\n<pre><code class=\"hljs language-swift\"><span class=\"hljs-keyword\">struct</span> <span class=\"hljs-title class_\">ContentView</span>: <span class=\"hljs-title class_\">View</span> {\n\n <span class=\"hljs-meta\">@StateObject</span>\n <span class=\"hljs-keyword\">var</span> emojiHubViewModel: <span class=\"hljs-type\">EmojiHubViewModel</span>()\n\n <span class=\"hljs-keyword\">var</span> body: <span class=\"hljs-keyword\">some</span> <span class=\"hljs-type\">View</span> {\n     <span class=\"hljs-type\">Text</span>(<span class=\"hljs-type\">String</span>(<span class=\"hljs-string\">\"EmojiHub\"</span>))\n     <span class=\"hljs-type\">List</span> {\n          <span class=\"hljs-type\">ForEach</span>(iOSEmojiHubViewModel.items, id: \\.<span class=\"hljs-keyword\">self</span>) { item <span class=\"hljs-keyword\">in</span>\n              <span class=\"hljs-type\">Item</span>(emojiItem: item)\n          }\n     }\n  }\n}\n</code></pre>\n<h1>5. 네트워킹</h1>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>Ktor은 마이크로서비스부터 멀티플랫폼 HTTP 클라이언트 앱까지 다양한 용도로 사용됩니다. 이를 사용하려면 build.gradle.kts 파일에 아래와 같이 Ktor 종속성을 추가하면 됩니다.</p>\n<pre><code class=\"hljs language-kotlin\"><span class=\"hljs-keyword\">val</span> ktorVersion = <span class=\"hljs-string\">\"3.4.3\"</span>\n\n<span class=\"hljs-comment\">// shared/build.gradle.kts</span>\nsourceSets {\n\n    <span class=\"hljs-keyword\">val</span> commonMain <span class=\"hljs-keyword\">by</span> getting {\n        dependencies {\n            implementation(<span class=\"hljs-string\">\"io.ktor:ktor-client-core:<span class=\"hljs-variable\">$ktorVersion</span>\"</span>)\n            implementation(<span class=\"hljs-string\">\"io.ktor:ktor-client-logging:<span class=\"hljs-variable\">$ktorVersion</span>\"</span>)\n            implementation(<span class=\"hljs-string\">\"io.ktor:ktor-client-content-negotiation:<span class=\"hljs-variable\">$ktorVersion</span>\"</span>)\n        }\n    }\n\n    <span class=\"hljs-keyword\">val</span> androidMain <span class=\"hljs-keyword\">by</span> getting {\n        dependsOn(commonMain)\n        dependencies {\n            <span class=\"hljs-comment\">// 다른 의존성 추가</span>\n            implementation(<span class=\"hljs-string\">\"io.ktor:ktor-client-okhttp:<span class=\"hljs-variable\">$ktorVersion</span>\"</span>)\n        }\n    }\n\n    <span class=\"hljs-keyword\">val</span> iosMain <span class=\"hljs-keyword\">by</span> getting {\n        dependsOn(commonMain)\n        dependencies {\n            implementation(<span class=\"hljs-string\">\"io.ktor:ktor-client-darwin:<span class=\"hljs-variable\">$ktorVersion</span>\"</span>)\n        }\n    }\n}\n</code></pre>\n<p>공통 모듈인 commonMain에 HttpClient 파일을 아래와 같이 추가하세요:</p>\n<pre><code class=\"hljs language-kotlin\"><span class=\"hljs-keyword\">expect</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">fun</span> <span class=\"hljs-title\">httpClient</span><span class=\"hljs-params\">(config: <span class=\"hljs-type\">HttpClientConfig</span>&#x3C;*>.() -> <span class=\"hljs-type\">Unit</span>)</span></span>: HttpClient\n</code></pre>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>안드로이드 메인에서 실제 키워드를 사용하여 httpClient를 선언하세요:</p>\n<pre><code class=\"hljs language-kotlin\"><span class=\"hljs-keyword\">actual</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">fun</span> <span class=\"hljs-title\">httpClient</span><span class=\"hljs-params\">(config: <span class=\"hljs-type\">HttpClientConfig</span>&#x3C;*>.() -> <span class=\"hljs-type\">Unit</span>)</span></span>: HttpClient = HttpClient(OkHttp) {\n    config()\n}\n</code></pre>\n<p>또한 iOS 메인에서도 실제 키워드를 사용하여 httpClient를 선언하세요:</p>\n<pre><code class=\"hljs language-kotlin\"><span class=\"hljs-keyword\">actual</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">fun</span> <span class=\"hljs-title\">httpClient</span><span class=\"hljs-params\">(config: <span class=\"hljs-type\">HttpClientConfig</span>&#x3C;*>.() -> <span class=\"hljs-type\">Unit</span>)</span></span>: HttpClient = HttpClient(Darwin) {\n    config()\n}\n</code></pre>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>이제 EmojiHubRepository에서 httpClient를 사용하여 원격 서버에서 이모지를 가져오세요.</p>\n<pre><code class=\"hljs language-kotlin\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">EmojiHubRepository</span>(<span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">val</span> httpClient: HttpClient) {\n\n    <span class=\"hljs-keyword\">suspend</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">fun</span> <span class=\"hljs-title\">getEmojis</span><span class=\"hljs-params\">()</span></span>: List&#x3C;EmojiItem> {\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">try</span> {\n            httpClient.<span class=\"hljs-keyword\">get</span>(urlString = <span class=\"hljs-string\">\"/api/all\"</span>).body()\n        } <span class=\"hljs-keyword\">catch</span> (e: Exception) {\n            e.printStackTrace()\n            emptyList()\n        }\n    }\n}\n</code></pre>\n<p>그리고 EmojiHubViewModel에서 EmojiHubRepository를 사용하여 원격 또는 로컬 소스에서 데이터를 가져오세요.</p>\n<pre><code class=\"hljs language-kotlin\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">EmojiHubViewModel</span>(<span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">val</span> repository: EmojiHubRepository) : SharedViewModel() {\n\n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">val</span> _items = MutableStateFlow&#x3C;List&#x3C;EmojiItem>>(listOf())\n\n    <span class=\"hljs-meta\">@NativeCoroutinesState</span>\n    <span class=\"hljs-keyword\">val</span> items = _items.asStateFlow()\n\n    <span class=\"hljs-keyword\">init</span> {\n        sharedViewModelScope.launch {\n            _items.update {\n                repository.getEmojis() <span class=\"hljs-comment\">// 저장소를 통해 데이터 가져오기</span>\n            }\n        }\n    }\n}\n</code></pre>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<h1>6. 아이폰에서의 코루틴</h1>\n<p>프로젝트에 Kotlinx.Serialization을 추가하세요.</p>\n<p>Kotlinx.Serialization은 사용자 정의 타입의 객체를 직렬화하고 역직렬화하는 데 사용됩니다.</p>\n<pre><code class=\"hljs language-js\">val kotlinxSerializationVersion = <span class=\"hljs-string\">\"1.5.1\"</span>\n\n<span class=\"hljs-comment\">// shared/build.gradle.kts</span>\nsourceSets {\n\n    val commonMain by getting {\n        dependencies {\n            <span class=\"hljs-title function_\">implementation</span>(<span class=\"hljs-string\">\"org.jetbrains.kotlinx:kotlinx-serialization-json:$kotlinxSerializationVersion\"</span>)\n            ...\n        }\n    }\n\n    val androidMain by getting {\n        <span class=\"hljs-title function_\">dependsOn</span>(commonMain)\n        dependencies {\n            ...\n        }\n    }\n\n    val iosMain by getting {\n        <span class=\"hljs-title function_\">dependsOn</span>(commonMain)\n        dependencies {\n            ...\n        }\n    }\n}\n</code></pre>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<h2>httpClient 재구성하기</h2>\n<pre><code class=\"hljs language-kotlin\"><span class=\"hljs-comment\">// shared/commonMain/.../EmojiHubRepository</span>\n    <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">EmojiHubRepository</span> {\n        <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">val</span> httpClient = httpClient {\n            ...\n            install(ContentNegotiation) {\n                json(\n                    Json {\n                        ignoreUnknownKeys = <span class=\"hljs-literal\">true</span>\n                    }\n                )\n            }\n        }\n    }\n</code></pre>\n<p>서버에서 데이터를 가져와 Android 앱을 실행합니다.</p>\n<pre><code class=\"hljs language-kotlin\"><span class=\"hljs-keyword\">suspend</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">fun</span> <span class=\"hljs-title\">getEmojis</span><span class=\"hljs-params\">()</span></span>: List&#x3C;EmojiItem> {\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">try</span> {\n            httpClient.<span class=\"hljs-keyword\">get</span>(urlString = <span class=\"hljs-string\">\"/api/all\"</span>).body()\n        } <span class=\"hljs-keyword\">catch</span> (e: Exception) {\n            e.printStackTrace()\n            emptyList()\n        }\n    }\n</code></pre>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<pre><code class=\"hljs language-kotlin\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">EmojiHubViewModel</span>(<span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">val</span> repository: EmojiHubRepository) : SharedViewModel() {\n\n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">val</span> _items = MutableStateFlow&#x3C;List&#x3C;EmojiItem>>(listOf())\n\n    <span class=\"hljs-meta\">@NativeCoroutinesState</span>\n    <span class=\"hljs-keyword\">val</span> items = _items.asStateFlow()\n\n    <span class=\"hljs-keyword\">init</span> {\n        sharedViewModelScope.launch {\n            _items.update {\n                repository.getEmojis()\n            }\n        }\n    }\n}\n</code></pre>\n<p><img src=\"/assets/img/2024-06-19-KotlinMultiPlatformKMP_12.png\" alt=\"Image\"></p>\n<h2>KMP-NativeCoroutines</h2>\n<pre><code class=\"hljs language-kotlin\"><span class=\"hljs-comment\">// commonMain/viewModel/EmojiHubViewModel</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">EmojiHubViewModel</span>(<span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">val</span> repository: EmojiHubRepository) : SharedViewModel() {\n\n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">val</span> _items = MutableStateFlow&#x3C;List&#x3C;EmojiItem>>(listOf())\n\n    <span class=\"hljs-meta\">@NativeCoroutinesState</span>\n    <span class=\"hljs-keyword\">val</span> items = _items.asStateFlow()\n\n    ...\n}\n</code></pre>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>IOSEmojiHubViewModel은 iosApp 모듈에 있어요.</p>\n<img src=\"/assets/img/2024-06-19-KotlinMultiPlatformKMP_13.png\">\n<p>IOSEmojiHubViewModel에서 KMPNativeCoroutinesAsync을 사용하여 데이터를 가져옵니다.</p>\n<pre><code class=\"hljs language-swift\"><span class=\"hljs-meta\">@MainActor</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">IOSEmojiHubViewModel</span>: <span class=\"hljs-title class_\">ObservableObject</span> {\n\n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">let</span> githubViewModel <span class=\"hljs-operator\">=</span> <span class=\"hljs-type\">GithubViewModel</span>()\n\n    <span class=\"hljs-meta\">@Published</span>\n    <span class=\"hljs-keyword\">var</span> items <span class=\"hljs-operator\">=</span> <span class=\"hljs-type\">Array</span>&#x3C;<span class=\"hljs-type\">EmojiItem</span>>()\n\n    <span class=\"hljs-keyword\">var</span> task: <span class=\"hljs-type\">Task</span>&#x3C;(), <span class=\"hljs-type\">Never</span>>? <span class=\"hljs-operator\">=</span> <span class=\"hljs-literal\">nil</span>\n\n    <span class=\"hljs-keyword\">init</span>() {\n        task <span class=\"hljs-operator\">=</span> <span class=\"hljs-type\">Task</span> {\n            <span class=\"hljs-keyword\">do</span> {\n                <span class=\"hljs-keyword\">let</span> asyncItems <span class=\"hljs-operator\">=</span> asyncSequence(for: emojiHubViewModel.itemsFlow)\n                <span class=\"hljs-keyword\">for</span> <span class=\"hljs-keyword\">try</span> <span class=\"hljs-keyword\">await</span> asyncItem <span class=\"hljs-keyword\">in</span> asyncItems {\n                    items <span class=\"hljs-operator\">=</span> asyncItem\n                }\n            } <span class=\"hljs-keyword\">catch</span> {\n                <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">\"Failed with error: <span class=\"hljs-subst\">\\(error)</span>\"</span>)\n            }\n        }\n    }\n\n    <span class=\"hljs-keyword\">func</span> <span class=\"hljs-title function_\">clear</span>() {\n        task<span class=\"hljs-operator\">?</span>.cancel()\n    }\n}\n</code></pre>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<pre><code class=\"hljs language-swift\"><span class=\"hljs-keyword\">struct</span> <span class=\"hljs-title class_\">ContentView</span>: <span class=\"hljs-title class_\">View</span> {\n\n    <span class=\"hljs-meta\">@StateObject</span>\n    <span class=\"hljs-keyword\">var</span> iOSEmojiHubViewModel <span class=\"hljs-operator\">=</span> <span class=\"hljs-type\">IOSEmojiHubViewModel</span>()\n\n    <span class=\"hljs-keyword\">var</span> body: <span class=\"hljs-keyword\">some</span> <span class=\"hljs-type\">View</span> {\n        <span class=\"hljs-type\">Text</span>(<span class=\"hljs-type\">String</span>(<span class=\"hljs-string\">\"EmojiHub\"</span>))\n        <span class=\"hljs-type\">List</span> {\n            <span class=\"hljs-type\">ForEach</span>(iOSEmojiHubViewModel.items, id: \\.<span class=\"hljs-keyword\">self</span>) { item <span class=\"hljs-keyword\">in</span>\n                <span class=\"hljs-type\">Item</span>(emojiItem: item)\n            }\n        }\n    }\n}\n</code></pre>\n<h1>7. 의존성 주입</h1>\n<p>의존성 주입 패턴을 구현하기 위해 프로젝트에 Koin을 추가하세요.</p>\n<pre><code class=\"hljs language-js\">val koinVersion = <span class=\"hljs-string\">\"3.4.3\"</span>\n\n<span class=\"hljs-comment\">// shared/build.gradle.kts</span>\nsourceSets {\n\n    val commonMain by getting {\n        dependencies {\n            <span class=\"hljs-title function_\">implementation</span>(<span class=\"hljs-string\">\"io.insert-koin:koin-core:$koinVersion\"</span>)\n            ...\n        }\n    }\n\n    val androidMain by getting {\n        <span class=\"hljs-title function_\">dependsOn</span>(commonMain)\n        dependencies {\n            <span class=\"hljs-title function_\">implementation</span>(<span class=\"hljs-string\">\"io.insert-koin:koin-android:$koinVersion\"</span>)\n            ...\n        }\n    }\n\n    val iosMain by getting {\n        <span class=\"hljs-title function_\">dependsOn</span>(commonMain)\n        dependencies {\n            ...\n        }\n    }\n}\n</code></pre>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>EmojiHubRepository에 HttpClient을 주입해주세요.</p>\n<pre><code class=\"hljs language-kotlin\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">EmojiHubRepository</span>(<span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">val</span> httpClient: HttpClient) {\n\n    ...\n}\n</code></pre>\n<p>그리고 EmojiHubViewModel에서 EmojiHubRepository를 주입해주세요.</p>\n<pre><code class=\"hljs language-kotlin\"><span class=\"hljs-comment\">// commonMain/viewModel/EmojiHubViewModel</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">EmojiHubViewModel</span>(<span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">val</span> repository: EmojiHubRepository) : SharedViewModel() {\n\n    ...\n}\n</code></pre>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>아래와 같이 의존성을 정의하도록 모듈을 선언해보세요:</p>\n<pre><code class=\"hljs language-kotlin\"><span class=\"hljs-keyword\">val</span> appModule = module {\n    single {\n        httpClient {\n           ...\n        }\n    }\n\n    single {\n        EmojiHubRepository(<span class=\"hljs-keyword\">get</span>())\n    }\n\n    sharedViewModel {\n        EmojiHubViewModel(<span class=\"hljs-keyword\">get</span>())\n    }\n}\n</code></pre>\n<p>프로젝트 애플리케이션 클래스에 Koin을 시작하는 코드를 추가해보세요.</p>\n<pre><code class=\"hljs language-kotlin\"><span class=\"hljs-comment\">//androidApp/MainApplication</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">MainApplication</span> : <span class=\"hljs-type\">Application</span>() {\n\n    <span class=\"hljs-keyword\">override</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">fun</span> <span class=\"hljs-title\">onCreate</span><span class=\"hljs-params\">()</span></span> {\n        <span class=\"hljs-keyword\">super</span>.onCreate()\n\n        startKoin {\n            androidContext(<span class=\"hljs-keyword\">this</span><span class=\"hljs-symbol\">@MainApplication</span>)\n            modules(appModule) <span class=\"hljs-comment\">// 앱 모듈</span>\n        }\n    }\n}\n</code></pre>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>iOSMain 에서 Koin을 시작하려면 아래와 같이 시작하세요.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-comment\">// shared/iosMain/.../KoinStarter.kt</span>\nfun <span class=\"hljs-title function_\">startKoin</span>(<span class=\"hljs-params\"></span>) {\n    startKoin { <span class=\"hljs-title function_\">modules</span>(appModule) }\n}\n</code></pre>\n<img src=\"/assets/img/2024-06-19-KotlinMultiPlatformKMP_14.png\">\n<p>iOSApp에서 startKoin을 호출하세요.</p>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>@ main\n구조체 iOSApp: 앱 {</p>\n<p>init() {\nKoinStarterKt.startKoin()\n}</p>\n<pre><code>var body: some Scene {\n   WindowGroup {\n       ContentView()\n   }\n}\n</code></pre>\n<p>}</p>\n<p>그리고 GithubViewModelHelper은 iOS에서 GithubViewModel을 주입하는 데 사용됩니다.</p>\n<p>class EmojiHubViewModelHelper: KoinComponent {</p>\n<pre><code>private val emojiHubViewModel: EmojiHubViewModel = get()\n\n@NativeCoroutinesState\nval items = emojiHubViewModel.items\n</code></pre>\n<p>}</p>\n<p><img src=\"/assets/img/2024-06-19-KotlinMultiPlatformKMP_15.png\" alt=\"이미지\"></p>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>이제 Android 앱과 iOS 앱을 실행해보세요.</p>\n<p><img src=\"/assets/img/2024-06-19-KotlinMultiPlatformKMP_16.png\" alt=\"Kotlin Multiplatform\"></p>\n<h2>라이브러리 및 도구</h2>\n<ul>\n<li>KMP 플러그인</li>\n<li>Kdoctor</li>\n<li>Ktor</li>\n<li>kotlinx.serialization</li>\n<li>KMP-NativeCoroutines</li>\n<li>Koin</li>\n</ul>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>간단한 KMP(Kotlin Multiplatform)를 사용한 예제 프로젝트입니다.</p>\n<p><a href=\"https://github.com/ZahraHeydari/Kotlin-MultiPlatform-Mobile\" rel=\"nofollow\" target=\"_blank\">여기</a>를 클릭해주세요!</p>\n<p>이 이야기를 읽어 주셔서 감사합니다. 도움이 되셨으면 좋겠어요.</p>\n<p>의견이 있으시면 언제든지 남겨주세요. 감사합니다!</p>\n<!-- ui-station 사각형 -->\n<p><ins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins></p>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>\n<p>코딩을 즐기세요!</p>\n</body>\n</html>\n"},"__N_SSG":true}