---
title: "ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ì€ ì—”ì§€ë‹ˆì–´ë¥¼ ìœ„í•œ ê²ƒì…ë‹ˆë‹¤  ì•„ë‹ˆì—ìš”"
description: ""
coverImage: "/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_0.png"
date: 2024-05-18 18:24
ogImage:
  url: /assets/img/2024-05-18-DataEngineeringisforEngineersNOT_0.png
tag: Tech
originalTitle: "Data Engineering is for Engineers â€” NOT!"
link: "https://medium.com/stackademic/data-engineering-is-for-engineers-not-49fe0dc22497"
---

## ê¸€ì„ ì“°ëŠ” ì‚¬ëŒì´ ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ë„ ë°°ìš¸ ìˆ˜ ìˆì„ ê±°ë¼ê³  ìƒê°í•´ìš”.

"ì´ê²Œ ë¬´ìŠ¨ ì¼ì´ì£ ."

ì²˜ìŒ ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ ì—…ë¬´ë¥¼ ë§¡ì•˜ì„ ë•Œ ë‚˜ëŠ” ì´ë ‡ê²Œ ìƒê°í–ˆì–´ìš”. í•˜ì§€ë§Œ ì–¼ë§ˆ í›„, ìš°ë¦¬ê°€ í•˜ë‚˜ì”© ìœ„í‚¤í”¼ë””ì•„ì—ì„œ ì§‘ì–´ë‚¼ ëª‡ ê°€ì§€ ìˆ«ìë¥¼ ê°€ì ¸ì˜¤ëŠ” ê²ƒì´ ì²« ë²ˆì§¸ ë‹¨ê³„ì˜€ë‹¤ëŠ” ê²ƒì„ ê¹¨ë‹¬ì•˜ì£ .

íŒŒì´ì¬ì—ì„œ ì‘ì—…ì„ í•´ì£¼ì…”ì•¼ê² ë‹¤ê³  ë§ì”€í•˜ì…”ì•¼ í–ˆë˜ ì²« ë²ˆì§¸ ì–´ë ¤ì›€ì´ ìˆì—ˆì–´ìš”! ì¦‰, ë°ì´í„°ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ê°€ì ¸ì˜¤ëŠ” ë‚ ì´ ëë‚¬ë‹¤ëŠ” ê±°ì£ . ì¸ë‚´ì‹¬ì„ ê°€ì§€ê³  ìì‹ ì—ê²Œ ì´ëŸ° ë§ì„ í•´ë³´ì„¸ìš”. ê´œì°®ì•„, ì´ ì¼ ì˜ í•  ìˆ˜ ìˆì–´ìš”!

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

ë¬¸ì œ: ì‚¬íšŒê³¼í•™ ì¡¸ì—…ìƒì´ ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ì„ ëŠ¥ìˆ™í•˜ê²Œ ìˆ˜í–‰í•  ìˆ˜ ìˆì„ê¹Œìš”? ìë™í™”ëœ ë°ì´í„° íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•˜ê³  ì•ˆì „í•˜ê²Œ í´ë¼ìš°ë“œì— ë³´ê´€í•  ìˆ˜ ìˆì„ê¹Œìš”?

ê·€ë¬´ê°€ì„¤: ì—”ì§€ë‹ˆì–´ëŠ” ìƒì—…ìœ¼ë¡œ ê¸€ì„ ì“°ëŠ” ì‚¬ëŒë§Œí¼ ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ ê°€ì„¤ì„ ê¸°ê°í•´ì•¼ í• ê¹Œìš”? ë‚´ ì§ê°ì€ "ì˜ˆ"ë¼ê³  ë§í–ˆìŠµë‹ˆë‹¤. IT ë¹„ì „ë¬¸ê°€ì¸ ë‚˜ ê°™ì€ ì‚¬ëŒì´ ê·¸ë ‡ê²Œ í•  ìˆ˜ëŠ” ì—†ì„ ê²ƒ ê°™ì•„ìš”.

ëŒ€ì•ˆ ê°€ì„¤ì€ ì•„ë§ˆë„ ì´ë ‡ê²Œ í•  ìˆ˜ ìˆì„ ê²ƒ ê°™ì•„ìš”: ìƒì—…ìœ¼ë¡œ ê¸€ì“°ëŠ” ì‚¬ëŒë„ ì—”ì§€ë‹ˆì–´ì²˜ëŸ¼ ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ì„ ë°°ìš¸ ìˆ˜ ìˆë‹¤ë©´ìš”.

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

ì—¬ê¸°ì„œ ì‹œì‘í•´ìš”...

## ìš°ë¦¬ ë¹„ì¦ˆë‹ˆìŠ¤ ì¼€ì´ìŠ¤

ì´ ì‘ì—…ì€ ì£¼ë¡œ ì „ê¸° ì´ë™ì„±ì— ê´€ë ¨ëœ ì‚¬ì—…ì„ í•˜ëŠ” "Gans" íšŒì‚¬ë¥¼ ìœ„í•œ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ìƒì„±í•˜ëŠ” ê²ƒì„ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤. íŠ¹ì • ì‹œê°„ì— ì¶©ë¶„í•œ ì´ë™ì„± ë‹¨ìœ„ë¥¼ ì œê³µí•˜ê¸° ìœ„í•´ ë‚ ì”¨ ìš”ì†Œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìˆ˜ìš”ë¥¼ ì¸¡ì •í•˜ê¸° ìœ„í•œ ë°ì´í„° ê³¼í•™ìë¥¼ í•„ìš”ë¡œ í•©ë‹ˆë‹¤.

íšŒì‚¬ì˜ ì£¼ìš” ì‚¬ì—…ì€ ë…ì¼ì—ì„œ ìŠ¤ì¿ í„°ë¥¼ ëŒ€ì—¬í•˜ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì— ë¹„ê°€ ì˜¤ê±°ë‚˜ ëˆˆì´ ì˜¤ëŠ” ê²½ìš°ì—ëŠ” ì¼ë°˜ì ìœ¼ë¡œ ìˆ˜ìš”ê°€ ì¤„ì–´ë“¤ê²Œ ë©ë‹ˆë‹¤. ë¹„ë‚˜ ëˆˆì´ ì˜ˆë³´ëœ ê²½ìš°, ì„ì‹œ ìˆ˜ìš”ë„ ì¦ê°€í•  ê²ƒì…ë‹ˆë‹¤.

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

ë”°ë¼ì„œ, í˜„ì¬ ê³¼ì œëŠ” ë„ì‹œì™€ ë‚ ì”¨ ì •ë³´ë¡œ ì±„ì›Œì§„ ê°„ë‹¨í•œ SQL ë°ì´í„°ë² ì´ìŠ¤ë¥¼ êµ¬ì¶•í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. íšŒì‚¬ì˜ ìš´ì˜ ë¶€ì„œëŠ” ë§¤ì¼ì´ ì´ ë°ì´í„°ë² ì´ìŠ¤ì— ì•¡ì„¸ìŠ¤í•˜ì—¬ ì´ë™ ê°€ëŠ¥ ì°¨ëŸ‰ì˜ ì§€ë¦¬ì  ê°€ìš©ì„±ì— ê´€í•œ íŒë‹¨ì„ ë‚´ë¦´ ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤.

ë‚˜ì¤‘ì— ë°ì´í„°ë² ì´ìŠ¤ëŠ” ê´€ê´‘ê° ë°©ë¬¸ ì˜ˆìƒ ë“±ì„ ì œê³µí•˜ê¸° ìœ„í•´ ê³µê³µ êµí†µ ë„ì°© ì •ë³´(ì˜ˆ: í•­ê³µí¸, ê¸°ì°¨, ë˜ëŠ” ë²„ìŠ¤ API ì‚¬ìš©)ê°€ í¬í•¨ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë“¤ì€ íšŒì‚¬ì˜ ì ì¬ì  ê³ ê° ì¤‘ ì¼ë¶€ì…ë‹ˆë‹¤.

ë‹¤ìŒì€ ë‚ ì”¨ì™€ í•­ê³µí¸ APIë¥¼ í¬í•¨í•œ ì§€ë„ í”„ë¡œì íŠ¸ì˜ ëª¨ìŠµì…ë‹ˆë‹¤:

<img src="/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_0.png" />

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

ì´ ê¸°ì‚¬ì—ì„œëŠ” ë‚ ì”¨ ë°ì´í„° í†µí•©ë§Œ ë‹¤ë£¨ê³  ë‚˜ì¤‘ì— ì „ì†¡ ë¶€ë¶„ì€ ë‚˜ì¤‘ì— ê°œì„ í•  ê²ƒì…ë‹ˆë‹¤.

ì‹œì‘í•˜ê¸° ì „ì— Pythonì—ì„œ í•„ìš”í•œ ëª¨ë“  ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ê°€ì ¸ì™€ì•¼ í•©ë‹ˆë‹¤:

```python
import pandas as pd
import requests
from bs4 import BeautifulSoup
from datetime import datetime
from pytz import timezone
```

## ì›¹ ìŠ¤í¬ë˜í•‘ 101: HTML ì½”ë“œë¥¼ ê°€ì ¸ì˜¤ëŠ” ë°©ë²•?

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

ë¨¼ì €, ë‹¤ë¥¸ í…Œì´ë¸”ê³¼ ê´€ë ¨í•˜ëŠ” ì£¼ìš” í…Œì´ë¸”ë¡œ ì‘ìš©í•˜ëŠ” ë„ì‹œ ì •ë³´ê°€ í¬í•¨ëœ í…Œì´ë¸”ì„ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤. ì´ í…Œì´ë¸”ì€ ì£¼ê¸°ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•  í•„ìš”ê°€ ì—†ëŠ” ì •ì  í…Œì´ë¸”ì´ ë  ê²ƒì…ë‹ˆë‹¤. ì´ í…Œì´ë¸”ì„ "cities_info"ë¼ê³  ë¶€ë¥¼ ê²ƒì…ë‹ˆë‹¤.

ê° ë„ì‹œì— ëŒ€í•´ ê³ ìœ í•œ ë„ì‹œ ID, ë„ì‹œ ì´ë¦„, ë…ì¼ì˜ ì†Œì† ì£¼(State), ìœ„ë„ ë° ê²½ë„ê°€ í¬í•¨ëœ 5ê°œ ì—´ì´ ìˆì„ ê²ƒì…ë‹ˆë‹¤. ê° ë„ì‹œì— ëŒ€í•œ ì´ ì •ë³´ëŠ” ì˜ì–´ ìœ„í‚¤í”¼ë””ì•„ ì‚¬ì´íŠ¸ì—ì„œ ìŠ¤í¬ë˜í•‘í•˜ì—¬ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆì‚°ì´ í—ˆìš©í•œë‹¤ë©´, ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ì™€ ë°©ë²•ë¡ ì  ì •ë³´ê°€ í¬í•¨ëœ ë„ì‹œì˜ APIë¥¼ êµ¬ë§¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ í”„ë¡œì íŠ¸ì—ì„œëŠ” ìœ„í‚¤í”¼ë””ì•„ë¥¼ ì‚¬ìš©í•˜ì—¬ ìŠ¤í¬ë˜í•‘ ê¸°ìˆ ì„ ì—°ìŠµí•  ê²ƒì…ë‹ˆë‹¤.

ì²˜ìŒì—ëŠ” ê° ì›¹ì‚¬ì´íŠ¸ë§ˆë‹¤ HTML ì½”ë“œë¥¼ ìˆ˜ë™ìœ¼ë¡œ ë‚´ë³´ë‚´ê³  Vs Codeì— ë³µì‚¬í•´ì•¼ í•œë‹¤ëŠ” ìƒê°ì´ ì••ë„ì ì´ì—ˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ë‹¤í–‰íˆ íŒŒì´ì¬ì˜ "requests" ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ë©´ ìë™ìœ¼ë¡œ ìˆ˜í–‰í•  ìˆ˜ ìˆìŒì„ ì•Œê²Œ ë˜ì–´ ì•ˆë„í–ˆìŠµë‹ˆë‹¤:

```js
import requests
berlin_url = "https://en.wikipedia.org/wiki/Berlin"
berlin_response = requests.get(berlin_url)
berlin_soup = BeautifulSoup(berlin_response.content, 'html.parser')
print(berlin_soup.prettify)
```

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

íŒŒì´ì¬: 1 - ë‚˜: 0

## ë£¨í”„ì™€ í•¨ìˆ˜

ì´í„°ë ˆì´ì…˜ì˜ ì„±ë°°ì…ë‹ˆë‹¤. ì´ë“¤ ì—†ì´ëŠ” ë™ì¼í•œ ì½”ë“œë¥¼ ì¬ìƒì‚°í•˜ê³  ë‹¤ë¥¸ URLì— ë™ì‹œì— ì ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì´ê²ƒì´ ì›¹ ìŠ¤í¬ë ˆì´í•‘ì„ ìë™í™”í•˜ëŠ” ì—´ì‡ ì…ë‹ˆë‹¤.

ì—¬ê¸°ì—ëŠ” ê° ìœ„í‚¤í”¼ë””ì•„ ì‚¬ì´íŠ¸ì˜ HTML ì½”ë“œë¥¼ ê²€ìƒ‰í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•œ ë£¨í”„ì˜ ì˜ˆì‹œê°€ ìˆìŠµë‹ˆë‹¤:

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

```js
cities_list = ["Berlin", "Hamburg", "Munich", "Cologne", "Frankfurt"]

for city in cities_list:
  url = f"https://www.wikipedia.org/wiki/{city}"   # urlì„ f ë¬¸ìì—´ë¡œ ë³€í™˜í•˜ì—¬ ë„ì‹œë¥¼ ë³€ìˆ˜ë¡œ ë„£ì–´ í•´ë‹¹ ë„ì‹œì—ì„œ ë‹¤ë¥¸ ë„ì‹œë¡œ ë³€ê²½ë¨
  response = requests.get(url)          # ìœ„í‚¤ë°±ê³¼ í˜ì´ì§€ì˜ ëª¨ë“  ë‚´ìš©ì„ ê°€ì ¸ì™€ responseì— ì €ì¥
  city_soup = BeautifulSoup(response.content, 'html.parser')
```

ì§€ê¸ˆì€ í•¨ìˆ˜ê°€ ë¬´ì„œì›Œì„œ ìµœëŒ€í•œ í”¼í•˜ê³  ìˆì–´ìš” ğŸ˜…

íŒŒì´ì¬: 1,000 â€” ë‚˜: 0

## HTMLì—ì„œ ë¬´ì—‡ì„ ì ‘ê·¼í•˜ë‚˜ìš”?

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

HTMLì—ì„œ "p íƒœê·¸"ë¼ëŠ” ê²ƒì´ ìˆì–´ìš”. ì´ë¥¼ ì•¡ì„¸ìŠ¤í•˜ëŠ” ë° ìœ ìš©í•©ë‹ˆë‹¤. ë‹¤ìŒ ì½”ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ê·¸ë ‡ê²Œ í•  ìˆ˜ ìˆì–´ìš”:

```js
print(soup.p)   # ì²« ë²ˆì§¸ p íƒœê·¸ ìì²´ì— ì ‘ê·¼
print(soup.p.string)  # ì²« ë²ˆì§¸ p íƒœê·¸ì™€ ê´€ë ¨ëœ ë¬¸ìì—´ì— ì ‘ê·¼
```

```js
for child in soup.div:  # 1ë²ˆì§¸ divì—ì„œ ê° ìì‹ì„ ì°¾ì•„ì„œ ì¸ì‡„í•˜ëŠ” ì˜ˆì œ
    print(child)
```

## Pythonì—ì„œ ë°ì´í„°í”„ë ˆì„ ë° SQLì—ì„œ í•´ë‹¹ í…Œì´ë¸” ë§Œë“¤ê¸°

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

HTML ë° ì›¹ ìŠ¤í¬ë˜í•‘ ê¸°ìˆ ì„ ì—°ë§ˆí•œ í›„, ì²« ë‘ í…Œì´ë¸”ì— í•„ìš”í•œ ëª¨ë“  ì •ë³´ë¥¼ ì–»ê¸° ìœ„í•´ ì´ ë£¨í”„ë¥¼ ë§Œë“¤ì—ˆì–´ìš”.

ì²« ë²ˆì§¸ ë°ì´í„°í”„ë ˆì„ì€ ì •ì  ì¸ë±ìŠ¤ë¡œ ì‘ë™í•  ê²ƒì´ê³  (ì¦‰, ì •ë³´ë¥¼ ì •ê¸°ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•  í•„ìš”ê°€ ì—†ì–´ìš”): cities_info

```js
cities_list = ["ë² ë¥¼ë¦°", "í•¨ë¶€ë¥´í¬", "ë®Œí—¨", "ì¾°ë¥¸", "í”„ë‘í¬í‘¸ë¥´íŠ¸"]
states = []
latitudes = []
longitudes = []

for city in cities_list:
  url = f"https://www.wikipedia.org/wiki/{city}"
  city_soup = BeautifulSoup(response.content, 'html.parser')    # (ìœ„í‚¤ë°±ê³¼ ì‚¬ì´íŠ¸ì˜ ë‚´ìš©ì„ city_soup ë³€ìˆ˜ì— ì €ì¥í•˜ëŠ”) ë‚´ìš©ì„ êµ¬ë¬¸ ë¶„ì„í•©ë‹ˆë‹¤.

  # ë„ì‹œê°€ ì†í•œ ì£¼ë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤
  if city not in ["í•¨ë¶€ë¥´í¬", "ë² ë¥¼ë¦°"]:         # ë² ë¥¼ë¦°ì˜ ê²½ìš° ì¼ë°˜ì ì¸ .find ê³µì‹ë„ ì‘ë™í•  ê±°ì˜ˆìš”! ì£¼ ì„¹ì…˜ì´ ì—†ëŠ” "í•¨ë¶€ë¥´í¬"ë§Œì´ ì˜ˆì™¸ì—ìš”
    city_state = city_soup.find("table", class_="vcard").find(string="ì£¼").find_next("td").get_text()  # ë‹¤ë¥¸ ì£¼ ì´ë¦„ì„ ê°€ì§„ ë„ì‹œì— ëŒ€í•œ ì£¼ë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤
  else:
    city_state = city     # í•¨ë¶€ë¥´í¬ì™€ ë² ë¥¼ë¦°ì˜ ê²½ìš°, ë™ëª…ì˜ ë„ì‹œ ì´ë¦„ì„ ê°€ì ¸ì˜¬ ê±°ì˜ˆìš”
  states.append(city_state)

  # ê° ë„ì‹œì˜ ìœ„ë„ë¥¼ ê²€ìƒ‰í•˜ì—¬ ìœ„ë„ ì—´ì— ì¶”ê°€í•©ë‹ˆë‹¤
  city_latitude = city_soup.find(class_="latitude").get_text()
  latitudes.append(city_latitude)

   # ê° ë„ì‹œì˜ ê²½ë„ë¥¼ ê²€ìƒ‰í•˜ì—¬ ê²½ë„ ì—´ì— ì¶”ê°€í•©ë‹ˆë‹¤
  city_longitude = city_soup.find(class_="longitude").get_text()
  longitudes.append(city_longitude)

cities_info_non_rel = pd.DataFrame({         # ì´ê²ƒì´ cities_info ë°ì´í„°í”„ë ˆì„ì´ì—ìš”
    "ë„ì‹œ ì´ë¦„": cities_list,
    "ë…ì¼ ì£¼": states,
    "ìœ„ë„": latitudes,
    "ê²½ë„": longitudes
})

display(cities_info_non_rel)    # í‘œì‹œí•˜ë©´ í…Œì´ë¸”ì´ ë” ì˜ˆì˜ê²Œ ë³´ì—¬ìš”
```

ë˜í•œ, ì—°ê°„ í•œ ë²ˆì”© ì—…ë°ì´íŠ¸ë  ê²ƒìœ¼ë¡œ ì˜ˆìƒë˜ëŠ” ì¸êµ¬ ë°ì´í„°ë¥¼ í¬í•¨í•˜ëŠ” ë‘ ë²ˆì§¸ ë°ì´í„°í”„ë ˆì„ë„ ìƒì„±í–ˆì–´ìš”: cities_population

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

```sql
/***************************
í™˜ê²½ ì„¤ì •
***************************/

-- ë°ì´í„°ë² ì´ìŠ¤ê°€ ì´ë¯¸ ìˆëŠ” ê²½ìš° ì‚­ì œ
DROP DATABASE IF EXISTS gans;

-- ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±
CREATE DATABASE gans;

-- ë°ì´í„°ë² ì´ìŠ¤ ì‚¬ìš©
USE gans;


/***************************
ì²« ë²ˆì§¸ í…Œì´ë¸” ìƒì„±
***************************/

-- 'cities_info' í…Œì´ë¸” ìƒì„±
CREATE TABLE cities_info (
    cities_id INT AUTO_INCREMENT, -- ë„ì‹œë§ˆë‹¤ ìë™ìœ¼ë¡œ ìƒì„±ëœ ID
    city_name VARCHAR(255) NOT NULL, -- ë„ì‹œ ì´ë¦„
    german_state VARCHAR(255) NOT NULL, -- ì£¼ ì´ë¦„
    latitude VARCHAR(255) NOT NULL, -- ìœ„ë„ ì¢Œí‘œ
    longitude VARCHAR(255) NOT NULL, -- ê²½ë„ ì¢Œí‘œ
    PRIMARY KEY (cities_id) -- ê° ë„ì‹œë¥¼ ê³ ìœ í•˜ê²Œ ì‹ë³„í•˜ê¸° ìœ„í•œ ê¸°ë³¸ í‚¤
    );


/***************************
ë‘ ë²ˆì§¸ í…Œì´ë¸” ìƒì„±
***************************/

CREATE TABLE cities_population (
    cities_id INT,
    population INT, -- ì¸êµ¬ìˆ˜
    year_data_retrieved INT, -- ì¸êµ¬ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•œ í•´ë‹¹ ë…„ë„
    FOREIGN KEY (cities_id) REFERENCES cities_info(cities_id)
);
```

ì´ì œ Pythonì—ì„œ ë°ì´í„°ë¥¼ ì²« ë²ˆì§¸ SQL í…Œì´ë¸”ë¡œ ì „ì†¡í•©ë‹ˆë‹¤:

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

```js
schema = "gans"     # ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„
host = "xxx.x.x.x"
user = "root"               # ì‚¬ìš©ì ì´ë¦„
password = "xxxx"           # SQL ì•”í˜¸ ì§ì ‘ ì§€ì • ë˜ëŠ” ë‹¤ë¥¸ ë…¸íŠ¸ë¶ì—ì„œ ê°€ì ¸ì˜¤ê¸° ("from xxxfile import my_password")
port = 3306

connection_string = f'mysql+pymysql://{user}:{password}@{host}:{port}/{schema}'
# ì´ê±´ íŒŒì´ì¬ ë…¸íŠ¸ë¶ì„ SQL Workbenchì— ì—°ê²°í•˜ëŠ” ë°©ë²•ì´ì—ìš”
```

```js
cities_info_non_rel.to_sql('cities_info',   # íŒŒì´ì¬ì—ì„œ SQLë¡œ ë°ì´í„°ë¥¼ ë³´ë‚´ëŠ” ë°©ë²•
                  if_exists='append',       # ë®ì–´ì“°ì§€ ì•Šê³  ê¸°ì¡´ ë°ì´í„°ì— ì¶”ê°€í•˜ê¸° ìœ„í•¨
                  con=connection_string,    # SQL Workbenchì— ì—°ê²°í•  ë•Œ í•„ìš”í•œ ì¸ì
                  index=False)
```

ì²« ë²ˆì§¸ ì‹œë„ëŠ” ë¡œì»¬ì—ì„œ ì´ë£¨ì–´ì¡ŒìŠµë‹ˆë‹¤. ë‚˜ì¤‘ì— Google Cloud Platform ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì¶”ê°€í•˜ë©´ "host" í•„ë“œë¥¼ í¸ì§‘í•˜ì—¬ ì´ ë°ì´í„°ë¥¼ í´ë¼ìš°ë“œì— ì§ì ‘ ì „ì†¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

SQLì— ì²« ë²ˆì§¸ í…Œì´ë¸”ì´ ìƒì„±ë˜ë©´ cities_infoì— í¬í•¨ëœ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•˜ì—¬ ë‘ ë²ˆì§¸ cities_population ë°ì´í„° í”„ë ˆì„ì—ì„œ í•´ë‹¹ cities_id ì—´ì„ ì¸ë±ìŠ¤ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

```js
cities_info = pd.read_sql("cities_info", con=connection_string)   # ì´ ì½”ë“œëŠ” SQLì— ì €ì¥ëœ ì •ë³´ë¥¼ "ì½ì–´ì˜µë‹ˆë‹¤"
cities_info
```

ë‹¤ìŒì€ cities_infoì˜ ëª¨ìŠµì…ë‹ˆë‹¤:

<img src="/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_1.png" />

ë‘ ë²ˆì§¸ ë°ì´í„°í”„ë ˆì„ì˜ ë‚´ìš©ì„ SQLë¡œ ë„£ê¸° ì „ì—, ìƒˆë¡œ ìƒì„±ëœ cities_id ì—´ì„ ì‚¬ìš©í•˜ì—¬ cities_populations ë°ì´í„°í”„ë ˆì„ì— ì¶”ê°€í•´ì•¼ í•©ë‹ˆë‹¤.

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

ì•„ë˜ëŠ” ì¹¼ëŸ¼ ìˆœì„œë¥¼ ì¬ì¡°ì •í•˜ê³ , ì´ì œ cities_populations ë°ì´í„°í”„ë ˆì„ì— cities_id ì¹¼ëŸ¼ì´ ìˆê¸° ë•Œë¬¸ì— ë” ì´ìƒ city_name ì¹¼ëŸ¼ì´ í•„ìš”í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì‚­ì œí–ˆìŠµë‹ˆë‹¤:

```js
# ë‹¤ë¥¸ ì¸êµ¬ ë°ì´í„°í”„ë ˆì„ì— cities_id ì¹¼ëŸ¼ì„ ì¶”ê°€í•©ë‹ˆë‹¤
cities_population["cities_id"] = cities_info_non_rel["cities_id"]
cities_population

# city_name ì¹¼ëŸ¼ì€ ë” ì´ìƒ í•„ìš”í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ì‚­ì œí•˜ê³  ì¹¼ëŸ¼ ìˆœì„œë¥¼ ë°”ê¿” ë” ì§ê´€ì ìœ¼ë¡œ ë§Œë“­ë‹ˆë‹¤
cities_population = cities_population[["cities_id", "population", "year_data_retrieved"]]
cities_population
```

ê·¸ë¦¬ê³  ì œ ë‘ ë²ˆì§¸ ë°ì´í„°í”„ë ˆì„ì´ ìˆìŠµë‹ˆë‹¤. ì´ ë°ì´í„°í”„ë ˆì„ì€ ì¼ë¶€ ë™ì ì…ë‹ˆë‹¤(ë°ì´í„°ê°€ ë•Œë•Œë¡œ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤. ì˜ˆ: ì—°ê°„ í•œ ë²ˆ):

![ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ì€ ì—”ì§€ë‹ˆì–´ë¥¼ ìœ„í•œ ê²ƒ](/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_2.png)

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

ë‹¹ë¶„ê°„ì€, ë‹¤ìŒ í•´ê¹Œì§€ ì—…ë°ì´íŠ¸ë˜ì§€ ì•Šì„ ë™ì ì´ ì•„ë‹Œ cities_population í…Œì´ë¸”ë¡œ ê°„ì£¼í•˜ê² ìŠµë‹ˆë‹¤.

ì´ì œ ìš°ë¦¬ëŠ” ë¡œì»¬ SQL ì¸ìŠ¤í„´ìŠ¤ë¡œ ë‚´ìš©ì„ í‘¸ì‹œí•  ì¤€ë¹„ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤:

```js
# ë‘ ë²ˆì§¸ í…Œì´ë¸” ë‚´ìš©ì„ SQLë¡œ í‘¸ì‹œí•©ë‹ˆë‹¤
cities_population.to_sql('cities_population',   # ì´ë ‡ê²Œ í•˜ë©´ Pythonì—ì„œ SQLë¡œ í‘¸ì‹œí•©ë‹ˆë‹¤
                  if_exists='append',       # ë®ì–´ì“°ê¸°ë¥¼ ì›í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ, ê¸°ì¡´ ë°ì´í„°ì—ë§Œ ë°ì´í„°ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤
                  con=connection_string,    # conì€ sql workbenchì— ì—°ê²°í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ì¸ìì…ë‹ˆë‹¤
                  index=False)
```

SQLì—ì„œ ëª¨ë“  ê²ƒì„ ì‹¤í–‰í•˜ê³  "ì—­ê³µí•™" ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë©´, ìš°ë¦¬ì˜ ìŠ¤í‚¤ë§ˆì˜ ê°€ì¥ ì´ˆê¸° ë²„ì „ì„ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<img src="/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_3.png" />

ìš°ë¦¬ëŠ” í•™ìŠµ ê³¡ì„  ì†ìœ¼ë¡œ ë” ê¹Šì´ íŒŒê³ ë“¤ê³  ìˆì–´ìš”.

ë‹¤ìŒ ë‹¨ê³„: APIë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— í†µí•©í•˜ê¸°. ì§€êµ¬ìƒì˜ ëª¨ë“  ë°ì´í„° ê³¼í•™ìì˜ ë³¸ì§ˆì´ë¼ê³  í•  ìˆ˜ ìˆì£ .

AIê°€ ë”°ë¼ì¡ê¸° ì „ì— ì–´ë–»ê²Œ í•´ì•¼ í• ì§€ ë°°ì›Œì•¼ê² ë„¤ìš”! (ë˜ëŠ” ì™¸ê³„ì¸ì´ ê·¸ë“¤ì˜ ë°ì´í„° ìš”êµ¬ë¥¼ ì–´ë–»ê²Œ ì²˜ë¦¬í•˜ëŠ”ì§€ë¥¼ ë³´ì¼ ë•Œê¹Œì§€) ğŸ‘½

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

## ë‚ ì”¨ API ì‚¬ìš©í•˜ê¸°

ì´ í”„ë¡œì íŠ¸ì˜ ì„¸ ë²ˆì§¸ í° ë‹¨ê³„ëŠ” í˜„ì¬ ì¡´ì¬í•˜ëŠ” ë°ì´í„° ì €ì¥ì†Œì—ì„œ ë‚ ì”¨ ë°ì´í„°ë¥¼ ì¶”ì¶œí•˜ê³  SQL ë°ì´í„°ë² ì´ìŠ¤ì— í†µí•©í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ëŸ¬í•œ ì €ì¥ì†Œë“¤ì€ APIë¥¼ í†µí•´ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. APIëŠ” Application Programming Interfaceì˜ ì•½ìë¡œ, ì„œë¡œ ë‹¤ë¥¸ ì†Œí”„íŠ¸ì›¨ì–´ ì‘ìš© í”„ë¡œê·¸ë¨ ê°„ì— í†µì‹ í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê·œì¹™ê³¼ í”„ë¡œí† ì½œì˜ ì§‘í•©ì…ë‹ˆë‹¤.

ì´ë¥¼ ìœ„í•´ ìš°ë¦¬ëŠ” openweathermap.org ì›¹ì‚¬ì´íŠ¸ë¥¼ ì‚¬ìš©í•  ê²ƒì…ë‹ˆë‹¤. ì´ ì‚¬ì´íŠ¸ë¥¼ í†µí•´ ì „ ì„¸ê³„ ì–´ëŠ ìœ„ì¹˜ì˜ ë¬´ë£Œ ë‚ ì”¨ ì˜ˆë³´ì—ë„ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìš°ë¦¬ëŠ” 5ì¼ ë‚ ì”¨ ì˜ˆë³´ APIë¥¼ ì‚¬ìš©í•  ê²ƒì´ë©°, 3ì‹œê°„ ê°„ê²©ì˜ ì˜ˆë³´ ë°ì´í„°ë¥¼ í¬í•¨í•©ë‹ˆë‹¤: [https://openweathermap.org/forecast5](https://openweathermap.org/forecast5)

ì´ì œ ìš°ë¦¬ í”„ë¡œì íŠ¸ì˜ í•µì‹¬ ì‘ì—…ì— ì§ë©´í–ˆìŠµë‹ˆë‹¤: ìš°ë¦¬ê°€ ì›í•˜ëŠ” ë‚ ì”¨ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•˜ê³  SQL ë°ì´í„°ë² ì´ìŠ¤ë¡œ ì „ì†¡í•˜ê¸° ìœ„í•œ í•„ìš”í•œ ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ìˆ˜ì‹­ ì‹œê°„ ë™ì•ˆ ê³ êµ°ë¶„íˆ¬í•œ ê²°ê³¼, ê°€ì¥ ê´€ë ¨ì„± ìˆëŠ” ë‚ ì”¨ ë°ì´í„°ë¥¼ ì¶”ì¶œí•˜ê¸° ìœ„í•œ ì´ ì½”ë“œë¥¼ ê°œë°œí•´ëƒˆìŠµë‹ˆë‹¤:

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

```js
def get_weather_data(cities):
  # í´ë¼ìš°ë“œì—ì„œ ì‘ì—…í•  ì˜ˆì •ì´ë¯€ë¡œ ì»´í“¨í„°ëŠ” ì–´ë””ì— ìˆì„ì§€ ëª¨ë¦…ë‹ˆë‹¤ - ì»´í“¨í„° ì‹œê°„ëŒ€ë¥¼ ìš°ë¦¬ ì§€ì—­ ì‹œê°„ëŒ€ë¡œ ìˆ˜ì •í•©ì‹œë‹¤.
  berlin_timezone = timezone("Europe/Berlin")
  API_key = "7e5623c79f102b6c08b15c8hjib4cc9l"    # ì´ê²ƒì€ ì‹¤ì œ ê°’ì´ ì•„ë‹™ë‹ˆë‹¤.
  weather_items = []

  for city in cities:
    url = (f"http://api.openweathermap.org/data/2.5/forecast?q={city}&appid={API_key}&units=metric")
    response = requests.get(url)
    json = response.json()

    # ì˜ˆë³´ë¥¼ ì‘ì„±í•œ ì‹œê°„ì„ ì•Œê¸° ìœ„í•´ ê²€ìƒ‰ ì‹œê°„ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.
    retrieval_time = datetime.now(berlin_timezone).strftime("%Y-%m-%d %H:%M:%S")

    # ì´ì œ ìš°ë¦¬ì˜ ê´€ë ¨ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ, ë„ì‹œëŠ” ë„ì‹œ ì´ë¦„ì´ ì•„ë‹Œ ë„ì‹œ IDë¥¼ ë°˜ì˜í•´ì•¼ í•©ë‹ˆë‹¤.
    city_id = cities_info.loc[cities_info["city_name"] == city, "city_id"].values[0]  # ì—¬ê¸°ì—ì„œ ê°’ë“¤ì„ ê²€ìƒ‰í•´ì•¼ í•˜ë©°, ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ì‹œë¦¬ì¦ˆë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.

    for item in json["list"]:
        weather_item = {
            # ì—¬ëŸ¬ ë„ì‹œë¥¼ ê³ ë ¤í•  ë•Œ ì •ë³´ë¥¼ ëª…í™•íˆ ì•Œ ìˆ˜ ìˆê²Œ ë„ì‹œ ì´ë¦„ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.
            "city_id": city_id,
            "forecast_time": item.get("dt_txt", None),
            "temperature": item["main"].get("temp", None),
            "feels_like": item["main"].get("feels_like", None),
            "forecast": item["weather"][0].get("main", None),
            "humidity": item["main"].get("humidity", None),
            "rain_in_last_3h": item.get("rain", {}).get("3h", 0),
            "risk_of_rain": item["pop"],
            "snow_in_last_3h": item.get("snow", {}).get("3h", 0),
            "wind_speed": item["wind"].get("speed", None),
            "data_retrieved_at": retrieval_time
        }

        weather_items.append(weather_item)

  weather_df = pd.DataFrame(weather_items)
  weather_df["forecast_time"] = pd.to_datetime(weather_df["forecast_time"])
  weather_df["data_retrieved_at"] = pd.to_datetime(weather_df["data_retrieved_at"])
  weather_df["snow_in_last_3h"] = pd.to_numeric(weather_df["snow_in_last_3h"], downcast="float.")

  return weather_df

weather_df = get_weather_data(["Berlin", "Hamburg", "Munich", "Cologne", "Frankfurt"])
weather_df     # í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒˆë¡œìš´ ë°ì´í„°í”„ë ˆì„ ìƒì„±
```

ë‚ ì”¨ ë°ì´í„°í”„ë ˆì„ ë° í…Œì´ë¸”ì˜ ì¤‘ìš” ê¸°ëŠ¥ ì¤‘ í•˜ë‚˜ëŠ” ë°ì´í„° ê²€ìƒ‰ ì‹œê°„ì„ ê¸°ë¡í•˜ëŠ” ì—´ì„ í¬í•¨í•´ì•¼ í•œë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ í•„í„°ë§ ë° ì¼ì •í•œ ê¸°ê°„ í›„ ìë™ìœ¼ë¡œ ì´ì „ ë°ì´í„°ê°€ ì‚­ì œë˜ë„ë¡ SQLì—ì„œ í”„ë¡œì‹œì €ë‚˜ í•¨ìˆ˜ë¥¼ ì‘ì„±í•˜ê±°ë‚˜ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ë°ì´í„° ì¼ê´€ì„± ëª©ì ìœ¼ë¡œ ë‚ ì”¨ì™€ ë°ì´í„° ê²€ìƒ‰ ì‹œê°„ì´ í•­ìƒ ì˜ˆë³´ì— ëŒ€í•œ ë‚ ì§œ/ì‹œê°„ê³¼ ë‹¤ë¥¸ ê²ƒì„ì„ í•­ìƒ ì¸ì‹í•  ìˆ˜ ìˆë„ë¡ í•˜ê¸° ìœ„í•œ ê²ƒì…ë‹ˆë‹¤.

ì´ê²ƒì´ Pythonì—ì„œ ìƒˆë¡œìš´ ë‚ ì”¨ ë°ì´í„°í”„ë ˆì„ì´ ë³´ì´ëŠ” ë°©ì‹ì…ë‹ˆë‹¤:

<img src="/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_4.png" />

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

ì¼ë‹¨ ë‚ ì”¨ ë°ì´í„°í”„ë ˆì„ êµ¬ì¡°ë¥¼ ê°€ì§€ê³  ìˆì—ˆì„ ë•Œ, SQLì—ì„œ ë‚ ì”¨ í…Œì´ë¸”ì„ ìƒì„±í•˜ëŠ” ì‘ì—…ì„ ì‹œì‘í–ˆìŠµë‹ˆë‹¤:

```js
/***************************
ë‚ ì”¨ í…Œì´ë¸”ì„ ìƒì„±í•©ë‹ˆë‹¤
***************************/

CREATE TABLE weather (
    city_id INT,
    forecast_time datetime,
    temperature float,
    feels_like float,
    forecast VARCHAR(255) NOT NULL,
    humidity INT,
    rain_in_last_3h FLOAT,
    risk_of_rain FLOAT,
    snow_in_last_3h FLOAT,
    wind_speed FLOAT,
    data_retrieved_at DATETIME,
    FOREIGN KEY (city_id) REFERENCES cities_info(city_id)
    );

-- TRUNCATE TABLE weather;   -- í…Œì´ë¸”ì´ ë„ˆë¬´ ì»¤ì§€ê³  ë°ì´í„°ê°€ ì˜¤ë˜ë˜ì—ˆì„ ë•Œ ëª¨ë“  í–‰ì„ ì§€ì›Œì•¼ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤
```

ì´ê²ƒì€ ì—”ì§€ë‹ˆì–´ë§ì„ í†µí•´ ì—­ ê³µí•™ì„ ê±°ì³ ì—…ë°ì´íŠ¸ëœ SQL ìŠ¤í‚¤ë§ˆì…ë‹ˆë‹¤:

<img src="/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_5.png" />

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

## ì§€ì—­ì—ì„œ ì „ì—­ìœ¼ë¡œ

ìš°ë¦¬ì˜ ì½”ë“œë¥¼ í´ë¼ìš°ë“œì— ì˜¬ë¦¬ê¸° ì „ì—, ë‚ ì”¨ ë°ì´í„° ê²€ìƒ‰ ì½”ë“œê°€ ë¡œì»¬ì—ì„œ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤. Pythonìœ¼ë¡œ ì½”ë“œë¥¼ ì‘ì„±í•œ í›„, ë¡œì»¬ SQL ì¸ìŠ¤í„´ìŠ¤ë¡œ ì „ì†¡í•´ë³´ê² ìŠµë‹ˆë‹¤:

```python
weather_df.to_sql("weather",
                  if_exists='append',
                  con=connection_string,
                  index=False)
```

ë§Œì•½ ìƒˆ ë°ì´í„°ê°€ ìš°ë¦¬ì˜ SQL í…Œì´ë¸”ì— ì¶”ê°€ëœë‹¤ë©´, ì‘ë™í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤!

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

íŒŒì´ì¬ì„ í†µí•´ ë¡œì»¬ ë°ì´í„°ë¥¼ ì…ë ¥í•œ í›„ SQL ë‚ ì”¨ í…Œì´ë¸”ì´ ì–´ë–»ê²Œ ë³´ì´ëŠ”ì§€ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

![Weather Table](/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_6.png)

## Google Cloud Platform í†µí•©

ë¡œì»¬ì—ì„œ ì½”ë“œê°€ ì‘ë™í•˜ëŠ” ê²ƒì„ í™•ì¸í•˜ë©´, ì´ì œ í´ë¼ìš°ë“œì— ì˜¬ë ¤ë³´ëŠ” ì‹œê°„ì…ë‹ˆë‹¤.

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

êµ¬ê¸€ í´ë¼ìš°ë“œ í”Œë«í¼(GCP) ê³„ì •ì„ ì—´ê³  í´ë¼ìš°ë“œ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” ìì„¸íˆ ë‹¤ë£¨ì§€ëŠ” ì•Šê² ì§€ë§Œ MySQLì„ ì‚¬ìš©í•œ ì¢‹ì€ ë‹¨ê³„ë³„ ì„¤ëª…ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤: https://support.google.com/appsheet/answer/10107301?hl=en

ì œê²Œ ê°€ì¥ ì¤‘ìš”í•œ ë‹¨ê³„ ì¤‘ í•˜ë‚˜ëŠ” íŒŒì´ì¬ ë…¸íŠ¸ë¶ì—ì„œ ë¡œì»¬ IP í˜¸ìŠ¤íŠ¸ë¥¼ êµ¬ê¸€ IP í˜¸ìŠ¤íŠ¸ë¡œ ë³€ê²½í•˜ëŠ” ê²ƒì´ì—ˆìŠµë‹ˆë‹¤. êµ¬ì²´ì ìœ¼ë¡œ, ë°ì´í„°ë¥¼ SQLë¡œ ì „ì†¡í•˜ëŠ” ì½”ë“œ ë¸”ë¡ì—ì„œ ë³€ê²½í–ˆìŠµë‹ˆë‹¤:

```js
schema = "gans"         # ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„
host = "XX.XXX.XX.XX"   # ë¡œì»¬ í˜¸ìŠ¤íŠ¸:"xxx.x.x.x" (í´ë¼ìš°ë“œë¡œ ë³€ê²½í•˜ê¸° ì „)
user = "root"           # ì‚¬ìš©ì ì´ë¦„ (ê°€ì´ë“œ ì°¸ì¡°)
password = "XXXX"       # ë¹„ë°€ë²ˆí˜¸ ì§ì ‘ ì…ë ¥í•˜ê±°ë‚˜ ë‹¤ë¥¸ ë…¸íŠ¸ë¶ì—ì„œ ê°€ì ¸ì˜µë‹ˆë‹¤ ("from xxxfile import my_password")
port = 3306

connection_string = f'mysql+pymysql://{user}:{password}@{host}:{port}/{schema}'     # ì´ ë¶€ë¶„ì´ íŒŒì´ì¬ ë…¸íŠ¸ë¶ì„ SQL ì›Œí¬ë²¤ì¹˜ì— ì—°ê²°í•˜ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤
```

ì´ë ‡ê²Œ í•¨ìœ¼ë¡œì¨, ì´ì „ì— ìƒì„±í•œ ì •ì  í…Œì´ë¸”ì„ í´ë¼ìš°ë“œì— ìë™ìœ¼ë¡œ ì—…ë¡œë“œí•˜ê³  íŒŒì´ì¬ì—ì„œ ì½”ë“œë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•˜ì§€ ì•Šê³  ì´ë¯¸ ì¡´ì¬í•˜ëŠ” SQL í…Œì´ë¸”ì— ë°ì´í„°ë¥¼ ì±„ìš¸ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. ì•„ë‹ˆë©´ ì ì–´ë„ íŒŒì´ì¬ì—ì„œ ì½”ë“œë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤. í˜¹ì€ ìƒˆë¡œìš´ ë¹„ë™ì  í…Œì´ë¸”(ë„ì‹œ ì •ë³´ ë° ë„ì‹œ ì¸êµ¬)ì„ ì—…ë°ì´íŠ¸í•˜ê¸°ë¡œ ê²°ì •í•  ë•Œê¹Œì§€ì…ë‹ˆë‹¤.

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

ì´ í”„ë¡œì íŠ¸ì˜ ëª©ì ìœ¼ë¡œ, Pythonì—ì„œ ì´ ë‘ í‘œë¥¼ GCPë¡œ ì—…ë¡œë“œí•˜ë ¤ë©´ í˜¸ìŠ¤íŠ¸ IPë¥¼ ë³€ê²½í•˜ëŠ” ê²ƒìœ¼ë¡œ ì¶©ë¶„í•©ë‹ˆë‹¤. ë˜ ë‹¤ë¥¸ ë°©ë²•ì€ ë‘ í‘œë¥¼ ë§Œë“œëŠ” ì½”ë“œë¥¼ í´ë¼ìš°ë“œì— ì—…ë¡œë“œí•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ ê²½ìš°, ìš°ë¦¬ëŠ” í´ë¼ìš°ë“œì— ë™ì  í‘œ ë‚ ì”¨ë¥¼ ë§Œë“¤ê³  ì±„ìš°ëŠ” ì½”ë“œë§Œ ì˜¬ë¦´ ê²ƒì…ë‹ˆë‹¤.

GCPì˜ "Cloud Functions" í•„ë“œì— í•¨ìˆ˜ë¥¼ ë§Œë“  í›„ ì—¬ëŸ¬ ë²ˆì˜ ì‹œí–‰ì°©ì˜¤ ëì— ì½”ë“œê°€ ë§ˆì¹¨ë‚´ ì‘ë™í–ˆìŠµë‹ˆë‹¤:

![cloud_function_image](/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_7.png)

í•˜ì§€ë§Œ ì½”ë“œê°€ ì‘ë™í•˜ê¸° ì „ì— í´ë¼ìš°ë“œ ì¸ìŠ¤í„´ìŠ¤ì— í•¨ìˆ˜ë¥¼ ì—°ê²°í•´ì•¼í•©ë‹ˆë‹¤. ì•„ë˜ ë‹¨ê³„ë¥¼ ë”°ë¼ì•¼í•©ë‹ˆë‹¤:

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<img src="/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_8.png" />

ì‘ì—…ì´ ì˜ë˜ì—ˆëŠ”ì§€ ì–´ë–»ê²Œ ì•Œ ìˆ˜ ìˆì„ê¹Œìš”? ê°€ì¥ ì¢‹ì€ ì†Œì‹ì€ ë‹¤ìŒê³¼ ê°™ì´ ë³´ì…ë‹ˆë‹¤:

<img src="/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_9.png" />

ë¡œì»¬ì—ì„œ í…ŒìŠ¤íŠ¸í•œ ì½”ë“œì™€ ë¹„êµí•´ ìƒë‹¹í•œ ìˆ˜ì •ì´ í•„ìš”í–ˆìŠµë‹ˆë‹¤. ìµœì¢… ì½”ë“œëŠ” ì´ë ‡ê²Œ ë³´ì…ë‹ˆë‹¤:

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

```python
import functions_framework
import pandas as pd
import sqlalchemy
import requests
from pytz import timezone
from datetime import datetime

@functions_framework.http
def insert(request):
  connection_string = connection()
  insert_into_weather(connection_string)
  return 'Data successfully added'

def connection():
  connection_name = "flying-dove-416317:europe-west1:wbs-mysql-db"    # this is not a real one
  db_user = "root"
  db_password = "xxxx"   # fill in with your SQL password
  schema_name = "gans"

  driver_name = 'mysql+pymysql'
  query_string = {"unix_socket": f"/cloudsql/{connection_name}"}

  db = sqlalchemy.create_engine(
      sqlalchemy.engine.url.URL(
          drivername = driver_name,
          username = db_user,
          password = db_password,
          database = schema_name,
          query = query_string,
      )
  )
  return db


# HERE STARTS THE WEATHER DATA RETRIEVAL FUNCTION:

def extract_city(connection_string):
    return pd.read_sql("cities_info", con=connection_string)

def get_weather_data(cities_df):
  berlin_timezone = timezone("Europe/Berlin")
  API_key = "7e5623c79f102b6c08b15c8hjib4cc9l"    # this is not a real one
  weather_items = []

  for city in cities_df["city_name"]:
    url = (f"http://api.openweathermap.org/data/2.5/forecast?q={city}&appid={API_key}&units=metric")
    response = requests.get(url)
    json = response.json()

    # Added the time retrieved so we know when the forecast was made
    retrieval_time = datetime.now(berlin_timezone).strftime("%Y-%m-%d %H:%M:%S")

    # As we are now using the data from our relational database, the city should reflect the city_id and not the city name
    city_id = cities_df.loc[cities_df["city_name"] == city, "city_id"].values[0]  # here we need to retrieve the values, otherwise it shows us the series

    for item in json["list"]:
        weather_item = {
            # Added the city name, so the information is clear when looking at multiple cities
            "city_id": city_id,
            "forecast_time": item.get("dt_txt", None),
            "temperature": item["main"].get("temp", None),
            "feels_like": item["main"].get("feels_like", None),
            "forecast": item["weather"][0].get("main", None),
            "humidity": item["main"].get("humidity", None),
            "rain_in_last_3h": item.get("rain", {}).get("3h", 0),
            "risk_of_rain": item["pop"],
            "snow_in_last_3h": item.get("snow", {}).get("3h", 0),
            "wind_speed": item["wind"].get("speed", None),
            "data_retrieved_at": retrieval_time
        }

        weather_items.append(weather_item)

  weather_df = pd.DataFrame(weather_items)
  weather_df["forecast_time"] = pd.to_datetime(weather_df["forecast_time"])
  weather_df["data_retrieved_at"] = pd.to_datetime(weather_df["data_retrieved_at"])
  weather_df["snow_in_last_3h"] = pd.to_numeric(weather_df["snow_in_last_3h"], downcast="float")

  return weather_df

def insert_into_weather(connection_string):
  cities_df = extract_city(connection_string)
  weather_df = get_weather_data(cities_df)    # we create the new dataframe using the function
  weather_df.to_sql("weather",
            if_exists="append",
            con=connection_string,
            index=False)
```

## Lessons learned from making our code cloud-worthy

### 1. Dependencies:

We need to add the right dependencies to the `requirements.txt` file. This was one of the main initial reasons preventing our code from working properly. It is important to note that some libraries are already uploaded on GCP by default and should not be included in the `.txt` file, but still need to be added as a library in our source code, e.g.:

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

```js
from pytz import timezone
from datetime import datetime
```

ë§Œì•½ ë°°í¬ë¥¼ ì‹œë„í•œ í›„ì— ë¹¨ê°„ ë°°ë„ˆ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤ë©´, ëŒ€ë¶€ë¶„ì˜ ê²½ìš° requirements.txt íŒŒì¼ì— ëª…ì‹œë˜ì–´ ìˆì§€ ì•Šì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ importí•˜ëŠ” ê²ƒì´ ì›ì¸ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

![image](/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_10.png)

requirements ì„¹ì…˜ì—ì„œëŠ” Python ëª¨ë“ˆì´ ì•„ë‹Œ íŒ¨í‚¤ì§€ë§Œ ì¶”ê°€í•´ì•¼ í•©ë‹ˆë‹¤. ë¯¸ë¦¬ ì•Œë ¤ë“œë¦¬ìë©´, ì—¬ê¸° Python ëª¨ë“ˆë“¤ì˜ ì¢…í•© ëª©ë¡ì´ ìˆìŠµë‹ˆë‹¤: [Python ëª¨ë“ˆ ëª©ë¡](https://docs.python.org/3/py-modindex.html)

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

ë‹¤ë¥¸ ìœ ìš©í•œ íŒì€ ì½”ë“œì—ì„œ ì‚¬ìš© ì¤‘ì¸ ëª¨ë“  ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì¶œë ¥í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ë…¸íŠ¸ë¶ì—ì„œ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œ í›„ì—ëŠ” ë‹¤ìŒì„ ì‹¤í–‰í•´ì•¼ í•©ë‹ˆë‹¤:

```js
print('\n'.join(f'{m.__name__}=={m.__version__}' for m in globals().values() if getattr(m, '__version__', None)))
```

ê·¸ëŸ° ë‹¤ìŒ ì ì ˆí•œ ì¢…ì†ì„±ìœ¼ë¡œ requirements.txtì— ì§ì ‘ ë³µì‚¬í•˜ì—¬ ë¶™ì—¬ë„£ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

![ì´ë¯¸ì§€](/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_11.png)

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

ì´ í”„ë¡œì íŠ¸ë¥¼ ìœ„í•´ í•„ìš”í•œ ì˜ì¡´ì„±ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤ .txt íŒŒì¼:

```js
functions-framework==3.*
SQLAlchemy==1.4.37
PyMySQL==1.0.2
pandas==1.5.2
requests==2.31.0
```

## 2. ì—°ê²° ì½”ë“œ í…ŒìŠ¤íŠ¸

ë°ì´í„° ê²€ìƒ‰ í•¨ìˆ˜ë¥¼ ì¶”ê°€í•˜ê¸° ì „ì— ì—°ê²° ì½”ë“œê°€ ì‘ë™í•˜ëŠ”ì§€ ë¨¼ì € í…ŒìŠ¤íŠ¸í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ë¬¸ì œê°€ ì—°ê²° ì„¤ì •ì— ìˆëŠ”ì§€ ì•„ë‹Œì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

ë¡œì»¬ ìŠ¤í¬ë¦½íŠ¸ë¥¼ GCPë¡œ ì´ë™í•  ë•Œ ì¢‹ì€ ì‹œì‘ ë°©ë²•ì€ "ë”ë¯¸" í•¨ìˆ˜ë¥¼ ë§Œë“¤ê³  í…ŒìŠ¤íŠ¸í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´:

```js
import functions_framework
import pandas as pd
import sqlalchemy

@functions_framework.http
def insert(request):
  connection_string = connection()
  insert_into_test_table(connection_string)
  return 'Data successfully added'

def connection():
  connection_name = "YOUR_DB_CON_NAME"  # ë³€ê²½í•´ì£¼ì„¸ìš”
  db_user = "root"                      # ë³€ê²½
  db_password = "YOUR_PASSWORD"         # ë³€ê²½
  schema_name = "test_schema"           # ë³€ê²½

  driver_name = 'mysql+pymysql'
  query_string = {"unix_socket": f"/cloudsql/{connection_name}"}

  db = sqlalchemy.create_engine(
      sqlalchemy.engine.url.URL(
          drivername = driver_name,
          username = db_user,
          password = db_password,
          database = schema_name,
          query = query_string,
      )
  )
  return db

def insert_into_test_table(con_str):
  data = {'FirstName': ['Function', 'Test'],
          'City': ['Cloud', 'Complete']}
  df = pd.DataFrame(data)
  df.to_sql(name="test_table", con=con_str, if_exists='append', index=False)
```

ì´ ê°„ë‹¨í•œ í•¨ìˆ˜ê°€ ì‘ë™í•˜ë©´ ì—°ê²°ì´ ì‘ë™í•˜ëŠ” ê²ƒì´ê³ , í•  ì¼ì€ ì‹¤ì œ ì½”ë“œë¥¼ ì¶”ê°€í•˜ê³  í†µí•©í•˜ëŠ” ê²ƒë¿ì…ë‹ˆë‹¤.

ë‹¤ìŒ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´ ìš°ë¦¬ì˜ ì½”ë“œì— ë¬¸ì œê°€ ìˆìŒì„ ê°€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

## 3. ìš°ë¦¬ ì‹¤ì œ ì½”ë“œì˜ ë¬¸ì œì 

ë‚´ ì½”ë“œë¥¼ ì˜¨ë¼ì¸ì— ì˜¬ë¦´ ë•Œ ì‹¤ìˆ˜í•œ ì£¼ìš”í•œ ë¶€ë¶„ì€ "ë”ë¯¸" í…œí”Œë¦¿ì„ ê¸°ë°˜ìœ¼ë¡œ ì½”ë“œë¥¼ ì¡°ì •í•˜ê³  ì‹¤ì œë¡œ ì •ì˜ë˜ì§€ ì•Šì€ "insert_into_weather" í•¨ìˆ˜ë¥¼ "@functions_framework.http" ì•„ë˜ì—ì„œ í˜¸ì¶œí–ˆë‹¤ëŠ” ê²ƒì´ì—ˆìŠµë‹ˆë‹¤.

ì´ í•¨ìˆ˜ë¥¼ ì¶”ê°€í•œ í›„ì—ë„ ì½”ë“œê°€ ì‘ë™í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì´ëŠ” í•„ìš”í•œ ë„ì‹œë¥¼ ìˆ˜ë™ìœ¼ë¡œ ëª…ëª…í–ˆê¸° ë•Œë¬¸ì— ë„ì‹œ ì •ë³´ ë°ì´í„°í”„ë ˆì„ì—ì„œ ì´ë¯¸ ê°€ì ¸ì˜¤ëŠ” ëŒ€ì‹ ì— ë„ì‹œ ì´ë¦„ì„ ìˆ˜ë™ìœ¼ë¡œ ì§€ì •í•´ì„œ ì˜¤ëŠ” ì ê³¼ ê´€ë ¨ì´ ìˆì—ˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ë‚˜ëŠ” ë¨¼ì € "extract_city"ë¼ëŠ” ë˜ ë‹¤ë¥¸ í•¨ìˆ˜ë¥¼ ì¶”ê°€í•´ì•¼ í–ˆê³ , ì´ í•¨ìˆ˜ê°€ ë¡œì»¬ì—ì„œ ì‘ë™í•˜ëŠ” ê²ƒì„ í™•ì¸ í›„ì— ì½”ë“œë¥¼ ì˜¨ë¼ì¸ì— ë°°í¬í•´ì•¼ í–ˆìŠµë‹ˆë‹¤.

ë„ì‹œ ì´ë¦„ì„ ì–»ê¸° ìœ„í•´ cities_info í…Œì´ë¸”ì„ ì‚¬ìš©í•œ í›„ì—, ë„ì‹œ ì´ë¦„ì„ ì¶”ì¶œí•˜ì§€ ì•Šì€ ì „ ë°˜ë³µë¬¸ì„ ì—…ë°ì´íŠ¸í•˜ì§€ ì•Šì€ ë‹¤ë¥¸ ì‹¤ìˆ˜ë¥¼ í–ˆìŠµë‹ˆë‹¤. ì´ì œ ë„ì‹œ ì´ë¦„ì„ ì´ì „ì— ëª©ë¡ì—ì„œ ê°€ì ¸ì˜¤ì§€ ì•Šê³  ë°ì´í„°í”„ë ˆì„ì—ì„œ ê°€ì ¸ì™€ì•¼ í–ˆê³ , ì´ì „ ì¸ìˆ˜ë¡œëŠ” ë„ì‹œ ì´ë¦„ì„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

# ë§ˆì§€ë§‰ ë‹¨ê³„

ìš°ë¦¬ í”„ë¡œì íŠ¸ë¥¼ ì™„ì „íˆ ê¸°ëŠ¥ì ì´ê³  ìë™í™”í•˜ê¸° ìœ„í•´ ì£¼ê¸°ì ìœ¼ë¡œ ì‹¤í–‰í•  í•¨ìˆ˜ë¥¼ ì˜ˆì•½í•´ì•¼ í•©ë‹ˆë‹¤. GCPì˜ "Cloud Scheduler" ë©”ë‰´ë¥¼ ì‚¬ìš©í•˜ë©´ ìƒë‹¹íˆ ì‰½ìŠµë‹ˆë‹¤.

ì´ë¥¼ ìœ„í•´ "ì‘ì—… ì˜ˆì•½"ì„ í•˜ê³  ëª‡ ê°€ì§€ ë§¤ê°œë³€ìˆ˜ë¥¼ ì œê³µí•˜ê³  ë¹ˆë„ë¥¼ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤(ë§¤ì£¼ í•œ ë²ˆ ë˜ëŠ” Cron í‘œí˜„ì‹ì„ ì‚¬ìš©í•˜ì—¬ íŠ¹ì • ì‹œê°„ì— íŠ¹ì • ìš”ì¼ì— ì‹¤í–‰í•˜ë„ë¡ ì„¤ì •). ì´ë ‡ê²Œ í•˜ë©´ í•´ë‹¹ ì‹œê°„ì— í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ì–´ SQL í…Œì´ë¸”ì— í•„ìš”í•œ ë°ì´í„°ë¥¼ ì±„ì›ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì—¬ê¸°ì„œëŠ” ë§¤ì£¼ ì›”ìš”ì¼ ì˜¤í›„ 3ì‹œì— ì‹¤í–‰ë˜ë„ë¡ ì„¤ì •í–ˆìŠµë‹ˆë‹¤:

![ì´ë¯¸ì§€](/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_12.png)

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

SQLì—ì„œ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”:

![image](/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_13.png)

ì²« ë²ˆì§¸ SQL-to-Python-to-GCP í”„ë¡œì íŠ¸ì™€ ì‘ë³„í•˜ê¸° ì „ì—, ë¬´ë£Œ í¬ë ˆë”§ì„ ì†Œë¹„í•˜ì§€ ì•Šë„ë¡ GCP ê³„ì •ì—ì„œ ë°ì´í„°ë¥¼ ì‚­ì œí•´ì•¼ í•´ìš”. ì´ëŠ” í´ë¼ìš°ë“œ ì¸ìŠ¤í„´ìŠ¤, í•¨ìˆ˜ ë° ì˜ˆì•½ëœ ì‘ì—…ì„ í¬í•¨í•´ìš”.

# ë

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

ì´ ê¸€ì„ ì“°ë©´ì„œ SQL, Python ë° í´ë¼ìš°ë“œ ì»´í“¨íŒ…ì„ ê²°í•©í•œ ë§¤ìš° ê¸°ë³¸ì ì¸ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ êµ¬ì¶•í•˜ëŠ” ë°©ë²•ì„ ë°°ì› ì–´ìš”.

ì´ í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í•  ë•Œ êµ¬ê¸€ í´ë¼ìš°ë“œ í”Œë«í¼ ë˜ëŠ” ë‹¤ë¥¸ í´ë¼ìš°ë“œ ì»´í“¨íŒ… í”Œë«í¼ì— ëŒ€í•´ ì „í˜€ ì•Œì§€ ëª°ëì–´ìš”. ì„œë²„, í˜¸ìŠ¤íŠ¸, ì¸ìŠ¤í„´ìŠ¤ ë˜ëŠ” ì†Œí”„íŠ¸ì›¨ì–´ ì—°ê²°ì— ëŒ€í•´ ì•„ë¬´ê²ƒë„ ëª¨ë¥´ê³  ìˆì—ˆì–´ìš” (ì§€ê¸ˆë„ìš”). SQLê³¼ Pythonì˜ ê¸°ë³¸ì ì¸ ì§€ì‹ë§Œ ìˆì—ˆì–´ìš”.

ì´ë ‡ê²Œ ì´ˆë³´ìë¡œ ì‹œì‘í–ˆì„ ë•Œ, ìë™í™”ëœ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ìƒì„±í•˜ê³  ì£¼ê¸°ì ìœ¼ë¡œ ê°€ì¹˜ ìˆëŠ” ë°ì´í„°ë¡œ ì±„ìš°ëŠ” ì¼ì´ ë„ˆë¬´ ì–´ë ¤ìš¸ ê²ƒì´ë¼ê³  íšŒì˜ì ì´ì—ˆì–´ìš”. ì´ì œ ë‚´ê°€ í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ì•Œê²Œ ë˜ì—ˆì–´ìš”!

ì•ìœ¼ë¡œì˜ ê³„íšì€ ë‹¤ë¥¸ APIì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ GCP ê¸°ëŠ¥ì— ê²°í•©í•˜ì—¬ ë” ì™„ì „í•˜ê³  ìœ ìš©í•œ ìµœì¢… ì œí’ˆì„ ë§Œë“¤ê³  ì‹¶ì–´í•´ìš”.

<!-- ui-station ì‚¬ê°í˜• -->

<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-4877378276818686"
data-ad-slot="7249294152"
data-ad-format="auto"
data-full-width-responsive="true"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

ê¸€ì„ ì“°ëŠ” ì‚¬ëŒì´ë¼ê³  í•˜ë”ë¼ë„ ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ì„ ì†Œí”„íŠ¸ì›¨ì–´ ì—”ì§€ë‹ˆì–´ë§Œí¼ ì˜ í•  ìˆ˜ëŠ” ì—†ì„ ì§€ë„ ëª¨ë¥´ê² ì–´ìš”. í•˜ì§€ë§Œ ìš°ë¦¬ëŠ” ê¸°ì´ˆë¥¼ ë°°ìš°ê³  ê±°ê¸°ì„œë¶€í„° ì„±ì¥í•  ìˆ˜ ìˆì£ .

# Stackademic ğŸ“

ëê¹Œì§€ ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤. ë– ë‚˜ì‹œê¸° ì „ì—:

- ì €ìë¥¼ í´ë©í•˜ì‹œê³  íŒ”ë¡œìš°í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ‘
- ìš°ë¦¬ë¥¼ íŒ”ë¡œìš°í•´ì£¼ì„¸ìš” X | LinkedIn | YouTube | Discord
- ë‹¤ë¥¸ í”Œë«í¼ì—ì„œë„ ë§Œë‚˜ë³´ì„¸ìš”: In Plain English | CoFeed | Venture | Cubed
- ë” ë§ì€ ì½˜í…ì¸ ëŠ” Stackademic.comì—ì„œ í™•ì¸í•˜ì„¸ìš”
