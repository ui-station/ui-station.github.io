<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>EKS에 GitOps Argo CD 설정하기 | ui-station</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://ui-station.github.io///post/2024-05-27-GitOpsArgoCDSetupOnEKS" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="EKS에 GitOps Argo CD 설정하기 | ui-station" data-gatsby-head="true"/><meta property="og:title" content="EKS에 GitOps Argo CD 설정하기 | ui-station" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-05-27-GitOpsArgoCDSetupOnEKS_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://ui-station.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://ui-station.github.io///post/2024-05-27-GitOpsArgoCDSetupOnEKS" data-gatsby-head="true"/><meta name="twitter:title" content="EKS에 GitOps Argo CD 설정하기 | ui-station" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-05-27-GitOpsArgoCDSetupOnEKS_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | ui-station" data-gatsby-head="true"/><meta name="article:published_time" content="2024-05-27 17:23" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-BHFR6GTH9P"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
          
            gtag('config', 'G-BHFR6GTH9P');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b8ef307c9aee1e34.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b8ef307c9aee1e34.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-4a646156c659a948.js" defer=""></script><script src="/_next/static/chunks/348-d11c34b645b13f5b.js" defer=""></script><script src="/_next/static/chunks/162-4172e84c8e2aa747.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-4f7b40c1114f0d09.js" defer=""></script><script src="/_next/static/o1YmnmSuZvAX2O4TI9r41/_buildManifest.js" defer=""></script><script src="/_next/static/o1YmnmSuZvAX2O4TI9r41/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">UI STATION</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">EKS에 GitOps Argo CD 설정하기</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="EKS에 GitOps Argo CD 설정하기" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">UI STATION</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On May 27, 2024</span><span class="posts_reading_time__f7YPP">9<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-05-27-GitOpsArgoCDSetupOnEKS&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<p>Argo CD는 쿠버네티스를 위한 GitOps 지속적 전달 도구로, 응용 프로그램 상태를 Git 저장소와 자동 동기화하고 롤백, 헬스 체크, RBAC 통합, 다중 환경 지원 및 CI/CD 시스템과의 원활한 통합을 가능케 합니다. 우리의 구현에 사용할 Argo CD에 대한 몇 가지 포인트는 다음과 같습니다:</p>
<ul>
<li>Git Ops 에이전트 — Argo CD는 Git 저장소에서 업데이트된 코드를 가져와 쿠버네티스 리소스로 직접 배포하는 역할을 합니다. 인프라 구성 및 애플리케이션 업데이트를 한 시스템에서 관리할 수 있습니다.</li>
<li>자동 배포: Argo CD는 응용 프로그램을 지정된 목표 환경에 자동으로 배포합니다. 응용 프로그램 상태를 선언적으로 정의하고, Argo CD가 배포 프로세스를 처리합니다.</li>
<li>다중 클러스터 관리: Argo CD를 사용하면 여러 쿠버네티스 클러스터에서 응용 프로그램을 관리하고 배포할 수 있습니다.</li>
<li>템플릿 지원: Argo CD는 helm과 Kustomize를 사용하여 템플릿 및 구성 관리를 지원합니다.</li>
<li>롤백: Git 저장소에 커밋된 모든 애플리케이션 구성을 어디서든지 롤백할 수 있습니다.</li>
</ul>
<p>Argo CD에는 많은 기능이 있습니다. 위에서 설명한 기능 중 일부를 우리의 CI/CD 파이프라인에 사용할 것입니다. Argo CD에 대한 자세한 내용은 Argo CD — Declarative GitOps CD for Kubernetes (argo-cd.readthedocs.io)에서 확인할 수 있습니다.</p>
<h1>Argo CD 설치하기:</h1>
<p>아르고 CD는 다음 두 가지 방법을 사용하여 EKS에 설치할 수 있습니다:</p>
<h2>쿠버네티스 매니페스트를 사용하는 방법:</h2>
<ol>
<li>아르고 CD Git 저장소를 복제하세요:</li>
</ol>
<pre><code class="hljs language-js"><span class="hljs-attr">C</span>:<span class="hljs-regexp">/>git clone https:/</span><span class="hljs-regexp">/github.com/</span>argoproj/argo-cd.<span class="hljs-property">git</span>
</code></pre>
<p>귀하의 기계에 git을 설치해야 하며, git CLI가 있어야 합니다.</p>
<p>b. 매니페스트를 귀하의 Kubernetes 클러스터에 적용하세요:</p>
<pre><code class="hljs language-js"><span class="hljs-attr">C</span>:<span class="hljs-regexp">/argo-cd> kubectl apply -n argocd -f manifests/i</span>nstall.<span class="hljs-property">yaml</span>
</code></pre>
<h2>Helm 사용 (권장되는 최상의 방법)</h2>
<p>a. 아르고 CD 헬름 리포지토리 추가:</p>
<pre><code class="hljs language-js">  helm repo add argo <span class="hljs-attr">https</span>:<span class="hljs-comment">//argoproj.github.io/argo-helm</span>
</code></pre>
<p>b. Helm 업데이트</p>
<pre><code class="hljs language-js">helm repo update
</code></pre>
<p>c. 설치</p>
<p>helm install argocd argo/argo-cd -n argocd</p>
<h1>Argo CD CLI:</h1>
<p>Argo CD는 여러 클러스터 추가, 사용자 추가, Argo CD CLI 명령 실행 등 여러 기능 위한 중요한 도구입니다. Argo CD Command Line Interface (CLI)를 설치하는 방법은 운영 체제에 따라 옵션이 조금 다를 수 있습니다. 다음은 CLI를 설치하는 방법입니다:</p>
<p>Linux/macOS</p>
<pre><code class="hljs language-bash">brew install argocd
</code></pre>
<p>Windows:</p>
<p>관리자 권한으로 PowerShell을 열어주세요. 아래 명령어를 입력하여 choco를 설치해주세요. 자세한 단계는 <a href="https://medium.com/@vikash06.india/part-1-multi-environment-instance-deployment-helm-template-argo-cd-eks-initial-setup-5ce4519184fc%EC%97%90%EC%84%9C" rel="nofollow" target="_blank">https://medium.com/@vikash06.india/part-1-multi-environment-instance-deployment-helm-template-argo-cd-eks-initial-setup-5ce4519184fc에서</a> 확인하실 수 있습니다.</p>
<pre><code class="hljs language-js"><span class="hljs-attr">C</span>:/> choco install argocd-cli
</code></pre>
<pre><code class="hljs language-js"><span class="hljs-attr">C</span>:/> argocd version
<span class="hljs-attr">argocd</span>: v2<span class="hljs-number">.9</span><span class="hljs-number">.3</span>+6eba5be
  <span class="hljs-title class_">BuildDate</span>: <span class="hljs-number">2023</span>-<span class="hljs-number">12</span>-01<span class="hljs-attr">T23</span>:<span class="hljs-number">24</span>:09Z
  <span class="hljs-title class_">GitCommit</span>: 6eba5be864b7e031871ed7698f5233336dfe75c7
  <span class="hljs-title class_">GitTreeState</span>: clean
  <span class="hljs-title class_">GoVersion</span>: go1<span class="hljs-number">.21</span><span class="hljs-number">.4</span>
  <span class="hljs-title class_">Compiler</span>: gc
  <span class="hljs-title class_">Platform</span>: windows/amd64
</code></pre>
<h1>Argo CD UI에 액세스하기:</h1>
<p>Argo CD UI에는 다음과 같은 방법으로 액세스할 수 있습니다:</p>
<ul>
<li>포트 포워딩</li>
<li>인그레스</li>
</ul>
<h2>포트 포워딩:</h2>
<p>포트 포워딩은 주로 로컬 머신에서 Argo CD UI를 사용하고자 할 때 사용됩니다</p>
<pre><code class="hljs language-js">kubectl port-forward svc/argocd-server -n argocd <span class="hljs-number">8080</span>:<span class="hljs-number">443</span>
</code></pre>
<p>그럼, 브라우저에서 <a href="https://localhost:8080%EC%9D%84" rel="nofollow" target="_blank">https://localhost:8080을</a> 열어 Argo CD UI에 액세스할 수 있어요.</p>
<h2>ALB Ingress:</h2>
<p>EKS에 설치하고 Argo CD를 로드 밸런서로 노출하려면 ALB Ingress가 최적의 옵션입니다(다른 로드 밸런서도 있습니다)</p>
<pre><code class="hljs language-js"><span class="hljs-attr">apiVersion</span>: networking.<span class="hljs-property">k8s</span>.<span class="hljs-property">io</span>/v1
<span class="hljs-attr">kind</span>: <span class="hljs-title class_">Ingress</span>
<span class="hljs-attr">metadata</span>:
  <span class="hljs-attr">name</span>: argocd-ingress
  <span class="hljs-attr">namespace</span>: argocd
  <span class="hljs-attr">annotations</span>:
    alb.<span class="hljs-property">ingress</span>.<span class="hljs-property">kubernetes</span>.<span class="hljs-property">io</span>/actions.<span class="hljs-property">ssl</span>-<span class="hljs-attr">redirect</span>: <span class="hljs-string">'{"Type": "redirect", "RedirectConfig":{ "Protocol": "HTTPS", "Port": "443", "StatusCode": "HTTP_301"}'</span>
    alb.<span class="hljs-property">ingress</span>.<span class="hljs-property">kubernetes</span>.<span class="hljs-property">io</span>/backend-<span class="hljs-attr">protocol</span>: <span class="hljs-variable constant_">HTTPS</span>
    alb.<span class="hljs-property">ingress</span>.<span class="hljs-property">kubernetes</span>.<span class="hljs-property">io</span>/certificate-<span class="hljs-attr">arn</span>: <span class="hljs-attr">arn</span>:<span class="hljs-attr">aws</span>:<span class="hljs-attr">acm</span>:us-east-<span class="hljs-number">1</span>:&#x3C;account-id>:certificate/&#x3C;certificate-id>
    alb.<span class="hljs-property">ingress</span>.<span class="hljs-property">kubernetes</span>.<span class="hljs-property">io</span>/group.<span class="hljs-property">name</span>:  prodalb
    alb.<span class="hljs-property">ingress</span>.<span class="hljs-property">kubernetes</span>.<span class="hljs-property">io</span>/listen-<span class="hljs-attr">ports</span>: <span class="hljs-string">'[{"HTTP": 80}, {"HTTPS": 443}]'</span>
    alb.<span class="hljs-property">ingress</span>.<span class="hljs-property">kubernetes</span>.<span class="hljs-property">io</span>/load-balancer-<span class="hljs-attr">name</span>: shared-load-balacer-name
    alb.<span class="hljs-property">ingress</span>.<span class="hljs-property">kubernetes</span>.<span class="hljs-property">io</span>/<span class="hljs-attr">scheme</span>: internet-facing
    alb.<span class="hljs-property">ingress</span>.<span class="hljs-property">kubernetes</span>.<span class="hljs-property">io</span>/<span class="hljs-attr">tags</span>: <span class="hljs-title class_">Environment</span>=dev,<span class="hljs-title class_">Team</span>=<span class="hljs-title class_">Cool</span> <span class="hljs-title class_">Product</span>, name=<span class="hljs-variable constant_">ALB</span>
      <span class="hljs-title class_">Dev</span> , <span class="hljs-title class_">UsedIN</span>=<span class="hljs-variable constant_">EKS</span>
    alb.<span class="hljs-property">ingress</span>.<span class="hljs-property">kubernetes</span>.<span class="hljs-property">io</span>/target-<span class="hljs-attr">type</span>: ip

  <span class="hljs-attr">finalizers</span>:
   - ingress.<span class="hljs-property">k8s</span>.<span class="hljs-property">aws</span>/resources

<span class="hljs-attr">spec</span>:
    <span class="hljs-attr">ingressClassName</span>: alb
    <span class="hljs-attr">rules</span>:
    - <span class="hljs-attr">host</span>: argocd.<span class="hljs-property">example</span>.<span class="hljs-property">net</span>
      <span class="hljs-attr">http</span>:
        <span class="hljs-attr">paths</span>:
        - <span class="hljs-attr">path</span>: /
          <span class="hljs-attr">backend</span>:
            <span class="hljs-attr">service</span>:
              <span class="hljs-attr">name</span>: argocd-server
              <span class="hljs-attr">port</span>:
                <span class="hljs-attr">number</span>: <span class="hljs-number">443</span>
          <span class="hljs-attr">pathType</span>: <span class="hljs-title class_">Prefix</span>
</code></pre>
<p>위 예제에서 <code>account-id</code>를 귀하의 AWS 계정 ID로, 인증서 ID를 AWS Certificate Manager에서 가져온 인증서 ID로 바꾸세요. 본질적으로 그것은 인증서 ARN입니다. 아직 인증서를 보유하고 있지 않다면 AWS Certificate Manager에서 인증서를 생성하세요. 매우 간단한 과정이며 발급 완료까지 약 5-10분이 소요됩니다. 이 링크를 참조하세요: <a href="https://docs.aws.amazon.com/acm/latest/userguide/gs-acm-request-public.html" rel="nofollow" target="_blank">링크</a></p>
<p>또한, <code>alb.ingress.kubernetes.io/group.name</code>은 여러 네임스페이스에서 동일한 로드 밸런서를 사용하는 경우에 사용됩니다.</p>
<pre><code class="hljs language-js"><span class="hljs-attr">C</span>:> kubectl apply -f argocd-ingress.<span class="hljs-property">yaml</span>
</code></pre>
<p>위 명령을 실행하면 ALB Ingress 로드 밸런서가 생성됩니다.</p>
<p>argocd.example.io는 브라우저에서 접속 가능합니다. (문제가 발생하면 서브 도메인의 Route 53 A 레코드를 확인해보세요.)</p>
<p>argocd.example.io 또는 localhost:8080(포트 포워드)로 접속하면 아래 페이지가 나타납니다:</p>
<p><img src="/assets/img/2024-05-27-GitOpsArgoCDSetupOnEKS_0.png" alt="Argo CD 설치 페이지"></p>
<p>Argo CD에 처음으로 로그인하기.</p>
<p>Argo CD와 인그레스 설정을 설치한 후에는 Argo CD의 기본 비밀번호를 가져와야 합니다. 아래 명령어를 사용할 것입니다.</p>
<pre><code class="hljs language-js">kubectl -n argocd get secret argocd-initial-admin-secret -o jsonpath=<span class="hljs-string">"{.data.password}"</span> | base64 -d
</code></pre>
<p>위 명령은 Argo CD의 비밀번호를 가져옵니다. 기본적으로 k8s에 저장된 모든 비밀번호는 Secret으로 암호화되어 base64로 저장됩니다. 윈도우 사용자의 경우 때로는 위 명령이 작동하지 않을 수 있으니 PowerShell을 사용하거나 'kubectl -n argocd get secret argocd-initial-admin-secret -o' 명령어로 비밀번호를 가져온 후에 Base64로 복호화해주세요.</p>
<p>argo cd.example.io 또는 localhost:8080(포트 포워드)로 접속할 때, 사용자를 admin으로 설정하고 위 단계에서 가져온 'password'로 로그인해주세요.</p>
<p>로그인 후에는 사용자 정보 화면에서 비밀번호를 업데이트할 수 있습니다.</p>
<p><img src="/assets/img/2024-05-27-GitOpsArgoCDSetupOnEKS_1.png" alt="User Info Screen"></p>
<h1>사용자 및 RBAC Argo CD 생성</h1>
<p>Argo CD 설치 시 기본적으로 관리자 사용자가 생성됩니다. 때로는 사용자를 생성하고 역할을 관리해야 할 때도 있습니다.</p>
<p>Argo CD를 통해 설치된 인증 및 역할 관리용 Configmaps이 있습니다. 클러스터에서 역할 및 권한 부여를 관리하기 위해 아래 ConfigMap을 찾을 수 있습니다. 아래 명령을 실행하면 K8s의 모든 ConfigMaps이 표시됩니다.</p>
<pre><code class="hljs language-js">kubectl get configmaps -n argoccd
</code></pre>
<p>결과:</p>
<p>다음으로 우리는 사용자를 만들기 위해 argocd-cm을 사용할 것이고 역할 관리를 위해 argocd-rbac-cm을 사용할 것입니다.</p>
<h2>사용자 생성:</h2>
<p>사용자 관점에서 Argo CD에는 다음과 같은 옵션이 있습니다:</p>
<ul>
<li>OIDC 공급자 — 이미 사용 중인 OIDC 공급자(예: Okta, OneLogin, Auth0, Microsoft, Keycloak, Google (G Suite))가 있으면 이 옵션을 사용하세요. 여기서 사용자, 그룹 및 멤버십을 관리합니다.</li>
<li>번들된 Dex OIDC 공급자 — 현재 공급자가 OIDC를 지원하지 않는 경우(예: SAML, LDAP) 또는 Dex의 커넥터 기능(예: GitHub 조직 및 팀을 OIDC 그룹 클레임에 매핑하는 기능)을 활용하려는 경우 이 옵션을 사용하세요.</li>
<li>소규모 팀을 위한 사용자 생성:</li>
</ul>
<pre><code class="hljs language-plaintext">C:\Users\vikas>kubectl edit configmap/argocd-cm -n argocd
</code></pre>
<p>아래와 같이 출력이되며, 사용자를 "accounts" 섹션에 추가하고 후행 앱앤더로 사용자를 추가하세요:</p>
<pre><code class="hljs language-yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">ConfigMap</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">argocd-cm</span>
  <span class="hljs-attr">namespace:</span> <span class="hljs-string">argocd</span>
  <span class="hljs-attr">labels:</span>
    <span class="hljs-attr">app.kubernetes.io/name:</span> <span class="hljs-string">argocd-cm</span>
    <span class="hljs-attr">app.kubernetes.io/part-of:</span> <span class="hljs-string">argocd</span>
<span class="hljs-attr">data:</span>
  <span class="hljs-comment"># add an additional local user with apiKey and login capabilities</span>
  <span class="hljs-comment">#   apiKey - allows generating API keys</span>
  <span class="hljs-comment">#   login - allows to login using UI</span>
  <span class="hljs-attr">accounts.demouser:</span> <span class="hljs-string">apiKey,</span> <span class="hljs-string">login</span>
  <span class="hljs-comment"># disables user. User is enabled by default</span>
  <span class="hljs-attr">accounts.demouser.enabled:</span> <span class="hljs-string">"false"</span>
</code></pre>
<p>"accounts.demouser.enabled"은 비밀번호를 활성화하거나 비활성화하는 데 사용됩니다.</p>
<p>새로 추가된 사용자의 비밀번호를 업데이트하려면 Argo CD CLI가 필요합니다. 이미 로컬에 Argo CD CLI를 설치해 두었으며 해당 명령을 실행하기 위해 EKS Argo CD에 연결해야 합니다. Windows 기기의 경우 Environment 변수 ARGOCD_SERVER를 설정해야 하며 URL은 http(ingress 또는 port forward)을 제외한 값을 사용해야 합니다. 다른 방법은 login 명령을 사용하여 Argo CD CLI에 로그인하는 것입니다.</p>
<pre><code class="hljs language-js">argocd login &#x3C;<span class="hljs-variable constant_">ARGOCD_SERVER</span>> --username &#x3C;<span class="hljs-variable constant_">USERNAME</span>> --password &#x3C;<span class="hljs-variable constant_">PASSWORD</span>>
</code></pre>
<p>새로 생성된 사용자를 확인합니다.</p>
<pre><code class="hljs language-js">argocd account list
</code></pre>
<p>사용자 목록이 표시됩니다. 이제 사용자 암호를 업데이트해야 합니다:</p>
<pre><code class="hljs language-js"># 만일 당신이 어드민 사용자로서 사용자를 관리 중이라면, &#x3C;current-user-password>에는 현재 어드민 암호를 입력해주세요.
argocd account update-password --account &#x3C;name> --current-password &#x3C;current-user-password> --<span class="hljs-keyword">new</span>-password &#x3C;<span class="hljs-keyword">new</span>-user-password>
</code></pre>
<p>위에서 사용자 이름은 구성 맵에 정의되어 있는 demouser이고, current-password는 어드민 사용자의 암호입니다.</p>
<p><a href="https://argo-cd.readthedocs.io/en/stable/operator-manual/user-management/#:~:text=Once%20installed%20Argo%20CD%20has,users%20or%20configure%20SSO%20integration" rel="nofollow" target="_blank">https://argo-cd.readthedocs.io/en/stable/operator-manual/user-management/#:~:text=Once%20installed%20Argo%20CD%20has,users%20or%20configure%20SSO%20integration</a>.</p>
<h1>RBAC:</h1>
<p>위에서 사용자를 만든 후에는 권한 역할을 할당해야 합니다. RBAC는 Argo CD의 일부로 이미 설치된 ConfigMap입니다. 역할 및 인증을 정의하는 데 사용됩니다. 클러스터에서 역할과 권한을 관리하는 ConfigMap을 아래에서 찾을 수 있습니다. 애플리케이션 배포를 변경하고 권한 및 액세스와 관련된 문제가 발생할 때는 항상 아래 ConfigMap을 참고해야 합니다.</p>
<p>아래 명령어를 실행하면 모든 RBAC 세부 정보가 표시됩니다:</p>
<pre><code class="hljs language-js"><span class="hljs-attr">C</span>:\<span class="hljs-title class_">Users</span>\vikas>kubectl describe configmap/argocd-rbac-cm -n argocd
</code></pre>
<pre><code class="hljs language-yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">ConfigMap</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">argocd-rbac-cm</span>
  <span class="hljs-attr">namespace:</span> <span class="hljs-string">argocd</span>
<span class="hljs-attr">data:</span>
  <span class="hljs-attr">policy.default:</span> <span class="hljs-string">role:readonly</span>
  <span class="hljs-attr">policy.csv:</span> <span class="hljs-string">|
    p, role:org-admin, applications, *, */*, allow
    p, role:org-admin, clusters, get, *, allow
</span></code></pre>
<p>아래 명령어로 구성 맵을 수정할 수 있어요</p>
<pre><code class="hljs language-bash">C:\Users\vikas>kubectl edit configmap/argocd-rbac-cm -n argocd
</code></pre>
<p>이 링크에서 각 정책 파일의 각 속성에 대한 자세한 내용을 찾을 수 있어요 RBAC Configuration — Argo CD — Declarative GitOps CD for Kubernetes (argo-cd.readthedocs.io)</p>
<h2>결론:</h2>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"EKS에 GitOps Argo CD 설정하기","description":"","date":"2024-05-27 17:23","slug":"2024-05-27-GitOpsArgoCDSetupOnEKS","content":"\n\nArgo CD는 쿠버네티스를 위한 GitOps 지속적 전달 도구로, 응용 프로그램 상태를 Git 저장소와 자동 동기화하고 롤백, 헬스 체크, RBAC 통합, 다중 환경 지원 및 CI/CD 시스템과의 원활한 통합을 가능케 합니다. 우리의 구현에 사용할 Argo CD에 대한 몇 가지 포인트는 다음과 같습니다:\n\n- Git Ops 에이전트 — Argo CD는 Git 저장소에서 업데이트된 코드를 가져와 쿠버네티스 리소스로 직접 배포하는 역할을 합니다. 인프라 구성 및 애플리케이션 업데이트를 한 시스템에서 관리할 수 있습니다.\n- 자동 배포: Argo CD는 응용 프로그램을 지정된 목표 환경에 자동으로 배포합니다. 응용 프로그램 상태를 선언적으로 정의하고, Argo CD가 배포 프로세스를 처리합니다.\n- 다중 클러스터 관리: Argo CD를 사용하면 여러 쿠버네티스 클러스터에서 응용 프로그램을 관리하고 배포할 수 있습니다.\n- 템플릿 지원: Argo CD는 helm과 Kustomize를 사용하여 템플릿 및 구성 관리를 지원합니다.\n- 롤백: Git 저장소에 커밋된 모든 애플리케이션 구성을 어디서든지 롤백할 수 있습니다.\n\nArgo CD에는 많은 기능이 있습니다. 위에서 설명한 기능 중 일부를 우리의 CI/CD 파이프라인에 사용할 것입니다. Argo CD에 대한 자세한 내용은 Argo CD — Declarative GitOps CD for Kubernetes (argo-cd.readthedocs.io)에서 확인할 수 있습니다.\n\n# Argo CD 설치하기:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n아르고 CD는 다음 두 가지 방법을 사용하여 EKS에 설치할 수 있습니다:\n\n## 쿠버네티스 매니페스트를 사용하는 방법:\n\n1. 아르고 CD Git 저장소를 복제하세요:\n\n```js\nC:/\u003egit clone https://github.com/argoproj/argo-cd.git\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n귀하의 기계에 git을 설치해야 하며, git CLI가 있어야 합니다.\n\nb. 매니페스트를 귀하의 Kubernetes 클러스터에 적용하세요:\n\n```js\nC:/argo-cd\u003e kubectl apply -n argocd -f manifests/install.yaml\n```\n\n## Helm 사용 (권장되는 최상의 방법)\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\na. 아르고 CD 헬름 리포지토리 추가:\n\n```js\n  helm repo add argo https://argoproj.github.io/argo-helm\n```\n\nb. Helm 업데이트\n\n```js\nhelm repo update\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nc. 설치\n\n\nhelm install argocd argo/argo-cd -n argocd\n\n\n# Argo CD CLI:\n\nArgo CD는 여러 클러스터 추가, 사용자 추가, Argo CD CLI 명령 실행 등 여러 기능 위한 중요한 도구입니다. Argo CD Command Line Interface (CLI)를 설치하는 방법은 운영 체제에 따라 옵션이 조금 다를 수 있습니다. 다음은 CLI를 설치하는 방법입니다:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nLinux/macOS\n\n```bash\nbrew install argocd\n```\n\nWindows:\n\n관리자 권한으로 PowerShell을 열어주세요. 아래 명령어를 입력하여 choco를 설치해주세요. 자세한 단계는 https://medium.com/@vikash06.india/part-1-multi-environment-instance-deployment-helm-template-argo-cd-eks-initial-setup-5ce4519184fc에서 확인하실 수 있습니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\nC:/\u003e choco install argocd-cli\n```\n\n```js\nC:/\u003e argocd version\nargocd: v2.9.3+6eba5be\n  BuildDate: 2023-12-01T23:24:09Z\n  GitCommit: 6eba5be864b7e031871ed7698f5233336dfe75c7\n  GitTreeState: clean\n  GoVersion: go1.21.4\n  Compiler: gc\n  Platform: windows/amd64\n```\n\n# Argo CD UI에 액세스하기:\n\nArgo CD UI에는 다음과 같은 방법으로 액세스할 수 있습니다:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n- 포트 포워딩\n- 인그레스\n\n## 포트 포워딩:\n\n포트 포워딩은 주로 로컬 머신에서 Argo CD UI를 사용하고자 할 때 사용됩니다\n\n```js\nkubectl port-forward svc/argocd-server -n argocd 8080:443\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n그럼, 브라우저에서 https://localhost:8080을 열어 Argo CD UI에 액세스할 수 있어요.\n\n## ALB Ingress:\n\nEKS에 설치하고 Argo CD를 로드 밸런서로 노출하려면 ALB Ingress가 최적의 옵션입니다(다른 로드 밸런서도 있습니다)\n\n```js\napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: argocd-ingress\n  namespace: argocd\n  annotations:\n    alb.ingress.kubernetes.io/actions.ssl-redirect: '{\"Type\": \"redirect\", \"RedirectConfig\":{ \"Protocol\": \"HTTPS\", \"Port\": \"443\", \"StatusCode\": \"HTTP_301\"}'\n    alb.ingress.kubernetes.io/backend-protocol: HTTPS\n    alb.ingress.kubernetes.io/certificate-arn: arn:aws:acm:us-east-1:\u003caccount-id\u003e:certificate/\u003ccertificate-id\u003e\n    alb.ingress.kubernetes.io/group.name:  prodalb\n    alb.ingress.kubernetes.io/listen-ports: '[{\"HTTP\": 80}, {\"HTTPS\": 443}]'\n    alb.ingress.kubernetes.io/load-balancer-name: shared-load-balacer-name\n    alb.ingress.kubernetes.io/scheme: internet-facing\n    alb.ingress.kubernetes.io/tags: Environment=dev,Team=Cool Product, name=ALB\n      Dev , UsedIN=EKS\n    alb.ingress.kubernetes.io/target-type: ip\n\n  finalizers:\n   - ingress.k8s.aws/resources\n\nspec:\n    ingressClassName: alb\n    rules:\n    - host: argocd.example.net\n      http:\n        paths:\n        - path: /\n          backend:\n            service:\n              name: argocd-server\n              port:\n                number: 443\n          pathType: Prefix\n```  \n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n위 예제에서 `account-id`를 귀하의 AWS 계정 ID로, 인증서 ID를 AWS Certificate Manager에서 가져온 인증서 ID로 바꾸세요. 본질적으로 그것은 인증서 ARN입니다. 아직 인증서를 보유하고 있지 않다면 AWS Certificate Manager에서 인증서를 생성하세요. 매우 간단한 과정이며 발급 완료까지 약 5-10분이 소요됩니다. 이 링크를 참조하세요: [링크](https://docs.aws.amazon.com/acm/latest/userguide/gs-acm-request-public.html)\n\n또한, `alb.ingress.kubernetes.io/group.name`은 여러 네임스페이스에서 동일한 로드 밸런서를 사용하는 경우에 사용됩니다.\n\n```js\nC:\u003e kubectl apply -f argocd-ingress.yaml\n```\n\n위 명령을 실행하면 ALB Ingress 로드 밸런서가 생성됩니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nargocd.example.io는 브라우저에서 접속 가능합니다. (문제가 발생하면 서브 도메인의 Route 53 A 레코드를 확인해보세요.)\n\nargocd.example.io 또는 localhost:8080(포트 포워드)로 접속하면 아래 페이지가 나타납니다:\n\n![Argo CD 설치 페이지](/assets/img/2024-05-27-GitOpsArgoCDSetupOnEKS_0.png)\n\nArgo CD에 처음으로 로그인하기.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nArgo CD와 인그레스 설정을 설치한 후에는 Argo CD의 기본 비밀번호를 가져와야 합니다. 아래 명령어를 사용할 것입니다.\n\n```js\nkubectl -n argocd get secret argocd-initial-admin-secret -o jsonpath=\"{.data.password}\" | base64 -d\n```\n\n위 명령은 Argo CD의 비밀번호를 가져옵니다. 기본적으로 k8s에 저장된 모든 비밀번호는 Secret으로 암호화되어 base64로 저장됩니다. 윈도우 사용자의 경우 때로는 위 명령이 작동하지 않을 수 있으니 PowerShell을 사용하거나 'kubectl -n argocd get secret argocd-initial-admin-secret -o' 명령어로 비밀번호를 가져온 후에 Base64로 복호화해주세요.\n\nargo cd.example.io 또는 localhost:8080(포트 포워드)로 접속할 때, 사용자를 admin으로 설정하고 위 단계에서 가져온 'password'로 로그인해주세요.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n로그인 후에는 사용자 정보 화면에서 비밀번호를 업데이트할 수 있습니다.\n\n![User Info Screen](/assets/img/2024-05-27-GitOpsArgoCDSetupOnEKS_1.png)\n\n# 사용자 및 RBAC Argo CD 생성\n\nArgo CD 설치 시 기본적으로 관리자 사용자가 생성됩니다. 때로는 사용자를 생성하고 역할을 관리해야 할 때도 있습니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nArgo CD를 통해 설치된 인증 및 역할 관리용 Configmaps이 있습니다. 클러스터에서 역할 및 권한 부여를 관리하기 위해 아래 ConfigMap을 찾을 수 있습니다. 아래 명령을 실행하면 K8s의 모든 ConfigMaps이 표시됩니다.\n\n```js\nkubectl get configmaps -n argoccd\n```\n\n결과:\n\n\u003cimg src=\"/assets/img/2024-05-27-GitOpsArgoCDSetupOnEKS_2.png\" /\u003e\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n다음으로 우리는 사용자를 만들기 위해 argocd-cm을 사용할 것이고 역할 관리를 위해 argocd-rbac-cm을 사용할 것입니다.\n\n## 사용자 생성:\n\n사용자 관점에서 Argo CD에는 다음과 같은 옵션이 있습니다:\n\n- OIDC 공급자 — 이미 사용 중인 OIDC 공급자(예: Okta, OneLogin, Auth0, Microsoft, Keycloak, Google (G Suite))가 있으면 이 옵션을 사용하세요. 여기서 사용자, 그룹 및 멤버십을 관리합니다.\n- 번들된 Dex OIDC 공급자 — 현재 공급자가 OIDC를 지원하지 않는 경우(예: SAML, LDAP) 또는 Dex의 커넥터 기능(예: GitHub 조직 및 팀을 OIDC 그룹 클레임에 매핑하는 기능)을 활용하려는 경우 이 옵션을 사용하세요.\n- 소규모 팀을 위한 사용자 생성:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```plaintext\nC:\\Users\\vikas\u003ekubectl edit configmap/argocd-cm -n argocd\n```\n\n아래와 같이 출력이되며, 사용자를 \"accounts\" 섹션에 추가하고 후행 앱앤더로 사용자를 추가하세요:\n\n```yaml\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: argocd-cm\n  namespace: argocd\n  labels:\n    app.kubernetes.io/name: argocd-cm\n    app.kubernetes.io/part-of: argocd\ndata:\n  # add an additional local user with apiKey and login capabilities\n  #   apiKey - allows generating API keys\n  #   login - allows to login using UI\n  accounts.demouser: apiKey, login\n  # disables user. User is enabled by default\n  accounts.demouser.enabled: \"false\"\n```\n\n\"accounts.demouser.enabled\"은 비밀번호를 활성화하거나 비활성화하는 데 사용됩니다.\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n새로 추가된 사용자의 비밀번호를 업데이트하려면 Argo CD CLI가 필요합니다. 이미 로컬에 Argo CD CLI를 설치해 두었으며 해당 명령을 실행하기 위해 EKS Argo CD에 연결해야 합니다. Windows 기기의 경우 Environment 변수 ARGOCD_SERVER를 설정해야 하며 URL은 http(ingress 또는 port forward)을 제외한 값을 사용해야 합니다. 다른 방법은 login 명령을 사용하여 Argo CD CLI에 로그인하는 것입니다.\n\n```js\nargocd login \u003cARGOCD_SERVER\u003e --username \u003cUSERNAME\u003e --password \u003cPASSWORD\u003e\n```\n\n새로 생성된 사용자를 확인합니다.\n\n```js\nargocd account list\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n사용자 목록이 표시됩니다. 이제 사용자 암호를 업데이트해야 합니다:\n\n```js\n# 만일 당신이 어드민 사용자로서 사용자를 관리 중이라면, \u003ccurrent-user-password\u003e에는 현재 어드민 암호를 입력해주세요.\nargocd account update-password --account \u003cname\u003e --current-password \u003ccurrent-user-password\u003e --new-password \u003cnew-user-password\u003e\n```\n\n위에서 사용자 이름은 구성 맵에 정의되어 있는 demouser이고, current-password는 어드민 사용자의 암호입니다.\n\nhttps://argo-cd.readthedocs.io/en/stable/operator-manual/user-management/#:~:text=Once%20installed%20Argo%20CD%20has,users%20or%20configure%20SSO%20integration.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# RBAC:\n\n위에서 사용자를 만든 후에는 권한 역할을 할당해야 합니다. RBAC는 Argo CD의 일부로 이미 설치된 ConfigMap입니다. 역할 및 인증을 정의하는 데 사용됩니다. 클러스터에서 역할과 권한을 관리하는 ConfigMap을 아래에서 찾을 수 있습니다. 애플리케이션 배포를 변경하고 권한 및 액세스와 관련된 문제가 발생할 때는 항상 아래 ConfigMap을 참고해야 합니다.\n\n아래 명령어를 실행하면 모든 RBAC 세부 정보가 표시됩니다:\n\n```js\nC:\\Users\\vikas\u003ekubectl describe configmap/argocd-rbac-cm -n argocd\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```yaml\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: argocd-rbac-cm\n  namespace: argocd\ndata:\n  policy.default: role:readonly\n  policy.csv: |\n    p, role:org-admin, applications, *, */*, allow\n    p, role:org-admin, clusters, get, *, allow\n```\n\n아래 명령어로 구성 맵을 수정할 수 있어요\n\n```bash\nC:\\Users\\vikas\u003ekubectl edit configmap/argocd-rbac-cm -n argocd\n```\n\n이 링크에서 각 정책 파일의 각 속성에 대한 자세한 내용을 찾을 수 있어요 RBAC Configuration — Argo CD — Declarative GitOps CD for Kubernetes (argo-cd.readthedocs.io)\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n## 결론:","ogImage":{"url":"/assets/img/2024-05-27-GitOpsArgoCDSetupOnEKS_0.png"},"coverImage":"/assets/img/2024-05-27-GitOpsArgoCDSetupOnEKS_0.png","tag":["Tech"],"readingTime":9},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cp\u003eArgo CD는 쿠버네티스를 위한 GitOps 지속적 전달 도구로, 응용 프로그램 상태를 Git 저장소와 자동 동기화하고 롤백, 헬스 체크, RBAC 통합, 다중 환경 지원 및 CI/CD 시스템과의 원활한 통합을 가능케 합니다. 우리의 구현에 사용할 Argo CD에 대한 몇 가지 포인트는 다음과 같습니다:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eGit Ops 에이전트 — Argo CD는 Git 저장소에서 업데이트된 코드를 가져와 쿠버네티스 리소스로 직접 배포하는 역할을 합니다. 인프라 구성 및 애플리케이션 업데이트를 한 시스템에서 관리할 수 있습니다.\u003c/li\u003e\n\u003cli\u003e자동 배포: Argo CD는 응용 프로그램을 지정된 목표 환경에 자동으로 배포합니다. 응용 프로그램 상태를 선언적으로 정의하고, Argo CD가 배포 프로세스를 처리합니다.\u003c/li\u003e\n\u003cli\u003e다중 클러스터 관리: Argo CD를 사용하면 여러 쿠버네티스 클러스터에서 응용 프로그램을 관리하고 배포할 수 있습니다.\u003c/li\u003e\n\u003cli\u003e템플릿 지원: Argo CD는 helm과 Kustomize를 사용하여 템플릿 및 구성 관리를 지원합니다.\u003c/li\u003e\n\u003cli\u003e롤백: Git 저장소에 커밋된 모든 애플리케이션 구성을 어디서든지 롤백할 수 있습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eArgo CD에는 많은 기능이 있습니다. 위에서 설명한 기능 중 일부를 우리의 CI/CD 파이프라인에 사용할 것입니다. Argo CD에 대한 자세한 내용은 Argo CD — Declarative GitOps CD for Kubernetes (argo-cd.readthedocs.io)에서 확인할 수 있습니다.\u003c/p\u003e\n\u003ch1\u003eArgo CD 설치하기:\u003c/h1\u003e\n\u003cp\u003e아르고 CD는 다음 두 가지 방법을 사용하여 EKS에 설치할 수 있습니다:\u003c/p\u003e\n\u003ch2\u003e쿠버네티스 매니페스트를 사용하는 방법:\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e아르고 CD Git 저장소를 복제하세요:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-attr\"\u003eC\u003c/span\u003e:\u003cspan class=\"hljs-regexp\"\u003e/\u003egit clone https:/\u003c/span\u003e\u003cspan class=\"hljs-regexp\"\u003e/github.com/\u003c/span\u003eargoproj/argo-cd.\u003cspan class=\"hljs-property\"\u003egit\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e귀하의 기계에 git을 설치해야 하며, git CLI가 있어야 합니다.\u003c/p\u003e\n\u003cp\u003eb. 매니페스트를 귀하의 Kubernetes 클러스터에 적용하세요:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-attr\"\u003eC\u003c/span\u003e:\u003cspan class=\"hljs-regexp\"\u003e/argo-cd\u003e kubectl apply -n argocd -f manifests/i\u003c/span\u003enstall.\u003cspan class=\"hljs-property\"\u003eyaml\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eHelm 사용 (권장되는 최상의 방법)\u003c/h2\u003e\n\u003cp\u003ea. 아르고 CD 헬름 리포지토리 추가:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e  helm repo add argo \u003cspan class=\"hljs-attr\"\u003ehttps\u003c/span\u003e:\u003cspan class=\"hljs-comment\"\u003e//argoproj.github.io/argo-helm\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eb. Helm 업데이트\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003ehelm repo update\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ec. 설치\u003c/p\u003e\n\u003cp\u003ehelm install argocd argo/argo-cd -n argocd\u003c/p\u003e\n\u003ch1\u003eArgo CD CLI:\u003c/h1\u003e\n\u003cp\u003eArgo CD는 여러 클러스터 추가, 사용자 추가, Argo CD CLI 명령 실행 등 여러 기능 위한 중요한 도구입니다. Argo CD Command Line Interface (CLI)를 설치하는 방법은 운영 체제에 따라 옵션이 조금 다를 수 있습니다. 다음은 CLI를 설치하는 방법입니다:\u003c/p\u003e\n\u003cp\u003eLinux/macOS\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ebrew install argocd\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWindows:\u003c/p\u003e\n\u003cp\u003e관리자 권한으로 PowerShell을 열어주세요. 아래 명령어를 입력하여 choco를 설치해주세요. 자세한 단계는 \u003ca href=\"https://medium.com/@vikash06.india/part-1-multi-environment-instance-deployment-helm-template-argo-cd-eks-initial-setup-5ce4519184fc%EC%97%90%EC%84%9C\" rel=\"nofollow\" target=\"_blank\"\u003ehttps://medium.com/@vikash06.india/part-1-multi-environment-instance-deployment-helm-template-argo-cd-eks-initial-setup-5ce4519184fc에서\u003c/a\u003e 확인하실 수 있습니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-attr\"\u003eC\u003c/span\u003e:/\u003e choco install argocd-cli\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-attr\"\u003eC\u003c/span\u003e:/\u003e argocd version\n\u003cspan class=\"hljs-attr\"\u003eargocd\u003c/span\u003e: v2\u003cspan class=\"hljs-number\"\u003e.9\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.3\u003c/span\u003e+6eba5be\n  \u003cspan class=\"hljs-title class_\"\u003eBuildDate\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2023\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e-01\u003cspan class=\"hljs-attr\"\u003eT23\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e:09Z\n  \u003cspan class=\"hljs-title class_\"\u003eGitCommit\u003c/span\u003e: 6eba5be864b7e031871ed7698f5233336dfe75c7\n  \u003cspan class=\"hljs-title class_\"\u003eGitTreeState\u003c/span\u003e: clean\n  \u003cspan class=\"hljs-title class_\"\u003eGoVersion\u003c/span\u003e: go1\u003cspan class=\"hljs-number\"\u003e.21\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.4\u003c/span\u003e\n  \u003cspan class=\"hljs-title class_\"\u003eCompiler\u003c/span\u003e: gc\n  \u003cspan class=\"hljs-title class_\"\u003ePlatform\u003c/span\u003e: windows/amd64\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch1\u003eArgo CD UI에 액세스하기:\u003c/h1\u003e\n\u003cp\u003eArgo CD UI에는 다음과 같은 방법으로 액세스할 수 있습니다:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e포트 포워딩\u003c/li\u003e\n\u003cli\u003e인그레스\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003e포트 포워딩:\u003c/h2\u003e\n\u003cp\u003e포트 포워딩은 주로 로컬 머신에서 Argo CD UI를 사용하고자 할 때 사용됩니다\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003ekubectl port-forward svc/argocd-server -n argocd \u003cspan class=\"hljs-number\"\u003e8080\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e443\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e그럼, 브라우저에서 \u003ca href=\"https://localhost:8080%EC%9D%84\" rel=\"nofollow\" target=\"_blank\"\u003ehttps://localhost:8080을\u003c/a\u003e 열어 Argo CD UI에 액세스할 수 있어요.\u003c/p\u003e\n\u003ch2\u003eALB Ingress:\u003c/h2\u003e\n\u003cp\u003eEKS에 설치하고 Argo CD를 로드 밸런서로 노출하려면 ALB Ingress가 최적의 옵션입니다(다른 로드 밸런서도 있습니다)\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-attr\"\u003eapiVersion\u003c/span\u003e: networking.\u003cspan class=\"hljs-property\"\u003ek8s\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eio\u003c/span\u003e/v1\n\u003cspan class=\"hljs-attr\"\u003ekind\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eIngress\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003emetadata\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: argocd-ingress\n  \u003cspan class=\"hljs-attr\"\u003enamespace\u003c/span\u003e: argocd\n  \u003cspan class=\"hljs-attr\"\u003eannotations\u003c/span\u003e:\n    alb.\u003cspan class=\"hljs-property\"\u003eingress\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ekubernetes\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eio\u003c/span\u003e/actions.\u003cspan class=\"hljs-property\"\u003essl\u003c/span\u003e-\u003cspan class=\"hljs-attr\"\u003eredirect\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'{\"Type\": \"redirect\", \"RedirectConfig\":{ \"Protocol\": \"HTTPS\", \"Port\": \"443\", \"StatusCode\": \"HTTP_301\"}'\u003c/span\u003e\n    alb.\u003cspan class=\"hljs-property\"\u003eingress\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ekubernetes\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eio\u003c/span\u003e/backend-\u003cspan class=\"hljs-attr\"\u003eprotocol\u003c/span\u003e: \u003cspan class=\"hljs-variable constant_\"\u003eHTTPS\u003c/span\u003e\n    alb.\u003cspan class=\"hljs-property\"\u003eingress\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ekubernetes\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eio\u003c/span\u003e/certificate-\u003cspan class=\"hljs-attr\"\u003earn\u003c/span\u003e: \u003cspan class=\"hljs-attr\"\u003earn\u003c/span\u003e:\u003cspan class=\"hljs-attr\"\u003eaws\u003c/span\u003e:\u003cspan class=\"hljs-attr\"\u003eacm\u003c/span\u003e:us-east-\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e:\u0026#x3C;account-id\u003e:certificate/\u0026#x3C;certificate-id\u003e\n    alb.\u003cspan class=\"hljs-property\"\u003eingress\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ekubernetes\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eio\u003c/span\u003e/group.\u003cspan class=\"hljs-property\"\u003ename\u003c/span\u003e:  prodalb\n    alb.\u003cspan class=\"hljs-property\"\u003eingress\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ekubernetes\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eio\u003c/span\u003e/listen-\u003cspan class=\"hljs-attr\"\u003eports\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'[{\"HTTP\": 80}, {\"HTTPS\": 443}]'\u003c/span\u003e\n    alb.\u003cspan class=\"hljs-property\"\u003eingress\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ekubernetes\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eio\u003c/span\u003e/load-balancer-\u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: shared-load-balacer-name\n    alb.\u003cspan class=\"hljs-property\"\u003eingress\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ekubernetes\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eio\u003c/span\u003e/\u003cspan class=\"hljs-attr\"\u003escheme\u003c/span\u003e: internet-facing\n    alb.\u003cspan class=\"hljs-property\"\u003eingress\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ekubernetes\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eio\u003c/span\u003e/\u003cspan class=\"hljs-attr\"\u003etags\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eEnvironment\u003c/span\u003e=dev,\u003cspan class=\"hljs-title class_\"\u003eTeam\u003c/span\u003e=\u003cspan class=\"hljs-title class_\"\u003eCool\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eProduct\u003c/span\u003e, name=\u003cspan class=\"hljs-variable constant_\"\u003eALB\u003c/span\u003e\n      \u003cspan class=\"hljs-title class_\"\u003eDev\u003c/span\u003e , \u003cspan class=\"hljs-title class_\"\u003eUsedIN\u003c/span\u003e=\u003cspan class=\"hljs-variable constant_\"\u003eEKS\u003c/span\u003e\n    alb.\u003cspan class=\"hljs-property\"\u003eingress\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ekubernetes\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eio\u003c/span\u003e/target-\u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e: ip\n\n  \u003cspan class=\"hljs-attr\"\u003efinalizers\u003c/span\u003e:\n   - ingress.\u003cspan class=\"hljs-property\"\u003ek8s\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eaws\u003c/span\u003e/resources\n\n\u003cspan class=\"hljs-attr\"\u003espec\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eingressClassName\u003c/span\u003e: alb\n    \u003cspan class=\"hljs-attr\"\u003erules\u003c/span\u003e:\n    - \u003cspan class=\"hljs-attr\"\u003ehost\u003c/span\u003e: argocd.\u003cspan class=\"hljs-property\"\u003eexample\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003enet\u003c/span\u003e\n      \u003cspan class=\"hljs-attr\"\u003ehttp\u003c/span\u003e:\n        \u003cspan class=\"hljs-attr\"\u003epaths\u003c/span\u003e:\n        - \u003cspan class=\"hljs-attr\"\u003epath\u003c/span\u003e: /\n          \u003cspan class=\"hljs-attr\"\u003ebackend\u003c/span\u003e:\n            \u003cspan class=\"hljs-attr\"\u003eservice\u003c/span\u003e:\n              \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: argocd-server\n              \u003cspan class=\"hljs-attr\"\u003eport\u003c/span\u003e:\n                \u003cspan class=\"hljs-attr\"\u003enumber\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e443\u003c/span\u003e\n          \u003cspan class=\"hljs-attr\"\u003epathType\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003ePrefix\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e위 예제에서 \u003ccode\u003eaccount-id\u003c/code\u003e를 귀하의 AWS 계정 ID로, 인증서 ID를 AWS Certificate Manager에서 가져온 인증서 ID로 바꾸세요. 본질적으로 그것은 인증서 ARN입니다. 아직 인증서를 보유하고 있지 않다면 AWS Certificate Manager에서 인증서를 생성하세요. 매우 간단한 과정이며 발급 완료까지 약 5-10분이 소요됩니다. 이 링크를 참조하세요: \u003ca href=\"https://docs.aws.amazon.com/acm/latest/userguide/gs-acm-request-public.html\" rel=\"nofollow\" target=\"_blank\"\u003e링크\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e또한, \u003ccode\u003ealb.ingress.kubernetes.io/group.name\u003c/code\u003e은 여러 네임스페이스에서 동일한 로드 밸런서를 사용하는 경우에 사용됩니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-attr\"\u003eC\u003c/span\u003e:\u003e kubectl apply -f argocd-ingress.\u003cspan class=\"hljs-property\"\u003eyaml\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e위 명령을 실행하면 ALB Ingress 로드 밸런서가 생성됩니다.\u003c/p\u003e\n\u003cp\u003eargocd.example.io는 브라우저에서 접속 가능합니다. (문제가 발생하면 서브 도메인의 Route 53 A 레코드를 확인해보세요.)\u003c/p\u003e\n\u003cp\u003eargocd.example.io 또는 localhost:8080(포트 포워드)로 접속하면 아래 페이지가 나타납니다:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-05-27-GitOpsArgoCDSetupOnEKS_0.png\" alt=\"Argo CD 설치 페이지\"\u003e\u003c/p\u003e\n\u003cp\u003eArgo CD에 처음으로 로그인하기.\u003c/p\u003e\n\u003cp\u003eArgo CD와 인그레스 설정을 설치한 후에는 Argo CD의 기본 비밀번호를 가져와야 합니다. 아래 명령어를 사용할 것입니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003ekubectl -n argocd get secret argocd-initial-admin-secret -o jsonpath=\u003cspan class=\"hljs-string\"\u003e\"{.data.password}\"\u003c/span\u003e | base64 -d\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e위 명령은 Argo CD의 비밀번호를 가져옵니다. 기본적으로 k8s에 저장된 모든 비밀번호는 Secret으로 암호화되어 base64로 저장됩니다. 윈도우 사용자의 경우 때로는 위 명령이 작동하지 않을 수 있으니 PowerShell을 사용하거나 'kubectl -n argocd get secret argocd-initial-admin-secret -o' 명령어로 비밀번호를 가져온 후에 Base64로 복호화해주세요.\u003c/p\u003e\n\u003cp\u003eargo cd.example.io 또는 localhost:8080(포트 포워드)로 접속할 때, 사용자를 admin으로 설정하고 위 단계에서 가져온 'password'로 로그인해주세요.\u003c/p\u003e\n\u003cp\u003e로그인 후에는 사용자 정보 화면에서 비밀번호를 업데이트할 수 있습니다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-05-27-GitOpsArgoCDSetupOnEKS_1.png\" alt=\"User Info Screen\"\u003e\u003c/p\u003e\n\u003ch1\u003e사용자 및 RBAC Argo CD 생성\u003c/h1\u003e\n\u003cp\u003eArgo CD 설치 시 기본적으로 관리자 사용자가 생성됩니다. 때로는 사용자를 생성하고 역할을 관리해야 할 때도 있습니다.\u003c/p\u003e\n\u003cp\u003eArgo CD를 통해 설치된 인증 및 역할 관리용 Configmaps이 있습니다. 클러스터에서 역할 및 권한 부여를 관리하기 위해 아래 ConfigMap을 찾을 수 있습니다. 아래 명령을 실행하면 K8s의 모든 ConfigMaps이 표시됩니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003ekubectl get configmaps -n argoccd\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e결과:\u003c/p\u003e\n\u003cp\u003e다음으로 우리는 사용자를 만들기 위해 argocd-cm을 사용할 것이고 역할 관리를 위해 argocd-rbac-cm을 사용할 것입니다.\u003c/p\u003e\n\u003ch2\u003e사용자 생성:\u003c/h2\u003e\n\u003cp\u003e사용자 관점에서 Argo CD에는 다음과 같은 옵션이 있습니다:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eOIDC 공급자 — 이미 사용 중인 OIDC 공급자(예: Okta, OneLogin, Auth0, Microsoft, Keycloak, Google (G Suite))가 있으면 이 옵션을 사용하세요. 여기서 사용자, 그룹 및 멤버십을 관리합니다.\u003c/li\u003e\n\u003cli\u003e번들된 Dex OIDC 공급자 — 현재 공급자가 OIDC를 지원하지 않는 경우(예: SAML, LDAP) 또는 Dex의 커넥터 기능(예: GitHub 조직 및 팀을 OIDC 그룹 클레임에 매핑하는 기능)을 활용하려는 경우 이 옵션을 사용하세요.\u003c/li\u003e\n\u003cli\u003e소규모 팀을 위한 사용자 생성:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-plaintext\"\u003eC:\\Users\\vikas\u003ekubectl edit configmap/argocd-cm -n argocd\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e아래와 같이 출력이되며, 사용자를 \"accounts\" 섹션에 추가하고 후행 앱앤더로 사용자를 추가하세요:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-yaml\"\u003e\u003cspan class=\"hljs-attr\"\u003eapiVersion:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ev1\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003ekind:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eConfigMap\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003emetadata:\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eargocd-cm\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003enamespace:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eargocd\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003elabels:\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003eapp.kubernetes.io/name:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eargocd-cm\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003eapp.kubernetes.io/part-of:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eargocd\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003edata:\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# add an additional local user with apiKey and login capabilities\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e#   apiKey - allows generating API keys\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e#   login - allows to login using UI\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eaccounts.demouser:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eapiKey,\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003elogin\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# disables user. User is enabled by default\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eaccounts.demouser.enabled:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"false\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\"accounts.demouser.enabled\"은 비밀번호를 활성화하거나 비활성화하는 데 사용됩니다.\u003c/p\u003e\n\u003cp\u003e새로 추가된 사용자의 비밀번호를 업데이트하려면 Argo CD CLI가 필요합니다. 이미 로컬에 Argo CD CLI를 설치해 두었으며 해당 명령을 실행하기 위해 EKS Argo CD에 연결해야 합니다. Windows 기기의 경우 Environment 변수 ARGOCD_SERVER를 설정해야 하며 URL은 http(ingress 또는 port forward)을 제외한 값을 사용해야 합니다. 다른 방법은 login 명령을 사용하여 Argo CD CLI에 로그인하는 것입니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eargocd login \u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eARGOCD_SERVER\u003c/span\u003e\u003e --username \u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eUSERNAME\u003c/span\u003e\u003e --password \u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003ePASSWORD\u003c/span\u003e\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e새로 생성된 사용자를 확인합니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eargocd account list\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e사용자 목록이 표시됩니다. 이제 사용자 암호를 업데이트해야 합니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e# 만일 당신이 어드민 사용자로서 사용자를 관리 중이라면, \u0026#x3C;current-user-password\u003e에는 현재 어드민 암호를 입력해주세요.\nargocd account update-password --account \u0026#x3C;name\u003e --current-password \u0026#x3C;current-user-password\u003e --\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e-password \u0026#x3C;\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e-user-password\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e위에서 사용자 이름은 구성 맵에 정의되어 있는 demouser이고, current-password는 어드민 사용자의 암호입니다.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://argo-cd.readthedocs.io/en/stable/operator-manual/user-management/#:~:text=Once%20installed%20Argo%20CD%20has,users%20or%20configure%20SSO%20integration\" rel=\"nofollow\" target=\"_blank\"\u003ehttps://argo-cd.readthedocs.io/en/stable/operator-manual/user-management/#:~:text=Once%20installed%20Argo%20CD%20has,users%20or%20configure%20SSO%20integration\u003c/a\u003e.\u003c/p\u003e\n\u003ch1\u003eRBAC:\u003c/h1\u003e\n\u003cp\u003e위에서 사용자를 만든 후에는 권한 역할을 할당해야 합니다. RBAC는 Argo CD의 일부로 이미 설치된 ConfigMap입니다. 역할 및 인증을 정의하는 데 사용됩니다. 클러스터에서 역할과 권한을 관리하는 ConfigMap을 아래에서 찾을 수 있습니다. 애플리케이션 배포를 변경하고 권한 및 액세스와 관련된 문제가 발생할 때는 항상 아래 ConfigMap을 참고해야 합니다.\u003c/p\u003e\n\u003cp\u003e아래 명령어를 실행하면 모든 RBAC 세부 정보가 표시됩니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-attr\"\u003eC\u003c/span\u003e:\\\u003cspan class=\"hljs-title class_\"\u003eUsers\u003c/span\u003e\\vikas\u003ekubectl describe configmap/argocd-rbac-cm -n argocd\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-yaml\"\u003e\u003cspan class=\"hljs-attr\"\u003eapiVersion:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ev1\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003ekind:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eConfigMap\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003emetadata:\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eargocd-rbac-cm\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003enamespace:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eargocd\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003edata:\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003epolicy.default:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003erole:readonly\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003epolicy.csv:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e|\n    p, role:org-admin, applications, *, */*, allow\n    p, role:org-admin, clusters, get, *, allow\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e아래 명령어로 구성 맵을 수정할 수 있어요\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eC:\\Users\\vikas\u003ekubectl edit configmap/argocd-rbac-cm -n argocd\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e이 링크에서 각 정책 파일의 각 속성에 대한 자세한 내용을 찾을 수 있어요 RBAC Configuration — Argo CD — Declarative GitOps CD for Kubernetes (argo-cd.readthedocs.io)\u003c/p\u003e\n\u003ch2\u003e결론:\u003c/h2\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-05-27-GitOpsArgoCDSetupOnEKS"},"buildId":"o1YmnmSuZvAX2O4TI9r41","isFallback":false,"gsp":true,"scriptLoader":[{"async":true,"src":"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4877378276818686","strategy":"lazyOnload","crossOrigin":"anonymous"}]}</script></body></html>