<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>5가지 필수 NET 마이크로서비스 패턴 | ui-station</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://ui-station.github.io///post/2024-06-19-5EssentialNETMicroservicesPatterns" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="5가지 필수 NET 마이크로서비스 패턴 | ui-station" data-gatsby-head="true"/><meta property="og:title" content="5가지 필수 NET 마이크로서비스 패턴 | ui-station" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-06-19-5EssentialNETMicroservicesPatterns_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://ui-station.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://ui-station.github.io///post/2024-06-19-5EssentialNETMicroservicesPatterns" data-gatsby-head="true"/><meta name="twitter:title" content="5가지 필수 NET 마이크로서비스 패턴 | ui-station" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-06-19-5EssentialNETMicroservicesPatterns_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | ui-station" data-gatsby-head="true"/><meta name="article:published_time" content="2024-06-19 11:29" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-BHFR6GTH9P"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
          
            gtag('config', 'G-BHFR6GTH9P');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b8ef307c9aee1e34.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b8ef307c9aee1e34.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-ac4aa08aae62f90e.js" defer=""></script><script src="/_next/static/chunks/463-0429087d4c0b0335.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-70e5ce89f3d962ac.js" defer=""></script><script src="/_next/static/JlBEgQDLGRx6DYlBnT8eD/_buildManifest.js" defer=""></script><script src="/_next/static/JlBEgQDLGRx6DYlBnT8eD/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">UI STATION</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">5가지 필수 NET 마이크로서비스 패턴</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="5가지 필수 NET 마이크로서비스 패턴" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">UI STATION</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On Jun 19, 2024</span><span class="posts_reading_time__f7YPP">8<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-06-19-5EssentialNETMicroservicesPatterns&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<p><img src="/assets/img/2024-06-19-5EssentialNETMicroservicesPatterns_0.png" alt="2024-06-19-5EssentialNETMicroservicesPatterns_0"></p>
<p>소프트웨어 개발의 끊임없는 세계에서, 마이크로서비스 아키텍처는 특히 .NET의 광범위한 영역에서 인기 있는 선택지가 되었습니다. .NET은 확장 및 적응이 가능한 능력으로 대규모의 데이터 및 트래픽을 처리할 수 있는 이상적인 플랫폼입니다.</p>
<p>이 기사에서는 마이크로서비스 아키텍처를 숙달하고자 하는 .NET 개발자들을 위한 다섯 가지 필수 패턴을 탐구할 것입니다. 우리는 실용적인 예제와 실행 가능한 조언을 제공하여 마이크로서비스의 우수성을 달성하는 여정에서 당신을 돕겠습니다.</p>
<h2>1. 게이트웨이 집계 패턴</h2>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p><img src="/assets/img/2024-06-19-5EssentialNETMicroservicesPatterns_1.png" alt="image"></p>
<p>마이크로서비스 아키텍처에서는 클라이언트 응용 프로그램이 상호 작용해야 할 여러 서비스가 있는 것이 일반적입니다. 각 개별 서비스와 직접 상호 작용하는 대신 API 게이트웨이를 사용하는 것이 더 좋습니다. 이 방법은 클라이언트 코드를 간소화하고 백엔드 서비스에 액세스하기 위한 단일 진입점을 생성합니다.</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// Ocelot API Gateway 사용 예제</span>
public <span class="hljs-keyword">async</span> <span class="hljs-title class_">Task</span>&#x3C;<span class="hljs-title class_">AggregatedResult</span>> <span class="hljs-title class_">AggregateData</span>()
{
    <span class="hljs-keyword">var</span> userTask = _userService.<span class="hljs-title class_">GetUser</span>();
    <span class="hljs-keyword">var</span> ordersTask = _orderService.<span class="hljs-title class_">GetOrdersForUser</span>();

    <span class="hljs-keyword">await</span> <span class="hljs-title class_">Task</span>.<span class="hljs-title class_">WhenAll</span>(userTask, ordersTask);

    <span class="hljs-keyword">var</span> user = <span class="hljs-keyword">await</span> userTask;
    <span class="hljs-keyword">var</span> orders = <span class="hljs-keyword">await</span> ordersTask;

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AggregatedResult</span>
    {
        <span class="hljs-title class_">User</span> = user,
        <span class="hljs-title class_">Orders</span> = orders
    };
}
</code></pre>
<h2>2. 회로 차단기 패턴</h2>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p><img src="/assets/img/2024-06-19-5EssentialNETMicroservicesPatterns_2.png" alt="Circuit Breaker"></p>
<p>서킷 브레이커를 구현하면 네트워크 또는 서비스 장애가 다른 서비스로 전파되는 것을 방지할 수 있습니다. 서비스 장애가 발생하면 서킷 브레이커가 이를 감지하고 그 서비스로의 후속 호출을 일정 기간 동안 자동으로 차단합니다.</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// Polly 라이브러리 사용 예제</span>
<span class="hljs-keyword">var</span> circuitBreakerPolicy = <span class="hljs-title class_">Policy</span>
    .<span class="hljs-property">Handle</span>&#x3C;<span class="hljs-title class_">Exception</span>>()
    .<span class="hljs-title class_">CircuitBreaker</span>(<span class="hljs-number">2</span>, <span class="hljs-title class_">TimeSpan</span>.<span class="hljs-title class_">FromMinutes</span>(<span class="hljs-number">1</span>));

<span class="hljs-keyword">await</span> circuitBreakerPolicy.<span class="hljs-title class_">ExecuteAsync</span>(<span class="hljs-keyword">async</span> () =>
{
    <span class="hljs-keyword">await</span> <span class="hljs-title class_">PerformServiceCall</span>();
});
</code></pre>
<h2>3. 서비스 디스커버리 패턴</h2>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p><img src="/assets/img/2024-06-19-5EssentialNETMicroservicesPatterns_3.png" alt="Image"></p>
<p>마이크로서비스 아키텍처를 확장할수록 다양한 서비스 엔드포인트를 추적하기가 더 어려워집니다. 이 문제를 해결하기 위해 서비스 디스커버리를 구현할 수 있습니다. 이를 통해 서비스가 동적으로 서로를 찾을 수 있습니다.</p>
<pre><code class="hljs language-js">using <span class="hljs-title class_">System</span>;
using <span class="hljs-title class_">System</span>.<span class="hljs-property">Threading</span>.<span class="hljs-property">Tasks</span>;
using <span class="hljs-title class_">Consul</span>;
using <span class="hljs-title class_">Microsoft</span>.<span class="hljs-property">Extensions</span>.<span class="hljs-property">DependencyInjection</span>;

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Program</span>
{
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title class_">Main</span>(string[] args)
    {
        <span class="hljs-keyword">var</span> serviceProvider = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServiceCollection</span>()
            .<span class="hljs-property">AddSingleton</span>&#x3C;<span class="hljs-title class_">IConsulClient</span>, <span class="hljs-title class_">ConsulClient</span>>(<span class="hljs-function"><span class="hljs-params">p</span> =></span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConsulClient</span>(<span class="hljs-function"><span class="hljs-params">consulConfig</span> =></span>
            {
                <span class="hljs-comment">// Assuming Consul is running on localhost</span>
                consulConfig.<span class="hljs-property">Address</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uri</span>(<span class="hljs-string">"http://localhost:8500"</span>);
            }))
            .<span class="hljs-property">AddSingleton</span>&#x3C;<span class="hljs-title class_">IConsulService</span>, <span class="hljs-title class_">ConsulService</span>>()
            .<span class="hljs-title class_">BuildServiceProvider</span>();

        <span class="hljs-keyword">var</span> consulService = serviceProvider.<span class="hljs-property">GetService</span>&#x3C;<span class="hljs-title class_">IConsulService</span>>();
        consulService.<span class="hljs-title class_">RegisterService</span>().<span class="hljs-title class_">Wait</span>();
        consulService.<span class="hljs-title class_">DiscoverServices</span>().<span class="hljs-title class_">Wait</span>();
    }
}

public interface <span class="hljs-title class_">IConsulService</span>
{
    <span class="hljs-title class_">Task</span> <span class="hljs-title class_">RegisterService</span>();
    <span class="hljs-title class_">Task</span> <span class="hljs-title class_">DiscoverServices</span>();
}

public <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConsulService</span> : <span class="hljs-title class_">IConsulService</span>
{
    private readonly <span class="hljs-title class_">IConsulClient</span> _consulClient;

    public <span class="hljs-title class_">ConsulService</span>(<span class="hljs-title class_">IConsulClient</span> consulClient)
    {
        _consulClient = consulClient;
    }

    public <span class="hljs-keyword">async</span> <span class="hljs-title class_">Task</span> <span class="hljs-title class_">RegisterService</span>()
    {
        <span class="hljs-keyword">var</span> registration = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AgentServiceRegistration</span>()
        {
            <span class="hljs-variable constant_">ID</span> = <span class="hljs-title class_">Guid</span>.<span class="hljs-title class_">NewGuid</span>().<span class="hljs-title class_">ToString</span>(),
            <span class="hljs-title class_">Name</span> = <span class="hljs-string">"MyService"</span>,
            <span class="hljs-title class_">Address</span> = <span class="hljs-string">"localhost"</span>,
            <span class="hljs-title class_">Port</span> = <span class="hljs-number">5000</span>,
        };

        <span class="hljs-keyword">await</span> _consulClient.<span class="hljs-property">Agent</span>.<span class="hljs-title class_">ServiceRegister</span>(registration);
        <span class="hljs-title class_">Console</span>.<span class="hljs-title class_">WriteLine</span>(<span class="hljs-string">"Consul에 서비스 등록됨"</span>);
    }

    public <span class="hljs-keyword">async</span> <span class="hljs-title class_">Task</span> <span class="hljs-title class_">DiscoverServices</span>()
    {
        <span class="hljs-keyword">var</span> services = <span class="hljs-keyword">await</span> _consulClient.<span class="hljs-property">Agent</span>.<span class="hljs-title class_">Services</span>();
        foreach (<span class="hljs-keyword">var</span> service <span class="hljs-keyword">in</span> services.<span class="hljs-property">Response</span>.<span class="hljs-property">Values</span>)
        {
            <span class="hljs-title class_">Console</span>.<span class="hljs-title class_">WriteLine</span>($<span class="hljs-string">"발견된 서비스: {service.Service}"</span>);
        }
    }
}
</code></pre>
<h2>4. 이벤트 소싱 패턴</h2>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<img src="/assets/img/2024-06-19-5EssentialNETMicroservicesPatterns_4.png">
<p>이벤트 소싱은 응용 프로그램 엔티티의 상태 변경을 이벤트 시리즈로 저장하는 패턴입니다. 이 접근 방식은 특히 마이크로서비스 아키텍처에서 유용하며 시스템에 대한 모든 변경 사항의 감사 가능한 레코드를 제공하여 디버깅 및 문제 해결에 도움이 됩니다. 게다가 이벤트 소싱은 응용 프로그램의 다른 구성 요소 간 데이터 일관성을 보장하는 데 도움이 될 수 있습니다.</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// EventStore를 사용한 이벤트 소싱 예시</span>
public <span class="hljs-keyword">async</span> <span class="hljs-title class_">Task</span> <span class="hljs-title class_">SaveEvents</span>(<span class="hljs-title class_">Guid</span> entityId, <span class="hljs-title class_">IEnumerable</span>&#x3C;<span class="hljs-title class_">Event</span>> events, long expectedVersion)
{
    <span class="hljs-keyword">var</span> eventData = events.<span class="hljs-title class_">Select</span>(<span class="hljs-function"><span class="hljs-params">e</span> =></span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventData</span>(
        <span class="hljs-title class_">Guid</span>.<span class="hljs-title class_">NewGuid</span>(),
        e.<span class="hljs-title class_">GetType</span>().<span class="hljs-property">Name</span>,
        <span class="hljs-literal">true</span>,
        <span class="hljs-title class_">Serialize</span>(e),
        <span class="hljs-literal">null</span>));

    <span class="hljs-keyword">var</span> streamName = $<span class="hljs-string">"Entity-{entityId}"</span>;
    <span class="hljs-keyword">await</span> _eventStoreConnection.<span class="hljs-title class_">AppendToStreamAsync</span>(streamName, expectedVersion, eventData);
}
</code></pre>
<h2>5. CQRS 패턴</h2>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p><img src="/assets/img/2024-06-19-5EssentialNETMicroservicesPatterns_5.png" alt="image"></p>
<p>Command Query Responsibility Segregation (CQRS)는 시스템의 읽기 및 쓰기 작업을 분리하는 디자인 패턴입니다. 이 접근 방식은 마이크로서비스에 적합하며 복잡한 데이터 모델을 관리하고 시스템을 더 효과적으로 확장하는 데 도움이 됩니다.</p>
<p>새로운 사용자 추가를 위한 명령</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// Commands/AddUserCommand.cs</span>
public <span class="hljs-keyword">class</span> <span class="hljs-title class_">AddUserCommand</span>
{
    public string <span class="hljs-title class_">Name</span> { get; }

    public <span class="hljs-title class_">AddUserCommand</span>(string name)
    {
        <span class="hljs-title class_">Name</span> = name;
    }
}

<span class="hljs-comment">// Handlers/AddUserCommandHandler.cs</span>
public <span class="hljs-keyword">class</span> <span class="hljs-title class_">AddUserCommandHandler</span> : <span class="hljs-title class_">ICommandHandler</span>&#x3C;<span class="hljs-title class_">AddUserCommand</span>>
{
    public <span class="hljs-keyword">void</span> <span class="hljs-title class_">Handle</span>(<span class="hljs-title class_">AddUserCommand</span> command)
    {
        <span class="hljs-comment">// Logic to add the user to the database</span>
        <span class="hljs-title class_">Console</span>.<span class="hljs-title class_">WriteLine</span>($<span class="hljs-string">"User {command.Name} added"</span>);
    }
}
</code></pre>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>ID로 사용자를 가져오는 쿼리</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// Queries/GetUserQuery.cs</span>
public <span class="hljs-keyword">class</span> <span class="hljs-title class_">GetUserQuery</span>
{
    public int <span class="hljs-title class_">UserId</span> { get; }

    public <span class="hljs-title class_">GetUserQuery</span>(int userId)
    {
        <span class="hljs-title class_">UserId</span> = userId;
    }
}

<span class="hljs-comment">// Handlers/GetUserQueryHandler.cs</span>
public <span class="hljs-keyword">class</span> <span class="hljs-title class_">GetUserQueryHandler</span> : <span class="hljs-title class_">IQueryHandler</span>&#x3C;<span class="hljs-title class_">GetUserQuery</span>, <span class="hljs-title class_">User</span>>
{
    public <span class="hljs-title class_">User</span> <span class="hljs-title class_">Handle</span>(<span class="hljs-title class_">GetUserQuery</span> query)
    {
        <span class="hljs-comment">// 데이터베이스에서 사용자를 가져오는 로직</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span> { <span class="hljs-title class_">Id</span> = query.<span class="hljs-property">UserId</span>, <span class="hljs-title class_">Name</span> = <span class="hljs-string">"John Doe"</span> };
    }
}
</code></pre>
<p>핸들러를 위한 인터페이스</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// Commands/ICommandHandler.cs</span>
public interface <span class="hljs-title class_">ICommandHandler</span>&#x3C;<span class="hljs-title class_">TCommand</span>>
{
    <span class="hljs-keyword">void</span> <span class="hljs-title class_">Handle</span>(<span class="hljs-title class_">TCommand</span> command);
}

<span class="hljs-comment">// Queries/IQueryHandler.cs</span>
public interface <span class="hljs-title class_">IQueryHandler</span>&#x3C;<span class="hljs-title class_">TQuery</span>, <span class="hljs-title class_">TResult</span>>
{
    <span class="hljs-title class_">TResult</span> <span class="hljs-title class_">Handle</span>(<span class="hljs-title class_">TQuery</span> query);
}
</code></pre>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>이 다섯 가지 방식을 따라가면 .NET 마이크로서비스를 숙달하기에 한 발짝 더 다가갈 것입니다. 이것들을 구성 요소로 활용하고 프로젝트에 맞게 사용자 정의하여 사용하세요. 당신의 마이크로서비스는 번성할 것입니다. 코딩을 즐기세요!</p>
<p><img src="https://miro.medium.com/v2/resize:fit:1400/0*UmnFETy8f6kvj1TV.gif" alt="이미지"></p>
<p>👏 만약 이 콘텐츠가 도움이 된다면, 버튼을 누른 채로 여러 번 클랩(clap)할 수 있습니다. 또한, 여러분의 생각과 제안을 댓글로 남겨 주시면 더 많은 토론을 할 수 있습니다.</p>
<p>읽어 주셔서 감사합니다...</p>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"5가지 필수 NET 마이크로서비스 패턴","description":"","date":"2024-06-19 11:29","slug":"2024-06-19-5EssentialNETMicroservicesPatterns","content":"\n![2024-06-19-5EssentialNETMicroservicesPatterns_0](/assets/img/2024-06-19-5EssentialNETMicroservicesPatterns_0.png)\n\n소프트웨어 개발의 끊임없는 세계에서, 마이크로서비스 아키텍처는 특히 .NET의 광범위한 영역에서 인기 있는 선택지가 되었습니다. .NET은 확장 및 적응이 가능한 능력으로 대규모의 데이터 및 트래픽을 처리할 수 있는 이상적인 플랫폼입니다.\n\n이 기사에서는 마이크로서비스 아키텍처를 숙달하고자 하는 .NET 개발자들을 위한 다섯 가지 필수 패턴을 탐구할 것입니다. 우리는 실용적인 예제와 실행 가능한 조언을 제공하여 마이크로서비스의 우수성을 달성하는 여정에서 당신을 돕겠습니다.\n\n## 1. 게이트웨이 집계 패턴\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n![image](/assets/img/2024-06-19-5EssentialNETMicroservicesPatterns_1.png)\n\n마이크로서비스 아키텍처에서는 클라이언트 응용 프로그램이 상호 작용해야 할 여러 서비스가 있는 것이 일반적입니다. 각 개별 서비스와 직접 상호 작용하는 대신 API 게이트웨이를 사용하는 것이 더 좋습니다. 이 방법은 클라이언트 코드를 간소화하고 백엔드 서비스에 액세스하기 위한 단일 진입점을 생성합니다.\n\n```js\n// Ocelot API Gateway 사용 예제\npublic async Task\u003cAggregatedResult\u003e AggregateData()\n{\n    var userTask = _userService.GetUser();\n    var ordersTask = _orderService.GetOrdersForUser();\n\n    await Task.WhenAll(userTask, ordersTask);\n\n    var user = await userTask;\n    var orders = await ordersTask;\n\n    return new AggregatedResult\n    {\n        User = user,\n        Orders = orders\n    };\n}\n```\n\n## 2. 회로 차단기 패턴\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n![Circuit Breaker](/assets/img/2024-06-19-5EssentialNETMicroservicesPatterns_2.png)\n\n서킷 브레이커를 구현하면 네트워크 또는 서비스 장애가 다른 서비스로 전파되는 것을 방지할 수 있습니다. 서비스 장애가 발생하면 서킷 브레이커가 이를 감지하고 그 서비스로의 후속 호출을 일정 기간 동안 자동으로 차단합니다.\n\n```js\n// Polly 라이브러리 사용 예제\nvar circuitBreakerPolicy = Policy\n    .Handle\u003cException\u003e()\n    .CircuitBreaker(2, TimeSpan.FromMinutes(1));\n\nawait circuitBreakerPolicy.ExecuteAsync(async () =\u003e\n{\n    await PerformServiceCall();\n});\n```\n\n## 3. 서비스 디스커버리 패턴\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n![Image](/assets/img/2024-06-19-5EssentialNETMicroservicesPatterns_3.png)\n\n마이크로서비스 아키텍처를 확장할수록 다양한 서비스 엔드포인트를 추적하기가 더 어려워집니다. 이 문제를 해결하기 위해 서비스 디스커버리를 구현할 수 있습니다. 이를 통해 서비스가 동적으로 서로를 찾을 수 있습니다.\n\n```js\nusing System;\nusing System.Threading.Tasks;\nusing Consul;\nusing Microsoft.Extensions.DependencyInjection;\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        var serviceProvider = new ServiceCollection()\n            .AddSingleton\u003cIConsulClient, ConsulClient\u003e(p =\u003e new ConsulClient(consulConfig =\u003e\n            {\n                // Assuming Consul is running on localhost\n                consulConfig.Address = new Uri(\"http://localhost:8500\");\n            }))\n            .AddSingleton\u003cIConsulService, ConsulService\u003e()\n            .BuildServiceProvider();\n\n        var consulService = serviceProvider.GetService\u003cIConsulService\u003e();\n        consulService.RegisterService().Wait();\n        consulService.DiscoverServices().Wait();\n    }\n}\n\npublic interface IConsulService\n{\n    Task RegisterService();\n    Task DiscoverServices();\n}\n\npublic class ConsulService : IConsulService\n{\n    private readonly IConsulClient _consulClient;\n\n    public ConsulService(IConsulClient consulClient)\n    {\n        _consulClient = consulClient;\n    }\n\n    public async Task RegisterService()\n    {\n        var registration = new AgentServiceRegistration()\n        {\n            ID = Guid.NewGuid().ToString(),\n            Name = \"MyService\",\n            Address = \"localhost\",\n            Port = 5000,\n        };\n\n        await _consulClient.Agent.ServiceRegister(registration);\n        Console.WriteLine(\"Consul에 서비스 등록됨\");\n    }\n\n    public async Task DiscoverServices()\n    {\n        var services = await _consulClient.Agent.Services();\n        foreach (var service in services.Response.Values)\n        {\n            Console.WriteLine($\"발견된 서비스: {service.Service}\");\n        }\n    }\n}\n```\n\n## 4. 이벤트 소싱 패턴\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n\u003cimg src=\"/assets/img/2024-06-19-5EssentialNETMicroservicesPatterns_4.png\" /\u003e\n\n이벤트 소싱은 응용 프로그램 엔티티의 상태 변경을 이벤트 시리즈로 저장하는 패턴입니다. 이 접근 방식은 특히 마이크로서비스 아키텍처에서 유용하며 시스템에 대한 모든 변경 사항의 감사 가능한 레코드를 제공하여 디버깅 및 문제 해결에 도움이 됩니다. 게다가 이벤트 소싱은 응용 프로그램의 다른 구성 요소 간 데이터 일관성을 보장하는 데 도움이 될 수 있습니다.\n\n```js\n// EventStore를 사용한 이벤트 소싱 예시\npublic async Task SaveEvents(Guid entityId, IEnumerable\u003cEvent\u003e events, long expectedVersion)\n{\n    var eventData = events.Select(e =\u003e new EventData(\n        Guid.NewGuid(),\n        e.GetType().Name,\n        true,\n        Serialize(e),\n        null));\n\n    var streamName = $\"Entity-{entityId}\";\n    await _eventStoreConnection.AppendToStreamAsync(streamName, expectedVersion, eventData);\n}\n```\n\n## 5. CQRS 패턴\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n![image](/assets/img/2024-06-19-5EssentialNETMicroservicesPatterns_5.png)\n\nCommand Query Responsibility Segregation (CQRS)는 시스템의 읽기 및 쓰기 작업을 분리하는 디자인 패턴입니다. 이 접근 방식은 마이크로서비스에 적합하며 복잡한 데이터 모델을 관리하고 시스템을 더 효과적으로 확장하는 데 도움이 됩니다.\n\n새로운 사용자 추가를 위한 명령\n\n```js\n// Commands/AddUserCommand.cs\npublic class AddUserCommand\n{\n    public string Name { get; }\n\n    public AddUserCommand(string name)\n    {\n        Name = name;\n    }\n}\n\n// Handlers/AddUserCommandHandler.cs\npublic class AddUserCommandHandler : ICommandHandler\u003cAddUserCommand\u003e\n{\n    public void Handle(AddUserCommand command)\n    {\n        // Logic to add the user to the database\n        Console.WriteLine($\"User {command.Name} added\");\n    }\n}\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nID로 사용자를 가져오는 쿼리\n\n```js\n// Queries/GetUserQuery.cs\npublic class GetUserQuery\n{\n    public int UserId { get; }\n\n    public GetUserQuery(int userId)\n    {\n        UserId = userId;\n    }\n}\n\n// Handlers/GetUserQueryHandler.cs\npublic class GetUserQueryHandler : IQueryHandler\u003cGetUserQuery, User\u003e\n{\n    public User Handle(GetUserQuery query)\n    {\n        // 데이터베이스에서 사용자를 가져오는 로직\n        return new User { Id = query.UserId, Name = \"John Doe\" };\n    }\n}\n```\n\n핸들러를 위한 인터페이스\n\n```js\n// Commands/ICommandHandler.cs\npublic interface ICommandHandler\u003cTCommand\u003e\n{\n    void Handle(TCommand command);\n}\n\n// Queries/IQueryHandler.cs\npublic interface IQueryHandler\u003cTQuery, TResult\u003e\n{\n    TResult Handle(TQuery query);\n}\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n이 다섯 가지 방식을 따라가면 .NET 마이크로서비스를 숙달하기에 한 발짝 더 다가갈 것입니다. 이것들을 구성 요소로 활용하고 프로젝트에 맞게 사용자 정의하여 사용하세요. 당신의 마이크로서비스는 번성할 것입니다. 코딩을 즐기세요!\n\n![이미지](https://miro.medium.com/v2/resize:fit:1400/0*UmnFETy8f6kvj1TV.gif)\n\n👏 만약 이 콘텐츠가 도움이 된다면, 버튼을 누른 채로 여러 번 클랩(clap)할 수 있습니다. 또한, 여러분의 생각과 제안을 댓글로 남겨 주시면 더 많은 토론을 할 수 있습니다.\n\n읽어 주셔서 감사합니다...\n","ogImage":{"url":"/assets/img/2024-06-19-5EssentialNETMicroservicesPatterns_0.png"},"coverImage":"/assets/img/2024-06-19-5EssentialNETMicroservicesPatterns_0.png","tag":["Tech"],"readingTime":8},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-19-5EssentialNETMicroservicesPatterns_0.png\" alt=\"2024-06-19-5EssentialNETMicroservicesPatterns_0\"\u003e\u003c/p\u003e\n\u003cp\u003e소프트웨어 개발의 끊임없는 세계에서, 마이크로서비스 아키텍처는 특히 .NET의 광범위한 영역에서 인기 있는 선택지가 되었습니다. .NET은 확장 및 적응이 가능한 능력으로 대규모의 데이터 및 트래픽을 처리할 수 있는 이상적인 플랫폼입니다.\u003c/p\u003e\n\u003cp\u003e이 기사에서는 마이크로서비스 아키텍처를 숙달하고자 하는 .NET 개발자들을 위한 다섯 가지 필수 패턴을 탐구할 것입니다. 우리는 실용적인 예제와 실행 가능한 조언을 제공하여 마이크로서비스의 우수성을 달성하는 여정에서 당신을 돕겠습니다.\u003c/p\u003e\n\u003ch2\u003e1. 게이트웨이 집계 패턴\u003c/h2\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-19-5EssentialNETMicroservicesPatterns_1.png\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cp\u003e마이크로서비스 아키텍처에서는 클라이언트 응용 프로그램이 상호 작용해야 할 여러 서비스가 있는 것이 일반적입니다. 각 개별 서비스와 직접 상호 작용하는 대신 API 게이트웨이를 사용하는 것이 더 좋습니다. 이 방법은 클라이언트 코드를 간소화하고 백엔드 서비스에 액세스하기 위한 단일 진입점을 생성합니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// Ocelot API Gateway 사용 예제\u003c/span\u003e\npublic \u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eTask\u003c/span\u003e\u0026#x3C;\u003cspan class=\"hljs-title class_\"\u003eAggregatedResult\u003c/span\u003e\u003e \u003cspan class=\"hljs-title class_\"\u003eAggregateData\u003c/span\u003e()\n{\n    \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e userTask = _userService.\u003cspan class=\"hljs-title class_\"\u003eGetUser\u003c/span\u003e();\n    \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e ordersTask = _orderService.\u003cspan class=\"hljs-title class_\"\u003eGetOrdersForUser\u003c/span\u003e();\n\n    \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eTask\u003c/span\u003e.\u003cspan class=\"hljs-title class_\"\u003eWhenAll\u003c/span\u003e(userTask, ordersTask);\n\n    \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e user = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e userTask;\n    \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e orders = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e ordersTask;\n\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eAggregatedResult\u003c/span\u003e\n    {\n        \u003cspan class=\"hljs-title class_\"\u003eUser\u003c/span\u003e = user,\n        \u003cspan class=\"hljs-title class_\"\u003eOrders\u003c/span\u003e = orders\n    };\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e2. 회로 차단기 패턴\u003c/h2\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-19-5EssentialNETMicroservicesPatterns_2.png\" alt=\"Circuit Breaker\"\u003e\u003c/p\u003e\n\u003cp\u003e서킷 브레이커를 구현하면 네트워크 또는 서비스 장애가 다른 서비스로 전파되는 것을 방지할 수 있습니다. 서비스 장애가 발생하면 서킷 브레이커가 이를 감지하고 그 서비스로의 후속 호출을 일정 기간 동안 자동으로 차단합니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// Polly 라이브러리 사용 예제\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e circuitBreakerPolicy = \u003cspan class=\"hljs-title class_\"\u003ePolicy\u003c/span\u003e\n    .\u003cspan class=\"hljs-property\"\u003eHandle\u003c/span\u003e\u0026#x3C;\u003cspan class=\"hljs-title class_\"\u003eException\u003c/span\u003e\u003e()\n    .\u003cspan class=\"hljs-title class_\"\u003eCircuitBreaker\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eTimeSpan\u003c/span\u003e.\u003cspan class=\"hljs-title class_\"\u003eFromMinutes\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e));\n\n\u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e circuitBreakerPolicy.\u003cspan class=\"hljs-title class_\"\u003eExecuteAsync\u003c/span\u003e(\u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e () =\u003e\n{\n    \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003ePerformServiceCall\u003c/span\u003e();\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e3. 서비스 디스커버리 패턴\u003c/h2\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-19-5EssentialNETMicroservicesPatterns_3.png\" alt=\"Image\"\u003e\u003c/p\u003e\n\u003cp\u003e마이크로서비스 아키텍처를 확장할수록 다양한 서비스 엔드포인트를 추적하기가 더 어려워집니다. 이 문제를 해결하기 위해 서비스 디스커버리를 구현할 수 있습니다. 이를 통해 서비스가 동적으로 서로를 찾을 수 있습니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eusing \u003cspan class=\"hljs-title class_\"\u003eSystem\u003c/span\u003e;\nusing \u003cspan class=\"hljs-title class_\"\u003eSystem\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eThreading\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eTasks\u003c/span\u003e;\nusing \u003cspan class=\"hljs-title class_\"\u003eConsul\u003c/span\u003e;\nusing \u003cspan class=\"hljs-title class_\"\u003eMicrosoft\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eExtensions\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eDependencyInjection\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eProgram\u003c/span\u003e\n{\n    \u003cspan class=\"hljs-keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eMain\u003c/span\u003e(string[] args)\n    {\n        \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e serviceProvider = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eServiceCollection\u003c/span\u003e()\n            .\u003cspan class=\"hljs-property\"\u003eAddSingleton\u003c/span\u003e\u0026#x3C;\u003cspan class=\"hljs-title class_\"\u003eIConsulClient\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eConsulClient\u003c/span\u003e\u003e(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003ep\u003c/span\u003e =\u003e\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eConsulClient\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003econsulConfig\u003c/span\u003e =\u003e\u003c/span\u003e\n            {\n                \u003cspan class=\"hljs-comment\"\u003e// Assuming Consul is running on localhost\u003c/span\u003e\n                consulConfig.\u003cspan class=\"hljs-property\"\u003eAddress\u003c/span\u003e = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eUri\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"http://localhost:8500\"\u003c/span\u003e);\n            }))\n            .\u003cspan class=\"hljs-property\"\u003eAddSingleton\u003c/span\u003e\u0026#x3C;\u003cspan class=\"hljs-title class_\"\u003eIConsulService\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eConsulService\u003c/span\u003e\u003e()\n            .\u003cspan class=\"hljs-title class_\"\u003eBuildServiceProvider\u003c/span\u003e();\n\n        \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e consulService = serviceProvider.\u003cspan class=\"hljs-property\"\u003eGetService\u003c/span\u003e\u0026#x3C;\u003cspan class=\"hljs-title class_\"\u003eIConsulService\u003c/span\u003e\u003e();\n        consulService.\u003cspan class=\"hljs-title class_\"\u003eRegisterService\u003c/span\u003e().\u003cspan class=\"hljs-title class_\"\u003eWait\u003c/span\u003e();\n        consulService.\u003cspan class=\"hljs-title class_\"\u003eDiscoverServices\u003c/span\u003e().\u003cspan class=\"hljs-title class_\"\u003eWait\u003c/span\u003e();\n    }\n}\n\npublic interface \u003cspan class=\"hljs-title class_\"\u003eIConsulService\u003c/span\u003e\n{\n    \u003cspan class=\"hljs-title class_\"\u003eTask\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eRegisterService\u003c/span\u003e();\n    \u003cspan class=\"hljs-title class_\"\u003eTask\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eDiscoverServices\u003c/span\u003e();\n}\n\npublic \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eConsulService\u003c/span\u003e : \u003cspan class=\"hljs-title class_\"\u003eIConsulService\u003c/span\u003e\n{\n    private readonly \u003cspan class=\"hljs-title class_\"\u003eIConsulClient\u003c/span\u003e _consulClient;\n\n    public \u003cspan class=\"hljs-title class_\"\u003eConsulService\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eIConsulClient\u003c/span\u003e consulClient)\n    {\n        _consulClient = consulClient;\n    }\n\n    public \u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eTask\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eRegisterService\u003c/span\u003e()\n    {\n        \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e registration = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eAgentServiceRegistration\u003c/span\u003e()\n        {\n            \u003cspan class=\"hljs-variable constant_\"\u003eID\u003c/span\u003e = \u003cspan class=\"hljs-title class_\"\u003eGuid\u003c/span\u003e.\u003cspan class=\"hljs-title class_\"\u003eNewGuid\u003c/span\u003e().\u003cspan class=\"hljs-title class_\"\u003eToString\u003c/span\u003e(),\n            \u003cspan class=\"hljs-title class_\"\u003eName\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"MyService\"\u003c/span\u003e,\n            \u003cspan class=\"hljs-title class_\"\u003eAddress\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"localhost\"\u003c/span\u003e,\n            \u003cspan class=\"hljs-title class_\"\u003ePort\u003c/span\u003e = \u003cspan class=\"hljs-number\"\u003e5000\u003c/span\u003e,\n        };\n\n        \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e _consulClient.\u003cspan class=\"hljs-property\"\u003eAgent\u003c/span\u003e.\u003cspan class=\"hljs-title class_\"\u003eServiceRegister\u003c/span\u003e(registration);\n        \u003cspan class=\"hljs-title class_\"\u003eConsole\u003c/span\u003e.\u003cspan class=\"hljs-title class_\"\u003eWriteLine\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Consul에 서비스 등록됨\"\u003c/span\u003e);\n    }\n\n    public \u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eTask\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eDiscoverServices\u003c/span\u003e()\n    {\n        \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e services = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e _consulClient.\u003cspan class=\"hljs-property\"\u003eAgent\u003c/span\u003e.\u003cspan class=\"hljs-title class_\"\u003eServices\u003c/span\u003e();\n        foreach (\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e service \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e services.\u003cspan class=\"hljs-property\"\u003eResponse\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eValues\u003c/span\u003e)\n        {\n            \u003cspan class=\"hljs-title class_\"\u003eConsole\u003c/span\u003e.\u003cspan class=\"hljs-title class_\"\u003eWriteLine\u003c/span\u003e($\u003cspan class=\"hljs-string\"\u003e\"발견된 서비스: {service.Service}\"\u003c/span\u003e);\n        }\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e4. 이벤트 소싱 패턴\u003c/h2\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cimg src=\"/assets/img/2024-06-19-5EssentialNETMicroservicesPatterns_4.png\"\u003e\n\u003cp\u003e이벤트 소싱은 응용 프로그램 엔티티의 상태 변경을 이벤트 시리즈로 저장하는 패턴입니다. 이 접근 방식은 특히 마이크로서비스 아키텍처에서 유용하며 시스템에 대한 모든 변경 사항의 감사 가능한 레코드를 제공하여 디버깅 및 문제 해결에 도움이 됩니다. 게다가 이벤트 소싱은 응용 프로그램의 다른 구성 요소 간 데이터 일관성을 보장하는 데 도움이 될 수 있습니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// EventStore를 사용한 이벤트 소싱 예시\u003c/span\u003e\npublic \u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eTask\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eSaveEvents\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eGuid\u003c/span\u003e entityId, \u003cspan class=\"hljs-title class_\"\u003eIEnumerable\u003c/span\u003e\u0026#x3C;\u003cspan class=\"hljs-title class_\"\u003eEvent\u003c/span\u003e\u003e events, long expectedVersion)\n{\n    \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e eventData = events.\u003cspan class=\"hljs-title class_\"\u003eSelect\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003ee\u003c/span\u003e =\u003e\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eEventData\u003c/span\u003e(\n        \u003cspan class=\"hljs-title class_\"\u003eGuid\u003c/span\u003e.\u003cspan class=\"hljs-title class_\"\u003eNewGuid\u003c/span\u003e(),\n        e.\u003cspan class=\"hljs-title class_\"\u003eGetType\u003c/span\u003e().\u003cspan class=\"hljs-property\"\u003eName\u003c/span\u003e,\n        \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e,\n        \u003cspan class=\"hljs-title class_\"\u003eSerialize\u003c/span\u003e(e),\n        \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e));\n\n    \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e streamName = $\u003cspan class=\"hljs-string\"\u003e\"Entity-{entityId}\"\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e _eventStoreConnection.\u003cspan class=\"hljs-title class_\"\u003eAppendToStreamAsync\u003c/span\u003e(streamName, expectedVersion, eventData);\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e5. CQRS 패턴\u003c/h2\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-19-5EssentialNETMicroservicesPatterns_5.png\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cp\u003eCommand Query Responsibility Segregation (CQRS)는 시스템의 읽기 및 쓰기 작업을 분리하는 디자인 패턴입니다. 이 접근 방식은 마이크로서비스에 적합하며 복잡한 데이터 모델을 관리하고 시스템을 더 효과적으로 확장하는 데 도움이 됩니다.\u003c/p\u003e\n\u003cp\u003e새로운 사용자 추가를 위한 명령\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// Commands/AddUserCommand.cs\u003c/span\u003e\npublic \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eAddUserCommand\u003c/span\u003e\n{\n    public string \u003cspan class=\"hljs-title class_\"\u003eName\u003c/span\u003e { get; }\n\n    public \u003cspan class=\"hljs-title class_\"\u003eAddUserCommand\u003c/span\u003e(string name)\n    {\n        \u003cspan class=\"hljs-title class_\"\u003eName\u003c/span\u003e = name;\n    }\n}\n\n\u003cspan class=\"hljs-comment\"\u003e// Handlers/AddUserCommandHandler.cs\u003c/span\u003e\npublic \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eAddUserCommandHandler\u003c/span\u003e : \u003cspan class=\"hljs-title class_\"\u003eICommandHandler\u003c/span\u003e\u0026#x3C;\u003cspan class=\"hljs-title class_\"\u003eAddUserCommand\u003c/span\u003e\u003e\n{\n    public \u003cspan class=\"hljs-keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eHandle\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eAddUserCommand\u003c/span\u003e command)\n    {\n        \u003cspan class=\"hljs-comment\"\u003e// Logic to add the user to the database\u003c/span\u003e\n        \u003cspan class=\"hljs-title class_\"\u003eConsole\u003c/span\u003e.\u003cspan class=\"hljs-title class_\"\u003eWriteLine\u003c/span\u003e($\u003cspan class=\"hljs-string\"\u003e\"User {command.Name} added\"\u003c/span\u003e);\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eID로 사용자를 가져오는 쿼리\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// Queries/GetUserQuery.cs\u003c/span\u003e\npublic \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eGetUserQuery\u003c/span\u003e\n{\n    public int \u003cspan class=\"hljs-title class_\"\u003eUserId\u003c/span\u003e { get; }\n\n    public \u003cspan class=\"hljs-title class_\"\u003eGetUserQuery\u003c/span\u003e(int userId)\n    {\n        \u003cspan class=\"hljs-title class_\"\u003eUserId\u003c/span\u003e = userId;\n    }\n}\n\n\u003cspan class=\"hljs-comment\"\u003e// Handlers/GetUserQueryHandler.cs\u003c/span\u003e\npublic \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eGetUserQueryHandler\u003c/span\u003e : \u003cspan class=\"hljs-title class_\"\u003eIQueryHandler\u003c/span\u003e\u0026#x3C;\u003cspan class=\"hljs-title class_\"\u003eGetUserQuery\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eUser\u003c/span\u003e\u003e\n{\n    public \u003cspan class=\"hljs-title class_\"\u003eUser\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eHandle\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eGetUserQuery\u003c/span\u003e query)\n    {\n        \u003cspan class=\"hljs-comment\"\u003e// 데이터베이스에서 사용자를 가져오는 로직\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eUser\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eId\u003c/span\u003e = query.\u003cspan class=\"hljs-property\"\u003eUserId\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eName\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"John Doe\"\u003c/span\u003e };\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e핸들러를 위한 인터페이스\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// Commands/ICommandHandler.cs\u003c/span\u003e\npublic interface \u003cspan class=\"hljs-title class_\"\u003eICommandHandler\u003c/span\u003e\u0026#x3C;\u003cspan class=\"hljs-title class_\"\u003eTCommand\u003c/span\u003e\u003e\n{\n    \u003cspan class=\"hljs-keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eHandle\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eTCommand\u003c/span\u003e command);\n}\n\n\u003cspan class=\"hljs-comment\"\u003e// Queries/IQueryHandler.cs\u003c/span\u003e\npublic interface \u003cspan class=\"hljs-title class_\"\u003eIQueryHandler\u003c/span\u003e\u0026#x3C;\u003cspan class=\"hljs-title class_\"\u003eTQuery\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eTResult\u003c/span\u003e\u003e\n{\n    \u003cspan class=\"hljs-title class_\"\u003eTResult\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eHandle\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eTQuery\u003c/span\u003e query);\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e이 다섯 가지 방식을 따라가면 .NET 마이크로서비스를 숙달하기에 한 발짝 더 다가갈 것입니다. 이것들을 구성 요소로 활용하고 프로젝트에 맞게 사용자 정의하여 사용하세요. 당신의 마이크로서비스는 번성할 것입니다. 코딩을 즐기세요!\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://miro.medium.com/v2/resize:fit:1400/0*UmnFETy8f6kvj1TV.gif\" alt=\"이미지\"\u003e\u003c/p\u003e\n\u003cp\u003e👏 만약 이 콘텐츠가 도움이 된다면, 버튼을 누른 채로 여러 번 클랩(clap)할 수 있습니다. 또한, 여러분의 생각과 제안을 댓글로 남겨 주시면 더 많은 토론을 할 수 있습니다.\u003c/p\u003e\n\u003cp\u003e읽어 주셔서 감사합니다...\u003c/p\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-06-19-5EssentialNETMicroservicesPatterns"},"buildId":"JlBEgQDLGRx6DYlBnT8eD","isFallback":false,"gsp":true,"scriptLoader":[{"async":true,"src":"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4877378276818686","strategy":"lazyOnload","crossOrigin":"anonymous"}]}</script></body></html>