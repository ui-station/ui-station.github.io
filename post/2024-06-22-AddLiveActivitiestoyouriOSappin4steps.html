<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>4단계로 iOS 앱에 실시간 활동 추가하는 방법 | ui-station</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://ui-station.github.io///post/2024-06-22-AddLiveActivitiestoyouriOSappin4steps" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="4단계로 iOS 앱에 실시간 활동 추가하는 방법 | ui-station" data-gatsby-head="true"/><meta property="og:title" content="4단계로 iOS 앱에 실시간 활동 추가하는 방법 | ui-station" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-06-22-AddLiveActivitiestoyouriOSappin4steps_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://ui-station.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://ui-station.github.io///post/2024-06-22-AddLiveActivitiestoyouriOSappin4steps" data-gatsby-head="true"/><meta name="twitter:title" content="4단계로 iOS 앱에 실시간 활동 추가하는 방법 | ui-station" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-06-22-AddLiveActivitiestoyouriOSappin4steps_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | ui-station" data-gatsby-head="true"/><meta name="article:published_time" content="2024-06-22 23:13" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-BHFR6GTH9P"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
          
            gtag('config', 'G-BHFR6GTH9P');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b8ef307c9aee1e34.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b8ef307c9aee1e34.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-ac4aa08aae62f90e.js" defer=""></script><script src="/_next/static/chunks/463-0429087d4c0b0335.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-70e5ce89f3d962ac.js" defer=""></script><script src="/_next/static/T_Nz0g9U1yttYMSEma95P/_buildManifest.js" defer=""></script><script src="/_next/static/T_Nz0g9U1yttYMSEma95P/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">UI STATION</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">4단계로 iOS 앱에 실시간 활동 추가하는 방법</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="4단계로 iOS 앱에 실시간 활동 추가하는 방법" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">UI STATION</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On Jun 22, 2024</span><span class="posts_reading_time__f7YPP">9<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-06-22-AddLiveActivitiestoyouriOSappin4steps&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<h2>iOS에서 라이브 액티비티로 사용자 경험과 실시간 상호작용 향상</h2>
<p>이미 라이브 액티비티를 앱에 통합하지 않았다면, 이제 강력한 잠재력을 고려해보는 것이 좋습니다.</p>
<p>라이브 액티비티는 호환되는 아이폰의 잠금 화면과 다이나믹 아일랜드에 자연스럽게 나타나는 전용 UI로, 이 기능을 활용하면 사용자가 앱의 주요 부분을 벗어나도 사용자와 상호작용을 유지할 수 있습니다.</p>
<p>푸시 알림을 보내지 않고 업데이트를 보내거나 실시간 정보를 표시할 수 있습니다. 그리고 가장 좋은 점은? 이를 추가하는 것이 놀랍도록 쉽습니다.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>여기에 그것을 하는 방법이 있어요.</p>
<p><img src="/assets/img/2024-06-22-AddLiveActivitiestoyouriOSappin4steps_0.png" alt="image1"></p>
<p><img src="https://miro.medium.com/v2/resize:fit:460/1*RqsG45Gbo625UNKcIUElTQ.gif" alt="image2"></p>
<h2>단계1 — 라이브 활동 콘텐츠 정의</h2>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>가장 처음으로 할 일은 라이브 활동에서 보여줄 정보를 정의하는 것입니다. 제한된 공간 때문에 사용자가 중요하게 생각할 데이터에 집중해야 합니다.</p>
<p>그 생각을 기억하고 다음으로 할 일은 ActivityAttributes 프로토콜을 구현하는 것입니다.</p>
<pre><code class="hljs language-js">public protocol <span class="hljs-title class_">ActivityAttributes</span> : <span class="hljs-title class_">Decodable</span>, <span class="hljs-title class_">Encodable</span> {

    <span class="hljs-comment">/// 라이브 활동의 동적 콘텐츠를 설명하는 연관 타입.</span>
    <span class="hljs-comment">///</span>
    <span class="hljs-comment">/// `ContentState`로 인코딩된 라이브 활동의 동적 데이터는 4KB를 초과할 수 없습니다.</span>
    associatedtype <span class="hljs-title class_">ContentState</span> : <span class="hljs-title class_">Decodable</span>, <span class="hljs-title class_">Encodable</span>, <span class="hljs-title class_">Hashable</span>
}
</code></pre>
<p>알 수 있듯이, 우리는 정보를 두 가지 범주로 나눌 수 있습니다:</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<ul>
<li>정적 → ActivityAttributes를 구현하는 모델의 속성입니다.</li>
<li>동적 → ContentState 타입에 저장됩니다.</li>
</ul>
<p>우리 경우에는 다음과 같이 정보를 정리할 수 있습니다:</p>
<ul>
<li>정적 → 주문 번호입니다. 사용자가 주문을 하면 번호가 바뀌지 않습니다.</li>
<li>동적 → 주문 상태로, 주문의 현재 단계를 나타냅니다.</li>
</ul>
<pre><code class="hljs language-js">struct <span class="hljs-title class_">OrderAttributes</span>: <span class="hljs-title class_">ActivityAttributes</span> {

    struct <span class="hljs-title class_">ContentState</span>: <span class="hljs-title class_">Codable</span>, <span class="hljs-title class_">Hashable</span> {
        enum <span class="hljs-title class_">OrderStatus</span>: <span class="hljs-title class_">Float</span>, <span class="hljs-title class_">Codable</span>, <span class="hljs-title class_">Hashable</span> {
            <span class="hljs-keyword">case</span> inQueue = <span class="hljs-number">0</span>
            <span class="hljs-keyword">case</span> aboutToTake
            <span class="hljs-keyword">case</span> making
            <span class="hljs-keyword">case</span> ready

            <span class="hljs-keyword">var</span> <span class="hljs-attr">description</span>: <span class="hljs-title class_">String</span> {
                <span class="hljs-keyword">switch</span> self {
                <span class="hljs-keyword">case</span> .<span class="hljs-property">inQueue</span>:
                    <span class="hljs-keyword">return</span> <span class="hljs-string">"주문이 대기 중입니다"</span>
                <span class="hljs-keyword">case</span> .<span class="hljs-property">aboutToTake</span>:
                    <span class="hljs-keyword">return</span> <span class="hljs-string">"주문을 받을 준비 중입니다"</span>
                <span class="hljs-keyword">case</span> .<span class="hljs-property">making</span>:
                    <span class="hljs-keyword">return</span> <span class="hljs-string">"주문을 준비 중입니다"</span>
                <span class="hljs-keyword">case</span> .<span class="hljs-property">ready</span>:
                    <span class="hljs-keyword">return</span> <span class="hljs-string">"주문이 수령 가능합니다!"</span>
                }
            }
        }

        <span class="hljs-keyword">let</span> <span class="hljs-attr">status</span>: <span class="hljs-title class_">OrderStatus</span>
    }

    <span class="hljs-keyword">let</span> <span class="hljs-attr">orderNumber</span>: <span class="hljs-title class_">Int</span>
}
</code></pre>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2>단계 2 — UI 생성하기</h2>
<p>라이브 활동 UI는 앱의 위젯 범위에 있습니다. 따라서 앱에 위젯 확장 기능이 없는 경우, 먼저 하나를 생성해야 합니다.</p>
<p>새로운 위젯 뷰를 생성하고 위젯 구현에서 ActivityConfiguration의 인스턴스를 반환합니다. 이전 단계에서 만든 ActivityAttributes 모델을 사용해야 합니다.</p>
<pre><code class="hljs language-js">struct <span class="hljs-title class_">CoffeeShopWidgetLiveActivity</span>: <span class="hljs-title class_">Widget</span> {

    <span class="hljs-keyword">var</span> <span class="hljs-attr">body</span>: some <span class="hljs-title class_">WidgetConfiguration</span> {
        <span class="hljs-title class_">ActivityConfiguration</span>(<span class="hljs-attr">for</span>: <span class="hljs-title class_">OrderAttributes</span>.<span class="hljs-property">self</span>) { context <span class="hljs-keyword">in</span>
            <span class="hljs-comment">// 여기에 잠금 화면/배너 UI가 들어갑니다</span>
            <span class="hljs-title class_">LiveActivityView</span>(<span class="hljs-attr">state</span>: context.<span class="hljs-property">state</span>)
        } <span class="hljs-attr">dynamicIsland</span>: { context <span class="hljs-keyword">in</span>
            <span class="hljs-comment">// 동적 아일랜드 구현이 이곳에 들어갑니다</span>
            <span class="hljs-comment">// 이 기사의 범위를 벗어난 내용입니다</span>
             ...
        }
    }
}
</code></pre>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>LiveActivityView 내에서는 Live Activity UI를 구성합니다.</p>
<pre><code class="hljs language-js">struct <span class="hljs-title class_">LiveActivityView</span>: <span class="hljs-title class_">View</span> {
    <span class="hljs-keyword">let</span> <span class="hljs-attr">state</span>: <span class="hljs-title class_">OrderAttributes</span>.<span class="hljs-property">ContentState</span>

    <span class="hljs-keyword">var</span> <span class="hljs-attr">body</span>: some <span class="hljs-title class_">View</span> {
        <span class="hljs-title class_">VStack</span> {
            <span class="hljs-title class_">HStack</span> {
                <span class="hljs-title class_">Image</span>(<span class="hljs-attr">systemName</span>: <span class="hljs-string">"cup.and.saucer"</span>)
                <span class="hljs-title class_">ProgressView</span>(<span class="hljs-attr">value</span>: state.<span class="hljs-property">status</span>.<span class="hljs-property">rawValue</span>, <span class="hljs-attr">total</span>: <span class="hljs-number">3</span>)
                    .<span class="hljs-title function_">tint</span>(.<span class="hljs-property">black</span>)
                    .<span class="hljs-title function_">background</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">brown</span>)
                <span class="hljs-title class_">Image</span>(<span class="hljs-attr">systemName</span>: <span class="hljs-string">"cup.and.saucer.fill"</span>)
            }
            .<span class="hljs-title function_">padding</span>(<span class="hljs-number">16</span>)

            <span class="hljs-title class_">Text</span>(<span class="hljs-string">"\(state.status.description)"</span>)
                .<span class="hljs-title function_">font</span>(.<span class="hljs-title function_">system</span>(<span class="hljs-attr">size</span>: <span class="hljs-number">18</span>, <span class="hljs-attr">weight</span>: .<span class="hljs-property">semibold</span>))
                .<span class="hljs-title function_">padding</span>(.<span class="hljs-property">bottom</span>)
            <span class="hljs-title class_">Spacer</span>()
        }
        .<span class="hljs-title function_">background</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">brown</span>.<span class="hljs-title function_">opacity</span>(<span class="hljs-number">0.6</span>))
    }
}
</code></pre>
<p>마지막으로, Live Activity 위젯을 위한 위젯 번들에 추가해야 합니다. 이 경우, 위젯을 제공하지 않을 것이므로 Live Activity만 사용합니다.</p>
<pre><code class="hljs language-js">@main
struct <span class="hljs-title class_">CoffeeShopWidgetBundle</span>: <span class="hljs-title class_">WidgetBundle</span> {
    <span class="hljs-keyword">var</span> <span class="hljs-attr">body</span>: some <span class="hljs-title class_">Widget</span> {
        <span class="hljs-title class_">CoffeeShopWidgetLiveActivity</span>()
    }
}
</code></pre>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2>단계 3 — 라이브 활동 초기화</h2>
<p>라이브 활동과 상호 작용하는 데는 ActivityKit API를 사용해야 합니다.</p>
<p>먼저, ActivityContent의 생성자인 init(state:staleDate:relevanceScore:)를 사용하여 라이브 활동의 초기 내용을 만들어야 합니다.</p>
<ul>
<li>state: 라이브 활동에 대한 초기 ActivityAttributes.ContentState입니다.</li>
<li>staleDate: 라이브 활동이 오래되었음을 OS에 알리기 위한 날짜입니다. staleDate가 지정되지 않으면, 8시간 후 OS가 라이브 활동을 종료합니다.</li>
<li>relevanceScore: 여러 개의 라이브 활동이 있는 경우, relevanceScore는 다이나믹 아일랜드에 표시할 우선순위와 잠금 화면의 순서를 나타냅니다.</li>
</ul>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>그럼 Activity 메서드 request(attributes: content: pushType:)를 호출하여 새로운 라이브 액티비티를 요청할 수 있어요.</p>
<ul>
<li>attributes: Step 1에서 생성한 ActivityAttributes의 인스턴스입니다.</li>
<li>content: 라이브 액티비티의 초기 콘텐츠입니다.</li>
<li>pushType: 라이브 액티비티의 업데이트가 ActivityKit 푸시 알림에서 올 것인지를 나타냅니다. 업데이트 기능만 사용할 경우에는 nil을 전달할 수 있어요.</li>
</ul>
<p>📣 중요한 알림: 새로운 Activity를 요청할 때 앱은 활성화 상태여야 해요.</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">let</span> orderAttributes = <span class="hljs-title class_">OrderAttributes</span>(<span class="hljs-attr">orderNumber</span>: <span class="hljs-number">1</span>)
<span class="hljs-keyword">let</span> initialState = <span class="hljs-title class_">OrderAttributes</span>.<span class="hljs-title class_">ContentState</span>(<span class="hljs-attr">status</span>: .<span class="hljs-property">inQueue</span>)
<span class="hljs-keyword">let</span> content = <span class="hljs-title class_">ActivityContent</span>(<span class="hljs-attr">state</span>: initialState, <span class="hljs-attr">staleDate</span>: nil, <span class="hljs-attr">relevanceScore</span>: <span class="hljs-number">1.0</span>)

<span class="hljs-keyword">do</span> {
    <span class="hljs-keyword">let</span> orderActivity = <span class="hljs-keyword">try</span> <span class="hljs-title class_">Activity</span>.<span class="hljs-title function_">request</span>(
        <span class="hljs-attr">attributes</span>: orderAttributes,
        <span class="hljs-attr">content</span>: content,
        <span class="hljs-attr">pushType</span>: nil
    )
} <span class="hljs-keyword">catch</span> {
    <span class="hljs-title function_">print</span>(error.<span class="hljs-property">localizedDescription</span>)
}
</code></pre>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2>단계 4 — 라이브 활동 업데이트</h2>
<p>라이브 활동을 업데이트하려면 update(_:) 함수를 사용할 수 있습니다. 초기 상태를 생성한 것과 마찬가지로 업데이트로 ActivityContent를 작성할 수 있습니다.</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">await</span> orderActivity?.<span class="hljs-title function_">update</span>(
    <span class="hljs-title class_">ActivityContent</span>&#x3C;<span class="hljs-title class_">OrderAttributes</span>.<span class="hljs-property">ContentState</span>>(
        <span class="hljs-attr">state</span>: state,
        <span class="hljs-attr">staleDate</span>: nil
    )
)
</code></pre>
<p>라이브 활동을 종료하려면 end(_:dismissalPolicy:) 함수를 사용합니다. 사용하는 종료 정책에 따라 라이브 활동은 사용자가 명시적으로 제거할 때까지 잠금 화면에 남게될 수 있습니다. 이것이 마지막 라이브 활동 상태를 전달하여 UI를 항상 최신 상태로 유지해야하는 이유입니다.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>사용 가능한 해제 정책 옵션은 세 가지입니다.</p>
<ul>
<li>default: 라이브 액티비티는 최대 4시간 동안 잠금 화면에 유지됩니다. (사용자가 제거할 때까지)</li>
<li>immediate: 운영 체제가 즉시 라이브 액티비티를 제거합니다.</li>
<li>after(_ date:): 라이브 액티비티를 해제할 날짜를 지정할 수 있습니다. (라이브 액티비티 종료 시간으로부터 4시간 이내여야 함)</li>
</ul>
<h1>다음 단계는 무엇인가요?</h1>
<p>앱의 사용 사례를 신중하게 고려해보세요. 라이브 액티비티는 배송 앱이나 스포츠 이벤트와 같은 실시간 애플리케이션에 특히 적합하지만, 푸시 알림에 대한 매력적인 대안으로도 사용될 수 있어 사용자에게 더 매력적인 경험을 제공할 수 있습니다.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>더 풍부한 사용자 경험을 위해 라이브 활동에 딥 링크를 통합하여 사용자가 라이브 활동을 탭할 때 연결이 원활하도록 할 수 있습니다.</p>
<p>질문이 있으시면 언제든지 메시지 남겨주세요! 🙂</p>
<ul>
<li>🤓 iOS 개발 팁과 통찰을 정기적으로 제공하는 제 트위터에 참여해보세요.</li>
<li>🚀 나의 예제 프로젝트를 모두 공유하는 GitHub를 확인해보세요.</li>
</ul>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"4단계로 iOS 앱에 실시간 활동 추가하는 방법","description":"","date":"2024-06-22 23:13","slug":"2024-06-22-AddLiveActivitiestoyouriOSappin4steps","content":"\n## iOS에서 라이브 액티비티로 사용자 경험과 실시간 상호작용 향상\n\n이미 라이브 액티비티를 앱에 통합하지 않았다면, 이제 강력한 잠재력을 고려해보는 것이 좋습니다.\n\n라이브 액티비티는 호환되는 아이폰의 잠금 화면과 다이나믹 아일랜드에 자연스럽게 나타나는 전용 UI로, 이 기능을 활용하면 사용자가 앱의 주요 부분을 벗어나도 사용자와 상호작용을 유지할 수 있습니다.\n\n푸시 알림을 보내지 않고 업데이트를 보내거나 실시간 정보를 표시할 수 있습니다. 그리고 가장 좋은 점은? 이를 추가하는 것이 놀랍도록 쉽습니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n여기에 그것을 하는 방법이 있어요.\n\n![image1](/assets/img/2024-06-22-AddLiveActivitiestoyouriOSappin4steps_0.png)\n\n![image2](https://miro.medium.com/v2/resize:fit:460/1*RqsG45Gbo625UNKcIUElTQ.gif)\n\n## 단계1 — 라이브 활동 콘텐츠 정의\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n가장 처음으로 할 일은 라이브 활동에서 보여줄 정보를 정의하는 것입니다. 제한된 공간 때문에 사용자가 중요하게 생각할 데이터에 집중해야 합니다.\n\n그 생각을 기억하고 다음으로 할 일은 ActivityAttributes 프로토콜을 구현하는 것입니다.\n\n```js\npublic protocol ActivityAttributes : Decodable, Encodable {\n\n    /// 라이브 활동의 동적 콘텐츠를 설명하는 연관 타입.\n    ///\n    /// `ContentState`로 인코딩된 라이브 활동의 동적 데이터는 4KB를 초과할 수 없습니다.\n    associatedtype ContentState : Decodable, Encodable, Hashable\n}\n```\n\n알 수 있듯이, 우리는 정보를 두 가지 범주로 나눌 수 있습니다:\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n- 정적 → ActivityAttributes를 구현하는 모델의 속성입니다.\n- 동적 → ContentState 타입에 저장됩니다.\n\n우리 경우에는 다음과 같이 정보를 정리할 수 있습니다:\n\n- 정적 → 주문 번호입니다. 사용자가 주문을 하면 번호가 바뀌지 않습니다.\n- 동적 → 주문 상태로, 주문의 현재 단계를 나타냅니다.\n\n```js\nstruct OrderAttributes: ActivityAttributes {\n\n    struct ContentState: Codable, Hashable {\n        enum OrderStatus: Float, Codable, Hashable {\n            case inQueue = 0\n            case aboutToTake\n            case making\n            case ready\n\n            var description: String {\n                switch self {\n                case .inQueue:\n                    return \"주문이 대기 중입니다\"\n                case .aboutToTake:\n                    return \"주문을 받을 준비 중입니다\"\n                case .making:\n                    return \"주문을 준비 중입니다\"\n                case .ready:\n                    return \"주문이 수령 가능합니다!\"\n                }\n            }\n        }\n\n        let status: OrderStatus\n    }\n\n    let orderNumber: Int\n}\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## 단계 2 — UI 생성하기\n\n라이브 활동 UI는 앱의 위젯 범위에 있습니다. 따라서 앱에 위젯 확장 기능이 없는 경우, 먼저 하나를 생성해야 합니다.\n\n새로운 위젯 뷰를 생성하고 위젯 구현에서 ActivityConfiguration의 인스턴스를 반환합니다. 이전 단계에서 만든 ActivityAttributes 모델을 사용해야 합니다.\n\n```js\nstruct CoffeeShopWidgetLiveActivity: Widget {\n\n    var body: some WidgetConfiguration {\n        ActivityConfiguration(for: OrderAttributes.self) { context in\n            // 여기에 잠금 화면/배너 UI가 들어갑니다\n            LiveActivityView(state: context.state)\n        } dynamicIsland: { context in\n            // 동적 아일랜드 구현이 이곳에 들어갑니다\n            // 이 기사의 범위를 벗어난 내용입니다\n             ...\n        }\n    }\n}\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nLiveActivityView 내에서는 Live Activity UI를 구성합니다.\n\n```js\nstruct LiveActivityView: View {\n    let state: OrderAttributes.ContentState\n\n    var body: some View {\n        VStack {\n            HStack {\n                Image(systemName: \"cup.and.saucer\")\n                ProgressView(value: state.status.rawValue, total: 3)\n                    .tint(.black)\n                    .background(Color.brown)\n                Image(systemName: \"cup.and.saucer.fill\")\n            }\n            .padding(16)\n\n            Text(\"\\(state.status.description)\")\n                .font(.system(size: 18, weight: .semibold))\n                .padding(.bottom)\n            Spacer()\n        }\n        .background(Color.brown.opacity(0.6))\n    }\n}\n```\n\n마지막으로, Live Activity 위젯을 위한 위젯 번들에 추가해야 합니다. 이 경우, 위젯을 제공하지 않을 것이므로 Live Activity만 사용합니다.\n\n```js\n@main\nstruct CoffeeShopWidgetBundle: WidgetBundle {\n    var body: some Widget {\n        CoffeeShopWidgetLiveActivity()\n    }\n}\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## 단계 3 — 라이브 활동 초기화\n\n라이브 활동과 상호 작용하는 데는 ActivityKit API를 사용해야 합니다.\n\n먼저, ActivityContent의 생성자인 init(state:staleDate:relevanceScore:)를 사용하여 라이브 활동의 초기 내용을 만들어야 합니다.\n\n- state: 라이브 활동에 대한 초기 ActivityAttributes.ContentState입니다.\n- staleDate: 라이브 활동이 오래되었음을 OS에 알리기 위한 날짜입니다. staleDate가 지정되지 않으면, 8시간 후 OS가 라이브 활동을 종료합니다.\n- relevanceScore: 여러 개의 라이브 활동이 있는 경우, relevanceScore는 다이나믹 아일랜드에 표시할 우선순위와 잠금 화면의 순서를 나타냅니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n그럼 Activity 메서드 request(attributes: content: pushType:)를 호출하여 새로운 라이브 액티비티를 요청할 수 있어요.\n\n- attributes: Step 1에서 생성한 ActivityAttributes의 인스턴스입니다.\n- content: 라이브 액티비티의 초기 콘텐츠입니다.\n- pushType: 라이브 액티비티의 업데이트가 ActivityKit 푸시 알림에서 올 것인지를 나타냅니다. 업데이트 기능만 사용할 경우에는 nil을 전달할 수 있어요.\n\n📣 중요한 알림: 새로운 Activity를 요청할 때 앱은 활성화 상태여야 해요.\n\n```js\nlet orderAttributes = OrderAttributes(orderNumber: 1)\nlet initialState = OrderAttributes.ContentState(status: .inQueue)\nlet content = ActivityContent(state: initialState, staleDate: nil, relevanceScore: 1.0)\n\ndo {\n    let orderActivity = try Activity.request(\n        attributes: orderAttributes,\n        content: content,\n        pushType: nil\n    )\n} catch {\n    print(error.localizedDescription)\n}\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## 단계 4 — 라이브 활동 업데이트\n\n라이브 활동을 업데이트하려면 update(\\_:) 함수를 사용할 수 있습니다. 초기 상태를 생성한 것과 마찬가지로 업데이트로 ActivityContent를 작성할 수 있습니다.\n\n```js\nawait orderActivity?.update(\n    ActivityContent\u003cOrderAttributes.ContentState\u003e(\n        state: state,\n        staleDate: nil\n    )\n)\n```\n\n라이브 활동을 종료하려면 end(\\_:dismissalPolicy:) 함수를 사용합니다. 사용하는 종료 정책에 따라 라이브 활동은 사용자가 명시적으로 제거할 때까지 잠금 화면에 남게될 수 있습니다. 이것이 마지막 라이브 활동 상태를 전달하여 UI를 항상 최신 상태로 유지해야하는 이유입니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n사용 가능한 해제 정책 옵션은 세 가지입니다.\n\n- default: 라이브 액티비티는 최대 4시간 동안 잠금 화면에 유지됩니다. (사용자가 제거할 때까지)\n- immediate: 운영 체제가 즉시 라이브 액티비티를 제거합니다.\n- after(\\_ date:): 라이브 액티비티를 해제할 날짜를 지정할 수 있습니다. (라이브 액티비티 종료 시간으로부터 4시간 이내여야 함)\n\n# 다음 단계는 무엇인가요?\n\n앱의 사용 사례를 신중하게 고려해보세요. 라이브 액티비티는 배송 앱이나 스포츠 이벤트와 같은 실시간 애플리케이션에 특히 적합하지만, 푸시 알림에 대한 매력적인 대안으로도 사용될 수 있어 사용자에게 더 매력적인 경험을 제공할 수 있습니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n더 풍부한 사용자 경험을 위해 라이브 활동에 딥 링크를 통합하여 사용자가 라이브 활동을 탭할 때 연결이 원활하도록 할 수 있습니다.\n\n질문이 있으시면 언제든지 메시지 남겨주세요! 🙂\n\n- 🤓 iOS 개발 팁과 통찰을 정기적으로 제공하는 제 트위터에 참여해보세요.\n- 🚀 나의 예제 프로젝트를 모두 공유하는 GitHub를 확인해보세요.\n","ogImage":{"url":"/assets/img/2024-06-22-AddLiveActivitiestoyouriOSappin4steps_0.png"},"coverImage":"/assets/img/2024-06-22-AddLiveActivitiestoyouriOSappin4steps_0.png","tag":["Tech"],"readingTime":9},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003ch2\u003eiOS에서 라이브 액티비티로 사용자 경험과 실시간 상호작용 향상\u003c/h2\u003e\n\u003cp\u003e이미 라이브 액티비티를 앱에 통합하지 않았다면, 이제 강력한 잠재력을 고려해보는 것이 좋습니다.\u003c/p\u003e\n\u003cp\u003e라이브 액티비티는 호환되는 아이폰의 잠금 화면과 다이나믹 아일랜드에 자연스럽게 나타나는 전용 UI로, 이 기능을 활용하면 사용자가 앱의 주요 부분을 벗어나도 사용자와 상호작용을 유지할 수 있습니다.\u003c/p\u003e\n\u003cp\u003e푸시 알림을 보내지 않고 업데이트를 보내거나 실시간 정보를 표시할 수 있습니다. 그리고 가장 좋은 점은? 이를 추가하는 것이 놀랍도록 쉽습니다.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e여기에 그것을 하는 방법이 있어요.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-22-AddLiveActivitiestoyouriOSappin4steps_0.png\" alt=\"image1\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://miro.medium.com/v2/resize:fit:460/1*RqsG45Gbo625UNKcIUElTQ.gif\" alt=\"image2\"\u003e\u003c/p\u003e\n\u003ch2\u003e단계1 — 라이브 활동 콘텐츠 정의\u003c/h2\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e가장 처음으로 할 일은 라이브 활동에서 보여줄 정보를 정의하는 것입니다. 제한된 공간 때문에 사용자가 중요하게 생각할 데이터에 집중해야 합니다.\u003c/p\u003e\n\u003cp\u003e그 생각을 기억하고 다음으로 할 일은 ActivityAttributes 프로토콜을 구현하는 것입니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003epublic protocol \u003cspan class=\"hljs-title class_\"\u003eActivityAttributes\u003c/span\u003e : \u003cspan class=\"hljs-title class_\"\u003eDecodable\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eEncodable\u003c/span\u003e {\n\n    \u003cspan class=\"hljs-comment\"\u003e/// 라이브 활동의 동적 콘텐츠를 설명하는 연관 타입.\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e///\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e/// `ContentState`로 인코딩된 라이브 활동의 동적 데이터는 4KB를 초과할 수 없습니다.\u003c/span\u003e\n    associatedtype \u003cspan class=\"hljs-title class_\"\u003eContentState\u003c/span\u003e : \u003cspan class=\"hljs-title class_\"\u003eDecodable\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eEncodable\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eHashable\u003c/span\u003e\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e알 수 있듯이, 우리는 정보를 두 가지 범주로 나눌 수 있습니다:\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cul\u003e\n\u003cli\u003e정적 → ActivityAttributes를 구현하는 모델의 속성입니다.\u003c/li\u003e\n\u003cli\u003e동적 → ContentState 타입에 저장됩니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e우리 경우에는 다음과 같이 정보를 정리할 수 있습니다:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e정적 → 주문 번호입니다. 사용자가 주문을 하면 번호가 바뀌지 않습니다.\u003c/li\u003e\n\u003cli\u003e동적 → 주문 상태로, 주문의 현재 단계를 나타냅니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003estruct \u003cspan class=\"hljs-title class_\"\u003eOrderAttributes\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eActivityAttributes\u003c/span\u003e {\n\n    struct \u003cspan class=\"hljs-title class_\"\u003eContentState\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eCodable\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eHashable\u003c/span\u003e {\n        enum \u003cspan class=\"hljs-title class_\"\u003eOrderStatus\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eFloat\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eCodable\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eHashable\u003c/span\u003e {\n            \u003cspan class=\"hljs-keyword\"\u003ecase\u003c/span\u003e inQueue = \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n            \u003cspan class=\"hljs-keyword\"\u003ecase\u003c/span\u003e aboutToTake\n            \u003cspan class=\"hljs-keyword\"\u003ecase\u003c/span\u003e making\n            \u003cspan class=\"hljs-keyword\"\u003ecase\u003c/span\u003e ready\n\n            \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003edescription\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eString\u003c/span\u003e {\n                \u003cspan class=\"hljs-keyword\"\u003eswitch\u003c/span\u003e self {\n                \u003cspan class=\"hljs-keyword\"\u003ecase\u003c/span\u003e .\u003cspan class=\"hljs-property\"\u003einQueue\u003c/span\u003e:\n                    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"주문이 대기 중입니다\"\u003c/span\u003e\n                \u003cspan class=\"hljs-keyword\"\u003ecase\u003c/span\u003e .\u003cspan class=\"hljs-property\"\u003eaboutToTake\u003c/span\u003e:\n                    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"주문을 받을 준비 중입니다\"\u003c/span\u003e\n                \u003cspan class=\"hljs-keyword\"\u003ecase\u003c/span\u003e .\u003cspan class=\"hljs-property\"\u003emaking\u003c/span\u003e:\n                    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"주문을 준비 중입니다\"\u003c/span\u003e\n                \u003cspan class=\"hljs-keyword\"\u003ecase\u003c/span\u003e .\u003cspan class=\"hljs-property\"\u003eready\u003c/span\u003e:\n                    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"주문이 수령 가능합니다!\"\u003c/span\u003e\n                }\n            }\n        }\n\n        \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003estatus\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eOrderStatus\u003c/span\u003e\n    }\n\n    \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eorderNumber\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eInt\u003c/span\u003e\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch2\u003e단계 2 — UI 생성하기\u003c/h2\u003e\n\u003cp\u003e라이브 활동 UI는 앱의 위젯 범위에 있습니다. 따라서 앱에 위젯 확장 기능이 없는 경우, 먼저 하나를 생성해야 합니다.\u003c/p\u003e\n\u003cp\u003e새로운 위젯 뷰를 생성하고 위젯 구현에서 ActivityConfiguration의 인스턴스를 반환합니다. 이전 단계에서 만든 ActivityAttributes 모델을 사용해야 합니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003estruct \u003cspan class=\"hljs-title class_\"\u003eCoffeeShopWidgetLiveActivity\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eWidget\u003c/span\u003e {\n\n    \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ebody\u003c/span\u003e: some \u003cspan class=\"hljs-title class_\"\u003eWidgetConfiguration\u003c/span\u003e {\n        \u003cspan class=\"hljs-title class_\"\u003eActivityConfiguration\u003c/span\u003e(\u003cspan class=\"hljs-attr\"\u003efor\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eOrderAttributes\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eself\u003c/span\u003e) { context \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e\n            \u003cspan class=\"hljs-comment\"\u003e// 여기에 잠금 화면/배너 UI가 들어갑니다\u003c/span\u003e\n            \u003cspan class=\"hljs-title class_\"\u003eLiveActivityView\u003c/span\u003e(\u003cspan class=\"hljs-attr\"\u003estate\u003c/span\u003e: context.\u003cspan class=\"hljs-property\"\u003estate\u003c/span\u003e)\n        } \u003cspan class=\"hljs-attr\"\u003edynamicIsland\u003c/span\u003e: { context \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e\n            \u003cspan class=\"hljs-comment\"\u003e// 동적 아일랜드 구현이 이곳에 들어갑니다\u003c/span\u003e\n            \u003cspan class=\"hljs-comment\"\u003e// 이 기사의 범위를 벗어난 내용입니다\u003c/span\u003e\n             ...\n        }\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eLiveActivityView 내에서는 Live Activity UI를 구성합니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003estruct \u003cspan class=\"hljs-title class_\"\u003eLiveActivityView\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eView\u003c/span\u003e {\n    \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003estate\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eOrderAttributes\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eContentState\u003c/span\u003e\n\n    \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ebody\u003c/span\u003e: some \u003cspan class=\"hljs-title class_\"\u003eView\u003c/span\u003e {\n        \u003cspan class=\"hljs-title class_\"\u003eVStack\u003c/span\u003e {\n            \u003cspan class=\"hljs-title class_\"\u003eHStack\u003c/span\u003e {\n                \u003cspan class=\"hljs-title class_\"\u003eImage\u003c/span\u003e(\u003cspan class=\"hljs-attr\"\u003esystemName\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"cup.and.saucer\"\u003c/span\u003e)\n                \u003cspan class=\"hljs-title class_\"\u003eProgressView\u003c/span\u003e(\u003cspan class=\"hljs-attr\"\u003evalue\u003c/span\u003e: state.\u003cspan class=\"hljs-property\"\u003estatus\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003erawValue\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003etotal\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e)\n                    .\u003cspan class=\"hljs-title function_\"\u003etint\u003c/span\u003e(.\u003cspan class=\"hljs-property\"\u003eblack\u003c/span\u003e)\n                    .\u003cspan class=\"hljs-title function_\"\u003ebackground\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eColor\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ebrown\u003c/span\u003e)\n                \u003cspan class=\"hljs-title class_\"\u003eImage\u003c/span\u003e(\u003cspan class=\"hljs-attr\"\u003esystemName\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"cup.and.saucer.fill\"\u003c/span\u003e)\n            }\n            .\u003cspan class=\"hljs-title function_\"\u003epadding\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e)\n\n            \u003cspan class=\"hljs-title class_\"\u003eText\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"\\(state.status.description)\"\u003c/span\u003e)\n                .\u003cspan class=\"hljs-title function_\"\u003efont\u003c/span\u003e(.\u003cspan class=\"hljs-title function_\"\u003esystem\u003c/span\u003e(\u003cspan class=\"hljs-attr\"\u003esize\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e18\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eweight\u003c/span\u003e: .\u003cspan class=\"hljs-property\"\u003esemibold\u003c/span\u003e))\n                .\u003cspan class=\"hljs-title function_\"\u003epadding\u003c/span\u003e(.\u003cspan class=\"hljs-property\"\u003ebottom\u003c/span\u003e)\n            \u003cspan class=\"hljs-title class_\"\u003eSpacer\u003c/span\u003e()\n        }\n        .\u003cspan class=\"hljs-title function_\"\u003ebackground\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eColor\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ebrown\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eopacity\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e0.6\u003c/span\u003e))\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e마지막으로, Live Activity 위젯을 위한 위젯 번들에 추가해야 합니다. 이 경우, 위젯을 제공하지 않을 것이므로 Live Activity만 사용합니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e@main\nstruct \u003cspan class=\"hljs-title class_\"\u003eCoffeeShopWidgetBundle\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eWidgetBundle\u003c/span\u003e {\n    \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ebody\u003c/span\u003e: some \u003cspan class=\"hljs-title class_\"\u003eWidget\u003c/span\u003e {\n        \u003cspan class=\"hljs-title class_\"\u003eCoffeeShopWidgetLiveActivity\u003c/span\u003e()\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch2\u003e단계 3 — 라이브 활동 초기화\u003c/h2\u003e\n\u003cp\u003e라이브 활동과 상호 작용하는 데는 ActivityKit API를 사용해야 합니다.\u003c/p\u003e\n\u003cp\u003e먼저, ActivityContent의 생성자인 init(state:staleDate:relevanceScore:)를 사용하여 라이브 활동의 초기 내용을 만들어야 합니다.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003estate: 라이브 활동에 대한 초기 ActivityAttributes.ContentState입니다.\u003c/li\u003e\n\u003cli\u003estaleDate: 라이브 활동이 오래되었음을 OS에 알리기 위한 날짜입니다. staleDate가 지정되지 않으면, 8시간 후 OS가 라이브 활동을 종료합니다.\u003c/li\u003e\n\u003cli\u003erelevanceScore: 여러 개의 라이브 활동이 있는 경우, relevanceScore는 다이나믹 아일랜드에 표시할 우선순위와 잠금 화면의 순서를 나타냅니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e그럼 Activity 메서드 request(attributes: content: pushType:)를 호출하여 새로운 라이브 액티비티를 요청할 수 있어요.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eattributes: Step 1에서 생성한 ActivityAttributes의 인스턴스입니다.\u003c/li\u003e\n\u003cli\u003econtent: 라이브 액티비티의 초기 콘텐츠입니다.\u003c/li\u003e\n\u003cli\u003epushType: 라이브 액티비티의 업데이트가 ActivityKit 푸시 알림에서 올 것인지를 나타냅니다. 업데이트 기능만 사용할 경우에는 nil을 전달할 수 있어요.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e📣 중요한 알림: 새로운 Activity를 요청할 때 앱은 활성화 상태여야 해요.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e orderAttributes = \u003cspan class=\"hljs-title class_\"\u003eOrderAttributes\u003c/span\u003e(\u003cspan class=\"hljs-attr\"\u003eorderNumber\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n\u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e initialState = \u003cspan class=\"hljs-title class_\"\u003eOrderAttributes\u003c/span\u003e.\u003cspan class=\"hljs-title class_\"\u003eContentState\u003c/span\u003e(\u003cspan class=\"hljs-attr\"\u003estatus\u003c/span\u003e: .\u003cspan class=\"hljs-property\"\u003einQueue\u003c/span\u003e)\n\u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e content = \u003cspan class=\"hljs-title class_\"\u003eActivityContent\u003c/span\u003e(\u003cspan class=\"hljs-attr\"\u003estate\u003c/span\u003e: initialState, \u003cspan class=\"hljs-attr\"\u003estaleDate\u003c/span\u003e: nil, \u003cspan class=\"hljs-attr\"\u003erelevanceScore\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1.0\u003c/span\u003e)\n\n\u003cspan class=\"hljs-keyword\"\u003edo\u003c/span\u003e {\n    \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e orderActivity = \u003cspan class=\"hljs-keyword\"\u003etry\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eActivity\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003erequest\u003c/span\u003e(\n        \u003cspan class=\"hljs-attr\"\u003eattributes\u003c/span\u003e: orderAttributes,\n        \u003cspan class=\"hljs-attr\"\u003econtent\u003c/span\u003e: content,\n        \u003cspan class=\"hljs-attr\"\u003epushType\u003c/span\u003e: nil\n    )\n} \u003cspan class=\"hljs-keyword\"\u003ecatch\u003c/span\u003e {\n    \u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(error.\u003cspan class=\"hljs-property\"\u003elocalizedDescription\u003c/span\u003e)\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch2\u003e단계 4 — 라이브 활동 업데이트\u003c/h2\u003e\n\u003cp\u003e라이브 활동을 업데이트하려면 update(_:) 함수를 사용할 수 있습니다. 초기 상태를 생성한 것과 마찬가지로 업데이트로 ActivityContent를 작성할 수 있습니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e orderActivity?.\u003cspan class=\"hljs-title function_\"\u003eupdate\u003c/span\u003e(\n    \u003cspan class=\"hljs-title class_\"\u003eActivityContent\u003c/span\u003e\u0026#x3C;\u003cspan class=\"hljs-title class_\"\u003eOrderAttributes\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eContentState\u003c/span\u003e\u003e(\n        \u003cspan class=\"hljs-attr\"\u003estate\u003c/span\u003e: state,\n        \u003cspan class=\"hljs-attr\"\u003estaleDate\u003c/span\u003e: nil\n    )\n)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e라이브 활동을 종료하려면 end(_:dismissalPolicy:) 함수를 사용합니다. 사용하는 종료 정책에 따라 라이브 활동은 사용자가 명시적으로 제거할 때까지 잠금 화면에 남게될 수 있습니다. 이것이 마지막 라이브 활동 상태를 전달하여 UI를 항상 최신 상태로 유지해야하는 이유입니다.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e사용 가능한 해제 정책 옵션은 세 가지입니다.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003edefault: 라이브 액티비티는 최대 4시간 동안 잠금 화면에 유지됩니다. (사용자가 제거할 때까지)\u003c/li\u003e\n\u003cli\u003eimmediate: 운영 체제가 즉시 라이브 액티비티를 제거합니다.\u003c/li\u003e\n\u003cli\u003eafter(_ date:): 라이브 액티비티를 해제할 날짜를 지정할 수 있습니다. (라이브 액티비티 종료 시간으로부터 4시간 이내여야 함)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1\u003e다음 단계는 무엇인가요?\u003c/h1\u003e\n\u003cp\u003e앱의 사용 사례를 신중하게 고려해보세요. 라이브 액티비티는 배송 앱이나 스포츠 이벤트와 같은 실시간 애플리케이션에 특히 적합하지만, 푸시 알림에 대한 매력적인 대안으로도 사용될 수 있어 사용자에게 더 매력적인 경험을 제공할 수 있습니다.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e더 풍부한 사용자 경험을 위해 라이브 활동에 딥 링크를 통합하여 사용자가 라이브 활동을 탭할 때 연결이 원활하도록 할 수 있습니다.\u003c/p\u003e\n\u003cp\u003e질문이 있으시면 언제든지 메시지 남겨주세요! 🙂\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e🤓 iOS 개발 팁과 통찰을 정기적으로 제공하는 제 트위터에 참여해보세요.\u003c/li\u003e\n\u003cli\u003e🚀 나의 예제 프로젝트를 모두 공유하는 GitHub를 확인해보세요.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-06-22-AddLiveActivitiestoyouriOSappin4steps"},"buildId":"T_Nz0g9U1yttYMSEma95P","isFallback":false,"gsp":true,"scriptLoader":[{"async":true,"src":"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4877378276818686","strategy":"lazyOnload","crossOrigin":"anonymous"}]}</script></body></html>