<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>AWS에서 Terraform을 사용하여 Lambda 함수를 배포하는 방법 | ui-station</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://ui-station.github.io///post/2024-06-19-HowtodeployLambdafunctiononAWSusingTerraform" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="AWS에서 Terraform을 사용하여 Lambda 함수를 배포하는 방법 | ui-station" data-gatsby-head="true"/><meta property="og:title" content="AWS에서 Terraform을 사용하여 Lambda 함수를 배포하는 방법 | ui-station" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-06-19-HowtodeployLambdafunctiononAWSusingTerraform_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://ui-station.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://ui-station.github.io///post/2024-06-19-HowtodeployLambdafunctiononAWSusingTerraform" data-gatsby-head="true"/><meta name="twitter:title" content="AWS에서 Terraform을 사용하여 Lambda 함수를 배포하는 방법 | ui-station" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-06-19-HowtodeployLambdafunctiononAWSusingTerraform_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | ui-station" data-gatsby-head="true"/><meta name="article:published_time" content="2024-06-19 12:12" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-BHFR6GTH9P"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
          
            gtag('config', 'G-BHFR6GTH9P');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b8ef307c9aee1e34.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b8ef307c9aee1e34.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-4a646156c659a948.js" defer=""></script><script src="/_next/static/chunks/348-d11c34b645b13f5b.js" defer=""></script><script src="/_next/static/chunks/162-4172e84c8e2aa747.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-4f7b40c1114f0d09.js" defer=""></script><script src="/_next/static/YUMR4jSyk_WlOHHc7UfOk/_buildManifest.js" defer=""></script><script src="/_next/static/YUMR4jSyk_WlOHHc7UfOk/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">UI STATION</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">AWS에서 Terraform을 사용하여 Lambda 함수를 배포하는 방법</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="AWS에서 Terraform을 사용하여 Lambda 함수를 배포하는 방법" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">UI STATION</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On Jun 19, 2024</span><span class="posts_reading_time__f7YPP">14<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-06-19-HowtodeployLambdafunctiononAWSusingTerraform&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<p>서버리스 함수는 인프라 걱정 할 필요 없이 DevOps 및 SysOps에게 필수적입니다.</p>
<p>우리는 Amazon Web Services (AWS) 람다 함수를 살펴보고, 어떻게 테라폼을 사용하여 AWS 람다를 배포할 수 있는지 알아볼 것입니다.</p>
<p><img src="/assets/img/2024-06-19-HowtodeployLambdafunctiononAWSusingTerraform_0.png" alt="이미지"></p>
<p>모든 자료에 대한 Github 링크: <a href="https://github.com/batuhan-bulut/terraform-aws-lambda" rel="nofollow" target="_blank">https://github.com/batuhan-bulut/terraform-aws-lambda</a></p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h1>AWS Lambda란 무엇인가요?</h1>
<p>AWS Lambda를 사용하면 서버에 대해 걱정하지 않고 지원되는 언어로 스크립트를 실행할 수 있습니다. Node.JS, Python, C# 등으로 작성된 코드를 실행할 수 있습니다.</p>
<p>Lambda를 사용하면 다음을 수행할 수 있습니다.</p>
<ul>
<li>지역별 EC2 인스턴스 상태 확인</li>
<li>AWS CLI를 사용하여 일부 자동화 실행</li>
<li>AWS SQS로 작업 예약</li>
<li>기타</li>
</ul>
<p>이런 가능성들로 AWS Lambda는 데브옵스 및 시스옵스 팀에 매우 중요한 역할을 합니다.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>AWS 웹 사이트에서 GUI를 사용하여 AWS Lambda를 쉽게 배포할 수 있어요.</p>
<p>여러 계정이 있고 동일한 Lambda를 다른 지역에 배포해야 한다면 어떻게 할 건가요? 하나씩 Lambda를 배포할까요?</p>
<p>이때 IaC와 Terraform이 게임에 합류해요.</p>
<h1>IaC란? (Infrastructure as Code)</h1>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>IaC를 사용하면 우리는 쉽게 환경 (개발, 테스트, 스테이징, 프로덕션 등)을 설정할 수 있어요. 인기 있는 공급 업체들은 요구 사항에 맞는 CDK(Cloud Development Kit)를 가지고 있어요.</p>
<h2>왜 테라폼이 중요한가요?</h2>
<p>예를 들어, AWS에 앱이 있고 (EC2, RDS, Lambda, SQS 등을 사용하는) 다양한 서비스를 사용한다고 가정해봅시다. AWS CDK로 이 애플리케이션을 쉽게 배포할 수 있어요.</p>
<p>그런데 만약 경영진이 Azure, GCP 또는 다른 클라우드 공급업체로 전환하기로 결정한다면 어떻게 될까요?</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>AWS CDK에 대한 지식 대부분은 중요하지 않아요. 왜냐하면 해당 공급업체가 자체 CDK를 가지고 있거든요.</p>
<p>여기서 Terraform이 우리의 워크플로에 합류하는 곳이에요.</p>
<h1>Terraform이란?</h1>
<p>지식과 경험을 통해 Terraform을 사용하면 간단한 명령어로 많은 리소스를 관리할 수 있어요.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>이 문서에서는 Terraform의 AWS 쪽에 중점을 둘 것입니다.</p>
<h1>불이 켜지면, 카메라 맞춰, 액션!</h1>
<p>주의하세요: 이 작업은 AWS 측에 비용을 발생시킬 수 있습니다.</p>
<h2>우리의 Terraform 코드는 무엇을 할까요?</h2>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<ul>
<li>IAM 역할 제공</li>
<li>IAM 프로필 제공</li>
<li>프로필에 IAM 정책 부착</li>
<li>업로드용 ZIP 파일 생성</li>
<li>람다 함수 생성</li>
</ul>
<p>이 문서에서는 하드코딩된 값 대신 변수를 사용할 것입니다. 이렇게 하면 다양한 설정으로 동일한 스크립트를 실행할 수 있습니다.</p>
<p>이것은 우리의 terraform/main.tf 파일입니다. 우리 코드의 구조를 담고 있습니다.</p>
<pre><code class="hljs language-js">provider <span class="hljs-string">"aws"</span> {
  region = <span class="hljs-keyword">var</span>.<span class="hljs-property">region</span>
}

# <span class="hljs-variable constant_">AWS</span> <span class="hljs-title class_">Lambda</span>를 위한 <span class="hljs-variable constant_">IAM</span> 역할
resource <span class="hljs-string">"aws_iam_role"</span> <span class="hljs-string">"terraform_lambda_iam_role"</span> {
name               = <span class="hljs-keyword">var</span>.<span class="hljs-property">terraform_lambda_iam_role</span>.<span class="hljs-property">name</span>
assume_role_policy = <span class="hljs-keyword">var</span>.<span class="hljs-property">terraform_lambda_iam_role</span>.<span class="hljs-property">assume_role_policy</span>
}

# 람다를 위한 새로운 정책 생성
resource <span class="hljs-string">"aws_iam_policy"</span> <span class="hljs-string">"iam_policy_for_lambda"</span> {
name         = <span class="hljs-string">"iam_policy_${var.terraform_lambda_iam_role.name}"</span>
description  = <span class="hljs-keyword">var</span>.<span class="hljs-property">iam_policy_for_lambda</span>.<span class="hljs-property">description</span>
policy       = <span class="hljs-keyword">var</span>.<span class="hljs-property">iam_policy_for_lambda</span>.<span class="hljs-property">policy</span>
}

# <span class="hljs-variable constant_">IAM</span> 정책을 <span class="hljs-variable constant_">IAM</span> 역할에 부착
resource <span class="hljs-string">"aws_iam_role_policy_attachment"</span> <span class="hljs-string">"attach_iam_policy_to_iam_role"</span> {
role        = aws_iam_role.<span class="hljs-property">terraform_lambda_iam_role</span>.<span class="hljs-property">name</span>
policy_arn  = aws_iam_policy.<span class="hljs-property">iam_policy_for_lambda</span>.<span class="hljs-property">arn</span>
}

# <span class="hljs-title class_">Lambda</span>에 업로드할 <span class="hljs-variable constant_">ZIP</span> 파일 생성
data <span class="hljs-string">"archive_file"</span> <span class="hljs-string">"zip_python_lambda_code"</span> {
type        = <span class="hljs-string">"zip"</span>
output_path = <span class="hljs-string">"${path.module}/python/${var.zip_python_lambda_code.name}.zip"</span>
source_file = <span class="hljs-string">"${path.module}/../${var.zip_python_lambda_code.name}.py"</span>
}

# <span class="hljs-title class_">Lambda</span> 함수 생성
resource <span class="hljs-string">"aws_lambda_function"</span> <span class="hljs-string">"terraform_lambda"</span> {
filename     = <span class="hljs-string">"${path.module}/python/${var.zip_python_lambda_code.name}.zip"</span>
function_name  = <span class="hljs-keyword">var</span>.<span class="hljs-property">terraform_lambda</span>.<span class="hljs-property">name</span>
role        = aws_iam_role.<span class="hljs-property">terraform_lambda_iam_role</span>.<span class="hljs-property">arn</span>
runtime     = <span class="hljs-keyword">var</span>.<span class="hljs-property">terraform_lambda</span>.<span class="hljs-property">runtime</span>
handler     = <span class="hljs-string">"${var.zip_python_lambda_code.name}.lambda_handler"</span>
}
</code></pre>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>이 코드 블록에서는 terraform/terraform.tf 파일에서 모든 변수를 읽습니다. 동일한 Terraform 파일을 프로덕션, 스테이징 또는 다른 AWS 지역과 같이 다른 환경에 대해 다양한 구성으로 실행할 수 있습니다.</p>
<p>이 변수들을 읽기 위해서는 변수를 정의해야 합니다. “.tf” 파일을 사용하여 변수를 선언할 수 있습니다.</p>
<p>위 코드에 대한 terraform.tf 파일이 다음과 같이 보입니다.</p>
<pre><code class="hljs language-js">변수 <span class="hljs-string">"region"</span> {
  type = string
  설명 = <span class="hljs-string">"AWS 지역"</span>
  기본 = <span class="hljs-string">"eu-central-1"</span>
}

변수 <span class="hljs-string">"zip_python_lambda_code"</span> {
  type = <span class="hljs-title function_">map</span>(string)
  설명 = <span class="hljs-string">"Python 파일의 이름"</span>
  기본 = {
    name = <span class="hljs-string">"index"</span>
  }
}

변수 <span class="hljs-string">"terraform_lambda_iam_role"</span> {
  type = <span class="hljs-title function_">map</span>(string)
  설명 = <span class="hljs-string">"aws_iam_role - terraform_lambda_iam_role 변수"</span>
  기본 = {
    name = <span class="hljs-string">"Lambda-from-terraform"</span>
    assume_role_policy = &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
{
 <span class="hljs-string">"Version"</span>: <span class="hljs-string">"2012-10-17"</span>,
 <span class="hljs-string">"Statement"</span>: [
   {
     <span class="hljs-string">"Action"</span>: <span class="hljs-string">"sts:AssumeRole"</span>,
     <span class="hljs-string">"Principal"</span>: {
       <span class="hljs-string">"Service"</span>: <span class="hljs-string">"lambda.amazonaws.com"</span>
     },
     <span class="hljs-string">"Effect"</span>: <span class="hljs-string">"Allow"</span>,
     <span class="hljs-string">"Sid"</span>: <span class="hljs-string">""</span>
   }
 ]
}
<span class="hljs-variable constant_">EOF</span>
  }
}

변수 <span class="hljs-string">"iam_policy_for_lambda"</span> {
  type = <span class="hljs-title function_">map</span>(string)
  설명 = <span class="hljs-string">"람다를 위한 IAM 정책"</span>
  기본 = {
    description = <span class="hljs-string">"Terraform으로 생성된 IAM 정책"</span>
    policy = &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
{
 <span class="hljs-string">"Version"</span>: <span class="hljs-string">"2012-10-17"</span>,
 <span class="hljs-string">"Statement"</span>: [
   {
     <span class="hljs-string">"Action"</span>: [
       <span class="hljs-string">"logs:CreateLogGroup"</span>,
       <span class="hljs-string">"logs:CreateLogStream"</span>,
       <span class="hljs-string">"logs:PutLogEvents"</span>
     ],
     <span class="hljs-string">"Resource"</span>: <span class="hljs-string">"arn:aws:logs:*:*:*"</span>,
     <span class="hljs-string">"Effect"</span>: <span class="hljs-string">"Allow"</span>
   }
 ]
}
<span class="hljs-variable constant_">EOF</span>
  }
}

변수 <span class="hljs-string">"terraform_lambda"</span> {
  type = <span class="hljs-title function_">map</span>(string)
  설명 = <span class="hljs-string">"람다를 위한 변수"</span>
  기본 = {
    name = <span class="hljs-string">"Lambda_Terraform"</span>
    runtime = <span class="hljs-string">"python3.12"</span>
    handler = <span class="hljs-string">"index.lambda_handler"</span>
  }
}
</code></pre>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>이 파일에서는 변수와 그 기본 값들을 선언합니다. 테라폼에서는 다양한 유형의 변수를 선언할 수 있어요.</p>
<p>더 많은 정보를 원하신다면 테라폼 문서를 확인해보세요.</p>
<p>코드에 기본 값을 사용하고 싶지 않다면 기본 변수를 덮어쓸 terraform/vars.tfvars 파일을 추가할 수도 있어요. 이 파일의 내용은 일반적으로 "key = value" 형식입니다.</p>
<p>여기 .tfvars 파일의 예시가 있어요.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-js">region = <span class="hljs-string">"us-east-1"</span>

terraform_lambda= {
    name = <span class="hljs-string">"Override_Name"</span>
    runtime = <span class="hljs-string">"python3.9"</span>
    handler = <span class="hljs-string">"override.lambda_handler"</span>
}
</code></pre>
<p>이렇게 하면 Terraform이 region 및 terraform_lambda 변수의 기본값을 재정의할 것입니다.</p>
<p>참고: 이 예와 같이 terraform_lambda와 같은 객체에서 변수를 변경하려면 객체의 모든 변수를 전달해야 합니다. 그렇지 않으면 오류가 발생합니다.</p>
<p>그리고 루트 폴더에 간단한 Python 앱을 index.py라는 이름으로 추가해보세요.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-js"># 간단한 <span class="hljs-title class_">Hello</span> 함수
<span class="hljs-keyword">import</span> json

def <span class="hljs-title function_">lambda_handler</span>(event, context):
    <span class="hljs-keyword">return</span> {
        <span class="hljs-string">'statusCode'</span>: <span class="hljs-number">200</span>,
        <span class="hljs-string">'body'</span>: json.<span class="hljs-title function_">dumps</span>(<span class="hljs-string">'Lambda에서 안녕하세요!'</span>)
    }
</code></pre>
<p>다음은 폴더가 보이는 예시입니다</p>
<img src="/assets/img/2024-06-19-HowtodeployLambdafunctiononAWSusingTerraform_1.png">
<h1>쇼타임!</h1>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>코드를 실행할 준비가 되었습니다.</p>
<p>먼저 테라폼 구성 파일이 포함된 작업 디렉터리를 초기화하기 위해 terraform init 명령을 실행해야 합니다.</p>
<pre><code class="hljs language-js">$terraform init

백엔드 초기화 중...

공급자 플러그인 초기화 중...
- 이전 의존성 락 파일에서 hashicorp/aws의 이전 버전 재사용 중
- 이전 의존성 락 파일에서 hashicorp/archive의 이전 버전 재사용 중
- 이전에 설치한 hashicorp/aws v5<span class="hljs-number">.54</span><span class="hljs-number">.1</span> 사용 중
- 이전에 설치한 hashicorp/archive v2<span class="hljs-number">.4</span><span class="hljs-number">.2</span> 사용 중

테라폼이 성공적으로 초기화되었습니다!

이제 테라폼을 사용할 수 있습니다. 인프라에 필요한 변경 사항을 볼려면 <span class="hljs-string">"terraform plan"</span>을 실행해보세요. 이제 모든 테라폼 명령이 작동해야 합니다.

테라폼의 모듈 또는 백엔드 구성을 설정하거나 변경한 경우, 작업 디렉터리를 다시 초기화하려면이 명령을 다시 실행하십시오. 잊어버릴 경우 다른 명령어가 감지하여 필요시 상기시켜줄 것입니다.
</code></pre>
<p>이후, 인프라 구조의 변경 사항을 확인하기 위해 terraform plan을 실행할 수 있습니다.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-js">data.<span class="hljs-property">archive_file</span>.<span class="hljs-property">zip_python_lambda_code</span>: 읽는 중...
data.<span class="hljs-property">archive_file</span>.<span class="hljs-property">zip_python_lambda_code</span>: 읽기 완료 소요 시간 <span class="hljs-number">0</span>초 [id=<span class="hljs-number">111</span>]

테라폼은 선택한 공급업체를 사용하여 다음 실행 계획을 생성했습니다. 자원 작업은 다음 기호로 표시됩니다:
  + 생성

테라폼은 다음 작업을 수행할 것입니다:

  # aws_iam_policy.<span class="hljs-property">iam_policy_for_lambda</span>가 생성됩니다
  + resource <span class="hljs-string">"aws_iam_policy"</span> <span class="hljs-string">"iam_policy_for_lambda"</span> {
      + arn              = (적용 후 알려짐)
      + attachment_count = (적용 후 알려짐)
      + description      = <span class="hljs-string">"테라폼에 의해 생성된 IAM 정책"</span>
      + id               = (적용 후 알려짐)
      + name             = <span class="hljs-string">"iam_policy_Lambda-from-terraform"</span>
      + name_prefix      = (적용 후 알려짐)
      + path             = <span class="hljs-string">"/"</span>
      + policy           = <span class="hljs-title function_">jsonencode</span>(
            {
              + <span class="hljs-title class_">Statement</span> = [
                  + {
                      + <span class="hljs-title class_">Action</span>   = [
                          + <span class="hljs-string">"logs:CreateLogGroup"</span>,
                          + <span class="hljs-string">"logs:CreateLogStream"</span>,
                          + <span class="hljs-string">"logs:PutLogEvents"</span>,
                        ]
                      + <span class="hljs-title class_">Effect</span>   = <span class="hljs-string">"Allow"</span>
                      + <span class="hljs-title class_">Resource</span> = <span class="hljs-string">"arn:aws:logs:*:*:*"</span>
                    },
                ]
              + <span class="hljs-title class_">Version</span>   = <span class="hljs-string">"2012-10-17"</span>
            }
        )
      + policy_id        = (적용 후 알려짐)
      + tags_all         = (적용 후 알려짐)
    }

  # aws_iam_role.<span class="hljs-property">terraform_lambda_iam_role</span>가 생성됩니다
  + resource <span class="hljs-string">"aws_iam_role"</span> <span class="hljs-string">"terraform_lambda_iam_role"</span> {
      + arn                   = (적용 후 알려짐)
      + assume_role_policy    = <span class="hljs-title function_">jsonencode</span>(
            {
              + <span class="hljs-title class_">Statement</span> = [
                  + {
                      + <span class="hljs-title class_">Action</span>    = <span class="hljs-string">"sts:AssumeRole"</span>
                      + <span class="hljs-title class_">Effect</span>    = <span class="hljs-string">"Allow"</span>
                      + <span class="hljs-title class_">Principal</span> = {
                          + <span class="hljs-title class_">Service</span> = <span class="hljs-string">"lambda.amazonaws.com"</span>
                        }
                      + <span class="hljs-title class_">Sid</span>       = <span class="hljs-string">""</span>
                    },
                ]
              + <span class="hljs-title class_">Version</span>   = <span class="hljs-string">"2012-10-17"</span>
            }
        )
      + create_date           = (적용 후 알려짐)
      + force_detach_policies = <span class="hljs-literal">false</span>
      + id                    = (적용 후 알려짐)
      + managed_policy_arns   = (적용 후 알려짐)
      + max_session_duration  = <span class="hljs-number">3600</span>
      + name                  = <span class="hljs-string">"Lambda-from-terraform"</span>
      + name_prefix           = (적용 후 알려짐)
      + path                  = <span class="hljs-string">"/"</span>
      + tags_all              = (적용 후 알려짐)
      + unique_id             = (적용 후 알려짐)
    }

  # aws_iam_role_policy_attachment.<span class="hljs-property">attach_iam_policy_to_iam_role</span> 생성됩니다
  + resource <span class="hljs-string">"aws_iam_role_policy_attachment"</span> <span class="hljs-string">"attach_iam_policy_to_iam_role"</span> {
      + id         = (적용 후 알려짐)
      + policy_arn = (적용 후 알려짐)
      + role       = <span class="hljs-string">"Lambda-from-terraform"</span>
    }

  # aws_lambda_function.<span class="hljs-property">terraform_lambda</span> 생성됩니다
  + resource <span class="hljs-string">"aws_lambda_function"</span> <span class="hljs-string">"terraform_lambda"</span> {
      + architectures                  = (적용 후 알려짐)
      + arn                            = (적용 후 알려짐)
      + code_sha256                    = (적용 후 알려짐)
      + filename                       = <span class="hljs-string">"./python/index.zip"</span>
      + function_name                  = <span class="hljs-string">"Override_Name"</span>
      + handler                        = <span class="hljs-string">"index.lambda_handler"</span>
      + id                             = (적용 후 알려짐)
      + invoke_arn                     = (적용 후 알려짐)
      + last_modified                  = (적용 후 알려짐)
      + memory_size                    = <span class="hljs-number">128</span>
      + package_type                   = <span class="hljs-string">"Zip"</span>
      + publish                        = <span class="hljs-literal">false</span>
      + qualified_arn                  = (적용 후 알려짐)
      + qualified_invoke_arn           = (적용 후 알려짐)
      + reserved_concurrent_executions = -<span class="hljs-number">1</span>
      + role                           = (적용 후 알려짐)
      + runtime                        = <span class="hljs-string">"python3.9"</span>
      + signing_job_arn                = (적용 후 알려짐)
      + signing_profile_version_arn    = (적용 후 알려짐)
      + skip_destroy                   = <span class="hljs-literal">false</span>
      + source_code_hash               = (적용 후 알려짐)
      + source_code_size               = (적용 후 알려짐)
      + tags_all                       = (적용 후 알려짐)
      + timeout                        = <span class="hljs-number">3</span>
      + version                        = (적용 후 알려짐)
    }

계획: <span class="hljs-number">4</span>개 추가, <span class="hljs-number">0</span>개 변경, <span class="hljs-number">0</span>개 제거.

앞서 설명한 변경 사항을 적용시키기 위해 terraform apply를 실행할 수 있습니다.

그 후 콘솔에 성공 메시지가 표시될 것입니다. 이는 모든 리소스가 <span class="hljs-variable constant_">AWS</span> 측에 생성된 것을 의미합니다. <span class="hljs-variable constant_">AWS</span> <span class="hljs-variable constant_">GUI</span>에서 람다 함수를 확인하고 실행하거나 <span class="hljs-variable constant_">CLI</span>에서 람다 함수를 확인할 수 있습니다.

aws lambda list-functions --region us-east-<span class="hljs-number">1</span> | grep <span class="hljs-title class_">Override</span>_Name

<span class="hljs-string">"FunctionName"</span>: <span class="hljs-string">"Override_Name"</span>,
<span class="hljs-string">"FunctionArn"</span>: <span class="hljs-string">"arn:aws:lambda:us-east-1:11111:function:Override_Name"</span>,
<span class="hljs-string">"LogGroup"</span>: <span class="hljs-string">"/aws/lambda/Override_Name"</span>
</code></pre>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"AWS에서 Terraform을 사용하여 Lambda 함수를 배포하는 방법","description":"","date":"2024-06-19 12:12","slug":"2024-06-19-HowtodeployLambdafunctiononAWSusingTerraform","content":"\n서버리스 함수는 인프라 걱정 할 필요 없이 DevOps 및 SysOps에게 필수적입니다.\n\n우리는 Amazon Web Services (AWS) 람다 함수를 살펴보고, 어떻게 테라폼을 사용하여 AWS 람다를 배포할 수 있는지 알아볼 것입니다.\n\n![이미지](/assets/img/2024-06-19-HowtodeployLambdafunctiononAWSusingTerraform_0.png)\n\n모든 자료에 대한 Github 링크: [https://github.com/batuhan-bulut/terraform-aws-lambda](https://github.com/batuhan-bulut/terraform-aws-lambda)\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n# AWS Lambda란 무엇인가요?\n\nAWS Lambda를 사용하면 서버에 대해 걱정하지 않고 지원되는 언어로 스크립트를 실행할 수 있습니다. Node.JS, Python, C# 등으로 작성된 코드를 실행할 수 있습니다.\n\nLambda를 사용하면 다음을 수행할 수 있습니다.\n\n- 지역별 EC2 인스턴스 상태 확인\n- AWS CLI를 사용하여 일부 자동화 실행\n- AWS SQS로 작업 예약\n- 기타\n\n이런 가능성들로 AWS Lambda는 데브옵스 및 시스옵스 팀에 매우 중요한 역할을 합니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nAWS 웹 사이트에서 GUI를 사용하여 AWS Lambda를 쉽게 배포할 수 있어요.\n\n여러 계정이 있고 동일한 Lambda를 다른 지역에 배포해야 한다면 어떻게 할 건가요? 하나씩 Lambda를 배포할까요?\n\n이때 IaC와 Terraform이 게임에 합류해요.\n\n# IaC란? (Infrastructure as Code)\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nIaC를 사용하면 우리는 쉽게 환경 (개발, 테스트, 스테이징, 프로덕션 등)을 설정할 수 있어요. 인기 있는 공급 업체들은 요구 사항에 맞는 CDK(Cloud Development Kit)를 가지고 있어요.\n\n## 왜 테라폼이 중요한가요?\n\n예를 들어, AWS에 앱이 있고 (EC2, RDS, Lambda, SQS 등을 사용하는) 다양한 서비스를 사용한다고 가정해봅시다. AWS CDK로 이 애플리케이션을 쉽게 배포할 수 있어요.\n\n그런데 만약 경영진이 Azure, GCP 또는 다른 클라우드 공급업체로 전환하기로 결정한다면 어떻게 될까요?\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nAWS CDK에 대한 지식 대부분은 중요하지 않아요. 왜냐하면 해당 공급업체가 자체 CDK를 가지고 있거든요.\n\n여기서 Terraform이 우리의 워크플로에 합류하는 곳이에요.\n\n# Terraform이란?\n\n지식과 경험을 통해 Terraform을 사용하면 간단한 명령어로 많은 리소스를 관리할 수 있어요.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n이 문서에서는 Terraform의 AWS 쪽에 중점을 둘 것입니다.\n\n# 불이 켜지면, 카메라 맞춰, 액션!\n\n주의하세요: 이 작업은 AWS 측에 비용을 발생시킬 수 있습니다.\n\n## 우리의 Terraform 코드는 무엇을 할까요?\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n- IAM 역할 제공\n- IAM 프로필 제공\n- 프로필에 IAM 정책 부착\n- 업로드용 ZIP 파일 생성\n- 람다 함수 생성\n\n이 문서에서는 하드코딩된 값 대신 변수를 사용할 것입니다. 이렇게 하면 다양한 설정으로 동일한 스크립트를 실행할 수 있습니다.\n\n이것은 우리의 terraform/main.tf 파일입니다. 우리 코드의 구조를 담고 있습니다.\n\n```js\nprovider \"aws\" {\n  region = var.region\n}\n\n# AWS Lambda를 위한 IAM 역할\nresource \"aws_iam_role\" \"terraform_lambda_iam_role\" {\nname               = var.terraform_lambda_iam_role.name\nassume_role_policy = var.terraform_lambda_iam_role.assume_role_policy\n}\n\n# 람다를 위한 새로운 정책 생성\nresource \"aws_iam_policy\" \"iam_policy_for_lambda\" {\nname         = \"iam_policy_${var.terraform_lambda_iam_role.name}\"\ndescription  = var.iam_policy_for_lambda.description\npolicy       = var.iam_policy_for_lambda.policy\n}\n\n# IAM 정책을 IAM 역할에 부착\nresource \"aws_iam_role_policy_attachment\" \"attach_iam_policy_to_iam_role\" {\nrole        = aws_iam_role.terraform_lambda_iam_role.name\npolicy_arn  = aws_iam_policy.iam_policy_for_lambda.arn\n}\n\n# Lambda에 업로드할 ZIP 파일 생성\ndata \"archive_file\" \"zip_python_lambda_code\" {\ntype        = \"zip\"\noutput_path = \"${path.module}/python/${var.zip_python_lambda_code.name}.zip\"\nsource_file = \"${path.module}/../${var.zip_python_lambda_code.name}.py\"\n}\n\n# Lambda 함수 생성\nresource \"aws_lambda_function\" \"terraform_lambda\" {\nfilename     = \"${path.module}/python/${var.zip_python_lambda_code.name}.zip\"\nfunction_name  = var.terraform_lambda.name\nrole        = aws_iam_role.terraform_lambda_iam_role.arn\nruntime     = var.terraform_lambda.runtime\nhandler     = \"${var.zip_python_lambda_code.name}.lambda_handler\"\n}\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n이 코드 블록에서는 terraform/terraform.tf 파일에서 모든 변수를 읽습니다. 동일한 Terraform 파일을 프로덕션, 스테이징 또는 다른 AWS 지역과 같이 다른 환경에 대해 다양한 구성으로 실행할 수 있습니다.\n\n이 변수들을 읽기 위해서는 변수를 정의해야 합니다. “.tf” 파일을 사용하여 변수를 선언할 수 있습니다.\n\n위 코드에 대한 terraform.tf 파일이 다음과 같이 보입니다.\n\n```js\n변수 \"region\" {\n  type = string\n  설명 = \"AWS 지역\"\n  기본 = \"eu-central-1\"\n}\n\n변수 \"zip_python_lambda_code\" {\n  type = map(string)\n  설명 = \"Python 파일의 이름\"\n  기본 = {\n    name = \"index\"\n  }\n}\n\n변수 \"terraform_lambda_iam_role\" {\n  type = map(string)\n  설명 = \"aws_iam_role - terraform_lambda_iam_role 변수\"\n  기본 = {\n    name = \"Lambda-from-terraform\"\n    assume_role_policy = \u003c\u003cEOF\n{\n \"Version\": \"2012-10-17\",\n \"Statement\": [\n   {\n     \"Action\": \"sts:AssumeRole\",\n     \"Principal\": {\n       \"Service\": \"lambda.amazonaws.com\"\n     },\n     \"Effect\": \"Allow\",\n     \"Sid\": \"\"\n   }\n ]\n}\nEOF\n  }\n}\n\n변수 \"iam_policy_for_lambda\" {\n  type = map(string)\n  설명 = \"람다를 위한 IAM 정책\"\n  기본 = {\n    description = \"Terraform으로 생성된 IAM 정책\"\n    policy = \u003c\u003cEOF\n{\n \"Version\": \"2012-10-17\",\n \"Statement\": [\n   {\n     \"Action\": [\n       \"logs:CreateLogGroup\",\n       \"logs:CreateLogStream\",\n       \"logs:PutLogEvents\"\n     ],\n     \"Resource\": \"arn:aws:logs:*:*:*\",\n     \"Effect\": \"Allow\"\n   }\n ]\n}\nEOF\n  }\n}\n\n변수 \"terraform_lambda\" {\n  type = map(string)\n  설명 = \"람다를 위한 변수\"\n  기본 = {\n    name = \"Lambda_Terraform\"\n    runtime = \"python3.12\"\n    handler = \"index.lambda_handler\"\n  }\n}\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n이 파일에서는 변수와 그 기본 값들을 선언합니다. 테라폼에서는 다양한 유형의 변수를 선언할 수 있어요.\n\n더 많은 정보를 원하신다면 테라폼 문서를 확인해보세요.\n\n코드에 기본 값을 사용하고 싶지 않다면 기본 변수를 덮어쓸 terraform/vars.tfvars 파일을 추가할 수도 있어요. 이 파일의 내용은 일반적으로 \"key = value\" 형식입니다.\n\n여기 .tfvars 파일의 예시가 있어요.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\nregion = \"us-east-1\"\n\nterraform_lambda= {\n    name = \"Override_Name\"\n    runtime = \"python3.9\"\n    handler = \"override.lambda_handler\"\n}\n```\n\n이렇게 하면 Terraform이 region 및 terraform_lambda 변수의 기본값을 재정의할 것입니다.\n\n참고: 이 예와 같이 terraform_lambda와 같은 객체에서 변수를 변경하려면 객체의 모든 변수를 전달해야 합니다. 그렇지 않으면 오류가 발생합니다.\n\n그리고 루트 폴더에 간단한 Python 앱을 index.py라는 이름으로 추가해보세요.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\n# 간단한 Hello 함수\nimport json\n\ndef lambda_handler(event, context):\n    return {\n        'statusCode': 200,\n        'body': json.dumps('Lambda에서 안녕하세요!')\n    }\n```\n\n다음은 폴더가 보이는 예시입니다\n\n\u003cimg src=\"/assets/img/2024-06-19-HowtodeployLambdafunctiononAWSusingTerraform_1.png\" /\u003e\n\n# 쇼타임!\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n코드를 실행할 준비가 되었습니다.\n\n먼저 테라폼 구성 파일이 포함된 작업 디렉터리를 초기화하기 위해 terraform init 명령을 실행해야 합니다.\n\n```js\n$terraform init\n\n백엔드 초기화 중...\n\n공급자 플러그인 초기화 중...\n- 이전 의존성 락 파일에서 hashicorp/aws의 이전 버전 재사용 중\n- 이전 의존성 락 파일에서 hashicorp/archive의 이전 버전 재사용 중\n- 이전에 설치한 hashicorp/aws v5.54.1 사용 중\n- 이전에 설치한 hashicorp/archive v2.4.2 사용 중\n\n테라폼이 성공적으로 초기화되었습니다!\n\n이제 테라폼을 사용할 수 있습니다. 인프라에 필요한 변경 사항을 볼려면 \"terraform plan\"을 실행해보세요. 이제 모든 테라폼 명령이 작동해야 합니다.\n\n테라폼의 모듈 또는 백엔드 구성을 설정하거나 변경한 경우, 작업 디렉터리를 다시 초기화하려면이 명령을 다시 실행하십시오. 잊어버릴 경우 다른 명령어가 감지하여 필요시 상기시켜줄 것입니다.\n```\n\n이후, 인프라 구조의 변경 사항을 확인하기 위해 terraform plan을 실행할 수 있습니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\ndata.archive_file.zip_python_lambda_code: 읽는 중...\ndata.archive_file.zip_python_lambda_code: 읽기 완료 소요 시간 0초 [id=111]\n\n테라폼은 선택한 공급업체를 사용하여 다음 실행 계획을 생성했습니다. 자원 작업은 다음 기호로 표시됩니다:\n  + 생성\n\n테라폼은 다음 작업을 수행할 것입니다:\n\n  # aws_iam_policy.iam_policy_for_lambda가 생성됩니다\n  + resource \"aws_iam_policy\" \"iam_policy_for_lambda\" {\n      + arn              = (적용 후 알려짐)\n      + attachment_count = (적용 후 알려짐)\n      + description      = \"테라폼에 의해 생성된 IAM 정책\"\n      + id               = (적용 후 알려짐)\n      + name             = \"iam_policy_Lambda-from-terraform\"\n      + name_prefix      = (적용 후 알려짐)\n      + path             = \"/\"\n      + policy           = jsonencode(\n            {\n              + Statement = [\n                  + {\n                      + Action   = [\n                          + \"logs:CreateLogGroup\",\n                          + \"logs:CreateLogStream\",\n                          + \"logs:PutLogEvents\",\n                        ]\n                      + Effect   = \"Allow\"\n                      + Resource = \"arn:aws:logs:*:*:*\"\n                    },\n                ]\n              + Version   = \"2012-10-17\"\n            }\n        )\n      + policy_id        = (적용 후 알려짐)\n      + tags_all         = (적용 후 알려짐)\n    }\n\n  # aws_iam_role.terraform_lambda_iam_role가 생성됩니다\n  + resource \"aws_iam_role\" \"terraform_lambda_iam_role\" {\n      + arn                   = (적용 후 알려짐)\n      + assume_role_policy    = jsonencode(\n            {\n              + Statement = [\n                  + {\n                      + Action    = \"sts:AssumeRole\"\n                      + Effect    = \"Allow\"\n                      + Principal = {\n                          + Service = \"lambda.amazonaws.com\"\n                        }\n                      + Sid       = \"\"\n                    },\n                ]\n              + Version   = \"2012-10-17\"\n            }\n        )\n      + create_date           = (적용 후 알려짐)\n      + force_detach_policies = false\n      + id                    = (적용 후 알려짐)\n      + managed_policy_arns   = (적용 후 알려짐)\n      + max_session_duration  = 3600\n      + name                  = \"Lambda-from-terraform\"\n      + name_prefix           = (적용 후 알려짐)\n      + path                  = \"/\"\n      + tags_all              = (적용 후 알려짐)\n      + unique_id             = (적용 후 알려짐)\n    }\n\n  # aws_iam_role_policy_attachment.attach_iam_policy_to_iam_role 생성됩니다\n  + resource \"aws_iam_role_policy_attachment\" \"attach_iam_policy_to_iam_role\" {\n      + id         = (적용 후 알려짐)\n      + policy_arn = (적용 후 알려짐)\n      + role       = \"Lambda-from-terraform\"\n    }\n\n  # aws_lambda_function.terraform_lambda 생성됩니다\n  + resource \"aws_lambda_function\" \"terraform_lambda\" {\n      + architectures                  = (적용 후 알려짐)\n      + arn                            = (적용 후 알려짐)\n      + code_sha256                    = (적용 후 알려짐)\n      + filename                       = \"./python/index.zip\"\n      + function_name                  = \"Override_Name\"\n      + handler                        = \"index.lambda_handler\"\n      + id                             = (적용 후 알려짐)\n      + invoke_arn                     = (적용 후 알려짐)\n      + last_modified                  = (적용 후 알려짐)\n      + memory_size                    = 128\n      + package_type                   = \"Zip\"\n      + publish                        = false\n      + qualified_arn                  = (적용 후 알려짐)\n      + qualified_invoke_arn           = (적용 후 알려짐)\n      + reserved_concurrent_executions = -1\n      + role                           = (적용 후 알려짐)\n      + runtime                        = \"python3.9\"\n      + signing_job_arn                = (적용 후 알려짐)\n      + signing_profile_version_arn    = (적용 후 알려짐)\n      + skip_destroy                   = false\n      + source_code_hash               = (적용 후 알려짐)\n      + source_code_size               = (적용 후 알려짐)\n      + tags_all                       = (적용 후 알려짐)\n      + timeout                        = 3\n      + version                        = (적용 후 알려짐)\n    }\n\n계획: 4개 추가, 0개 변경, 0개 제거.\n\n앞서 설명한 변경 사항을 적용시키기 위해 terraform apply를 실행할 수 있습니다.\n\n그 후 콘솔에 성공 메시지가 표시될 것입니다. 이는 모든 리소스가 AWS 측에 생성된 것을 의미합니다. AWS GUI에서 람다 함수를 확인하고 실행하거나 CLI에서 람다 함수를 확인할 수 있습니다.\n\naws lambda list-functions --region us-east-1 | grep Override_Name\n\n\"FunctionName\": \"Override_Name\",\n\"FunctionArn\": \"arn:aws:lambda:us-east-1:11111:function:Override_Name\",\n\"LogGroup\": \"/aws/lambda/Override_Name\"\n```\n","ogImage":{"url":"/assets/img/2024-06-19-HowtodeployLambdafunctiononAWSusingTerraform_0.png"},"coverImage":"/assets/img/2024-06-19-HowtodeployLambdafunctiononAWSusingTerraform_0.png","tag":["Tech"],"readingTime":14},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cp\u003e서버리스 함수는 인프라 걱정 할 필요 없이 DevOps 및 SysOps에게 필수적입니다.\u003c/p\u003e\n\u003cp\u003e우리는 Amazon Web Services (AWS) 람다 함수를 살펴보고, 어떻게 테라폼을 사용하여 AWS 람다를 배포할 수 있는지 알아볼 것입니다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-19-HowtodeployLambdafunctiononAWSusingTerraform_0.png\" alt=\"이미지\"\u003e\u003c/p\u003e\n\u003cp\u003e모든 자료에 대한 Github 링크: \u003ca href=\"https://github.com/batuhan-bulut/terraform-aws-lambda\" rel=\"nofollow\" target=\"_blank\"\u003ehttps://github.com/batuhan-bulut/terraform-aws-lambda\u003c/a\u003e\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch1\u003eAWS Lambda란 무엇인가요?\u003c/h1\u003e\n\u003cp\u003eAWS Lambda를 사용하면 서버에 대해 걱정하지 않고 지원되는 언어로 스크립트를 실행할 수 있습니다. Node.JS, Python, C# 등으로 작성된 코드를 실행할 수 있습니다.\u003c/p\u003e\n\u003cp\u003eLambda를 사용하면 다음을 수행할 수 있습니다.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e지역별 EC2 인스턴스 상태 확인\u003c/li\u003e\n\u003cli\u003eAWS CLI를 사용하여 일부 자동화 실행\u003c/li\u003e\n\u003cli\u003eAWS SQS로 작업 예약\u003c/li\u003e\n\u003cli\u003e기타\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e이런 가능성들로 AWS Lambda는 데브옵스 및 시스옵스 팀에 매우 중요한 역할을 합니다.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eAWS 웹 사이트에서 GUI를 사용하여 AWS Lambda를 쉽게 배포할 수 있어요.\u003c/p\u003e\n\u003cp\u003e여러 계정이 있고 동일한 Lambda를 다른 지역에 배포해야 한다면 어떻게 할 건가요? 하나씩 Lambda를 배포할까요?\u003c/p\u003e\n\u003cp\u003e이때 IaC와 Terraform이 게임에 합류해요.\u003c/p\u003e\n\u003ch1\u003eIaC란? (Infrastructure as Code)\u003c/h1\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eIaC를 사용하면 우리는 쉽게 환경 (개발, 테스트, 스테이징, 프로덕션 등)을 설정할 수 있어요. 인기 있는 공급 업체들은 요구 사항에 맞는 CDK(Cloud Development Kit)를 가지고 있어요.\u003c/p\u003e\n\u003ch2\u003e왜 테라폼이 중요한가요?\u003c/h2\u003e\n\u003cp\u003e예를 들어, AWS에 앱이 있고 (EC2, RDS, Lambda, SQS 등을 사용하는) 다양한 서비스를 사용한다고 가정해봅시다. AWS CDK로 이 애플리케이션을 쉽게 배포할 수 있어요.\u003c/p\u003e\n\u003cp\u003e그런데 만약 경영진이 Azure, GCP 또는 다른 클라우드 공급업체로 전환하기로 결정한다면 어떻게 될까요?\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eAWS CDK에 대한 지식 대부분은 중요하지 않아요. 왜냐하면 해당 공급업체가 자체 CDK를 가지고 있거든요.\u003c/p\u003e\n\u003cp\u003e여기서 Terraform이 우리의 워크플로에 합류하는 곳이에요.\u003c/p\u003e\n\u003ch1\u003eTerraform이란?\u003c/h1\u003e\n\u003cp\u003e지식과 경험을 통해 Terraform을 사용하면 간단한 명령어로 많은 리소스를 관리할 수 있어요.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e이 문서에서는 Terraform의 AWS 쪽에 중점을 둘 것입니다.\u003c/p\u003e\n\u003ch1\u003e불이 켜지면, 카메라 맞춰, 액션!\u003c/h1\u003e\n\u003cp\u003e주의하세요: 이 작업은 AWS 측에 비용을 발생시킬 수 있습니다.\u003c/p\u003e\n\u003ch2\u003e우리의 Terraform 코드는 무엇을 할까요?\u003c/h2\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cul\u003e\n\u003cli\u003eIAM 역할 제공\u003c/li\u003e\n\u003cli\u003eIAM 프로필 제공\u003c/li\u003e\n\u003cli\u003e프로필에 IAM 정책 부착\u003c/li\u003e\n\u003cli\u003e업로드용 ZIP 파일 생성\u003c/li\u003e\n\u003cli\u003e람다 함수 생성\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e이 문서에서는 하드코딩된 값 대신 변수를 사용할 것입니다. 이렇게 하면 다양한 설정으로 동일한 스크립트를 실행할 수 있습니다.\u003c/p\u003e\n\u003cp\u003e이것은 우리의 terraform/main.tf 파일입니다. 우리 코드의 구조를 담고 있습니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eprovider \u003cspan class=\"hljs-string\"\u003e\"aws\"\u003c/span\u003e {\n  region = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eregion\u003c/span\u003e\n}\n\n# \u003cspan class=\"hljs-variable constant_\"\u003eAWS\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eLambda\u003c/span\u003e를 위한 \u003cspan class=\"hljs-variable constant_\"\u003eIAM\u003c/span\u003e 역할\nresource \u003cspan class=\"hljs-string\"\u003e\"aws_iam_role\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"terraform_lambda_iam_role\"\u003c/span\u003e {\nname               = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eterraform_lambda_iam_role\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ename\u003c/span\u003e\nassume_role_policy = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eterraform_lambda_iam_role\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eassume_role_policy\u003c/span\u003e\n}\n\n# 람다를 위한 새로운 정책 생성\nresource \u003cspan class=\"hljs-string\"\u003e\"aws_iam_policy\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"iam_policy_for_lambda\"\u003c/span\u003e {\nname         = \u003cspan class=\"hljs-string\"\u003e\"iam_policy_${var.terraform_lambda_iam_role.name}\"\u003c/span\u003e\ndescription  = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eiam_policy_for_lambda\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003edescription\u003c/span\u003e\npolicy       = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eiam_policy_for_lambda\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003epolicy\u003c/span\u003e\n}\n\n# \u003cspan class=\"hljs-variable constant_\"\u003eIAM\u003c/span\u003e 정책을 \u003cspan class=\"hljs-variable constant_\"\u003eIAM\u003c/span\u003e 역할에 부착\nresource \u003cspan class=\"hljs-string\"\u003e\"aws_iam_role_policy_attachment\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"attach_iam_policy_to_iam_role\"\u003c/span\u003e {\nrole        = aws_iam_role.\u003cspan class=\"hljs-property\"\u003eterraform_lambda_iam_role\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ename\u003c/span\u003e\npolicy_arn  = aws_iam_policy.\u003cspan class=\"hljs-property\"\u003eiam_policy_for_lambda\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003earn\u003c/span\u003e\n}\n\n# \u003cspan class=\"hljs-title class_\"\u003eLambda\u003c/span\u003e에 업로드할 \u003cspan class=\"hljs-variable constant_\"\u003eZIP\u003c/span\u003e 파일 생성\ndata \u003cspan class=\"hljs-string\"\u003e\"archive_file\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"zip_python_lambda_code\"\u003c/span\u003e {\ntype        = \u003cspan class=\"hljs-string\"\u003e\"zip\"\u003c/span\u003e\noutput_path = \u003cspan class=\"hljs-string\"\u003e\"${path.module}/python/${var.zip_python_lambda_code.name}.zip\"\u003c/span\u003e\nsource_file = \u003cspan class=\"hljs-string\"\u003e\"${path.module}/../${var.zip_python_lambda_code.name}.py\"\u003c/span\u003e\n}\n\n# \u003cspan class=\"hljs-title class_\"\u003eLambda\u003c/span\u003e 함수 생성\nresource \u003cspan class=\"hljs-string\"\u003e\"aws_lambda_function\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"terraform_lambda\"\u003c/span\u003e {\nfilename     = \u003cspan class=\"hljs-string\"\u003e\"${path.module}/python/${var.zip_python_lambda_code.name}.zip\"\u003c/span\u003e\nfunction_name  = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eterraform_lambda\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ename\u003c/span\u003e\nrole        = aws_iam_role.\u003cspan class=\"hljs-property\"\u003eterraform_lambda_iam_role\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003earn\u003c/span\u003e\nruntime     = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eterraform_lambda\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eruntime\u003c/span\u003e\nhandler     = \u003cspan class=\"hljs-string\"\u003e\"${var.zip_python_lambda_code.name}.lambda_handler\"\u003c/span\u003e\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e이 코드 블록에서는 terraform/terraform.tf 파일에서 모든 변수를 읽습니다. 동일한 Terraform 파일을 프로덕션, 스테이징 또는 다른 AWS 지역과 같이 다른 환경에 대해 다양한 구성으로 실행할 수 있습니다.\u003c/p\u003e\n\u003cp\u003e이 변수들을 읽기 위해서는 변수를 정의해야 합니다. “.tf” 파일을 사용하여 변수를 선언할 수 있습니다.\u003c/p\u003e\n\u003cp\u003e위 코드에 대한 terraform.tf 파일이 다음과 같이 보입니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e변수 \u003cspan class=\"hljs-string\"\u003e\"region\"\u003c/span\u003e {\n  type = string\n  설명 = \u003cspan class=\"hljs-string\"\u003e\"AWS 지역\"\u003c/span\u003e\n  기본 = \u003cspan class=\"hljs-string\"\u003e\"eu-central-1\"\u003c/span\u003e\n}\n\n변수 \u003cspan class=\"hljs-string\"\u003e\"zip_python_lambda_code\"\u003c/span\u003e {\n  type = \u003cspan class=\"hljs-title function_\"\u003emap\u003c/span\u003e(string)\n  설명 = \u003cspan class=\"hljs-string\"\u003e\"Python 파일의 이름\"\u003c/span\u003e\n  기본 = {\n    name = \u003cspan class=\"hljs-string\"\u003e\"index\"\u003c/span\u003e\n  }\n}\n\n변수 \u003cspan class=\"hljs-string\"\u003e\"terraform_lambda_iam_role\"\u003c/span\u003e {\n  type = \u003cspan class=\"hljs-title function_\"\u003emap\u003c/span\u003e(string)\n  설명 = \u003cspan class=\"hljs-string\"\u003e\"aws_iam_role - terraform_lambda_iam_role 변수\"\u003c/span\u003e\n  기본 = {\n    name = \u003cspan class=\"hljs-string\"\u003e\"Lambda-from-terraform\"\u003c/span\u003e\n    assume_role_policy = \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n{\n \u003cspan class=\"hljs-string\"\u003e\"Version\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"2012-10-17\"\u003c/span\u003e,\n \u003cspan class=\"hljs-string\"\u003e\"Statement\"\u003c/span\u003e: [\n   {\n     \u003cspan class=\"hljs-string\"\u003e\"Action\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"sts:AssumeRole\"\u003c/span\u003e,\n     \u003cspan class=\"hljs-string\"\u003e\"Principal\"\u003c/span\u003e: {\n       \u003cspan class=\"hljs-string\"\u003e\"Service\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"lambda.amazonaws.com\"\u003c/span\u003e\n     },\n     \u003cspan class=\"hljs-string\"\u003e\"Effect\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"Allow\"\u003c/span\u003e,\n     \u003cspan class=\"hljs-string\"\u003e\"Sid\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\n   }\n ]\n}\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n  }\n}\n\n변수 \u003cspan class=\"hljs-string\"\u003e\"iam_policy_for_lambda\"\u003c/span\u003e {\n  type = \u003cspan class=\"hljs-title function_\"\u003emap\u003c/span\u003e(string)\n  설명 = \u003cspan class=\"hljs-string\"\u003e\"람다를 위한 IAM 정책\"\u003c/span\u003e\n  기본 = {\n    description = \u003cspan class=\"hljs-string\"\u003e\"Terraform으로 생성된 IAM 정책\"\u003c/span\u003e\n    policy = \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n{\n \u003cspan class=\"hljs-string\"\u003e\"Version\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"2012-10-17\"\u003c/span\u003e,\n \u003cspan class=\"hljs-string\"\u003e\"Statement\"\u003c/span\u003e: [\n   {\n     \u003cspan class=\"hljs-string\"\u003e\"Action\"\u003c/span\u003e: [\n       \u003cspan class=\"hljs-string\"\u003e\"logs:CreateLogGroup\"\u003c/span\u003e,\n       \u003cspan class=\"hljs-string\"\u003e\"logs:CreateLogStream\"\u003c/span\u003e,\n       \u003cspan class=\"hljs-string\"\u003e\"logs:PutLogEvents\"\u003c/span\u003e\n     ],\n     \u003cspan class=\"hljs-string\"\u003e\"Resource\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"arn:aws:logs:*:*:*\"\u003c/span\u003e,\n     \u003cspan class=\"hljs-string\"\u003e\"Effect\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"Allow\"\u003c/span\u003e\n   }\n ]\n}\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n  }\n}\n\n변수 \u003cspan class=\"hljs-string\"\u003e\"terraform_lambda\"\u003c/span\u003e {\n  type = \u003cspan class=\"hljs-title function_\"\u003emap\u003c/span\u003e(string)\n  설명 = \u003cspan class=\"hljs-string\"\u003e\"람다를 위한 변수\"\u003c/span\u003e\n  기본 = {\n    name = \u003cspan class=\"hljs-string\"\u003e\"Lambda_Terraform\"\u003c/span\u003e\n    runtime = \u003cspan class=\"hljs-string\"\u003e\"python3.12\"\u003c/span\u003e\n    handler = \u003cspan class=\"hljs-string\"\u003e\"index.lambda_handler\"\u003c/span\u003e\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e이 파일에서는 변수와 그 기본 값들을 선언합니다. 테라폼에서는 다양한 유형의 변수를 선언할 수 있어요.\u003c/p\u003e\n\u003cp\u003e더 많은 정보를 원하신다면 테라폼 문서를 확인해보세요.\u003c/p\u003e\n\u003cp\u003e코드에 기본 값을 사용하고 싶지 않다면 기본 변수를 덮어쓸 terraform/vars.tfvars 파일을 추가할 수도 있어요. 이 파일의 내용은 일반적으로 \"key = value\" 형식입니다.\u003c/p\u003e\n\u003cp\u003e여기 .tfvars 파일의 예시가 있어요.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eregion = \u003cspan class=\"hljs-string\"\u003e\"us-east-1\"\u003c/span\u003e\n\nterraform_lambda= {\n    name = \u003cspan class=\"hljs-string\"\u003e\"Override_Name\"\u003c/span\u003e\n    runtime = \u003cspan class=\"hljs-string\"\u003e\"python3.9\"\u003c/span\u003e\n    handler = \u003cspan class=\"hljs-string\"\u003e\"override.lambda_handler\"\u003c/span\u003e\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e이렇게 하면 Terraform이 region 및 terraform_lambda 변수의 기본값을 재정의할 것입니다.\u003c/p\u003e\n\u003cp\u003e참고: 이 예와 같이 terraform_lambda와 같은 객체에서 변수를 변경하려면 객체의 모든 변수를 전달해야 합니다. 그렇지 않으면 오류가 발생합니다.\u003c/p\u003e\n\u003cp\u003e그리고 루트 폴더에 간단한 Python 앱을 index.py라는 이름으로 추가해보세요.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e# 간단한 \u003cspan class=\"hljs-title class_\"\u003eHello\u003c/span\u003e 함수\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e json\n\ndef \u003cspan class=\"hljs-title function_\"\u003elambda_handler\u003c/span\u003e(event, context):\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e {\n        \u003cspan class=\"hljs-string\"\u003e'statusCode'\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e'body'\u003c/span\u003e: json.\u003cspan class=\"hljs-title function_\"\u003edumps\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'Lambda에서 안녕하세요!'\u003c/span\u003e)\n    }\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e다음은 폴더가 보이는 예시입니다\u003c/p\u003e\n\u003cimg src=\"/assets/img/2024-06-19-HowtodeployLambdafunctiononAWSusingTerraform_1.png\"\u003e\n\u003ch1\u003e쇼타임!\u003c/h1\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e코드를 실행할 준비가 되었습니다.\u003c/p\u003e\n\u003cp\u003e먼저 테라폼 구성 파일이 포함된 작업 디렉터리를 초기화하기 위해 terraform init 명령을 실행해야 합니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$terraform init\n\n백엔드 초기화 중...\n\n공급자 플러그인 초기화 중...\n- 이전 의존성 락 파일에서 hashicorp/aws의 이전 버전 재사용 중\n- 이전 의존성 락 파일에서 hashicorp/archive의 이전 버전 재사용 중\n- 이전에 설치한 hashicorp/aws v5\u003cspan class=\"hljs-number\"\u003e.54\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e 사용 중\n- 이전에 설치한 hashicorp/archive v2\u003cspan class=\"hljs-number\"\u003e.4\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.2\u003c/span\u003e 사용 중\n\n테라폼이 성공적으로 초기화되었습니다!\n\n이제 테라폼을 사용할 수 있습니다. 인프라에 필요한 변경 사항을 볼려면 \u003cspan class=\"hljs-string\"\u003e\"terraform plan\"\u003c/span\u003e을 실행해보세요. 이제 모든 테라폼 명령이 작동해야 합니다.\n\n테라폼의 모듈 또는 백엔드 구성을 설정하거나 변경한 경우, 작업 디렉터리를 다시 초기화하려면이 명령을 다시 실행하십시오. 잊어버릴 경우 다른 명령어가 감지하여 필요시 상기시켜줄 것입니다.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e이후, 인프라 구조의 변경 사항을 확인하기 위해 terraform plan을 실행할 수 있습니다.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003edata.\u003cspan class=\"hljs-property\"\u003earchive_file\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ezip_python_lambda_code\u003c/span\u003e: 읽는 중...\ndata.\u003cspan class=\"hljs-property\"\u003earchive_file\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ezip_python_lambda_code\u003c/span\u003e: 읽기 완료 소요 시간 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e초 [id=\u003cspan class=\"hljs-number\"\u003e111\u003c/span\u003e]\n\n테라폼은 선택한 공급업체를 사용하여 다음 실행 계획을 생성했습니다. 자원 작업은 다음 기호로 표시됩니다:\n  + 생성\n\n테라폼은 다음 작업을 수행할 것입니다:\n\n  # aws_iam_policy.\u003cspan class=\"hljs-property\"\u003eiam_policy_for_lambda\u003c/span\u003e가 생성됩니다\n  + resource \u003cspan class=\"hljs-string\"\u003e\"aws_iam_policy\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"iam_policy_for_lambda\"\u003c/span\u003e {\n      + arn              = (적용 후 알려짐)\n      + attachment_count = (적용 후 알려짐)\n      + description      = \u003cspan class=\"hljs-string\"\u003e\"테라폼에 의해 생성된 IAM 정책\"\u003c/span\u003e\n      + id               = (적용 후 알려짐)\n      + name             = \u003cspan class=\"hljs-string\"\u003e\"iam_policy_Lambda-from-terraform\"\u003c/span\u003e\n      + name_prefix      = (적용 후 알려짐)\n      + path             = \u003cspan class=\"hljs-string\"\u003e\"/\"\u003c/span\u003e\n      + policy           = \u003cspan class=\"hljs-title function_\"\u003ejsonencode\u003c/span\u003e(\n            {\n              + \u003cspan class=\"hljs-title class_\"\u003eStatement\u003c/span\u003e = [\n                  + {\n                      + \u003cspan class=\"hljs-title class_\"\u003eAction\u003c/span\u003e   = [\n                          + \u003cspan class=\"hljs-string\"\u003e\"logs:CreateLogGroup\"\u003c/span\u003e,\n                          + \u003cspan class=\"hljs-string\"\u003e\"logs:CreateLogStream\"\u003c/span\u003e,\n                          + \u003cspan class=\"hljs-string\"\u003e\"logs:PutLogEvents\"\u003c/span\u003e,\n                        ]\n                      + \u003cspan class=\"hljs-title class_\"\u003eEffect\u003c/span\u003e   = \u003cspan class=\"hljs-string\"\u003e\"Allow\"\u003c/span\u003e\n                      + \u003cspan class=\"hljs-title class_\"\u003eResource\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"arn:aws:logs:*:*:*\"\u003c/span\u003e\n                    },\n                ]\n              + \u003cspan class=\"hljs-title class_\"\u003eVersion\u003c/span\u003e   = \u003cspan class=\"hljs-string\"\u003e\"2012-10-17\"\u003c/span\u003e\n            }\n        )\n      + policy_id        = (적용 후 알려짐)\n      + tags_all         = (적용 후 알려짐)\n    }\n\n  # aws_iam_role.\u003cspan class=\"hljs-property\"\u003eterraform_lambda_iam_role\u003c/span\u003e가 생성됩니다\n  + resource \u003cspan class=\"hljs-string\"\u003e\"aws_iam_role\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"terraform_lambda_iam_role\"\u003c/span\u003e {\n      + arn                   = (적용 후 알려짐)\n      + assume_role_policy    = \u003cspan class=\"hljs-title function_\"\u003ejsonencode\u003c/span\u003e(\n            {\n              + \u003cspan class=\"hljs-title class_\"\u003eStatement\u003c/span\u003e = [\n                  + {\n                      + \u003cspan class=\"hljs-title class_\"\u003eAction\u003c/span\u003e    = \u003cspan class=\"hljs-string\"\u003e\"sts:AssumeRole\"\u003c/span\u003e\n                      + \u003cspan class=\"hljs-title class_\"\u003eEffect\u003c/span\u003e    = \u003cspan class=\"hljs-string\"\u003e\"Allow\"\u003c/span\u003e\n                      + \u003cspan class=\"hljs-title class_\"\u003ePrincipal\u003c/span\u003e = {\n                          + \u003cspan class=\"hljs-title class_\"\u003eService\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"lambda.amazonaws.com\"\u003c/span\u003e\n                        }\n                      + \u003cspan class=\"hljs-title class_\"\u003eSid\u003c/span\u003e       = \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\n                    },\n                ]\n              + \u003cspan class=\"hljs-title class_\"\u003eVersion\u003c/span\u003e   = \u003cspan class=\"hljs-string\"\u003e\"2012-10-17\"\u003c/span\u003e\n            }\n        )\n      + create_date           = (적용 후 알려짐)\n      + force_detach_policies = \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e\n      + id                    = (적용 후 알려짐)\n      + managed_policy_arns   = (적용 후 알려짐)\n      + max_session_duration  = \u003cspan class=\"hljs-number\"\u003e3600\u003c/span\u003e\n      + name                  = \u003cspan class=\"hljs-string\"\u003e\"Lambda-from-terraform\"\u003c/span\u003e\n      + name_prefix           = (적용 후 알려짐)\n      + path                  = \u003cspan class=\"hljs-string\"\u003e\"/\"\u003c/span\u003e\n      + tags_all              = (적용 후 알려짐)\n      + unique_id             = (적용 후 알려짐)\n    }\n\n  # aws_iam_role_policy_attachment.\u003cspan class=\"hljs-property\"\u003eattach_iam_policy_to_iam_role\u003c/span\u003e 생성됩니다\n  + resource \u003cspan class=\"hljs-string\"\u003e\"aws_iam_role_policy_attachment\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"attach_iam_policy_to_iam_role\"\u003c/span\u003e {\n      + id         = (적용 후 알려짐)\n      + policy_arn = (적용 후 알려짐)\n      + role       = \u003cspan class=\"hljs-string\"\u003e\"Lambda-from-terraform\"\u003c/span\u003e\n    }\n\n  # aws_lambda_function.\u003cspan class=\"hljs-property\"\u003eterraform_lambda\u003c/span\u003e 생성됩니다\n  + resource \u003cspan class=\"hljs-string\"\u003e\"aws_lambda_function\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"terraform_lambda\"\u003c/span\u003e {\n      + architectures                  = (적용 후 알려짐)\n      + arn                            = (적용 후 알려짐)\n      + code_sha256                    = (적용 후 알려짐)\n      + filename                       = \u003cspan class=\"hljs-string\"\u003e\"./python/index.zip\"\u003c/span\u003e\n      + function_name                  = \u003cspan class=\"hljs-string\"\u003e\"Override_Name\"\u003c/span\u003e\n      + handler                        = \u003cspan class=\"hljs-string\"\u003e\"index.lambda_handler\"\u003c/span\u003e\n      + id                             = (적용 후 알려짐)\n      + invoke_arn                     = (적용 후 알려짐)\n      + last_modified                  = (적용 후 알려짐)\n      + memory_size                    = \u003cspan class=\"hljs-number\"\u003e128\u003c/span\u003e\n      + package_type                   = \u003cspan class=\"hljs-string\"\u003e\"Zip\"\u003c/span\u003e\n      + publish                        = \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e\n      + qualified_arn                  = (적용 후 알려짐)\n      + qualified_invoke_arn           = (적용 후 알려짐)\n      + reserved_concurrent_executions = -\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n      + role                           = (적용 후 알려짐)\n      + runtime                        = \u003cspan class=\"hljs-string\"\u003e\"python3.9\"\u003c/span\u003e\n      + signing_job_arn                = (적용 후 알려짐)\n      + signing_profile_version_arn    = (적용 후 알려짐)\n      + skip_destroy                   = \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e\n      + source_code_hash               = (적용 후 알려짐)\n      + source_code_size               = (적용 후 알려짐)\n      + tags_all                       = (적용 후 알려짐)\n      + timeout                        = \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e\n      + version                        = (적용 후 알려짐)\n    }\n\n계획: \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e개 추가, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e개 변경, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e개 제거.\n\n앞서 설명한 변경 사항을 적용시키기 위해 terraform apply를 실행할 수 있습니다.\n\n그 후 콘솔에 성공 메시지가 표시될 것입니다. 이는 모든 리소스가 \u003cspan class=\"hljs-variable constant_\"\u003eAWS\u003c/span\u003e 측에 생성된 것을 의미합니다. \u003cspan class=\"hljs-variable constant_\"\u003eAWS\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eGUI\u003c/span\u003e에서 람다 함수를 확인하고 실행하거나 \u003cspan class=\"hljs-variable constant_\"\u003eCLI\u003c/span\u003e에서 람다 함수를 확인할 수 있습니다.\n\naws lambda list-functions --region us-east-\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e | grep \u003cspan class=\"hljs-title class_\"\u003eOverride\u003c/span\u003e_Name\n\n\u003cspan class=\"hljs-string\"\u003e\"FunctionName\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"Override_Name\"\u003c/span\u003e,\n\u003cspan class=\"hljs-string\"\u003e\"FunctionArn\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"arn:aws:lambda:us-east-1:11111:function:Override_Name\"\u003c/span\u003e,\n\u003cspan class=\"hljs-string\"\u003e\"LogGroup\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"/aws/lambda/Override_Name\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-06-19-HowtodeployLambdafunctiononAWSusingTerraform"},"buildId":"YUMR4jSyk_WlOHHc7UfOk","isFallback":false,"gsp":true,"scriptLoader":[{"async":true,"src":"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4877378276818686","strategy":"lazyOnload","crossOrigin":"anonymous"}]}</script></body></html>