<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>앱에 대한 자부심  안드로이드에서 GraphQL 사용해보기 | ui-station</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://ui-station.github.io///post/2024-06-19-PrideinYourAppTryingOutGraphQLonAndroid" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="앱에 대한 자부심  안드로이드에서 GraphQL 사용해보기 | ui-station" data-gatsby-head="true"/><meta property="og:title" content="앱에 대한 자부심  안드로이드에서 GraphQL 사용해보기 | ui-station" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-06-19-PrideinYourAppTryingOutGraphQLonAndroid_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://ui-station.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://ui-station.github.io///post/2024-06-19-PrideinYourAppTryingOutGraphQLonAndroid" data-gatsby-head="true"/><meta name="twitter:title" content="앱에 대한 자부심  안드로이드에서 GraphQL 사용해보기 | ui-station" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-06-19-PrideinYourAppTryingOutGraphQLonAndroid_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | ui-station" data-gatsby-head="true"/><meta name="article:published_time" content="2024-06-19 10:39" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-BHFR6GTH9P"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
          
            gtag('config', 'G-BHFR6GTH9P');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b8ef307c9aee1e34.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b8ef307c9aee1e34.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-4a646156c659a948.js" defer=""></script><script src="/_next/static/chunks/348-d11c34b645b13f5b.js" defer=""></script><script src="/_next/static/chunks/162-4172e84c8e2aa747.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-4f7b40c1114f0d09.js" defer=""></script><script src="/_next/static/bb_yO9GbCvdfc_n71SfUf/_buildManifest.js" defer=""></script><script src="/_next/static/bb_yO9GbCvdfc_n71SfUf/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">UI STATION</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">앱에 대한 자부심  안드로이드에서 GraphQL 사용해보기</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="앱에 대한 자부심  안드로이드에서 GraphQL 사용해보기" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">UI STATION</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On Jun 19, 2024</span><span class="posts_reading_time__f7YPP">9<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-06-19-PrideinYourAppTryingOutGraphQLonAndroid&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<p><img src="/assets/img/2024-06-19-PrideinYourAppTryingOutGraphQLonAndroid_0.png" alt="이미지"></p>
<p>모두들, 요즘은 프라이드 달이에요! LGBTIQA+ 커뮤니티 구성원으로서, 이번 달은 좋으면서도 스트레스를 받는 시기예요. 누군가 무슨 일을 일으키려 할지 예측할 수 없어요. 이번 달은 정말 몇몇 나쁜 사람들을 끌어모을 것 같아요. 그리고 유럽에서 논할 우파의 급부상까지... 시작도 못하겠네요.</p>
<p>오래전부터 안드로이드에서 GraphQL을 시도해보고 싶어했는데, 이 Pride Flag API를 발견하면서 이제 내가 그때가 된 것 같았어요. API(그리고 GraphQL)를 시도하고 블로그 글을 써서 프라이드를 기념하는 좋은 방법이죠!</p>
<p>GraphQL에 대해 조금 소개하자면: 저는 과거에서 GraphQL에 대해 이야기하며 공개 연설 경력을 시작했어요 (JavaScript도요. 제 밝혀지지 않은 비밀이죠.) 재미있었고 정말 좋았어요. 물론, 어떠한 기술을 사용할지 고려할 때 항상 장단점이 있지만, 그래도 정말 좋아했어요. 어느 밋업에서 "GraphQL에 대해 물어봐주세요"라는 문구가 적힌 티셔츠를 받았는데, 아마 그 저의 가장 멋진 티셔츠였을 거예요.</p>
<p></p>
<p>안녕하세요!</p>
<p>안드로이드로 전환했을 때는 GraphQL을 안드로이드와 통합하는 방법을 배울 필요성을 느끼지 못했어요. 그래서 그동안 시도해보고 싶었는데, 이제야 좋은 방법을 찾아 해볼 기회를 찾았어요. 함께 시작해봐요!</p>
<h1>GraphQL</h1>
<p>GraphQL이라는 단어를 처음 들어보셨다면, 이것은 그래프 형태로 API를 구축하는 쿼리 언어로 대안적인 방법입니다.</p>
<p>GraphQL API를 통해 필요한 것만 요청할 수 있습니다. 그래서 항상 모든 것을 반환하는 REST API와 달리 GraphQL API는 요청한 값만 반환합니다. 그리고 그래프 기반으로 데이터를 중첩하여 하나의 쿼리로 가져올 수 있어요. 예를 들어 작가, 그의 책, 그리고 책 속 캐릭터를 예로 들 수 있는데, REST API에서는 세 번의 요청이 필요하죠 (물론 API에 따라 달라질 수 있어요).</p>
<p></p>
<p>GraphQL은 데이터를 쿼리, 변경 또는 구독하는 세 가지 작업을 제공합니다. REST와 비교하면, 쿼리는 GET 요청과 일치하고, 변경은 데이터를 변경하는 다른 모든 요처과 일치하며, 구독은 양방향으로 작동합니다 - 예를 들어, 웹소켓과 같이요.</p>
<p>이 블로그 포스트의 맥락에서는 데이터를 쿼리할 것입니다. 사용 가능한 작업 및 일반적인 GraphQL에 대해 더 알고 싶다면, GraphQL 문서로 이동하세요.</p>
<p>GraphQL을 사용하기 위해 우리는 Apollo Kotlin(이전 Apollo Android)을 사용할 것입니다. 이 라이브러리는 타입 안전하며 Kotlin 멀티플랫폼과 호환됩니다.</p>
<h1>의존성 및 스키마 가져오기</h1>
<p></p>
<p>Apollo Kotlin을 시작하려면 프로젝트에 몇 가지 종속성을 추가해야 합니다:</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// 프로젝트 수준의 build.gradle.kts</span>

plugins {
  <span class="hljs-title function_">id</span>(<span class="hljs-string">"com.apollographql.apollo3"</span>).<span class="hljs-title function_">version</span>(<span class="hljs-string">"3.8.4"</span>)
}
</code></pre>
<p>그리고</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// 모듈 수준의 build.gradle.kts</span>

dependencies {
  <span class="hljs-title function_">implementation</span>(<span class="hljs-string">"com.apollographql.apollo3:apollo-runtime:3.8.4"</span>)
}
</code></pre>
<p></p>
<p>이 패키지들의 버전 번호는 반드시 동일해야 합니다.</p>
<p>의존성에 추가하여 생성된 모델을 위한 패키지 이름을 추가해야 합니다:</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// module-level build.gradle.kts</span>

apollo {
    <span class="hljs-title function_">service</span>(<span class="hljs-params"><span class="hljs-string">"service"</span></span>) {
        packageName.<span class="hljs-title function_">set</span>(<span class="hljs-string">"com.example"</span>)
    }
}
</code></pre>
<p>많은 프로젝트에서는 그레이들 파일을 동기화하게 됩니다. 그러나 이 프로젝트는 다릅니다; 여전히 GraphQL 쿼리의 스키마가 필요합니다. 여러 옵션이 있지만 외부 API를 통해 스키마를 내려받는 것이 가장 쉽습니다. 스키마를 src/main/graphql에 저장해야 하며, 이 작은 프로젝트의 경우에는 다음 명령어를 사용하여 이 작업을 수행합니다:</p>
<p></p>
<pre><code class="hljs language-js">./gradlew :<span class="hljs-attr">app</span>:downloadApolloSchema --endpoint= <span class="hljs-string">'https://pride.dev/api/graphql'</span> --schema=app/src/main/graphql/schema.<span class="hljs-property">graphqls</span>
</code></pre>
<p>스키마를 얻었다면 Gradle 파일을 동기화하고 데이터 쿼리를 계속합니다.</p>
<h1>데이터 쿼리</h1>
<p>이 작은 앱에서는 데이터를 읽고 싶습니다 — 따라서 GraphQL 용어로는 쿼리하려고 합니다. 모든 속성이 필요하지 않으므로 필요한 것만 포함한 쿼리를 정의합니다:</p>
<p></p>
<pre><code class="hljs language-js">query <span class="hljs-title class_">FlagQuery</span> {
  allFlags {
    name
    year
    svgUrl
  }
}
</code></pre>
<p>Apollo Kotlin을 사용하면 모든 쿼리에 이름이 지정되어 있어야 합니다. 이름이 없는 쿼리가 있으면 오류가 발생할 수 있어요. 믿어요, 제 경험이죠.</p>
<p>이 쿼리는 API에서 사용 가능한 모든 플래그를 가져옵니다. 플래그의 이름, 연도 및 SVG URL이 필요하기 때문에 쿼리에 이러한 속성을 작성합니다.</p>
<p>Android 프로젝트에 쿼리를 추가하려면 먼저 src/main/ 폴더에 파일을 만들어야 합니다. 이 폴더는 스키마가 있는 폴더와 동일합니다. 파일 이름을 FlagQuery.graphql로 지정하고 쿼리를 추가합니다. 앱이 빌드 될 때 자동으로 실행되는 작업을 통해 Apollo는 쿼리에 대한 모델을 생성합니다. 그러니 앱을 빌드하고 나면 쿼리 모델을 사용할 수 있을 거에요.</p>
<p></p>
<p>이 시점에서 AndroidManifest에 인터넷 권한을 추가해야 한다는 것을 상기시키고 싶어요. 그렇게 하지 않으면, 다음 단계가 더 복잡해질 거에요. 믿어줘요, 알아요.</p>
<p>추가해야 하는 내용을 상기시키기 위해 여기에 있어요. 나처럼 검색 엔진을 사용하지 않아도 괜찮아요:</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// AndroidManifest.xml</span>

&#x3C;uses-permission <span class="hljs-attr">android</span>:name=<span class="hljs-string">"android.permission.INTERNET"</span> />
</code></pre>
<p>자, 이제 쿼리가 준비되었는데, 이것을 UI에 어떻게 연결할까요? 답은 GraphQL 클라이언트입니다. 데이터를 쿼리하는 데 사용할 수 있어요. 이 데모를 위해 간단하게 만들고 있으니, GraphQL 클라이언트를 정의하고 데이터를 뷰 모델에서 쿼리할 것이에요. 제작용 앱에서는 아마 레이어 구조가 더 복잡할 거에요.</p>
<p></p>
<p>먼저 클라이언트를 정의합니다:</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// GraphQLClient.kt</span>

<span class="hljs-keyword">const</span> val <span class="hljs-variable constant_">API_ENDPOINT</span> = <span class="hljs-string">"https://pride.dev/api/graphql"</span>

val apolloClient = <span class="hljs-title class_">ApolloClient</span>.<span class="hljs-title class_">Builder</span>()
    .<span class="hljs-title function_">serverUrl</span>(<span class="hljs-variable constant_">API_ENDPOINT</span>)
    .<span class="hljs-title function_">build</span>()
</code></pre>
<p>뷰 모델에서는 먼저 UI에서 사용할 상태를 정의합니다:</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// FlagsViewModel.kt</span>

data <span class="hljs-keyword">class</span> <span class="hljs-title class_">FlagsUiState</span>(
    val <span class="hljs-attr">loading</span>: <span class="hljs-title class_">Boolean</span> = <span class="hljs-literal">true</span>,
    val <span class="hljs-attr">flags</span>: <span class="hljs-title class_">List</span>&#x3C;<span class="hljs-title class_">FlagQuery</span>.<span class="hljs-property">AllFlag</span>> = <span class="hljs-title function_">emptyList</span>(),
    val <span class="hljs-attr">currentFlag</span>: <span class="hljs-title class_">FlagQuery</span>.<span class="hljs-property">AllFlag</span>? = <span class="hljs-literal">null</span>,
)

<span class="hljs-keyword">class</span> <span class="hljs-title class_">FlagsViewModel</span> : <span class="hljs-title class_">ViewModel</span>() {
    private <span class="hljs-keyword">var</span> _state = <span class="hljs-title class_">MutableStateFlow</span>(<span class="hljs-title class_">FlagsUiState</span>())
    val state = _state.<span class="hljs-title function_">asStateFlow</span>()
    ...
}
</code></pre>
<p></p>
<p>API에서 받은 모든 플래그를 저장하고 상세 페이지에서 현재 플래그를 표시하려고 합니다. 이를 위해 상태에 플래그 및 현재 플래그 속성이 있습니다. 두 속성 모두 (FlagQuery.AllFlag)은 Apollo Kotlin에 의해 생성된 형식입니다.</p>
<p>모든 플래그를 쿼리하려면 ViewModel 내부에 다음과 같은 함수를 정의하세요:</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// FlagsViewModel.kt</span>

suspend fun <span class="hljs-title function_">getFlags</span>(<span class="hljs-params"></span>) {
    val flagsQuery = apolloClient
        .<span class="hljs-title function_">query</span>(<span class="hljs-title class_">FlagQuery</span>())
        .<span class="hljs-title function_">execute</span>()

    _state.<span class="hljs-property">update</span> { currentState ->
        currentState.<span class="hljs-title function_">copy</span>(
            loading = <span class="hljs-literal">false</span>,
            flags = flagsQuery.<span class="hljs-property">data</span>?.<span class="hljs-property">allFlags</span> ?: <span class="hljs-title function_">emptyList</span>(),
        )
    }
}
</code></pre>
<p>따라서 플래그를 가져오려면 apolloClient.query(...)를 호출하는 중단 함수가 필요하며, 이 함수 내에서 이전에 정의한 FlagQuery와 함께 실행해야합니다. 성공하면 데이터 속성에서 데이터를 반환하고 해당 데이터를 사용하여 상태를 업데이트할 수 있습니다.</p>
<p></p>
<p>저희는 현재 상태에 플래그를 저장하고 싶다고 언급했었습니다. 이를 설정하는 것은 GraphQL 매직 없이 간단한 함수입니다:</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// FlagsViewModel.kt</span>

fun <span class="hljs-title function_">setFlag</span>(<span class="hljs-params">flag: FlagQuery.AllFlag</span>) {
    _state.<span class="hljs-property">update</span> {
        it.<span class="hljs-title function_">copy</span>(
            currentFlag = flag,
        )
    }
}
</code></pre>
<h1>UI에 대해 간략히</h1>
<p>UI 측면에서는 매우 간단한 작업을 수행하고 있습니다: 플래그 목록을 표시한 다음 상세 뷰로 이동합니다. GraphQL과 관련이 없으므로 데이터를 상태로 전달하는 것은 이 블로그 포스트의 범위를 벗어납니다.</p>
<p></p>
<p>여기에 경험이 어떻게 보이는지 보여주는 비디오가 있어요:</p>
<p>UI 코드를 확인하고 싶다면, Flag Explorer 리포지토리로 이동해보세요.</p>
<h1>마무리</h1>
<p>이 블로그 포스트에서는 GraphQL과 안드로이드 프로젝트에서의 활용 방법에 대해 논의했습니다. 예를 들어, Pride Flag API에서 프라이드 플래그를 가져오는 작은 앱을 만들었습니다.</p>
<p></p>
<p>프로젝트에 GraphQL을 추가하는 것은 생각보다 꽤 간단했습니다. 어떤 이유에서인지 더 복잡할 거라고 생각했는데요. 글 처음에 언급한 대로 저는 GraphQL에 대해 호감을 가지고 있어요, 그래서 실제 프로젝트에서 사용해보면 멋질 것 같아요. 앞으로 어떤 일이 일어날지 기대되네요!</p>
<p>GraphQL에 대해서 어떻게 생각하세요? 사용해보신 적이 있나요?</p>
<h1>블로그 포스트에서의 링크</h1>
<ul>
<li>프라이드 플래그 API</li>
<li>GraphQL 문서</li>
<li>아폴로 코틀린</li>
<li>플래그 익스플로러</li>
</ul>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"앱에 대한 자부심  안드로이드에서 GraphQL 사용해보기","description":"","date":"2024-06-19 10:39","slug":"2024-06-19-PrideinYourAppTryingOutGraphQLonAndroid","content":"\n![이미지](/assets/img/2024-06-19-PrideinYourAppTryingOutGraphQLonAndroid_0.png)\n\n모두들, 요즘은 프라이드 달이에요! LGBTIQA+ 커뮤니티 구성원으로서, 이번 달은 좋으면서도 스트레스를 받는 시기예요. 누군가 무슨 일을 일으키려 할지 예측할 수 없어요. 이번 달은 정말 몇몇 나쁜 사람들을 끌어모을 것 같아요. 그리고 유럽에서 논할 우파의 급부상까지... 시작도 못하겠네요.\n\n오래전부터 안드로이드에서 GraphQL을 시도해보고 싶어했는데, 이 Pride Flag API를 발견하면서 이제 내가 그때가 된 것 같았어요. API(그리고 GraphQL)를 시도하고 블로그 글을 써서 프라이드를 기념하는 좋은 방법이죠!\n\nGraphQL에 대해 조금 소개하자면: 저는 과거에서 GraphQL에 대해 이야기하며 공개 연설 경력을 시작했어요 (JavaScript도요. 제 밝혀지지 않은 비밀이죠.) 재미있었고 정말 좋았어요. 물론, 어떠한 기술을 사용할지 고려할 때 항상 장단점이 있지만, 그래도 정말 좋아했어요. 어느 밋업에서 \"GraphQL에 대해 물어봐주세요\"라는 문구가 적힌 티셔츠를 받았는데, 아마 그 저의 가장 멋진 티셔츠였을 거예요.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n안녕하세요!\n\n안드로이드로 전환했을 때는 GraphQL을 안드로이드와 통합하는 방법을 배울 필요성을 느끼지 못했어요. 그래서 그동안 시도해보고 싶었는데, 이제야 좋은 방법을 찾아 해볼 기회를 찾았어요. 함께 시작해봐요!\n\n# GraphQL\n\nGraphQL이라는 단어를 처음 들어보셨다면, 이것은 그래프 형태로 API를 구축하는 쿼리 언어로 대안적인 방법입니다.\n\nGraphQL API를 통해 필요한 것만 요청할 수 있습니다. 그래서 항상 모든 것을 반환하는 REST API와 달리 GraphQL API는 요청한 값만 반환합니다. 그리고 그래프 기반으로 데이터를 중첩하여 하나의 쿼리로 가져올 수 있어요. 예를 들어 작가, 그의 책, 그리고 책 속 캐릭터를 예로 들 수 있는데, REST API에서는 세 번의 요청이 필요하죠 (물론 API에 따라 달라질 수 있어요).\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nGraphQL은 데이터를 쿼리, 변경 또는 구독하는 세 가지 작업을 제공합니다. REST와 비교하면, 쿼리는 GET 요청과 일치하고, 변경은 데이터를 변경하는 다른 모든 요처과 일치하며, 구독은 양방향으로 작동합니다 - 예를 들어, 웹소켓과 같이요.\n\n이 블로그 포스트의 맥락에서는 데이터를 쿼리할 것입니다. 사용 가능한 작업 및 일반적인 GraphQL에 대해 더 알고 싶다면, GraphQL 문서로 이동하세요.\n\nGraphQL을 사용하기 위해 우리는 Apollo Kotlin(이전 Apollo Android)을 사용할 것입니다. 이 라이브러리는 타입 안전하며 Kotlin 멀티플랫폼과 호환됩니다.\n\n# 의존성 및 스키마 가져오기\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nApollo Kotlin을 시작하려면 프로젝트에 몇 가지 종속성을 추가해야 합니다:\n\n```js\n// 프로젝트 수준의 build.gradle.kts\n\nplugins {\n  id(\"com.apollographql.apollo3\").version(\"3.8.4\")\n}\n```\n\n그리고\n\n```js\n// 모듈 수준의 build.gradle.kts\n\ndependencies {\n  implementation(\"com.apollographql.apollo3:apollo-runtime:3.8.4\")\n}\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n이 패키지들의 버전 번호는 반드시 동일해야 합니다.\n\n의존성에 추가하여 생성된 모델을 위한 패키지 이름을 추가해야 합니다:\n\n```js\n// module-level build.gradle.kts\n\napollo {\n    service(\"service\") {\n        packageName.set(\"com.example\")\n    }\n}\n```\n\n많은 프로젝트에서는 그레이들 파일을 동기화하게 됩니다. 그러나 이 프로젝트는 다릅니다; 여전히 GraphQL 쿼리의 스키마가 필요합니다. 여러 옵션이 있지만 외부 API를 통해 스키마를 내려받는 것이 가장 쉽습니다. 스키마를 src/main/graphql에 저장해야 하며, 이 작은 프로젝트의 경우에는 다음 명령어를 사용하여 이 작업을 수행합니다:\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\n./gradlew :app:downloadApolloSchema --endpoint= 'https://pride.dev/api/graphql' --schema=app/src/main/graphql/schema.graphqls\n```\n\n스키마를 얻었다면 Gradle 파일을 동기화하고 데이터 쿼리를 계속합니다.\n\n# 데이터 쿼리\n\n이 작은 앱에서는 데이터를 읽고 싶습니다 — 따라서 GraphQL 용어로는 쿼리하려고 합니다. 모든 속성이 필요하지 않으므로 필요한 것만 포함한 쿼리를 정의합니다:\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\nquery FlagQuery {\n  allFlags {\n    name\n    year\n    svgUrl\n  }\n}\n```\n\nApollo Kotlin을 사용하면 모든 쿼리에 이름이 지정되어 있어야 합니다. 이름이 없는 쿼리가 있으면 오류가 발생할 수 있어요. 믿어요, 제 경험이죠.\n\n이 쿼리는 API에서 사용 가능한 모든 플래그를 가져옵니다. 플래그의 이름, 연도 및 SVG URL이 필요하기 때문에 쿼리에 이러한 속성을 작성합니다.\n\nAndroid 프로젝트에 쿼리를 추가하려면 먼저 src/main/ 폴더에 파일을 만들어야 합니다. 이 폴더는 스키마가 있는 폴더와 동일합니다. 파일 이름을 FlagQuery.graphql로 지정하고 쿼리를 추가합니다. 앱이 빌드 될 때 자동으로 실행되는 작업을 통해 Apollo는 쿼리에 대한 모델을 생성합니다. 그러니 앱을 빌드하고 나면 쿼리 모델을 사용할 수 있을 거에요.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n이 시점에서 AndroidManifest에 인터넷 권한을 추가해야 한다는 것을 상기시키고 싶어요. 그렇게 하지 않으면, 다음 단계가 더 복잡해질 거에요. 믿어줘요, 알아요.\n\n추가해야 하는 내용을 상기시키기 위해 여기에 있어요. 나처럼 검색 엔진을 사용하지 않아도 괜찮아요:\n\n```js\n// AndroidManifest.xml\n\n\u003cuses-permission android:name=\"android.permission.INTERNET\" /\u003e\n```\n\n자, 이제 쿼리가 준비되었는데, 이것을 UI에 어떻게 연결할까요? 답은 GraphQL 클라이언트입니다. 데이터를 쿼리하는 데 사용할 수 있어요. 이 데모를 위해 간단하게 만들고 있으니, GraphQL 클라이언트를 정의하고 데이터를 뷰 모델에서 쿼리할 것이에요. 제작용 앱에서는 아마 레이어 구조가 더 복잡할 거에요.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n먼저 클라이언트를 정의합니다:\n\n```js\n// GraphQLClient.kt\n\nconst val API_ENDPOINT = \"https://pride.dev/api/graphql\"\n\nval apolloClient = ApolloClient.Builder()\n    .serverUrl(API_ENDPOINT)\n    .build()\n```\n\n뷰 모델에서는 먼저 UI에서 사용할 상태를 정의합니다:\n\n```js\n// FlagsViewModel.kt\n\ndata class FlagsUiState(\n    val loading: Boolean = true,\n    val flags: List\u003cFlagQuery.AllFlag\u003e = emptyList(),\n    val currentFlag: FlagQuery.AllFlag? = null,\n)\n\nclass FlagsViewModel : ViewModel() {\n    private var _state = MutableStateFlow(FlagsUiState())\n    val state = _state.asStateFlow()\n    ...\n}\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nAPI에서 받은 모든 플래그를 저장하고 상세 페이지에서 현재 플래그를 표시하려고 합니다. 이를 위해 상태에 플래그 및 현재 플래그 속성이 있습니다. 두 속성 모두 (FlagQuery.AllFlag)은 Apollo Kotlin에 의해 생성된 형식입니다.\n\n모든 플래그를 쿼리하려면 ViewModel 내부에 다음과 같은 함수를 정의하세요:\n\n```js\n// FlagsViewModel.kt\n\nsuspend fun getFlags() {\n    val flagsQuery = apolloClient\n        .query(FlagQuery())\n        .execute()\n\n    _state.update { currentState -\u003e\n        currentState.copy(\n            loading = false,\n            flags = flagsQuery.data?.allFlags ?: emptyList(),\n        )\n    }\n}\n```\n\n따라서 플래그를 가져오려면 apolloClient.query(...)를 호출하는 중단 함수가 필요하며, 이 함수 내에서 이전에 정의한 FlagQuery와 함께 실행해야합니다. 성공하면 데이터 속성에서 데이터를 반환하고 해당 데이터를 사용하여 상태를 업데이트할 수 있습니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n저희는 현재 상태에 플래그를 저장하고 싶다고 언급했었습니다. 이를 설정하는 것은 GraphQL 매직 없이 간단한 함수입니다:\n\n```js\n// FlagsViewModel.kt\n\nfun setFlag(flag: FlagQuery.AllFlag) {\n    _state.update {\n        it.copy(\n            currentFlag = flag,\n        )\n    }\n}\n```\n\n# UI에 대해 간략히\n\nUI 측면에서는 매우 간단한 작업을 수행하고 있습니다: 플래그 목록을 표시한 다음 상세 뷰로 이동합니다. GraphQL과 관련이 없으므로 데이터를 상태로 전달하는 것은 이 블로그 포스트의 범위를 벗어납니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n여기에 경험이 어떻게 보이는지 보여주는 비디오가 있어요:\n\nUI 코드를 확인하고 싶다면, Flag Explorer 리포지토리로 이동해보세요.\n\n# 마무리\n\n이 블로그 포스트에서는 GraphQL과 안드로이드 프로젝트에서의 활용 방법에 대해 논의했습니다. 예를 들어, Pride Flag API에서 프라이드 플래그를 가져오는 작은 앱을 만들었습니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n프로젝트에 GraphQL을 추가하는 것은 생각보다 꽤 간단했습니다. 어떤 이유에서인지 더 복잡할 거라고 생각했는데요. 글 처음에 언급한 대로 저는 GraphQL에 대해 호감을 가지고 있어요, 그래서 실제 프로젝트에서 사용해보면 멋질 것 같아요. 앞으로 어떤 일이 일어날지 기대되네요!\n\nGraphQL에 대해서 어떻게 생각하세요? 사용해보신 적이 있나요?\n\n# 블로그 포스트에서의 링크\n\n- 프라이드 플래그 API\n- GraphQL 문서\n- 아폴로 코틀린\n- 플래그 익스플로러\n","ogImage":{"url":"/assets/img/2024-06-19-PrideinYourAppTryingOutGraphQLonAndroid_0.png"},"coverImage":"/assets/img/2024-06-19-PrideinYourAppTryingOutGraphQLonAndroid_0.png","tag":["Tech"],"readingTime":9},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-19-PrideinYourAppTryingOutGraphQLonAndroid_0.png\" alt=\"이미지\"\u003e\u003c/p\u003e\n\u003cp\u003e모두들, 요즘은 프라이드 달이에요! LGBTIQA+ 커뮤니티 구성원으로서, 이번 달은 좋으면서도 스트레스를 받는 시기예요. 누군가 무슨 일을 일으키려 할지 예측할 수 없어요. 이번 달은 정말 몇몇 나쁜 사람들을 끌어모을 것 같아요. 그리고 유럽에서 논할 우파의 급부상까지... 시작도 못하겠네요.\u003c/p\u003e\n\u003cp\u003e오래전부터 안드로이드에서 GraphQL을 시도해보고 싶어했는데, 이 Pride Flag API를 발견하면서 이제 내가 그때가 된 것 같았어요. API(그리고 GraphQL)를 시도하고 블로그 글을 써서 프라이드를 기념하는 좋은 방법이죠!\u003c/p\u003e\n\u003cp\u003eGraphQL에 대해 조금 소개하자면: 저는 과거에서 GraphQL에 대해 이야기하며 공개 연설 경력을 시작했어요 (JavaScript도요. 제 밝혀지지 않은 비밀이죠.) 재미있었고 정말 좋았어요. 물론, 어떠한 기술을 사용할지 고려할 때 항상 장단점이 있지만, 그래도 정말 좋아했어요. 어느 밋업에서 \"GraphQL에 대해 물어봐주세요\"라는 문구가 적힌 티셔츠를 받았는데, 아마 그 저의 가장 멋진 티셔츠였을 거예요.\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003e안녕하세요!\u003c/p\u003e\n\u003cp\u003e안드로이드로 전환했을 때는 GraphQL을 안드로이드와 통합하는 방법을 배울 필요성을 느끼지 못했어요. 그래서 그동안 시도해보고 싶었는데, 이제야 좋은 방법을 찾아 해볼 기회를 찾았어요. 함께 시작해봐요!\u003c/p\u003e\n\u003ch1\u003eGraphQL\u003c/h1\u003e\n\u003cp\u003eGraphQL이라는 단어를 처음 들어보셨다면, 이것은 그래프 형태로 API를 구축하는 쿼리 언어로 대안적인 방법입니다.\u003c/p\u003e\n\u003cp\u003eGraphQL API를 통해 필요한 것만 요청할 수 있습니다. 그래서 항상 모든 것을 반환하는 REST API와 달리 GraphQL API는 요청한 값만 반환합니다. 그리고 그래프 기반으로 데이터를 중첩하여 하나의 쿼리로 가져올 수 있어요. 예를 들어 작가, 그의 책, 그리고 책 속 캐릭터를 예로 들 수 있는데, REST API에서는 세 번의 요청이 필요하죠 (물론 API에 따라 달라질 수 있어요).\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eGraphQL은 데이터를 쿼리, 변경 또는 구독하는 세 가지 작업을 제공합니다. REST와 비교하면, 쿼리는 GET 요청과 일치하고, 변경은 데이터를 변경하는 다른 모든 요처과 일치하며, 구독은 양방향으로 작동합니다 - 예를 들어, 웹소켓과 같이요.\u003c/p\u003e\n\u003cp\u003e이 블로그 포스트의 맥락에서는 데이터를 쿼리할 것입니다. 사용 가능한 작업 및 일반적인 GraphQL에 대해 더 알고 싶다면, GraphQL 문서로 이동하세요.\u003c/p\u003e\n\u003cp\u003eGraphQL을 사용하기 위해 우리는 Apollo Kotlin(이전 Apollo Android)을 사용할 것입니다. 이 라이브러리는 타입 안전하며 Kotlin 멀티플랫폼과 호환됩니다.\u003c/p\u003e\n\u003ch1\u003e의존성 및 스키마 가져오기\u003c/h1\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eApollo Kotlin을 시작하려면 프로젝트에 몇 가지 종속성을 추가해야 합니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// 프로젝트 수준의 build.gradle.kts\u003c/span\u003e\n\nplugins {\n  \u003cspan class=\"hljs-title function_\"\u003eid\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"com.apollographql.apollo3\"\u003c/span\u003e).\u003cspan class=\"hljs-title function_\"\u003eversion\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"3.8.4\"\u003c/span\u003e)\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e그리고\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// 모듈 수준의 build.gradle.kts\u003c/span\u003e\n\ndependencies {\n  \u003cspan class=\"hljs-title function_\"\u003eimplementation\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"com.apollographql.apollo3:apollo-runtime:3.8.4\"\u003c/span\u003e)\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003e이 패키지들의 버전 번호는 반드시 동일해야 합니다.\u003c/p\u003e\n\u003cp\u003e의존성에 추가하여 생성된 모델을 위한 패키지 이름을 추가해야 합니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// module-level build.gradle.kts\u003c/span\u003e\n\napollo {\n    \u003cspan class=\"hljs-title function_\"\u003eservice\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003cspan class=\"hljs-string\"\u003e\"service\"\u003c/span\u003e\u003c/span\u003e) {\n        packageName.\u003cspan class=\"hljs-title function_\"\u003eset\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"com.example\"\u003c/span\u003e)\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e많은 프로젝트에서는 그레이들 파일을 동기화하게 됩니다. 그러나 이 프로젝트는 다릅니다; 여전히 GraphQL 쿼리의 스키마가 필요합니다. 여러 옵션이 있지만 외부 API를 통해 스키마를 내려받는 것이 가장 쉽습니다. 스키마를 src/main/graphql에 저장해야 하며, 이 작은 프로젝트의 경우에는 다음 명령어를 사용하여 이 작업을 수행합니다:\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e./gradlew :\u003cspan class=\"hljs-attr\"\u003eapp\u003c/span\u003e:downloadApolloSchema --endpoint= \u003cspan class=\"hljs-string\"\u003e'https://pride.dev/api/graphql'\u003c/span\u003e --schema=app/src/main/graphql/schema.\u003cspan class=\"hljs-property\"\u003egraphqls\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e스키마를 얻었다면 Gradle 파일을 동기화하고 데이터 쿼리를 계속합니다.\u003c/p\u003e\n\u003ch1\u003e데이터 쿼리\u003c/h1\u003e\n\u003cp\u003e이 작은 앱에서는 데이터를 읽고 싶습니다 — 따라서 GraphQL 용어로는 쿼리하려고 합니다. 모든 속성이 필요하지 않으므로 필요한 것만 포함한 쿼리를 정의합니다:\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003equery \u003cspan class=\"hljs-title class_\"\u003eFlagQuery\u003c/span\u003e {\n  allFlags {\n    name\n    year\n    svgUrl\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eApollo Kotlin을 사용하면 모든 쿼리에 이름이 지정되어 있어야 합니다. 이름이 없는 쿼리가 있으면 오류가 발생할 수 있어요. 믿어요, 제 경험이죠.\u003c/p\u003e\n\u003cp\u003e이 쿼리는 API에서 사용 가능한 모든 플래그를 가져옵니다. 플래그의 이름, 연도 및 SVG URL이 필요하기 때문에 쿼리에 이러한 속성을 작성합니다.\u003c/p\u003e\n\u003cp\u003eAndroid 프로젝트에 쿼리를 추가하려면 먼저 src/main/ 폴더에 파일을 만들어야 합니다. 이 폴더는 스키마가 있는 폴더와 동일합니다. 파일 이름을 FlagQuery.graphql로 지정하고 쿼리를 추가합니다. 앱이 빌드 될 때 자동으로 실행되는 작업을 통해 Apollo는 쿼리에 대한 모델을 생성합니다. 그러니 앱을 빌드하고 나면 쿼리 모델을 사용할 수 있을 거에요.\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003e이 시점에서 AndroidManifest에 인터넷 권한을 추가해야 한다는 것을 상기시키고 싶어요. 그렇게 하지 않으면, 다음 단계가 더 복잡해질 거에요. 믿어줘요, 알아요.\u003c/p\u003e\n\u003cp\u003e추가해야 하는 내용을 상기시키기 위해 여기에 있어요. 나처럼 검색 엔진을 사용하지 않아도 괜찮아요:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// AndroidManifest.xml\u003c/span\u003e\n\n\u0026#x3C;uses-permission \u003cspan class=\"hljs-attr\"\u003eandroid\u003c/span\u003e:name=\u003cspan class=\"hljs-string\"\u003e\"android.permission.INTERNET\"\u003c/span\u003e /\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e자, 이제 쿼리가 준비되었는데, 이것을 UI에 어떻게 연결할까요? 답은 GraphQL 클라이언트입니다. 데이터를 쿼리하는 데 사용할 수 있어요. 이 데모를 위해 간단하게 만들고 있으니, GraphQL 클라이언트를 정의하고 데이터를 뷰 모델에서 쿼리할 것이에요. 제작용 앱에서는 아마 레이어 구조가 더 복잡할 거에요.\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003e먼저 클라이언트를 정의합니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// GraphQLClient.kt\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e val \u003cspan class=\"hljs-variable constant_\"\u003eAPI_ENDPOINT\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"https://pride.dev/api/graphql\"\u003c/span\u003e\n\nval apolloClient = \u003cspan class=\"hljs-title class_\"\u003eApolloClient\u003c/span\u003e.\u003cspan class=\"hljs-title class_\"\u003eBuilder\u003c/span\u003e()\n    .\u003cspan class=\"hljs-title function_\"\u003eserverUrl\u003c/span\u003e(\u003cspan class=\"hljs-variable constant_\"\u003eAPI_ENDPOINT\u003c/span\u003e)\n    .\u003cspan class=\"hljs-title function_\"\u003ebuild\u003c/span\u003e()\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e뷰 모델에서는 먼저 UI에서 사용할 상태를 정의합니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// FlagsViewModel.kt\u003c/span\u003e\n\ndata \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eFlagsUiState\u003c/span\u003e(\n    val \u003cspan class=\"hljs-attr\"\u003eloading\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eBoolean\u003c/span\u003e = \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e,\n    val \u003cspan class=\"hljs-attr\"\u003eflags\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eList\u003c/span\u003e\u0026#x3C;\u003cspan class=\"hljs-title class_\"\u003eFlagQuery\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eAllFlag\u003c/span\u003e\u003e = \u003cspan class=\"hljs-title function_\"\u003eemptyList\u003c/span\u003e(),\n    val \u003cspan class=\"hljs-attr\"\u003ecurrentFlag\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eFlagQuery\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eAllFlag\u003c/span\u003e? = \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e,\n)\n\n\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eFlagsViewModel\u003c/span\u003e : \u003cspan class=\"hljs-title class_\"\u003eViewModel\u003c/span\u003e() {\n    private \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e _state = \u003cspan class=\"hljs-title class_\"\u003eMutableStateFlow\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eFlagsUiState\u003c/span\u003e())\n    val state = _state.\u003cspan class=\"hljs-title function_\"\u003easStateFlow\u003c/span\u003e()\n    ...\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eAPI에서 받은 모든 플래그를 저장하고 상세 페이지에서 현재 플래그를 표시하려고 합니다. 이를 위해 상태에 플래그 및 현재 플래그 속성이 있습니다. 두 속성 모두 (FlagQuery.AllFlag)은 Apollo Kotlin에 의해 생성된 형식입니다.\u003c/p\u003e\n\u003cp\u003e모든 플래그를 쿼리하려면 ViewModel 내부에 다음과 같은 함수를 정의하세요:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// FlagsViewModel.kt\u003c/span\u003e\n\nsuspend fun \u003cspan class=\"hljs-title function_\"\u003egetFlags\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n    val flagsQuery = apolloClient\n        .\u003cspan class=\"hljs-title function_\"\u003equery\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eFlagQuery\u003c/span\u003e())\n        .\u003cspan class=\"hljs-title function_\"\u003eexecute\u003c/span\u003e()\n\n    _state.\u003cspan class=\"hljs-property\"\u003eupdate\u003c/span\u003e { currentState -\u003e\n        currentState.\u003cspan class=\"hljs-title function_\"\u003ecopy\u003c/span\u003e(\n            loading = \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e,\n            flags = flagsQuery.\u003cspan class=\"hljs-property\"\u003edata\u003c/span\u003e?.\u003cspan class=\"hljs-property\"\u003eallFlags\u003c/span\u003e ?: \u003cspan class=\"hljs-title function_\"\u003eemptyList\u003c/span\u003e(),\n        )\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e따라서 플래그를 가져오려면 apolloClient.query(...)를 호출하는 중단 함수가 필요하며, 이 함수 내에서 이전에 정의한 FlagQuery와 함께 실행해야합니다. 성공하면 데이터 속성에서 데이터를 반환하고 해당 데이터를 사용하여 상태를 업데이트할 수 있습니다.\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003e저희는 현재 상태에 플래그를 저장하고 싶다고 언급했었습니다. 이를 설정하는 것은 GraphQL 매직 없이 간단한 함수입니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// FlagsViewModel.kt\u003c/span\u003e\n\nfun \u003cspan class=\"hljs-title function_\"\u003esetFlag\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eflag: FlagQuery.AllFlag\u003c/span\u003e) {\n    _state.\u003cspan class=\"hljs-property\"\u003eupdate\u003c/span\u003e {\n        it.\u003cspan class=\"hljs-title function_\"\u003ecopy\u003c/span\u003e(\n            currentFlag = flag,\n        )\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch1\u003eUI에 대해 간략히\u003c/h1\u003e\n\u003cp\u003eUI 측면에서는 매우 간단한 작업을 수행하고 있습니다: 플래그 목록을 표시한 다음 상세 뷰로 이동합니다. GraphQL과 관련이 없으므로 데이터를 상태로 전달하는 것은 이 블로그 포스트의 범위를 벗어납니다.\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003e여기에 경험이 어떻게 보이는지 보여주는 비디오가 있어요:\u003c/p\u003e\n\u003cp\u003eUI 코드를 확인하고 싶다면, Flag Explorer 리포지토리로 이동해보세요.\u003c/p\u003e\n\u003ch1\u003e마무리\u003c/h1\u003e\n\u003cp\u003e이 블로그 포스트에서는 GraphQL과 안드로이드 프로젝트에서의 활용 방법에 대해 논의했습니다. 예를 들어, Pride Flag API에서 프라이드 플래그를 가져오는 작은 앱을 만들었습니다.\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003e프로젝트에 GraphQL을 추가하는 것은 생각보다 꽤 간단했습니다. 어떤 이유에서인지 더 복잡할 거라고 생각했는데요. 글 처음에 언급한 대로 저는 GraphQL에 대해 호감을 가지고 있어요, 그래서 실제 프로젝트에서 사용해보면 멋질 것 같아요. 앞으로 어떤 일이 일어날지 기대되네요!\u003c/p\u003e\n\u003cp\u003eGraphQL에 대해서 어떻게 생각하세요? 사용해보신 적이 있나요?\u003c/p\u003e\n\u003ch1\u003e블로그 포스트에서의 링크\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003e프라이드 플래그 API\u003c/li\u003e\n\u003cli\u003eGraphQL 문서\u003c/li\u003e\n\u003cli\u003e아폴로 코틀린\u003c/li\u003e\n\u003cli\u003e플래그 익스플로러\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-06-19-PrideinYourAppTryingOutGraphQLonAndroid"},"buildId":"bb_yO9GbCvdfc_n71SfUf","isFallback":false,"gsp":true,"scriptLoader":[{"async":true,"src":"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4877378276818686","strategy":"lazyOnload","crossOrigin":"anonymous"}]}</script></body></html>