<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>ëŸ¬ìŠ¤íŠ¸ ë°°ìš°ê¸° 11ë¶€  ë¹Œë”ì™€ ë°ì´í„°ë² ì´ìŠ¤ ìƒí˜¸ì‘ìš© | ui-station</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://ui-station.github.io///post/2024-05-23-LearningRustPart11BuildersandDatabaseInteraction" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="ëŸ¬ìŠ¤íŠ¸ ë°°ìš°ê¸° 11ë¶€  ë¹Œë”ì™€ ë°ì´í„°ë² ì´ìŠ¤ ìƒí˜¸ì‘ìš© | ui-station" data-gatsby-head="true"/><meta property="og:title" content="ëŸ¬ìŠ¤íŠ¸ ë°°ìš°ê¸° 11ë¶€  ë¹Œë”ì™€ ë°ì´í„°ë² ì´ìŠ¤ ìƒí˜¸ì‘ìš© | ui-station" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-05-23-LearningRustPart11BuildersandDatabaseInteraction_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://ui-station.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://ui-station.github.io///post/2024-05-23-LearningRustPart11BuildersandDatabaseInteraction" data-gatsby-head="true"/><meta name="twitter:title" content="ëŸ¬ìŠ¤íŠ¸ ë°°ìš°ê¸° 11ë¶€  ë¹Œë”ì™€ ë°ì´í„°ë² ì´ìŠ¤ ìƒí˜¸ì‘ìš© | ui-station" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-05-23-LearningRustPart11BuildersandDatabaseInteraction_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | ui-station" data-gatsby-head="true"/><meta name="article:published_time" content="2024-05-23 14:11" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-BHFR6GTH9P"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
          
            gtag('config', 'G-BHFR6GTH9P');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b8ef307c9aee1e34.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b8ef307c9aee1e34.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-ac4aa08aae62f90e.js" defer=""></script><script src="/_next/static/chunks/463-0429087d4c0b0335.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-70e5ce89f3d962ac.js" defer=""></script><script src="/_next/static/wfHLuDA3kTGBYfaM5IGXk/_buildManifest.js" defer=""></script><script src="/_next/static/wfHLuDA3kTGBYfaM5IGXk/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">UI STATION</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">ëŸ¬ìŠ¤íŠ¸ ë°°ìš°ê¸° 11ë¶€  ë¹Œë”ì™€ ë°ì´í„°ë² ì´ìŠ¤ ìƒí˜¸ì‘ìš©</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="ëŸ¬ìŠ¤íŠ¸ ë°°ìš°ê¸° 11ë¶€  ë¹Œë”ì™€ ë°ì´í„°ë² ì´ìŠ¤ ìƒí˜¸ì‘ìš©" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">UI STATION</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On May 23, 2024</span><span class="posts_reading_time__f7YPP">24<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-05-23-LearningRustPart11BuildersandDatabaseInteraction&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<p>ë‹¤ìŒ ì‹œë¦¬ì¦ˆë¡œ ë„˜ì–´ê°€ë³´ê² ìŠµë‹ˆë‹¤; ì´ ë¶€ë¶„ì—ì„œëŠ” ë°ì´í„° êµ¬ì¡°ì— ë¹Œë” íŒ¨í„´ì„ êµ¬í˜„í•˜ëŠ” ë°©ë²•ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ sqlxì™€ Postgresë¥¼ ì‚¬ìš©í•œ ë°ì´í„°ë² ì´ìŠ¤ ìƒí˜¸ì‘ìš©ìœ¼ë¡œ ë„˜ì–´ê°€ê² ìŠµë‹ˆë‹¤.</p>
<p><img src="/assets/img/2024-05-23-LearningRustPart11BuildersandDatabaseInteraction_0.png" alt="ì´ë¯¸ì§€"></p>
<h1>Rust ì‹œë¦¬ì¦ˆ</h1>
<p>ë¶€ë¶„ 1 â€” ê¸°ë³¸ ê°œë…</p>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>Part 2 â€” ë©”ëª¨ë¦¬</p>
<p>Part 3 â€” íë¦„ ì œì–´ì™€ í•¨ìˆ˜</p>
<p>Part 4 â€” ì˜µì…˜/ê²°ê³¼ ë° ì»¬ë ‰ì…˜</p>
<p>Part 5 â€” íŠ¸ë ˆì´íŠ¸, ì œë„¤ë¦­ ë° í´ë¡œì €</p>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>ì œ 6ë¶€ â€” ë§¤í¬ë¡œ, ë°˜ë³µì ë° íŒŒì¼ ì²˜ë¦¬</p>
<p>ì œ 7ë¶€ â€” ìŠ¤ë ˆë“œ ê³µìœ  ìƒíƒœ ë° ì±„ë„</p>
<p>ì œ 8ë¶€ â€” Cargo, í¬ë ˆì´íŠ¸, ëª¨ë“ˆ ë° ë¼ì´ë¸ŒëŸ¬ë¦¬</p>
<p>ì œ 9ë¶€ â€” ëª…ë ¹í–‰ ì¸ìˆ˜, ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ë° í…ŒìŠ¤íŒ…</p>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>ì œ 10ë¶€ â€” ìƒì í¬ì¸í„° ë° ì›¹ ì•±</p>
<p>ì œ 11ë¶€ â€” ë¹Œë”ì™€ ë°ì´í„°ë² ì´ìŠ¤ ìƒí˜¸ì‘ìš© (ì´ ê¸°ì‚¬)</p>
<h1>ì†Œê°œ</h1>
<p>ì´ê²ƒì€ ëŸ¬ìŠ¤íŠ¸ í•™ìŠµ ì‹œë¦¬ì¦ˆì˜ ì—´í•œ ë²ˆì§¸ ì„¹ì…˜ì…ë‹ˆë‹¤. ì´ë²ˆì—ëŠ” ëŸ¬ìŠ¤íŠ¸ì—ì„œ ë¹Œë” íŒ¨í„´ì„ ë‹¤ë£° ê²ƒì…ë‹ˆë‹¤. ì´ ê³µí†µëœ íŒ¨í„´ì€ êµ¬ì¡°ì²´ë¥¼ ì•ˆì „í•˜ê³  íˆ¬ëª…í•˜ê²Œ ì´ˆê¸°í™”í•˜ëŠ” ì¢‹ì€ ë°©ë²•ì…ë‹ˆë‹¤. ë‹¤ìŒìœ¼ë¡œ, ìš°ë¦¬ëŠ” í¬ìŠ¤íŠ¸ê·¸ë ˆìŠ¤ì™€ SQLX í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ CRUD ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë°©ë²•ì„ ì‚´í´ë³¼ ê²ƒì…ë‹ˆë‹¤.</p>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h1>ì¤€ë¹„ë¬¼</h1>
<p>ì´ ê¸€ì˜ ë°ì´í„°ë² ì´ìŠ¤ ë¶€ë¶„ì„ ìœ„í•œ ìœ ì¼í•œ ì¤€ë¹„ë¬¼ì€ Rustì™€ Cargoê°€ ì„¤ì¹˜ë˜ì–´ ìˆê³  ì‹œìŠ¤í…œì— Dockerê°€ ì„¤ì¹˜ë˜ì–´ ìˆëŠ” ê²ƒì…ë‹ˆë‹¤. ë§Œì•½ Dockerë¥¼ ê°€ì§€ê³  ìˆì§€ ì•Šì§€ë§Œ ë¡œì»¬ Postgres DBê°€ ì´ë¯¸ ì„¤ì¹˜ë˜ì–´ ìˆê±°ë‚˜ ë‹¤ë¥¸ ì„œë²„ì˜ DBì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆë‹¤ë©´ Docker Postgres ì„¤ì •ì„ ê±´ë„ˆë›°ê³  DBì— ì—°ê²°í•˜ê¸° ìœ„í•œ ì—°ê²° ì†ì„±ë§Œ ìˆ˜ì •í•˜ë©´ ë©ë‹ˆë‹¤.</p>
<h1>ë¹Œë” íŒ¨í„´</h1>
<p>ë¹Œë” íŒ¨í„´ì€ ë³µì¡í•œ ê°ì²´ì˜ êµ¬ì„±ì„ í•´ë‹¹ í‘œí˜„ì—ì„œ ë¶„ë¦¬í•˜ëŠ” ë””ìì¸ íŒ¨í„´ì…ë‹ˆë‹¤. ì´ íŒ¨í„´ì„ ì‚¬ìš©í•˜ë©´ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ìˆ˜í–‰í•˜ê³  ê¸°ë³¸ê°’ìœ¼ë¡œ ëŒ€ì²´í•˜ë©° ê°’ì„ ë¶€ë¶„ì ìœ¼ë¡œ í• ë‹¹í•œ í›„ì— í•­ëª©ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>Rustë¡œ ê·¸ êµ¬í˜„í•˜ëŠ” ë°©ë²•ì„ ì‚´í´ë³¼ ê±°ì˜ˆìš”. ì´ê²ƒì´ ìš°ë¦¬ì˜ ì½”ë“œì…ë‹ˆë‹¤.</p>
<pre><code class="hljs language-js">#[<span class="hljs-title function_">derive</span>(<span class="hljs-title class_">Debug</span>)]
struct <span class="hljs-title class_">ChargingSession</span> {
    <span class="hljs-attr">id</span>: <span class="hljs-title class_">String</span>,
    <span class="hljs-attr">watts</span>: u32,
    <span class="hljs-attr">vin</span>: <span class="hljs-title class_">String</span>,
}

struct <span class="hljs-title class_">ChargingSessionBuilder</span> {
    <span class="hljs-attr">id</span>: <span class="hljs-title class_">String</span>,
    <span class="hljs-attr">watts</span>: <span class="hljs-title class_">Option</span>&#x3C;u32>,
    <span class="hljs-attr">vin</span>: <span class="hljs-title class_">Option</span>&#x3C;<span class="hljs-title class_">String</span>>,
}

impl <span class="hljs-title class_">ChargingSessionBuilder</span> {
    fn <span class="hljs-title function_">new</span>(<span class="hljs-attr">id</span>: &#x26;str) -> <span class="hljs-title class_">ChargingSessionBuilder</span> {
        <span class="hljs-title class_">ChargingSessionBuilder</span> {
            <span class="hljs-attr">id</span>: id.<span class="hljs-title function_">to_string</span>(),
            <span class="hljs-attr">watts</span>: <span class="hljs-title class_">None</span>,
            <span class="hljs-attr">vin</span>: <span class="hljs-title class_">None</span>,
        }
    }

    fn <span class="hljs-title function_">watts</span>(mut self, <span class="hljs-attr">watts</span>: u32) -> <span class="hljs-title class_">ChargingSessionBuilder</span> {
        self.<span class="hljs-property">watts</span> = <span class="hljs-title class_">Some</span>(watts);
        self
    }

    fn <span class="hljs-title function_">vin</span>(mut self, <span class="hljs-attr">vin</span>: &#x26;str) -> <span class="hljs-title class_">ChargingSessionBuilder</span> {
        self.<span class="hljs-property">vin</span> = <span class="hljs-title class_">Some</span>(vin.<span class="hljs-title function_">to_string</span>());
        self
    }

    fn <span class="hljs-title function_">build</span>(self) -> <span class="hljs-title class_">ChargingSession</span> {
        <span class="hljs-title class_">ChargingSession</span> {
            <span class="hljs-attr">id</span>: self.<span class="hljs-property">id</span>,
            <span class="hljs-attr">watts</span>: self.<span class="hljs-property">watts</span>.<span class="hljs-title function_">unwrap_or_else</span>(|| <span class="hljs-number">0</span>),
            <span class="hljs-attr">vin</span>: self.<span class="hljs-property">vin</span>.<span class="hljs-title function_">unwrap_or_else</span>(|| <span class="hljs-string">"Unknown"</span>.<span class="hljs-title function_">to_string</span>()),
        }
    }
}

fn <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) {
    <span class="hljs-comment">// ì´ê²ƒì€ ChargingSessionì„ ìƒì„±í•˜ëŠ” í‘œì¤€ì ì¸ ë°©ë²•ì…ë‹ˆë‹¤.</span>
    <span class="hljs-keyword">let</span> cs_old_way = <span class="hljs-title class_">ChargingSession</span> {
        <span class="hljs-attr">id</span>: <span class="hljs-title class_">String</span>::<span class="hljs-title function_">from</span>(<span class="hljs-string">"11111"</span>),
        <span class="hljs-attr">watts</span>: <span class="hljs-number">420</span>,
        <span class="hljs-attr">vin</span>: <span class="hljs-title class_">String</span>::<span class="hljs-title function_">from</span>(<span class="hljs-string">"4Y1SL65848Z411439"</span>),
    };
    println!(<span class="hljs-string">"Regular way to create struct: {:?}"</span>, cs_old_way);

    <span class="hljs-comment">// ë¹Œë”ë¥¼ ì‚¬ìš©í•´ì„œ ìƒì„±í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.</span>
    <span class="hljs-keyword">let</span> cs = <span class="hljs-title class_">ChargingSessionBuilder</span>::<span class="hljs-title function_">new</span>(<span class="hljs-string">"11111"</span>)
        .<span class="hljs-title function_">watts</span>(<span class="hljs-number">420</span>)
        .<span class="hljs-title function_">vin</span>(<span class="hljs-string">"4Y1SL65848Z411439"</span>)
        .<span class="hljs-title function_">build</span>();
    println!(<span class="hljs-string">"Builder pattern to create struct: {:?}"</span>, cs);

    <span class="hljs-comment">// IDë§Œ ì œê³µí•˜ì—¬ ìƒì„±í•˜ëŠ” ì˜ˆì‹œì…ë‹ˆë‹¤.</span>
    <span class="hljs-keyword">let</span> cs_lean = <span class="hljs-title class_">ChargingSessionBuilder</span>::<span class="hljs-title function_">new</span>(<span class="hljs-string">"11111"</span>)
    .<span class="hljs-title function_">build</span>();
     println!(<span class="hljs-string">"Builder pattern to create struct (default values): {:?}"</span>, cs_lean);
}
</code></pre>
<p>ì´ê±¸ í•œ ë²ˆì— ì´í•´í•˜ê¸°ì— ë§ì§€ë§Œ, ë‹¨ê³„ì ìœ¼ë¡œ ì§„í–‰í•´ ë´…ì‹œë‹¤.</p>
<p>ë¨¼ì €, ì¶©ì „ ì„¸ì…˜ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” êµ¬ì¡°ì²´ë¥¼ ì •ì˜í–ˆìŠµë‹ˆë‹¤. ì´ ì‹œë¦¬ì¦ˆì˜ ì´ì „ ì˜ˆì œì—ì„œ í•˜ë‚˜ì˜ í•„ë“œì¸ ì„¸ì…˜ìš© ì°¨ëŸ‰ ID ë²ˆí˜¸ì¸ vinì„ ì¶”ê°€í–ˆì–´ìš”.</p>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>ê·¸ëŸ¬ë©´ ë°ì´í„° êµ¬ì¡°ì²´ì™€ ë™ì¼í•œ í•„ë“œë¥¼ ê°€ì§„ ë¹Œë”ë¥¼ ìœ„í•œ êµ¬ì¡°ì²´ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.</p>
<p>ë¹Œë”ëŠ” impl ë¸”ë¡ì—ì„œ êµ¬í˜„ë˜ë©°, id ë° ê° ì¶”ê°€ í•„ë“œë¥¼ ì„¤ì •í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì •ì˜í•˜ëŠ” ìƒˆ í•¨ìˆ˜ê°€ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ëª‡ ê°€ì§€ ì¤‘ìš”í•œ ì‚¬í•­ì´ ìˆìŠµë‹ˆë‹¤.</p>
<ul>
<li>ê° í•¨ìˆ˜ëŠ” ChargingSessionBuilder ìœ í˜•ì„ ë°˜í™˜í•©ë‹ˆë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ selfì…ë‹ˆë‹¤.</li>
<li>ì¶”ê°€ ì†ì„± í•„ë“œì—ëŠ” mut selfë¥¼ ì²« ë²ˆì§¸ ë§¤ê°œë³€ìˆ˜ë¡œ ì‚¬ìš©í•˜ëŠ” ë©”ì„œë“œê°€ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ì´ëŸ¬í•œ í•¨ìˆ˜ í˜¸ì¶œì˜ ì²´ì´ë‹ì„ í—ˆìš©í•˜ëŠ” ë° ì¤‘ìš”í•©ë‹ˆë‹¤. ë˜í•œ ì—¬ê¸°ì— ìœ íš¨ì„± ê²€ì‚¬ ë…¼ë¦¬ë¥¼ ì½”ë”©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
<li>build í•¨ìˆ˜ê°€ ëª¨ë‘ í†µí•©ë˜ëŠ” ê³³ì…ë‹ˆë‹¤. ì¡´ì¬í•˜ëŠ” ê°’ë“¤ì„ í• ë‹¹í•˜ê³  ë‚˜ë©´ ê¸°ë³¸ê°’ì„ ê²°ì •í•˜ê³  ëŒ€ìƒ êµ¬ì¡°ì²´ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
</ul>
<p>ì´ë¥¼ í†µí•´ ë¹Œë” íŒ¨í„´ì˜ ìš°ì•„í•¨ê³¼ Rust ë‚´ì—ì„œì˜ êµ¬í˜„ ë°©ë²•ì„ ì‚´í´ë³´ì•˜ìŠµë‹ˆë‹¤. ì´ê²ƒì´ ì•±ì´ë‚˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ì½”ë“œë¥¼ êµ¬í˜„í•˜ëŠ” í›Œë¥­í•œ ë°©ë²•ì„ì„ ì•Œ ìˆ˜ ìˆê¸°ë¥¼ ë°”ëë‹ˆë‹¤.</p>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>ë‹¤ìŒ ì„¹ì…˜ì¸ ë°ì´í„°ë² ì´ìŠ¤ë¡œ ë„˜ì–´ê°€ ë´…ì‹œë‹¤.</p>
<h1>ë°ì´í„°ë² ì´ìŠ¤ â€” sqlx</h1>
<p>ì´ ì„¹ì…˜ì—ì„œëŠ” Rust í”„ë¡œê·¸ë¨ì—ì„œ sqlxë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ ì‘ì—…ì„ ì‚´í´ë³¼ ê²ƒì…ë‹ˆë‹¤. ë¨¼ì € ì¼ë¶€ ì„¤ì •ì´ í•„ìš”í•©ë‹ˆë‹¤.</p>
<h2>ì„¤ì •</h2>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>ìƒˆ í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í•´ë´…ì‹œë‹¤. db_appì´ë¼ê³  ì´ë¦„ ì§“ê³ , cargo new db_appìœ¼ë¡œ ìƒì„±í•  ìˆ˜ ìˆì–´ìš”. ê¸°ë³¸ ë””ë ‰í† ë¦¬ì— ëª‡ ê°œì˜ íŒŒì¼ì„ ìƒì„±í•  ê±°ì—ìš”. ì²« ë²ˆì§¸ íŒŒì¼ì€ docker-compose.ymlì´ë¼ê³  í•˜ë©° ë‹¤ìŒ ë‚´ìš©ì´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤. Postgresì™€ Pgadminì´ ë…¸ì¶œë˜ëŠ” ì„ì˜ì˜ í¬íŠ¸ë¥¼ ì„ íƒí–ˆìœ¼ë©°, ì»´í“¨í„°ì— ì„¤ì¹˜ëœ ë‹¤ë¥¸ ì•±ë“¤ê³¼ ì¶©ëŒí•˜ì§€ ì•Šë„ë¡ í–ˆì–´ìš”.</p>
<pre><code class="hljs language-js"><span class="hljs-attr">version</span>: <span class="hljs-string">'3'</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">postgres</span>:
    <span class="hljs-attr">image</span>: <span class="hljs-attr">postgres</span>:latest
    <span class="hljs-attr">container_name</span>: postgres
    <span class="hljs-attr">ports</span>:
      - <span class="hljs-string">'6500:5432'</span>
    <span class="hljs-attr">volumes</span>:
      - <span class="hljs-attr">postgresDB</span>:<span class="hljs-regexp">/data/</span>postgres
    <span class="hljs-attr">env_file</span>:
      - ./.<span class="hljs-property">env</span>
  <span class="hljs-attr">pgAdmin</span>:
    <span class="hljs-attr">image</span>: dpage/pgadmin4
    <span class="hljs-attr">container_name</span>: pgAdmin
    <span class="hljs-attr">env_file</span>:
      - ./.<span class="hljs-property">env</span>
    <span class="hljs-attr">ports</span>:
      - <span class="hljs-string">"5050:80"</span>
<span class="hljs-attr">volumes</span>:
  <span class="hljs-attr">postgresDB</span>:
</code></pre>
<p>.envì´ë¼ëŠ” íŒŒì¼ì´ í•˜ë‚˜ ë” í•„ìš”í•˜ë©°, ë‹¤ìŒ ë‚´ìš©ì´ ìˆì–´ì•¼ í•´ìš”. ì´ íŒŒì¼ì€ docker-compose íŒŒì¼ê³¼ ë‚˜ì¤‘ì— Rust ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ëª¨ë‘ ì‚¬ìš©í•  ê±°ì—ìš”.</p>
<pre><code class="hljs language-js"><span class="hljs-variable constant_">POSTGRES_HOST</span>=<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>
<span class="hljs-variable constant_">POSTGRES_PORT</span>=<span class="hljs-number">6500</span>
<span class="hljs-variable constant_">POSTGRES_USER</span>=admin
<span class="hljs-variable constant_">POSTGRES_PASSWORD</span>=password123
<span class="hljs-variable constant_">POSTGRES_DB</span>=charging_session

<span class="hljs-variable constant_">DATABASE_URL</span>=<span class="hljs-attr">postgresql</span>:<span class="hljs-comment">//admin:password123@localhost:6500/charging_session?currentSchema=public</span>

<span class="hljs-variable constant_">PGADMIN_DEFAULT_EMAIL</span>=admin@admin.<span class="hljs-property">com</span>
<span class="hljs-variable constant_">PGADMIN_DEFAULT_PASSWORD</span>=password123
</code></pre>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>ìœ„ì˜ ë‚´ìš©ê³¼ í•¨ê»˜ ë°ì´í„°ë² ì´ìŠ¤ ì‚¬ìš©ì, ë¹„ë°€ë²ˆí˜¸, ê·¸ë¦¬ê³  Pgadminì— ëŒ€í•œ ì—°ê²° ì •ë³´ë¥¼ ì œê³µí•´ ë“œë ¸ìŠµë‹ˆë‹¤.</p>
<p>ì´ ë‘ ê°€ì§€ í•­ëª©ì„ ë§Œë“¤ê³  ìœ„ì˜ ë‚´ìš©ì„ ì‚¬ìš©í•˜ì—¬ Docker Composeë¥¼ ì‚¬ìš©í•˜ì—¬ ë¡œì»¬ DB ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì²˜ìŒì—ëŠ” í•­ìƒ ì „ê²½ì—ì„œ ì‹œì‘í•˜ëŠ” ê²ƒì„ ì¢‹ì•„í•©ë‹ˆë‹¤. ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ë° ê¸°íƒ€ ì‘ì—…ì„ í•˜ê¸° ë•Œë¬¸ì— ì—¬ëŸ¬ë¶„ì˜ ì»´í“¨í„° ë° ë„¤íŠ¸ì›Œí¬ ì†ë„ì— ë”°ë¼ ì‹œê°„ì´ ì†Œìš”ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. docker-compose.yml ë° .env íŒŒì¼ì´ ìˆëŠ” ë””ë ‰í† ë¦¬ì™€ ë™ì¼í•œ ìœ„ì¹˜ì—ì„œ ë‹¤ìŒì„ ì‹¤í–‰í•˜ì‹­ì‹œì˜¤.</p>
<pre><code class="hljs language-js">docker-compose up
</code></pre>
<p>ì‹œì‘ëœ ëª¨ë“  ê²ƒì„ í™•ì¸í•œ í›„ì—ëŠ” ì–¸ì œë“ ì§€ -d ìŠ¤ìœ„ì¹˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ëª¬ ëª¨ë“œë¡œ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì™„ë£Œë˜ë©´ ë‘ ì»¨í…Œì´ë„ˆê°€ ì‹œì‘ë˜ì—ˆëŠ”ì§€ í™•ì¸í•´ ë´…ì‹œë‹¤. ë‹¤ìŒê³¼ ê°™ì´ ëª…ë ¹ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.</p>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-js">docker ps
</code></pre>
<p>ë¹„ìŠ·í•œ ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤.</p>
<img src="/assets/img/2024-05-23-LearningRustPart11BuildersandDatabaseInteraction_1.png">
<p>ë§Œì•½ ë‘ ê°œì˜ ì»¨í…Œì´ë„ˆê°€ í‘œì‹œë˜ì§€ ì•ŠëŠ”ë‹¤ë©´, docker-composeë¥¼ ì‹¤í–‰í•œ í„°ë¯¸ë„ì—ì„œ ì—ëŸ¬ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”.</p>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>í•œ ë²ˆ ì´ë“¤ì´ ì‹¤í–‰ë˜ë©´ DBì— ì—°ê²°í•´ ë´…ì‹œë‹¤. Pgadminì„ í¬íŠ¸ 5050ì—ì„œ ì‹¤í–‰í•˜ë„ë¡ êµ¬ì„±í–ˆìœ¼ë‹ˆ ë¸Œë¼ìš°ì €ì—ì„œ <a href="http://localhost:5050%EC%9D%84" rel="nofollow" target="_blank">http://localhost:5050ì„</a> ì…ë ¥í•˜ë©´ pgadminì˜ ë¡œê·¸ì¸ í™”ë©´ì´ í‘œì‹œë©ë‹ˆë‹¤. .env íŒŒì¼ì— êµ¬ì„±ëœ ìê²© ì¦ëª…(ê´€ë¦¬ì@ê´€ë¦¬ì.com/ë¹„ë°€ë²ˆí˜¸123)ì„ ì‚¬ìš©í•˜ì—¬ pgadminì— ë¡œê·¸ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ°ë° ì•„ì§ ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ ë‹¤ìŒì„ ì‹¤í–‰í•´ì•¼ í•©ë‹ˆë‹¤.</p>
<pre><code class="hljs language-js">docker inspect postgres
</code></pre>
<p>ì¶œë ¥ì„ í™•ì¸í•˜ì—¬ "NetworkSettings" ì„¹ì…˜ìœ¼ë¡œ ì´ë™í•˜ê³  "IPAddress" ì†ì„±ì˜ ê°’ì„ ë³µì‚¬í•©ë‹ˆë‹¤. ì´ ê°’ì€ DBì— ì—°ê²°í•˜ëŠ” ë° ì‚¬ìš©í•  í˜¸ìŠ¤íŠ¸(IP)ì…ë‹ˆë‹¤. ì œ ì»´í“¨í„°ì—ì„œ ì´ ê°’ì€ 172.23.0.1 ì´ì—ˆìŠµë‹ˆë‹¤.</p>
<p>ë¡œê·¸ì¸í•œ í›„ "ìƒˆ ì„œë²„ ì¶”ê°€" ë²„íŠ¼ì„ í´ë¦­í•˜ê³ , "í˜¸ìŠ¤íŠ¸ ì´ë¦„/ì£¼ì†Œ"ë¡œ ì´ì „ì— ë³µì‚¬í•œ IP ì£¼ì†Œë¥¼ í¬í•¨í•œ í•„ìˆ˜ ìê²© ì¦ëª…ì„ ì œê³µí•˜ê³  "ì €ì¥" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.</p>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>ì„œë²„ì— ë¡œê·¸ì¸í•˜ë©´ ë°ì´í„°ë² ì´ìŠ¤ charging_sessionì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p><img src="/assets/img/2024-05-23-LearningRustPart11BuildersandDatabaseInteraction_2.png" alt="ì´ë¯¸ì§€"></p>
<p>ì˜ í–ˆì–´ìš”. ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì‚¬ìš©í•  ì¤€ë¹„ê°€ ë˜ì—ˆê³  Pgadminì—ì„œ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>ì´ì œ Rust ì•±ì˜ ì¢…ì†ì„±ì„ êµ¬ì„±í•´ ë´…ì‹œë‹¤. ì²˜ìŒì—ëŠ” ëª¨ë‘ í•„ìš”í•˜ì§€ ì•Šì§€ë§Œ ê²°êµ­ í•„ìš”í•˜ê²Œ ë  ê²ƒì´ë¯€ë¡œ ì§€ê¸ˆ ì¶”ê°€í•´ ë‘ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.</p>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>Cargo.toml íŒŒì¼ì˜ ì¢…ì†ì„± ë¶€ë¶„ì„ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜ì •í•˜ì„¸ìš”.</p>
<pre><code class="hljs language-toml"><span class="hljs-section">[dependencies]</span>
<span class="hljs-attr">chrono</span> = { version = <span class="hljs-string">"0.4.31"</span>, features = [<span class="hljs-string">"serde"</span>] }
<span class="hljs-attr">dotenv</span> = <span class="hljs-string">"0.15.0"</span>
<span class="hljs-attr">env_logger</span> = <span class="hljs-string">"0.10.1"</span>
<span class="hljs-attr">log</span> = <span class="hljs-string">"0.4.20"</span>
<span class="hljs-attr">serde</span> = { version = <span class="hljs-string">"1.0.193"</span>, features = [<span class="hljs-string">"derive"</span>] }
<span class="hljs-attr">serde_json</span> = <span class="hljs-string">"1.0.108"</span>
<span class="hljs-attr">sqlx</span> = { version = <span class="hljs-string">"0.7.3"</span>, features = [<span class="hljs-string">"runtime-tokio-native-tls"</span>, <span class="hljs-string">"postgres"</span>, <span class="hljs-string">"uuid"</span>, <span class="hljs-string">"chrono"</span>] }
<span class="hljs-attr">tokio</span> = { version = <span class="hljs-string">"1.35.0"</span>, features = [<span class="hljs-string">"macros"</span>, <span class="hljs-string">"rt-multi-thread"</span>]}
<span class="hljs-attr">uuid</span> = { version = <span class="hljs-string">"1.6.1"</span>, features = [<span class="hljs-string">"serde"</span>, <span class="hljs-string">"v4"</span>] }
</code></pre>
<p>ë‹¤ì–‘í•œ ì¢…ì†ì„±ì— ëŒ€í•´ í™œì„±í™”ëœ ê¸°ëŠ¥ì„ ê²€í† í•˜ëŠ” ë°ë„ ì‹œê°„ì„ í• ì• í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.</p>
<p>ë‹¤ìŒìœ¼ë¡œ, í•„ìš”í•œ í…Œì´ë¸”ì„ ë§Œë“¤ê¸° ìœ„í•´ sqlx-cli ë§ˆì´ê·¸ë ˆì´ì…˜ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ê²ƒì…ë‹ˆë‹¤.</p>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>ìš°ì„  ëª…ë ¹ ì¤„ì—ì„œ ë‹¤ìŒì„ ì‹¤í–‰í•˜ì—¬ CLIë¥¼ ì„¤ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.</p>
<pre><code class="hljs language-js">cargo install sqlx-cli --no-<span class="hljs-keyword">default</span>-features --features rustls,postgres
</code></pre>
<p>ê·¸ëŸ° ë‹¤ìŒ ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ì„ ì´ˆê¸°í™”í•´ì•¼ í•©ë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì´ ì‹¤í–‰í•©ë‹ˆë‹¤.</p>
<pre><code class="hljs language-js">sqlx migrate add initial-tables
</code></pre>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>ì´ ëª…ë ¹ì–´ëŠ” ìš°ë¦¬ê°€ ë§ˆì´ê·¸ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•˜ê¸° ìœ„í•´ ìƒˆ íŒŒì¼ migrations/<code>timestamp</code>_initial-tables.sqlì„ ìƒì„±í•©ë‹ˆë‹¤.</p>
<p><img src="/assets/img/2024-05-23-LearningRustPart11BuildersandDatabaseInteraction_3.png" alt="ì´ë¯¸ì§€"></p>
<p>ì´ íŒŒì¼ì„ ì—´ê³  ì•„ë˜ SQL ë¬¸ì„ ì¶”ê°€í•˜ì—¬ í…Œì´ë¸”ì„ ìƒì„±í•˜ì„¸ìš”.</p>
<p>create table locations (
id bigserial primary key,
name varchar(255) unique not null
);</p>
<p>create table sessions (
id bigserial primary key,
location_id bigint not null,
watts bigint not null,
vin varchar(255) not null,
constraint fk_location foreign key (location_id) references locations(id) on delete cascade
);</p>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>ìœ„ ì˜ˆì œì—ì„œ ì‚¬ìš©í•  ë‘ ê°œì˜ í…Œì´ë¸” ì •ì˜ì…ë‹ˆë‹¤. ì´ ì‹œë¦¬ì¦ˆì˜ ì¶©ì „ ì„¸ì…˜ì— ëŒ€í•œ í‘œì¤€ ì˜ˆì œë¥¼ í™•ì¥í•˜ì—¬, ì¶©ì „ ì¥ì¹˜ì˜ ìœ„ì¹˜ë¥¼ ì €ì¥í•  locations í…Œì´ë¸”ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.</p>
<p>ì´ì œ ë‹¤ìŒì„ ì‹¤í–‰í•˜ì—¬ í…Œì´ë¸”ì„ ìƒì„±í•˜ì„¸ìš”.</p>
<pre><code class="hljs language-js">sqlx migrate run
</code></pre>
<p>ê·¸ëŸ¬ë©´ ì¦‰ì‹œ 20231212235431/migrate initial-tables (íƒ€ì„ìŠ¤íƒ¬í”„ ë¶€ë¶„ì€ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŒ)ê³¼ ê°™ì€ ë©”ì‹œì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤. ì´ì œ Pgadminì— ê°€ì„œ í…Œì´ë¸”ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<img src="/assets/img/2024-05-23-LearningRustPart11BuildersandDatabaseInteraction_4.png">
<p>ìœ„ì—ì„œ ë³´ë“¯ì´ ë‘ ê°œì˜ í…Œì´ë¸”ì´ ìƒì„±ë˜ì—ˆê³ , ë¬¸ì„œ ëª©ì ì„ ìœ„í•´ Pgadmin ë‚´ì— ERD ë‹¤ì´ì–´ê·¸ë¨ë„ ìƒì„±í–ˆìŠµë‹ˆë‹¤. ì´ì œ ì´ˆê¸° ì„¤ì •ê³¼ í”„ë¡œì íŠ¸ êµ¬ì„±ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤.</p>
<h1>ë°ì´í„°ë² ì´ìŠ¤ í•¨ìˆ˜</h1>
<p>ì´ ì„¹ì…˜ì—ì„œëŠ” ë°ì´í„°ë² ì´ìŠ¤ ìƒí˜¸ ì‘ìš©ì˜ ë‹¤ì–‘í•œ ìœ í˜•ê³¼ Rust êµ¬í˜„ì„ ì‚´í´ë³¼ ê²ƒì…ë‹ˆë‹¤. ì´ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°í•˜ëŠ” ê²ƒìœ¼ë¡œ ì‹œì‘ë©ë‹ˆë‹¤.</p>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>DBì— ì—°ê²°í•˜ê¸°</p>
<p>ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°í•˜ëŠ” ë°©ë²•ì€ PgPoolOptions connect í•¨ìˆ˜ë¥¼ í†µí•´ ì—°ê²°ì„ ìƒì„±í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ìš°ë¦¬ì˜ .env íŒŒì¼ì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ë¬¸ìì—´ì„ ì½ê³  ë¡œê¹…ì„ êµ¬ì„±í•˜ë©° ì„±ê³µ ë˜ëŠ” ì˜¤ë¥˜ë¥¼ ê¸°ë¡í•˜ëŠ” ì½”ë“œ ì „ì²´ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.</p>
<pre><code class="hljs language-js">use <span class="hljs-attr">sqlx</span>::{<span class="hljs-attr">postgres</span>::<span class="hljs-title class_">PgPoolOptions</span>, <span class="hljs-title class_">Pool</span>, <span class="hljs-title class_">Postgres</span>};
use <span class="hljs-attr">dotenv</span>::dotenv;
use <span class="hljs-attr">log</span>::{info, error};

#[<span class="hljs-attr">tokio</span>::main]
<span class="hljs-keyword">async</span> fn <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">if</span> <span class="hljs-attr">std</span>::<span class="hljs-attr">env</span>::<span class="hljs-title function_">var_os</span>(<span class="hljs-string">"RUST_LOG"</span>).<span class="hljs-title function_">is_none</span>(<span class="hljs-params"></span>) {
        <span class="hljs-attr">std</span>::<span class="hljs-attr">env</span>::<span class="hljs-title function_">set_var</span>(<span class="hljs-string">"RUST_LOG"</span>, <span class="hljs-string">"info"</span>);
    }
    <span class="hljs-title function_">dotenv</span>().<span class="hljs-title function_">ok</span>();
    <span class="hljs-attr">env_logger</span>::<span class="hljs-title function_">init</span>();

    <span class="hljs-keyword">let</span> database_url = <span class="hljs-attr">std</span>::<span class="hljs-attr">env</span>::<span class="hljs-title function_">var</span>(<span class="hljs-string">"DATABASE_URL"</span>).<span class="hljs-title function_">expect</span>(<span class="hljs-string">"DATABASE_URL must be set"</span>);
    <span class="hljs-keyword">let</span> pool = match <span class="hljs-title class_">PgPoolOptions</span>::<span class="hljs-title function_">new</span>()
        .<span class="hljs-title function_">max_connections</span>(<span class="hljs-number">10</span>)
        .<span class="hljs-title function_">connect</span>(&#x26;database_url)
        .<span class="hljs-property">await</span>
    {
        <span class="hljs-title class_">Ok</span>(pool) => {
            info!(<span class="hljs-string">"âœ… ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤!"</span>);
            pool
        }
        <span class="hljs-title class_">Err</span>(err) => {
            error!(<span class="hljs-string">"ğŸ”¥ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: {:?}"</span>, err);
            <span class="hljs-attr">std</span>::<span class="hljs-attr">process</span>::<span class="hljs-title function_">exit</span>(<span class="hljs-number">1</span>);
        }
    };
}
</code></pre>
<p>ì‹œì‘ ë¶€ë¶„ì˜ #[tokio::main] ë§¤í¬ë¡œë¥¼ ì£¼ëª©í•´ì£¼ì„¸ìš”. ì´ëŠ” async fn main()ì„ ë™ê¸° fn main()ë¡œ ë³€í™˜í•˜ì—¬ ëŸ°íƒ€ì„ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì´ˆê¸°í™”í•˜ê³  async main í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ê²Œ í•©ë‹ˆë‹¤.</p>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>ìœ„ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë©´ ì¶œë ¥ ë¡œê¹…ì—ì„œ ë‹¤ìŒ ë©”ì‹œì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤.</p>
<p>[2023-12-13T00:16:42Z INFO db_app] âœ… ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤!</p>
<p>ìš°ë¦¬ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. .env íŒŒì¼ì—ì„œ êµ¬ì„±í•œ ëª¨ë“  ì—°ê²° ì •ë³´ë¥¼ ê¸°ì–µí•´ ì£¼ì„¸ìš”. ì´ ì •ë³´ëŠ” docker-compose, sqlx-cli, ê·¸ë¦¬ê³  ìš°ë¦¬ì˜ ì–´í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ê³µìœ ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
<h2>Inserts</h2>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>ì´ì œ ì—°ê²° í’€ì´ ì¤€ë¹„ë˜ì—ˆìœ¼ë‹ˆ, ìš°ë¦¬ê°€ ì‚´í´ë³¼ ì²« ë²ˆì§¸ ë°ì´í„°ë² ì´ìŠ¤ ë¡œì§ì€ ì‚½ì…ì…ë‹ˆë‹¤. sqlxë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚½ì…í•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>
<pre><code class="hljs language-rust"><span class="hljs-keyword">let</span> <span class="hljs-variable">insert_result</span> = sqlx::query_as!(
    Locations,
    <span class="hljs-string">"INSERT INTO locations (id,name) VALUES (1, 'Location A') RETURNING *"</span>
)
.<span class="hljs-title function_ invoke__">fetch_one</span>(&#x26;pool)
.<span class="hljs-keyword">await</span>;

<span class="hljs-keyword">match</span> insert_result {
    <span class="hljs-title function_ invoke__">Ok</span>(location) => {
        info!(<span class="hljs-string">"âœ“Inserted: {:?}"</span>, location);
    }
    <span class="hljs-title function_ invoke__">Err</span>(e) => {
        error!(<span class="hljs-string">"Error Insert: {}"</span>, e.<span class="hljs-title function_ invoke__">to_string</span>())
    }
}
</code></pre>
<p>ì´ ì½”ë“œëŠ” í•˜ë‚˜ì˜ ë ˆì½”ë“œë¥¼ ì‚½ì…í•  ê²ƒì…ë‹ˆë‹¤. ë¬¼ë¡  ë§¤ê°œë³€ìˆ˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆìœ¼ë©°, ì´ëŠ” ì—…ë°ì´íŠ¸ë¥¼ ì‚´í´ë³¼ ë•Œ ì‚´í´ë³¼ ê²ƒì…ë‹ˆë‹¤.</p>
<h2>ì§ˆì˜í•˜ê¸°</h2>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>ë‹¤ìŒìœ¼ë¡œ, ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì¡°íšŒí•˜ëŠ” ë°©ë²•ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.</p>
<pre><code class="hljs language-js">    <span class="hljs-keyword">let</span> query_result = <span class="hljs-attr">sqlx</span>::query_as!(<span class="hljs-title class_">Locations</span>, <span class="hljs-string">"SELECT * FROM Locations"</span>)
        .<span class="hljs-title function_">fetch_all</span>(&#x26;pool)
        .<span class="hljs-property">await</span>;
    <span class="hljs-keyword">if</span> query_result.<span class="hljs-title function_">is_err</span>(<span class="hljs-params"></span>) {
        <span class="hljs-keyword">let</span> message = <span class="hljs-string">"ëª¨ë“  ìœ„ì¹˜ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë™ì•ˆ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."</span>;
        error!(<span class="hljs-string">"{}{}"</span>, message, query_result.<span class="hljs-title function_">err</span>().<span class="hljs-title function_">unwrap</span>());
    } <span class="hljs-keyword">else</span> {
        info!(<span class="hljs-string">"ğŸ˜ ìœ„ì¹˜ì— ëŒ€í•œ ì¿¼ë¦¬ ê²°ê³¼ {:?}"</span>, query_result.<span class="hljs-title function_">unwrap</span>());
    }
</code></pre>
<p>ì´ê²ƒì€ ì„±ê³µì ìœ¼ë¡œ ì‘ë™í–ˆë‹¤ë©´ unwrapì„ í†µí•´ ê²°ê³¼ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ê²°ê³¼ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. ì¿¼ë¦¬ ë‚´ì˜ ì´ìŠˆê°€ ë°œìƒí–ˆë‹¤ë©´ í•´ë‹¹ ì—ëŸ¬ì— ì ‘ê·¼í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.</p>
<h2>ì—…ë°ì´íŠ¸</h2>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>ë‹¤ìŒ ì‘ì—…ì€ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ëŠ” ì´ì „ì— ì‚½ì…í•œ ê²ƒê³¼ ë¹„ìŠ·í•  ê²ƒì…ë‹ˆë‹¤.</p>
<pre><code class="hljs language-js">    <span class="hljs-keyword">let</span> update_result = <span class="hljs-attr">sqlx</span>::query_as!(
        <span class="hljs-title class_">Sessions</span>,
        <span class="hljs-string">"UPDATE sessions SET watts = 415 WHERE id = $1 RETURNING *"</span>,
        1i64,
    )
    .<span class="hljs-title function_">fetch_one</span>(&#x26;pool)
    .<span class="hljs-property">await</span>;

    match update_result {
        <span class="hljs-title class_">Ok</span>(session) => {
            info!(<span class="hljs-string">"âœ“Update: {:?}"</span>, session);
        }
        <span class="hljs-title class_">Err</span>(e) => {
            error!(<span class="hljs-string">"Error Update: {}"</span>, e.<span class="hljs-title function_">to_string</span>())
        }
    }
</code></pre>
<p>ì´ ì˜ˆì œì—ì„œ ì£¼ëª©í•  ì ì€ $1ì´ë¼ëŠ” ë§¤ê°œë³€ìˆ˜ ìë¦¬ í‘œì‹œìë¥¼ ì‚¬ìš©í•˜ëŠ” ì¤€ë¹„ëœ ë¬¸(statement)ë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ SQL ë¬¸ìì—´ ë’¤ì— ë§¤ê°œë³€ìˆ˜ë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤.</p>
<h2>Deletes</h2>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>ë§ˆì§€ë§‰ìœ¼ë¡œ, ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ë ˆì½”ë“œë¥¼ ì‚­ì œí•˜ëŠ” CRUD ì‘ì—…ì„ ì™„ë£Œí•©ë‹ˆë‹¤. ìš°ë¦¬ì˜ ëª©ì ì€ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì •ë¦¬í•˜ëŠ” ë° ì‚¬ìš©í•  ê²ƒì´ë©°, ì´ë ‡ê²Œ í•˜ë©´ ì–¸ì œë“ ì§€ ì‘ìš© í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">let</span> rows_deleted = <span class="hljs-attr">sqlx</span>::query!(<span class="hljs-string">"DELETE from sessions"</span>)
    .<span class="hljs-title function_">execute</span>(&#x26;pool)
    .<span class="hljs-property">await</span>
    .<span class="hljs-title function_">unwrap</span>()
    .<span class="hljs-title function_">rows_affected</span>();

info!(<span class="hljs-string">"âœ• ì„¸ì…˜ í…Œì´ë¸”ì—ì„œ {}ê°œì˜ í–‰ ì‚­ì œë¨"</span>, rows_deleted);
</code></pre>
<p>ì—¬ê¸°ì„œëŠ” ì—°ì‚°ì—ì„œì²˜ëŸ¼ sqlx::query ëŒ€ì‹  sqlx::query_asë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ë˜í•œ ì–¸ë© ì´í›„ .rows_affectedë¥¼ ì¶”ê°€í•˜ì—¬ ì‚­ì œëœ í–‰ ìˆ˜ë¥¼ ì–»ìŠµë‹ˆë‹¤.</p>
<h2>íŠ¸ëœì­ì…˜</h2>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-rust">   <span class="hljs-keyword">let</span> <span class="hljs-variable">tx</span> = pool.<span class="hljs-title function_ invoke__">begin</span>().<span class="hljs-keyword">await</span>.<span class="hljs-title function_ invoke__">expect</span>(<span class="hljs-string">"íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤"</span>);

   <span class="hljs-comment">// ë°ì´í„°ë² ì´ìŠ¤ ì‘ì—… ìˆ˜í–‰(ë°ì´í„° ì‚½ì… ë˜ëŠ” ë³€ê²½)</span>

   tx.<span class="hljs-title function_ invoke__">commit</span>().<span class="hljs-keyword">await</span>.<span class="hljs-title function_ invoke__">expect</span>(<span class="hljs-string">"íŠ¸ëœì­ì…˜ì„ ì»¤ë°‹í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤"</span>);
</code></pre>
<p>ì»¤ë°‹ì„ í˜¸ì¶œí•˜ì§€ ì•Šìœ¼ë©´ íŠ¸ëœì­ì…˜ì´ ë²”ìœ„ë¥¼ ë²—ì–´ë‚˜ë©´ ìë™ìœ¼ë¡œ ë¡¤ë°±ë©ë‹ˆë‹¤.</p>
<h2>ì™„ì „í•œ ì‘ìš© í”„ë¡œê·¸ë¨</h2>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>ìœ„ì˜ ì½”ë“œëŠ” ìš°ë¦¬ê°€ ì´ì „ì— ë…¼ì˜í•œ ëª¨ë“  ë‹¤ì–‘í•œ ê¸°ëŠ¥ì´ í•˜ë‚˜ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ëª¨ë‘ í¬í•¨ëœ ì™„ì „í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤.</p>
<pre><code class="hljs language-js">use <span class="hljs-attr">dotenv</span>::dotenv;
use <span class="hljs-attr">log</span>::{error, info};
use <span class="hljs-attr">sqlx</span>::{<span class="hljs-attr">postgres</span>::<span class="hljs-title class_">PgPoolOptions</span>, <span class="hljs-title class_">Pool</span>, <span class="hljs-title class_">Postgres</span>};

#[<span class="hljs-title function_">derive</span>(<span class="hljs-title class_">Debug</span>)]
struct <span class="hljs-title class_">Locations</span> {
    <span class="hljs-attr">id</span>: i64,
    <span class="hljs-attr">name</span>: <span class="hljs-title class_">String</span>,
}

#[<span class="hljs-title function_">derive</span>(<span class="hljs-title class_">Debug</span>)]
struct <span class="hljs-title class_">Sessions</span> {
    <span class="hljs-attr">id</span>: i64,
    <span class="hljs-attr">location_id</span>: i64,
    <span class="hljs-attr">watts</span>: i64,
    <span class="hljs-attr">vin</span>: <span class="hljs-title class_">String</span>,
}
<span class="hljs-keyword">async</span> fn <span class="hljs-title function_">insert_into_locations</span>(<span class="hljs-params">pool: Pool&#x3C;Postgres></span>) {
    <span class="hljs-keyword">let</span> tx = pool.<span class="hljs-title function_">begin</span>().<span class="hljs-property">await</span>.<span class="hljs-title function_">expect</span>(<span class="hljs-string">"Unable to begin transaction"</span>);

    <span class="hljs-keyword">let</span> insert_result = <span class="hljs-attr">sqlx</span>::query_as!(
        <span class="hljs-title class_">Locations</span>,
        <span class="hljs-string">"INSERT INTO locations (id,name) VALUES (1, 'Location A') RETURNING *"</span>
    )
    .<span class="hljs-title function_">fetch_one</span>(&#x26;pool)
    .<span class="hljs-property">await</span>;

    match insert_result {
        <span class="hljs-title class_">Ok</span>(location) => {
            info!(<span class="hljs-string">"âœ“Inserted: {:?}"</span>, location);
        }
        <span class="hljs-title class_">Err</span>(e) => {
            error!(<span class="hljs-string">"Error Insert: {}"</span>, e.<span class="hljs-title function_">to_string</span>())
        }
    }
    <span class="hljs-keyword">let</span> insert_result = <span class="hljs-attr">sqlx</span>::query_as!(
        <span class="hljs-title class_">Locations</span>,
        <span class="hljs-string">"INSERT INTO locations (id,name) VALUES (2, 'Location B') RETURNING *"</span>
    )
    .<span class="hljs-title function_">fetch_one</span>(&#x26;pool)
    .<span class="hljs-property">await</span>;

    match insert_result {
        <span class="hljs-title class_">Ok</span>(location) => {
            info!(<span class="hljs-string">"âœ“Inserted: {:?}"</span>, location);
        }
        <span class="hljs-title class_">Err</span>(e) => {
            error!(<span class="hljs-string">"Error Insert: {}"</span>, e.<span class="hljs-title function_">to_string</span>())
        }
    }

    tx.<span class="hljs-title function_">commit</span>().<span class="hljs-property">await</span>.<span class="hljs-title function_">expect</span>(<span class="hljs-string">"Unable to commit the transaction"</span>);
}

<span class="hljs-keyword">async</span> fn <span class="hljs-title function_">insert_into_sessions</span>(<span class="hljs-params">pool: Pool&#x3C;Postgres></span>) {
    <span class="hljs-keyword">let</span> tx = pool.<span class="hljs-title function_">begin</span>().<span class="hljs-property">await</span>.<span class="hljs-title function_">expect</span>(<span class="hljs-string">"Unable to begin transaction"</span>);

    <span class="hljs-keyword">let</span> insert_result = <span class="hljs-attr">sqlx</span>::query_as!(
        <span class="hljs-title class_">Sessions</span>,
        <span class="hljs-string">"INSERT INTO sessions (id,location_id, watts, vin) VALUES (1, 1, 420, '2FMZA52286BA02033') RETURNING *"</span>
    )
    .<span class="hljs-title function_">fetch_one</span>(&#x26;pool)
    .<span class="hljs-property">await</span>;

    match insert_result {
        <span class="hljs-title class_">Ok</span>(session) => {
            info!(<span class="hljs-string">"âœ“Inserted: {:?}"</span>, session);
        }
        <span class="hljs-title class_">Err</span>(e) => {
            error!(<span class="hljs-string">"Error Insert: {}"</span>, e.<span class="hljs-title function_">to_string</span>())
        }
    }
    <span class="hljs-keyword">let</span> insert_result = <span class="hljs-attr">sqlx</span>::query_as!(
        <span class="hljs-title class_">Sessions</span>,
        <span class="hljs-string">"INSERT INTO sessions (id,location_id, watts, vin) VALUES (2, 2, 393, '1GMYA52286BA04055') RETURNING *"</span>
)
    .<span class="hljs-title function_">fetch_one</span>(&#x26;pool)
    .<span class="hljs-property">await</span>;

    match insert_result {
        <span class="hljs-title class_">Ok</span>(session) => {
            info!(<span class="hljs-string">"âœ“Inserted: {:?}"</span>, session);
        }
        <span class="hljs-title class_">Err</span>(e) => {
            error!(<span class="hljs-string">"Error Insert: {}"</span>, e.<span class="hljs-title function_">to_string</span>())
        }
    }

    tx.<span class="hljs-title function_">commit</span>().<span class="hljs-property">await</span>.<span class="hljs-title function_">expect</span>(<span class="hljs-string">"Unable to commit the transaction"</span>);
}

<span class="hljs-keyword">async</span> fn <span class="hljs-title function_">update_sessions</span>(<span class="hljs-params">pool: Pool&#x3C;Postgres></span>) {
    <span class="hljs-keyword">let</span> tx = pool.<span class="hljs-title function_">begin</span>().<span class="hljs-property">await</span>.<span class="hljs-title function_">expect</span>(<span class="hljs-string">"Unable to begin transaction"</span>);

    <span class="hljs-keyword">let</span> update_result = <span class="hljs-attr">sqlx</span>::query_as!(
        <span class="hljs-title class_">Sessions</span>,
        <span class="hljs-string">"UPDATE sessions SET watts = 415 WHERE id = $1 RETURNING *"</span>,
        1i64,
    )
    .<span class="hljs-title function_">fetch_one</span>(&#x26;pool)
    .<span class="hljs-property">await</span>;

    match update_result {
        <span class="hljs-title class_">Ok</span>(session) => {
            info!(<span class="hljs-string">"âœ“Update: {:?}"</span>, session);
        }
        <span class="hljs-title class_">Err</span>(e) => {
            error!(<span class="hljs-string">"Error Update: {}"</span>, e.<span class="hljs-title function_">to_string</span>())
        }
    }

    tx.<span class="hljs-title function_">commit</span>().<span class="hljs-property">await</span>.<span class="hljs-title function_">expect</span>(<span class="hljs-string">"Unable to commit the transaction"</span>);
}

<span class="hljs-keyword">async</span> fn <span class="hljs-title function_">clean_db</span>(<span class="hljs-params">pool: Pool&#x3C;Postgres></span>) {
    <span class="hljs-keyword">let</span> rows_deleted = <span class="hljs-attr">sqlx</span>::query!(<span class="hljs-string">"DELETE from sessions"</span>)
        .<span class="hljs-title function_">execute</span>(&#x26;pool)
        .<span class="hljs-property">await</span>
        .<span class="hljs-title function_">unwrap</span>()
        .<span class="hljs-title function_">rows_affected</span>();

    info!(<span class="hljs-string">"âœ•Deleted {} rows from sessions table"</span>, rows_deleted);

    <span class="hljs-keyword">let</span> rows_deleted = <span class="hljs-attr">sqlx</span>::query!(<span class="hljs-string">"DELETE from locations"</span>)
        .<span class="hljs-title function_">execute</span>(&#x26;pool)
        .<span class="hljs-property">await</span>
        .<span class="hljs-title function_">unwrap</span>()
        .<span class="hljs-title function_">rows_affected</span>();
    info!(<span class="hljs-string">"âœ•Deleted {} rows from locations table"</span>, rows_deleted);
}

<span class="hljs-keyword">async</span> fn <span class="hljs-title function_">query_locations</span>(<span class="hljs-params">pool: Pool&#x3C;Postgres></span>) {
    <span class="hljs-keyword">let</span> query_result = <span class="hljs-attr">sqlx</span>::query_as!(<span class="hljs-title class_">Locations</span>, <span class="hljs-string">"SELECT * FROM Locations"</span>)
        .<span class="hljs-title function_">fetch_all</span>(&#x26;pool)
        .<span class="hljs-property">await</span>;
    <span class="hljs-keyword">if</span> query_result.<span class="hljs-title function_">is_err</span>(<span class="hljs-params"></span>) {
        <span class="hljs-keyword">let</span> message = <span class="hljs-string">"Something bad happened while fetching all locations"</span>;
        error!(<span class="hljs-string">"{}"</span>, message);
    } <span class="hljs-keyword">else</span> {
        info!(<span class="hljs-string">"ğŸ˜Query Result For Locations {:?}"</span>, query_result);
    }
}

<span class="hljs-keyword">async</span> fn <span class="hljs-title function_">query_sessions</span>(<span class="hljs-params">pool: Pool&#x3C;Postgres></span>) {
    <span class="hljs-keyword">let</span> query_result = <span class="hljs-attr">sqlx</span>::query_as!(<span class="hljs-title class_">Sessions</span>, <span class="hljs-string">"SELECT * FROM Sessions"</span>)
        .<span class="hljs-title function_">fetch_all</span>(&#x26;pool)
        .<span class="hljs-property">await</span>;
    <span class="hljs-keyword">if</span> query_result.<span class="hljs-title function_">is_err</span>(<span class="hljs-params"></span>) {
        <span class="hljs-keyword">let</span> message = <span class="hljs-string">"Something bad happened while fetching all sessions"</span>;
        error!(<span class="hljs-string">"{}"</span>, message);
    } <span class="hljs-keyword">else</span> {
        info!(<span class="hljs-string">"ğŸ˜Query Result for Sessions {:?}"</span>, query_result);
    }
}

#[<span class="hljs-attr">tokio</span>::main]
<span class="hljs-keyword">async</span> fn <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">if</span> <span class="hljs-attr">std</span>::<span class="hljs-attr">env</span>::<span class="hljs-title function_">var_os</span>(<span class="hljs-string">"RUST_LOG"</span>).<span class="hljs-title function_">is_none</span>(<span class="hljs-params"></span>) {
        <span class="hljs-attr">std</span>::<span class="hljs-attr">env</span>::<span class="hljs-title function_">set_var</span>(<span class="hljs-string">"RUST_LOG"</span>, <span class="hljs-string">"info"</span>);
    }
    <span class="hljs-title function_">dotenv</span>().<span class="hljs-title function_">ok</span>();
    <span class="hljs-attr">env_logger</span>::<span class="hljs-title function_">init</span>();

    <span class="hljs-keyword">let</span> database_url = <span class="hljs-attr">std</span>::<span class="hljs-attr">env</span>::<span class="hljs-title function_">var</span>(<span class="hljs-string">"DATABASE_URL"</span>).<span class="hljs-title function_">expect</span>(<span class="hljs-string">"DATABASE_URL must be set"</span>);
    <span class="hljs-keyword">let</span> pool = match <span class="hljs-title class_">PgPoolOptions</span>::<span class="hljs-title function_">new</span>()
        .<span class="hljs-title function_">max_connections</span>(<span class="hljs-number">10</span>)
        .<span class="hljs-title function_">connect</span>(&#x26;database_url)
        .<span class="hljs-property">await</span>
    {
        <span class="hljs-title class_">Ok</span>(pool) => {
            info!(<span class="hljs-string">"âœ…Connection to the database is successful!"</span>);
            pool
        }
        <span class="hljs-title class_">Err</span>(err) => {
            error!(<span class="hljs-string">"ğŸ”¥ Failed to connect to the database: {:?}"</span>, err);
            <span class="hljs-attr">std</span>::<span class="hljs-attr">process</span>::<span class="hljs-title function_">exit</span>(<span class="hljs-number">1</span>);
        }
    };
    <span class="hljs-title function_">clean_db</span>(pool.<span class="hljs-title function_">clone</span>()).<span class="hljs-property">await</span>;

    <span class="hljs-title function_">insert_into_locations</span>(pool.<span class="hljs-title function_">clone</span>()).<span class="hljs-property">await</span>;
    <span class="hljs-title function_">query_locations</span>(pool.<span class="hljs-title function_">clone</span>()).<span class="hljs-property">await</span>;

    <span class="hljs-title function_">insert_into_sessions</span>(pool.<span class="hljs-title function_">clone</span>()).<span class="hljs-property">await</span>;
    <span class="hljs-title function_">query_sessions</span>(pool.<span class="hljs-title function_">clone</span>()).<span class="hljs-property">await</span>;

    <span class="hljs-title function_">update_sessions</span>(pool.<span class="hljs-title function_">clone</span>()).<span class="hljs-property">await</span>;
    <span class="hljs-title function_">query_sessions</span>(pool.<span class="hljs-title function_">clone</span>()).<span class="hljs-property">await</span>;
}
</code></pre>
<p>ìœ„ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•œ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>
<img src="/assets/img/2024-05-23-LearningRustPart11BuildersandDatabaseInteraction_5.png">
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>ìœ„ì™€ ê°™ì´ ë°ì´í„°ë² ì´ìŠ¤ ìƒí˜¸ì‘ìš© í† ë¡ ì„ ë§ˆì³¤ìŠµë‹ˆë‹¤. sqlxë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì¢‹ì€ ê°œìš”ë¥¼ ì œê³µí–ˆì„ ê²ë‹ˆë‹¤.</p>
<h1>ìš”ì•½</h1>
<p>ì €í¬ ëŸ¬ìŠ¤íŠ¸ í•™ìŠµ ì‹œë¦¬ì¦ˆì˜ ì´ ë¶€ë¶„ì„ ì¦ê¸°ì…¨ê¸°ë¥¼ ë°”ëë‹ˆë‹¤. ì‹œë¦¬ì¦ˆ ì´ë²ˆ ì„¹ì…˜ì—ì„œëŠ” ë¨¼ì € ëŸ¬ìŠ¤íŠ¸ì—ì„œ ê°ì²´ ìƒì„±ì— ëŒ€í•œ ë§¤ìš° ìœ ìš©í•œ íŒ¨í„´ì¸ ë¹Œë” íŒ¨í„´ì„ ì‚´í´ë³´ì•˜ìŠµë‹ˆë‹¤. ì´ëŠ” ë‹¤ë¥¸ ì–¸ì–´ì—ì„œ ìµìˆ™í•  ìˆ˜ ìˆì§€ë§Œ, ëŸ¬ìŠ¤íŠ¸ì—ì„œ ì–´ë–»ê²Œ êµ¬í˜„í•˜ëŠ”ì§€ ì‚´í´ë³´ì•˜ìŠµë‹ˆë‹¤.</p>
<p>ë‹¤ìŒìœ¼ë¡œ, ìš°ë¦¬ëŠ” Rustë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ì¸ íŠ¹íˆ Postgresì™€ ìƒí˜¸ì‘ìš©í•˜ëŠ” ë°©ë²•ì„ ê²€í† í–ˆìŠµë‹ˆë‹¤. ìš°ë¦¬ëŠ” ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ì‹¤í–‰í•˜ê³  ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°í•˜ëŠ” ë°©ë²•ì„ ë³´ì•˜ìœ¼ë©°, ê·¸ í›„ DBì— ëŒ€í•´ ì—¬ëŸ¬ ê°€ì§€ CRUD ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë°©ë²•ì„ ì‚´í´ë³´ì•˜ìŠµë‹ˆë‹¤.</p>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>ëŸ¬ìŠ¤íŠ¸ í•™ìŠµ ì—¬ì •ì— í•¨ê»˜í•´ì¤˜ì„œ ê³ ë§ˆì›Œìš”.</p>
<p>ì¢‹ì€ ì—¬í–‰ ë˜ì„¸ìš”!</p>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"ëŸ¬ìŠ¤íŠ¸ ë°°ìš°ê¸° 11ë¶€  ë¹Œë”ì™€ ë°ì´í„°ë² ì´ìŠ¤ ìƒí˜¸ì‘ìš©","description":"","date":"2024-05-23 14:11","slug":"2024-05-23-LearningRustPart11BuildersandDatabaseInteraction","content":"\në‹¤ìŒ ì‹œë¦¬ì¦ˆë¡œ ë„˜ì–´ê°€ë³´ê² ìŠµë‹ˆë‹¤; ì´ ë¶€ë¶„ì—ì„œëŠ” ë°ì´í„° êµ¬ì¡°ì— ë¹Œë” íŒ¨í„´ì„ êµ¬í˜„í•˜ëŠ” ë°©ë²•ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ sqlxì™€ Postgresë¥¼ ì‚¬ìš©í•œ ë°ì´í„°ë² ì´ìŠ¤ ìƒí˜¸ì‘ìš©ìœ¼ë¡œ ë„˜ì–´ê°€ê² ìŠµë‹ˆë‹¤.\n\n![ì´ë¯¸ì§€](/assets/img/2024-05-23-LearningRustPart11BuildersandDatabaseInteraction_0.png)\n\n# Rust ì‹œë¦¬ì¦ˆ\n\në¶€ë¶„ 1 â€” ê¸°ë³¸ ê°œë…\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nPart 2 â€” ë©”ëª¨ë¦¬\n\nPart 3 â€” íë¦„ ì œì–´ì™€ í•¨ìˆ˜\n\nPart 4 â€” ì˜µì…˜/ê²°ê³¼ ë° ì»¬ë ‰ì…˜\n\nPart 5 â€” íŠ¸ë ˆì´íŠ¸, ì œë„¤ë¦­ ë° í´ë¡œì €\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nì œ 6ë¶€ â€” ë§¤í¬ë¡œ, ë°˜ë³µì ë° íŒŒì¼ ì²˜ë¦¬\n\nì œ 7ë¶€ â€” ìŠ¤ë ˆë“œ ê³µìœ  ìƒíƒœ ë° ì±„ë„\n\nì œ 8ë¶€ â€” Cargo, í¬ë ˆì´íŠ¸, ëª¨ë“ˆ ë° ë¼ì´ë¸ŒëŸ¬ë¦¬\n\nì œ 9ë¶€ â€” ëª…ë ¹í–‰ ì¸ìˆ˜, ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ë° í…ŒìŠ¤íŒ…\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nì œ 10ë¶€ â€” ìƒì í¬ì¸í„° ë° ì›¹ ì•±\n\nì œ 11ë¶€ â€” ë¹Œë”ì™€ ë°ì´í„°ë² ì´ìŠ¤ ìƒí˜¸ì‘ìš© (ì´ ê¸°ì‚¬)\n\n# ì†Œê°œ\n\nì´ê²ƒì€ ëŸ¬ìŠ¤íŠ¸ í•™ìŠµ ì‹œë¦¬ì¦ˆì˜ ì—´í•œ ë²ˆì§¸ ì„¹ì…˜ì…ë‹ˆë‹¤. ì´ë²ˆì—ëŠ” ëŸ¬ìŠ¤íŠ¸ì—ì„œ ë¹Œë” íŒ¨í„´ì„ ë‹¤ë£° ê²ƒì…ë‹ˆë‹¤. ì´ ê³µí†µëœ íŒ¨í„´ì€ êµ¬ì¡°ì²´ë¥¼ ì•ˆì „í•˜ê³  íˆ¬ëª…í•˜ê²Œ ì´ˆê¸°í™”í•˜ëŠ” ì¢‹ì€ ë°©ë²•ì…ë‹ˆë‹¤. ë‹¤ìŒìœ¼ë¡œ, ìš°ë¦¬ëŠ” í¬ìŠ¤íŠ¸ê·¸ë ˆìŠ¤ì™€ SQLX í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ CRUD ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë°©ë²•ì„ ì‚´í´ë³¼ ê²ƒì…ë‹ˆë‹¤.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n# ì¤€ë¹„ë¬¼\n\nì´ ê¸€ì˜ ë°ì´í„°ë² ì´ìŠ¤ ë¶€ë¶„ì„ ìœ„í•œ ìœ ì¼í•œ ì¤€ë¹„ë¬¼ì€ Rustì™€ Cargoê°€ ì„¤ì¹˜ë˜ì–´ ìˆê³  ì‹œìŠ¤í…œì— Dockerê°€ ì„¤ì¹˜ë˜ì–´ ìˆëŠ” ê²ƒì…ë‹ˆë‹¤. ë§Œì•½ Dockerë¥¼ ê°€ì§€ê³  ìˆì§€ ì•Šì§€ë§Œ ë¡œì»¬ Postgres DBê°€ ì´ë¯¸ ì„¤ì¹˜ë˜ì–´ ìˆê±°ë‚˜ ë‹¤ë¥¸ ì„œë²„ì˜ DBì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆë‹¤ë©´ Docker Postgres ì„¤ì •ì„ ê±´ë„ˆë›°ê³  DBì— ì—°ê²°í•˜ê¸° ìœ„í•œ ì—°ê²° ì†ì„±ë§Œ ìˆ˜ì •í•˜ë©´ ë©ë‹ˆë‹¤.\n\n# ë¹Œë” íŒ¨í„´\n\në¹Œë” íŒ¨í„´ì€ ë³µì¡í•œ ê°ì²´ì˜ êµ¬ì„±ì„ í•´ë‹¹ í‘œí˜„ì—ì„œ ë¶„ë¦¬í•˜ëŠ” ë””ìì¸ íŒ¨í„´ì…ë‹ˆë‹¤. ì´ íŒ¨í„´ì„ ì‚¬ìš©í•˜ë©´ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ìˆ˜í–‰í•˜ê³  ê¸°ë³¸ê°’ìœ¼ë¡œ ëŒ€ì²´í•˜ë©° ê°’ì„ ë¶€ë¶„ì ìœ¼ë¡œ í• ë‹¹í•œ í›„ì— í•­ëª©ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nRustë¡œ ê·¸ êµ¬í˜„í•˜ëŠ” ë°©ë²•ì„ ì‚´í´ë³¼ ê±°ì˜ˆìš”. ì´ê²ƒì´ ìš°ë¦¬ì˜ ì½”ë“œì…ë‹ˆë‹¤.\n\n```js\n#[derive(Debug)]\nstruct ChargingSession {\n    id: String,\n    watts: u32,\n    vin: String,\n}\n\nstruct ChargingSessionBuilder {\n    id: String,\n    watts: Option\u003cu32\u003e,\n    vin: Option\u003cString\u003e,\n}\n\nimpl ChargingSessionBuilder {\n    fn new(id: \u0026str) -\u003e ChargingSessionBuilder {\n        ChargingSessionBuilder {\n            id: id.to_string(),\n            watts: None,\n            vin: None,\n        }\n    }\n\n    fn watts(mut self, watts: u32) -\u003e ChargingSessionBuilder {\n        self.watts = Some(watts);\n        self\n    }\n\n    fn vin(mut self, vin: \u0026str) -\u003e ChargingSessionBuilder {\n        self.vin = Some(vin.to_string());\n        self\n    }\n\n    fn build(self) -\u003e ChargingSession {\n        ChargingSession {\n            id: self.id,\n            watts: self.watts.unwrap_or_else(|| 0),\n            vin: self.vin.unwrap_or_else(|| \"Unknown\".to_string()),\n        }\n    }\n}\n\nfn main() {\n    // ì´ê²ƒì€ ChargingSessionì„ ìƒì„±í•˜ëŠ” í‘œì¤€ì ì¸ ë°©ë²•ì…ë‹ˆë‹¤.\n    let cs_old_way = ChargingSession {\n        id: String::from(\"11111\"),\n        watts: 420,\n        vin: String::from(\"4Y1SL65848Z411439\"),\n    };\n    println!(\"Regular way to create struct: {:?}\", cs_old_way);\n\n    // ë¹Œë”ë¥¼ ì‚¬ìš©í•´ì„œ ìƒì„±í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.\n    let cs = ChargingSessionBuilder::new(\"11111\")\n        .watts(420)\n        .vin(\"4Y1SL65848Z411439\")\n        .build();\n    println!(\"Builder pattern to create struct: {:?}\", cs);\n\n    // IDë§Œ ì œê³µí•˜ì—¬ ìƒì„±í•˜ëŠ” ì˜ˆì‹œì…ë‹ˆë‹¤.\n    let cs_lean = ChargingSessionBuilder::new(\"11111\")\n    .build();\n     println!(\"Builder pattern to create struct (default values): {:?}\", cs_lean);\n}\n```\n\nì´ê±¸ í•œ ë²ˆì— ì´í•´í•˜ê¸°ì— ë§ì§€ë§Œ, ë‹¨ê³„ì ìœ¼ë¡œ ì§„í–‰í•´ ë´…ì‹œë‹¤.\n\në¨¼ì €, ì¶©ì „ ì„¸ì…˜ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” êµ¬ì¡°ì²´ë¥¼ ì •ì˜í–ˆìŠµë‹ˆë‹¤. ì´ ì‹œë¦¬ì¦ˆì˜ ì´ì „ ì˜ˆì œì—ì„œ í•˜ë‚˜ì˜ í•„ë“œì¸ ì„¸ì…˜ìš© ì°¨ëŸ‰ ID ë²ˆí˜¸ì¸ vinì„ ì¶”ê°€í–ˆì–´ìš”.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nê·¸ëŸ¬ë©´ ë°ì´í„° êµ¬ì¡°ì²´ì™€ ë™ì¼í•œ í•„ë“œë¥¼ ê°€ì§„ ë¹Œë”ë¥¼ ìœ„í•œ êµ¬ì¡°ì²´ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.\n\në¹Œë”ëŠ” impl ë¸”ë¡ì—ì„œ êµ¬í˜„ë˜ë©°, id ë° ê° ì¶”ê°€ í•„ë“œë¥¼ ì„¤ì •í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì •ì˜í•˜ëŠ” ìƒˆ í•¨ìˆ˜ê°€ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ëª‡ ê°€ì§€ ì¤‘ìš”í•œ ì‚¬í•­ì´ ìˆìŠµë‹ˆë‹¤.\n\n- ê° í•¨ìˆ˜ëŠ” ChargingSessionBuilder ìœ í˜•ì„ ë°˜í™˜í•©ë‹ˆë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ selfì…ë‹ˆë‹¤.\n- ì¶”ê°€ ì†ì„± í•„ë“œì—ëŠ” mut selfë¥¼ ì²« ë²ˆì§¸ ë§¤ê°œë³€ìˆ˜ë¡œ ì‚¬ìš©í•˜ëŠ” ë©”ì„œë“œê°€ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ì´ëŸ¬í•œ í•¨ìˆ˜ í˜¸ì¶œì˜ ì²´ì´ë‹ì„ í—ˆìš©í•˜ëŠ” ë° ì¤‘ìš”í•©ë‹ˆë‹¤. ë˜í•œ ì—¬ê¸°ì— ìœ íš¨ì„± ê²€ì‚¬ ë…¼ë¦¬ë¥¼ ì½”ë”©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n- build í•¨ìˆ˜ê°€ ëª¨ë‘ í†µí•©ë˜ëŠ” ê³³ì…ë‹ˆë‹¤. ì¡´ì¬í•˜ëŠ” ê°’ë“¤ì„ í• ë‹¹í•˜ê³  ë‚˜ë©´ ê¸°ë³¸ê°’ì„ ê²°ì •í•˜ê³  ëŒ€ìƒ êµ¬ì¡°ì²´ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nì´ë¥¼ í†µí•´ ë¹Œë” íŒ¨í„´ì˜ ìš°ì•„í•¨ê³¼ Rust ë‚´ì—ì„œì˜ êµ¬í˜„ ë°©ë²•ì„ ì‚´í´ë³´ì•˜ìŠµë‹ˆë‹¤. ì´ê²ƒì´ ì•±ì´ë‚˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ì½”ë“œë¥¼ êµ¬í˜„í•˜ëŠ” í›Œë¥­í•œ ë°©ë²•ì„ì„ ì•Œ ìˆ˜ ìˆê¸°ë¥¼ ë°”ëë‹ˆë‹¤.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\në‹¤ìŒ ì„¹ì…˜ì¸ ë°ì´í„°ë² ì´ìŠ¤ë¡œ ë„˜ì–´ê°€ ë´…ì‹œë‹¤.\n\n# ë°ì´í„°ë² ì´ìŠ¤ â€” sqlx\n\nì´ ì„¹ì…˜ì—ì„œëŠ” Rust í”„ë¡œê·¸ë¨ì—ì„œ sqlxë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ ì‘ì—…ì„ ì‚´í´ë³¼ ê²ƒì…ë‹ˆë‹¤. ë¨¼ì € ì¼ë¶€ ì„¤ì •ì´ í•„ìš”í•©ë‹ˆë‹¤.\n\n## ì„¤ì •\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nìƒˆ í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í•´ë´…ì‹œë‹¤. db_appì´ë¼ê³  ì´ë¦„ ì§“ê³ , cargo new db_appìœ¼ë¡œ ìƒì„±í•  ìˆ˜ ìˆì–´ìš”. ê¸°ë³¸ ë””ë ‰í† ë¦¬ì— ëª‡ ê°œì˜ íŒŒì¼ì„ ìƒì„±í•  ê±°ì—ìš”. ì²« ë²ˆì§¸ íŒŒì¼ì€ docker-compose.ymlì´ë¼ê³  í•˜ë©° ë‹¤ìŒ ë‚´ìš©ì´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤. Postgresì™€ Pgadminì´ ë…¸ì¶œë˜ëŠ” ì„ì˜ì˜ í¬íŠ¸ë¥¼ ì„ íƒí–ˆìœ¼ë©°, ì»´í“¨í„°ì— ì„¤ì¹˜ëœ ë‹¤ë¥¸ ì•±ë“¤ê³¼ ì¶©ëŒí•˜ì§€ ì•Šë„ë¡ í–ˆì–´ìš”.\n\n```js\nversion: '3'\nservices:\n  postgres:\n    image: postgres:latest\n    container_name: postgres\n    ports:\n      - '6500:5432'\n    volumes:\n      - postgresDB:/data/postgres\n    env_file:\n      - ./.env\n  pgAdmin:\n    image: dpage/pgadmin4\n    container_name: pgAdmin\n    env_file:\n      - ./.env\n    ports:\n      - \"5050:80\"\nvolumes:\n  postgresDB:\n```\n\n.envì´ë¼ëŠ” íŒŒì¼ì´ í•˜ë‚˜ ë” í•„ìš”í•˜ë©°, ë‹¤ìŒ ë‚´ìš©ì´ ìˆì–´ì•¼ í•´ìš”. ì´ íŒŒì¼ì€ docker-compose íŒŒì¼ê³¼ ë‚˜ì¤‘ì— Rust ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ëª¨ë‘ ì‚¬ìš©í•  ê±°ì—ìš”.\n\n```js\nPOSTGRES_HOST=127.0.0.1\nPOSTGRES_PORT=6500\nPOSTGRES_USER=admin\nPOSTGRES_PASSWORD=password123\nPOSTGRES_DB=charging_session\n\nDATABASE_URL=postgresql://admin:password123@localhost:6500/charging_session?currentSchema=public\n\nPGADMIN_DEFAULT_EMAIL=admin@admin.com\nPGADMIN_DEFAULT_PASSWORD=password123\n```\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nìœ„ì˜ ë‚´ìš©ê³¼ í•¨ê»˜ ë°ì´í„°ë² ì´ìŠ¤ ì‚¬ìš©ì, ë¹„ë°€ë²ˆí˜¸, ê·¸ë¦¬ê³  Pgadminì— ëŒ€í•œ ì—°ê²° ì •ë³´ë¥¼ ì œê³µí•´ ë“œë ¸ìŠµë‹ˆë‹¤.\n\nì´ ë‘ ê°€ì§€ í•­ëª©ì„ ë§Œë“¤ê³  ìœ„ì˜ ë‚´ìš©ì„ ì‚¬ìš©í•˜ì—¬ Docker Composeë¥¼ ì‚¬ìš©í•˜ì—¬ ë¡œì»¬ DB ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì²˜ìŒì—ëŠ” í•­ìƒ ì „ê²½ì—ì„œ ì‹œì‘í•˜ëŠ” ê²ƒì„ ì¢‹ì•„í•©ë‹ˆë‹¤. ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ë° ê¸°íƒ€ ì‘ì—…ì„ í•˜ê¸° ë•Œë¬¸ì— ì—¬ëŸ¬ë¶„ì˜ ì»´í“¨í„° ë° ë„¤íŠ¸ì›Œí¬ ì†ë„ì— ë”°ë¼ ì‹œê°„ì´ ì†Œìš”ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. docker-compose.yml ë° .env íŒŒì¼ì´ ìˆëŠ” ë””ë ‰í† ë¦¬ì™€ ë™ì¼í•œ ìœ„ì¹˜ì—ì„œ ë‹¤ìŒì„ ì‹¤í–‰í•˜ì‹­ì‹œì˜¤.\n\n```js\ndocker-compose up\n```\n\nì‹œì‘ëœ ëª¨ë“  ê²ƒì„ í™•ì¸í•œ í›„ì—ëŠ” ì–¸ì œë“ ì§€ -d ìŠ¤ìœ„ì¹˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ëª¬ ëª¨ë“œë¡œ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì™„ë£Œë˜ë©´ ë‘ ì»¨í…Œì´ë„ˆê°€ ì‹œì‘ë˜ì—ˆëŠ”ì§€ í™•ì¸í•´ ë´…ì‹œë‹¤. ë‹¤ìŒê³¼ ê°™ì´ ëª…ë ¹ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\ndocker ps\n```\n\në¹„ìŠ·í•œ ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤.\n\n\u003cimg src=\"/assets/img/2024-05-23-LearningRustPart11BuildersandDatabaseInteraction_1.png\" /\u003e\n\në§Œì•½ ë‘ ê°œì˜ ì»¨í…Œì´ë„ˆê°€ í‘œì‹œë˜ì§€ ì•ŠëŠ”ë‹¤ë©´, docker-composeë¥¼ ì‹¤í–‰í•œ í„°ë¯¸ë„ì—ì„œ ì—ëŸ¬ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\ní•œ ë²ˆ ì´ë“¤ì´ ì‹¤í–‰ë˜ë©´ DBì— ì—°ê²°í•´ ë´…ì‹œë‹¤. Pgadminì„ í¬íŠ¸ 5050ì—ì„œ ì‹¤í–‰í•˜ë„ë¡ êµ¬ì„±í–ˆìœ¼ë‹ˆ ë¸Œë¼ìš°ì €ì—ì„œ http://localhost:5050ì„ ì…ë ¥í•˜ë©´ pgadminì˜ ë¡œê·¸ì¸ í™”ë©´ì´ í‘œì‹œë©ë‹ˆë‹¤. .env íŒŒì¼ì— êµ¬ì„±ëœ ìê²© ì¦ëª…(ê´€ë¦¬ì@ê´€ë¦¬ì.com/ë¹„ë°€ë²ˆí˜¸123)ì„ ì‚¬ìš©í•˜ì—¬ pgadminì— ë¡œê·¸ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ°ë° ì•„ì§ ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ ë‹¤ìŒì„ ì‹¤í–‰í•´ì•¼ í•©ë‹ˆë‹¤.\n\n```js\ndocker inspect postgres\n```\n\nì¶œë ¥ì„ í™•ì¸í•˜ì—¬ \"NetworkSettings\" ì„¹ì…˜ìœ¼ë¡œ ì´ë™í•˜ê³  \"IPAddress\" ì†ì„±ì˜ ê°’ì„ ë³µì‚¬í•©ë‹ˆë‹¤. ì´ ê°’ì€ DBì— ì—°ê²°í•˜ëŠ” ë° ì‚¬ìš©í•  í˜¸ìŠ¤íŠ¸(IP)ì…ë‹ˆë‹¤. ì œ ì»´í“¨í„°ì—ì„œ ì´ ê°’ì€ 172.23.0.1 ì´ì—ˆìŠµë‹ˆë‹¤.\n\në¡œê·¸ì¸í•œ í›„ \"ìƒˆ ì„œë²„ ì¶”ê°€\" ë²„íŠ¼ì„ í´ë¦­í•˜ê³ , \"í˜¸ìŠ¤íŠ¸ ì´ë¦„/ì£¼ì†Œ\"ë¡œ ì´ì „ì— ë³µì‚¬í•œ IP ì£¼ì†Œë¥¼ í¬í•¨í•œ í•„ìˆ˜ ìê²© ì¦ëª…ì„ ì œê³µí•˜ê³  \"ì €ì¥\" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nì„œë²„ì— ë¡œê·¸ì¸í•˜ë©´ ë°ì´í„°ë² ì´ìŠ¤ charging_sessionì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n![ì´ë¯¸ì§€](/assets/img/2024-05-23-LearningRustPart11BuildersandDatabaseInteraction_2.png)\n\nì˜ í–ˆì–´ìš”. ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì‚¬ìš©í•  ì¤€ë¹„ê°€ ë˜ì—ˆê³  Pgadminì—ì„œ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nì´ì œ Rust ì•±ì˜ ì¢…ì†ì„±ì„ êµ¬ì„±í•´ ë´…ì‹œë‹¤. ì²˜ìŒì—ëŠ” ëª¨ë‘ í•„ìš”í•˜ì§€ ì•Šì§€ë§Œ ê²°êµ­ í•„ìš”í•˜ê²Œ ë  ê²ƒì´ë¯€ë¡œ ì§€ê¸ˆ ì¶”ê°€í•´ ë‘ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nCargo.toml íŒŒì¼ì˜ ì¢…ì†ì„± ë¶€ë¶„ì„ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜ì •í•˜ì„¸ìš”.\n\n```toml\n[dependencies]\nchrono = { version = \"0.4.31\", features = [\"serde\"] }\ndotenv = \"0.15.0\"\nenv_logger = \"0.10.1\"\nlog = \"0.4.20\"\nserde = { version = \"1.0.193\", features = [\"derive\"] }\nserde_json = \"1.0.108\"\nsqlx = { version = \"0.7.3\", features = [\"runtime-tokio-native-tls\", \"postgres\", \"uuid\", \"chrono\"] }\ntokio = { version = \"1.35.0\", features = [\"macros\", \"rt-multi-thread\"]}\nuuid = { version = \"1.6.1\", features = [\"serde\", \"v4\"] }\n```\n\në‹¤ì–‘í•œ ì¢…ì†ì„±ì— ëŒ€í•´ í™œì„±í™”ëœ ê¸°ëŠ¥ì„ ê²€í† í•˜ëŠ” ë°ë„ ì‹œê°„ì„ í• ì• í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.\n\në‹¤ìŒìœ¼ë¡œ, í•„ìš”í•œ í…Œì´ë¸”ì„ ë§Œë“¤ê¸° ìœ„í•´ sqlx-cli ë§ˆì´ê·¸ë ˆì´ì…˜ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ê²ƒì…ë‹ˆë‹¤.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nìš°ì„  ëª…ë ¹ ì¤„ì—ì„œ ë‹¤ìŒì„ ì‹¤í–‰í•˜ì—¬ CLIë¥¼ ì„¤ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.\n\n```js\ncargo install sqlx-cli --no-default-features --features rustls,postgres\n```\n\nê·¸ëŸ° ë‹¤ìŒ ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ì„ ì´ˆê¸°í™”í•´ì•¼ í•©ë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì´ ì‹¤í–‰í•©ë‹ˆë‹¤.\n\n```js\nsqlx migrate add initial-tables\n```\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nì´ ëª…ë ¹ì–´ëŠ” ìš°ë¦¬ê°€ ë§ˆì´ê·¸ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•˜ê¸° ìœ„í•´ ìƒˆ íŒŒì¼ migrations/`timestamp`\\_initial-tables.sqlì„ ìƒì„±í•©ë‹ˆë‹¤.\n\n![ì´ë¯¸ì§€](/assets/img/2024-05-23-LearningRustPart11BuildersandDatabaseInteraction_3.png)\n\nì´ íŒŒì¼ì„ ì—´ê³  ì•„ë˜ SQL ë¬¸ì„ ì¶”ê°€í•˜ì—¬ í…Œì´ë¸”ì„ ìƒì„±í•˜ì„¸ìš”.\n\ncreate table locations (\nid bigserial primary key,\nname varchar(255) unique not null\n);\n\ncreate table sessions (\nid bigserial primary key,\nlocation_id bigint not null,\nwatts bigint not null,\nvin varchar(255) not null,\nconstraint fk_location foreign key (location_id) references locations(id) on delete cascade\n);\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nìœ„ ì˜ˆì œì—ì„œ ì‚¬ìš©í•  ë‘ ê°œì˜ í…Œì´ë¸” ì •ì˜ì…ë‹ˆë‹¤. ì´ ì‹œë¦¬ì¦ˆì˜ ì¶©ì „ ì„¸ì…˜ì— ëŒ€í•œ í‘œì¤€ ì˜ˆì œë¥¼ í™•ì¥í•˜ì—¬, ì¶©ì „ ì¥ì¹˜ì˜ ìœ„ì¹˜ë¥¼ ì €ì¥í•  locations í…Œì´ë¸”ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.\n\nì´ì œ ë‹¤ìŒì„ ì‹¤í–‰í•˜ì—¬ í…Œì´ë¸”ì„ ìƒì„±í•˜ì„¸ìš”.\n\n```js\nsqlx migrate run\n```\n\nê·¸ëŸ¬ë©´ ì¦‰ì‹œ 20231212235431/migrate initial-tables (íƒ€ì„ìŠ¤íƒ¬í”„ ë¶€ë¶„ì€ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŒ)ê³¼ ê°™ì€ ë©”ì‹œì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤. ì´ì œ Pgadminì— ê°€ì„œ í…Œì´ë¸”ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n\u003cimg src=\"/assets/img/2024-05-23-LearningRustPart11BuildersandDatabaseInteraction_4.png\" /\u003e\n\nìœ„ì—ì„œ ë³´ë“¯ì´ ë‘ ê°œì˜ í…Œì´ë¸”ì´ ìƒì„±ë˜ì—ˆê³ , ë¬¸ì„œ ëª©ì ì„ ìœ„í•´ Pgadmin ë‚´ì— ERD ë‹¤ì´ì–´ê·¸ë¨ë„ ìƒì„±í–ˆìŠµë‹ˆë‹¤. ì´ì œ ì´ˆê¸° ì„¤ì •ê³¼ í”„ë¡œì íŠ¸ êµ¬ì„±ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤.\n\n# ë°ì´í„°ë² ì´ìŠ¤ í•¨ìˆ˜\n\nì´ ì„¹ì…˜ì—ì„œëŠ” ë°ì´í„°ë² ì´ìŠ¤ ìƒí˜¸ ì‘ìš©ì˜ ë‹¤ì–‘í•œ ìœ í˜•ê³¼ Rust êµ¬í˜„ì„ ì‚´í´ë³¼ ê²ƒì…ë‹ˆë‹¤. ì´ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°í•˜ëŠ” ê²ƒìœ¼ë¡œ ì‹œì‘ë©ë‹ˆë‹¤.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nDBì— ì—°ê²°í•˜ê¸°\n\në°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°í•˜ëŠ” ë°©ë²•ì€ PgPoolOptions connect í•¨ìˆ˜ë¥¼ í†µí•´ ì—°ê²°ì„ ìƒì„±í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ìš°ë¦¬ì˜ .env íŒŒì¼ì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ë¬¸ìì—´ì„ ì½ê³  ë¡œê¹…ì„ êµ¬ì„±í•˜ë©° ì„±ê³µ ë˜ëŠ” ì˜¤ë¥˜ë¥¼ ê¸°ë¡í•˜ëŠ” ì½”ë“œ ì „ì²´ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.\n\n```js\nuse sqlx::{postgres::PgPoolOptions, Pool, Postgres};\nuse dotenv::dotenv;\nuse log::{info, error};\n\n#[tokio::main]\nasync fn main() {\n    if std::env::var_os(\"RUST_LOG\").is_none() {\n        std::env::set_var(\"RUST_LOG\", \"info\");\n    }\n    dotenv().ok();\n    env_logger::init();\n\n    let database_url = std::env::var(\"DATABASE_URL\").expect(\"DATABASE_URL must be set\");\n    let pool = match PgPoolOptions::new()\n        .max_connections(10)\n        .connect(\u0026database_url)\n        .await\n    {\n        Ok(pool) =\u003e {\n            info!(\"âœ… ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤!\");\n            pool\n        }\n        Err(err) =\u003e {\n            error!(\"ğŸ”¥ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: {:?}\", err);\n            std::process::exit(1);\n        }\n    };\n}\n```\n\nì‹œì‘ ë¶€ë¶„ì˜ #[tokio::main] ë§¤í¬ë¡œë¥¼ ì£¼ëª©í•´ì£¼ì„¸ìš”. ì´ëŠ” async fn main()ì„ ë™ê¸° fn main()ë¡œ ë³€í™˜í•˜ì—¬ ëŸ°íƒ€ì„ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì´ˆê¸°í™”í•˜ê³  async main í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ê²Œ í•©ë‹ˆë‹¤.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nìœ„ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë©´ ì¶œë ¥ ë¡œê¹…ì—ì„œ ë‹¤ìŒ ë©”ì‹œì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤.\n\n[2023-12-13T00:16:42Z INFO db_app] âœ… ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nìš°ë¦¬ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. .env íŒŒì¼ì—ì„œ êµ¬ì„±í•œ ëª¨ë“  ì—°ê²° ì •ë³´ë¥¼ ê¸°ì–µí•´ ì£¼ì„¸ìš”. ì´ ì •ë³´ëŠ” docker-compose, sqlx-cli, ê·¸ë¦¬ê³  ìš°ë¦¬ì˜ ì–´í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ê³µìœ ë˜ì—ˆìŠµë‹ˆë‹¤.\n\n## Inserts\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nì´ì œ ì—°ê²° í’€ì´ ì¤€ë¹„ë˜ì—ˆìœ¼ë‹ˆ, ìš°ë¦¬ê°€ ì‚´í´ë³¼ ì²« ë²ˆì§¸ ë°ì´í„°ë² ì´ìŠ¤ ë¡œì§ì€ ì‚½ì…ì…ë‹ˆë‹¤. sqlxë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚½ì…í•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\n\n```rust\nlet insert_result = sqlx::query_as!(\n    Locations,\n    \"INSERT INTO locations (id,name) VALUES (1, 'Location A') RETURNING *\"\n)\n.fetch_one(\u0026pool)\n.await;\n\nmatch insert_result {\n    Ok(location) =\u003e {\n        info!(\"âœ“Inserted: {:?}\", location);\n    }\n    Err(e) =\u003e {\n        error!(\"Error Insert: {}\", e.to_string())\n    }\n}\n```\n\nì´ ì½”ë“œëŠ” í•˜ë‚˜ì˜ ë ˆì½”ë“œë¥¼ ì‚½ì…í•  ê²ƒì…ë‹ˆë‹¤. ë¬¼ë¡  ë§¤ê°œë³€ìˆ˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆìœ¼ë©°, ì´ëŠ” ì—…ë°ì´íŠ¸ë¥¼ ì‚´í´ë³¼ ë•Œ ì‚´í´ë³¼ ê²ƒì…ë‹ˆë‹¤.\n\n## ì§ˆì˜í•˜ê¸°\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\në‹¤ìŒìœ¼ë¡œ, ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì¡°íšŒí•˜ëŠ” ë°©ë²•ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\n\n```js\n    let query_result = sqlx::query_as!(Locations, \"SELECT * FROM Locations\")\n        .fetch_all(\u0026pool)\n        .await;\n    if query_result.is_err() {\n        let message = \"ëª¨ë“  ìœ„ì¹˜ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë™ì•ˆ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\";\n        error!(\"{}{}\", message, query_result.err().unwrap());\n    } else {\n        info!(\"ğŸ˜ ìœ„ì¹˜ì— ëŒ€í•œ ì¿¼ë¦¬ ê²°ê³¼ {:?}\", query_result.unwrap());\n    }\n```\n\nì´ê²ƒì€ ì„±ê³µì ìœ¼ë¡œ ì‘ë™í–ˆë‹¤ë©´ unwrapì„ í†µí•´ ê²°ê³¼ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ê²°ê³¼ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. ì¿¼ë¦¬ ë‚´ì˜ ì´ìŠˆê°€ ë°œìƒí–ˆë‹¤ë©´ í•´ë‹¹ ì—ëŸ¬ì— ì ‘ê·¼í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.\n\n## ì—…ë°ì´íŠ¸\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\në‹¤ìŒ ì‘ì—…ì€ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ëŠ” ì´ì „ì— ì‚½ì…í•œ ê²ƒê³¼ ë¹„ìŠ·í•  ê²ƒì…ë‹ˆë‹¤.\n\n```js\n    let update_result = sqlx::query_as!(\n        Sessions,\n        \"UPDATE sessions SET watts = 415 WHERE id = $1 RETURNING *\",\n        1i64,\n    )\n    .fetch_one(\u0026pool)\n    .await;\n\n    match update_result {\n        Ok(session) =\u003e {\n            info!(\"âœ“Update: {:?}\", session);\n        }\n        Err(e) =\u003e {\n            error!(\"Error Update: {}\", e.to_string())\n        }\n    }\n```\n\nì´ ì˜ˆì œì—ì„œ ì£¼ëª©í•  ì ì€ $1ì´ë¼ëŠ” ë§¤ê°œë³€ìˆ˜ ìë¦¬ í‘œì‹œìë¥¼ ì‚¬ìš©í•˜ëŠ” ì¤€ë¹„ëœ ë¬¸(statement)ë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ SQL ë¬¸ìì—´ ë’¤ì— ë§¤ê°œë³€ìˆ˜ë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤.\n\n## Deletes\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\në§ˆì§€ë§‰ìœ¼ë¡œ, ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ë ˆì½”ë“œë¥¼ ì‚­ì œí•˜ëŠ” CRUD ì‘ì—…ì„ ì™„ë£Œí•©ë‹ˆë‹¤. ìš°ë¦¬ì˜ ëª©ì ì€ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì •ë¦¬í•˜ëŠ” ë° ì‚¬ìš©í•  ê²ƒì´ë©°, ì´ë ‡ê²Œ í•˜ë©´ ì–¸ì œë“ ì§€ ì‘ìš© í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n```js\nlet rows_deleted = sqlx::query!(\"DELETE from sessions\")\n    .execute(\u0026pool)\n    .await\n    .unwrap()\n    .rows_affected();\n\ninfo!(\"âœ• ì„¸ì…˜ í…Œì´ë¸”ì—ì„œ {}ê°œì˜ í–‰ ì‚­ì œë¨\", rows_deleted);\n```\n\nì—¬ê¸°ì„œëŠ” ì—°ì‚°ì—ì„œì²˜ëŸ¼ sqlx::query ëŒ€ì‹  sqlx::query_asë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ë˜í•œ ì–¸ë© ì´í›„ .rows_affectedë¥¼ ì¶”ê°€í•˜ì—¬ ì‚­ì œëœ í–‰ ìˆ˜ë¥¼ ì–»ìŠµë‹ˆë‹¤.\n\n## íŠ¸ëœì­ì…˜\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```rust\n   let tx = pool.begin().await.expect(\"íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤\");\n\n   // ë°ì´í„°ë² ì´ìŠ¤ ì‘ì—… ìˆ˜í–‰(ë°ì´í„° ì‚½ì… ë˜ëŠ” ë³€ê²½)\n\n   tx.commit().await.expect(\"íŠ¸ëœì­ì…˜ì„ ì»¤ë°‹í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤\");\n```\n\nì»¤ë°‹ì„ í˜¸ì¶œí•˜ì§€ ì•Šìœ¼ë©´ íŠ¸ëœì­ì…˜ì´ ë²”ìœ„ë¥¼ ë²—ì–´ë‚˜ë©´ ìë™ìœ¼ë¡œ ë¡¤ë°±ë©ë‹ˆë‹¤.\n\n## ì™„ì „í•œ ì‘ìš© í”„ë¡œê·¸ë¨\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nìœ„ì˜ ì½”ë“œëŠ” ìš°ë¦¬ê°€ ì´ì „ì— ë…¼ì˜í•œ ëª¨ë“  ë‹¤ì–‘í•œ ê¸°ëŠ¥ì´ í•˜ë‚˜ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ëª¨ë‘ í¬í•¨ëœ ì™„ì „í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤.\n\n```js\nuse dotenv::dotenv;\nuse log::{error, info};\nuse sqlx::{postgres::PgPoolOptions, Pool, Postgres};\n\n#[derive(Debug)]\nstruct Locations {\n    id: i64,\n    name: String,\n}\n\n#[derive(Debug)]\nstruct Sessions {\n    id: i64,\n    location_id: i64,\n    watts: i64,\n    vin: String,\n}\nasync fn insert_into_locations(pool: Pool\u003cPostgres\u003e) {\n    let tx = pool.begin().await.expect(\"Unable to begin transaction\");\n\n    let insert_result = sqlx::query_as!(\n        Locations,\n        \"INSERT INTO locations (id,name) VALUES (1, 'Location A') RETURNING *\"\n    )\n    .fetch_one(\u0026pool)\n    .await;\n\n    match insert_result {\n        Ok(location) =\u003e {\n            info!(\"âœ“Inserted: {:?}\", location);\n        }\n        Err(e) =\u003e {\n            error!(\"Error Insert: {}\", e.to_string())\n        }\n    }\n    let insert_result = sqlx::query_as!(\n        Locations,\n        \"INSERT INTO locations (id,name) VALUES (2, 'Location B') RETURNING *\"\n    )\n    .fetch_one(\u0026pool)\n    .await;\n\n    match insert_result {\n        Ok(location) =\u003e {\n            info!(\"âœ“Inserted: {:?}\", location);\n        }\n        Err(e) =\u003e {\n            error!(\"Error Insert: {}\", e.to_string())\n        }\n    }\n\n    tx.commit().await.expect(\"Unable to commit the transaction\");\n}\n\nasync fn insert_into_sessions(pool: Pool\u003cPostgres\u003e) {\n    let tx = pool.begin().await.expect(\"Unable to begin transaction\");\n\n    let insert_result = sqlx::query_as!(\n        Sessions,\n        \"INSERT INTO sessions (id,location_id, watts, vin) VALUES (1, 1, 420, '2FMZA52286BA02033') RETURNING *\"\n    )\n    .fetch_one(\u0026pool)\n    .await;\n\n    match insert_result {\n        Ok(session) =\u003e {\n            info!(\"âœ“Inserted: {:?}\", session);\n        }\n        Err(e) =\u003e {\n            error!(\"Error Insert: {}\", e.to_string())\n        }\n    }\n    let insert_result = sqlx::query_as!(\n        Sessions,\n        \"INSERT INTO sessions (id,location_id, watts, vin) VALUES (2, 2, 393, '1GMYA52286BA04055') RETURNING *\"\n)\n    .fetch_one(\u0026pool)\n    .await;\n\n    match insert_result {\n        Ok(session) =\u003e {\n            info!(\"âœ“Inserted: {:?}\", session);\n        }\n        Err(e) =\u003e {\n            error!(\"Error Insert: {}\", e.to_string())\n        }\n    }\n\n    tx.commit().await.expect(\"Unable to commit the transaction\");\n}\n\nasync fn update_sessions(pool: Pool\u003cPostgres\u003e) {\n    let tx = pool.begin().await.expect(\"Unable to begin transaction\");\n\n    let update_result = sqlx::query_as!(\n        Sessions,\n        \"UPDATE sessions SET watts = 415 WHERE id = $1 RETURNING *\",\n        1i64,\n    )\n    .fetch_one(\u0026pool)\n    .await;\n\n    match update_result {\n        Ok(session) =\u003e {\n            info!(\"âœ“Update: {:?}\", session);\n        }\n        Err(e) =\u003e {\n            error!(\"Error Update: {}\", e.to_string())\n        }\n    }\n\n    tx.commit().await.expect(\"Unable to commit the transaction\");\n}\n\nasync fn clean_db(pool: Pool\u003cPostgres\u003e) {\n    let rows_deleted = sqlx::query!(\"DELETE from sessions\")\n        .execute(\u0026pool)\n        .await\n        .unwrap()\n        .rows_affected();\n\n    info!(\"âœ•Deleted {} rows from sessions table\", rows_deleted);\n\n    let rows_deleted = sqlx::query!(\"DELETE from locations\")\n        .execute(\u0026pool)\n        .await\n        .unwrap()\n        .rows_affected();\n    info!(\"âœ•Deleted {} rows from locations table\", rows_deleted);\n}\n\nasync fn query_locations(pool: Pool\u003cPostgres\u003e) {\n    let query_result = sqlx::query_as!(Locations, \"SELECT * FROM Locations\")\n        .fetch_all(\u0026pool)\n        .await;\n    if query_result.is_err() {\n        let message = \"Something bad happened while fetching all locations\";\n        error!(\"{}\", message);\n    } else {\n        info!(\"ğŸ˜Query Result For Locations {:?}\", query_result);\n    }\n}\n\nasync fn query_sessions(pool: Pool\u003cPostgres\u003e) {\n    let query_result = sqlx::query_as!(Sessions, \"SELECT * FROM Sessions\")\n        .fetch_all(\u0026pool)\n        .await;\n    if query_result.is_err() {\n        let message = \"Something bad happened while fetching all sessions\";\n        error!(\"{}\", message);\n    } else {\n        info!(\"ğŸ˜Query Result for Sessions {:?}\", query_result);\n    }\n}\n\n#[tokio::main]\nasync fn main() {\n    if std::env::var_os(\"RUST_LOG\").is_none() {\n        std::env::set_var(\"RUST_LOG\", \"info\");\n    }\n    dotenv().ok();\n    env_logger::init();\n\n    let database_url = std::env::var(\"DATABASE_URL\").expect(\"DATABASE_URL must be set\");\n    let pool = match PgPoolOptions::new()\n        .max_connections(10)\n        .connect(\u0026database_url)\n        .await\n    {\n        Ok(pool) =\u003e {\n            info!(\"âœ…Connection to the database is successful!\");\n            pool\n        }\n        Err(err) =\u003e {\n            error!(\"ğŸ”¥ Failed to connect to the database: {:?}\", err);\n            std::process::exit(1);\n        }\n    };\n    clean_db(pool.clone()).await;\n\n    insert_into_locations(pool.clone()).await;\n    query_locations(pool.clone()).await;\n\n    insert_into_sessions(pool.clone()).await;\n    query_sessions(pool.clone()).await;\n\n    update_sessions(pool.clone()).await;\n    query_sessions(pool.clone()).await;\n}\n```\n\nìœ„ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•œ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\n\n\u003cimg src=\"/assets/img/2024-05-23-LearningRustPart11BuildersandDatabaseInteraction_5.png\" /\u003e\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nìœ„ì™€ ê°™ì´ ë°ì´í„°ë² ì´ìŠ¤ ìƒí˜¸ì‘ìš© í† ë¡ ì„ ë§ˆì³¤ìŠµë‹ˆë‹¤. sqlxë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì¢‹ì€ ê°œìš”ë¥¼ ì œê³µí–ˆì„ ê²ë‹ˆë‹¤.\n\n# ìš”ì•½\n\nì €í¬ ëŸ¬ìŠ¤íŠ¸ í•™ìŠµ ì‹œë¦¬ì¦ˆì˜ ì´ ë¶€ë¶„ì„ ì¦ê¸°ì…¨ê¸°ë¥¼ ë°”ëë‹ˆë‹¤. ì‹œë¦¬ì¦ˆ ì´ë²ˆ ì„¹ì…˜ì—ì„œëŠ” ë¨¼ì € ëŸ¬ìŠ¤íŠ¸ì—ì„œ ê°ì²´ ìƒì„±ì— ëŒ€í•œ ë§¤ìš° ìœ ìš©í•œ íŒ¨í„´ì¸ ë¹Œë” íŒ¨í„´ì„ ì‚´í´ë³´ì•˜ìŠµë‹ˆë‹¤. ì´ëŠ” ë‹¤ë¥¸ ì–¸ì–´ì—ì„œ ìµìˆ™í•  ìˆ˜ ìˆì§€ë§Œ, ëŸ¬ìŠ¤íŠ¸ì—ì„œ ì–´ë–»ê²Œ êµ¬í˜„í•˜ëŠ”ì§€ ì‚´í´ë³´ì•˜ìŠµë‹ˆë‹¤.\n\në‹¤ìŒìœ¼ë¡œ, ìš°ë¦¬ëŠ” Rustë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ì¸ íŠ¹íˆ Postgresì™€ ìƒí˜¸ì‘ìš©í•˜ëŠ” ë°©ë²•ì„ ê²€í† í–ˆìŠµë‹ˆë‹¤. ìš°ë¦¬ëŠ” ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ì‹¤í–‰í•˜ê³  ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°í•˜ëŠ” ë°©ë²•ì„ ë³´ì•˜ìœ¼ë©°, ê·¸ í›„ DBì— ëŒ€í•´ ì—¬ëŸ¬ ê°€ì§€ CRUD ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë°©ë²•ì„ ì‚´í´ë³´ì•˜ìŠµë‹ˆë‹¤.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nëŸ¬ìŠ¤íŠ¸ í•™ìŠµ ì—¬ì •ì— í•¨ê»˜í•´ì¤˜ì„œ ê³ ë§ˆì›Œìš”.\n\nì¢‹ì€ ì—¬í–‰ ë˜ì„¸ìš”!\n","ogImage":{"url":"/assets/img/2024-05-23-LearningRustPart11BuildersandDatabaseInteraction_0.png"},"coverImage":"/assets/img/2024-05-23-LearningRustPart11BuildersandDatabaseInteraction_0.png","tag":["Tech"],"readingTime":24},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cp\u003eë‹¤ìŒ ì‹œë¦¬ì¦ˆë¡œ ë„˜ì–´ê°€ë³´ê² ìŠµë‹ˆë‹¤; ì´ ë¶€ë¶„ì—ì„œëŠ” ë°ì´í„° êµ¬ì¡°ì— ë¹Œë” íŒ¨í„´ì„ êµ¬í˜„í•˜ëŠ” ë°©ë²•ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ sqlxì™€ Postgresë¥¼ ì‚¬ìš©í•œ ë°ì´í„°ë² ì´ìŠ¤ ìƒí˜¸ì‘ìš©ìœ¼ë¡œ ë„˜ì–´ê°€ê² ìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-05-23-LearningRustPart11BuildersandDatabaseInteraction_0.png\" alt=\"ì´ë¯¸ì§€\"\u003e\u003c/p\u003e\n\u003ch1\u003eRust ì‹œë¦¬ì¦ˆ\u003c/h1\u003e\n\u003cp\u003eë¶€ë¶„ 1 â€” ê¸°ë³¸ ê°œë…\u003c/p\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003ePart 2 â€” ë©”ëª¨ë¦¬\u003c/p\u003e\n\u003cp\u003ePart 3 â€” íë¦„ ì œì–´ì™€ í•¨ìˆ˜\u003c/p\u003e\n\u003cp\u003ePart 4 â€” ì˜µì…˜/ê²°ê³¼ ë° ì»¬ë ‰ì…˜\u003c/p\u003e\n\u003cp\u003ePart 5 â€” íŠ¸ë ˆì´íŠ¸, ì œë„¤ë¦­ ë° í´ë¡œì €\u003c/p\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eì œ 6ë¶€ â€” ë§¤í¬ë¡œ, ë°˜ë³µì ë° íŒŒì¼ ì²˜ë¦¬\u003c/p\u003e\n\u003cp\u003eì œ 7ë¶€ â€” ìŠ¤ë ˆë“œ ê³µìœ  ìƒíƒœ ë° ì±„ë„\u003c/p\u003e\n\u003cp\u003eì œ 8ë¶€ â€” Cargo, í¬ë ˆì´íŠ¸, ëª¨ë“ˆ ë° ë¼ì´ë¸ŒëŸ¬ë¦¬\u003c/p\u003e\n\u003cp\u003eì œ 9ë¶€ â€” ëª…ë ¹í–‰ ì¸ìˆ˜, ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ë° í…ŒìŠ¤íŒ…\u003c/p\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eì œ 10ë¶€ â€” ìƒì í¬ì¸í„° ë° ì›¹ ì•±\u003c/p\u003e\n\u003cp\u003eì œ 11ë¶€ â€” ë¹Œë”ì™€ ë°ì´í„°ë² ì´ìŠ¤ ìƒí˜¸ì‘ìš© (ì´ ê¸°ì‚¬)\u003c/p\u003e\n\u003ch1\u003eì†Œê°œ\u003c/h1\u003e\n\u003cp\u003eì´ê²ƒì€ ëŸ¬ìŠ¤íŠ¸ í•™ìŠµ ì‹œë¦¬ì¦ˆì˜ ì—´í•œ ë²ˆì§¸ ì„¹ì…˜ì…ë‹ˆë‹¤. ì´ë²ˆì—ëŠ” ëŸ¬ìŠ¤íŠ¸ì—ì„œ ë¹Œë” íŒ¨í„´ì„ ë‹¤ë£° ê²ƒì…ë‹ˆë‹¤. ì´ ê³µí†µëœ íŒ¨í„´ì€ êµ¬ì¡°ì²´ë¥¼ ì•ˆì „í•˜ê³  íˆ¬ëª…í•˜ê²Œ ì´ˆê¸°í™”í•˜ëŠ” ì¢‹ì€ ë°©ë²•ì…ë‹ˆë‹¤. ë‹¤ìŒìœ¼ë¡œ, ìš°ë¦¬ëŠ” í¬ìŠ¤íŠ¸ê·¸ë ˆìŠ¤ì™€ SQLX í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ CRUD ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë°©ë²•ì„ ì‚´í´ë³¼ ê²ƒì…ë‹ˆë‹¤.\u003c/p\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch1\u003eì¤€ë¹„ë¬¼\u003c/h1\u003e\n\u003cp\u003eì´ ê¸€ì˜ ë°ì´í„°ë² ì´ìŠ¤ ë¶€ë¶„ì„ ìœ„í•œ ìœ ì¼í•œ ì¤€ë¹„ë¬¼ì€ Rustì™€ Cargoê°€ ì„¤ì¹˜ë˜ì–´ ìˆê³  ì‹œìŠ¤í…œì— Dockerê°€ ì„¤ì¹˜ë˜ì–´ ìˆëŠ” ê²ƒì…ë‹ˆë‹¤. ë§Œì•½ Dockerë¥¼ ê°€ì§€ê³  ìˆì§€ ì•Šì§€ë§Œ ë¡œì»¬ Postgres DBê°€ ì´ë¯¸ ì„¤ì¹˜ë˜ì–´ ìˆê±°ë‚˜ ë‹¤ë¥¸ ì„œë²„ì˜ DBì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆë‹¤ë©´ Docker Postgres ì„¤ì •ì„ ê±´ë„ˆë›°ê³  DBì— ì—°ê²°í•˜ê¸° ìœ„í•œ ì—°ê²° ì†ì„±ë§Œ ìˆ˜ì •í•˜ë©´ ë©ë‹ˆë‹¤.\u003c/p\u003e\n\u003ch1\u003eë¹Œë” íŒ¨í„´\u003c/h1\u003e\n\u003cp\u003eë¹Œë” íŒ¨í„´ì€ ë³µì¡í•œ ê°ì²´ì˜ êµ¬ì„±ì„ í•´ë‹¹ í‘œí˜„ì—ì„œ ë¶„ë¦¬í•˜ëŠ” ë””ìì¸ íŒ¨í„´ì…ë‹ˆë‹¤. ì´ íŒ¨í„´ì„ ì‚¬ìš©í•˜ë©´ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ìˆ˜í–‰í•˜ê³  ê¸°ë³¸ê°’ìœ¼ë¡œ ëŒ€ì²´í•˜ë©° ê°’ì„ ë¶€ë¶„ì ìœ¼ë¡œ í• ë‹¹í•œ í›„ì— í•­ëª©ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eRustë¡œ ê·¸ êµ¬í˜„í•˜ëŠ” ë°©ë²•ì„ ì‚´í´ë³¼ ê±°ì˜ˆìš”. ì´ê²ƒì´ ìš°ë¦¬ì˜ ì½”ë“œì…ë‹ˆë‹¤.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e#[\u003cspan class=\"hljs-title function_\"\u003ederive\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eDebug\u003c/span\u003e)]\nstruct \u003cspan class=\"hljs-title class_\"\u003eChargingSession\u003c/span\u003e {\n    \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eString\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003ewatts\u003c/span\u003e: u32,\n    \u003cspan class=\"hljs-attr\"\u003evin\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eString\u003c/span\u003e,\n}\n\nstruct \u003cspan class=\"hljs-title class_\"\u003eChargingSessionBuilder\u003c/span\u003e {\n    \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eString\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003ewatts\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eOption\u003c/span\u003e\u0026#x3C;u32\u003e,\n    \u003cspan class=\"hljs-attr\"\u003evin\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eOption\u003c/span\u003e\u0026#x3C;\u003cspan class=\"hljs-title class_\"\u003eString\u003c/span\u003e\u003e,\n}\n\nimpl \u003cspan class=\"hljs-title class_\"\u003eChargingSessionBuilder\u003c/span\u003e {\n    fn \u003cspan class=\"hljs-title function_\"\u003enew\u003c/span\u003e(\u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: \u0026#x26;str) -\u003e \u003cspan class=\"hljs-title class_\"\u003eChargingSessionBuilder\u003c/span\u003e {\n        \u003cspan class=\"hljs-title class_\"\u003eChargingSessionBuilder\u003c/span\u003e {\n            \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: id.\u003cspan class=\"hljs-title function_\"\u003eto_string\u003c/span\u003e(),\n            \u003cspan class=\"hljs-attr\"\u003ewatts\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eNone\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr\"\u003evin\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eNone\u003c/span\u003e,\n        }\n    }\n\n    fn \u003cspan class=\"hljs-title function_\"\u003ewatts\u003c/span\u003e(mut self, \u003cspan class=\"hljs-attr\"\u003ewatts\u003c/span\u003e: u32) -\u003e \u003cspan class=\"hljs-title class_\"\u003eChargingSessionBuilder\u003c/span\u003e {\n        self.\u003cspan class=\"hljs-property\"\u003ewatts\u003c/span\u003e = \u003cspan class=\"hljs-title class_\"\u003eSome\u003c/span\u003e(watts);\n        self\n    }\n\n    fn \u003cspan class=\"hljs-title function_\"\u003evin\u003c/span\u003e(mut self, \u003cspan class=\"hljs-attr\"\u003evin\u003c/span\u003e: \u0026#x26;str) -\u003e \u003cspan class=\"hljs-title class_\"\u003eChargingSessionBuilder\u003c/span\u003e {\n        self.\u003cspan class=\"hljs-property\"\u003evin\u003c/span\u003e = \u003cspan class=\"hljs-title class_\"\u003eSome\u003c/span\u003e(vin.\u003cspan class=\"hljs-title function_\"\u003eto_string\u003c/span\u003e());\n        self\n    }\n\n    fn \u003cspan class=\"hljs-title function_\"\u003ebuild\u003c/span\u003e(self) -\u003e \u003cspan class=\"hljs-title class_\"\u003eChargingSession\u003c/span\u003e {\n        \u003cspan class=\"hljs-title class_\"\u003eChargingSession\u003c/span\u003e {\n            \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: self.\u003cspan class=\"hljs-property\"\u003eid\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr\"\u003ewatts\u003c/span\u003e: self.\u003cspan class=\"hljs-property\"\u003ewatts\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eunwrap_or_else\u003c/span\u003e(|| \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e),\n            \u003cspan class=\"hljs-attr\"\u003evin\u003c/span\u003e: self.\u003cspan class=\"hljs-property\"\u003evin\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eunwrap_or_else\u003c/span\u003e(|| \u003cspan class=\"hljs-string\"\u003e\"Unknown\"\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eto_string\u003c/span\u003e()),\n        }\n    }\n}\n\nfn \u003cspan class=\"hljs-title function_\"\u003emain\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-comment\"\u003e// ì´ê²ƒì€ ChargingSessionì„ ìƒì„±í•˜ëŠ” í‘œì¤€ì ì¸ ë°©ë²•ì…ë‹ˆë‹¤.\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e cs_old_way = \u003cspan class=\"hljs-title class_\"\u003eChargingSession\u003c/span\u003e {\n        \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eString\u003c/span\u003e::\u003cspan class=\"hljs-title function_\"\u003efrom\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"11111\"\u003c/span\u003e),\n        \u003cspan class=\"hljs-attr\"\u003ewatts\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e420\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr\"\u003evin\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eString\u003c/span\u003e::\u003cspan class=\"hljs-title function_\"\u003efrom\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"4Y1SL65848Z411439\"\u003c/span\u003e),\n    };\n    println!(\u003cspan class=\"hljs-string\"\u003e\"Regular way to create struct: {:?}\"\u003c/span\u003e, cs_old_way);\n\n    \u003cspan class=\"hljs-comment\"\u003e// ë¹Œë”ë¥¼ ì‚¬ìš©í•´ì„œ ìƒì„±í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e cs = \u003cspan class=\"hljs-title class_\"\u003eChargingSessionBuilder\u003c/span\u003e::\u003cspan class=\"hljs-title function_\"\u003enew\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"11111\"\u003c/span\u003e)\n        .\u003cspan class=\"hljs-title function_\"\u003ewatts\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e420\u003c/span\u003e)\n        .\u003cspan class=\"hljs-title function_\"\u003evin\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"4Y1SL65848Z411439\"\u003c/span\u003e)\n        .\u003cspan class=\"hljs-title function_\"\u003ebuild\u003c/span\u003e();\n    println!(\u003cspan class=\"hljs-string\"\u003e\"Builder pattern to create struct: {:?}\"\u003c/span\u003e, cs);\n\n    \u003cspan class=\"hljs-comment\"\u003e// IDë§Œ ì œê³µí•˜ì—¬ ìƒì„±í•˜ëŠ” ì˜ˆì‹œì…ë‹ˆë‹¤.\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e cs_lean = \u003cspan class=\"hljs-title class_\"\u003eChargingSessionBuilder\u003c/span\u003e::\u003cspan class=\"hljs-title function_\"\u003enew\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"11111\"\u003c/span\u003e)\n    .\u003cspan class=\"hljs-title function_\"\u003ebuild\u003c/span\u003e();\n     println!(\u003cspan class=\"hljs-string\"\u003e\"Builder pattern to create struct (default values): {:?}\"\u003c/span\u003e, cs_lean);\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eì´ê±¸ í•œ ë²ˆì— ì´í•´í•˜ê¸°ì— ë§ì§€ë§Œ, ë‹¨ê³„ì ìœ¼ë¡œ ì§„í–‰í•´ ë´…ì‹œë‹¤.\u003c/p\u003e\n\u003cp\u003eë¨¼ì €, ì¶©ì „ ì„¸ì…˜ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” êµ¬ì¡°ì²´ë¥¼ ì •ì˜í–ˆìŠµë‹ˆë‹¤. ì´ ì‹œë¦¬ì¦ˆì˜ ì´ì „ ì˜ˆì œì—ì„œ í•˜ë‚˜ì˜ í•„ë“œì¸ ì„¸ì…˜ìš© ì°¨ëŸ‰ ID ë²ˆí˜¸ì¸ vinì„ ì¶”ê°€í–ˆì–´ìš”.\u003c/p\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eê·¸ëŸ¬ë©´ ë°ì´í„° êµ¬ì¡°ì²´ì™€ ë™ì¼í•œ í•„ë“œë¥¼ ê°€ì§„ ë¹Œë”ë¥¼ ìœ„í•œ êµ¬ì¡°ì²´ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eë¹Œë”ëŠ” impl ë¸”ë¡ì—ì„œ êµ¬í˜„ë˜ë©°, id ë° ê° ì¶”ê°€ í•„ë“œë¥¼ ì„¤ì •í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì •ì˜í•˜ëŠ” ìƒˆ í•¨ìˆ˜ê°€ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ëª‡ ê°€ì§€ ì¤‘ìš”í•œ ì‚¬í•­ì´ ìˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eê° í•¨ìˆ˜ëŠ” ChargingSessionBuilder ìœ í˜•ì„ ë°˜í™˜í•©ë‹ˆë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ selfì…ë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eì¶”ê°€ ì†ì„± í•„ë“œì—ëŠ” mut selfë¥¼ ì²« ë²ˆì§¸ ë§¤ê°œë³€ìˆ˜ë¡œ ì‚¬ìš©í•˜ëŠ” ë©”ì„œë“œê°€ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ì´ëŸ¬í•œ í•¨ìˆ˜ í˜¸ì¶œì˜ ì²´ì´ë‹ì„ í—ˆìš©í•˜ëŠ” ë° ì¤‘ìš”í•©ë‹ˆë‹¤. ë˜í•œ ì—¬ê¸°ì— ìœ íš¨ì„± ê²€ì‚¬ ë…¼ë¦¬ë¥¼ ì½”ë”©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003ebuild í•¨ìˆ˜ê°€ ëª¨ë‘ í†µí•©ë˜ëŠ” ê³³ì…ë‹ˆë‹¤. ì¡´ì¬í•˜ëŠ” ê°’ë“¤ì„ í• ë‹¹í•˜ê³  ë‚˜ë©´ ê¸°ë³¸ê°’ì„ ê²°ì •í•˜ê³  ëŒ€ìƒ êµ¬ì¡°ì²´ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eì´ë¥¼ í†µí•´ ë¹Œë” íŒ¨í„´ì˜ ìš°ì•„í•¨ê³¼ Rust ë‚´ì—ì„œì˜ êµ¬í˜„ ë°©ë²•ì„ ì‚´í´ë³´ì•˜ìŠµë‹ˆë‹¤. ì´ê²ƒì´ ì•±ì´ë‚˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ì½”ë“œë¥¼ êµ¬í˜„í•˜ëŠ” í›Œë¥­í•œ ë°©ë²•ì„ì„ ì•Œ ìˆ˜ ìˆê¸°ë¥¼ ë°”ëë‹ˆë‹¤.\u003c/p\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eë‹¤ìŒ ì„¹ì…˜ì¸ ë°ì´í„°ë² ì´ìŠ¤ë¡œ ë„˜ì–´ê°€ ë´…ì‹œë‹¤.\u003c/p\u003e\n\u003ch1\u003eë°ì´í„°ë² ì´ìŠ¤ â€” sqlx\u003c/h1\u003e\n\u003cp\u003eì´ ì„¹ì…˜ì—ì„œëŠ” Rust í”„ë¡œê·¸ë¨ì—ì„œ sqlxë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ ì‘ì—…ì„ ì‚´í´ë³¼ ê²ƒì…ë‹ˆë‹¤. ë¨¼ì € ì¼ë¶€ ì„¤ì •ì´ í•„ìš”í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003ch2\u003eì„¤ì •\u003c/h2\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eìƒˆ í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í•´ë´…ì‹œë‹¤. db_appì´ë¼ê³  ì´ë¦„ ì§“ê³ , cargo new db_appìœ¼ë¡œ ìƒì„±í•  ìˆ˜ ìˆì–´ìš”. ê¸°ë³¸ ë””ë ‰í† ë¦¬ì— ëª‡ ê°œì˜ íŒŒì¼ì„ ìƒì„±í•  ê±°ì—ìš”. ì²« ë²ˆì§¸ íŒŒì¼ì€ docker-compose.ymlì´ë¼ê³  í•˜ë©° ë‹¤ìŒ ë‚´ìš©ì´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤. Postgresì™€ Pgadminì´ ë…¸ì¶œë˜ëŠ” ì„ì˜ì˜ í¬íŠ¸ë¥¼ ì„ íƒí–ˆìœ¼ë©°, ì»´í“¨í„°ì— ì„¤ì¹˜ëœ ë‹¤ë¥¸ ì•±ë“¤ê³¼ ì¶©ëŒí•˜ì§€ ì•Šë„ë¡ í–ˆì–´ìš”.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'3'\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003epostgres\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: \u003cspan class=\"hljs-attr\"\u003epostgres\u003c/span\u003e:latest\n    \u003cspan class=\"hljs-attr\"\u003econtainer_name\u003c/span\u003e: postgres\n    \u003cspan class=\"hljs-attr\"\u003eports\u003c/span\u003e:\n      - \u003cspan class=\"hljs-string\"\u003e'6500:5432'\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003evolumes\u003c/span\u003e:\n      - \u003cspan class=\"hljs-attr\"\u003epostgresDB\u003c/span\u003e:\u003cspan class=\"hljs-regexp\"\u003e/data/\u003c/span\u003epostgres\n    \u003cspan class=\"hljs-attr\"\u003eenv_file\u003c/span\u003e:\n      - ./.\u003cspan class=\"hljs-property\"\u003eenv\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003epgAdmin\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: dpage/pgadmin4\n    \u003cspan class=\"hljs-attr\"\u003econtainer_name\u003c/span\u003e: pgAdmin\n    \u003cspan class=\"hljs-attr\"\u003eenv_file\u003c/span\u003e:\n      - ./.\u003cspan class=\"hljs-property\"\u003eenv\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003eports\u003c/span\u003e:\n      - \u003cspan class=\"hljs-string\"\u003e\"5050:80\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003evolumes\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003epostgresDB\u003c/span\u003e:\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e.envì´ë¼ëŠ” íŒŒì¼ì´ í•˜ë‚˜ ë” í•„ìš”í•˜ë©°, ë‹¤ìŒ ë‚´ìš©ì´ ìˆì–´ì•¼ í•´ìš”. ì´ íŒŒì¼ì€ docker-compose íŒŒì¼ê³¼ ë‚˜ì¤‘ì— Rust ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ëª¨ë‘ ì‚¬ìš©í•  ê±°ì—ìš”.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-variable constant_\"\u003ePOSTGRES_HOST\u003c/span\u003e=\u003cspan class=\"hljs-number\"\u003e127.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003ePOSTGRES_PORT\u003c/span\u003e=\u003cspan class=\"hljs-number\"\u003e6500\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003ePOSTGRES_USER\u003c/span\u003e=admin\n\u003cspan class=\"hljs-variable constant_\"\u003ePOSTGRES_PASSWORD\u003c/span\u003e=password123\n\u003cspan class=\"hljs-variable constant_\"\u003ePOSTGRES_DB\u003c/span\u003e=charging_session\n\n\u003cspan class=\"hljs-variable constant_\"\u003eDATABASE_URL\u003c/span\u003e=\u003cspan class=\"hljs-attr\"\u003epostgresql\u003c/span\u003e:\u003cspan class=\"hljs-comment\"\u003e//admin:password123@localhost:6500/charging_session?currentSchema=public\u003c/span\u003e\n\n\u003cspan class=\"hljs-variable constant_\"\u003ePGADMIN_DEFAULT_EMAIL\u003c/span\u003e=admin@admin.\u003cspan class=\"hljs-property\"\u003ecom\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003ePGADMIN_DEFAULT_PASSWORD\u003c/span\u003e=password123\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eìœ„ì˜ ë‚´ìš©ê³¼ í•¨ê»˜ ë°ì´í„°ë² ì´ìŠ¤ ì‚¬ìš©ì, ë¹„ë°€ë²ˆí˜¸, ê·¸ë¦¬ê³  Pgadminì— ëŒ€í•œ ì—°ê²° ì •ë³´ë¥¼ ì œê³µí•´ ë“œë ¸ìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eì´ ë‘ ê°€ì§€ í•­ëª©ì„ ë§Œë“¤ê³  ìœ„ì˜ ë‚´ìš©ì„ ì‚¬ìš©í•˜ì—¬ Docker Composeë¥¼ ì‚¬ìš©í•˜ì—¬ ë¡œì»¬ DB ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì²˜ìŒì—ëŠ” í•­ìƒ ì „ê²½ì—ì„œ ì‹œì‘í•˜ëŠ” ê²ƒì„ ì¢‹ì•„í•©ë‹ˆë‹¤. ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ë° ê¸°íƒ€ ì‘ì—…ì„ í•˜ê¸° ë•Œë¬¸ì— ì—¬ëŸ¬ë¶„ì˜ ì»´í“¨í„° ë° ë„¤íŠ¸ì›Œí¬ ì†ë„ì— ë”°ë¼ ì‹œê°„ì´ ì†Œìš”ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. docker-compose.yml ë° .env íŒŒì¼ì´ ìˆëŠ” ë””ë ‰í† ë¦¬ì™€ ë™ì¼í•œ ìœ„ì¹˜ì—ì„œ ë‹¤ìŒì„ ì‹¤í–‰í•˜ì‹­ì‹œì˜¤.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003edocker-compose up\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eì‹œì‘ëœ ëª¨ë“  ê²ƒì„ í™•ì¸í•œ í›„ì—ëŠ” ì–¸ì œë“ ì§€ -d ìŠ¤ìœ„ì¹˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ëª¬ ëª¨ë“œë¡œ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì™„ë£Œë˜ë©´ ë‘ ì»¨í…Œì´ë„ˆê°€ ì‹œì‘ë˜ì—ˆëŠ”ì§€ í™•ì¸í•´ ë´…ì‹œë‹¤. ë‹¤ìŒê³¼ ê°™ì´ ëª…ë ¹ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003edocker ps\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eë¹„ìŠ·í•œ ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cimg src=\"/assets/img/2024-05-23-LearningRustPart11BuildersandDatabaseInteraction_1.png\"\u003e\n\u003cp\u003eë§Œì•½ ë‘ ê°œì˜ ì»¨í…Œì´ë„ˆê°€ í‘œì‹œë˜ì§€ ì•ŠëŠ”ë‹¤ë©´, docker-composeë¥¼ ì‹¤í–‰í•œ í„°ë¯¸ë„ì—ì„œ ì—ëŸ¬ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”.\u003c/p\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eí•œ ë²ˆ ì´ë“¤ì´ ì‹¤í–‰ë˜ë©´ DBì— ì—°ê²°í•´ ë´…ì‹œë‹¤. Pgadminì„ í¬íŠ¸ 5050ì—ì„œ ì‹¤í–‰í•˜ë„ë¡ êµ¬ì„±í–ˆìœ¼ë‹ˆ ë¸Œë¼ìš°ì €ì—ì„œ \u003ca href=\"http://localhost:5050%EC%9D%84\" rel=\"nofollow\" target=\"_blank\"\u003ehttp://localhost:5050ì„\u003c/a\u003e ì…ë ¥í•˜ë©´ pgadminì˜ ë¡œê·¸ì¸ í™”ë©´ì´ í‘œì‹œë©ë‹ˆë‹¤. .env íŒŒì¼ì— êµ¬ì„±ëœ ìê²© ì¦ëª…(ê´€ë¦¬ì@ê´€ë¦¬ì.com/ë¹„ë°€ë²ˆí˜¸123)ì„ ì‚¬ìš©í•˜ì—¬ pgadminì— ë¡œê·¸ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ°ë° ì•„ì§ ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ ë‹¤ìŒì„ ì‹¤í–‰í•´ì•¼ í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003edocker inspect postgres\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eì¶œë ¥ì„ í™•ì¸í•˜ì—¬ \"NetworkSettings\" ì„¹ì…˜ìœ¼ë¡œ ì´ë™í•˜ê³  \"IPAddress\" ì†ì„±ì˜ ê°’ì„ ë³µì‚¬í•©ë‹ˆë‹¤. ì´ ê°’ì€ DBì— ì—°ê²°í•˜ëŠ” ë° ì‚¬ìš©í•  í˜¸ìŠ¤íŠ¸(IP)ì…ë‹ˆë‹¤. ì œ ì»´í“¨í„°ì—ì„œ ì´ ê°’ì€ 172.23.0.1 ì´ì—ˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eë¡œê·¸ì¸í•œ í›„ \"ìƒˆ ì„œë²„ ì¶”ê°€\" ë²„íŠ¼ì„ í´ë¦­í•˜ê³ , \"í˜¸ìŠ¤íŠ¸ ì´ë¦„/ì£¼ì†Œ\"ë¡œ ì´ì „ì— ë³µì‚¬í•œ IP ì£¼ì†Œë¥¼ í¬í•¨í•œ í•„ìˆ˜ ìê²© ì¦ëª…ì„ ì œê³µí•˜ê³  \"ì €ì¥\" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.\u003c/p\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eì„œë²„ì— ë¡œê·¸ì¸í•˜ë©´ ë°ì´í„°ë² ì´ìŠ¤ charging_sessionì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-05-23-LearningRustPart11BuildersandDatabaseInteraction_2.png\" alt=\"ì´ë¯¸ì§€\"\u003e\u003c/p\u003e\n\u003cp\u003eì˜ í–ˆì–´ìš”. ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì‚¬ìš©í•  ì¤€ë¹„ê°€ ë˜ì—ˆê³  Pgadminì—ì„œ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eì´ì œ Rust ì•±ì˜ ì¢…ì†ì„±ì„ êµ¬ì„±í•´ ë´…ì‹œë‹¤. ì²˜ìŒì—ëŠ” ëª¨ë‘ í•„ìš”í•˜ì§€ ì•Šì§€ë§Œ ê²°êµ­ í•„ìš”í•˜ê²Œ ë  ê²ƒì´ë¯€ë¡œ ì§€ê¸ˆ ì¶”ê°€í•´ ë‘ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eCargo.toml íŒŒì¼ì˜ ì¢…ì†ì„± ë¶€ë¶„ì„ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜ì •í•˜ì„¸ìš”.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-toml\"\u003e\u003cspan class=\"hljs-section\"\u003e[dependencies]\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003echrono\u003c/span\u003e = { version = \u003cspan class=\"hljs-string\"\u003e\"0.4.31\"\u003c/span\u003e, features = [\u003cspan class=\"hljs-string\"\u003e\"serde\"\u003c/span\u003e] }\n\u003cspan class=\"hljs-attr\"\u003edotenv\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"0.15.0\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eenv_logger\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"0.10.1\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003elog\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"0.4.20\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eserde\u003c/span\u003e = { version = \u003cspan class=\"hljs-string\"\u003e\"1.0.193\"\u003c/span\u003e, features = [\u003cspan class=\"hljs-string\"\u003e\"derive\"\u003c/span\u003e] }\n\u003cspan class=\"hljs-attr\"\u003eserde_json\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"1.0.108\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003esqlx\u003c/span\u003e = { version = \u003cspan class=\"hljs-string\"\u003e\"0.7.3\"\u003c/span\u003e, features = [\u003cspan class=\"hljs-string\"\u003e\"runtime-tokio-native-tls\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"postgres\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"uuid\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"chrono\"\u003c/span\u003e] }\n\u003cspan class=\"hljs-attr\"\u003etokio\u003c/span\u003e = { version = \u003cspan class=\"hljs-string\"\u003e\"1.35.0\"\u003c/span\u003e, features = [\u003cspan class=\"hljs-string\"\u003e\"macros\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"rt-multi-thread\"\u003c/span\u003e]}\n\u003cspan class=\"hljs-attr\"\u003euuid\u003c/span\u003e = { version = \u003cspan class=\"hljs-string\"\u003e\"1.6.1\"\u003c/span\u003e, features = [\u003cspan class=\"hljs-string\"\u003e\"serde\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"v4\"\u003c/span\u003e] }\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eë‹¤ì–‘í•œ ì¢…ì†ì„±ì— ëŒ€í•´ í™œì„±í™”ëœ ê¸°ëŠ¥ì„ ê²€í† í•˜ëŠ” ë°ë„ ì‹œê°„ì„ í• ì• í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eë‹¤ìŒìœ¼ë¡œ, í•„ìš”í•œ í…Œì´ë¸”ì„ ë§Œë“¤ê¸° ìœ„í•´ sqlx-cli ë§ˆì´ê·¸ë ˆì´ì…˜ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ê²ƒì…ë‹ˆë‹¤.\u003c/p\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eìš°ì„  ëª…ë ¹ ì¤„ì—ì„œ ë‹¤ìŒì„ ì‹¤í–‰í•˜ì—¬ CLIë¥¼ ì„¤ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003ecargo install sqlx-cli --no-\u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e-features --features rustls,postgres\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eê·¸ëŸ° ë‹¤ìŒ ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ì„ ì´ˆê¸°í™”í•´ì•¼ í•©ë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì´ ì‹¤í–‰í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003esqlx migrate add initial-tables\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eì´ ëª…ë ¹ì–´ëŠ” ìš°ë¦¬ê°€ ë§ˆì´ê·¸ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•˜ê¸° ìœ„í•´ ìƒˆ íŒŒì¼ migrations/\u003ccode\u003etimestamp\u003c/code\u003e_initial-tables.sqlì„ ìƒì„±í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-05-23-LearningRustPart11BuildersandDatabaseInteraction_3.png\" alt=\"ì´ë¯¸ì§€\"\u003e\u003c/p\u003e\n\u003cp\u003eì´ íŒŒì¼ì„ ì—´ê³  ì•„ë˜ SQL ë¬¸ì„ ì¶”ê°€í•˜ì—¬ í…Œì´ë¸”ì„ ìƒì„±í•˜ì„¸ìš”.\u003c/p\u003e\n\u003cp\u003ecreate table locations (\nid bigserial primary key,\nname varchar(255) unique not null\n);\u003c/p\u003e\n\u003cp\u003ecreate table sessions (\nid bigserial primary key,\nlocation_id bigint not null,\nwatts bigint not null,\nvin varchar(255) not null,\nconstraint fk_location foreign key (location_id) references locations(id) on delete cascade\n);\u003c/p\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eìœ„ ì˜ˆì œì—ì„œ ì‚¬ìš©í•  ë‘ ê°œì˜ í…Œì´ë¸” ì •ì˜ì…ë‹ˆë‹¤. ì´ ì‹œë¦¬ì¦ˆì˜ ì¶©ì „ ì„¸ì…˜ì— ëŒ€í•œ í‘œì¤€ ì˜ˆì œë¥¼ í™•ì¥í•˜ì—¬, ì¶©ì „ ì¥ì¹˜ì˜ ìœ„ì¹˜ë¥¼ ì €ì¥í•  locations í…Œì´ë¸”ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eì´ì œ ë‹¤ìŒì„ ì‹¤í–‰í•˜ì—¬ í…Œì´ë¸”ì„ ìƒì„±í•˜ì„¸ìš”.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003esqlx migrate run\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eê·¸ëŸ¬ë©´ ì¦‰ì‹œ 20231212235431/migrate initial-tables (íƒ€ì„ìŠ¤íƒ¬í”„ ë¶€ë¶„ì€ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŒ)ê³¼ ê°™ì€ ë©”ì‹œì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤. ì´ì œ Pgadminì— ê°€ì„œ í…Œì´ë¸”ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cimg src=\"/assets/img/2024-05-23-LearningRustPart11BuildersandDatabaseInteraction_4.png\"\u003e\n\u003cp\u003eìœ„ì—ì„œ ë³´ë“¯ì´ ë‘ ê°œì˜ í…Œì´ë¸”ì´ ìƒì„±ë˜ì—ˆê³ , ë¬¸ì„œ ëª©ì ì„ ìœ„í•´ Pgadmin ë‚´ì— ERD ë‹¤ì´ì–´ê·¸ë¨ë„ ìƒì„±í–ˆìŠµë‹ˆë‹¤. ì´ì œ ì´ˆê¸° ì„¤ì •ê³¼ í”„ë¡œì íŠ¸ êµ¬ì„±ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003ch1\u003eë°ì´í„°ë² ì´ìŠ¤ í•¨ìˆ˜\u003c/h1\u003e\n\u003cp\u003eì´ ì„¹ì…˜ì—ì„œëŠ” ë°ì´í„°ë² ì´ìŠ¤ ìƒí˜¸ ì‘ìš©ì˜ ë‹¤ì–‘í•œ ìœ í˜•ê³¼ Rust êµ¬í˜„ì„ ì‚´í´ë³¼ ê²ƒì…ë‹ˆë‹¤. ì´ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°í•˜ëŠ” ê²ƒìœ¼ë¡œ ì‹œì‘ë©ë‹ˆë‹¤.\u003c/p\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eDBì— ì—°ê²°í•˜ê¸°\u003c/p\u003e\n\u003cp\u003eë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°í•˜ëŠ” ë°©ë²•ì€ PgPoolOptions connect í•¨ìˆ˜ë¥¼ í†µí•´ ì—°ê²°ì„ ìƒì„±í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ìš°ë¦¬ì˜ .env íŒŒì¼ì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ë¬¸ìì—´ì„ ì½ê³  ë¡œê¹…ì„ êµ¬ì„±í•˜ë©° ì„±ê³µ ë˜ëŠ” ì˜¤ë¥˜ë¥¼ ê¸°ë¡í•˜ëŠ” ì½”ë“œ ì „ì²´ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003euse \u003cspan class=\"hljs-attr\"\u003esqlx\u003c/span\u003e::{\u003cspan class=\"hljs-attr\"\u003epostgres\u003c/span\u003e::\u003cspan class=\"hljs-title class_\"\u003ePgPoolOptions\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003ePool\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003ePostgres\u003c/span\u003e};\nuse \u003cspan class=\"hljs-attr\"\u003edotenv\u003c/span\u003e::dotenv;\nuse \u003cspan class=\"hljs-attr\"\u003elog\u003c/span\u003e::{info, error};\n\n#[\u003cspan class=\"hljs-attr\"\u003etokio\u003c/span\u003e::main]\n\u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e fn \u003cspan class=\"hljs-title function_\"\u003emain\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003estd\u003c/span\u003e::\u003cspan class=\"hljs-attr\"\u003eenv\u003c/span\u003e::\u003cspan class=\"hljs-title function_\"\u003evar_os\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"RUST_LOG\"\u003c/span\u003e).\u003cspan class=\"hljs-title function_\"\u003eis_none\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n        \u003cspan class=\"hljs-attr\"\u003estd\u003c/span\u003e::\u003cspan class=\"hljs-attr\"\u003eenv\u003c/span\u003e::\u003cspan class=\"hljs-title function_\"\u003eset_var\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"RUST_LOG\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"info\"\u003c/span\u003e);\n    }\n    \u003cspan class=\"hljs-title function_\"\u003edotenv\u003c/span\u003e().\u003cspan class=\"hljs-title function_\"\u003eok\u003c/span\u003e();\n    \u003cspan class=\"hljs-attr\"\u003eenv_logger\u003c/span\u003e::\u003cspan class=\"hljs-title function_\"\u003einit\u003c/span\u003e();\n\n    \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e database_url = \u003cspan class=\"hljs-attr\"\u003estd\u003c/span\u003e::\u003cspan class=\"hljs-attr\"\u003eenv\u003c/span\u003e::\u003cspan class=\"hljs-title function_\"\u003evar\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"DATABASE_URL\"\u003c/span\u003e).\u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"DATABASE_URL must be set\"\u003c/span\u003e);\n    \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e pool = match \u003cspan class=\"hljs-title class_\"\u003ePgPoolOptions\u003c/span\u003e::\u003cspan class=\"hljs-title function_\"\u003enew\u003c/span\u003e()\n        .\u003cspan class=\"hljs-title function_\"\u003emax_connections\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e)\n        .\u003cspan class=\"hljs-title function_\"\u003econnect\u003c/span\u003e(\u0026#x26;database_url)\n        .\u003cspan class=\"hljs-property\"\u003eawait\u003c/span\u003e\n    {\n        \u003cspan class=\"hljs-title class_\"\u003eOk\u003c/span\u003e(pool) =\u003e {\n            info!(\u003cspan class=\"hljs-string\"\u003e\"âœ… ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤!\"\u003c/span\u003e);\n            pool\n        }\n        \u003cspan class=\"hljs-title class_\"\u003eErr\u003c/span\u003e(err) =\u003e {\n            error!(\u003cspan class=\"hljs-string\"\u003e\"ğŸ”¥ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: {:?}\"\u003c/span\u003e, err);\n            \u003cspan class=\"hljs-attr\"\u003estd\u003c/span\u003e::\u003cspan class=\"hljs-attr\"\u003eprocess\u003c/span\u003e::\u003cspan class=\"hljs-title function_\"\u003eexit\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e);\n        }\n    };\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eì‹œì‘ ë¶€ë¶„ì˜ #[tokio::main] ë§¤í¬ë¡œë¥¼ ì£¼ëª©í•´ì£¼ì„¸ìš”. ì´ëŠ” async fn main()ì„ ë™ê¸° fn main()ë¡œ ë³€í™˜í•˜ì—¬ ëŸ°íƒ€ì„ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì´ˆê¸°í™”í•˜ê³  async main í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ê²Œ í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eìœ„ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë©´ ì¶œë ¥ ë¡œê¹…ì—ì„œ ë‹¤ìŒ ë©”ì‹œì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e[2023-12-13T00:16:42Z INFO db_app] âœ… ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤!\u003c/p\u003e\n\u003cp\u003eìš°ë¦¬ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. .env íŒŒì¼ì—ì„œ êµ¬ì„±í•œ ëª¨ë“  ì—°ê²° ì •ë³´ë¥¼ ê¸°ì–µí•´ ì£¼ì„¸ìš”. ì´ ì •ë³´ëŠ” docker-compose, sqlx-cli, ê·¸ë¦¬ê³  ìš°ë¦¬ì˜ ì–´í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ê³µìœ ë˜ì—ˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003ch2\u003eInserts\u003c/h2\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eì´ì œ ì—°ê²° í’€ì´ ì¤€ë¹„ë˜ì—ˆìœ¼ë‹ˆ, ìš°ë¦¬ê°€ ì‚´í´ë³¼ ì²« ë²ˆì§¸ ë°ì´í„°ë² ì´ìŠ¤ ë¡œì§ì€ ì‚½ì…ì…ë‹ˆë‹¤. sqlxë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚½ì…í•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-rust\"\u003e\u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"hljs-variable\"\u003einsert_result\u003c/span\u003e = sqlx::query_as!(\n    Locations,\n    \u003cspan class=\"hljs-string\"\u003e\"INSERT INTO locations (id,name) VALUES (1, 'Location A') RETURNING *\"\u003c/span\u003e\n)\n.\u003cspan class=\"hljs-title function_ invoke__\"\u003efetch_one\u003c/span\u003e(\u0026#x26;pool)\n.\u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword\"\u003ematch\u003c/span\u003e insert_result {\n    \u003cspan class=\"hljs-title function_ invoke__\"\u003eOk\u003c/span\u003e(location) =\u003e {\n        info!(\u003cspan class=\"hljs-string\"\u003e\"âœ“Inserted: {:?}\"\u003c/span\u003e, location);\n    }\n    \u003cspan class=\"hljs-title function_ invoke__\"\u003eErr\u003c/span\u003e(e) =\u003e {\n        error!(\u003cspan class=\"hljs-string\"\u003e\"Error Insert: {}\"\u003c/span\u003e, e.\u003cspan class=\"hljs-title function_ invoke__\"\u003eto_string\u003c/span\u003e())\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eì´ ì½”ë“œëŠ” í•˜ë‚˜ì˜ ë ˆì½”ë“œë¥¼ ì‚½ì…í•  ê²ƒì…ë‹ˆë‹¤. ë¬¼ë¡  ë§¤ê°œë³€ìˆ˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆìœ¼ë©°, ì´ëŠ” ì—…ë°ì´íŠ¸ë¥¼ ì‚´í´ë³¼ ë•Œ ì‚´í´ë³¼ ê²ƒì…ë‹ˆë‹¤.\u003c/p\u003e\n\u003ch2\u003eì§ˆì˜í•˜ê¸°\u003c/h2\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eë‹¤ìŒìœ¼ë¡œ, ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì¡°íšŒí•˜ëŠ” ë°©ë²•ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e    \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e query_result = \u003cspan class=\"hljs-attr\"\u003esqlx\u003c/span\u003e::query_as!(\u003cspan class=\"hljs-title class_\"\u003eLocations\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"SELECT * FROM Locations\"\u003c/span\u003e)\n        .\u003cspan class=\"hljs-title function_\"\u003efetch_all\u003c/span\u003e(\u0026#x26;pool)\n        .\u003cspan class=\"hljs-property\"\u003eawait\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e query_result.\u003cspan class=\"hljs-title function_\"\u003eis_err\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n        \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e message = \u003cspan class=\"hljs-string\"\u003e\"ëª¨ë“  ìœ„ì¹˜ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë™ì•ˆ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\"\u003c/span\u003e;\n        error!(\u003cspan class=\"hljs-string\"\u003e\"{}{}\"\u003c/span\u003e, message, query_result.\u003cspan class=\"hljs-title function_\"\u003eerr\u003c/span\u003e().\u003cspan class=\"hljs-title function_\"\u003eunwrap\u003c/span\u003e());\n    } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n        info!(\u003cspan class=\"hljs-string\"\u003e\"ğŸ˜ ìœ„ì¹˜ì— ëŒ€í•œ ì¿¼ë¦¬ ê²°ê³¼ {:?}\"\u003c/span\u003e, query_result.\u003cspan class=\"hljs-title function_\"\u003eunwrap\u003c/span\u003e());\n    }\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eì´ê²ƒì€ ì„±ê³µì ìœ¼ë¡œ ì‘ë™í–ˆë‹¤ë©´ unwrapì„ í†µí•´ ê²°ê³¼ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ê²°ê³¼ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. ì¿¼ë¦¬ ë‚´ì˜ ì´ìŠˆê°€ ë°œìƒí–ˆë‹¤ë©´ í•´ë‹¹ ì—ëŸ¬ì— ì ‘ê·¼í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003ch2\u003eì—…ë°ì´íŠ¸\u003c/h2\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eë‹¤ìŒ ì‘ì—…ì€ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ëŠ” ì´ì „ì— ì‚½ì…í•œ ê²ƒê³¼ ë¹„ìŠ·í•  ê²ƒì…ë‹ˆë‹¤.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e    \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e update_result = \u003cspan class=\"hljs-attr\"\u003esqlx\u003c/span\u003e::query_as!(\n        \u003cspan class=\"hljs-title class_\"\u003eSessions\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"UPDATE sessions SET watts = 415 WHERE id = $1 RETURNING *\"\u003c/span\u003e,\n        1i64,\n    )\n    .\u003cspan class=\"hljs-title function_\"\u003efetch_one\u003c/span\u003e(\u0026#x26;pool)\n    .\u003cspan class=\"hljs-property\"\u003eawait\u003c/span\u003e;\n\n    match update_result {\n        \u003cspan class=\"hljs-title class_\"\u003eOk\u003c/span\u003e(session) =\u003e {\n            info!(\u003cspan class=\"hljs-string\"\u003e\"âœ“Update: {:?}\"\u003c/span\u003e, session);\n        }\n        \u003cspan class=\"hljs-title class_\"\u003eErr\u003c/span\u003e(e) =\u003e {\n            error!(\u003cspan class=\"hljs-string\"\u003e\"Error Update: {}\"\u003c/span\u003e, e.\u003cspan class=\"hljs-title function_\"\u003eto_string\u003c/span\u003e())\n        }\n    }\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eì´ ì˜ˆì œì—ì„œ ì£¼ëª©í•  ì ì€ $1ì´ë¼ëŠ” ë§¤ê°œë³€ìˆ˜ ìë¦¬ í‘œì‹œìë¥¼ ì‚¬ìš©í•˜ëŠ” ì¤€ë¹„ëœ ë¬¸(statement)ë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ SQL ë¬¸ìì—´ ë’¤ì— ë§¤ê°œë³€ìˆ˜ë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003ch2\u003eDeletes\u003c/h2\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eë§ˆì§€ë§‰ìœ¼ë¡œ, ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ë ˆì½”ë“œë¥¼ ì‚­ì œí•˜ëŠ” CRUD ì‘ì—…ì„ ì™„ë£Œí•©ë‹ˆë‹¤. ìš°ë¦¬ì˜ ëª©ì ì€ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì •ë¦¬í•˜ëŠ” ë° ì‚¬ìš©í•  ê²ƒì´ë©°, ì´ë ‡ê²Œ í•˜ë©´ ì–¸ì œë“ ì§€ ì‘ìš© í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e rows_deleted = \u003cspan class=\"hljs-attr\"\u003esqlx\u003c/span\u003e::query!(\u003cspan class=\"hljs-string\"\u003e\"DELETE from sessions\"\u003c/span\u003e)\n    .\u003cspan class=\"hljs-title function_\"\u003eexecute\u003c/span\u003e(\u0026#x26;pool)\n    .\u003cspan class=\"hljs-property\"\u003eawait\u003c/span\u003e\n    .\u003cspan class=\"hljs-title function_\"\u003eunwrap\u003c/span\u003e()\n    .\u003cspan class=\"hljs-title function_\"\u003erows_affected\u003c/span\u003e();\n\ninfo!(\u003cspan class=\"hljs-string\"\u003e\"âœ• ì„¸ì…˜ í…Œì´ë¸”ì—ì„œ {}ê°œì˜ í–‰ ì‚­ì œë¨\"\u003c/span\u003e, rows_deleted);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eì—¬ê¸°ì„œëŠ” ì—°ì‚°ì—ì„œì²˜ëŸ¼ sqlx::query ëŒ€ì‹  sqlx::query_asë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ë˜í•œ ì–¸ë© ì´í›„ .rows_affectedë¥¼ ì¶”ê°€í•˜ì—¬ ì‚­ì œëœ í–‰ ìˆ˜ë¥¼ ì–»ìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003ch2\u003eíŠ¸ëœì­ì…˜\u003c/h2\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-rust\"\u003e   \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"hljs-variable\"\u003etx\u003c/span\u003e = pool.\u003cspan class=\"hljs-title function_ invoke__\"\u003ebegin\u003c/span\u003e().\u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e.\u003cspan class=\"hljs-title function_ invoke__\"\u003eexpect\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤\"\u003c/span\u003e);\n\n   \u003cspan class=\"hljs-comment\"\u003e// ë°ì´í„°ë² ì´ìŠ¤ ì‘ì—… ìˆ˜í–‰(ë°ì´í„° ì‚½ì… ë˜ëŠ” ë³€ê²½)\u003c/span\u003e\n\n   tx.\u003cspan class=\"hljs-title function_ invoke__\"\u003ecommit\u003c/span\u003e().\u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e.\u003cspan class=\"hljs-title function_ invoke__\"\u003eexpect\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"íŠ¸ëœì­ì…˜ì„ ì»¤ë°‹í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤\"\u003c/span\u003e);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eì»¤ë°‹ì„ í˜¸ì¶œí•˜ì§€ ì•Šìœ¼ë©´ íŠ¸ëœì­ì…˜ì´ ë²”ìœ„ë¥¼ ë²—ì–´ë‚˜ë©´ ìë™ìœ¼ë¡œ ë¡¤ë°±ë©ë‹ˆë‹¤.\u003c/p\u003e\n\u003ch2\u003eì™„ì „í•œ ì‘ìš© í”„ë¡œê·¸ë¨\u003c/h2\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eìœ„ì˜ ì½”ë“œëŠ” ìš°ë¦¬ê°€ ì´ì „ì— ë…¼ì˜í•œ ëª¨ë“  ë‹¤ì–‘í•œ ê¸°ëŠ¥ì´ í•˜ë‚˜ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ëª¨ë‘ í¬í•¨ëœ ì™„ì „í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003euse \u003cspan class=\"hljs-attr\"\u003edotenv\u003c/span\u003e::dotenv;\nuse \u003cspan class=\"hljs-attr\"\u003elog\u003c/span\u003e::{error, info};\nuse \u003cspan class=\"hljs-attr\"\u003esqlx\u003c/span\u003e::{\u003cspan class=\"hljs-attr\"\u003epostgres\u003c/span\u003e::\u003cspan class=\"hljs-title class_\"\u003ePgPoolOptions\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003ePool\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003ePostgres\u003c/span\u003e};\n\n#[\u003cspan class=\"hljs-title function_\"\u003ederive\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eDebug\u003c/span\u003e)]\nstruct \u003cspan class=\"hljs-title class_\"\u003eLocations\u003c/span\u003e {\n    \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: i64,\n    \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eString\u003c/span\u003e,\n}\n\n#[\u003cspan class=\"hljs-title function_\"\u003ederive\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eDebug\u003c/span\u003e)]\nstruct \u003cspan class=\"hljs-title class_\"\u003eSessions\u003c/span\u003e {\n    \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: i64,\n    \u003cspan class=\"hljs-attr\"\u003elocation_id\u003c/span\u003e: i64,\n    \u003cspan class=\"hljs-attr\"\u003ewatts\u003c/span\u003e: i64,\n    \u003cspan class=\"hljs-attr\"\u003evin\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eString\u003c/span\u003e,\n}\n\u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e fn \u003cspan class=\"hljs-title function_\"\u003einsert_into_locations\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003epool: Pool\u0026#x3C;Postgres\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e tx = pool.\u003cspan class=\"hljs-title function_\"\u003ebegin\u003c/span\u003e().\u003cspan class=\"hljs-property\"\u003eawait\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Unable to begin transaction\"\u003c/span\u003e);\n\n    \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e insert_result = \u003cspan class=\"hljs-attr\"\u003esqlx\u003c/span\u003e::query_as!(\n        \u003cspan class=\"hljs-title class_\"\u003eLocations\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"INSERT INTO locations (id,name) VALUES (1, 'Location A') RETURNING *\"\u003c/span\u003e\n    )\n    .\u003cspan class=\"hljs-title function_\"\u003efetch_one\u003c/span\u003e(\u0026#x26;pool)\n    .\u003cspan class=\"hljs-property\"\u003eawait\u003c/span\u003e;\n\n    match insert_result {\n        \u003cspan class=\"hljs-title class_\"\u003eOk\u003c/span\u003e(location) =\u003e {\n            info!(\u003cspan class=\"hljs-string\"\u003e\"âœ“Inserted: {:?}\"\u003c/span\u003e, location);\n        }\n        \u003cspan class=\"hljs-title class_\"\u003eErr\u003c/span\u003e(e) =\u003e {\n            error!(\u003cspan class=\"hljs-string\"\u003e\"Error Insert: {}\"\u003c/span\u003e, e.\u003cspan class=\"hljs-title function_\"\u003eto_string\u003c/span\u003e())\n        }\n    }\n    \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e insert_result = \u003cspan class=\"hljs-attr\"\u003esqlx\u003c/span\u003e::query_as!(\n        \u003cspan class=\"hljs-title class_\"\u003eLocations\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"INSERT INTO locations (id,name) VALUES (2, 'Location B') RETURNING *\"\u003c/span\u003e\n    )\n    .\u003cspan class=\"hljs-title function_\"\u003efetch_one\u003c/span\u003e(\u0026#x26;pool)\n    .\u003cspan class=\"hljs-property\"\u003eawait\u003c/span\u003e;\n\n    match insert_result {\n        \u003cspan class=\"hljs-title class_\"\u003eOk\u003c/span\u003e(location) =\u003e {\n            info!(\u003cspan class=\"hljs-string\"\u003e\"âœ“Inserted: {:?}\"\u003c/span\u003e, location);\n        }\n        \u003cspan class=\"hljs-title class_\"\u003eErr\u003c/span\u003e(e) =\u003e {\n            error!(\u003cspan class=\"hljs-string\"\u003e\"Error Insert: {}\"\u003c/span\u003e, e.\u003cspan class=\"hljs-title function_\"\u003eto_string\u003c/span\u003e())\n        }\n    }\n\n    tx.\u003cspan class=\"hljs-title function_\"\u003ecommit\u003c/span\u003e().\u003cspan class=\"hljs-property\"\u003eawait\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Unable to commit the transaction\"\u003c/span\u003e);\n}\n\n\u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e fn \u003cspan class=\"hljs-title function_\"\u003einsert_into_sessions\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003epool: Pool\u0026#x3C;Postgres\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e tx = pool.\u003cspan class=\"hljs-title function_\"\u003ebegin\u003c/span\u003e().\u003cspan class=\"hljs-property\"\u003eawait\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Unable to begin transaction\"\u003c/span\u003e);\n\n    \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e insert_result = \u003cspan class=\"hljs-attr\"\u003esqlx\u003c/span\u003e::query_as!(\n        \u003cspan class=\"hljs-title class_\"\u003eSessions\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"INSERT INTO sessions (id,location_id, watts, vin) VALUES (1, 1, 420, '2FMZA52286BA02033') RETURNING *\"\u003c/span\u003e\n    )\n    .\u003cspan class=\"hljs-title function_\"\u003efetch_one\u003c/span\u003e(\u0026#x26;pool)\n    .\u003cspan class=\"hljs-property\"\u003eawait\u003c/span\u003e;\n\n    match insert_result {\n        \u003cspan class=\"hljs-title class_\"\u003eOk\u003c/span\u003e(session) =\u003e {\n            info!(\u003cspan class=\"hljs-string\"\u003e\"âœ“Inserted: {:?}\"\u003c/span\u003e, session);\n        }\n        \u003cspan class=\"hljs-title class_\"\u003eErr\u003c/span\u003e(e) =\u003e {\n            error!(\u003cspan class=\"hljs-string\"\u003e\"Error Insert: {}\"\u003c/span\u003e, e.\u003cspan class=\"hljs-title function_\"\u003eto_string\u003c/span\u003e())\n        }\n    }\n    \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e insert_result = \u003cspan class=\"hljs-attr\"\u003esqlx\u003c/span\u003e::query_as!(\n        \u003cspan class=\"hljs-title class_\"\u003eSessions\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"INSERT INTO sessions (id,location_id, watts, vin) VALUES (2, 2, 393, '1GMYA52286BA04055') RETURNING *\"\u003c/span\u003e\n)\n    .\u003cspan class=\"hljs-title function_\"\u003efetch_one\u003c/span\u003e(\u0026#x26;pool)\n    .\u003cspan class=\"hljs-property\"\u003eawait\u003c/span\u003e;\n\n    match insert_result {\n        \u003cspan class=\"hljs-title class_\"\u003eOk\u003c/span\u003e(session) =\u003e {\n            info!(\u003cspan class=\"hljs-string\"\u003e\"âœ“Inserted: {:?}\"\u003c/span\u003e, session);\n        }\n        \u003cspan class=\"hljs-title class_\"\u003eErr\u003c/span\u003e(e) =\u003e {\n            error!(\u003cspan class=\"hljs-string\"\u003e\"Error Insert: {}\"\u003c/span\u003e, e.\u003cspan class=\"hljs-title function_\"\u003eto_string\u003c/span\u003e())\n        }\n    }\n\n    tx.\u003cspan class=\"hljs-title function_\"\u003ecommit\u003c/span\u003e().\u003cspan class=\"hljs-property\"\u003eawait\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Unable to commit the transaction\"\u003c/span\u003e);\n}\n\n\u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e fn \u003cspan class=\"hljs-title function_\"\u003eupdate_sessions\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003epool: Pool\u0026#x3C;Postgres\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e tx = pool.\u003cspan class=\"hljs-title function_\"\u003ebegin\u003c/span\u003e().\u003cspan class=\"hljs-property\"\u003eawait\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Unable to begin transaction\"\u003c/span\u003e);\n\n    \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e update_result = \u003cspan class=\"hljs-attr\"\u003esqlx\u003c/span\u003e::query_as!(\n        \u003cspan class=\"hljs-title class_\"\u003eSessions\u003c/span\u003e,\n        \u003cspan class=\"hljs-string\"\u003e\"UPDATE sessions SET watts = 415 WHERE id = $1 RETURNING *\"\u003c/span\u003e,\n        1i64,\n    )\n    .\u003cspan class=\"hljs-title function_\"\u003efetch_one\u003c/span\u003e(\u0026#x26;pool)\n    .\u003cspan class=\"hljs-property\"\u003eawait\u003c/span\u003e;\n\n    match update_result {\n        \u003cspan class=\"hljs-title class_\"\u003eOk\u003c/span\u003e(session) =\u003e {\n            info!(\u003cspan class=\"hljs-string\"\u003e\"âœ“Update: {:?}\"\u003c/span\u003e, session);\n        }\n        \u003cspan class=\"hljs-title class_\"\u003eErr\u003c/span\u003e(e) =\u003e {\n            error!(\u003cspan class=\"hljs-string\"\u003e\"Error Update: {}\"\u003c/span\u003e, e.\u003cspan class=\"hljs-title function_\"\u003eto_string\u003c/span\u003e())\n        }\n    }\n\n    tx.\u003cspan class=\"hljs-title function_\"\u003ecommit\u003c/span\u003e().\u003cspan class=\"hljs-property\"\u003eawait\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Unable to commit the transaction\"\u003c/span\u003e);\n}\n\n\u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e fn \u003cspan class=\"hljs-title function_\"\u003eclean_db\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003epool: Pool\u0026#x3C;Postgres\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e rows_deleted = \u003cspan class=\"hljs-attr\"\u003esqlx\u003c/span\u003e::query!(\u003cspan class=\"hljs-string\"\u003e\"DELETE from sessions\"\u003c/span\u003e)\n        .\u003cspan class=\"hljs-title function_\"\u003eexecute\u003c/span\u003e(\u0026#x26;pool)\n        .\u003cspan class=\"hljs-property\"\u003eawait\u003c/span\u003e\n        .\u003cspan class=\"hljs-title function_\"\u003eunwrap\u003c/span\u003e()\n        .\u003cspan class=\"hljs-title function_\"\u003erows_affected\u003c/span\u003e();\n\n    info!(\u003cspan class=\"hljs-string\"\u003e\"âœ•Deleted {} rows from sessions table\"\u003c/span\u003e, rows_deleted);\n\n    \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e rows_deleted = \u003cspan class=\"hljs-attr\"\u003esqlx\u003c/span\u003e::query!(\u003cspan class=\"hljs-string\"\u003e\"DELETE from locations\"\u003c/span\u003e)\n        .\u003cspan class=\"hljs-title function_\"\u003eexecute\u003c/span\u003e(\u0026#x26;pool)\n        .\u003cspan class=\"hljs-property\"\u003eawait\u003c/span\u003e\n        .\u003cspan class=\"hljs-title function_\"\u003eunwrap\u003c/span\u003e()\n        .\u003cspan class=\"hljs-title function_\"\u003erows_affected\u003c/span\u003e();\n    info!(\u003cspan class=\"hljs-string\"\u003e\"âœ•Deleted {} rows from locations table\"\u003c/span\u003e, rows_deleted);\n}\n\n\u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e fn \u003cspan class=\"hljs-title function_\"\u003equery_locations\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003epool: Pool\u0026#x3C;Postgres\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e query_result = \u003cspan class=\"hljs-attr\"\u003esqlx\u003c/span\u003e::query_as!(\u003cspan class=\"hljs-title class_\"\u003eLocations\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"SELECT * FROM Locations\"\u003c/span\u003e)\n        .\u003cspan class=\"hljs-title function_\"\u003efetch_all\u003c/span\u003e(\u0026#x26;pool)\n        .\u003cspan class=\"hljs-property\"\u003eawait\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e query_result.\u003cspan class=\"hljs-title function_\"\u003eis_err\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n        \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e message = \u003cspan class=\"hljs-string\"\u003e\"Something bad happened while fetching all locations\"\u003c/span\u003e;\n        error!(\u003cspan class=\"hljs-string\"\u003e\"{}\"\u003c/span\u003e, message);\n    } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n        info!(\u003cspan class=\"hljs-string\"\u003e\"ğŸ˜Query Result For Locations {:?}\"\u003c/span\u003e, query_result);\n    }\n}\n\n\u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e fn \u003cspan class=\"hljs-title function_\"\u003equery_sessions\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003epool: Pool\u0026#x3C;Postgres\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e query_result = \u003cspan class=\"hljs-attr\"\u003esqlx\u003c/span\u003e::query_as!(\u003cspan class=\"hljs-title class_\"\u003eSessions\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"SELECT * FROM Sessions\"\u003c/span\u003e)\n        .\u003cspan class=\"hljs-title function_\"\u003efetch_all\u003c/span\u003e(\u0026#x26;pool)\n        .\u003cspan class=\"hljs-property\"\u003eawait\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e query_result.\u003cspan class=\"hljs-title function_\"\u003eis_err\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n        \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e message = \u003cspan class=\"hljs-string\"\u003e\"Something bad happened while fetching all sessions\"\u003c/span\u003e;\n        error!(\u003cspan class=\"hljs-string\"\u003e\"{}\"\u003c/span\u003e, message);\n    } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n        info!(\u003cspan class=\"hljs-string\"\u003e\"ğŸ˜Query Result for Sessions {:?}\"\u003c/span\u003e, query_result);\n    }\n}\n\n#[\u003cspan class=\"hljs-attr\"\u003etokio\u003c/span\u003e::main]\n\u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e fn \u003cspan class=\"hljs-title function_\"\u003emain\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003estd\u003c/span\u003e::\u003cspan class=\"hljs-attr\"\u003eenv\u003c/span\u003e::\u003cspan class=\"hljs-title function_\"\u003evar_os\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"RUST_LOG\"\u003c/span\u003e).\u003cspan class=\"hljs-title function_\"\u003eis_none\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n        \u003cspan class=\"hljs-attr\"\u003estd\u003c/span\u003e::\u003cspan class=\"hljs-attr\"\u003eenv\u003c/span\u003e::\u003cspan class=\"hljs-title function_\"\u003eset_var\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"RUST_LOG\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"info\"\u003c/span\u003e);\n    }\n    \u003cspan class=\"hljs-title function_\"\u003edotenv\u003c/span\u003e().\u003cspan class=\"hljs-title function_\"\u003eok\u003c/span\u003e();\n    \u003cspan class=\"hljs-attr\"\u003eenv_logger\u003c/span\u003e::\u003cspan class=\"hljs-title function_\"\u003einit\u003c/span\u003e();\n\n    \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e database_url = \u003cspan class=\"hljs-attr\"\u003estd\u003c/span\u003e::\u003cspan class=\"hljs-attr\"\u003eenv\u003c/span\u003e::\u003cspan class=\"hljs-title function_\"\u003evar\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"DATABASE_URL\"\u003c/span\u003e).\u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"DATABASE_URL must be set\"\u003c/span\u003e);\n    \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e pool = match \u003cspan class=\"hljs-title class_\"\u003ePgPoolOptions\u003c/span\u003e::\u003cspan class=\"hljs-title function_\"\u003enew\u003c/span\u003e()\n        .\u003cspan class=\"hljs-title function_\"\u003emax_connections\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e)\n        .\u003cspan class=\"hljs-title function_\"\u003econnect\u003c/span\u003e(\u0026#x26;database_url)\n        .\u003cspan class=\"hljs-property\"\u003eawait\u003c/span\u003e\n    {\n        \u003cspan class=\"hljs-title class_\"\u003eOk\u003c/span\u003e(pool) =\u003e {\n            info!(\u003cspan class=\"hljs-string\"\u003e\"âœ…Connection to the database is successful!\"\u003c/span\u003e);\n            pool\n        }\n        \u003cspan class=\"hljs-title class_\"\u003eErr\u003c/span\u003e(err) =\u003e {\n            error!(\u003cspan class=\"hljs-string\"\u003e\"ğŸ”¥ Failed to connect to the database: {:?}\"\u003c/span\u003e, err);\n            \u003cspan class=\"hljs-attr\"\u003estd\u003c/span\u003e::\u003cspan class=\"hljs-attr\"\u003eprocess\u003c/span\u003e::\u003cspan class=\"hljs-title function_\"\u003eexit\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e);\n        }\n    };\n    \u003cspan class=\"hljs-title function_\"\u003eclean_db\u003c/span\u003e(pool.\u003cspan class=\"hljs-title function_\"\u003eclone\u003c/span\u003e()).\u003cspan class=\"hljs-property\"\u003eawait\u003c/span\u003e;\n\n    \u003cspan class=\"hljs-title function_\"\u003einsert_into_locations\u003c/span\u003e(pool.\u003cspan class=\"hljs-title function_\"\u003eclone\u003c/span\u003e()).\u003cspan class=\"hljs-property\"\u003eawait\u003c/span\u003e;\n    \u003cspan class=\"hljs-title function_\"\u003equery_locations\u003c/span\u003e(pool.\u003cspan class=\"hljs-title function_\"\u003eclone\u003c/span\u003e()).\u003cspan class=\"hljs-property\"\u003eawait\u003c/span\u003e;\n\n    \u003cspan class=\"hljs-title function_\"\u003einsert_into_sessions\u003c/span\u003e(pool.\u003cspan class=\"hljs-title function_\"\u003eclone\u003c/span\u003e()).\u003cspan class=\"hljs-property\"\u003eawait\u003c/span\u003e;\n    \u003cspan class=\"hljs-title function_\"\u003equery_sessions\u003c/span\u003e(pool.\u003cspan class=\"hljs-title function_\"\u003eclone\u003c/span\u003e()).\u003cspan class=\"hljs-property\"\u003eawait\u003c/span\u003e;\n\n    \u003cspan class=\"hljs-title function_\"\u003eupdate_sessions\u003c/span\u003e(pool.\u003cspan class=\"hljs-title function_\"\u003eclone\u003c/span\u003e()).\u003cspan class=\"hljs-property\"\u003eawait\u003c/span\u003e;\n    \u003cspan class=\"hljs-title function_\"\u003equery_sessions\u003c/span\u003e(pool.\u003cspan class=\"hljs-title function_\"\u003eclone\u003c/span\u003e()).\u003cspan class=\"hljs-property\"\u003eawait\u003c/span\u003e;\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eìœ„ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•œ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cimg src=\"/assets/img/2024-05-23-LearningRustPart11BuildersandDatabaseInteraction_5.png\"\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eìœ„ì™€ ê°™ì´ ë°ì´í„°ë² ì´ìŠ¤ ìƒí˜¸ì‘ìš© í† ë¡ ì„ ë§ˆì³¤ìŠµë‹ˆë‹¤. sqlxë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì¢‹ì€ ê°œìš”ë¥¼ ì œê³µí–ˆì„ ê²ë‹ˆë‹¤.\u003c/p\u003e\n\u003ch1\u003eìš”ì•½\u003c/h1\u003e\n\u003cp\u003eì €í¬ ëŸ¬ìŠ¤íŠ¸ í•™ìŠµ ì‹œë¦¬ì¦ˆì˜ ì´ ë¶€ë¶„ì„ ì¦ê¸°ì…¨ê¸°ë¥¼ ë°”ëë‹ˆë‹¤. ì‹œë¦¬ì¦ˆ ì´ë²ˆ ì„¹ì…˜ì—ì„œëŠ” ë¨¼ì € ëŸ¬ìŠ¤íŠ¸ì—ì„œ ê°ì²´ ìƒì„±ì— ëŒ€í•œ ë§¤ìš° ìœ ìš©í•œ íŒ¨í„´ì¸ ë¹Œë” íŒ¨í„´ì„ ì‚´í´ë³´ì•˜ìŠµë‹ˆë‹¤. ì´ëŠ” ë‹¤ë¥¸ ì–¸ì–´ì—ì„œ ìµìˆ™í•  ìˆ˜ ìˆì§€ë§Œ, ëŸ¬ìŠ¤íŠ¸ì—ì„œ ì–´ë–»ê²Œ êµ¬í˜„í•˜ëŠ”ì§€ ì‚´í´ë³´ì•˜ìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eë‹¤ìŒìœ¼ë¡œ, ìš°ë¦¬ëŠ” Rustë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ì¸ íŠ¹íˆ Postgresì™€ ìƒí˜¸ì‘ìš©í•˜ëŠ” ë°©ë²•ì„ ê²€í† í–ˆìŠµë‹ˆë‹¤. ìš°ë¦¬ëŠ” ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ì‹¤í–‰í•˜ê³  ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°í•˜ëŠ” ë°©ë²•ì„ ë³´ì•˜ìœ¼ë©°, ê·¸ í›„ DBì— ëŒ€í•´ ì—¬ëŸ¬ ê°€ì§€ CRUD ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë°©ë²•ì„ ì‚´í´ë³´ì•˜ìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eëŸ¬ìŠ¤íŠ¸ í•™ìŠµ ì—¬ì •ì— í•¨ê»˜í•´ì¤˜ì„œ ê³ ë§ˆì›Œìš”.\u003c/p\u003e\n\u003cp\u003eì¢‹ì€ ì—¬í–‰ ë˜ì„¸ìš”!\u003c/p\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-05-23-LearningRustPart11BuildersandDatabaseInteraction"},"buildId":"wfHLuDA3kTGBYfaM5IGXk","isFallback":false,"gsp":true,"scriptLoader":[{"async":true,"src":"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4877378276818686","strategy":"lazyOnload","crossOrigin":"anonymous"}]}</script></body></html>