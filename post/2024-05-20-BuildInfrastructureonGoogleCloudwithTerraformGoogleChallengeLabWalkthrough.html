<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>Google Cloud에서 Terraform을 사용하여 인프라 구축하기 - Google Challenge Lab 안내 | ui-station</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://ui-station.github.io///post/2024-05-20-BuildInfrastructureonGoogleCloudwithTerraformGoogleChallengeLabWalkthrough" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="Google Cloud에서 Terraform을 사용하여 인프라 구축하기 - Google Challenge Lab 안내 | ui-station" data-gatsby-head="true"/><meta property="og:title" content="Google Cloud에서 Terraform을 사용하여 인프라 구축하기 - Google Challenge Lab 안내 | ui-station" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-05-20-BuildInfrastructureonGoogleCloudwithTerraformGoogleChallengeLabWalkthrough_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://ui-station.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://ui-station.github.io///post/2024-05-20-BuildInfrastructureonGoogleCloudwithTerraformGoogleChallengeLabWalkthrough" data-gatsby-head="true"/><meta name="twitter:title" content="Google Cloud에서 Terraform을 사용하여 인프라 구축하기 - Google Challenge Lab 안내 | ui-station" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-05-20-BuildInfrastructureonGoogleCloudwithTerraformGoogleChallengeLabWalkthrough_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | ui-station" data-gatsby-head="true"/><meta name="article:published_time" content="2024-05-20 17:28" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-BHFR6GTH9P"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
          
            gtag('config', 'G-BHFR6GTH9P');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b8ef307c9aee1e34.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b8ef307c9aee1e34.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-4a646156c659a948.js" defer=""></script><script src="/_next/static/chunks/348-d11c34b645b13f5b.js" defer=""></script><script src="/_next/static/chunks/162-4172e84c8e2aa747.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-4f7b40c1114f0d09.js" defer=""></script><script src="/_next/static/YUMR4jSyk_WlOHHc7UfOk/_buildManifest.js" defer=""></script><script src="/_next/static/YUMR4jSyk_WlOHHc7UfOk/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">UI STATION</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">Google Cloud에서 Terraform을 사용하여 인프라 구축하기 - Google Challenge Lab 안내</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="Google Cloud에서 Terraform을 사용하여 인프라 구축하기 - Google Challenge Lab 안내" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">UI STATION</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On May 20, 2024</span><span class="posts_reading_time__f7YPP">16<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-05-20-BuildInfrastructureonGoogleCloudwithTerraformGoogleChallengeLabWalkthrough&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<p>구글 클라우드에서 Terraform으로 인프라를 구축하는 코스의 챌린지 랩 워크스루입니다.</p>
<p>이 랩은 다음을 테스트합니다:</p>
<ul>
<li>기존 인프라를 Terraform 구성으로 가져오는 능력.</li>
<li>직접 Terraform 모듈을 빌드하고 참조하는 것.</li>
<li>원격 백엔드를 구성에 추가하는 것.</li>
<li>Terraform 레지스트리에서 모듈을 사용하고 구현하는 것.</li>
<li>인프라를 다시 프로비저닝하고 파괴하고 업데이트하는 것.</li>
<li>생성한 리소스 간의 연결성을 테스트하는 것.</li>
</ul>
<h1>챌린지 랩 소개</h1>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>Google은 구글 클라우드 스킬즈 부스트(이전 명칭: QwikLabs)라는 온라인 학습 플랫폼을 제공합니다. 이 플랫폼에서는 학습 경로에 맞는 교육 과정을 따르거나 특정 제품 또는 솔루션에 대한 교육 과정을 진행할 수 있습니다.</p>
<p>이 플랫폼에서의 학습 경험 중 하나는 퀘스트입니다. 퀘스트에 참여하면 안내형 실습 랩을 수행한 후 도전 랩을 완료합니다. 도전 랩은 목표가 명시되지만 목표를 달성하는 방법에 대한 안내가 거의 없는 다른 랩과는 다릅니다.</p>
<p>제가 가끔 이 도전 랩에 대한 해결 방법을 제공합니다. 목표는 도전 랩을 도와주어서 쉽게 풀어내는 데 도움을 주는 것이 아닙니다! 대신에:</p>
<ul>
<li>랩을 완료하는 데 가장 이상적인 경로로 이끄는 것을 보여드립니다.</li>
<li>랩을 스스로 완료할 수 없는 특정 문제나 장애물을 해결하는 데 도움을 줍니다.</li>
</ul>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>도움이 필요한 경우, 도전 과제에 대한 도움을 얻으려면 올바른 곳에 오신 것을 환영합니다. 그러나 먼저 퀘스트를 진행하고 직접 랩을 시도한 후에 계속 읽기를 강력히 권장합니다!</p>
<p>이러한 랩들은 문제 해결에 대해 다양한 방법이 항상 있습니다. 일반적으로 저는 더 반복 가능하고 프로그래밸하게 문제를 해결할 수 있도록 문제를 해결하는 것이 좋습니다. 그러나 물론 클라우드 콘솔도 사용할 수 있습니다.</p>
<h1>이 랩 개요</h1>
<p>이 랩에서는 Terraform을 사용하여 Google Cloud에서 인프라를 생성, 배포 및 관리해야 합니다. 또한 일부 관리되지 않은 인스턴스를 구성에 가져와 수정해야 합니다.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h1>나의 해결책</h1>
<p>우리가 이 도전 과제 동안 사용할 몇 가지 변수를 정의하는 것부터 시작해봅시다. 실제 변수는 랩을 시작할 때 제공될 것입니다.</p>
<pre><code class="hljs language-js">gcloud auth list

region=&#x3C;지역 입력>
zone=&#x3C;존 입력>
prj=&#x3C;프로젝트 <span class="hljs-variable constant_">ID</span> 입력>
</code></pre>
<h2>작업 1 — 구성 파일 생성</h2>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>이 폴더 구조를 만들라고 지시받았어요:</p>
<pre><code class="hljs language-js">main.<span class="hljs-property">tf</span>
variables.<span class="hljs-property">tf</span>
modules/
└── instances
|   ├── instances.<span class="hljs-property">tf</span>
|   ├── outputs.<span class="hljs-property">tf</span>
|   └── variables.<span class="hljs-property">tf</span>
└── storage
    ├── storage.<span class="hljs-property">tf</span>
    ├── outputs.<span class="hljs-property">tf</span>
    └── variables.<span class="hljs-property">tf</span>
</code></pre>
<p>이렇게 만들어볼까요:</p>
<pre><code class="hljs language-js"># 루트 디렉토리에 main.<span class="hljs-property">tf</span>와 variables.<span class="hljs-property">tf</span> 파일 생성
touch main.<span class="hljs-property">tf</span> variables.<span class="hljs-property">tf</span>

# main 디렉토리 및 파일 생성
mkdir -p modules/instances
mkdir modules/storage

# <span class="hljs-string">'instances'</span> 모듈 디렉토리에 필요한 파일 생성
touch modules/instances/instances.<span class="hljs-property">tf</span>
touch modules/instances/outputs.<span class="hljs-property">tf</span>
touch modules/instances/variables.<span class="hljs-property">tf</span>

# <span class="hljs-string">'storage'</span> 모듈 디렉토리에 필요한 파일 생성
touch modules/storage/storage.<span class="hljs-property">tf</span>
touch modules/storage/outputs.<span class="hljs-property">tf</span>
touch modules/storage/variables.<span class="hljs-property">tf</span>
</code></pre>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>이제 변수.tf 파일을 업데이트하여 다음 변수들을 포함하도록 합니다:</p>
<pre><code class="hljs language-js">variable <span class="hljs-string">"region"</span> {
  description = <span class="hljs-string">"Google Cloud 지역"</span>
  type        = string
  <span class="hljs-keyword">default</span>     = <span class="hljs-string">"실습에서 제공하는 지역"</span>
}

variable <span class="hljs-string">"zone"</span> {
  description = <span class="hljs-string">"Google Cloud 존"</span>
  type        = string
  <span class="hljs-keyword">default</span>     = <span class="hljs-string">"실습에서 제공하는 존"</span>
}

variable <span class="hljs-string">"project_id"</span> {
  description = <span class="hljs-string">"리소스를 프로비저닝할 프로젝트의 ID"</span>
  type        = string
  <span class="hljs-keyword">default</span>     = <span class="hljs-string">"귀하의 프로젝트 ID"</span>
}
</code></pre>
<p>루트 모듈 main.tf를 업데이트하여 Google Cloud Provider를 포함하도록 합니다. Terraform Registry에서 항상 확인할 수 있습니다. 제공자 블록에 세 가지 변수를 모두 포함하도록 요청되었습니다.</p>
<pre><code class="hljs language-js">terraform {
  required_providers {
    google = {
      version = <span class="hljs-string">"~> 4.0"</span>
    }
  }
}

provider <span class="hljs-string">"google"</span> {
  project     = <span class="hljs-keyword">var</span>.<span class="hljs-property">project_id</span>
  region      = <span class="hljs-keyword">var</span>.<span class="hljs-property">region</span>
  zone        = <span class="hljs-keyword">var</span>.<span class="hljs-property">zone</span>
}
</code></pre>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>이제 테라폼을 초기화해야 합니다. 따라서 다음 명령을 실행하세요:</p>
<pre><code class="hljs language-js">terraform init
</code></pre>
<h2>작업 2 — 인프라 가져오기</h2>
<p>여기서의 목표는 지금까지 테라폼 외부에서 프로비저닝된 인프라를 테라폼 제어 아래로 가져오는 것입니다.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>테라폼 가져오기 워크플로우를 사용할 거에요:</p>
<p><img src="/assets/img/2024-05-20-BuildInfrastructureonGoogleCloudwithTerraformGoogleChallengeLabWalkthrough_0.png" alt="이미지"></p>
<p>이것들은 가져오기 단계들이에요:</p>
<ul>
<li>가져올 기존 인프라를 식별하세요.</li>
<li>인프라를 테라폼 상태에 가져오세요.</li>
<li>해당 인프라와 일치하는 테라폼 구성을 작성하세요.</li>
<li>구성이 예상 상태와 인프라와 일치하는지 확인하기 위해 테라폼 계획을 검토하세요.</li>
<li>구성을 적용하여 테라폼 상태를 업데이트하세요.</li>
</ul>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2>가져와야 할 기존 인프라 확인</h2>
<p>이미 두 개의 GCE 인스턴스가 생성되었습니다. Cloud 콘솔에서 기존 인스턴스 중 하나인 tf-instance-1을 확인하세요. 우리는 다음을 검색하려고 합니다:</p>
<ul>
<li>네트워크</li>
<li>머신 유형</li>
<li>디스크</li>
</ul>
<p>다음으로, 우리는 main.tf에 우리의 인스턴스 모듈을 두 번 호출해야 합니다. 이 두 호출은 빈 정의를 포함할 것이므로 가져올 수 있습니다.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>module "tf_instance_1" {
source = "./modules/instances"
instance_name = "tf-instance-1"
zone = var.zone
region = var.region
}</p>
<p>module "tf_instance_2" {
source = "./modules/instances"
instance_name = "tf-instance-2"
zone = var.zone
region = var.region
}</p>
<p>각 모듈 정의에는 고유한 레이블이 있어야 합니다.</p>
<p>이제 초기화해보세요:</p>
<pre><code class="hljs language-bash">terraform init
</code></pre>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>이제 instances.tf에 모듈 구성을 작성합니다. 우리는 포함해야 할 최소한의 구성 요소를 알려받았습니다:</p>
<pre><code class="hljs language-js">resource <span class="hljs-string">"google_compute_instance"</span> <span class="hljs-string">"instance"</span> {
  name         = <span class="hljs-keyword">var</span>.<span class="hljs-property">instance_name</span>
  machine_type = <span class="hljs-string">"기존 인스턴스에서 하드 코딩"</span>
  zone         = <span class="hljs-keyword">var</span>.<span class="hljs-property">zone</span>

  boot_disk {
    initialize_params {
      # image = <span class="hljs-string">"debian-cloud/debian-11"</span>
      image = <span class="hljs-string">"기존 인스턴스에서 하드 코딩"</span>
    }
  }

  network_interface {
    # network = <span class="hljs-string">"default"</span>
    network = <span class="hljs-string">"기존 인스턴스에서 하드 코딩"</span>
    access_config {
      <span class="hljs-comment">// 일시적 공용 IP</span>
    }
  }

  metadata_startup_script = &#x3C;&#x3C;-<span class="hljs-variable constant_">EOT</span>
          #!<span class="hljs-regexp">/bin/</span>bash
      <span class="hljs-variable constant_">EOT</span>
  allow_stopping_for_update = <span class="hljs-literal">true</span>
}
</code></pre>
<p>인스턴스 모듈의 변수를 전달할 수 있도록 variables.tf를 업데이트하십시오. instance_name을 전달할 수 있도록 합니다:</p>
<pre><code class="hljs language-js">variable <span class="hljs-string">"instance_name"</span> {
  description = <span class="hljs-string">"인스턴스의 이름."</span>
  type        = string
}
</code></pre>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2>Terraform State로 기존 인프라 가져오기</h2>
<pre><code class="hljs language-js">terraform <span class="hljs-keyword">import</span> <span class="hljs-variable language_">module</span>.<span class="hljs-property">tf_instance_1</span>.<span class="hljs-property">google_compute_instance</span>.<span class="hljs-property">instance</span> \
  projects/$prj/zones/$zone/instances/tf-instance-<span class="hljs-number">1</span>

terraform <span class="hljs-keyword">import</span> <span class="hljs-variable language_">module</span>.<span class="hljs-property">tf_instance_2</span>.<span class="hljs-property">google_compute_instance</span>.<span class="hljs-property">instance</span> \
  projects/$prj/zones/$zone/instances/tf-instance-<span class="hljs-number">2</span>

# 가져오기 확인
terraform show
</code></pre>
<p>다음과 같이 가져와야 합니다:</p>
<img src="/assets/img/2024-05-20-BuildInfrastructureonGoogleCloudwithTerraformGoogleChallengeLabWalkthrough_1.png">
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2>계획 및 적용</h2>
<p>이제 우리는 apply를 실행하여 인스턴스를 그 자리에서 업데이트합니다:</p>
<pre><code class="hljs language-js">terraform plan
terraform apply
</code></pre>
<h2>작업 3 — 원격 백엔드 구성</h2>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>이건 꽤 쉬워요. 원격 GCS 백엔드에 Terraform 상태를 저장하려고 할 때 실행해야 하는 표준 단계들이에요:</p>
<ul>
<li>Terraform을 사용하여 GCS 버킷을 프로비저닝합니다.</li>
<li>새로운 GCS 버킷을 가리키는 백엔드 블록을 추가합니다.</li>
<li>Terraform을 다시 초기화하고 로컬 상태 파일에서 원격 백엔드로 상태를 이관합니다.</li>
</ul>
<h2>GCS Bucket 프로비저닝하기</h2>
<p>다음 리소스 정의를 main.tf에 추가하세요:</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>위의 코드를 아래와 같이 번역해 드립니다.</p>
<pre><code class="hljs language-js">리소스 <span class="hljs-string">"google_storage_bucket"</span> <span class="hljs-string">"test-bucket-for-state"</span> {
  이름        = <span class="hljs-string">"할당 받은 버킷 이름"</span>
  위치    = <span class="hljs-string">"US"</span>
  uniform_bucket_level_access = <span class="hljs-literal">true</span>

  force_destroy = <span class="hljs-literal">true</span>
}
</code></pre>
<p>그리고 다음을 적용하세요:</p>
<pre><code class="hljs language-js">terraform apply
</code></pre>
<h2>GCS 백엔드 추가하기</h2>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>main.tf 파일을 수정하여 백엔드를 terraform 블록에 포함시키세요:</p>
<pre><code class="hljs language-js">terraform {
  backend <span class="hljs-string">"gcs"</span> {
    bucket  = <span class="hljs-string">"제공받은 버킷 이름"</span>
    prefix  = <span class="hljs-string">"terraform/state"</span>
  }
}
</code></pre>
<h2>상태 이전</h2>
<p>로컬 상태 파일에서 GCS 백엔드로 Terraform 상태를 이전하는 부분입니다.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-js">terraform init -migrate-state
</code></pre>
<p>상태를 이전하려는 것을 확인하라는 메시지가 표시됩니다:</p>
<img src="/assets/img/2024-05-20-BuildInfrastructureonGoogleCloudwithTerraformGoogleChallengeLabWalkthrough_2.png">
<h2>작업 4 — 인프라 수정 및 업데이트</h2>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>우리는 machine_type을 포함하는 variables.tf를 업데이트해야합니다:</p>
<pre><code class="hljs language-js">variable <span class="hljs-string">"machine_type"</span> {
  description = <span class="hljs-string">"인스턴스의 머신 유형"</span>
  type        = string
  <span class="hljs-keyword">default</span>     = <span class="hljs-string">"e2-standard-2"</span>
}
</code></pre>
<p>그런 다음, instance.tf를 수정하여 machine_type 매개변수를 허용할 수 있도록 설정해야합니다:</p>
<pre><code class="hljs language-js">resource <span class="hljs-string">"google_compute_instance"</span> <span class="hljs-string">"instance"</span> {
  name         = <span class="hljs-keyword">var</span>.<span class="hljs-property">instance_name</span>
  machine_type = <span class="hljs-keyword">var</span>.<span class="hljs-property">machine_type</span>
  zone         = <span class="hljs-keyword">var</span>.<span class="hljs-property">zone</span>

  ...
</code></pre>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>마지막으로, main.tf를 수정해서 세 번째 인스턴스를 추가해야 합니다. 세 번째 모듈을 호출하여 main.tf에 추가합니다. 이미 기본값을 설정했으므로 machine_type을 전달할 필요가 없습니다.</p>
<p>이제 초기화하고(모듈 인스턴스를 추가했으므로) 적용하세요.</p>
<pre><code class="hljs language-js">terraform init
terraform apply
</code></pre>
<h2>작업 5 — 리소스 파기</h2>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>이전에 추가했던 인스턴스를 제거해 보겠습니다. main.tf에서 이 모듈 호출을 제거한 다음 다시 적용하십시오:</p>
<pre><code class="hljs language-js">terraform init
terraform apply
</code></pre>
<h2>작업 6 — 레지스트리에서 모듈 사용하기</h2>
<p>Google Network Module를 사용하려고 합니다.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-bash">module <span class="hljs-string">"network"</span> {
  <span class="hljs-built_in">source</span>  = <span class="hljs-string">"terraform-google-modules/network/google"</span>
  version = <span class="hljs-string">"6.0.0"</span>

  project_id   = var.project_id
  network_name = <span class="hljs-string">"Use Supplied VPC Name"</span>
  routing_mode = <span class="hljs-string">"GLOBAL"</span>

  subnets = [
    {
      subnet_name           = <span class="hljs-string">"subnet-01"</span>
      subnet_ip             = <span class="hljs-string">"10.10.10.0/24"</span>
      subnet_region         = var.region
    },
    {
      subnet_name           = <span class="hljs-string">"subnet-02"</span>
      subnet_ip             = <span class="hljs-string">"10.10.20.0/24"</span>
      subnet_region         = var.region
    }
  ]
}
</code></pre>
<p>초기화하고 적용하세요:</p>
<pre><code class="hljs language-bash">terraform init
terraform apply
</code></pre>
<p>인스턴스 모듈을 업데이트하여 네트워크 매개변수와 서브넷 매개변수를 사용하도록 하십시오.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>variables.tf:</p>
<pre><code class="hljs language-js">variable <span class="hljs-string">"network"</span> {
  description = <span class="hljs-string">"네트워크"</span>
  type        = string
}

variable <span class="hljs-string">"subnet"</span> {
  description = <span class="hljs-string">"서브넷"</span>
  type        = string
}
</code></pre>
<p>instance.tf:</p>
<pre><code class="hljs language-js">network_interface {
  network = <span class="hljs-keyword">var</span>.<span class="hljs-property">network</span>
  subnetwork = <span class="hljs-keyword">var</span>.<span class="hljs-property">subnet</span>

  access_config {
    <span class="hljs-comment">// 일시적인 공용 IP</span>
  }
}
</code></pre>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>그럼 이렇게 인스턴스를 생성하도록 main.tf를 업데이트하세요:</p>
<pre><code class="hljs language-js"><span class="hljs-variable language_">module</span> <span class="hljs-string">"tf_instance_1"</span> {
  source        = <span class="hljs-string">"./modules/instances"</span>
  instance_name = <span class="hljs-string">"tf-instance-1"</span>
  zone          = <span class="hljs-keyword">var</span>.<span class="hljs-property">zone</span>
  region        = <span class="hljs-keyword">var</span>.<span class="hljs-property">region</span>

  network       = <span class="hljs-variable language_">module</span>.<span class="hljs-property">network</span>.<span class="hljs-property">network_name</span>
  subnet        = <span class="hljs-string">"subnet-01"</span>
}

<span class="hljs-variable language_">module</span> <span class="hljs-string">"tf_instance_2"</span> {
  source        = <span class="hljs-string">"./modules/instances"</span>
  instance_name = <span class="hljs-string">"tf-instance-2"</span>
  zone          = <span class="hljs-keyword">var</span>.<span class="hljs-property">zone</span>
  region        = <span class="hljs-keyword">var</span>.<span class="hljs-property">region</span>
  network       = <span class="hljs-variable language_">module</span>.<span class="hljs-property">network</span>.<span class="hljs-property">network_name</span>
  subnet        = <span class="hljs-string">"subnet-02"</span>
}
</code></pre>
<pre><code class="hljs language-js">terraform init
terraform apply
</code></pre>
<h2>작업 7 — 방화벽 추가</h2>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>위의 코드를 Korean으로 번역하였습니다:</p>
<p>md
main.tf을 업데이트 해주세요:</p>
<pre><code class="hljs language-js">resource <span class="hljs-string">"google_compute_firewall"</span> <span class="hljs-string">"default"</span> {
  name          = <span class="hljs-string">"tf-firewall"</span>
  network       = <span class="hljs-variable language_">module</span>.<span class="hljs-property">network</span>.<span class="hljs-property">network_name</span>
  direction     = <span class="hljs-string">"INGRESS"</span>
  source_ranges = [<span class="hljs-string">"0.0.0.0/0"</span>]

  allow {
    protocol = <span class="hljs-string">"tcp"</span>
    ports    = [<span class="hljs-string">"80"</span>]
  }
}
</code></pre>
<p>그리고 마지막으로 한 번 더 실행해주세요...</p>
<pre><code class="hljs language-js">terraform apply
</code></pre>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>그럼 끝났어요!</p>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Google Cloud에서 Terraform을 사용하여 인프라 구축하기 - Google Challenge Lab 안내","description":"","date":"2024-05-20 17:28","slug":"2024-05-20-BuildInfrastructureonGoogleCloudwithTerraformGoogleChallengeLabWalkthrough","content":"\n구글 클라우드에서 Terraform으로 인프라를 구축하는 코스의 챌린지 랩 워크스루입니다.\n\n이 랩은 다음을 테스트합니다:\n\n- 기존 인프라를 Terraform 구성으로 가져오는 능력.\n- 직접 Terraform 모듈을 빌드하고 참조하는 것.\n- 원격 백엔드를 구성에 추가하는 것.\n- Terraform 레지스트리에서 모듈을 사용하고 구현하는 것.\n- 인프라를 다시 프로비저닝하고 파괴하고 업데이트하는 것.\n- 생성한 리소스 간의 연결성을 테스트하는 것.\n\n# 챌린지 랩 소개\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nGoogle은 구글 클라우드 스킬즈 부스트(이전 명칭: QwikLabs)라는 온라인 학습 플랫폼을 제공합니다. 이 플랫폼에서는 학습 경로에 맞는 교육 과정을 따르거나 특정 제품 또는 솔루션에 대한 교육 과정을 진행할 수 있습니다.\n\n이 플랫폼에서의 학습 경험 중 하나는 퀘스트입니다. 퀘스트에 참여하면 안내형 실습 랩을 수행한 후 도전 랩을 완료합니다. 도전 랩은 목표가 명시되지만 목표를 달성하는 방법에 대한 안내가 거의 없는 다른 랩과는 다릅니다.\n\n제가 가끔 이 도전 랩에 대한 해결 방법을 제공합니다. 목표는 도전 랩을 도와주어서 쉽게 풀어내는 데 도움을 주는 것이 아닙니다! 대신에:\n\n- 랩을 완료하는 데 가장 이상적인 경로로 이끄는 것을 보여드립니다.\n- 랩을 스스로 완료할 수 없는 특정 문제나 장애물을 해결하는 데 도움을 줍니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n도움이 필요한 경우, 도전 과제에 대한 도움을 얻으려면 올바른 곳에 오신 것을 환영합니다. 그러나 먼저 퀘스트를 진행하고 직접 랩을 시도한 후에 계속 읽기를 강력히 권장합니다!\n\n이러한 랩들은 문제 해결에 대해 다양한 방법이 항상 있습니다. 일반적으로 저는 더 반복 가능하고 프로그래밸하게 문제를 해결할 수 있도록 문제를 해결하는 것이 좋습니다. 그러나 물론 클라우드 콘솔도 사용할 수 있습니다.\n\n# 이 랩 개요\n\n이 랩에서는 Terraform을 사용하여 Google Cloud에서 인프라를 생성, 배포 및 관리해야 합니다. 또한 일부 관리되지 않은 인스턴스를 구성에 가져와 수정해야 합니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n# 나의 해결책\n\n우리가 이 도전 과제 동안 사용할 몇 가지 변수를 정의하는 것부터 시작해봅시다. 실제 변수는 랩을 시작할 때 제공될 것입니다.\n\n```js\ngcloud auth list\n\nregion=\u003c지역 입력\u003e\nzone=\u003c존 입력\u003e\nprj=\u003c프로젝트 ID 입력\u003e\n```\n\n## 작업 1 — 구성 파일 생성\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n이 폴더 구조를 만들라고 지시받았어요:\n\n```js\nmain.tf\nvariables.tf\nmodules/\n└── instances\n|   ├── instances.tf\n|   ├── outputs.tf\n|   └── variables.tf\n└── storage\n    ├── storage.tf\n    ├── outputs.tf\n    └── variables.tf\n```\n\n이렇게 만들어볼까요:\n\n```js\n# 루트 디렉토리에 main.tf와 variables.tf 파일 생성\ntouch main.tf variables.tf\n\n# main 디렉토리 및 파일 생성\nmkdir -p modules/instances\nmkdir modules/storage\n\n# 'instances' 모듈 디렉토리에 필요한 파일 생성\ntouch modules/instances/instances.tf\ntouch modules/instances/outputs.tf\ntouch modules/instances/variables.tf\n\n# 'storage' 모듈 디렉토리에 필요한 파일 생성\ntouch modules/storage/storage.tf\ntouch modules/storage/outputs.tf\ntouch modules/storage/variables.tf\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n이제 변수.tf 파일을 업데이트하여 다음 변수들을 포함하도록 합니다:\n\n```js\nvariable \"region\" {\n  description = \"Google Cloud 지역\"\n  type        = string\n  default     = \"실습에서 제공하는 지역\"\n}\n\nvariable \"zone\" {\n  description = \"Google Cloud 존\"\n  type        = string\n  default     = \"실습에서 제공하는 존\"\n}\n\nvariable \"project_id\" {\n  description = \"리소스를 프로비저닝할 프로젝트의 ID\"\n  type        = string\n  default     = \"귀하의 프로젝트 ID\"\n}\n```\n\n루트 모듈 main.tf를 업데이트하여 Google Cloud Provider를 포함하도록 합니다. Terraform Registry에서 항상 확인할 수 있습니다. 제공자 블록에 세 가지 변수를 모두 포함하도록 요청되었습니다.\n\n```js\nterraform {\n  required_providers {\n    google = {\n      version = \"~\u003e 4.0\"\n    }\n  }\n}\n\nprovider \"google\" {\n  project     = var.project_id\n  region      = var.region\n  zone        = var.zone\n}\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n이제 테라폼을 초기화해야 합니다. 따라서 다음 명령을 실행하세요:\n\n```js\nterraform init\n```\n\n## 작업 2 — 인프라 가져오기\n\n여기서의 목표는 지금까지 테라폼 외부에서 프로비저닝된 인프라를 테라폼 제어 아래로 가져오는 것입니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n테라폼 가져오기 워크플로우를 사용할 거에요:\n\n![이미지](/assets/img/2024-05-20-BuildInfrastructureonGoogleCloudwithTerraformGoogleChallengeLabWalkthrough_0.png)\n\n이것들은 가져오기 단계들이에요:\n\n- 가져올 기존 인프라를 식별하세요.\n- 인프라를 테라폼 상태에 가져오세요.\n- 해당 인프라와 일치하는 테라폼 구성을 작성하세요.\n- 구성이 예상 상태와 인프라와 일치하는지 확인하기 위해 테라폼 계획을 검토하세요.\n- 구성을 적용하여 테라폼 상태를 업데이트하세요.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## 가져와야 할 기존 인프라 확인\n\n이미 두 개의 GCE 인스턴스가 생성되었습니다. Cloud 콘솔에서 기존 인스턴스 중 하나인 tf-instance-1을 확인하세요. 우리는 다음을 검색하려고 합니다:\n\n- 네트워크\n- 머신 유형\n- 디스크\n\n다음으로, 우리는 main.tf에 우리의 인스턴스 모듈을 두 번 호출해야 합니다. 이 두 호출은 빈 정의를 포함할 것이므로 가져올 수 있습니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nmodule \"tf_instance_1\" {\nsource = \"./modules/instances\"\ninstance_name = \"tf-instance-1\"\nzone = var.zone\nregion = var.region\n}\n\nmodule \"tf_instance_2\" {\nsource = \"./modules/instances\"\ninstance_name = \"tf-instance-2\"\nzone = var.zone\nregion = var.region\n}\n\n각 모듈 정의에는 고유한 레이블이 있어야 합니다.\n\n이제 초기화해보세요:\n\n```bash\nterraform init\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n이제 instances.tf에 모듈 구성을 작성합니다. 우리는 포함해야 할 최소한의 구성 요소를 알려받았습니다:\n\n```js\nresource \"google_compute_instance\" \"instance\" {\n  name         = var.instance_name\n  machine_type = \"기존 인스턴스에서 하드 코딩\"\n  zone         = var.zone\n\n  boot_disk {\n    initialize_params {\n      # image = \"debian-cloud/debian-11\"\n      image = \"기존 인스턴스에서 하드 코딩\"\n    }\n  }\n\n  network_interface {\n    # network = \"default\"\n    network = \"기존 인스턴스에서 하드 코딩\"\n    access_config {\n      // 일시적 공용 IP\n    }\n  }\n\n  metadata_startup_script = \u003c\u003c-EOT\n          #!/bin/bash\n      EOT\n  allow_stopping_for_update = true\n}\n```\n\n인스턴스 모듈의 변수를 전달할 수 있도록 variables.tf를 업데이트하십시오. instance_name을 전달할 수 있도록 합니다:\n\n```js\nvariable \"instance_name\" {\n  description = \"인스턴스의 이름.\"\n  type        = string\n}\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## Terraform State로 기존 인프라 가져오기\n\n```js\nterraform import module.tf_instance_1.google_compute_instance.instance \\\n  projects/$prj/zones/$zone/instances/tf-instance-1\n\nterraform import module.tf_instance_2.google_compute_instance.instance \\\n  projects/$prj/zones/$zone/instances/tf-instance-2\n\n# 가져오기 확인\nterraform show\n```\n\n다음과 같이 가져와야 합니다:\n\n\u003cimg src=\"/assets/img/2024-05-20-BuildInfrastructureonGoogleCloudwithTerraformGoogleChallengeLabWalkthrough_1.png\" /\u003e\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## 계획 및 적용\n\n이제 우리는 apply를 실행하여 인스턴스를 그 자리에서 업데이트합니다:\n\n```js\nterraform plan\nterraform apply\n```\n\n## 작업 3 — 원격 백엔드 구성\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n이건 꽤 쉬워요. 원격 GCS 백엔드에 Terraform 상태를 저장하려고 할 때 실행해야 하는 표준 단계들이에요:\n\n- Terraform을 사용하여 GCS 버킷을 프로비저닝합니다.\n- 새로운 GCS 버킷을 가리키는 백엔드 블록을 추가합니다.\n- Terraform을 다시 초기화하고 로컬 상태 파일에서 원격 백엔드로 상태를 이관합니다.\n\n## GCS Bucket 프로비저닝하기\n\n다음 리소스 정의를 main.tf에 추가하세요:\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n위의 코드를 아래와 같이 번역해 드립니다.\n\n```js\n리소스 \"google_storage_bucket\" \"test-bucket-for-state\" {\n  이름        = \"할당 받은 버킷 이름\"\n  위치    = \"US\"\n  uniform_bucket_level_access = true\n\n  force_destroy = true\n}\n```\n\n그리고 다음을 적용하세요:\n\n```js\nterraform apply\n```\n\n## GCS 백엔드 추가하기\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nmain.tf 파일을 수정하여 백엔드를 terraform 블록에 포함시키세요:\n\n```js\nterraform {\n  backend \"gcs\" {\n    bucket  = \"제공받은 버킷 이름\"\n    prefix  = \"terraform/state\"\n  }\n}\n```\n\n## 상태 이전\n\n로컬 상태 파일에서 GCS 백엔드로 Terraform 상태를 이전하는 부분입니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\nterraform init -migrate-state\n```\n\n상태를 이전하려는 것을 확인하라는 메시지가 표시됩니다:\n\n\u003cimg src=\"/assets/img/2024-05-20-BuildInfrastructureonGoogleCloudwithTerraformGoogleChallengeLabWalkthrough_2.png\" /\u003e\n\n## 작업 4 — 인프라 수정 및 업데이트\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n우리는 machine_type을 포함하는 variables.tf를 업데이트해야합니다:\n\n```js\nvariable \"machine_type\" {\n  description = \"인스턴스의 머신 유형\"\n  type        = string\n  default     = \"e2-standard-2\"\n}\n```\n\n그런 다음, instance.tf를 수정하여 machine_type 매개변수를 허용할 수 있도록 설정해야합니다:\n\n```js\nresource \"google_compute_instance\" \"instance\" {\n  name         = var.instance_name\n  machine_type = var.machine_type\n  zone         = var.zone\n\n  ...\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n마지막으로, main.tf를 수정해서 세 번째 인스턴스를 추가해야 합니다. 세 번째 모듈을 호출하여 main.tf에 추가합니다. 이미 기본값을 설정했으므로 machine_type을 전달할 필요가 없습니다.\n\n이제 초기화하고(모듈 인스턴스를 추가했으므로) 적용하세요.\n\n```js\nterraform init\nterraform apply\n```\n\n## 작업 5 — 리소스 파기\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n이전에 추가했던 인스턴스를 제거해 보겠습니다. main.tf에서 이 모듈 호출을 제거한 다음 다시 적용하십시오:\n\n```js\nterraform init\nterraform apply\n```\n\n## 작업 6 — 레지스트리에서 모듈 사용하기\n\nGoogle Network Module를 사용하려고 합니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```bash\nmodule \"network\" {\n  source  = \"terraform-google-modules/network/google\"\n  version = \"6.0.0\"\n\n  project_id   = var.project_id\n  network_name = \"Use Supplied VPC Name\"\n  routing_mode = \"GLOBAL\"\n\n  subnets = [\n    {\n      subnet_name           = \"subnet-01\"\n      subnet_ip             = \"10.10.10.0/24\"\n      subnet_region         = var.region\n    },\n    {\n      subnet_name           = \"subnet-02\"\n      subnet_ip             = \"10.10.20.0/24\"\n      subnet_region         = var.region\n    }\n  ]\n}\n```\n\n초기화하고 적용하세요:\n\n```bash\nterraform init\nterraform apply\n```\n\n인스턴스 모듈을 업데이트하여 네트워크 매개변수와 서브넷 매개변수를 사용하도록 하십시오.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nvariables.tf:\n\n```js\nvariable \"network\" {\n  description = \"네트워크\"\n  type        = string\n}\n\nvariable \"subnet\" {\n  description = \"서브넷\"\n  type        = string\n}\n```\n\ninstance.tf:\n\n```js\nnetwork_interface {\n  network = var.network\n  subnetwork = var.subnet\n\n  access_config {\n    // 일시적인 공용 IP\n  }\n}\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n그럼 이렇게 인스턴스를 생성하도록 main.tf를 업데이트하세요:\n\n```js\nmodule \"tf_instance_1\" {\n  source        = \"./modules/instances\"\n  instance_name = \"tf-instance-1\"\n  zone          = var.zone\n  region        = var.region\n\n  network       = module.network.network_name\n  subnet        = \"subnet-01\"\n}\n\nmodule \"tf_instance_2\" {\n  source        = \"./modules/instances\"\n  instance_name = \"tf-instance-2\"\n  zone          = var.zone\n  region        = var.region\n  network       = module.network.network_name\n  subnet        = \"subnet-02\"\n}\n```\n\n```js\nterraform init\nterraform apply\n```\n\n## 작업 7 — 방화벽 추가\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n위의 코드를 Korean으로 번역하였습니다:\n\nmd\nmain.tf을 업데이트 해주세요:\n\n```js\nresource \"google_compute_firewall\" \"default\" {\n  name          = \"tf-firewall\"\n  network       = module.network.network_name\n  direction     = \"INGRESS\"\n  source_ranges = [\"0.0.0.0/0\"]\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"80\"]\n  }\n}\n```\n\n그리고 마지막으로 한 번 더 실행해주세요...\n\n```js\nterraform apply\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n그럼 끝났어요!\n","ogImage":{"url":"/assets/img/2024-05-20-BuildInfrastructureonGoogleCloudwithTerraformGoogleChallengeLabWalkthrough_0.png"},"coverImage":"/assets/img/2024-05-20-BuildInfrastructureonGoogleCloudwithTerraformGoogleChallengeLabWalkthrough_0.png","tag":["Tech"],"readingTime":16},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cp\u003e구글 클라우드에서 Terraform으로 인프라를 구축하는 코스의 챌린지 랩 워크스루입니다.\u003c/p\u003e\n\u003cp\u003e이 랩은 다음을 테스트합니다:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e기존 인프라를 Terraform 구성으로 가져오는 능력.\u003c/li\u003e\n\u003cli\u003e직접 Terraform 모듈을 빌드하고 참조하는 것.\u003c/li\u003e\n\u003cli\u003e원격 백엔드를 구성에 추가하는 것.\u003c/li\u003e\n\u003cli\u003eTerraform 레지스트리에서 모듈을 사용하고 구현하는 것.\u003c/li\u003e\n\u003cli\u003e인프라를 다시 프로비저닝하고 파괴하고 업데이트하는 것.\u003c/li\u003e\n\u003cli\u003e생성한 리소스 간의 연결성을 테스트하는 것.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1\u003e챌린지 랩 소개\u003c/h1\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eGoogle은 구글 클라우드 스킬즈 부스트(이전 명칭: QwikLabs)라는 온라인 학습 플랫폼을 제공합니다. 이 플랫폼에서는 학습 경로에 맞는 교육 과정을 따르거나 특정 제품 또는 솔루션에 대한 교육 과정을 진행할 수 있습니다.\u003c/p\u003e\n\u003cp\u003e이 플랫폼에서의 학습 경험 중 하나는 퀘스트입니다. 퀘스트에 참여하면 안내형 실습 랩을 수행한 후 도전 랩을 완료합니다. 도전 랩은 목표가 명시되지만 목표를 달성하는 방법에 대한 안내가 거의 없는 다른 랩과는 다릅니다.\u003c/p\u003e\n\u003cp\u003e제가 가끔 이 도전 랩에 대한 해결 방법을 제공합니다. 목표는 도전 랩을 도와주어서 쉽게 풀어내는 데 도움을 주는 것이 아닙니다! 대신에:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e랩을 완료하는 데 가장 이상적인 경로로 이끄는 것을 보여드립니다.\u003c/li\u003e\n\u003cli\u003e랩을 스스로 완료할 수 없는 특정 문제나 장애물을 해결하는 데 도움을 줍니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e도움이 필요한 경우, 도전 과제에 대한 도움을 얻으려면 올바른 곳에 오신 것을 환영합니다. 그러나 먼저 퀘스트를 진행하고 직접 랩을 시도한 후에 계속 읽기를 강력히 권장합니다!\u003c/p\u003e\n\u003cp\u003e이러한 랩들은 문제 해결에 대해 다양한 방법이 항상 있습니다. 일반적으로 저는 더 반복 가능하고 프로그래밸하게 문제를 해결할 수 있도록 문제를 해결하는 것이 좋습니다. 그러나 물론 클라우드 콘솔도 사용할 수 있습니다.\u003c/p\u003e\n\u003ch1\u003e이 랩 개요\u003c/h1\u003e\n\u003cp\u003e이 랩에서는 Terraform을 사용하여 Google Cloud에서 인프라를 생성, 배포 및 관리해야 합니다. 또한 일부 관리되지 않은 인스턴스를 구성에 가져와 수정해야 합니다.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch1\u003e나의 해결책\u003c/h1\u003e\n\u003cp\u003e우리가 이 도전 과제 동안 사용할 몇 가지 변수를 정의하는 것부터 시작해봅시다. 실제 변수는 랩을 시작할 때 제공될 것입니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003egcloud auth list\n\nregion=\u0026#x3C;지역 입력\u003e\nzone=\u0026#x3C;존 입력\u003e\nprj=\u0026#x3C;프로젝트 \u003cspan class=\"hljs-variable constant_\"\u003eID\u003c/span\u003e 입력\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e작업 1 — 구성 파일 생성\u003c/h2\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e이 폴더 구조를 만들라고 지시받았어요:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003emain.\u003cspan class=\"hljs-property\"\u003etf\u003c/span\u003e\nvariables.\u003cspan class=\"hljs-property\"\u003etf\u003c/span\u003e\nmodules/\n└── instances\n|   ├── instances.\u003cspan class=\"hljs-property\"\u003etf\u003c/span\u003e\n|   ├── outputs.\u003cspan class=\"hljs-property\"\u003etf\u003c/span\u003e\n|   └── variables.\u003cspan class=\"hljs-property\"\u003etf\u003c/span\u003e\n└── storage\n    ├── storage.\u003cspan class=\"hljs-property\"\u003etf\u003c/span\u003e\n    ├── outputs.\u003cspan class=\"hljs-property\"\u003etf\u003c/span\u003e\n    └── variables.\u003cspan class=\"hljs-property\"\u003etf\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e이렇게 만들어볼까요:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e# 루트 디렉토리에 main.\u003cspan class=\"hljs-property\"\u003etf\u003c/span\u003e와 variables.\u003cspan class=\"hljs-property\"\u003etf\u003c/span\u003e 파일 생성\ntouch main.\u003cspan class=\"hljs-property\"\u003etf\u003c/span\u003e variables.\u003cspan class=\"hljs-property\"\u003etf\u003c/span\u003e\n\n# main 디렉토리 및 파일 생성\nmkdir -p modules/instances\nmkdir modules/storage\n\n# \u003cspan class=\"hljs-string\"\u003e'instances'\u003c/span\u003e 모듈 디렉토리에 필요한 파일 생성\ntouch modules/instances/instances.\u003cspan class=\"hljs-property\"\u003etf\u003c/span\u003e\ntouch modules/instances/outputs.\u003cspan class=\"hljs-property\"\u003etf\u003c/span\u003e\ntouch modules/instances/variables.\u003cspan class=\"hljs-property\"\u003etf\u003c/span\u003e\n\n# \u003cspan class=\"hljs-string\"\u003e'storage'\u003c/span\u003e 모듈 디렉토리에 필요한 파일 생성\ntouch modules/storage/storage.\u003cspan class=\"hljs-property\"\u003etf\u003c/span\u003e\ntouch modules/storage/outputs.\u003cspan class=\"hljs-property\"\u003etf\u003c/span\u003e\ntouch modules/storage/variables.\u003cspan class=\"hljs-property\"\u003etf\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e이제 변수.tf 파일을 업데이트하여 다음 변수들을 포함하도록 합니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003evariable \u003cspan class=\"hljs-string\"\u003e\"region\"\u003c/span\u003e {\n  description = \u003cspan class=\"hljs-string\"\u003e\"Google Cloud 지역\"\u003c/span\u003e\n  type        = string\n  \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e     = \u003cspan class=\"hljs-string\"\u003e\"실습에서 제공하는 지역\"\u003c/span\u003e\n}\n\nvariable \u003cspan class=\"hljs-string\"\u003e\"zone\"\u003c/span\u003e {\n  description = \u003cspan class=\"hljs-string\"\u003e\"Google Cloud 존\"\u003c/span\u003e\n  type        = string\n  \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e     = \u003cspan class=\"hljs-string\"\u003e\"실습에서 제공하는 존\"\u003c/span\u003e\n}\n\nvariable \u003cspan class=\"hljs-string\"\u003e\"project_id\"\u003c/span\u003e {\n  description = \u003cspan class=\"hljs-string\"\u003e\"리소스를 프로비저닝할 프로젝트의 ID\"\u003c/span\u003e\n  type        = string\n  \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e     = \u003cspan class=\"hljs-string\"\u003e\"귀하의 프로젝트 ID\"\u003c/span\u003e\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e루트 모듈 main.tf를 업데이트하여 Google Cloud Provider를 포함하도록 합니다. Terraform Registry에서 항상 확인할 수 있습니다. 제공자 블록에 세 가지 변수를 모두 포함하도록 요청되었습니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eterraform {\n  required_providers {\n    google = {\n      version = \u003cspan class=\"hljs-string\"\u003e\"~\u003e 4.0\"\u003c/span\u003e\n    }\n  }\n}\n\nprovider \u003cspan class=\"hljs-string\"\u003e\"google\"\u003c/span\u003e {\n  project     = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eproject_id\u003c/span\u003e\n  region      = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eregion\u003c/span\u003e\n  zone        = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ezone\u003c/span\u003e\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e이제 테라폼을 초기화해야 합니다. 따라서 다음 명령을 실행하세요:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eterraform init\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e작업 2 — 인프라 가져오기\u003c/h2\u003e\n\u003cp\u003e여기서의 목표는 지금까지 테라폼 외부에서 프로비저닝된 인프라를 테라폼 제어 아래로 가져오는 것입니다.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e테라폼 가져오기 워크플로우를 사용할 거에요:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-05-20-BuildInfrastructureonGoogleCloudwithTerraformGoogleChallengeLabWalkthrough_0.png\" alt=\"이미지\"\u003e\u003c/p\u003e\n\u003cp\u003e이것들은 가져오기 단계들이에요:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e가져올 기존 인프라를 식별하세요.\u003c/li\u003e\n\u003cli\u003e인프라를 테라폼 상태에 가져오세요.\u003c/li\u003e\n\u003cli\u003e해당 인프라와 일치하는 테라폼 구성을 작성하세요.\u003c/li\u003e\n\u003cli\u003e구성이 예상 상태와 인프라와 일치하는지 확인하기 위해 테라폼 계획을 검토하세요.\u003c/li\u003e\n\u003cli\u003e구성을 적용하여 테라폼 상태를 업데이트하세요.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch2\u003e가져와야 할 기존 인프라 확인\u003c/h2\u003e\n\u003cp\u003e이미 두 개의 GCE 인스턴스가 생성되었습니다. Cloud 콘솔에서 기존 인스턴스 중 하나인 tf-instance-1을 확인하세요. 우리는 다음을 검색하려고 합니다:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e네트워크\u003c/li\u003e\n\u003cli\u003e머신 유형\u003c/li\u003e\n\u003cli\u003e디스크\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e다음으로, 우리는 main.tf에 우리의 인스턴스 모듈을 두 번 호출해야 합니다. 이 두 호출은 빈 정의를 포함할 것이므로 가져올 수 있습니다.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003emodule \"tf_instance_1\" {\nsource = \"./modules/instances\"\ninstance_name = \"tf-instance-1\"\nzone = var.zone\nregion = var.region\n}\u003c/p\u003e\n\u003cp\u003emodule \"tf_instance_2\" {\nsource = \"./modules/instances\"\ninstance_name = \"tf-instance-2\"\nzone = var.zone\nregion = var.region\n}\u003c/p\u003e\n\u003cp\u003e각 모듈 정의에는 고유한 레이블이 있어야 합니다.\u003c/p\u003e\n\u003cp\u003e이제 초기화해보세요:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eterraform init\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e이제 instances.tf에 모듈 구성을 작성합니다. 우리는 포함해야 할 최소한의 구성 요소를 알려받았습니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eresource \u003cspan class=\"hljs-string\"\u003e\"google_compute_instance\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"instance\"\u003c/span\u003e {\n  name         = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003einstance_name\u003c/span\u003e\n  machine_type = \u003cspan class=\"hljs-string\"\u003e\"기존 인스턴스에서 하드 코딩\"\u003c/span\u003e\n  zone         = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ezone\u003c/span\u003e\n\n  boot_disk {\n    initialize_params {\n      # image = \u003cspan class=\"hljs-string\"\u003e\"debian-cloud/debian-11\"\u003c/span\u003e\n      image = \u003cspan class=\"hljs-string\"\u003e\"기존 인스턴스에서 하드 코딩\"\u003c/span\u003e\n    }\n  }\n\n  network_interface {\n    # network = \u003cspan class=\"hljs-string\"\u003e\"default\"\u003c/span\u003e\n    network = \u003cspan class=\"hljs-string\"\u003e\"기존 인스턴스에서 하드 코딩\"\u003c/span\u003e\n    access_config {\n      \u003cspan class=\"hljs-comment\"\u003e// 일시적 공용 IP\u003c/span\u003e\n    }\n  }\n\n  metadata_startup_script = \u0026#x3C;\u0026#x3C;-\u003cspan class=\"hljs-variable constant_\"\u003eEOT\u003c/span\u003e\n          #!\u003cspan class=\"hljs-regexp\"\u003e/bin/\u003c/span\u003ebash\n      \u003cspan class=\"hljs-variable constant_\"\u003eEOT\u003c/span\u003e\n  allow_stopping_for_update = \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e인스턴스 모듈의 변수를 전달할 수 있도록 variables.tf를 업데이트하십시오. instance_name을 전달할 수 있도록 합니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003evariable \u003cspan class=\"hljs-string\"\u003e\"instance_name\"\u003c/span\u003e {\n  description = \u003cspan class=\"hljs-string\"\u003e\"인스턴스의 이름.\"\u003c/span\u003e\n  type        = string\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch2\u003eTerraform State로 기존 인프라 가져오기\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eterraform \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003etf_instance_1\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003egoogle_compute_instance\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003einstance\u003c/span\u003e \\\n  projects/$prj/zones/$zone/instances/tf-instance-\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n\nterraform \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003etf_instance_2\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003egoogle_compute_instance\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003einstance\u003c/span\u003e \\\n  projects/$prj/zones/$zone/instances/tf-instance-\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\n\n# 가져오기 확인\nterraform show\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e다음과 같이 가져와야 합니다:\u003c/p\u003e\n\u003cimg src=\"/assets/img/2024-05-20-BuildInfrastructureonGoogleCloudwithTerraformGoogleChallengeLabWalkthrough_1.png\"\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch2\u003e계획 및 적용\u003c/h2\u003e\n\u003cp\u003e이제 우리는 apply를 실행하여 인스턴스를 그 자리에서 업데이트합니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eterraform plan\nterraform apply\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e작업 3 — 원격 백엔드 구성\u003c/h2\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e이건 꽤 쉬워요. 원격 GCS 백엔드에 Terraform 상태를 저장하려고 할 때 실행해야 하는 표준 단계들이에요:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eTerraform을 사용하여 GCS 버킷을 프로비저닝합니다.\u003c/li\u003e\n\u003cli\u003e새로운 GCS 버킷을 가리키는 백엔드 블록을 추가합니다.\u003c/li\u003e\n\u003cli\u003eTerraform을 다시 초기화하고 로컬 상태 파일에서 원격 백엔드로 상태를 이관합니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eGCS Bucket 프로비저닝하기\u003c/h2\u003e\n\u003cp\u003e다음 리소스 정의를 main.tf에 추가하세요:\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e위의 코드를 아래와 같이 번역해 드립니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e리소스 \u003cspan class=\"hljs-string\"\u003e\"google_storage_bucket\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"test-bucket-for-state\"\u003c/span\u003e {\n  이름        = \u003cspan class=\"hljs-string\"\u003e\"할당 받은 버킷 이름\"\u003c/span\u003e\n  위치    = \u003cspan class=\"hljs-string\"\u003e\"US\"\u003c/span\u003e\n  uniform_bucket_level_access = \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e\n\n  force_destroy = \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e그리고 다음을 적용하세요:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eterraform apply\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eGCS 백엔드 추가하기\u003c/h2\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003emain.tf 파일을 수정하여 백엔드를 terraform 블록에 포함시키세요:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eterraform {\n  backend \u003cspan class=\"hljs-string\"\u003e\"gcs\"\u003c/span\u003e {\n    bucket  = \u003cspan class=\"hljs-string\"\u003e\"제공받은 버킷 이름\"\u003c/span\u003e\n    prefix  = \u003cspan class=\"hljs-string\"\u003e\"terraform/state\"\u003c/span\u003e\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e상태 이전\u003c/h2\u003e\n\u003cp\u003e로컬 상태 파일에서 GCS 백엔드로 Terraform 상태를 이전하는 부분입니다.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eterraform init -migrate-state\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e상태를 이전하려는 것을 확인하라는 메시지가 표시됩니다:\u003c/p\u003e\n\u003cimg src=\"/assets/img/2024-05-20-BuildInfrastructureonGoogleCloudwithTerraformGoogleChallengeLabWalkthrough_2.png\"\u003e\n\u003ch2\u003e작업 4 — 인프라 수정 및 업데이트\u003c/h2\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e우리는 machine_type을 포함하는 variables.tf를 업데이트해야합니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003evariable \u003cspan class=\"hljs-string\"\u003e\"machine_type\"\u003c/span\u003e {\n  description = \u003cspan class=\"hljs-string\"\u003e\"인스턴스의 머신 유형\"\u003c/span\u003e\n  type        = string\n  \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e     = \u003cspan class=\"hljs-string\"\u003e\"e2-standard-2\"\u003c/span\u003e\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e그런 다음, instance.tf를 수정하여 machine_type 매개변수를 허용할 수 있도록 설정해야합니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eresource \u003cspan class=\"hljs-string\"\u003e\"google_compute_instance\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"instance\"\u003c/span\u003e {\n  name         = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003einstance_name\u003c/span\u003e\n  machine_type = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003emachine_type\u003c/span\u003e\n  zone         = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ezone\u003c/span\u003e\n\n  ...\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e마지막으로, main.tf를 수정해서 세 번째 인스턴스를 추가해야 합니다. 세 번째 모듈을 호출하여 main.tf에 추가합니다. 이미 기본값을 설정했으므로 machine_type을 전달할 필요가 없습니다.\u003c/p\u003e\n\u003cp\u003e이제 초기화하고(모듈 인스턴스를 추가했으므로) 적용하세요.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eterraform init\nterraform apply\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e작업 5 — 리소스 파기\u003c/h2\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e이전에 추가했던 인스턴스를 제거해 보겠습니다. main.tf에서 이 모듈 호출을 제거한 다음 다시 적용하십시오:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eterraform init\nterraform apply\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e작업 6 — 레지스트리에서 모듈 사용하기\u003c/h2\u003e\n\u003cp\u003eGoogle Network Module를 사용하려고 합니다.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emodule \u003cspan class=\"hljs-string\"\u003e\"network\"\u003c/span\u003e {\n  \u003cspan class=\"hljs-built_in\"\u003esource\u003c/span\u003e  = \u003cspan class=\"hljs-string\"\u003e\"terraform-google-modules/network/google\"\u003c/span\u003e\n  version = \u003cspan class=\"hljs-string\"\u003e\"6.0.0\"\u003c/span\u003e\n\n  project_id   = var.project_id\n  network_name = \u003cspan class=\"hljs-string\"\u003e\"Use Supplied VPC Name\"\u003c/span\u003e\n  routing_mode = \u003cspan class=\"hljs-string\"\u003e\"GLOBAL\"\u003c/span\u003e\n\n  subnets = [\n    {\n      subnet_name           = \u003cspan class=\"hljs-string\"\u003e\"subnet-01\"\u003c/span\u003e\n      subnet_ip             = \u003cspan class=\"hljs-string\"\u003e\"10.10.10.0/24\"\u003c/span\u003e\n      subnet_region         = var.region\n    },\n    {\n      subnet_name           = \u003cspan class=\"hljs-string\"\u003e\"subnet-02\"\u003c/span\u003e\n      subnet_ip             = \u003cspan class=\"hljs-string\"\u003e\"10.10.20.0/24\"\u003c/span\u003e\n      subnet_region         = var.region\n    }\n  ]\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e초기화하고 적용하세요:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eterraform init\nterraform apply\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e인스턴스 모듈을 업데이트하여 네트워크 매개변수와 서브넷 매개변수를 사용하도록 하십시오.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003evariables.tf:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003evariable \u003cspan class=\"hljs-string\"\u003e\"network\"\u003c/span\u003e {\n  description = \u003cspan class=\"hljs-string\"\u003e\"네트워크\"\u003c/span\u003e\n  type        = string\n}\n\nvariable \u003cspan class=\"hljs-string\"\u003e\"subnet\"\u003c/span\u003e {\n  description = \u003cspan class=\"hljs-string\"\u003e\"서브넷\"\u003c/span\u003e\n  type        = string\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003einstance.tf:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003enetwork_interface {\n  network = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003enetwork\u003c/span\u003e\n  subnetwork = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esubnet\u003c/span\u003e\n\n  access_config {\n    \u003cspan class=\"hljs-comment\"\u003e// 일시적인 공용 IP\u003c/span\u003e\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e그럼 이렇게 인스턴스를 생성하도록 main.tf를 업데이트하세요:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"tf_instance_1\"\u003c/span\u003e {\n  source        = \u003cspan class=\"hljs-string\"\u003e\"./modules/instances\"\u003c/span\u003e\n  instance_name = \u003cspan class=\"hljs-string\"\u003e\"tf-instance-1\"\u003c/span\u003e\n  zone          = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ezone\u003c/span\u003e\n  region        = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eregion\u003c/span\u003e\n\n  network       = \u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003enetwork\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003enetwork_name\u003c/span\u003e\n  subnet        = \u003cspan class=\"hljs-string\"\u003e\"subnet-01\"\u003c/span\u003e\n}\n\n\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"tf_instance_2\"\u003c/span\u003e {\n  source        = \u003cspan class=\"hljs-string\"\u003e\"./modules/instances\"\u003c/span\u003e\n  instance_name = \u003cspan class=\"hljs-string\"\u003e\"tf-instance-2\"\u003c/span\u003e\n  zone          = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ezone\u003c/span\u003e\n  region        = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eregion\u003c/span\u003e\n  network       = \u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003enetwork\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003enetwork_name\u003c/span\u003e\n  subnet        = \u003cspan class=\"hljs-string\"\u003e\"subnet-02\"\u003c/span\u003e\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eterraform init\nterraform apply\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e작업 7 — 방화벽 추가\u003c/h2\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e위의 코드를 Korean으로 번역하였습니다:\u003c/p\u003e\n\u003cp\u003emd\nmain.tf을 업데이트 해주세요:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eresource \u003cspan class=\"hljs-string\"\u003e\"google_compute_firewall\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"default\"\u003c/span\u003e {\n  name          = \u003cspan class=\"hljs-string\"\u003e\"tf-firewall\"\u003c/span\u003e\n  network       = \u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003enetwork\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003enetwork_name\u003c/span\u003e\n  direction     = \u003cspan class=\"hljs-string\"\u003e\"INGRESS\"\u003c/span\u003e\n  source_ranges = [\u003cspan class=\"hljs-string\"\u003e\"0.0.0.0/0\"\u003c/span\u003e]\n\n  allow {\n    protocol = \u003cspan class=\"hljs-string\"\u003e\"tcp\"\u003c/span\u003e\n    ports    = [\u003cspan class=\"hljs-string\"\u003e\"80\"\u003c/span\u003e]\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e그리고 마지막으로 한 번 더 실행해주세요...\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eterraform apply\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e그럼 끝났어요!\u003c/p\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-05-20-BuildInfrastructureonGoogleCloudwithTerraformGoogleChallengeLabWalkthrough"},"buildId":"YUMR4jSyk_WlOHHc7UfOk","isFallback":false,"gsp":true,"scriptLoader":[{"async":true,"src":"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4877378276818686","strategy":"lazyOnload","crossOrigin":"anonymous"}]}</script></body></html>