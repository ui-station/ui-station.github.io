<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>ì˜¤í”ˆì†ŒìŠ¤ SQLFrameì„ ì†Œê°œí•©ë‹ˆë‹¤  | ui-station</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://ui-station.github.io///post/2024-05-23-Introducingopen-sourceSQLFrame" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="ì˜¤í”ˆì†ŒìŠ¤ SQLFrameì„ ì†Œê°œí•©ë‹ˆë‹¤  | ui-station" data-gatsby-head="true"/><meta property="og:title" content="ì˜¤í”ˆì†ŒìŠ¤ SQLFrameì„ ì†Œê°œí•©ë‹ˆë‹¤  | ui-station" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-05-23-Introducingopen-sourceSQLFrame_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://ui-station.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://ui-station.github.io///post/2024-05-23-Introducingopen-sourceSQLFrame" data-gatsby-head="true"/><meta name="twitter:title" content="ì˜¤í”ˆì†ŒìŠ¤ SQLFrameì„ ì†Œê°œí•©ë‹ˆë‹¤  | ui-station" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-05-23-Introducingopen-sourceSQLFrame_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | ui-station" data-gatsby-head="true"/><meta name="article:published_time" content="2024-05-23 16:00" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-BHFR6GTH9P"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
          
            gtag('config', 'G-BHFR6GTH9P');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b8ef307c9aee1e34.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b8ef307c9aee1e34.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-ac4aa08aae62f90e.js" defer=""></script><script src="/_next/static/chunks/463-0429087d4c0b0335.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-70e5ce89f3d962ac.js" defer=""></script><script src="/_next/static/JlBEgQDLGRx6DYlBnT8eD/_buildManifest.js" defer=""></script><script src="/_next/static/JlBEgQDLGRx6DYlBnT8eD/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">UI STATION</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">ì˜¤í”ˆì†ŒìŠ¤ SQLFrameì„ ì†Œê°œí•©ë‹ˆë‹¤ </h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="ì˜¤í”ˆì†ŒìŠ¤ SQLFrameì„ ì†Œê°œí•©ë‹ˆë‹¤ " loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">UI STATION</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On May 23, 2024</span><span class="posts_reading_time__f7YPP">7<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-05-23-Introducingopen-sourceSQLFrame&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<p>13ë…„ê°„ ë°ì´í„° ì—”ì§€ë‹ˆì–´ë¡œ ê·¼ë¬´í•˜ë©´ì„œ ë³€í™”ì— ìµìˆ™í•´ì¡Œì–´ìš”. í´ë¼ìš°ë“œ ì´ì „ê³¼ ê°™ì€ ì¤‘ìš”í•œ ë³€í™”ë‚˜ ë…¸íŠ¸ë¶ í™œìš©ê³¼ ê°™ì€ ì‘ì€ íŠ¸ë Œë“œì™€ ê°™ì€ ê²ƒë“¤ì´ì£ . ì´ ëª¨ë“  ë³€í™” ì†ì—ì„œë„ í•˜ë‚˜ëŠ” ë¶ˆë³€í•´ ì™”ì–´ìš”: SQLì´ì£ . ìŠ¤íƒ€íŠ¸ì—…ë¶€í„° FAANGê¹Œì§€ ë‹¤ì–‘í•œ íšŒì‚¬ì—ì„œ ì¼í•œ ê²½í—˜ì„ í†µí•´ ì•Œê²Œ ëœ ê²ƒì€ SQLì„ ì˜ ì´í•´í•˜ê³  ì‘ì„±í•´ì•¼ í•œë‹¤ëŠ” ê²ƒì´ì—ˆì–´ìš”. SQLì€ ëª¨ë“  ë°ì´í„° ì „ë¬¸ê°€ë“¤ì„ í†µí•©í•˜ëŠ” ë³´í¸ì  ì–¸ì–´ì´ë©°, ë³µì¡í•œ ë¶„ì‚° ì²˜ë¦¬ì˜ ì„¸ë¶€ì‚¬í•­ì„ ì²˜ë¦¬í•˜ëŠ” ì¿¼ë¦¬ í”Œë˜ë„ˆì™€ ì˜µí‹°ë§ˆì´ì €ë¥¼ í†µí•´ íš¨ìœ¨ì ì¸ ë°ì´í„° íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•  ìˆ˜ ìˆê²Œ í•´ì¤˜ìš”.</p>
<p>SQLì˜ ê°•ì ì—ë„ ë¶ˆêµ¬í•˜ê³ , ì´ ì–¸ì–´ëŠ” ì¢…ì¢… ë°ì´í„° íŒŒì´í”„ë¼ì¸ ìœ ì§€ ê´€ë¦¬ì—ëŠ” ì í•©í•˜ì§€ ì•Šì•„ ë³´ì¼ ìˆ˜ ìˆì–´ìš”. ì´ ì–¸ì–´ëŠ” ì¼ë°˜ì ì¸ ì‘ì—…ì„ ì¶”ìƒí™”í•˜ê±°ë‚˜ ì½”ë“œì˜ íŠ¹ì • ì„¸ê·¸ë¨¼íŠ¸ì— ëŒ€í•œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ ì§€ì›í•˜ì§€ ì•Šì•„ì„œ, ë§ì€ ì‚¬ëŒë“¤ì´ ì„ì‹œ ë°©ë²•ìœ¼ë¡œ Jinjaë¥¼ ì‚¬ìš©í•˜ê³¤ í•´ìš”. Jinja SQLì€ SQLì˜ Pig Latinê³¼ ê°™ì€ ê´€ê³„ë¡œ, ì‘ì€ ëŸ‰ì—ì„œëŠ” ì¬ë¯¸ìˆì„ ìˆ˜ë„ ìˆì§€ë§Œ, ëŒ€ê·œëª¨ë¡œ í™•ì¥í•˜ë©´ ì´í•´í•˜ê¸° ì–´ë ¤ì›Œì§€ê¸°ë„ í•´ìš”. ë”êµ¬ë‚˜, SQLì˜ ë°˜ë³µì ì¸ íŠ¹ì„±ì€ ì—´ì„ ë°˜ë³µí•´ì„œ ì§€ì •í•´ì•¼ í•˜ëŠ” ê²ƒìœ¼ë¡œ, ì¢…ì¢… ë°ì´í„° ì „ë¬¸ê°€ë“¤ ì‚¬ì´ì—ì„œ í”¼ë¡œê°ì„ ì¼ìœ¼í‚¬ ìˆ˜ ìˆì–´ìš”.
ê²°êµ­, ë°ì´í„° ì „ë¬¸ê°€ë“¤ì€ SELECT *ì˜ ìœ í˜¹ì— ë°˜ì‘í•˜ë©° ë¶ˆí™•ì‹¤ì„±ì˜ ë°”ë‹¤ì—ì„œ ì¹¨ëª°í•˜ê²Œ ë˜ê¸°ë„ í•´ìš”.</p>
<p>ì´ë¡œì¨ ë°ì´í„° ì „ë¬¸ê°€ë“¤ì´ ì–´ë ¤ìš´ ì„ íƒì„ í•˜ê²Œ ë˜ì—ˆì–´ìš”: ì ‘ê·¼ì„±ì„ ìš°ì„ ì‹œí•˜ì—¬ SQLë¡œ íŒŒì´í”„ë¼ì¸ì„ ì‘ì„±í•  ê²ƒì¸ê°€ìš”, ì•„ë‹ˆë©´ ìœ ì§€ë³´ìˆ˜ì„±ì„ ìš°ì„ ì‹œí•˜ì—¬ Pythonìœ¼ë¡œ ì‘ì„±í•  ê²ƒì¸ê°€ìš”? ì˜¤ëŠ˜ë¶€í„°ëŠ” ë” ì´ìƒ ì„ íƒí•  í•„ìš”ê°€ ì—†ì–´ìš”. ì´ì œ ì—¬ëŸ¬ë¶„ì€ ë™ì‹œì— ì¼€ì´í¬ë¥¼ ë¨¹ê³  ê°€ì§ˆ ìˆ˜ ìˆê²Œ ë˜ì—ˆì–´ìš”.</p>
<p><img src="https://miro.medium.com/v2/resize:fit:1400/1*JZ4jUIBrQAf-oovf3IFN1w.gif" alt="image"></p>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h1>ì˜¤í”ˆì†ŒìŠ¤ SQLFrame ì†Œê°œ! ğŸ‰</h1>
<p><img src="/assets/img/2024-05-23-Introducingopen-sourceSQLFrame_0.png" alt="ì´ë¯¸ì§€"></p>
<p>SQLFrameì€ ë°ì´í„° ì „ë¬¸ê°€ë“¤ì´ SQL ë° PySpark ë°ì´í„°í”„ë ˆì„ê³¼ ìƒí˜¸ ì‘ìš©í•˜ëŠ” ë°©ì‹ì„ í˜ì‹ í•©ë‹ˆë‹¤. ì „í†µì ì¸ PySparkê³¼ ë‹¬ë¦¬ SQLFrameì€ DataFrame ì‘ì—…ì„ ì§ì ‘ SQLë¡œ ë³€í™˜í•˜ì—¬ ê°œë°œ ì¤‘ì— ì‹¤ì‹œê°„ SQL ìŠ¤í¬ë¦½íŠ¸ ìƒì„±ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤. ì‘ë™ ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:</p>
<p>ê³µê°œì ìœ¼ë¡œ ì ‘ê·¼ ê°€ëŠ¥í•œ ì¶œìƒ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë‹¨ì¼ ì•„ë™ì„ ì„ íƒí•œ ìƒˆ ê°€ì¡±ì˜ ìˆ˜ë¥¼ ë¶„ì„í•˜ëŠ” ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ê³ ë ¤í•´ ë³´ê² ìŠµë‹ˆë‹¤.</p>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>js
from sqlframe.bigquery import BigQuerySession
from sqlframe.bigquery import functions as F
from sqlframe.bigquery import Window</p>
<h1>SQLFrameì—ì„œ ì œê³µí•˜ëŠ” ê³ ìœ  ê¸°ëŠ¥: ë¹…ì¿¼ë¦¬ì— ì§ì ‘ ì—°ê²°í•  ìˆ˜ ìˆëŠ” ëŠ¥ë ¥</h1>
<p>session = BigQuerySession(default_dataset="sqlframe.db1")
table_path = "bigquery-public-data.samples.natality"
df = (
session.read.table(table_path)
.where(F.col("ever_born") == 1)
.groupBy("year")
.agg(F.count("_").alias("num_single_child_families"))
.withColumn("percent_change", 1 - F.lag(F.col("num_single_child_families"), 1).over(Window.orderBy("year")) / F.col("num_single_child_families"))
.orderBy(F.abs(F.col("percent_change")).desc())
.select(
F.col("year").alias("Year"),
F.format_number("num_single_child_families", 0).alias("number of new families single child"),
F.format_number(F.col("percent_change") _ 100, 2).alias("percent change"),
)
.limit(5)
)</p>
<h1>SQLFrameì—ì„œ ì œê³µí•˜ëŠ” ê³ ìœ  ê¸°ëŠ¥: DataFrameì˜ SQL í™•ì¸ ê°€ëŠ¥</h1>
<p>df.sql()</p>
<p>SQLFrameë¥¼ ì‚¬ìš©í•˜ë©´ íŠ¹ë³„í•œ ë¹…ì¿¼ë¦¬ í´ë˜ìŠ¤ë¥¼ í™œìš©í•˜ì—¬ ë¹…ì¿¼ë¦¬ í™˜ê²½ê³¼ ì‹œìŠ¤í…œì„ ì›í™œí•˜ê²Œ í†µí•©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. DataFrame ì‘ì—…ì€ PySparkì—ì„œ ìˆ˜í–‰í•˜ëŠ” ê²ƒê³¼ ìœ ì‚¬í•˜ì§€ë§Œ SQLFrameë¥¼ ì´ìš©í•˜ë©´ df.sql() ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹¤ì‹œê°„ìœ¼ë¡œ ìƒì„± ë° ê²€í† í•˜ëŠ” ëŒ€ì‘í•˜ëŠ” SQL ì¿¼ë¦¬ë„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>js
WITH <code>t94228</code> AS (
SELECT
<code>natality</code>.<code>year</code> AS <code>year</code>,
COUNT(_) AS <code>num_single_child_families</code>
FROM <code>bigquery-public-data</code>.<code>samples</code>.<code>natality</code> AS <code>natality</code>
WHERE
<code>natality</code>.<code>ever_born</code> = 1
GROUP BY
<code>natality</code>.<code>year</code>
), <code>t34770</code> AS (
SELECT
<code>t94228</code>.<code>year</code> AS <code>year</code>,
<code>t94228</code>.<code>num_single_child_families</code> AS <code>num_single_child_families</code>,
1 - LAG(<code>t94228</code>.<code>num_single_child_families</code>, 1) OVER (ORDER BY <code>t94228</code>.<code>year</code>) / <code>t94228</code>.<code>num_single_child_families</code> AS <code>percent_change</code>
FROM <code>t94228</code> AS <code>t94228</code>
ORDER BY
ABS(<code>percent_change</code>) DESC
)
SELECT
<code>t34770</code>.<code>year</code> AS <code>year</code>,
FORMAT('%'.0f', ROUND(CAST(<code>t34770</code>.<code>num_single_child_families</code> AS FLOAT64), 0)) AS <code>number of new families single child</code>,
FORMAT('%'.2f', ROUND(CAST(<code>t34770</code>.<code>percent_change</code> _ 100 AS FLOAT64), 2)) AS <code>percent change</code>
FROM <code>t34770</code> AS <code>t34770</code>
LIMIT 5</p>
<p>ì´ ê¸°ëŠ¥ì€ ì´í•´ë¥¼ ì¦ì§„ì‹œí‚¬ ë¿ë§Œ ì•„ë‹ˆë¼ SQL ì¶œë ¥ì´ ê²°ì •ë¡ ì ì´ì–´ì„œ ë²„ì „ ê´€ë¦¬ì— ì í•©í•˜ê²Œ ë§Œë“­ë‹ˆë‹¤. ì´ë ‡ê²Œ í•¨ìœ¼ë¡œì¨ íŒŒì´ì¬ ë° SQL íŒŒì´í”„ë¼ì¸ì˜ í‘œí˜„ì„ ëª¨ë‘ ë²„ì „ ê´€ë¦¬í•  ìˆ˜ ìˆê³  ë™ë£Œë“¤ì´ ê°€ì¥ ì˜ ë§ëŠ” í˜•ì‹ì„ ì„ íƒí•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤!</p>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p><img src="https://miro.medium.com/v2/resize:fit:808/1*y_ZC1qkDPllTA3Yk3XiC8A.gif" alt="SQLFrame"></p>
<p>SQLFrameì€ SQLì„ ìƒì„±í•˜ëŠ” ê²ƒ ì´ìƒì„ ì œê³µí•©ë‹ˆë‹¤: PySpark DataFrame APIê°€ ëª¨ë“  ì£¼ìš” ë°ì´í„° ì›¨ì–´í•˜ìš°ìŠ¤ì—ì„œ ë„¤ì´í‹°ë¸Œ DataFrame APIì²˜ëŸ¼ ëŠê»´ì§€ê²Œ í•˜ëŠ” ê²ƒì´ ëª©í‘œì…ë‹ˆë‹¤. ë”°ë¼ì„œ ì‚¬ìš©ìë“¤ì€ ìŠ¤íŒŒí¬ í´ëŸ¬ìŠ¤í„°ë‚˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—†ì´ ë°ì´í„° ì›¨ì–´í•˜ìš°ìŠ¤ì—ì„œ DataFrame API íŒŒì´í”„ë¼ì¸ì„ ì§ì ‘ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!</p>
<p>ì˜ˆë¥¼ ë“¤ì–´, .sql()ì„ .show()ë¡œ ë°”ê¾¸ë©´ íŒŒì´í”„ë¼ì¸ì—ì„œ ë¹…ì¿¼ë¦¬ì—ì„œ ê²°ê³¼ë¥¼ ì§ì ‘ í‘œì‹œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” PySparkì—ì„œì™€ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ì‘ë™í•©ë‹ˆë‹¤.</p>
<p>python</p>
<blockquote>
<blockquote>
<blockquote>
<p>df.show()
+------+-------------------------------------+----------------+
| year | number of new families single child | percent change |
+------+-------------------------------------+----------------+
| 1989 | 1,650,246 | 20.01 |
| 1974 | 783,448 | 12.66 |
| 1977 | 1,057,379 | 10.22 |
| 1985 | 1,308,476 | 10.03 |
| 1975 | 868,985 | 9.84 |
+------+-------------------------------------+----------------+</p>
</blockquote>
</blockquote>
</blockquote>
<p>`</p>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>ë§ì€ ì¹´íƒˆë¡œê·¸ ì‘ì—…ì´ ì§€ì›ë˜ë©° listColumnsì™€ ê°™ì€ ê²ƒì´ ì§€ì›ë©ë‹ˆë‹¤:</p>
<pre><code class="hljs language-js">>>> columns = session.<span class="hljs-property">catalog</span>.<span class="hljs-title function_">listColumns</span>(table_path)
>>> <span class="hljs-title function_">print</span>(<span class="hljs-string">"\n"</span>.<span class="hljs-title function_">join</span>([f<span class="hljs-string">"Name: {x.name}, Data Type: {x.dataType}, Desc: {x.description}"</span> <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> columns]))
<span class="hljs-title class_">Name</span>: source_year, <span class="hljs-title class_">Data</span> <span class="hljs-title class_">Type</span>: <span class="hljs-title class_">INT64</span>, <span class="hljs-title class_">Desc</span>: <span class="hljs-title class_">Four</span>-digit year <span class="hljs-keyword">of</span> the birth. <span class="hljs-title class_">Example</span>: <span class="hljs-number">1975.</span>
<span class="hljs-title class_">Name</span>: year, <span class="hljs-title class_">Data</span> <span class="hljs-title class_">Type</span>: <span class="hljs-title class_">INT64</span>, <span class="hljs-title class_">Desc</span>: <span class="hljs-title class_">Four</span>-digit year <span class="hljs-keyword">of</span> the birth. <span class="hljs-title class_">Example</span>: <span class="hljs-number">1975.</span>
<span class="hljs-title class_">Name</span>: month, <span class="hljs-title class_">Data</span> <span class="hljs-title class_">Type</span>: <span class="hljs-title class_">INT64</span>, <span class="hljs-title class_">Desc</span>: <span class="hljs-title class_">Month</span> index <span class="hljs-keyword">of</span> the date <span class="hljs-keyword">of</span> birth, where <span class="hljs-number">1</span>=<span class="hljs-title class_">January</span>.
<span class="hljs-title class_">Name</span>: day, <span class="hljs-title class_">Data</span> <span class="hljs-title class_">Type</span>: <span class="hljs-title class_">INT64</span>, <span class="hljs-title class_">Desc</span>: <span class="hljs-title class_">Day</span> <span class="hljs-keyword">of</span> birth, starting <span class="hljs-keyword">from</span> <span class="hljs-number">1.</span>
<span class="hljs-title class_">Name</span>: wday, <span class="hljs-title class_">Data</span> <span class="hljs-title class_">Type</span>: <span class="hljs-title class_">INT64</span>, <span class="hljs-title class_">Desc</span>: <span class="hljs-title class_">Day</span> <span class="hljs-keyword">of</span> the week, where <span class="hljs-number">1</span> is <span class="hljs-title class_">Sunday</span> and <span class="hljs-number">7</span> is <span class="hljs-title class_">Saturday</span>.
<span class="hljs-title class_">Name</span>: state, <span class="hljs-title class_">Data</span> <span class="hljs-title class_">Type</span>: <span class="hljs-variable constant_">STRING</span>, <span class="hljs-title class_">Desc</span>: <span class="hljs-title class_">The</span> two character postal code <span class="hljs-keyword">for</span> the state. <span class="hljs-title class_">Entries</span> after <span class="hljs-number">2004</span> <span class="hljs-keyword">do</span> not include <span class="hljs-variable language_">this</span> value.
</code></pre>
<p>ë”°ë¼ì„œ SQLFrameì€ ë‹¨ìˆœíˆ DataFrame íŒŒì´í”„ë¼ì¸ì„ ë”ìš± ì ‘ê·¼ ê°€ëŠ¥í•˜ê²Œ ë§Œë“¤ ë¿ë§Œ ì•„ë‹ˆë¼, PySpark DataFrame APIë¥¼ ë³´ë‹¤ ë²”ìš©ì˜ DataFrame APIë¡œ ë³€í™˜í•˜ì—¬ ëª¨ë“  ë°ì´í„° ì „ë¬¸ê°€ê°€ ì¦ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤!</p>
<img src="https://miro.medium.com/v2/resize:fit:720/1*JQ7uBfQn-4VWWWlfl5D_sA.gif">
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>SQLFrameì€ í˜„ì¬ BigQuery, DuckDB ë° Postgresë¥¼ ì§€ì›í•˜ê³  ìˆìœ¼ë©°, Clickhouse, Redshift, Snowflake, Spark ë° Trinoê°€ ê°œë°œ ì¤‘ì— ìˆìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ì—”ì§„ì„ ìœ„í•œ SQL ìƒì„± ì‹¤í—˜ì„ ì›í•˜ëŠ” ê²½ìš° Standalone ì„¸ì…˜ì—ì„œ ìœ ì—°í•œ í…ŒìŠ¤íŠ¸ í™˜ê²½ì„ ì œê³µí•©ë‹ˆë‹¤.</p>
<p>SQLFrameì„ ì‹œì‘í•˜ë ¤ë©´ GitHub ë¦¬í¬ì§€í† ë¦¬ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!</p>
<p><img src="/assets/img/2024-05-23-Introducingopen-sourceSQLFrame_1.png" alt="SQLFrame ì†Œê°œ"></p>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"ì˜¤í”ˆì†ŒìŠ¤ SQLFrameì„ ì†Œê°œí•©ë‹ˆë‹¤ ","description":"","date":"2024-05-23 16:00","slug":"2024-05-23-Introducingopen-sourceSQLFrame","content":"\n13ë…„ê°„ ë°ì´í„° ì—”ì§€ë‹ˆì–´ë¡œ ê·¼ë¬´í•˜ë©´ì„œ ë³€í™”ì— ìµìˆ™í•´ì¡Œì–´ìš”. í´ë¼ìš°ë“œ ì´ì „ê³¼ ê°™ì€ ì¤‘ìš”í•œ ë³€í™”ë‚˜ ë…¸íŠ¸ë¶ í™œìš©ê³¼ ê°™ì€ ì‘ì€ íŠ¸ë Œë“œì™€ ê°™ì€ ê²ƒë“¤ì´ì£ . ì´ ëª¨ë“  ë³€í™” ì†ì—ì„œë„ í•˜ë‚˜ëŠ” ë¶ˆë³€í•´ ì™”ì–´ìš”: SQLì´ì£ . ìŠ¤íƒ€íŠ¸ì—…ë¶€í„° FAANGê¹Œì§€ ë‹¤ì–‘í•œ íšŒì‚¬ì—ì„œ ì¼í•œ ê²½í—˜ì„ í†µí•´ ì•Œê²Œ ëœ ê²ƒì€ SQLì„ ì˜ ì´í•´í•˜ê³  ì‘ì„±í•´ì•¼ í•œë‹¤ëŠ” ê²ƒì´ì—ˆì–´ìš”. SQLì€ ëª¨ë“  ë°ì´í„° ì „ë¬¸ê°€ë“¤ì„ í†µí•©í•˜ëŠ” ë³´í¸ì  ì–¸ì–´ì´ë©°, ë³µì¡í•œ ë¶„ì‚° ì²˜ë¦¬ì˜ ì„¸ë¶€ì‚¬í•­ì„ ì²˜ë¦¬í•˜ëŠ” ì¿¼ë¦¬ í”Œë˜ë„ˆì™€ ì˜µí‹°ë§ˆì´ì €ë¥¼ í†µí•´ íš¨ìœ¨ì ì¸ ë°ì´í„° íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•  ìˆ˜ ìˆê²Œ í•´ì¤˜ìš”.\n\nSQLì˜ ê°•ì ì—ë„ ë¶ˆêµ¬í•˜ê³ , ì´ ì–¸ì–´ëŠ” ì¢…ì¢… ë°ì´í„° íŒŒì´í”„ë¼ì¸ ìœ ì§€ ê´€ë¦¬ì—ëŠ” ì í•©í•˜ì§€ ì•Šì•„ ë³´ì¼ ìˆ˜ ìˆì–´ìš”. ì´ ì–¸ì–´ëŠ” ì¼ë°˜ì ì¸ ì‘ì—…ì„ ì¶”ìƒí™”í•˜ê±°ë‚˜ ì½”ë“œì˜ íŠ¹ì • ì„¸ê·¸ë¨¼íŠ¸ì— ëŒ€í•œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ ì§€ì›í•˜ì§€ ì•Šì•„ì„œ, ë§ì€ ì‚¬ëŒë“¤ì´ ì„ì‹œ ë°©ë²•ìœ¼ë¡œ Jinjaë¥¼ ì‚¬ìš©í•˜ê³¤ í•´ìš”. Jinja SQLì€ SQLì˜ Pig Latinê³¼ ê°™ì€ ê´€ê³„ë¡œ, ì‘ì€ ëŸ‰ì—ì„œëŠ” ì¬ë¯¸ìˆì„ ìˆ˜ë„ ìˆì§€ë§Œ, ëŒ€ê·œëª¨ë¡œ í™•ì¥í•˜ë©´ ì´í•´í•˜ê¸° ì–´ë ¤ì›Œì§€ê¸°ë„ í•´ìš”. ë”êµ¬ë‚˜, SQLì˜ ë°˜ë³µì ì¸ íŠ¹ì„±ì€ ì—´ì„ ë°˜ë³µí•´ì„œ ì§€ì •í•´ì•¼ í•˜ëŠ” ê²ƒìœ¼ë¡œ, ì¢…ì¢… ë°ì´í„° ì „ë¬¸ê°€ë“¤ ì‚¬ì´ì—ì„œ í”¼ë¡œê°ì„ ì¼ìœ¼í‚¬ ìˆ˜ ìˆì–´ìš”.\nê²°êµ­, ë°ì´í„° ì „ë¬¸ê°€ë“¤ì€ SELECT \\*ì˜ ìœ í˜¹ì— ë°˜ì‘í•˜ë©° ë¶ˆí™•ì‹¤ì„±ì˜ ë°”ë‹¤ì—ì„œ ì¹¨ëª°í•˜ê²Œ ë˜ê¸°ë„ í•´ìš”.\n\nì´ë¡œì¨ ë°ì´í„° ì „ë¬¸ê°€ë“¤ì´ ì–´ë ¤ìš´ ì„ íƒì„ í•˜ê²Œ ë˜ì—ˆì–´ìš”: ì ‘ê·¼ì„±ì„ ìš°ì„ ì‹œí•˜ì—¬ SQLë¡œ íŒŒì´í”„ë¼ì¸ì„ ì‘ì„±í•  ê²ƒì¸ê°€ìš”, ì•„ë‹ˆë©´ ìœ ì§€ë³´ìˆ˜ì„±ì„ ìš°ì„ ì‹œí•˜ì—¬ Pythonìœ¼ë¡œ ì‘ì„±í•  ê²ƒì¸ê°€ìš”? ì˜¤ëŠ˜ë¶€í„°ëŠ” ë” ì´ìƒ ì„ íƒí•  í•„ìš”ê°€ ì—†ì–´ìš”. ì´ì œ ì—¬ëŸ¬ë¶„ì€ ë™ì‹œì— ì¼€ì´í¬ë¥¼ ë¨¹ê³  ê°€ì§ˆ ìˆ˜ ìˆê²Œ ë˜ì—ˆì–´ìš”.\n\n![image](https://miro.medium.com/v2/resize:fit:1400/1*JZ4jUIBrQAf-oovf3IFN1w.gif)\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n# ì˜¤í”ˆì†ŒìŠ¤ SQLFrame ì†Œê°œ! ğŸ‰\n\n![ì´ë¯¸ì§€](/assets/img/2024-05-23-Introducingopen-sourceSQLFrame_0.png)\n\nSQLFrameì€ ë°ì´í„° ì „ë¬¸ê°€ë“¤ì´ SQL ë° PySpark ë°ì´í„°í”„ë ˆì„ê³¼ ìƒí˜¸ ì‘ìš©í•˜ëŠ” ë°©ì‹ì„ í˜ì‹ í•©ë‹ˆë‹¤. ì „í†µì ì¸ PySparkê³¼ ë‹¬ë¦¬ SQLFrameì€ DataFrame ì‘ì—…ì„ ì§ì ‘ SQLë¡œ ë³€í™˜í•˜ì—¬ ê°œë°œ ì¤‘ì— ì‹¤ì‹œê°„ SQL ìŠ¤í¬ë¦½íŠ¸ ìƒì„±ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤. ì‘ë™ ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:\n\nê³µê°œì ìœ¼ë¡œ ì ‘ê·¼ ê°€ëŠ¥í•œ ì¶œìƒ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë‹¨ì¼ ì•„ë™ì„ ì„ íƒí•œ ìƒˆ ê°€ì¡±ì˜ ìˆ˜ë¥¼ ë¶„ì„í•˜ëŠ” ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ê³ ë ¤í•´ ë³´ê² ìŠµë‹ˆë‹¤.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\njs\nfrom sqlframe.bigquery import BigQuerySession\nfrom sqlframe.bigquery import functions as F\nfrom sqlframe.bigquery import Window\n\n# SQLFrameì—ì„œ ì œê³µí•˜ëŠ” ê³ ìœ  ê¸°ëŠ¥: ë¹…ì¿¼ë¦¬ì— ì§ì ‘ ì—°ê²°í•  ìˆ˜ ìˆëŠ” ëŠ¥ë ¥\n\nsession = BigQuerySession(default_dataset=\"sqlframe.db1\")\ntable_path = \"bigquery-public-data.samples.natality\"\ndf = (\nsession.read.table(table_path)\n.where(F.col(\"ever_born\") == 1)\n.groupBy(\"year\")\n.agg(F.count(\"_\").alias(\"num_single_child_families\"))\n.withColumn(\"percent_change\", 1 - F.lag(F.col(\"num_single_child_families\"), 1).over(Window.orderBy(\"year\")) / F.col(\"num_single_child_families\"))\n.orderBy(F.abs(F.col(\"percent_change\")).desc())\n.select(\nF.col(\"year\").alias(\"Year\"),\nF.format_number(\"num_single_child_families\", 0).alias(\"number of new families single child\"),\nF.format_number(F.col(\"percent_change\") _ 100, 2).alias(\"percent change\"),\n)\n.limit(5)\n)\n\n# SQLFrameì—ì„œ ì œê³µí•˜ëŠ” ê³ ìœ  ê¸°ëŠ¥: DataFrameì˜ SQL í™•ì¸ ê°€ëŠ¥\n\ndf.sql()\n\nSQLFrameë¥¼ ì‚¬ìš©í•˜ë©´ íŠ¹ë³„í•œ ë¹…ì¿¼ë¦¬ í´ë˜ìŠ¤ë¥¼ í™œìš©í•˜ì—¬ ë¹…ì¿¼ë¦¬ í™˜ê²½ê³¼ ì‹œìŠ¤í…œì„ ì›í™œí•˜ê²Œ í†µí•©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. DataFrame ì‘ì—…ì€ PySparkì—ì„œ ìˆ˜í–‰í•˜ëŠ” ê²ƒê³¼ ìœ ì‚¬í•˜ì§€ë§Œ SQLFrameë¥¼ ì´ìš©í•˜ë©´ df.sql() ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹¤ì‹œê°„ìœ¼ë¡œ ìƒì„± ë° ê²€í† í•˜ëŠ” ëŒ€ì‘í•˜ëŠ” SQL ì¿¼ë¦¬ë„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\njs\nWITH `t94228` AS (\nSELECT\n`natality`.`year` AS `year`,\nCOUNT(_) AS `num_single_child_families`\nFROM `bigquery-public-data`.`samples`.`natality` AS `natality`\nWHERE\n`natality`.`ever_born` = 1\nGROUP BY\n`natality`.`year`\n), `t34770` AS (\nSELECT\n`t94228`.`year` AS `year`,\n`t94228`.`num_single_child_families` AS `num_single_child_families`,\n1 - LAG(`t94228`.`num_single_child_families`, 1) OVER (ORDER BY `t94228`.`year`) / `t94228`.`num_single_child_families` AS `percent_change`\nFROM `t94228` AS `t94228`\nORDER BY\nABS(`percent_change`) DESC\n)\nSELECT\n`t34770`.`year` AS `year`,\nFORMAT('%\\'.0f', ROUND(CAST(`t34770`.`num_single_child_families` AS FLOAT64), 0)) AS `number of new families single child`,\nFORMAT('%\\'.2f', ROUND(CAST(`t34770`.`percent_change` _ 100 AS FLOAT64), 2)) AS `percent change`\nFROM `t34770` AS `t34770`\nLIMIT 5\n\nì´ ê¸°ëŠ¥ì€ ì´í•´ë¥¼ ì¦ì§„ì‹œí‚¬ ë¿ë§Œ ì•„ë‹ˆë¼ SQL ì¶œë ¥ì´ ê²°ì •ë¡ ì ì´ì–´ì„œ ë²„ì „ ê´€ë¦¬ì— ì í•©í•˜ê²Œ ë§Œë“­ë‹ˆë‹¤. ì´ë ‡ê²Œ í•¨ìœ¼ë¡œì¨ íŒŒì´ì¬ ë° SQL íŒŒì´í”„ë¼ì¸ì˜ í‘œí˜„ì„ ëª¨ë‘ ë²„ì „ ê´€ë¦¬í•  ìˆ˜ ìˆê³  ë™ë£Œë“¤ì´ ê°€ì¥ ì˜ ë§ëŠ” í˜•ì‹ì„ ì„ íƒí•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤!\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n![SQLFrame](https://miro.medium.com/v2/resize:fit:808/1*y_ZC1qkDPllTA3Yk3XiC8A.gif)\n\nSQLFrameì€ SQLì„ ìƒì„±í•˜ëŠ” ê²ƒ ì´ìƒì„ ì œê³µí•©ë‹ˆë‹¤: PySpark DataFrame APIê°€ ëª¨ë“  ì£¼ìš” ë°ì´í„° ì›¨ì–´í•˜ìš°ìŠ¤ì—ì„œ ë„¤ì´í‹°ë¸Œ DataFrame APIì²˜ëŸ¼ ëŠê»´ì§€ê²Œ í•˜ëŠ” ê²ƒì´ ëª©í‘œì…ë‹ˆë‹¤. ë”°ë¼ì„œ ì‚¬ìš©ìë“¤ì€ ìŠ¤íŒŒí¬ í´ëŸ¬ìŠ¤í„°ë‚˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—†ì´ ë°ì´í„° ì›¨ì–´í•˜ìš°ìŠ¤ì—ì„œ DataFrame API íŒŒì´í”„ë¼ì¸ì„ ì§ì ‘ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!\n\nì˜ˆë¥¼ ë“¤ì–´, .sql()ì„ .show()ë¡œ ë°”ê¾¸ë©´ íŒŒì´í”„ë¼ì¸ì—ì„œ ë¹…ì¿¼ë¦¬ì—ì„œ ê²°ê³¼ë¥¼ ì§ì ‘ í‘œì‹œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” PySparkì—ì„œì™€ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ì‘ë™í•©ë‹ˆë‹¤.\n\npython\n\n\u003e \u003e \u003e df.show()\n\u003e \u003e \u003e +------+-------------------------------------+----------------+\n\u003e \u003e \u003e | year | number of new families single child | percent change |\n\u003e \u003e \u003e +------+-------------------------------------+----------------+\n\u003e \u003e \u003e | 1989 | 1,650,246 | 20.01 |\n\u003e \u003e \u003e | 1974 | 783,448 | 12.66 |\n\u003e \u003e \u003e | 1977 | 1,057,379 | 10.22 |\n\u003e \u003e \u003e | 1985 | 1,308,476 | 10.03 |\n\u003e \u003e \u003e | 1975 | 868,985 | 9.84 |\n\u003e \u003e \u003e +------+-------------------------------------+----------------+\n\n`\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\në§ì€ ì¹´íƒˆë¡œê·¸ ì‘ì—…ì´ ì§€ì›ë˜ë©° listColumnsì™€ ê°™ì€ ê²ƒì´ ì§€ì›ë©ë‹ˆë‹¤:\n\n```js\n\u003e\u003e\u003e columns = session.catalog.listColumns(table_path)\n\u003e\u003e\u003e print(\"\\n\".join([f\"Name: {x.name}, Data Type: {x.dataType}, Desc: {x.description}\" for x in columns]))\nName: source_year, Data Type: INT64, Desc: Four-digit year of the birth. Example: 1975.\nName: year, Data Type: INT64, Desc: Four-digit year of the birth. Example: 1975.\nName: month, Data Type: INT64, Desc: Month index of the date of birth, where 1=January.\nName: day, Data Type: INT64, Desc: Day of birth, starting from 1.\nName: wday, Data Type: INT64, Desc: Day of the week, where 1 is Sunday and 7 is Saturday.\nName: state, Data Type: STRING, Desc: The two character postal code for the state. Entries after 2004 do not include this value.\n```\n\në”°ë¼ì„œ SQLFrameì€ ë‹¨ìˆœíˆ DataFrame íŒŒì´í”„ë¼ì¸ì„ ë”ìš± ì ‘ê·¼ ê°€ëŠ¥í•˜ê²Œ ë§Œë“¤ ë¿ë§Œ ì•„ë‹ˆë¼, PySpark DataFrame APIë¥¼ ë³´ë‹¤ ë²”ìš©ì˜ DataFrame APIë¡œ ë³€í™˜í•˜ì—¬ ëª¨ë“  ë°ì´í„° ì „ë¬¸ê°€ê°€ ì¦ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤!\n\n\u003cimg src=\"https://miro.medium.com/v2/resize:fit:720/1*JQ7uBfQn-4VWWWlfl5D_sA.gif\" /\u003e\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nSQLFrameì€ í˜„ì¬ BigQuery, DuckDB ë° Postgresë¥¼ ì§€ì›í•˜ê³  ìˆìœ¼ë©°, Clickhouse, Redshift, Snowflake, Spark ë° Trinoê°€ ê°œë°œ ì¤‘ì— ìˆìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ì—”ì§„ì„ ìœ„í•œ SQL ìƒì„± ì‹¤í—˜ì„ ì›í•˜ëŠ” ê²½ìš° Standalone ì„¸ì…˜ì—ì„œ ìœ ì—°í•œ í…ŒìŠ¤íŠ¸ í™˜ê²½ì„ ì œê³µí•©ë‹ˆë‹¤.\n\nSQLFrameì„ ì‹œì‘í•˜ë ¤ë©´ GitHub ë¦¬í¬ì§€í† ë¦¬ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!\n\n![SQLFrame ì†Œê°œ](/assets/img/2024-05-23-Introducingopen-sourceSQLFrame_1.png)\n","ogImage":{"url":"/assets/img/2024-05-23-Introducingopen-sourceSQLFrame_0.png"},"coverImage":"/assets/img/2024-05-23-Introducingopen-sourceSQLFrame_0.png","tag":["Tech"],"readingTime":7},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cp\u003e13ë…„ê°„ ë°ì´í„° ì—”ì§€ë‹ˆì–´ë¡œ ê·¼ë¬´í•˜ë©´ì„œ ë³€í™”ì— ìµìˆ™í•´ì¡Œì–´ìš”. í´ë¼ìš°ë“œ ì´ì „ê³¼ ê°™ì€ ì¤‘ìš”í•œ ë³€í™”ë‚˜ ë…¸íŠ¸ë¶ í™œìš©ê³¼ ê°™ì€ ì‘ì€ íŠ¸ë Œë“œì™€ ê°™ì€ ê²ƒë“¤ì´ì£ . ì´ ëª¨ë“  ë³€í™” ì†ì—ì„œë„ í•˜ë‚˜ëŠ” ë¶ˆë³€í•´ ì™”ì–´ìš”: SQLì´ì£ . ìŠ¤íƒ€íŠ¸ì—…ë¶€í„° FAANGê¹Œì§€ ë‹¤ì–‘í•œ íšŒì‚¬ì—ì„œ ì¼í•œ ê²½í—˜ì„ í†µí•´ ì•Œê²Œ ëœ ê²ƒì€ SQLì„ ì˜ ì´í•´í•˜ê³  ì‘ì„±í•´ì•¼ í•œë‹¤ëŠ” ê²ƒì´ì—ˆì–´ìš”. SQLì€ ëª¨ë“  ë°ì´í„° ì „ë¬¸ê°€ë“¤ì„ í†µí•©í•˜ëŠ” ë³´í¸ì  ì–¸ì–´ì´ë©°, ë³µì¡í•œ ë¶„ì‚° ì²˜ë¦¬ì˜ ì„¸ë¶€ì‚¬í•­ì„ ì²˜ë¦¬í•˜ëŠ” ì¿¼ë¦¬ í”Œë˜ë„ˆì™€ ì˜µí‹°ë§ˆì´ì €ë¥¼ í†µí•´ íš¨ìœ¨ì ì¸ ë°ì´í„° íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•  ìˆ˜ ìˆê²Œ í•´ì¤˜ìš”.\u003c/p\u003e\n\u003cp\u003eSQLì˜ ê°•ì ì—ë„ ë¶ˆêµ¬í•˜ê³ , ì´ ì–¸ì–´ëŠ” ì¢…ì¢… ë°ì´í„° íŒŒì´í”„ë¼ì¸ ìœ ì§€ ê´€ë¦¬ì—ëŠ” ì í•©í•˜ì§€ ì•Šì•„ ë³´ì¼ ìˆ˜ ìˆì–´ìš”. ì´ ì–¸ì–´ëŠ” ì¼ë°˜ì ì¸ ì‘ì—…ì„ ì¶”ìƒí™”í•˜ê±°ë‚˜ ì½”ë“œì˜ íŠ¹ì • ì„¸ê·¸ë¨¼íŠ¸ì— ëŒ€í•œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ ì§€ì›í•˜ì§€ ì•Šì•„ì„œ, ë§ì€ ì‚¬ëŒë“¤ì´ ì„ì‹œ ë°©ë²•ìœ¼ë¡œ Jinjaë¥¼ ì‚¬ìš©í•˜ê³¤ í•´ìš”. Jinja SQLì€ SQLì˜ Pig Latinê³¼ ê°™ì€ ê´€ê³„ë¡œ, ì‘ì€ ëŸ‰ì—ì„œëŠ” ì¬ë¯¸ìˆì„ ìˆ˜ë„ ìˆì§€ë§Œ, ëŒ€ê·œëª¨ë¡œ í™•ì¥í•˜ë©´ ì´í•´í•˜ê¸° ì–´ë ¤ì›Œì§€ê¸°ë„ í•´ìš”. ë”êµ¬ë‚˜, SQLì˜ ë°˜ë³µì ì¸ íŠ¹ì„±ì€ ì—´ì„ ë°˜ë³µí•´ì„œ ì§€ì •í•´ì•¼ í•˜ëŠ” ê²ƒìœ¼ë¡œ, ì¢…ì¢… ë°ì´í„° ì „ë¬¸ê°€ë“¤ ì‚¬ì´ì—ì„œ í”¼ë¡œê°ì„ ì¼ìœ¼í‚¬ ìˆ˜ ìˆì–´ìš”.\nê²°êµ­, ë°ì´í„° ì „ë¬¸ê°€ë“¤ì€ SELECT *ì˜ ìœ í˜¹ì— ë°˜ì‘í•˜ë©° ë¶ˆí™•ì‹¤ì„±ì˜ ë°”ë‹¤ì—ì„œ ì¹¨ëª°í•˜ê²Œ ë˜ê¸°ë„ í•´ìš”.\u003c/p\u003e\n\u003cp\u003eì´ë¡œì¨ ë°ì´í„° ì „ë¬¸ê°€ë“¤ì´ ì–´ë ¤ìš´ ì„ íƒì„ í•˜ê²Œ ë˜ì—ˆì–´ìš”: ì ‘ê·¼ì„±ì„ ìš°ì„ ì‹œí•˜ì—¬ SQLë¡œ íŒŒì´í”„ë¼ì¸ì„ ì‘ì„±í•  ê²ƒì¸ê°€ìš”, ì•„ë‹ˆë©´ ìœ ì§€ë³´ìˆ˜ì„±ì„ ìš°ì„ ì‹œí•˜ì—¬ Pythonìœ¼ë¡œ ì‘ì„±í•  ê²ƒì¸ê°€ìš”? ì˜¤ëŠ˜ë¶€í„°ëŠ” ë” ì´ìƒ ì„ íƒí•  í•„ìš”ê°€ ì—†ì–´ìš”. ì´ì œ ì—¬ëŸ¬ë¶„ì€ ë™ì‹œì— ì¼€ì´í¬ë¥¼ ë¨¹ê³  ê°€ì§ˆ ìˆ˜ ìˆê²Œ ë˜ì—ˆì–´ìš”.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://miro.medium.com/v2/resize:fit:1400/1*JZ4jUIBrQAf-oovf3IFN1w.gif\" alt=\"image\"\u003e\u003c/p\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch1\u003eì˜¤í”ˆì†ŒìŠ¤ SQLFrame ì†Œê°œ! ğŸ‰\u003c/h1\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-05-23-Introducingopen-sourceSQLFrame_0.png\" alt=\"ì´ë¯¸ì§€\"\u003e\u003c/p\u003e\n\u003cp\u003eSQLFrameì€ ë°ì´í„° ì „ë¬¸ê°€ë“¤ì´ SQL ë° PySpark ë°ì´í„°í”„ë ˆì„ê³¼ ìƒí˜¸ ì‘ìš©í•˜ëŠ” ë°©ì‹ì„ í˜ì‹ í•©ë‹ˆë‹¤. ì „í†µì ì¸ PySparkê³¼ ë‹¬ë¦¬ SQLFrameì€ DataFrame ì‘ì—…ì„ ì§ì ‘ SQLë¡œ ë³€í™˜í•˜ì—¬ ê°œë°œ ì¤‘ì— ì‹¤ì‹œê°„ SQL ìŠ¤í¬ë¦½íŠ¸ ìƒì„±ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤. ì‘ë™ ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:\u003c/p\u003e\n\u003cp\u003eê³µê°œì ìœ¼ë¡œ ì ‘ê·¼ ê°€ëŠ¥í•œ ì¶œìƒ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë‹¨ì¼ ì•„ë™ì„ ì„ íƒí•œ ìƒˆ ê°€ì¡±ì˜ ìˆ˜ë¥¼ ë¶„ì„í•˜ëŠ” ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ê³ ë ¤í•´ ë³´ê² ìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003ejs\nfrom sqlframe.bigquery import BigQuerySession\nfrom sqlframe.bigquery import functions as F\nfrom sqlframe.bigquery import Window\u003c/p\u003e\n\u003ch1\u003eSQLFrameì—ì„œ ì œê³µí•˜ëŠ” ê³ ìœ  ê¸°ëŠ¥: ë¹…ì¿¼ë¦¬ì— ì§ì ‘ ì—°ê²°í•  ìˆ˜ ìˆëŠ” ëŠ¥ë ¥\u003c/h1\u003e\n\u003cp\u003esession = BigQuerySession(default_dataset=\"sqlframe.db1\")\ntable_path = \"bigquery-public-data.samples.natality\"\ndf = (\nsession.read.table(table_path)\n.where(F.col(\"ever_born\") == 1)\n.groupBy(\"year\")\n.agg(F.count(\"_\").alias(\"num_single_child_families\"))\n.withColumn(\"percent_change\", 1 - F.lag(F.col(\"num_single_child_families\"), 1).over(Window.orderBy(\"year\")) / F.col(\"num_single_child_families\"))\n.orderBy(F.abs(F.col(\"percent_change\")).desc())\n.select(\nF.col(\"year\").alias(\"Year\"),\nF.format_number(\"num_single_child_families\", 0).alias(\"number of new families single child\"),\nF.format_number(F.col(\"percent_change\") _ 100, 2).alias(\"percent change\"),\n)\n.limit(5)\n)\u003c/p\u003e\n\u003ch1\u003eSQLFrameì—ì„œ ì œê³µí•˜ëŠ” ê³ ìœ  ê¸°ëŠ¥: DataFrameì˜ SQL í™•ì¸ ê°€ëŠ¥\u003c/h1\u003e\n\u003cp\u003edf.sql()\u003c/p\u003e\n\u003cp\u003eSQLFrameë¥¼ ì‚¬ìš©í•˜ë©´ íŠ¹ë³„í•œ ë¹…ì¿¼ë¦¬ í´ë˜ìŠ¤ë¥¼ í™œìš©í•˜ì—¬ ë¹…ì¿¼ë¦¬ í™˜ê²½ê³¼ ì‹œìŠ¤í…œì„ ì›í™œí•˜ê²Œ í†µí•©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. DataFrame ì‘ì—…ì€ PySparkì—ì„œ ìˆ˜í–‰í•˜ëŠ” ê²ƒê³¼ ìœ ì‚¬í•˜ì§€ë§Œ SQLFrameë¥¼ ì´ìš©í•˜ë©´ df.sql() ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹¤ì‹œê°„ìœ¼ë¡œ ìƒì„± ë° ê²€í† í•˜ëŠ” ëŒ€ì‘í•˜ëŠ” SQL ì¿¼ë¦¬ë„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003ejs\nWITH \u003ccode\u003et94228\u003c/code\u003e AS (\nSELECT\n\u003ccode\u003enatality\u003c/code\u003e.\u003ccode\u003eyear\u003c/code\u003e AS \u003ccode\u003eyear\u003c/code\u003e,\nCOUNT(_) AS \u003ccode\u003enum_single_child_families\u003c/code\u003e\nFROM \u003ccode\u003ebigquery-public-data\u003c/code\u003e.\u003ccode\u003esamples\u003c/code\u003e.\u003ccode\u003enatality\u003c/code\u003e AS \u003ccode\u003enatality\u003c/code\u003e\nWHERE\n\u003ccode\u003enatality\u003c/code\u003e.\u003ccode\u003eever_born\u003c/code\u003e = 1\nGROUP BY\n\u003ccode\u003enatality\u003c/code\u003e.\u003ccode\u003eyear\u003c/code\u003e\n), \u003ccode\u003et34770\u003c/code\u003e AS (\nSELECT\n\u003ccode\u003et94228\u003c/code\u003e.\u003ccode\u003eyear\u003c/code\u003e AS \u003ccode\u003eyear\u003c/code\u003e,\n\u003ccode\u003et94228\u003c/code\u003e.\u003ccode\u003enum_single_child_families\u003c/code\u003e AS \u003ccode\u003enum_single_child_families\u003c/code\u003e,\n1 - LAG(\u003ccode\u003et94228\u003c/code\u003e.\u003ccode\u003enum_single_child_families\u003c/code\u003e, 1) OVER (ORDER BY \u003ccode\u003et94228\u003c/code\u003e.\u003ccode\u003eyear\u003c/code\u003e) / \u003ccode\u003et94228\u003c/code\u003e.\u003ccode\u003enum_single_child_families\u003c/code\u003e AS \u003ccode\u003epercent_change\u003c/code\u003e\nFROM \u003ccode\u003et94228\u003c/code\u003e AS \u003ccode\u003et94228\u003c/code\u003e\nORDER BY\nABS(\u003ccode\u003epercent_change\u003c/code\u003e) DESC\n)\nSELECT\n\u003ccode\u003et34770\u003c/code\u003e.\u003ccode\u003eyear\u003c/code\u003e AS \u003ccode\u003eyear\u003c/code\u003e,\nFORMAT('%'.0f', ROUND(CAST(\u003ccode\u003et34770\u003c/code\u003e.\u003ccode\u003enum_single_child_families\u003c/code\u003e AS FLOAT64), 0)) AS \u003ccode\u003enumber of new families single child\u003c/code\u003e,\nFORMAT('%'.2f', ROUND(CAST(\u003ccode\u003et34770\u003c/code\u003e.\u003ccode\u003epercent_change\u003c/code\u003e _ 100 AS FLOAT64), 2)) AS \u003ccode\u003epercent change\u003c/code\u003e\nFROM \u003ccode\u003et34770\u003c/code\u003e AS \u003ccode\u003et34770\u003c/code\u003e\nLIMIT 5\u003c/p\u003e\n\u003cp\u003eì´ ê¸°ëŠ¥ì€ ì´í•´ë¥¼ ì¦ì§„ì‹œí‚¬ ë¿ë§Œ ì•„ë‹ˆë¼ SQL ì¶œë ¥ì´ ê²°ì •ë¡ ì ì´ì–´ì„œ ë²„ì „ ê´€ë¦¬ì— ì í•©í•˜ê²Œ ë§Œë“­ë‹ˆë‹¤. ì´ë ‡ê²Œ í•¨ìœ¼ë¡œì¨ íŒŒì´ì¬ ë° SQL íŒŒì´í”„ë¼ì¸ì˜ í‘œí˜„ì„ ëª¨ë‘ ë²„ì „ ê´€ë¦¬í•  ìˆ˜ ìˆê³  ë™ë£Œë“¤ì´ ê°€ì¥ ì˜ ë§ëŠ” í˜•ì‹ì„ ì„ íƒí•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤!\u003c/p\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e\u003cimg src=\"https://miro.medium.com/v2/resize:fit:808/1*y_ZC1qkDPllTA3Yk3XiC8A.gif\" alt=\"SQLFrame\"\u003e\u003c/p\u003e\n\u003cp\u003eSQLFrameì€ SQLì„ ìƒì„±í•˜ëŠ” ê²ƒ ì´ìƒì„ ì œê³µí•©ë‹ˆë‹¤: PySpark DataFrame APIê°€ ëª¨ë“  ì£¼ìš” ë°ì´í„° ì›¨ì–´í•˜ìš°ìŠ¤ì—ì„œ ë„¤ì´í‹°ë¸Œ DataFrame APIì²˜ëŸ¼ ëŠê»´ì§€ê²Œ í•˜ëŠ” ê²ƒì´ ëª©í‘œì…ë‹ˆë‹¤. ë”°ë¼ì„œ ì‚¬ìš©ìë“¤ì€ ìŠ¤íŒŒí¬ í´ëŸ¬ìŠ¤í„°ë‚˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—†ì´ ë°ì´í„° ì›¨ì–´í•˜ìš°ìŠ¤ì—ì„œ DataFrame API íŒŒì´í”„ë¼ì¸ì„ ì§ì ‘ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!\u003c/p\u003e\n\u003cp\u003eì˜ˆë¥¼ ë“¤ì–´, .sql()ì„ .show()ë¡œ ë°”ê¾¸ë©´ íŒŒì´í”„ë¼ì¸ì—ì„œ ë¹…ì¿¼ë¦¬ì—ì„œ ê²°ê³¼ë¥¼ ì§ì ‘ í‘œì‹œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” PySparkì—ì„œì™€ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ì‘ë™í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003epython\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cblockquote\u003e\n\u003cblockquote\u003e\n\u003cp\u003edf.show()\n+------+-------------------------------------+----------------+\n| year | number of new families single child | percent change |\n+------+-------------------------------------+----------------+\n| 1989 | 1,650,246 | 20.01 |\n| 1974 | 783,448 | 12.66 |\n| 1977 | 1,057,379 | 10.22 |\n| 1985 | 1,308,476 | 10.03 |\n| 1975 | 868,985 | 9.84 |\n+------+-------------------------------------+----------------+\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/blockquote\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e`\u003c/p\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eë§ì€ ì¹´íƒˆë¡œê·¸ ì‘ì—…ì´ ì§€ì›ë˜ë©° listColumnsì™€ ê°™ì€ ê²ƒì´ ì§€ì›ë©ë‹ˆë‹¤:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003e\u003e\u003e columns = session.\u003cspan class=\"hljs-property\"\u003ecatalog\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elistColumns\u003c/span\u003e(table_path)\n\u003e\u003e\u003e \u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"\\n\"\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003ejoin\u003c/span\u003e([f\u003cspan class=\"hljs-string\"\u003e\"Name: {x.name}, Data Type: {x.dataType}, Desc: {x.description}\"\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e x \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e columns]))\n\u003cspan class=\"hljs-title class_\"\u003eName\u003c/span\u003e: source_year, \u003cspan class=\"hljs-title class_\"\u003eData\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eType\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eINT64\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eDesc\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eFour\u003c/span\u003e-digit year \u003cspan class=\"hljs-keyword\"\u003eof\u003c/span\u003e the birth. \u003cspan class=\"hljs-title class_\"\u003eExample\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1975.\u003c/span\u003e\n\u003cspan class=\"hljs-title class_\"\u003eName\u003c/span\u003e: year, \u003cspan class=\"hljs-title class_\"\u003eData\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eType\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eINT64\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eDesc\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eFour\u003c/span\u003e-digit year \u003cspan class=\"hljs-keyword\"\u003eof\u003c/span\u003e the birth. \u003cspan class=\"hljs-title class_\"\u003eExample\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1975.\u003c/span\u003e\n\u003cspan class=\"hljs-title class_\"\u003eName\u003c/span\u003e: month, \u003cspan class=\"hljs-title class_\"\u003eData\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eType\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eINT64\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eDesc\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eMonth\u003c/span\u003e index \u003cspan class=\"hljs-keyword\"\u003eof\u003c/span\u003e the date \u003cspan class=\"hljs-keyword\"\u003eof\u003c/span\u003e birth, where \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e=\u003cspan class=\"hljs-title class_\"\u003eJanuary\u003c/span\u003e.\n\u003cspan class=\"hljs-title class_\"\u003eName\u003c/span\u003e: day, \u003cspan class=\"hljs-title class_\"\u003eData\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eType\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eINT64\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eDesc\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eDay\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eof\u003c/span\u003e birth, starting \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1.\u003c/span\u003e\n\u003cspan class=\"hljs-title class_\"\u003eName\u003c/span\u003e: wday, \u003cspan class=\"hljs-title class_\"\u003eData\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eType\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eINT64\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eDesc\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eDay\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eof\u003c/span\u003e the week, where \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e is \u003cspan class=\"hljs-title class_\"\u003eSunday\u003c/span\u003e and \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e is \u003cspan class=\"hljs-title class_\"\u003eSaturday\u003c/span\u003e.\n\u003cspan class=\"hljs-title class_\"\u003eName\u003c/span\u003e: state, \u003cspan class=\"hljs-title class_\"\u003eData\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eType\u003c/span\u003e: \u003cspan class=\"hljs-variable constant_\"\u003eSTRING\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eDesc\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eThe\u003c/span\u003e two character postal code \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e the state. \u003cspan class=\"hljs-title class_\"\u003eEntries\u003c/span\u003e after \u003cspan class=\"hljs-number\"\u003e2004\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edo\u003c/span\u003e not include \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e value.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eë”°ë¼ì„œ SQLFrameì€ ë‹¨ìˆœíˆ DataFrame íŒŒì´í”„ë¼ì¸ì„ ë”ìš± ì ‘ê·¼ ê°€ëŠ¥í•˜ê²Œ ë§Œë“¤ ë¿ë§Œ ì•„ë‹ˆë¼, PySpark DataFrame APIë¥¼ ë³´ë‹¤ ë²”ìš©ì˜ DataFrame APIë¡œ ë³€í™˜í•˜ì—¬ ëª¨ë“  ë°ì´í„° ì „ë¬¸ê°€ê°€ ì¦ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤!\u003c/p\u003e\n\u003cimg src=\"https://miro.medium.com/v2/resize:fit:720/1*JQ7uBfQn-4VWWWlfl5D_sA.gif\"\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eSQLFrameì€ í˜„ì¬ BigQuery, DuckDB ë° Postgresë¥¼ ì§€ì›í•˜ê³  ìˆìœ¼ë©°, Clickhouse, Redshift, Snowflake, Spark ë° Trinoê°€ ê°œë°œ ì¤‘ì— ìˆìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ì—”ì§„ì„ ìœ„í•œ SQL ìƒì„± ì‹¤í—˜ì„ ì›í•˜ëŠ” ê²½ìš° Standalone ì„¸ì…˜ì—ì„œ ìœ ì—°í•œ í…ŒìŠ¤íŠ¸ í™˜ê²½ì„ ì œê³µí•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eSQLFrameì„ ì‹œì‘í•˜ë ¤ë©´ GitHub ë¦¬í¬ì§€í† ë¦¬ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-05-23-Introducingopen-sourceSQLFrame_1.png\" alt=\"SQLFrame ì†Œê°œ\"\u003e\u003c/p\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-05-23-Introducingopen-sourceSQLFrame"},"buildId":"JlBEgQDLGRx6DYlBnT8eD","isFallback":false,"gsp":true,"scriptLoader":[{"async":true,"src":"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4877378276818686","strategy":"lazyOnload","crossOrigin":"anonymous"}]}</script></body></html>