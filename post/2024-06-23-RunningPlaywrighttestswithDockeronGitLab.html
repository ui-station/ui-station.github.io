<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>GitLab에서 Docker를 사용하여 Playwright 테스트 실행하는 방법 | ui-station</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://ui-station.github.io///post/2024-06-23-RunningPlaywrighttestswithDockeronGitLab" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="GitLab에서 Docker를 사용하여 Playwright 테스트 실행하는 방법 | ui-station" data-gatsby-head="true"/><meta property="og:title" content="GitLab에서 Docker를 사용하여 Playwright 테스트 실행하는 방법 | ui-station" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://ui-station.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://ui-station.github.io///post/2024-06-23-RunningPlaywrighttestswithDockeronGitLab" data-gatsby-head="true"/><meta name="twitter:title" content="GitLab에서 Docker를 사용하여 Playwright 테스트 실행하는 방법 | ui-station" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | ui-station" data-gatsby-head="true"/><meta name="article:published_time" content="2024-06-23 00:38" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-BHFR6GTH9P"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
          
            gtag('config', 'G-BHFR6GTH9P');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b8ef307c9aee1e34.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b8ef307c9aee1e34.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-ac4aa08aae62f90e.js" defer=""></script><script src="/_next/static/chunks/463-0429087d4c0b0335.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-70e5ce89f3d962ac.js" defer=""></script><script src="/_next/static/T_Nz0g9U1yttYMSEma95P/_buildManifest.js" defer=""></script><script src="/_next/static/T_Nz0g9U1yttYMSEma95P/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">UI STATION</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">GitLab에서 Docker를 사용하여 Playwright 테스트 실행하는 방법</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="GitLab에서 Docker를 사용하여 Playwright 테스트 실행하는 방법" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">UI STATION</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On Jun 23, 2024</span><span class="posts_reading_time__f7YPP">9<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-06-23-RunningPlaywrighttestswithDockeronGitLab&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<p><img src="/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_0.png" alt="이미지"></p>
<p>안녕하세요 여러분, 이 글에서는 도커를 사용하여 Playwright를 설치하고 GitLab에서 실행하는 방법을 설명하겠습니다. Trendyol 프로젝트의 설치 과정 중에 직면한 일부 어려움들도 함께 공유할 것입니다.</p>
<p>시작하기 전에 Playwright에 대한 기본 정보와 프로젝트 설치 단계에 대한 기본 사항은 생략할 예정이니 참고해 주세요.</p>
<h1>문제점</h1>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>시작하기 전에, 왜 우리가 도커 이미지에서 테스트를 실행하는지 설명하는 것이 중요합니다. 저희 프로젝트에서는 브랜치별 테스팅을 진행하고 있는데요, 그것은 스프린트 동안 개발 중인 기능 브랜치에 대해 테스트를 실행한다는 것을 의미합니다. 이 기능 브랜치는 테스트 프로젝트 이미지와 함께 풀되어 도커 컨테이너에서 실행되며, 그 후 해당 실행 애플리케이션에 대해 테스트를 실행합니다. 아래에 프로세스를 설명하는 스크린샷과 플로우차트를 포함하였습니다.</p>
<p><img src="/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_1.png" alt="이미지 링크"></p>
<p>위의 이미지에서 보듯이, 테스트 자동화 단계에서 개발된 브랜치를 풀고, 개발 중인 격리 환경에서 해당 애플리케이션을 실행합니다. 그런 다음 실행 중인 애플리케이션에 대해 테스트를 수행합니다. 이 새로운 개발이 아무 문제를 발생시키지 않았다고 확신을 갖게 되면, 병합 요청을 올리는 과정으로 나아갑니다.</p>
<p><img src="/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_2.png" alt="이미지 링크"></p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h1>설치</h1>
<p>처음에 언급했듯이 설치 과정은 건너뜁니다. 도움이 필요하면 이 문서를 참조해 주세요. Playwright를 설치한 후에는 프로젝트가 다음과 같이 보일 것입니다.</p>
<img src="/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_3.png">
<p>로컬에서 테스트를 실행하려면 컴퓨터에 Docker를 설치해야 합니다. 이 링크에서 설치할 수 있습니다.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h1>프로젝트에 Docker 추가하기</h1>
<p>이를 실현하기 위해서는 프로젝트에 Dockerfile을 포함시키고 그 단계들을 구성해야 합니다.</p>
<p><img src="/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_4.png" alt="Docker 이미지"></p>
<pre><code class="hljs language-js"><span class="hljs-variable constant_">FROM</span> mcr.<span class="hljs-property">microsoft</span>.<span class="hljs-property">com</span>/<span class="hljs-attr">playwright</span>:v1<span class="hljs-number">.44</span><span class="hljs-number">.0</span>-jammy

<span class="hljs-variable constant_">WORKDIR</span> /app

<span class="hljs-variable constant_">COPY</span> package*.<span class="hljs-property">json</span> ./

<span class="hljs-variable constant_">RUN</span> npm ci

<span class="hljs-variable constant_">COPY</span> . .

<span class="hljs-variable constant_">CMD</span> [<span class="hljs-string">"npx"</span>, <span class="hljs-string">"playwright"</span>, <span class="hljs-string">"test"</span>]
</code></pre>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>이 기사의 대상은 Docker에 대해 처음 접하는 사람부터 Docker 전문가까지 다양합니다. 모두가 명확히 이해할 수 있도록 한 줄씩 설명하겠습니다.</p>
<ul>
<li>먼저, 우리는 테스트를 실행하는 데 필요한 모든 것을 포함하는 공식 Playwright 이미지를 가져옵니다.</li>
<li>프로젝트를 설치하기 위해 컨테이너 내부에 디렉토리를 만듭니다.</li>
<li>작업 디렉토리에 package.json 및 package-lock.json 파일을 복사하여 프로젝트를 올바르게 초기화합니다.</li>
<li>필요한 파일을 복사한 후, "npm ci"를 실행하여 프로젝트를 컨테이너에 설치합니다.</li>
<li>프로젝트를 설치한 후에는 테스트 파일, 구성 파일 등 추가 파일을 컨테이너에 복사합니다.</li>
<li>마지막 단계는 Playwright 테스트를 실행하는 명령을 실행하는 것입니다.</li>
</ul>
<p>참고: Docker에서 npm 패키지를 사용할 때 다른 예제에서 발견할 수 있는 것과 달리 "npm install" 대신 "npm ci"를 사용하는 것이 권장됩니다. 일부 불필요한 단계를 건너뛸 수 있기 때문입니다.</p>
<h1>로컬에서 테스트 실행</h1>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>로컬에서 테스트하려면 먼저 Docker를 시작하고 프로젝트 루트에 생성한 도커 파일을 빌드해야 합니다. VS Code 터미널을 사용하여 다음 명령을 사용하여 도커 파일을 빌드합니다. "docker build -t playwright-demo ."</p>
<p><img src="/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_5.png" alt="이미지"></p>
<p>참고: Playwright의 퀵스타트 폴더 "tests-examples"를 제거했습니다. 불필요한 테스트 예제 실행을 피하기 위함입니다.</p>
<p>이미지가 성공적으로 빌드되면 "docker run -it — rm playwright-demo"으로 실행 준비가 완료됩니다.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<img src="/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_6.png">
<p>프로젝트에 테스트를 추가하여 프로세스를 가속화했습니다. 지금 확인해보면 테스트 실행이 완료된 것을 확인할 수 있습니다.</p>
<h1>Gitlab-ci.yml 구성</h1>
<p>프로젝트에 gitlab-ci.yml 파일을 추가하고 이를 구성하여 파이프라인에서 테스트를 실행해봅시다.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-YAML"><span class="hljs-string">기본값:</span>
  <span class="hljs-string">이미지:</span> <span class="hljs-string">docker:24.0.5</span>
  <span class="hljs-string">서비스:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">docker:24.0.5-dind</span>

<span class="hljs-string">변수:</span>
  <span class="hljs-attr">DOCKER_HOST:</span> <span class="hljs-string">tcp://docker:2376</span>
  <span class="hljs-attr">DOCKER_TLS_CERTDIR:</span> <span class="hljs-string">"/certs"</span>
  <span class="hljs-attr">DOCKER_DRIVER:</span> <span class="hljs-string">overlay2</span>
  <span class="hljs-attr">DOCKER_BUILDKIT:</span> <span class="hljs-string">'1'</span>
  <span class="hljs-attr">FF_USE_FASTZIP:</span> <span class="hljs-string">"true"</span>
  <span class="hljs-attr">ARTIFACT_COMPRESSION_LEVEL:</span> <span class="hljs-string">"fast"</span>
  <span class="hljs-attr">CACHE_COMPRESSION_LEVEL:</span> <span class="hljs-string">"fast"</span>

<span class="hljs-string">단계:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">빌드</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">테스트</span>

<span class="hljs-string">빌드:</span>
  <span class="hljs-attr">stage:</span> <span class="hljs-string">빌드</span>
  <span class="hljs-attr">before_script:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">echo</span> <span class="hljs-string">"$CI_REGISTRY_PASSWORD"</span> <span class="hljs-string">|</span> <span class="hljs-string">docker</span> <span class="hljs-string">login</span> <span class="hljs-string">$CI_REGISTRY</span> <span class="hljs-string">-u</span> <span class="hljs-string">$CI_REGISTRY_USER</span> <span class="hljs-string">--password-stdin</span>
  <span class="hljs-attr">script:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">docker</span> <span class="hljs-string">pull</span> <span class="hljs-string">$CI_REGISTRY_IMAGE:latest</span> <span class="hljs-string">||</span> <span class="hljs-literal">true</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">docker</span> <span class="hljs-string">build</span>
      <span class="hljs-string">--cache-from</span> <span class="hljs-string">$CI_REGISTRY_IMAGE:latest</span>
      <span class="hljs-string">--tag</span> <span class="hljs-string">$CI_REGISTRY_IMAGE:latest</span>
      <span class="hljs-string">--build-arg</span> <span class="hljs-string">BUILDKIT_INLINE_CACHE=1</span>
      <span class="hljs-string">"."</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">docker</span> <span class="hljs-string">push</span> <span class="hljs-string">$CI_REGISTRY_IMAGE:latest</span>

<span class="hljs-string">테스트:</span>
  <span class="hljs-attr">stage:</span> <span class="hljs-string">테스트</span>
  <span class="hljs-attr">before_script:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">echo</span> <span class="hljs-string">"$CI_REGISTRY_PASSWORD"</span> <span class="hljs-string">|</span> <span class="hljs-string">docker</span> <span class="hljs-string">login</span> <span class="hljs-string">$CI_REGISTRY</span> <span class="hljs-string">-u</span> <span class="hljs-string">$CI_REGISTRY_USER</span> <span class="hljs-string">--password-stdin</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">mkdir</span> <span class="hljs-string">playwright-report</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">mkdir</span> <span class="hljs-string">test-results</span>
  <span class="hljs-attr">script:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">docker</span> <span class="hljs-string">run</span> <span class="hljs-string">--ipc=host</span> <span class="hljs-string">--name</span> <span class="hljs-string">playwright-tests</span> <span class="hljs-string">$CI_REGISTRY_IMAGE:latest</span>
  <span class="hljs-attr">after_script:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">docker</span> <span class="hljs-string">cp</span> <span class="hljs-string">playwright-tests:app/playwright-report/.</span> <span class="hljs-string">playwright-report</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">docker</span> <span class="hljs-string">cp</span> <span class="hljs-string">playwright-tests:app/test-results/.</span> <span class="hljs-string">test-results</span>
  <span class="hljs-attr">allow_failure:</span> <span class="hljs-literal">false</span>
  <span class="hljs-attr">artifacts:</span>
    <span class="hljs-attr">when:</span> <span class="hljs-string">항상</span>
    <span class="hljs-attr">paths:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">playwright-report</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">test-results</span>
    <span class="hljs-attr">expire_in:</span> <span class="hljs-number">1</span> <span class="hljs-string">주</span>
</code></pre>
<p>우리는 Docker 이미지를 정의합니다. 이 섹션 끝에서 몇 가지 중요한 사항을 주목해야 합니다.</p>
<p>변수 섹션에서는 주로 Docker 및 그 캐싱 메커니즘과 관련된 변수를 정의하여 이미지를 가져오는 시간을 단축하는 데 도움이 됩니다.</p>
<p>파이프라인의 초기 단계에서는 "before_script" 섹션 내에서 docker에 로그인하여 이미지를 가져옵니다. Gitlab 이미지 레지스트리에 이미지가 있는 경우에는 캐시에서 가져옵니다. 그렇지 않으면 로컬로 빌드한 다음 미래 빌드를 가속화하기 위해 이미지 레지스트리에 푸시합니다.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>테스트 단계에서는 Docker에 로그인하고 우리의 테스트 결과를 Docker 이미지에서 Gitlab 아티팩트로 전송하기 위해 두 개의 폴더를 생성합니다. 스크립트 섹션에서는 우리의 이미지를 실행하고, 마지막으로 아티팩트 섹션에서 테스트 폴더의 경로를 지정합니다.</p>
<p>중요 참고 사항: 프로젝트 설정 중에 Docker 버전과 Node.js가 충돌하는 특이한 문제가 발생했습니다. 이전 버전의 Docker를 사용하면 Playwright를 실행할 때 예기치 않은 오류가 발생할 수 있습니다. 따라서 프로젝트를 초기화할 때 최신 버전의 Docker 및 Playwright 이미지를 사용하는 것이 권장됩니다.</p>
<h1>Gitlab 파이프라인에서 테스트 실행</h1>
<p>변경 사항을 GitLab에 푸시하면 파이프라인에서 이와 유사한 내용이 표시됩니다.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<img src="/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_7.png">
<p>실행된 파이프라인에서 테스트 단계를 클릭하면 결과에서 비슷한 로그를 볼 수 있습니다.</p>
<img src="/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_8.png">
<h1>보고서에 접근하기</h1>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>보고서에 액세스하려면 페이지 우측 하단에 있는 "찾아보기" 버튼을 클릭하여 프로젝트 자료를 확인하세요.</p>
<p><img src="/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_9.png" alt="이미지"></p>
<p>자료에서 "playwright-report" 하위에 있는 HTML 보고서를 찾을 수 있습니다.</p>
<p><img src="/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_10.png" alt="이미지"></p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h1>결론</h1>
<p>필요하다면 여기서 GitLab 저장소를 찾을 수 있어요.</p>
<p>읽어 주셔서 감사합니다! 이 글을 가능한 한 간단하게 유지하기 위해 노력했어요. 유용하게 찾으셨으면 좋겠어요. 자유롭게 댓글을 남겨주세요. 다음 글에서 만나요! 👋</p>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"GitLab에서 Docker를 사용하여 Playwright 테스트 실행하는 방법","description":"","date":"2024-06-23 00:38","slug":"2024-06-23-RunningPlaywrighttestswithDockeronGitLab","content":"\n![이미지](/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_0.png)\n\n안녕하세요 여러분, 이 글에서는 도커를 사용하여 Playwright를 설치하고 GitLab에서 실행하는 방법을 설명하겠습니다. Trendyol 프로젝트의 설치 과정 중에 직면한 일부 어려움들도 함께 공유할 것입니다.\n\n시작하기 전에 Playwright에 대한 기본 정보와 프로젝트 설치 단계에 대한 기본 사항은 생략할 예정이니 참고해 주세요.\n\n# 문제점\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n시작하기 전에, 왜 우리가 도커 이미지에서 테스트를 실행하는지 설명하는 것이 중요합니다. 저희 프로젝트에서는 브랜치별 테스팅을 진행하고 있는데요, 그것은 스프린트 동안 개발 중인 기능 브랜치에 대해 테스트를 실행한다는 것을 의미합니다. 이 기능 브랜치는 테스트 프로젝트 이미지와 함께 풀되어 도커 컨테이너에서 실행되며, 그 후 해당 실행 애플리케이션에 대해 테스트를 실행합니다. 아래에 프로세스를 설명하는 스크린샷과 플로우차트를 포함하였습니다.\n\n![이미지 링크](/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_1.png)\n\n위의 이미지에서 보듯이, 테스트 자동화 단계에서 개발된 브랜치를 풀고, 개발 중인 격리 환경에서 해당 애플리케이션을 실행합니다. 그런 다음 실행 중인 애플리케이션에 대해 테스트를 수행합니다. 이 새로운 개발이 아무 문제를 발생시키지 않았다고 확신을 갖게 되면, 병합 요청을 올리는 과정으로 나아갑니다.\n\n![이미지 링크](/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_2.png)\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n# 설치\n\n처음에 언급했듯이 설치 과정은 건너뜁니다. 도움이 필요하면 이 문서를 참조해 주세요. Playwright를 설치한 후에는 프로젝트가 다음과 같이 보일 것입니다.\n\n\u003cimg src=\"/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_3.png\" /\u003e\n\n로컬에서 테스트를 실행하려면 컴퓨터에 Docker를 설치해야 합니다. 이 링크에서 설치할 수 있습니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n# 프로젝트에 Docker 추가하기\n\n이를 실현하기 위해서는 프로젝트에 Dockerfile을 포함시키고 그 단계들을 구성해야 합니다.\n\n![Docker 이미지](/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_4.png)\n\n```js\nFROM mcr.microsoft.com/playwright:v1.44.0-jammy\n\nWORKDIR /app\n\nCOPY package*.json ./\n\nRUN npm ci\n\nCOPY . .\n\nCMD [\"npx\", \"playwright\", \"test\"]\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n이 기사의 대상은 Docker에 대해 처음 접하는 사람부터 Docker 전문가까지 다양합니다. 모두가 명확히 이해할 수 있도록 한 줄씩 설명하겠습니다.\n\n- 먼저, 우리는 테스트를 실행하는 데 필요한 모든 것을 포함하는 공식 Playwright 이미지를 가져옵니다.\n- 프로젝트를 설치하기 위해 컨테이너 내부에 디렉토리를 만듭니다.\n- 작업 디렉토리에 package.json 및 package-lock.json 파일을 복사하여 프로젝트를 올바르게 초기화합니다.\n- 필요한 파일을 복사한 후, \"npm ci\"를 실행하여 프로젝트를 컨테이너에 설치합니다.\n- 프로젝트를 설치한 후에는 테스트 파일, 구성 파일 등 추가 파일을 컨테이너에 복사합니다.\n- 마지막 단계는 Playwright 테스트를 실행하는 명령을 실행하는 것입니다.\n\n참고: Docker에서 npm 패키지를 사용할 때 다른 예제에서 발견할 수 있는 것과 달리 \"npm install\" 대신 \"npm ci\"를 사용하는 것이 권장됩니다. 일부 불필요한 단계를 건너뛸 수 있기 때문입니다.\n\n# 로컬에서 테스트 실행\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n로컬에서 테스트하려면 먼저 Docker를 시작하고 프로젝트 루트에 생성한 도커 파일을 빌드해야 합니다. VS Code 터미널을 사용하여 다음 명령을 사용하여 도커 파일을 빌드합니다. \"docker build -t playwright-demo .\"\n\n![이미지](/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_5.png)\n\n참고: Playwright의 퀵스타트 폴더 \"tests-examples\"를 제거했습니다. 불필요한 테스트 예제 실행을 피하기 위함입니다.\n\n이미지가 성공적으로 빌드되면 \"docker run -it — rm playwright-demo\"으로 실행 준비가 완료됩니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n\u003cimg src=\"/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_6.png\" /\u003e\n\n프로젝트에 테스트를 추가하여 프로세스를 가속화했습니다. 지금 확인해보면 테스트 실행이 완료된 것을 확인할 수 있습니다.\n\n# Gitlab-ci.yml 구성\n\n프로젝트에 gitlab-ci.yml 파일을 추가하고 이를 구성하여 파이프라인에서 테스트를 실행해봅시다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```YAML\n기본값:\n  이미지: docker:24.0.5\n  서비스:\n    - docker:24.0.5-dind\n\n변수:\n  DOCKER_HOST: tcp://docker:2376\n  DOCKER_TLS_CERTDIR: \"/certs\"\n  DOCKER_DRIVER: overlay2\n  DOCKER_BUILDKIT: '1'\n  FF_USE_FASTZIP: \"true\"\n  ARTIFACT_COMPRESSION_LEVEL: \"fast\"\n  CACHE_COMPRESSION_LEVEL: \"fast\"\n\n단계:\n  - 빌드\n  - 테스트\n\n빌드:\n  stage: 빌드\n  before_script:\n    - echo \"$CI_REGISTRY_PASSWORD\" | docker login $CI_REGISTRY -u $CI_REGISTRY_USER --password-stdin\n  script:\n    - docker pull $CI_REGISTRY_IMAGE:latest || true\n    - docker build\n      --cache-from $CI_REGISTRY_IMAGE:latest\n      --tag $CI_REGISTRY_IMAGE:latest\n      --build-arg BUILDKIT_INLINE_CACHE=1\n      \".\"\n    - docker push $CI_REGISTRY_IMAGE:latest\n\n테스트:\n  stage: 테스트\n  before_script:\n    - echo \"$CI_REGISTRY_PASSWORD\" | docker login $CI_REGISTRY -u $CI_REGISTRY_USER --password-stdin\n    - mkdir playwright-report\n    - mkdir test-results\n  script:\n    - docker run --ipc=host --name playwright-tests $CI_REGISTRY_IMAGE:latest\n  after_script:\n    - docker cp playwright-tests:app/playwright-report/. playwright-report\n    - docker cp playwright-tests:app/test-results/. test-results\n  allow_failure: false\n  artifacts:\n    when: 항상\n    paths:\n      - playwright-report\n      - test-results\n    expire_in: 1 주\n```\n\n우리는 Docker 이미지를 정의합니다. 이 섹션 끝에서 몇 가지 중요한 사항을 주목해야 합니다.\n\n변수 섹션에서는 주로 Docker 및 그 캐싱 메커니즘과 관련된 변수를 정의하여 이미지를 가져오는 시간을 단축하는 데 도움이 됩니다.\n\n파이프라인의 초기 단계에서는 \"before_script\" 섹션 내에서 docker에 로그인하여 이미지를 가져옵니다. Gitlab 이미지 레지스트리에 이미지가 있는 경우에는 캐시에서 가져옵니다. 그렇지 않으면 로컬로 빌드한 다음 미래 빌드를 가속화하기 위해 이미지 레지스트리에 푸시합니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n테스트 단계에서는 Docker에 로그인하고 우리의 테스트 결과를 Docker 이미지에서 Gitlab 아티팩트로 전송하기 위해 두 개의 폴더를 생성합니다. 스크립트 섹션에서는 우리의 이미지를 실행하고, 마지막으로 아티팩트 섹션에서 테스트 폴더의 경로를 지정합니다.\n\n중요 참고 사항: 프로젝트 설정 중에 Docker 버전과 Node.js가 충돌하는 특이한 문제가 발생했습니다. 이전 버전의 Docker를 사용하면 Playwright를 실행할 때 예기치 않은 오류가 발생할 수 있습니다. 따라서 프로젝트를 초기화할 때 최신 버전의 Docker 및 Playwright 이미지를 사용하는 것이 권장됩니다.\n\n# Gitlab 파이프라인에서 테스트 실행\n\n변경 사항을 GitLab에 푸시하면 파이프라인에서 이와 유사한 내용이 표시됩니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n\u003cimg src=\"/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_7.png\" /\u003e\n\n실행된 파이프라인에서 테스트 단계를 클릭하면 결과에서 비슷한 로그를 볼 수 있습니다.\n\n\u003cimg src=\"/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_8.png\" /\u003e\n\n# 보고서에 접근하기\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n보고서에 액세스하려면 페이지 우측 하단에 있는 \"찾아보기\" 버튼을 클릭하여 프로젝트 자료를 확인하세요.\n\n![이미지](/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_9.png)\n\n자료에서 \"playwright-report\" 하위에 있는 HTML 보고서를 찾을 수 있습니다.\n\n![이미지](/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_10.png)\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n# 결론\n\n필요하다면 여기서 GitLab 저장소를 찾을 수 있어요.\n\n읽어 주셔서 감사합니다! 이 글을 가능한 한 간단하게 유지하기 위해 노력했어요. 유용하게 찾으셨으면 좋겠어요. 자유롭게 댓글을 남겨주세요. 다음 글에서 만나요! 👋\n","ogImage":{"url":"/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_0.png"},"coverImage":"/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_0.png","tag":["Tech"],"readingTime":9},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_0.png\" alt=\"이미지\"\u003e\u003c/p\u003e\n\u003cp\u003e안녕하세요 여러분, 이 글에서는 도커를 사용하여 Playwright를 설치하고 GitLab에서 실행하는 방법을 설명하겠습니다. Trendyol 프로젝트의 설치 과정 중에 직면한 일부 어려움들도 함께 공유할 것입니다.\u003c/p\u003e\n\u003cp\u003e시작하기 전에 Playwright에 대한 기본 정보와 프로젝트 설치 단계에 대한 기본 사항은 생략할 예정이니 참고해 주세요.\u003c/p\u003e\n\u003ch1\u003e문제점\u003c/h1\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e시작하기 전에, 왜 우리가 도커 이미지에서 테스트를 실행하는지 설명하는 것이 중요합니다. 저희 프로젝트에서는 브랜치별 테스팅을 진행하고 있는데요, 그것은 스프린트 동안 개발 중인 기능 브랜치에 대해 테스트를 실행한다는 것을 의미합니다. 이 기능 브랜치는 테스트 프로젝트 이미지와 함께 풀되어 도커 컨테이너에서 실행되며, 그 후 해당 실행 애플리케이션에 대해 테스트를 실행합니다. 아래에 프로세스를 설명하는 스크린샷과 플로우차트를 포함하였습니다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_1.png\" alt=\"이미지 링크\"\u003e\u003c/p\u003e\n\u003cp\u003e위의 이미지에서 보듯이, 테스트 자동화 단계에서 개발된 브랜치를 풀고, 개발 중인 격리 환경에서 해당 애플리케이션을 실행합니다. 그런 다음 실행 중인 애플리케이션에 대해 테스트를 수행합니다. 이 새로운 개발이 아무 문제를 발생시키지 않았다고 확신을 갖게 되면, 병합 요청을 올리는 과정으로 나아갑니다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_2.png\" alt=\"이미지 링크\"\u003e\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch1\u003e설치\u003c/h1\u003e\n\u003cp\u003e처음에 언급했듯이 설치 과정은 건너뜁니다. 도움이 필요하면 이 문서를 참조해 주세요. Playwright를 설치한 후에는 프로젝트가 다음과 같이 보일 것입니다.\u003c/p\u003e\n\u003cimg src=\"/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_3.png\"\u003e\n\u003cp\u003e로컬에서 테스트를 실행하려면 컴퓨터에 Docker를 설치해야 합니다. 이 링크에서 설치할 수 있습니다.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch1\u003e프로젝트에 Docker 추가하기\u003c/h1\u003e\n\u003cp\u003e이를 실현하기 위해서는 프로젝트에 Dockerfile을 포함시키고 그 단계들을 구성해야 합니다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_4.png\" alt=\"Docker 이미지\"\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-variable constant_\"\u003eFROM\u003c/span\u003e mcr.\u003cspan class=\"hljs-property\"\u003emicrosoft\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ecom\u003c/span\u003e/\u003cspan class=\"hljs-attr\"\u003eplaywright\u003c/span\u003e:v1\u003cspan class=\"hljs-number\"\u003e.44\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e-jammy\n\n\u003cspan class=\"hljs-variable constant_\"\u003eWORKDIR\u003c/span\u003e /app\n\n\u003cspan class=\"hljs-variable constant_\"\u003eCOPY\u003c/span\u003e package*.\u003cspan class=\"hljs-property\"\u003ejson\u003c/span\u003e ./\n\n\u003cspan class=\"hljs-variable constant_\"\u003eRUN\u003c/span\u003e npm ci\n\n\u003cspan class=\"hljs-variable constant_\"\u003eCOPY\u003c/span\u003e . .\n\n\u003cspan class=\"hljs-variable constant_\"\u003eCMD\u003c/span\u003e [\u003cspan class=\"hljs-string\"\u003e\"npx\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"playwright\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"test\"\u003c/span\u003e]\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e이 기사의 대상은 Docker에 대해 처음 접하는 사람부터 Docker 전문가까지 다양합니다. 모두가 명확히 이해할 수 있도록 한 줄씩 설명하겠습니다.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e먼저, 우리는 테스트를 실행하는 데 필요한 모든 것을 포함하는 공식 Playwright 이미지를 가져옵니다.\u003c/li\u003e\n\u003cli\u003e프로젝트를 설치하기 위해 컨테이너 내부에 디렉토리를 만듭니다.\u003c/li\u003e\n\u003cli\u003e작업 디렉토리에 package.json 및 package-lock.json 파일을 복사하여 프로젝트를 올바르게 초기화합니다.\u003c/li\u003e\n\u003cli\u003e필요한 파일을 복사한 후, \"npm ci\"를 실행하여 프로젝트를 컨테이너에 설치합니다.\u003c/li\u003e\n\u003cli\u003e프로젝트를 설치한 후에는 테스트 파일, 구성 파일 등 추가 파일을 컨테이너에 복사합니다.\u003c/li\u003e\n\u003cli\u003e마지막 단계는 Playwright 테스트를 실행하는 명령을 실행하는 것입니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e참고: Docker에서 npm 패키지를 사용할 때 다른 예제에서 발견할 수 있는 것과 달리 \"npm install\" 대신 \"npm ci\"를 사용하는 것이 권장됩니다. 일부 불필요한 단계를 건너뛸 수 있기 때문입니다.\u003c/p\u003e\n\u003ch1\u003e로컬에서 테스트 실행\u003c/h1\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e로컬에서 테스트하려면 먼저 Docker를 시작하고 프로젝트 루트에 생성한 도커 파일을 빌드해야 합니다. VS Code 터미널을 사용하여 다음 명령을 사용하여 도커 파일을 빌드합니다. \"docker build -t playwright-demo .\"\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_5.png\" alt=\"이미지\"\u003e\u003c/p\u003e\n\u003cp\u003e참고: Playwright의 퀵스타트 폴더 \"tests-examples\"를 제거했습니다. 불필요한 테스트 예제 실행을 피하기 위함입니다.\u003c/p\u003e\n\u003cp\u003e이미지가 성공적으로 빌드되면 \"docker run -it — rm playwright-demo\"으로 실행 준비가 완료됩니다.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cimg src=\"/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_6.png\"\u003e\n\u003cp\u003e프로젝트에 테스트를 추가하여 프로세스를 가속화했습니다. 지금 확인해보면 테스트 실행이 완료된 것을 확인할 수 있습니다.\u003c/p\u003e\n\u003ch1\u003eGitlab-ci.yml 구성\u003c/h1\u003e\n\u003cp\u003e프로젝트에 gitlab-ci.yml 파일을 추가하고 이를 구성하여 파이프라인에서 테스트를 실행해봅시다.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-YAML\"\u003e\u003cspan class=\"hljs-string\"\u003e기본값:\u003c/span\u003e\n  \u003cspan class=\"hljs-string\"\u003e이미지:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003edocker:24.0.5\u003c/span\u003e\n  \u003cspan class=\"hljs-string\"\u003e서비스:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003edocker:24.0.5-dind\u003c/span\u003e\n\n\u003cspan class=\"hljs-string\"\u003e변수:\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eDOCKER_HOST:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003etcp://docker:2376\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eDOCKER_TLS_CERTDIR:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"/certs\"\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eDOCKER_DRIVER:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eoverlay2\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eDOCKER_BUILDKIT:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'1'\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eFF_USE_FASTZIP:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"true\"\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eARTIFACT_COMPRESSION_LEVEL:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"fast\"\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eCACHE_COMPRESSION_LEVEL:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"fast\"\u003c/span\u003e\n\n\u003cspan class=\"hljs-string\"\u003e단계:\u003c/span\u003e\n  \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e빌드\u003c/span\u003e\n  \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e테스트\u003c/span\u003e\n\n\u003cspan class=\"hljs-string\"\u003e빌드:\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003estage:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e빌드\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003ebefore_script:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"$CI_REGISTRY_PASSWORD\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e|\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003edocker\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003elogin\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e$CI_REGISTRY\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e-u\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e$CI_REGISTRY_USER\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e--password-stdin\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003escript:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003edocker\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003epull\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e$CI_REGISTRY_IMAGE:latest\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e||\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003edocker\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ebuild\u003c/span\u003e\n      \u003cspan class=\"hljs-string\"\u003e--cache-from\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e$CI_REGISTRY_IMAGE:latest\u003c/span\u003e\n      \u003cspan class=\"hljs-string\"\u003e--tag\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e$CI_REGISTRY_IMAGE:latest\u003c/span\u003e\n      \u003cspan class=\"hljs-string\"\u003e--build-arg\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eBUILDKIT_INLINE_CACHE=1\u003c/span\u003e\n      \u003cspan class=\"hljs-string\"\u003e\".\"\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003edocker\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003epush\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e$CI_REGISTRY_IMAGE:latest\u003c/span\u003e\n\n\u003cspan class=\"hljs-string\"\u003e테스트:\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003estage:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e테스트\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003ebefore_script:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eecho\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"$CI_REGISTRY_PASSWORD\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e|\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003edocker\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003elogin\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e$CI_REGISTRY\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e-u\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e$CI_REGISTRY_USER\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e--password-stdin\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003emkdir\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eplaywright-report\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003emkdir\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003etest-results\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003escript:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003edocker\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003erun\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e--ipc=host\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e--name\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eplaywright-tests\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e$CI_REGISTRY_IMAGE:latest\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eafter_script:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003edocker\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ecp\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eplaywright-tests:app/playwright-report/.\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eplaywright-report\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003edocker\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ecp\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eplaywright-tests:app/test-results/.\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003etest-results\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eallow_failure:\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eartifacts:\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003ewhen:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e항상\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003epaths:\u003c/span\u003e\n      \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eplaywright-report\u003c/span\u003e\n      \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003etest-results\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003eexpire_in:\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e주\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e우리는 Docker 이미지를 정의합니다. 이 섹션 끝에서 몇 가지 중요한 사항을 주목해야 합니다.\u003c/p\u003e\n\u003cp\u003e변수 섹션에서는 주로 Docker 및 그 캐싱 메커니즘과 관련된 변수를 정의하여 이미지를 가져오는 시간을 단축하는 데 도움이 됩니다.\u003c/p\u003e\n\u003cp\u003e파이프라인의 초기 단계에서는 \"before_script\" 섹션 내에서 docker에 로그인하여 이미지를 가져옵니다. Gitlab 이미지 레지스트리에 이미지가 있는 경우에는 캐시에서 가져옵니다. 그렇지 않으면 로컬로 빌드한 다음 미래 빌드를 가속화하기 위해 이미지 레지스트리에 푸시합니다.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e테스트 단계에서는 Docker에 로그인하고 우리의 테스트 결과를 Docker 이미지에서 Gitlab 아티팩트로 전송하기 위해 두 개의 폴더를 생성합니다. 스크립트 섹션에서는 우리의 이미지를 실행하고, 마지막으로 아티팩트 섹션에서 테스트 폴더의 경로를 지정합니다.\u003c/p\u003e\n\u003cp\u003e중요 참고 사항: 프로젝트 설정 중에 Docker 버전과 Node.js가 충돌하는 특이한 문제가 발생했습니다. 이전 버전의 Docker를 사용하면 Playwright를 실행할 때 예기치 않은 오류가 발생할 수 있습니다. 따라서 프로젝트를 초기화할 때 최신 버전의 Docker 및 Playwright 이미지를 사용하는 것이 권장됩니다.\u003c/p\u003e\n\u003ch1\u003eGitlab 파이프라인에서 테스트 실행\u003c/h1\u003e\n\u003cp\u003e변경 사항을 GitLab에 푸시하면 파이프라인에서 이와 유사한 내용이 표시됩니다.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cimg src=\"/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_7.png\"\u003e\n\u003cp\u003e실행된 파이프라인에서 테스트 단계를 클릭하면 결과에서 비슷한 로그를 볼 수 있습니다.\u003c/p\u003e\n\u003cimg src=\"/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_8.png\"\u003e\n\u003ch1\u003e보고서에 접근하기\u003c/h1\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e보고서에 액세스하려면 페이지 우측 하단에 있는 \"찾아보기\" 버튼을 클릭하여 프로젝트 자료를 확인하세요.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_9.png\" alt=\"이미지\"\u003e\u003c/p\u003e\n\u003cp\u003e자료에서 \"playwright-report\" 하위에 있는 HTML 보고서를 찾을 수 있습니다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-23-RunningPlaywrighttestswithDockeronGitLab_10.png\" alt=\"이미지\"\u003e\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch1\u003e결론\u003c/h1\u003e\n\u003cp\u003e필요하다면 여기서 GitLab 저장소를 찾을 수 있어요.\u003c/p\u003e\n\u003cp\u003e읽어 주셔서 감사합니다! 이 글을 가능한 한 간단하게 유지하기 위해 노력했어요. 유용하게 찾으셨으면 좋겠어요. 자유롭게 댓글을 남겨주세요. 다음 글에서 만나요! 👋\u003c/p\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-06-23-RunningPlaywrighttestswithDockeronGitLab"},"buildId":"T_Nz0g9U1yttYMSEma95P","isFallback":false,"gsp":true,"scriptLoader":[{"async":true,"src":"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4877378276818686","strategy":"lazyOnload","crossOrigin":"anonymous"}]}</script></body></html>