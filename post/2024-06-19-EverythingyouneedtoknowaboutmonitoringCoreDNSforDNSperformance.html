<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>DNS ì„±ëŠ¥ì„ ëª¨ë‹ˆí„°ë§í•˜ê¸° ìœ„í•´ ì•Œì•„ì•¼ í•  ëª¨ë“  ê²ƒ | ui-station</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://ui-station.github.io///post/2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="DNS ì„±ëŠ¥ì„ ëª¨ë‹ˆí„°ë§í•˜ê¸° ìœ„í•´ ì•Œì•„ì•¼ í•  ëª¨ë“  ê²ƒ | ui-station" data-gatsby-head="true"/><meta property="og:title" content="DNS ì„±ëŠ¥ì„ ëª¨ë‹ˆí„°ë§í•˜ê¸° ìœ„í•´ ì•Œì•„ì•¼ í•  ëª¨ë“  ê²ƒ | ui-station" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://ui-station.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://ui-station.github.io///post/2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance" data-gatsby-head="true"/><meta name="twitter:title" content="DNS ì„±ëŠ¥ì„ ëª¨ë‹ˆí„°ë§í•˜ê¸° ìœ„í•´ ì•Œì•„ì•¼ í•  ëª¨ë“  ê²ƒ | ui-station" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | ui-station" data-gatsby-head="true"/><meta name="article:published_time" content="2024-06-19 13:07" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-BHFR6GTH9P"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
          
            gtag('config', 'G-BHFR6GTH9P');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b8ef307c9aee1e34.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b8ef307c9aee1e34.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-4a646156c659a948.js" defer=""></script><script src="/_next/static/chunks/348-d11c34b645b13f5b.js" defer=""></script><script src="/_next/static/chunks/162-4172e84c8e2aa747.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-4f7b40c1114f0d09.js" defer=""></script><script src="/_next/static/bb_yO9GbCvdfc_n71SfUf/_buildManifest.js" defer=""></script><script src="/_next/static/bb_yO9GbCvdfc_n71SfUf/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">UI STATION</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">DNS ì„±ëŠ¥ì„ ëª¨ë‹ˆí„°ë§í•˜ê¸° ìœ„í•´ ì•Œì•„ì•¼ í•  ëª¨ë“  ê²ƒ</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="DNS ì„±ëŠ¥ì„ ëª¨ë‹ˆí„°ë§í•˜ê¸° ìœ„í•´ ì•Œì•„ì•¼ í•  ëª¨ë“  ê²ƒ" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">UI STATION</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On Jun 19, 2024</span><span class="posts_reading_time__f7YPP">19<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<p><img src="/assets/img/2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance_0.png" alt="CoreDNS Monitoring"></p>
<h1>ğŸ“š ì†Œê°œ:</h1>
<p>DNS ì§‘ì¤‘ ì›Œí¬ë¡œë“œë¥¼ ì‹¤í–‰í•  ë•Œ ì¢…ì¢… DNS ì“°ë¡œí‹€ë§ì— ì˜í•œ ê°„í—ì ì¸ CoreDNS ì‹¤íŒ¨ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ë¬¸ì œëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì¤‘ëŒ€í•œ ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>ì´ëŸ¬í•œ ì¤‘ë‹¨ì€ ì„œë¹„ìŠ¤ì˜ ì‹ ë¢°ì„±ê³¼ ì„±ëŠ¥ì— ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ëª¨ë‹ˆí„°ë§ ì†”ë£¨ì…˜ì´ í•„ìˆ˜ì ì…ë‹ˆë‹¤.</p>
<p></p>
<p>AWSëŠ” ëª¨ë‹ˆí„°ë§ ëª©ì ìœ¼ë¡œ í†µí•©í•  ìˆ˜ ìˆëŠ” ì˜¤í”ˆ ì†ŒìŠ¤ ë„êµ¬ì¸ CloudWatch, Fluentd ë° Grafanaë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì´ ë„êµ¬ë“¤ì€ CoreDNSë¥¼ ëª¨ë‹ˆí„°ë§í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<h1>Kubernetes DNS ì†Œê°œ:</h1>
<p>KubernetesëŠ” í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ ì„œë¹„ìŠ¤ ê²€ìƒ‰ì— DNSë¥¼ ì˜ì¡´í•©ë‹ˆë‹¤. íŒŸì—ì„œ ì‹¤í–‰ë˜ëŠ” ì‘ìš© í”„ë¡œê·¸ë¨ì´ ì„œë¡œ í†µì‹ í•´ì•¼ í•  ë•Œ, ê·¸ë“¤ì€ ì£¼ë¡œ IP ì£¼ì†Œê°€ ì•„ë‹Œ ë„ë©”ì¸ ì´ë¦„ì„ ì‚¬ìš©í•˜ì—¬ ì„œë¹„ìŠ¤ë¥¼ ì°¸ì¡°í•©ë‹ˆë‹¤.</p>
<p>ì´ ë•Œ Kubernetes DNSê°€ í•„ìš”í•©ë‹ˆë‹¤. ì´ëŠ” ë„ë©”ì¸ ì´ë¦„ì´ ì˜¬ë°”ë¥¸ IP ì£¼ì†Œë¡œ í•´ì„ë˜ë„ë¡ ë³´ì¥í•˜ì—¬ íŒŸê³¼ ì„œë¹„ìŠ¤ê°€ í†µì‹ í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.</p>
<p></p>
<p>Kubernetesì—ì„œëŠ” ê° íŒŒë“œë§ˆë‹¤ ì¼ì‹œì ì¸ IP ì£¼ì†Œê°€ í• ë‹¹ë©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì´ëŸ¬í•œ IP ì£¼ì†ŒëŠ” ë™ì ì´ë©° ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ ë³€ê²½ë  ìˆ˜ ìˆì–´, ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì´ë¥¼ ì¶”ì í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤.</p>
<p>KubernetesëŠ” ì´ëŸ¬í•œ ë„ì „ì— ëŒ€ì‘í•˜ê¸° ìœ„í•´ íŒŒë“œì™€ ì„œë¹„ìŠ¤ì— ì™„ì „íˆ ì •ê·œí™”ëœ ë„ë©”ì¸ ì´ë¦„(FQDNs)ì„ í• ë‹¹í•©ë‹ˆë‹¤.</p>
<p>Kubernetesì˜ ê¸°ë³¸ DNS ì œê³µìì¸ CoreDNSëŠ” í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ DNS ì¿¼ë¦¬ë¥¼ ì²˜ë¦¬í•˜ëŠ” ì—­í• ì„ ë‹´ë‹¹í•©ë‹ˆë‹¤. ê·¸ëŠ” ì´ëŸ¬í•œ FQDNì„ í•´ë‹¹ IP ì£¼ì†Œë¡œ ë§¤í•‘í•˜ì—¬ íŒŒë“œì™€ ì„œë¹„ìŠ¤ ê°„ì˜ í†µì‹ ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.</p>
<h1>ì™œ DNS ë¬¸ì œê°€ í”í• ê¹Œìš”:</h1>
<p></p>
<p>ë„¤íŠ¸ì›Œí¬ ë¬¸ì œ í•´ê²° ì¤‘ ê³µí†µì ìœ¼ë¡œ ë°œìƒí•˜ëŠ” ë²ˆê±°ë¡œì›€ì˜ ì›ì¸ ì¤‘ í•˜ë‚˜ì¸ DNS ë¬¸ì œ! DNSëŠ” ì‚¬ëŒì´ ì½ê¸° ì‰¬ìš´ ë„ë©”ì¸ ì´ë¦„ì„ ê¸°ê³„ê°€ ì´í•´í•  ìˆ˜ ìˆëŠ” IP ì£¼ì†Œë¡œ ë³€í™˜í•˜ëŠ” ë° í° ì—­í• ì„ í•©ë‹ˆë‹¤.</p>
<p>ê·¸ëŸ¬ë‚˜ DNS ë¬¸ì œëŠ” ì„¤ì • ì˜¤ë¥˜, ë„¤íŠ¸ì›Œí¬ ë¬¸ì œ ë˜ëŠ” ì„œë²„ ì¥ì• ì™€ ê°™ì€ ì—¬ëŸ¬ ìš”ì¸ìœ¼ë¡œ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë„ë©”ì¸ ì´ë¦„ì„ ì˜¬ë°”ë¥´ê²Œ í•´ì„í•˜ì§€ ëª»í•  ë•Œ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì™¸ë¶€ ì„œë¹„ìŠ¤ì— ì—°ê²° ë¬¸ì œë¥¼ ê²½í—˜í•˜ê±°ë‚˜ ì•¡ì„¸ìŠ¤ì— ì‹¤íŒ¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<h1>ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ CoreDNS:</h1>
<p>CoreDNSëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ DNS ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ëŠ” ë° ì¤‘ìš”í•œ ì—­í• ì„ í•©ë‹ˆë‹¤. Kubernetes v1.13 ì´í›„ ê¸°ë³¸ DNS ì œê³µìë¡œ ì‚¬ìš©ë˜ì–´ ì˜¨ CoreDNSëŠ” DNS ì´ë¦„ ëŒ€ì‹  IP ì£¼ì†Œ ëŒ€ì‹  DNS ì´ë¦„ì„ ì‚¬ìš©í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë¹„ìŠ¤ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆë„ë¡ í•¨ìœ¼ë¡œì¨ í´ëŸ¬ìŠ¤í„° ë„¤íŠ¸ì›Œí‚¹ì„ ê°„ì†Œí™”í•©ë‹ˆë‹¤. ê·¸ëŠ” ë„ë©”ì¸ ì´ë¦„ ìš”ì²­ì„ í•´ê²°í•˜ê³  í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ ì„œë¹„ìŠ¤ ê²€ìƒ‰ì„ ìš©ì´í•˜ê²Œ í•©ë‹ˆë‹¤.</p>
<p></p>
<h1>ì½”ì–´ë””ì—”ì—ìŠ¤ì˜ ì‘ë™ ë°©ì‹:</h1>
<p>ì½”ì–´ë””ì—”ì—ìŠ¤ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ DNS ìš”ì²­ì˜ ë¦¬ì¡¸ë²„ ë° í¬ì›Œë”ë¡œ ì‘ë™í•©ë‹ˆë‹¤. íŒŒë“œê°€ ë‹¤ë¥¸ ì„œë¹„ìŠ¤ì™€ í†µì‹ í•´ì•¼ í•  ë•Œ, ëŒ€ìƒ ì„œë¹„ìŠ¤ì˜ ë„ë©”ì¸ ì´ë¦„ì„ ì§€ì •í•˜ì—¬ DNS ì¿¼ë¦¬ë¥¼ ì½”ì–´ë””ì—”ì—ìŠ¤ì— ë³´ëƒ…ë‹ˆë‹¤. ê·¸ëŸ¼ ì½”ì–´ë””ì—”ì—ìŠ¤ëŠ” ë‚´ë¶€ ë ˆì½”ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ë„ë©”ì¸ ì´ë¦„ì„ í•´ë‹¹ IP ì£¼ì†Œë¡œ ë§¤í•‘í•˜ì—¬ ì´ ì¿¼ë¦¬ë¥¼ í•´ê²°í•©ë‹ˆë‹¤.</p>
<p>ì½”ì–´ë””ì—”ì—ìŠ¤ê°€ ê¶Œí•œì´ ì—†ëŠ” ì™¸ë¶€ ë„ë©”ì¸ ì´ë¦„ì— ëŒ€í•´ì„œëŠ”, ì´ë¥¼ ê³µê°œ ë¦¬ì¡¸ë²„ë‚˜ ìƒìœ„ DNS ì„œë²„ë¡œ ì „ë‹¬í•˜ì—¬ í•´ê²°í•©ë‹ˆë‹¤.</p>
<p>ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¤ê³  ëŒ€ê¸° ì‹œê°„ì„ ì¤„ì´ê¸° ìœ„í•´ ì½”ì–´ë””ì—”ì—ìŠ¤ëŠ” ìì£¼ ì•¡ì„¸ìŠ¤í•˜ëŠ” ë„ë©”ì¸ ì´ë¦„ì— ëŒ€í•œ DNS ì‘ë‹µì„ ìºì‹œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ìºì‹± ë©”ì»¤ë‹ˆì¦˜ì€ DNS ì¿¼ë¦¬ì˜ ì‘ë‹µ ì†ë„ë¥¼ í–¥ìƒì‹œí‚¤ê³  ìƒìœ„ DNS ì„œë²„ì˜ ë¶€í•˜ë¥¼ ì¤„ì…ë‹ˆë‹¤.</p>
<p></p>
<p>CoreDNSëŠ” ì´ ê¸°ëŠ¥ì„ ëª¨ë“ˆì‹ ì•„í‚¤í…ì²˜ì™€ í™•ì¥ ê°€ëŠ¥í•œ í”ŒëŸ¬ê·¸ì¸ ì‹œìŠ¤í…œì„ í†µí•´ êµ¬í˜„í•˜ë©°, ìš´ì˜ìê°€ ë…ìì ì¸ ìš”êµ¬ ì‚¬í•­ì— ë”°ë¼ DNS í•´ìƒë„ë¥¼ ì‚¬ìš©ì ì •ì˜í•˜ê³  ìµœì í™”í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤.</p>
<h1>Amazon EKSì—ì„œì˜ CoreDNS ì“°ë¡œí‹€ë§ ì™„í™” ë°©ë²•:</h1>
<p>Amazon EKS í´ëŸ¬ìŠ¤í„°ì—ì„œ CoreDNSì™€ DNS ì“°ë¡œí‹€ë§ ë¬¸ì œëŠ” ì‹ë³„í•˜ê³  í•´ê²°í•˜ê¸° ì–´ë ¤ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë§ì€ ì‚¬ìš©ìê°€ CoreDNS ë¡œê·¸ì™€ ë©”íŠ¸ë¦­ì„ ëª¨ë‹ˆí„°ë§í•˜ëŠ” ë° ì£¼ë ¥í•˜ì§€ë§Œ, ì—˜ë¼ìŠ¤í‹± ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤(ENI) ìˆ˜ì¤€ì—ì„œ ê°•ì œë˜ëŠ” ì´ˆë‹¹ 1024ê°œ íŒ¨í‚·(PPS)ì˜ í•˜ë“œ ì œí•œì„ ìì£¼ ê°„ê³¼í•©ë‹ˆë‹¤. ì´ í•œê³„ê°€ ì“°ë¡œí‹€ë§ ë¬¸ì œë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆëŠ” ë°©ì‹ì„ ì´í•´í•˜ë ¤ë©´ Kubernetes íŒŒë“œì˜ ì „í˜•ì ì¸ DNS í•´ìƒë„ íë¦„ì— ëŒ€í•œ í†µì°°ë ¥ì´ í•„ìš”í•©ë‹ˆë‹¤.</p>
<p>Kubernetes í™˜ê²½ì—ì„œëŠ” íŒŒë“œê°€ í†µì‹ ì„ ê°€ëŠ¥í•˜ê²Œ í•˜ê¸° ìœ„í•´ ë‚´ë¶€ ë° ì™¸ë¶€ ì„œë¹„ìŠ¤ì˜ ë„ë©”ì¸ ì´ë¦„ì„ í•´ìƒí•´ì•¼ í•©ë‹ˆë‹¤. ì´ í•´ìƒë„ í”„ë¡œì„¸ìŠ¤ëŠ” DNS ì¿¼ë¦¬ë¥¼ ì›Œì»¤ ë…¸ë“œì˜ ENIë¥¼ í†µí•´ ë¼ìš°íŒ…í•˜ëŠ” ê²ƒì„ í¬í•¨í•˜ë©°, íŠ¹íˆ ì™¸ë¶€ ì—”ë“œí¬ì¸íŠ¸ë¥¼ í•´ìƒí•˜ëŠ” ê²½ìš°ì…ë‹ˆë‹¤. ë‚´ë¶€ ì—”ë“œí¬ì¸íŠ¸ì˜ ê²½ìš°ì—ë„ ì¿¼ë¦¬í•˜ëŠ” íŒŒë“œì™€ ë™ì¼í•œ ìœ„ì¹˜ì— CoreDNS íŒŒë“œê°€ ì—†ìœ¼ë©´ DNS íŒ¨í‚·ì´ ì—¬ì „íˆ ì›Œì»¤ ë…¸ë“œì˜ ENIë¥¼ í†µí•´ ì´ë™í•©ë‹ˆë‹¤.</p>
<p></p>
<p>ê°‘ìê¸° DNS ì¿¼ë¦¬ê°€ ê¸‰ì¦í•˜ì—¬ PPSê°€ í•˜ë“œ ì œí•œê°’ 1024ì— ì ‘ê·¼í•˜ëŠ” ìƒí™©ì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ìƒí™©ì€ DNS ì“°ë¡œí‹€ë§ì„ ìœ ë°œí•  ìˆ˜ ìˆìœ¼ë©°, ì´ë¡œ ì¸í•´ ì˜í–¥ì„ ë°›ëŠ” ì‘ì—… ë…¸ë“œì—ì„œ ì‹¤í–‰ ì¤‘ì¸ ëª¨ë“  ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ì— ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìœ ê°ìŠ¤ëŸ½ê²Œë„, ì´ëŸ¬í•œ ë¬¸ì œ í•´ê²°ì€ ì£¼ë¡œ CoreDNS podì— ì´ˆì ì„ ë§ì¶”ëŠ” ENI ë©”íŠ¸ë¦­ë³´ë‹¤ ì–´ë ¤ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>EKS í´ëŸ¬ìŠ¤í„°ì—ì„œ DNS ì“°ë¡œí‹€ë§ ë¬¸ì œë¥¼ ì™„í™”í•˜ê¸° ìœ„í•´ì„œëŠ” ENI ìˆ˜ì¤€ì—ì„œ ë°œìƒí•˜ëŠ” íŒ¨í‚· ì†ì‹¤ì„ ì§€ì†ì ìœ¼ë¡œ ëª¨ë‹ˆí„°ë§í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤. ì´ ëª¨ë‹ˆí„°ë§ì„ í†µí•´ ì ì¬ì ì¸ ì¤‘ë‹¨ì„ ì¡°ê¸°ì— ê°ì§€í•˜ê³  ì˜ˆë°©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ì—ì„œëŠ” ë„¤íŠ¸ì›Œí¬ ì„±ëŠ¥ ë©”íŠ¸ë¦­ì„ í™œìš©í•˜ì—¬ DNS ì“°ë¡œí‹€ë§ ë¬¸ì œë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ì‹ë³„í•˜ëŠ” ì†”ë£¨ì…˜ì„ ì†Œê°œí•©ë‹ˆë‹¤.</p>
<h2>í•´ê²°ì±…: ğŸ‰</h2>
<p>ì‘ì—… ë…¸ë“œì—ì„œ DNS ì“°ë¡œí‹€ë§ ë¬¸ì œë¥¼ ì‹ë³„í•˜ëŠ” ê°„ë‹¨í•œ ë°©ë²•ì€ Elastic Network Adapter (ENA) ë“œë¼ì´ë²„ì—ì„œ ì œê³µí•˜ëŠ” linklocal_allowance_exceeded ë©”íŠ¸ë¦­ ë° ë‹¤ë¥¸ ë©”íŠ¸ë¦­ì„ ìº¡ì²˜í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.</p>
<p></p>
<p><code>linklocal_allowance_exceeded</code>ì€ ë¡œì»¬ í”„ë¡ì‹œ ì„œë¹„ìŠ¤ë¡œì˜ íŠ¸ë˜í”½ PPSê°€ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ì˜ ìµœëŒ€ë¥¼ ì´ˆê³¼í•˜ì—¬ ë“œë¡­ëœ íŒ¨í‚· ìˆ˜ì…ë‹ˆë‹¤. ì´ëŠ” DNS ì„œë¹„ìŠ¤, ì¸ìŠ¤í„´ìŠ¤ ë©”íƒ€ë°ì´í„° ì„œë¹„ìŠ¤ ë° Amazon ì‹œê°„ ë™ê¸°í™” ì„œë¹„ìŠ¤ë¡œì˜ íŠ¸ë˜í”½ì— ì˜í–¥ì„ ì¤ë‹ˆë‹¤.</p>
<p>ì´ ì´ë²¤íŠ¸ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ì¶”ì í•˜ëŠ” ëŒ€ì‹ , ìš°ë¦¬ëŠ” ì´ ë©”íŠ¸ë¦­ì„ Amazon Managed Service for Prometheusë¡œ ìŠ¤íŠ¸ë¦¬ë°í•˜ê³  Amazon Managed Grafanaì—ì„œ ì‹œê°í™”í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.</p>
<p><img src="/assets/img/2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance_1.png" alt="ì´ë¯¸ì§€"></p>
<h1>ì‹¤ì „: AWS EKSì—ì„œ CoreDNS ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ë° ì‹œê°í™”:</h1>
<p></p>
<p>CoreDNS í”„ë¡œë©”í…Œìš°ìŠ¤ í”ŒëŸ¬ê·¸ì¸ì€ OpenMetrics í˜•ì‹ìœ¼ë¡œ ë©”íŠ¸ë¦­ì„ ë…¸ì¶œí•˜ë©°, ì´ëŠ” í”„ë¡œë©”í…Œìš°ìŠ¤ í˜•ì‹ì—ì„œ ë°œì „í•œ í…ìŠ¤íŠ¸ ê¸°ë°˜ í‘œì¤€ì…ë‹ˆë‹¤. Kubernetes í´ëŸ¬ìŠ¤í„°ì—ì„œëŠ” í”ŒëŸ¬ê·¸ì¸ì´ ê¸°ë³¸ì ìœ¼ë¡œ í™œì„±í™”ë˜ì–´ ìˆì–´ í´ëŸ¬ìŠ¤í„°ë¥¼ ì‹œì‘í•˜ëŠ” ì¦‰ì‹œ ë§ì€ ì¤‘ìš”í•œ ë©”íŠ¸ë¦­ì„ ëª¨ë‹ˆí„°ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>ê¸°ë³¸ ì„¤ì •ì—ì„œ í”„ë¡œë©”í…Œìš°ìŠ¤ í”ŒëŸ¬ê·¸ì¸ì€ ê° CoreDNS íŒŸì˜ í¬íŠ¸ 9153ì— ìˆëŠ” /metrics ì—”ë“œí¬ì¸íŠ¸ì— ë©”íŠ¸ë¦­ì„ ê¸°ë¡í•©ë‹ˆë‹¤.</p>
<p>Amazon Managed Service for Prometheus ì›Œí¬ìŠ¤í˜ì´ìŠ¤ì™€ Managed Service for Grafanaë¥¼ ìƒì„±í•˜ì„¸ìš”:</p>
<p>ì´ ë‹¨ê³„ì—ì„œëŠ” Amazon Managed Service for Prometheus ë° Managed Service for Grafanaë¥¼ ìœ„í•œ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.</p>
<p></p>
<p>ì´ íŒŒì¼ êµ¬ì„±ì€ ë‹¤ìŒì„ ìƒì„±í•©ë‹ˆë‹¤:</p>
<ul>
<li>AMP ì‘ì—… ê³µê°„</li>
<li>AMP ê²½ë³´ ê´€ë¦¬ì ì •ì˜.</li>
</ul>
<p>main.tf:</p>
<pre><code class="hljs language-js"><span class="hljs-variable language_">module</span> <span class="hljs-string">"prometheus"</span> {
  source = <span class="hljs-string">"terraform-aws-modules/managed-service-prometheus/aws"</span>

  workspace_alias = <span class="hljs-string">"demo-coredns"</span>

  alert_manager_definition = &#x3C;&#x3C;-<span class="hljs-variable constant_">EOT</span>
  <span class="hljs-attr">alertmanager_config</span>: |
    <span class="hljs-attr">route</span>:
      <span class="hljs-attr">receiver</span>: <span class="hljs-string">'default'</span>
    <span class="hljs-attr">receivers</span>:
      - <span class="hljs-attr">name</span>: <span class="hljs-string">'default'</span>
  <span class="hljs-variable constant_">EOT</span>

  rule_group_namespaces = {}
}
</code></pre>
<p></p>
<p>versions.tf:</p>
<pre><code class="hljs language-js">terraform {
  required_version = <span class="hljs-string">">= 1.3"</span>

  required_providers {
    aws = {
      source  = <span class="hljs-string">"hashicorp/aws"</span>
      version = <span class="hljs-string">">= 5.32"</span>
    }
  }
}
</code></pre>
<p>í…Œë¼í¼ì„ ì‹¤í–‰í•˜ë ¤ë©´ ë‹¤ìŒì„ ì‹¤í–‰í•´ì•¼ í•©ë‹ˆë‹¤:</p>
<pre><code class="hljs language-js">$ terraform init
$ terraform plan
$ terraform apply
</code></pre>
<p></p>
<p>ì•„ë˜ êµ¬ì„± íŒŒì¼ì€ ë‹¤ìŒê³¼ ê°™ì€ ê²ƒì„ ìƒì„±í•©ë‹ˆë‹¤:</p>
<ul>
<li>ê¸°ë³¸ Grafana ì‘ì—… ê³µê°„ (ëª¨ë“ˆì—ì„œ ì œê³µí•˜ëŠ” ê¸°ë³¸ê°’ ì‚¬ìš©)</li>
</ul>
<p>main.tf:</p>
<pre><code class="hljs language-js">provider <span class="hljs-string">"aws"</span> {
  region = local.<span class="hljs-property">region</span>
}

data <span class="hljs-string">"aws_availability_zones"</span> <span class="hljs-string">"available"</span> {}

locals {
  region      = <span class="hljs-string">"eu-west-1"</span>
  name        = <span class="hljs-string">"amg-ex-${replace(basename(path.cwd), "</span>_<span class="hljs-string">", "</span>-<span class="hljs-string">")}"</span>
  description = <span class="hljs-string">"AWS Managed Grafana service for ${local.name}"</span>

  vpc_cidr = <span class="hljs-string">"10.0.0.0/16"</span>
  azs      = <span class="hljs-title function_">slice</span>(data.<span class="hljs-property">aws_availability_zones</span>.<span class="hljs-property">available</span>.<span class="hljs-property">names</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>)
}

################################################################################
# <span class="hljs-title class_">Managed</span> <span class="hljs-title class_">Grafana</span> <span class="hljs-title class_">Module</span>
################################################################################

<span class="hljs-variable language_">module</span> <span class="hljs-string">"managed_grafana"</span> {
  source = <span class="hljs-string">"terraform-aws-modules/managed-service-grafana/aws"</span>

  # <span class="hljs-title class_">Workspace</span>
  name                      = local.<span class="hljs-property">name</span>
  associate_license         = <span class="hljs-literal">false</span>
  description               = local.<span class="hljs-property">description</span>
  account_access_type       = <span class="hljs-string">"CURRENT_ACCOUNT"</span>
  authentication_providers  = [<span class="hljs-string">"AWS_SSO"</span>]
  permission_type           = <span class="hljs-string">"SERVICE_MANAGED"</span>
  data_sources              = [<span class="hljs-string">"CLOUDWATCH"</span>, <span class="hljs-string">"PROMETHEUS"</span>, <span class="hljs-string">"XRAY"</span>]
  notification_destinations = [<span class="hljs-string">"SNS"</span>]
  stack_set_name            = local.<span class="hljs-property">name</span>
  grafana_version           = <span class="hljs-string">"9.4"</span>

  configuration = <span class="hljs-title function_">jsonencode</span>({
    unifiedAlerting = {
      enabled = <span class="hljs-literal">true</span>
    },
    plugins = {
      pluginAdminEnabled = <span class="hljs-literal">false</span>
    }
  })

  # vpc configuration
  vpc_configuration = {
    subnet_ids = <span class="hljs-variable language_">module</span>.<span class="hljs-property">vpc</span>.<span class="hljs-property">private_subnets</span>
  }
  security_group_rules = {
    egress_postgresql = {
      description = <span class="hljs-string">"Allow egress to PostgreSQL"</span>
      from_port   = <span class="hljs-number">5432</span>
      to_port     = <span class="hljs-number">5432</span>
      protocol    = <span class="hljs-string">"tcp"</span>
      cidr_blocks = <span class="hljs-variable language_">module</span>.<span class="hljs-property">vpc</span>.<span class="hljs-property">private_subnets_cidr_blocks</span>
    }
  }

  # <span class="hljs-title class_">Workspace</span> <span class="hljs-variable constant_">API</span> keys
  workspace_api_keys = {
    viewer = {
      key_name        = <span class="hljs-string">"viewer"</span>
      key_role        = <span class="hljs-string">"VIEWER"</span>
      seconds_to_live = <span class="hljs-number">3600</span>
    }
    editor = {
      key_name        = <span class="hljs-string">"editor"</span>
      key_role        = <span class="hljs-string">"EDITOR"</span>
      seconds_to_live = <span class="hljs-number">3600</span>
    }
    admin = {
      key_name        = <span class="hljs-string">"admin"</span>
      key_role        = <span class="hljs-string">"ADMIN"</span>
      seconds_to_live = <span class="hljs-number">3600</span>
    }
  }

  # <span class="hljs-title class_">Workspace</span> <span class="hljs-variable constant_">IAM</span> role
  create_iam_role                = <span class="hljs-literal">true</span>
  iam_role_name                  = local.<span class="hljs-property">name</span>
  use_iam_role_name_prefix       = <span class="hljs-literal">true</span>
  iam_role_description           = local.<span class="hljs-property">description</span>
  iam_role_path                  = <span class="hljs-string">"/grafana/"</span>
  iam_role_force_detach_policies = <span class="hljs-literal">true</span>
  iam_role_max_session_duration  = <span class="hljs-number">7200</span>
  iam_role_tags                  = { role = <span class="hljs-literal">true</span> }


  tags = local.<span class="hljs-property">tags</span>
}

<span class="hljs-variable language_">module</span> <span class="hljs-string">"managed_grafana_default"</span> {
  source = <span class="hljs-string">"terraform-aws-modules/managed-service-grafana/aws"</span>

  name              = <span class="hljs-string">"${local.name}-default"</span>
  associate_license = <span class="hljs-literal">false</span>

  tags = local.<span class="hljs-property">tags</span>
}

<span class="hljs-variable language_">module</span> <span class="hljs-string">"managed_grafana_disabled"</span> {
  source = <span class="hljs-string">"terraform-aws-modules/managed-service-grafana/aws"</span>

  name   = local.<span class="hljs-property">name</span>
  create = <span class="hljs-literal">false</span>
}

################################################################################
# <span class="hljs-title class_">Supporting</span> <span class="hljs-title class_">Resources</span>
################################################################################

<span class="hljs-variable language_">module</span> <span class="hljs-string">"vpc"</span> {
  source  = <span class="hljs-string">"terraform-aws-modules/vpc/aws"</span>
  version = <span class="hljs-string">"~> 5.0"</span>

  name = local.<span class="hljs-property">name</span>
  cidr = local.<span class="hljs-property">vpc_cidr</span>

  azs             = local.<span class="hljs-property">azs</span>
  private_subnets = [<span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> local.<span class="hljs-property">azs</span> : <span class="hljs-title function_">cidrsubnet</span>(local.<span class="hljs-property">vpc_cidr</span>, <span class="hljs-number">4</span>, k)]
  public_subnets  = [<span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> local.<span class="hljs-property">azs</span> : <span class="hljs-title function_">cidrsubnet</span>(local.<span class="hljs-property">vpc_cidr</span>, <span class="hljs-number">8</span>, k + <span class="hljs-number">48</span>)]

  enable_nat_gateway = <span class="hljs-literal">false</span>
  single_nat_gateway = <span class="hljs-literal">true</span>

  tags = local.<span class="hljs-property">tags</span>
}
</code></pre>
<p></p>
<p>"versions.tf" íŒŒì¼ì…ë‹ˆë‹¤:</p>
<pre><code class="hljs language-js">terraform {
  required_version = <span class="hljs-string">">= 1.0"</span>

  required_providers {
    aws = {
      source  = <span class="hljs-string">"hashicorp/aws"</span>
      version = <span class="hljs-string">">= 5.0"</span>
    }
  }
}
</code></pre>
<p>ì´ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë ¤ë©´ ë‹¤ìŒì„ ì‹¤í–‰í•´ì•¼ í•©ë‹ˆë‹¤:</p>
<pre><code class="hljs language-js">$ terraform init
$ terraform plan
$ terraform apply
</code></pre>
<p></p>
<p>í”„ë¡œë©”í…Œìš°ìŠ¤ ethtool ìµìŠ¤í¬í„° ë°°ì¹˜:</p>
<p>ethtoolì€ ì›Œì»¤ ë…¸ë“œì˜ ì´ë”ë„· ì¥ì¹˜ì— ëŒ€í•œ ì •ë³´ë¥¼ êµ¬ì„±í•˜ê³  ìˆ˜ì§‘í•˜ëŠ” ë¦¬ëˆ…ìŠ¤ ë„êµ¬ì…ë‹ˆë‹¤. ìš°ë¦¬ëŠ” ethtoolì˜ ì¶œë ¥ì„ ì‚¬ìš©í•˜ì—¬ íŒ¨í‚· ì†ì‹¤ì„ ê°ì§€í•˜ê³  ì´ë¥¼ í”„ë¡œë©”í…Œìš°ìŠ¤ ethtool ìµìŠ¤í¬í„° ìœ í‹¸ë¦¬í‹°ë¥¼ ì‚¬ìš©í•˜ì—¬ í”„ë¡œë©”í…Œìš°ìŠ¤ í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•  ê²ƒì…ë‹ˆë‹¤.</p>
<p>ë°°í¬ì—ëŠ” ethtoolì—ì„œ ì •ë³´ë¥¼ ê°€ì ¸ ì™€ì„œ í”„ë¡œë©”í…Œìš°ìŠ¤ í˜•ì‹ìœ¼ë¡œ ê²Œì‹œí•˜ëŠ” Python ìŠ¤í¬ë¦½íŠ¸ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p>
<pre><code class="hljs language-js">kubectl apply -f <span class="hljs-attr">https</span>:<span class="hljs-comment">//raw.githubusercontent.com/Showmax/prometheus-ethtool-exporter/master/deploy/k8s-daemonset.yaml</span>
</code></pre>
<p></p>
<p>ì´ì œ ADOT ìˆ˜ì§‘ê¸°ë¥¼ ë°°í¬í•˜ê³  ADOT ìˆ˜ì§‘ê¸°ë¥¼ êµ¬ì„±í•˜ì—¬ Amazon Managed Service for Prometheusë¡œ ë©”íŠ¸ë¦­ì„ ìˆ˜ì§‘í•  ê²ƒì…ë‹ˆë‹¤.</p>
<p>ìš°ë¦¬ëŠ” Amazon EKS ì• ë“œì˜¨ì„ ì‚¬ìš©í•˜ì—¬ ADOT ì˜¤í¼ë ˆì´í„°ë¥¼ CoreDNS ëª¨ë‹ˆí„°ë§ì„ ìœ„í•´ ë©”íŠ¸ë¦­ "linklocal_allowance_exceeded"ë¥¼ Amazon Managed Service for Prometheusë¡œ ë³´ë‚´ê²Œ ë  ê²ƒì…ë‹ˆë‹¤.</p>
<p>IAM ì—­í• ê³¼ Amazon EKS ì„œë¹„ìŠ¤ ê³„ì •ì„ ìƒì„±í•˜ì„¸ìš”.</p>
<p></p>
<p>ADOT ìˆ˜ì§‘ê¸°ë¥¼ Kubernetes ì„œë¹„ìŠ¤ ê³„ì • "adot-collector"ì˜ ì‹ ì›ìœ¼ë¡œ ë°°í¬í•  ì˜ˆì •ì…ë‹ˆë‹¤. ì„œë¹„ìŠ¤ ê³„ì •ì— IAM ì—­í• (IRSA)ì„ ì—°ê²°í•˜ì—¬ Kubernetes ì„œë¹„ìŠ¤ ê³„ì •ì— AmazonPrometheusRemoteWriteAccess ì—­í• ì„ í• ë‹¹í•¨ìœ¼ë¡œì¨ í•´ë‹¹ ì„œë¹„ìŠ¤ ê³„ì •ì„ í™œìš©í•˜ëŠ” ëª¨ë“  íŒŒë“œê°€ Amazon Managed Service for Prometheusì— ë©”íŠ¸ë¦­ì„ ìˆ˜ì§‘í•˜ëŠ” ë° í•„ìš”í•œ IAM ê¶Œí•œì„ ë¶€ì—¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ë ¤ë©´ kubectl ë° eksctl CLI ë„êµ¬ê°€ í•„ìš”í•©ë‹ˆë‹¤. ì´ ë„êµ¬ë“¤ì€ Amazon EKS í´ëŸ¬ìŠ¤í„°ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆë„ë¡ êµ¬ì„±ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.</p>
<pre><code class="hljs language-js">eksctl create iamserviceaccount \
--name adot-collector \
--namespace <span class="hljs-keyword">default</span> \
--region eu-west-<span class="hljs-number">1</span>\
--cluster coredns-monitoring-demo\
--attach-policy-arn <span class="hljs-attr">arn</span>:<span class="hljs-attr">aws</span>:<span class="hljs-attr">iam</span>::<span class="hljs-attr">aws</span>:policy/<span class="hljs-title class_">AmazonPrometheusRemoteWriteAccess</span> \
--approve \
--override-existing-serviceaccounts
</code></pre>
<p>ADOT ì• ë“œì˜¨ ì„¤ì¹˜í•˜ê¸°:</p>
<p></p>
<p>ì—¬ëŸ¬ë¶„ì€ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ Amazon EKSì˜ ë‹¤ë¥¸ ë²„ì „ì— í™œì„±í™”ëœ ì• ë“œì˜¨ ëª©ë¡ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<p>í´ëŸ¬ìŠ¤í„° ë²„ì „ì—ì„œ ì§€ì›í•˜ëŠ” ADOT ë²„ì „ì„ í™•ì¸í•˜ì‹­ì‹œì˜¤.</p>
<pre><code class="hljs language-js">aws eks describe-addon-versions --addon-name adot --kubernetes-version <span class="hljs-number">1.28</span> \
  --query <span class="hljs-string">"addons[].addonVersions[].[addonVersion, compatibilities[].defaultVersion]"</span> --output text
</code></pre>
<p>ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ ADOT ì• ë“œì˜¨ì„ ì„¤ì¹˜í•˜ì‹­ì‹œì˜¤. ìœ„ ë‹¨ê³„ì—ì„œ ê¸°ìˆ ëœ ê²ƒì— ë”°ë¼ --addon-version í”Œë˜ê·¸ë¥¼ êµì²´í•˜ì‹­ì‹œì˜¤.</p>
<p></p>
<pre><code class="hljs language-js">aws eks create-addon --addon-name adot --addon-version v0<span class="hljs-number">.66</span><span class="hljs-number">.0</span>-eksbuild<span class="hljs-number">.1</span> --cluster-name coredns-monitoring-demo
</code></pre>
<p>ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ ADOT ì• ë“œì˜¨ì´ ì¤€ë¹„ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.</p>
<pre><code class="hljs language-js">kubectl get po -n opentelemetry-operator-system
</code></pre>
<p>ë‹¤ìŒ ì ˆì°¨ëŠ” ë°°í¬ë¥¼ ëª¨ë“œ ê°’ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ì˜ˆì œ YAML íŒŒì¼ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ì´ëŠ” ê¸°ë³¸ ëª¨ë“œì´ë©° ADOT Collectorë¥¼ ë…ë¦½ ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ ìœ ì‚¬í•˜ê²Œ ë°°í¬í•©ë‹ˆë‹¤. ì´ êµ¬ì„±ì€ ìƒ˜í”Œ ì• í”Œë¦¬ì¼€ì´ì…˜ìœ¼ë¡œë¶€í„° OTLP ë©”íŠ¸ë¦­ì„ ìˆ˜ì‹ í•˜ê³  í´ëŸ¬ìŠ¤í„°ì˜ podì—ì„œ ìŠ¤í¬ë˜í•‘ëœ Amazon Managed Service for Prometheus ë©”íŠ¸ë¦­ì„ ìˆ˜ì‹ í•©ë‹ˆë‹¤.</p>
<p></p>
<p>curl -o collector-config-amp.yaml <a href="https://raw.githubusercontent.com/aws-observability/aws-otel-community/master/sample-configs/operator/collector-config-amp.yaml" rel="nofollow" target="_blank">https://raw.githubusercontent.com/aws-observability/aws-otel-community/master/sample-configs/operator/collector-config-amp.yaml</a></p>
<p>collector-config-amp.yaml íŒŒì¼ì—ì„œ ë‹¤ìŒì„ ë³¸ì¸ì˜ ê°’ìœ¼ë¡œ ë°”ê¿”ì£¼ì„¸ìš”: _ mode: deployment _ serviceAccount: adot-collector _ endpoint: "" _ region: "" * name: adot-collector</p>
<p>kubectl apply -f collector-config-amp.yaml</p>
<p>adot collectorê°€ ë°°í¬ë˜ë©´ ë©”íŠ¸ë¦­ì´ Amazon Prometheusì— ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤.</p>
<p></p>
<p>Amazon Managed Grafanaì—ì„œ ethtool ë©”íŠ¸ë¦­ì„ ì‹œê°í™”í•´ë³´ì„¸ìš”:</p>
<p>Amazon Managed Grafana ì½˜ì†” ë‚´ì—ì„œ Prometheus ì›Œí¬ìŠ¤í˜ì´ìŠ¤ë¥¼ ë°ì´í„° ì†ŒìŠ¤ë¡œ êµ¬ì„±í•©ë‹ˆë‹¤.</p>
<p>ì´ì œ Amazon Managed Grafanaì—ì„œ ë©”íŠ¸ë¦­ì„ ì‚´í´ë´…ì‹œë‹¤: "íƒìƒ‰" ë²„íŠ¼ì„ í´ë¦­í•œ í›„ ethtoolì„ ê²€ìƒ‰í•˜ì„¸ìš”:</p>
<p><img src="/assets/img/2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance_2.png" alt="ì´ë¯¸ì§€"></p>
<p></p>
<p>ë§í¬ë¡œì»¬ í• ë‹¹ ì´ˆê³¼ ë©”íŠ¸ë¦­ì„ ì‚¬ìš©í•˜ì—¬ ëŒ€ì‹œë³´ë“œë¥¼ ë§Œë“¤ì–´ ë´…ì‹œë‹¤. ì¿¼ë¦¬ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>
<pre><code class="hljs language-js"><span class="hljs-title function_">rate</span>(node_net_ethtool{device=<span class="hljs-string">"eth0"</span>,type=<span class="hljs-string">"linklocal_allowance_exceeded"</span>} [30s])
</code></pre>
<p><img src="/assets/img/2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance_3.png" alt="ì´ë¯¸ì§€"></p>
<p>ê°’ì´ 0ì´ê¸° ë•Œë¬¸ì— ë“œëëœ íŒ¨í‚·ì´ ì—†ë‹¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Amazon Managed Service for Prometheusì˜ ê²½ê³  ê´€ë¦¬ìì—ì„œ ì•Œë¦¼ì„ êµ¬ì„±í•˜ì—¬ ì•Œë¦¼ì„ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p></p>
<h1>ê²°ë¡ :</h1>
<p>ì´ ê¸€ì—ì„œëŠ” AWS Distro for OpenTelemetry (ADOT), Amazon Managed Service for Prometheus ë° Amazon Managed Grafanaë¥¼ ì‚¬ìš©í•˜ì—¬ CoreDNS ì“°ë¡œí‹€ë§ ë¬¸ì œë¥¼ ëª¨ë‹ˆí„°ë§í•˜ê³  ê²½ê³ ë¥¼ ìƒì„±í•˜ëŠ” ë°©ë²•ì„ ë³´ì—¬ë“œë ¸ìŠµë‹ˆë‹¤. CoreDNS ë©”íŠ¸ë¦­ì„ ëª¨ë‹ˆí„°ë§í•¨ìœ¼ë¡œì¨ ê³ ê°ì€ íŒ¨í‚· ì†ì‹¤ì„ ì‚¬ì „ì— ê°ì§€í•˜ê³  ì˜ˆë°© ì¡°ì¹˜ë¥¼ ì·¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>ë‹¤ìŒì— ë˜ ë§Œë‚˜ìš” ğŸ‡µğŸ‡¸ ğŸ‰</p>
<p><img src="/assets/img/2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance_4.png" alt="ì´ë¯¸ì§€"></p>
<p></p>
<p>ì½ì–´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤!! ğŸ™ŒğŸ»ğŸ˜ğŸ“ƒ, ë‹¤ìŒ ë¸”ë¡œê·¸ì—ì„œ ë§Œë‚˜ìš”.ğŸ¤˜ğŸ‡µğŸ‡¸</p>
<p>ğŸš€ ëê¹Œì§€ í•¨ê»˜í•´ ì¤˜ì„œ ê°ì‚¬í•©ë‹ˆë‹¤. ì´ ë¸”ë¡œê·¸ì— ê´€í•œ ì§ˆë¬¸/í”¼ë“œë°±ì´ ìˆìœ¼ë©´ ì–¸ì œë“ ì§€ ì—°ë½í•´ ì£¼ì„¸ìš”:</p>
<p>â™»ï¸ ğŸ‡µğŸ‡¸LinkedIn: <a href="https://www.linkedin.com/in/rajhi-saif/" rel="nofollow" target="_blank">https://www.linkedin.com/in/rajhi-saif/</a></p>
<p>â™»ï¸ğŸ‡µğŸ‡¸ Twitter : <a href="https://twitter.com/rajhisaifeddine" rel="nofollow" target="_blank">https://twitter.com/rajhisaifeddine</a></p>
<p></p>
<p>ë! âœŒğŸ»</p>
<h1>ğŸ”° ê³„ì† ë°°ìš°ê³ !! ê³„ì† ê³µìœ í•´ìš”!! ğŸ”°</h1>
<h1>ì°¸ê³ :</h1>
<p><a href="https://aws.amazon.com/blogs/mt/monitoring-coredns-for-dns-throttling-issues-using-aws-open-source-monitoring-services/" rel="nofollow" target="_blank">https://aws.amazon.com/blogs/mt/monitoring-coredns-for-dns-throttling-issues-using-aws-open-source-monitoring-services/</a></p>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"DNS ì„±ëŠ¥ì„ ëª¨ë‹ˆí„°ë§í•˜ê¸° ìœ„í•´ ì•Œì•„ì•¼ í•  ëª¨ë“  ê²ƒ","description":"","date":"2024-06-19 13:07","slug":"2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance","content":"\n![CoreDNS Monitoring](/assets/img/2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance_0.png)\n\n# ğŸ“š ì†Œê°œ:\n\nDNS ì§‘ì¤‘ ì›Œí¬ë¡œë“œë¥¼ ì‹¤í–‰í•  ë•Œ ì¢…ì¢… DNS ì“°ë¡œí‹€ë§ì— ì˜í•œ ê°„í—ì ì¸ CoreDNS ì‹¤íŒ¨ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ë¬¸ì œëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì¤‘ëŒ€í•œ ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nì´ëŸ¬í•œ ì¤‘ë‹¨ì€ ì„œë¹„ìŠ¤ì˜ ì‹ ë¢°ì„±ê³¼ ì„±ëŠ¥ì— ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ëª¨ë‹ˆí„°ë§ ì†”ë£¨ì…˜ì´ í•„ìˆ˜ì ì…ë‹ˆë‹¤.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nAWSëŠ” ëª¨ë‹ˆí„°ë§ ëª©ì ìœ¼ë¡œ í†µí•©í•  ìˆ˜ ìˆëŠ” ì˜¤í”ˆ ì†ŒìŠ¤ ë„êµ¬ì¸ CloudWatch, Fluentd ë° Grafanaë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì´ ë„êµ¬ë“¤ì€ CoreDNSë¥¼ ëª¨ë‹ˆí„°ë§í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n# Kubernetes DNS ì†Œê°œ:\n\nKubernetesëŠ” í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ ì„œë¹„ìŠ¤ ê²€ìƒ‰ì— DNSë¥¼ ì˜ì¡´í•©ë‹ˆë‹¤. íŒŸì—ì„œ ì‹¤í–‰ë˜ëŠ” ì‘ìš© í”„ë¡œê·¸ë¨ì´ ì„œë¡œ í†µì‹ í•´ì•¼ í•  ë•Œ, ê·¸ë“¤ì€ ì£¼ë¡œ IP ì£¼ì†Œê°€ ì•„ë‹Œ ë„ë©”ì¸ ì´ë¦„ì„ ì‚¬ìš©í•˜ì—¬ ì„œë¹„ìŠ¤ë¥¼ ì°¸ì¡°í•©ë‹ˆë‹¤.\n\nì´ ë•Œ Kubernetes DNSê°€ í•„ìš”í•©ë‹ˆë‹¤. ì´ëŠ” ë„ë©”ì¸ ì´ë¦„ì´ ì˜¬ë°”ë¥¸ IP ì£¼ì†Œë¡œ í•´ì„ë˜ë„ë¡ ë³´ì¥í•˜ì—¬ íŒŸê³¼ ì„œë¹„ìŠ¤ê°€ í†µì‹ í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nKubernetesì—ì„œëŠ” ê° íŒŒë“œë§ˆë‹¤ ì¼ì‹œì ì¸ IP ì£¼ì†Œê°€ í• ë‹¹ë©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì´ëŸ¬í•œ IP ì£¼ì†ŒëŠ” ë™ì ì´ë©° ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ ë³€ê²½ë  ìˆ˜ ìˆì–´, ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì´ë¥¼ ì¶”ì í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤.\n\nKubernetesëŠ” ì´ëŸ¬í•œ ë„ì „ì— ëŒ€ì‘í•˜ê¸° ìœ„í•´ íŒŒë“œì™€ ì„œë¹„ìŠ¤ì— ì™„ì „íˆ ì •ê·œí™”ëœ ë„ë©”ì¸ ì´ë¦„(FQDNs)ì„ í• ë‹¹í•©ë‹ˆë‹¤.\n\nKubernetesì˜ ê¸°ë³¸ DNS ì œê³µìì¸ CoreDNSëŠ” í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ DNS ì¿¼ë¦¬ë¥¼ ì²˜ë¦¬í•˜ëŠ” ì—­í• ì„ ë‹´ë‹¹í•©ë‹ˆë‹¤. ê·¸ëŠ” ì´ëŸ¬í•œ FQDNì„ í•´ë‹¹ IP ì£¼ì†Œë¡œ ë§¤í•‘í•˜ì—¬ íŒŒë“œì™€ ì„œë¹„ìŠ¤ ê°„ì˜ í†µì‹ ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.\n\n# ì™œ DNS ë¬¸ì œê°€ í”í• ê¹Œìš”:\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\në„¤íŠ¸ì›Œí¬ ë¬¸ì œ í•´ê²° ì¤‘ ê³µí†µì ìœ¼ë¡œ ë°œìƒí•˜ëŠ” ë²ˆê±°ë¡œì›€ì˜ ì›ì¸ ì¤‘ í•˜ë‚˜ì¸ DNS ë¬¸ì œ! DNSëŠ” ì‚¬ëŒì´ ì½ê¸° ì‰¬ìš´ ë„ë©”ì¸ ì´ë¦„ì„ ê¸°ê³„ê°€ ì´í•´í•  ìˆ˜ ìˆëŠ” IP ì£¼ì†Œë¡œ ë³€í™˜í•˜ëŠ” ë° í° ì—­í• ì„ í•©ë‹ˆë‹¤.\n\nê·¸ëŸ¬ë‚˜ DNS ë¬¸ì œëŠ” ì„¤ì • ì˜¤ë¥˜, ë„¤íŠ¸ì›Œí¬ ë¬¸ì œ ë˜ëŠ” ì„œë²„ ì¥ì• ì™€ ê°™ì€ ì—¬ëŸ¬ ìš”ì¸ìœ¼ë¡œ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë„ë©”ì¸ ì´ë¦„ì„ ì˜¬ë°”ë¥´ê²Œ í•´ì„í•˜ì§€ ëª»í•  ë•Œ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì™¸ë¶€ ì„œë¹„ìŠ¤ì— ì—°ê²° ë¬¸ì œë¥¼ ê²½í—˜í•˜ê±°ë‚˜ ì•¡ì„¸ìŠ¤ì— ì‹¤íŒ¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n# ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ CoreDNS:\n\nCoreDNSëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ DNS ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ëŠ” ë° ì¤‘ìš”í•œ ì—­í• ì„ í•©ë‹ˆë‹¤. Kubernetes v1.13 ì´í›„ ê¸°ë³¸ DNS ì œê³µìë¡œ ì‚¬ìš©ë˜ì–´ ì˜¨ CoreDNSëŠ” DNS ì´ë¦„ ëŒ€ì‹  IP ì£¼ì†Œ ëŒ€ì‹  DNS ì´ë¦„ì„ ì‚¬ìš©í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë¹„ìŠ¤ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆë„ë¡ í•¨ìœ¼ë¡œì¨ í´ëŸ¬ìŠ¤í„° ë„¤íŠ¸ì›Œí‚¹ì„ ê°„ì†Œí™”í•©ë‹ˆë‹¤. ê·¸ëŠ” ë„ë©”ì¸ ì´ë¦„ ìš”ì²­ì„ í•´ê²°í•˜ê³  í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ ì„œë¹„ìŠ¤ ê²€ìƒ‰ì„ ìš©ì´í•˜ê²Œ í•©ë‹ˆë‹¤.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n# ì½”ì–´ë””ì—”ì—ìŠ¤ì˜ ì‘ë™ ë°©ì‹:\n\nì½”ì–´ë””ì—”ì—ìŠ¤ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ DNS ìš”ì²­ì˜ ë¦¬ì¡¸ë²„ ë° í¬ì›Œë”ë¡œ ì‘ë™í•©ë‹ˆë‹¤. íŒŒë“œê°€ ë‹¤ë¥¸ ì„œë¹„ìŠ¤ì™€ í†µì‹ í•´ì•¼ í•  ë•Œ, ëŒ€ìƒ ì„œë¹„ìŠ¤ì˜ ë„ë©”ì¸ ì´ë¦„ì„ ì§€ì •í•˜ì—¬ DNS ì¿¼ë¦¬ë¥¼ ì½”ì–´ë””ì—”ì—ìŠ¤ì— ë³´ëƒ…ë‹ˆë‹¤. ê·¸ëŸ¼ ì½”ì–´ë””ì—”ì—ìŠ¤ëŠ” ë‚´ë¶€ ë ˆì½”ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ë„ë©”ì¸ ì´ë¦„ì„ í•´ë‹¹ IP ì£¼ì†Œë¡œ ë§¤í•‘í•˜ì—¬ ì´ ì¿¼ë¦¬ë¥¼ í•´ê²°í•©ë‹ˆë‹¤.\n\nì½”ì–´ë””ì—”ì—ìŠ¤ê°€ ê¶Œí•œì´ ì—†ëŠ” ì™¸ë¶€ ë„ë©”ì¸ ì´ë¦„ì— ëŒ€í•´ì„œëŠ”, ì´ë¥¼ ê³µê°œ ë¦¬ì¡¸ë²„ë‚˜ ìƒìœ„ DNS ì„œë²„ë¡œ ì „ë‹¬í•˜ì—¬ í•´ê²°í•©ë‹ˆë‹¤.\n\nì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¤ê³  ëŒ€ê¸° ì‹œê°„ì„ ì¤„ì´ê¸° ìœ„í•´ ì½”ì–´ë””ì—”ì—ìŠ¤ëŠ” ìì£¼ ì•¡ì„¸ìŠ¤í•˜ëŠ” ë„ë©”ì¸ ì´ë¦„ì— ëŒ€í•œ DNS ì‘ë‹µì„ ìºì‹œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ìºì‹± ë©”ì»¤ë‹ˆì¦˜ì€ DNS ì¿¼ë¦¬ì˜ ì‘ë‹µ ì†ë„ë¥¼ í–¥ìƒì‹œí‚¤ê³  ìƒìœ„ DNS ì„œë²„ì˜ ë¶€í•˜ë¥¼ ì¤„ì…ë‹ˆë‹¤.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nCoreDNSëŠ” ì´ ê¸°ëŠ¥ì„ ëª¨ë“ˆì‹ ì•„í‚¤í…ì²˜ì™€ í™•ì¥ ê°€ëŠ¥í•œ í”ŒëŸ¬ê·¸ì¸ ì‹œìŠ¤í…œì„ í†µí•´ êµ¬í˜„í•˜ë©°, ìš´ì˜ìê°€ ë…ìì ì¸ ìš”êµ¬ ì‚¬í•­ì— ë”°ë¼ DNS í•´ìƒë„ë¥¼ ì‚¬ìš©ì ì •ì˜í•˜ê³  ìµœì í™”í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤.\n\n# Amazon EKSì—ì„œì˜ CoreDNS ì“°ë¡œí‹€ë§ ì™„í™” ë°©ë²•:\n\nAmazon EKS í´ëŸ¬ìŠ¤í„°ì—ì„œ CoreDNSì™€ DNS ì“°ë¡œí‹€ë§ ë¬¸ì œëŠ” ì‹ë³„í•˜ê³  í•´ê²°í•˜ê¸° ì–´ë ¤ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë§ì€ ì‚¬ìš©ìê°€ CoreDNS ë¡œê·¸ì™€ ë©”íŠ¸ë¦­ì„ ëª¨ë‹ˆí„°ë§í•˜ëŠ” ë° ì£¼ë ¥í•˜ì§€ë§Œ, ì—˜ë¼ìŠ¤í‹± ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤(ENI) ìˆ˜ì¤€ì—ì„œ ê°•ì œë˜ëŠ” ì´ˆë‹¹ 1024ê°œ íŒ¨í‚·(PPS)ì˜ í•˜ë“œ ì œí•œì„ ìì£¼ ê°„ê³¼í•©ë‹ˆë‹¤. ì´ í•œê³„ê°€ ì“°ë¡œí‹€ë§ ë¬¸ì œë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆëŠ” ë°©ì‹ì„ ì´í•´í•˜ë ¤ë©´ Kubernetes íŒŒë“œì˜ ì „í˜•ì ì¸ DNS í•´ìƒë„ íë¦„ì— ëŒ€í•œ í†µì°°ë ¥ì´ í•„ìš”í•©ë‹ˆë‹¤.\n\nKubernetes í™˜ê²½ì—ì„œëŠ” íŒŒë“œê°€ í†µì‹ ì„ ê°€ëŠ¥í•˜ê²Œ í•˜ê¸° ìœ„í•´ ë‚´ë¶€ ë° ì™¸ë¶€ ì„œë¹„ìŠ¤ì˜ ë„ë©”ì¸ ì´ë¦„ì„ í•´ìƒí•´ì•¼ í•©ë‹ˆë‹¤. ì´ í•´ìƒë„ í”„ë¡œì„¸ìŠ¤ëŠ” DNS ì¿¼ë¦¬ë¥¼ ì›Œì»¤ ë…¸ë“œì˜ ENIë¥¼ í†µí•´ ë¼ìš°íŒ…í•˜ëŠ” ê²ƒì„ í¬í•¨í•˜ë©°, íŠ¹íˆ ì™¸ë¶€ ì—”ë“œí¬ì¸íŠ¸ë¥¼ í•´ìƒí•˜ëŠ” ê²½ìš°ì…ë‹ˆë‹¤. ë‚´ë¶€ ì—”ë“œí¬ì¸íŠ¸ì˜ ê²½ìš°ì—ë„ ì¿¼ë¦¬í•˜ëŠ” íŒŒë“œì™€ ë™ì¼í•œ ìœ„ì¹˜ì— CoreDNS íŒŒë“œê°€ ì—†ìœ¼ë©´ DNS íŒ¨í‚·ì´ ì—¬ì „íˆ ì›Œì»¤ ë…¸ë“œì˜ ENIë¥¼ í†µí•´ ì´ë™í•©ë‹ˆë‹¤.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nê°‘ìê¸° DNS ì¿¼ë¦¬ê°€ ê¸‰ì¦í•˜ì—¬ PPSê°€ í•˜ë“œ ì œí•œê°’ 1024ì— ì ‘ê·¼í•˜ëŠ” ìƒí™©ì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ìƒí™©ì€ DNS ì“°ë¡œí‹€ë§ì„ ìœ ë°œí•  ìˆ˜ ìˆìœ¼ë©°, ì´ë¡œ ì¸í•´ ì˜í–¥ì„ ë°›ëŠ” ì‘ì—… ë…¸ë“œì—ì„œ ì‹¤í–‰ ì¤‘ì¸ ëª¨ë“  ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ì— ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìœ ê°ìŠ¤ëŸ½ê²Œë„, ì´ëŸ¬í•œ ë¬¸ì œ í•´ê²°ì€ ì£¼ë¡œ CoreDNS podì— ì´ˆì ì„ ë§ì¶”ëŠ” ENI ë©”íŠ¸ë¦­ë³´ë‹¤ ì–´ë ¤ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nEKS í´ëŸ¬ìŠ¤í„°ì—ì„œ DNS ì“°ë¡œí‹€ë§ ë¬¸ì œë¥¼ ì™„í™”í•˜ê¸° ìœ„í•´ì„œëŠ” ENI ìˆ˜ì¤€ì—ì„œ ë°œìƒí•˜ëŠ” íŒ¨í‚· ì†ì‹¤ì„ ì§€ì†ì ìœ¼ë¡œ ëª¨ë‹ˆí„°ë§í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤. ì´ ëª¨ë‹ˆí„°ë§ì„ í†µí•´ ì ì¬ì ì¸ ì¤‘ë‹¨ì„ ì¡°ê¸°ì— ê°ì§€í•˜ê³  ì˜ˆë°©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ì—ì„œëŠ” ë„¤íŠ¸ì›Œí¬ ì„±ëŠ¥ ë©”íŠ¸ë¦­ì„ í™œìš©í•˜ì—¬ DNS ì“°ë¡œí‹€ë§ ë¬¸ì œë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ì‹ë³„í•˜ëŠ” ì†”ë£¨ì…˜ì„ ì†Œê°œí•©ë‹ˆë‹¤.\n\n## í•´ê²°ì±…: ğŸ‰\n\nì‘ì—… ë…¸ë“œì—ì„œ DNS ì“°ë¡œí‹€ë§ ë¬¸ì œë¥¼ ì‹ë³„í•˜ëŠ” ê°„ë‹¨í•œ ë°©ë²•ì€ Elastic Network Adapter (ENA) ë“œë¼ì´ë²„ì—ì„œ ì œê³µí•˜ëŠ” linklocal_allowance_exceeded ë©”íŠ¸ë¦­ ë° ë‹¤ë¥¸ ë©”íŠ¸ë¦­ì„ ìº¡ì²˜í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n`linklocal_allowance_exceeded`ì€ ë¡œì»¬ í”„ë¡ì‹œ ì„œë¹„ìŠ¤ë¡œì˜ íŠ¸ë˜í”½ PPSê°€ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ì˜ ìµœëŒ€ë¥¼ ì´ˆê³¼í•˜ì—¬ ë“œë¡­ëœ íŒ¨í‚· ìˆ˜ì…ë‹ˆë‹¤. ì´ëŠ” DNS ì„œë¹„ìŠ¤, ì¸ìŠ¤í„´ìŠ¤ ë©”íƒ€ë°ì´í„° ì„œë¹„ìŠ¤ ë° Amazon ì‹œê°„ ë™ê¸°í™” ì„œë¹„ìŠ¤ë¡œì˜ íŠ¸ë˜í”½ì— ì˜í–¥ì„ ì¤ë‹ˆë‹¤.\n\nì´ ì´ë²¤íŠ¸ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ì¶”ì í•˜ëŠ” ëŒ€ì‹ , ìš°ë¦¬ëŠ” ì´ ë©”íŠ¸ë¦­ì„ Amazon Managed Service for Prometheusë¡œ ìŠ¤íŠ¸ë¦¬ë°í•˜ê³  Amazon Managed Grafanaì—ì„œ ì‹œê°í™”í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance_1.png)\n\n# ì‹¤ì „: AWS EKSì—ì„œ CoreDNS ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ë° ì‹œê°í™”:\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nCoreDNS í”„ë¡œë©”í…Œìš°ìŠ¤ í”ŒëŸ¬ê·¸ì¸ì€ OpenMetrics í˜•ì‹ìœ¼ë¡œ ë©”íŠ¸ë¦­ì„ ë…¸ì¶œí•˜ë©°, ì´ëŠ” í”„ë¡œë©”í…Œìš°ìŠ¤ í˜•ì‹ì—ì„œ ë°œì „í•œ í…ìŠ¤íŠ¸ ê¸°ë°˜ í‘œì¤€ì…ë‹ˆë‹¤. Kubernetes í´ëŸ¬ìŠ¤í„°ì—ì„œëŠ” í”ŒëŸ¬ê·¸ì¸ì´ ê¸°ë³¸ì ìœ¼ë¡œ í™œì„±í™”ë˜ì–´ ìˆì–´ í´ëŸ¬ìŠ¤í„°ë¥¼ ì‹œì‘í•˜ëŠ” ì¦‰ì‹œ ë§ì€ ì¤‘ìš”í•œ ë©”íŠ¸ë¦­ì„ ëª¨ë‹ˆí„°ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nê¸°ë³¸ ì„¤ì •ì—ì„œ í”„ë¡œë©”í…Œìš°ìŠ¤ í”ŒëŸ¬ê·¸ì¸ì€ ê° CoreDNS íŒŸì˜ í¬íŠ¸ 9153ì— ìˆëŠ” /metrics ì—”ë“œí¬ì¸íŠ¸ì— ë©”íŠ¸ë¦­ì„ ê¸°ë¡í•©ë‹ˆë‹¤.\n\nAmazon Managed Service for Prometheus ì›Œí¬ìŠ¤í˜ì´ìŠ¤ì™€ Managed Service for Grafanaë¥¼ ìƒì„±í•˜ì„¸ìš”:\n\nì´ ë‹¨ê³„ì—ì„œëŠ” Amazon Managed Service for Prometheus ë° Managed Service for Grafanaë¥¼ ìœ„í•œ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nì´ íŒŒì¼ êµ¬ì„±ì€ ë‹¤ìŒì„ ìƒì„±í•©ë‹ˆë‹¤:\n\n- AMP ì‘ì—… ê³µê°„\n- AMP ê²½ë³´ ê´€ë¦¬ì ì •ì˜.\n\nmain.tf:\n\n```js\nmodule \"prometheus\" {\n  source = \"terraform-aws-modules/managed-service-prometheus/aws\"\n\n  workspace_alias = \"demo-coredns\"\n\n  alert_manager_definition = \u003c\u003c-EOT\n  alertmanager_config: |\n    route:\n      receiver: 'default'\n    receivers:\n      - name: 'default'\n  EOT\n\n  rule_group_namespaces = {}\n}\n```\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nversions.tf:\n\n```js\nterraform {\n  required_version = \"\u003e= 1.3\"\n\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"\u003e= 5.32\"\n    }\n  }\n}\n```\n\ní…Œë¼í¼ì„ ì‹¤í–‰í•˜ë ¤ë©´ ë‹¤ìŒì„ ì‹¤í–‰í•´ì•¼ í•©ë‹ˆë‹¤:\n\n```js\n$ terraform init\n$ terraform plan\n$ terraform apply\n```\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nì•„ë˜ êµ¬ì„± íŒŒì¼ì€ ë‹¤ìŒê³¼ ê°™ì€ ê²ƒì„ ìƒì„±í•©ë‹ˆë‹¤:\n\n- ê¸°ë³¸ Grafana ì‘ì—… ê³µê°„ (ëª¨ë“ˆì—ì„œ ì œê³µí•˜ëŠ” ê¸°ë³¸ê°’ ì‚¬ìš©)\n\nmain.tf:\n\n```js\nprovider \"aws\" {\n  region = local.region\n}\n\ndata \"aws_availability_zones\" \"available\" {}\n\nlocals {\n  region      = \"eu-west-1\"\n  name        = \"amg-ex-${replace(basename(path.cwd), \"_\", \"-\")}\"\n  description = \"AWS Managed Grafana service for ${local.name}\"\n\n  vpc_cidr = \"10.0.0.0/16\"\n  azs      = slice(data.aws_availability_zones.available.names, 0, 3)\n}\n\n################################################################################\n# Managed Grafana Module\n################################################################################\n\nmodule \"managed_grafana\" {\n  source = \"terraform-aws-modules/managed-service-grafana/aws\"\n\n  # Workspace\n  name                      = local.name\n  associate_license         = false\n  description               = local.description\n  account_access_type       = \"CURRENT_ACCOUNT\"\n  authentication_providers  = [\"AWS_SSO\"]\n  permission_type           = \"SERVICE_MANAGED\"\n  data_sources              = [\"CLOUDWATCH\", \"PROMETHEUS\", \"XRAY\"]\n  notification_destinations = [\"SNS\"]\n  stack_set_name            = local.name\n  grafana_version           = \"9.4\"\n\n  configuration = jsonencode({\n    unifiedAlerting = {\n      enabled = true\n    },\n    plugins = {\n      pluginAdminEnabled = false\n    }\n  })\n\n  # vpc configuration\n  vpc_configuration = {\n    subnet_ids = module.vpc.private_subnets\n  }\n  security_group_rules = {\n    egress_postgresql = {\n      description = \"Allow egress to PostgreSQL\"\n      from_port   = 5432\n      to_port     = 5432\n      protocol    = \"tcp\"\n      cidr_blocks = module.vpc.private_subnets_cidr_blocks\n    }\n  }\n\n  # Workspace API keys\n  workspace_api_keys = {\n    viewer = {\n      key_name        = \"viewer\"\n      key_role        = \"VIEWER\"\n      seconds_to_live = 3600\n    }\n    editor = {\n      key_name        = \"editor\"\n      key_role        = \"EDITOR\"\n      seconds_to_live = 3600\n    }\n    admin = {\n      key_name        = \"admin\"\n      key_role        = \"ADMIN\"\n      seconds_to_live = 3600\n    }\n  }\n\n  # Workspace IAM role\n  create_iam_role                = true\n  iam_role_name                  = local.name\n  use_iam_role_name_prefix       = true\n  iam_role_description           = local.description\n  iam_role_path                  = \"/grafana/\"\n  iam_role_force_detach_policies = true\n  iam_role_max_session_duration  = 7200\n  iam_role_tags                  = { role = true }\n\n\n  tags = local.tags\n}\n\nmodule \"managed_grafana_default\" {\n  source = \"terraform-aws-modules/managed-service-grafana/aws\"\n\n  name              = \"${local.name}-default\"\n  associate_license = false\n\n  tags = local.tags\n}\n\nmodule \"managed_grafana_disabled\" {\n  source = \"terraform-aws-modules/managed-service-grafana/aws\"\n\n  name   = local.name\n  create = false\n}\n\n################################################################################\n# Supporting Resources\n################################################################################\n\nmodule \"vpc\" {\n  source  = \"terraform-aws-modules/vpc/aws\"\n  version = \"~\u003e 5.0\"\n\n  name = local.name\n  cidr = local.vpc_cidr\n\n  azs             = local.azs\n  private_subnets = [for k, v in local.azs : cidrsubnet(local.vpc_cidr, 4, k)]\n  public_subnets  = [for k, v in local.azs : cidrsubnet(local.vpc_cidr, 8, k + 48)]\n\n  enable_nat_gateway = false\n  single_nat_gateway = true\n\n  tags = local.tags\n}\n```\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n\"versions.tf\" íŒŒì¼ì…ë‹ˆë‹¤:\n\n```js\nterraform {\n  required_version = \"\u003e= 1.0\"\n\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"\u003e= 5.0\"\n    }\n  }\n}\n```\n\nì´ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë ¤ë©´ ë‹¤ìŒì„ ì‹¤í–‰í•´ì•¼ í•©ë‹ˆë‹¤:\n\n```js\n$ terraform init\n$ terraform plan\n$ terraform apply\n```\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\ní”„ë¡œë©”í…Œìš°ìŠ¤ ethtool ìµìŠ¤í¬í„° ë°°ì¹˜:\n\nethtoolì€ ì›Œì»¤ ë…¸ë“œì˜ ì´ë”ë„· ì¥ì¹˜ì— ëŒ€í•œ ì •ë³´ë¥¼ êµ¬ì„±í•˜ê³  ìˆ˜ì§‘í•˜ëŠ” ë¦¬ëˆ…ìŠ¤ ë„êµ¬ì…ë‹ˆë‹¤. ìš°ë¦¬ëŠ” ethtoolì˜ ì¶œë ¥ì„ ì‚¬ìš©í•˜ì—¬ íŒ¨í‚· ì†ì‹¤ì„ ê°ì§€í•˜ê³  ì´ë¥¼ í”„ë¡œë©”í…Œìš°ìŠ¤ ethtool ìµìŠ¤í¬í„° ìœ í‹¸ë¦¬í‹°ë¥¼ ì‚¬ìš©í•˜ì—¬ í”„ë¡œë©”í…Œìš°ìŠ¤ í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•  ê²ƒì…ë‹ˆë‹¤.\n\në°°í¬ì—ëŠ” ethtoolì—ì„œ ì •ë³´ë¥¼ ê°€ì ¸ ì™€ì„œ í”„ë¡œë©”í…Œìš°ìŠ¤ í˜•ì‹ìœ¼ë¡œ ê²Œì‹œí•˜ëŠ” Python ìŠ¤í¬ë¦½íŠ¸ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\n\n```js\nkubectl apply -f https://raw.githubusercontent.com/Showmax/prometheus-ethtool-exporter/master/deploy/k8s-daemonset.yaml\n```\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nì´ì œ ADOT ìˆ˜ì§‘ê¸°ë¥¼ ë°°í¬í•˜ê³  ADOT ìˆ˜ì§‘ê¸°ë¥¼ êµ¬ì„±í•˜ì—¬ Amazon Managed Service for Prometheusë¡œ ë©”íŠ¸ë¦­ì„ ìˆ˜ì§‘í•  ê²ƒì…ë‹ˆë‹¤.\n\nìš°ë¦¬ëŠ” Amazon EKS ì• ë“œì˜¨ì„ ì‚¬ìš©í•˜ì—¬ ADOT ì˜¤í¼ë ˆì´í„°ë¥¼ CoreDNS ëª¨ë‹ˆí„°ë§ì„ ìœ„í•´ ë©”íŠ¸ë¦­ \"linklocal_allowance_exceeded\"ë¥¼ Amazon Managed Service for Prometheusë¡œ ë³´ë‚´ê²Œ ë  ê²ƒì…ë‹ˆë‹¤.\n\nIAM ì—­í• ê³¼ Amazon EKS ì„œë¹„ìŠ¤ ê³„ì •ì„ ìƒì„±í•˜ì„¸ìš”.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nADOT ìˆ˜ì§‘ê¸°ë¥¼ Kubernetes ì„œë¹„ìŠ¤ ê³„ì • \"adot-collector\"ì˜ ì‹ ì›ìœ¼ë¡œ ë°°í¬í•  ì˜ˆì •ì…ë‹ˆë‹¤. ì„œë¹„ìŠ¤ ê³„ì •ì— IAM ì—­í• (IRSA)ì„ ì—°ê²°í•˜ì—¬ Kubernetes ì„œë¹„ìŠ¤ ê³„ì •ì— AmazonPrometheusRemoteWriteAccess ì—­í• ì„ í• ë‹¹í•¨ìœ¼ë¡œì¨ í•´ë‹¹ ì„œë¹„ìŠ¤ ê³„ì •ì„ í™œìš©í•˜ëŠ” ëª¨ë“  íŒŒë“œê°€ Amazon Managed Service for Prometheusì— ë©”íŠ¸ë¦­ì„ ìˆ˜ì§‘í•˜ëŠ” ë° í•„ìš”í•œ IAM ê¶Œí•œì„ ë¶€ì—¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ë ¤ë©´ kubectl ë° eksctl CLI ë„êµ¬ê°€ í•„ìš”í•©ë‹ˆë‹¤. ì´ ë„êµ¬ë“¤ì€ Amazon EKS í´ëŸ¬ìŠ¤í„°ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆë„ë¡ êµ¬ì„±ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.\n\n```js\neksctl create iamserviceaccount \\\n--name adot-collector \\\n--namespace default \\\n--region eu-west-1\\\n--cluster coredns-monitoring-demo\\\n--attach-policy-arn arn:aws:iam::aws:policy/AmazonPrometheusRemoteWriteAccess \\\n--approve \\\n--override-existing-serviceaccounts\n```\n\nADOT ì• ë“œì˜¨ ì„¤ì¹˜í•˜ê¸°:\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nì—¬ëŸ¬ë¶„ì€ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ Amazon EKSì˜ ë‹¤ë¥¸ ë²„ì „ì— í™œì„±í™”ëœ ì• ë“œì˜¨ ëª©ë¡ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\ní´ëŸ¬ìŠ¤í„° ë²„ì „ì—ì„œ ì§€ì›í•˜ëŠ” ADOT ë²„ì „ì„ í™•ì¸í•˜ì‹­ì‹œì˜¤.\n\n```js\naws eks describe-addon-versions --addon-name adot --kubernetes-version 1.28 \\\n  --query \"addons[].addonVersions[].[addonVersion, compatibilities[].defaultVersion]\" --output text\n```\n\në‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ ADOT ì• ë“œì˜¨ì„ ì„¤ì¹˜í•˜ì‹­ì‹œì˜¤. ìœ„ ë‹¨ê³„ì—ì„œ ê¸°ìˆ ëœ ê²ƒì— ë”°ë¼ --addon-version í”Œë˜ê·¸ë¥¼ êµì²´í•˜ì‹­ì‹œì˜¤.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\naws eks create-addon --addon-name adot --addon-version v0.66.0-eksbuild.1 --cluster-name coredns-monitoring-demo\n```\n\në‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ ADOT ì• ë“œì˜¨ì´ ì¤€ë¹„ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.\n\n```js\nkubectl get po -n opentelemetry-operator-system\n```\n\në‹¤ìŒ ì ˆì°¨ëŠ” ë°°í¬ë¥¼ ëª¨ë“œ ê°’ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ì˜ˆì œ YAML íŒŒì¼ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ì´ëŠ” ê¸°ë³¸ ëª¨ë“œì´ë©° ADOT Collectorë¥¼ ë…ë¦½ ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ ìœ ì‚¬í•˜ê²Œ ë°°í¬í•©ë‹ˆë‹¤. ì´ êµ¬ì„±ì€ ìƒ˜í”Œ ì• í”Œë¦¬ì¼€ì´ì…˜ìœ¼ë¡œë¶€í„° OTLP ë©”íŠ¸ë¦­ì„ ìˆ˜ì‹ í•˜ê³  í´ëŸ¬ìŠ¤í„°ì˜ podì—ì„œ ìŠ¤í¬ë˜í•‘ëœ Amazon Managed Service for Prometheus ë©”íŠ¸ë¦­ì„ ìˆ˜ì‹ í•©ë‹ˆë‹¤.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\ncurl -o collector-config-amp.yaml https://raw.githubusercontent.com/aws-observability/aws-otel-community/master/sample-configs/operator/collector-config-amp.yaml\n\ncollector-config-amp.yaml íŒŒì¼ì—ì„œ ë‹¤ìŒì„ ë³¸ì¸ì˜ ê°’ìœ¼ë¡œ ë°”ê¿”ì£¼ì„¸ìš”: _ mode: deployment _ serviceAccount: adot-collector _ endpoint: \"\" _ region: \"\" \\* name: adot-collector\n\nkubectl apply -f collector-config-amp.yaml\n\nadot collectorê°€ ë°°í¬ë˜ë©´ ë©”íŠ¸ë¦­ì´ Amazon Prometheusì— ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nAmazon Managed Grafanaì—ì„œ ethtool ë©”íŠ¸ë¦­ì„ ì‹œê°í™”í•´ë³´ì„¸ìš”:\n\nAmazon Managed Grafana ì½˜ì†” ë‚´ì—ì„œ Prometheus ì›Œí¬ìŠ¤í˜ì´ìŠ¤ë¥¼ ë°ì´í„° ì†ŒìŠ¤ë¡œ êµ¬ì„±í•©ë‹ˆë‹¤.\n\nì´ì œ Amazon Managed Grafanaì—ì„œ ë©”íŠ¸ë¦­ì„ ì‚´í´ë´…ì‹œë‹¤: \"íƒìƒ‰\" ë²„íŠ¼ì„ í´ë¦­í•œ í›„ ethtoolì„ ê²€ìƒ‰í•˜ì„¸ìš”:\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance_2.png)\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\në§í¬ë¡œì»¬ í• ë‹¹ ì´ˆê³¼ ë©”íŠ¸ë¦­ì„ ì‚¬ìš©í•˜ì—¬ ëŒ€ì‹œë³´ë“œë¥¼ ë§Œë“¤ì–´ ë´…ì‹œë‹¤. ì¿¼ë¦¬ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\n\n```js\nrate(node_net_ethtool{device=\"eth0\",type=\"linklocal_allowance_exceeded\"} [30s])\n```\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance_3.png)\n\nê°’ì´ 0ì´ê¸° ë•Œë¬¸ì— ë“œëëœ íŒ¨í‚·ì´ ì—†ë‹¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Amazon Managed Service for Prometheusì˜ ê²½ê³  ê´€ë¦¬ìì—ì„œ ì•Œë¦¼ì„ êµ¬ì„±í•˜ì—¬ ì•Œë¦¼ì„ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n# ê²°ë¡ :\n\nì´ ê¸€ì—ì„œëŠ” AWS Distro for OpenTelemetry (ADOT), Amazon Managed Service for Prometheus ë° Amazon Managed Grafanaë¥¼ ì‚¬ìš©í•˜ì—¬ CoreDNS ì“°ë¡œí‹€ë§ ë¬¸ì œë¥¼ ëª¨ë‹ˆí„°ë§í•˜ê³  ê²½ê³ ë¥¼ ìƒì„±í•˜ëŠ” ë°©ë²•ì„ ë³´ì—¬ë“œë ¸ìŠµë‹ˆë‹¤. CoreDNS ë©”íŠ¸ë¦­ì„ ëª¨ë‹ˆí„°ë§í•¨ìœ¼ë¡œì¨ ê³ ê°ì€ íŒ¨í‚· ì†ì‹¤ì„ ì‚¬ì „ì— ê°ì§€í•˜ê³  ì˜ˆë°© ì¡°ì¹˜ë¥¼ ì·¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\në‹¤ìŒì— ë˜ ë§Œë‚˜ìš” ğŸ‡µğŸ‡¸ ğŸ‰\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance_4.png)\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nì½ì–´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤!! ğŸ™ŒğŸ»ğŸ˜ğŸ“ƒ, ë‹¤ìŒ ë¸”ë¡œê·¸ì—ì„œ ë§Œë‚˜ìš”.ğŸ¤˜ğŸ‡µğŸ‡¸\n\nğŸš€ ëê¹Œì§€ í•¨ê»˜í•´ ì¤˜ì„œ ê°ì‚¬í•©ë‹ˆë‹¤. ì´ ë¸”ë¡œê·¸ì— ê´€í•œ ì§ˆë¬¸/í”¼ë“œë°±ì´ ìˆìœ¼ë©´ ì–¸ì œë“ ì§€ ì—°ë½í•´ ì£¼ì„¸ìš”:\n\nâ™»ï¸ ğŸ‡µğŸ‡¸LinkedIn: https://www.linkedin.com/in/rajhi-saif/\n\nâ™»ï¸ğŸ‡µğŸ‡¸ Twitter : https://twitter.com/rajhisaifeddine\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\në! âœŒğŸ»\n\n# ğŸ”° ê³„ì† ë°°ìš°ê³ !! ê³„ì† ê³µìœ í•´ìš”!! ğŸ”°\n\n# ì°¸ê³ :\n\n[https://aws.amazon.com/blogs/mt/monitoring-coredns-for-dns-throttling-issues-using-aws-open-source-monitoring-services/](https://aws.amazon.com/blogs/mt/monitoring-coredns-for-dns-throttling-issues-using-aws-open-source-monitoring-services/)\n","ogImage":{"url":"/assets/img/2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance_0.png"},"coverImage":"/assets/img/2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance_0.png","tag":["Tech"],"readingTime":19},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance_0.png\" alt=\"CoreDNS Monitoring\"\u003e\u003c/p\u003e\n\u003ch1\u003eğŸ“š ì†Œê°œ:\u003c/h1\u003e\n\u003cp\u003eDNS ì§‘ì¤‘ ì›Œí¬ë¡œë“œë¥¼ ì‹¤í–‰í•  ë•Œ ì¢…ì¢… DNS ì“°ë¡œí‹€ë§ì— ì˜í•œ ê°„í—ì ì¸ CoreDNS ì‹¤íŒ¨ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ë¬¸ì œëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì¤‘ëŒ€í•œ ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eì´ëŸ¬í•œ ì¤‘ë‹¨ì€ ì„œë¹„ìŠ¤ì˜ ì‹ ë¢°ì„±ê³¼ ì„±ëŠ¥ì— ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ëª¨ë‹ˆí„°ë§ ì†”ë£¨ì…˜ì´ í•„ìˆ˜ì ì…ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eAWSëŠ” ëª¨ë‹ˆí„°ë§ ëª©ì ìœ¼ë¡œ í†µí•©í•  ìˆ˜ ìˆëŠ” ì˜¤í”ˆ ì†ŒìŠ¤ ë„êµ¬ì¸ CloudWatch, Fluentd ë° Grafanaë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì´ ë„êµ¬ë“¤ì€ CoreDNSë¥¼ ëª¨ë‹ˆí„°ë§í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003ch1\u003eKubernetes DNS ì†Œê°œ:\u003c/h1\u003e\n\u003cp\u003eKubernetesëŠ” í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ ì„œë¹„ìŠ¤ ê²€ìƒ‰ì— DNSë¥¼ ì˜ì¡´í•©ë‹ˆë‹¤. íŒŸì—ì„œ ì‹¤í–‰ë˜ëŠ” ì‘ìš© í”„ë¡œê·¸ë¨ì´ ì„œë¡œ í†µì‹ í•´ì•¼ í•  ë•Œ, ê·¸ë“¤ì€ ì£¼ë¡œ IP ì£¼ì†Œê°€ ì•„ë‹Œ ë„ë©”ì¸ ì´ë¦„ì„ ì‚¬ìš©í•˜ì—¬ ì„œë¹„ìŠ¤ë¥¼ ì°¸ì¡°í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eì´ ë•Œ Kubernetes DNSê°€ í•„ìš”í•©ë‹ˆë‹¤. ì´ëŠ” ë„ë©”ì¸ ì´ë¦„ì´ ì˜¬ë°”ë¥¸ IP ì£¼ì†Œë¡œ í•´ì„ë˜ë„ë¡ ë³´ì¥í•˜ì—¬ íŒŸê³¼ ì„œë¹„ìŠ¤ê°€ í†µì‹ í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eKubernetesì—ì„œëŠ” ê° íŒŒë“œë§ˆë‹¤ ì¼ì‹œì ì¸ IP ì£¼ì†Œê°€ í• ë‹¹ë©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì´ëŸ¬í•œ IP ì£¼ì†ŒëŠ” ë™ì ì´ë©° ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ ë³€ê²½ë  ìˆ˜ ìˆì–´, ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì´ë¥¼ ì¶”ì í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eKubernetesëŠ” ì´ëŸ¬í•œ ë„ì „ì— ëŒ€ì‘í•˜ê¸° ìœ„í•´ íŒŒë“œì™€ ì„œë¹„ìŠ¤ì— ì™„ì „íˆ ì •ê·œí™”ëœ ë„ë©”ì¸ ì´ë¦„(FQDNs)ì„ í• ë‹¹í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eKubernetesì˜ ê¸°ë³¸ DNS ì œê³µìì¸ CoreDNSëŠ” í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ DNS ì¿¼ë¦¬ë¥¼ ì²˜ë¦¬í•˜ëŠ” ì—­í• ì„ ë‹´ë‹¹í•©ë‹ˆë‹¤. ê·¸ëŠ” ì´ëŸ¬í•œ FQDNì„ í•´ë‹¹ IP ì£¼ì†Œë¡œ ë§¤í•‘í•˜ì—¬ íŒŒë“œì™€ ì„œë¹„ìŠ¤ ê°„ì˜ í†µì‹ ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003ch1\u003eì™œ DNS ë¬¸ì œê°€ í”í• ê¹Œìš”:\u003c/h1\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eë„¤íŠ¸ì›Œí¬ ë¬¸ì œ í•´ê²° ì¤‘ ê³µí†µì ìœ¼ë¡œ ë°œìƒí•˜ëŠ” ë²ˆê±°ë¡œì›€ì˜ ì›ì¸ ì¤‘ í•˜ë‚˜ì¸ DNS ë¬¸ì œ! DNSëŠ” ì‚¬ëŒì´ ì½ê¸° ì‰¬ìš´ ë„ë©”ì¸ ì´ë¦„ì„ ê¸°ê³„ê°€ ì´í•´í•  ìˆ˜ ìˆëŠ” IP ì£¼ì†Œë¡œ ë³€í™˜í•˜ëŠ” ë° í° ì—­í• ì„ í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eê·¸ëŸ¬ë‚˜ DNS ë¬¸ì œëŠ” ì„¤ì • ì˜¤ë¥˜, ë„¤íŠ¸ì›Œí¬ ë¬¸ì œ ë˜ëŠ” ì„œë²„ ì¥ì• ì™€ ê°™ì€ ì—¬ëŸ¬ ìš”ì¸ìœ¼ë¡œ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë„ë©”ì¸ ì´ë¦„ì„ ì˜¬ë°”ë¥´ê²Œ í•´ì„í•˜ì§€ ëª»í•  ë•Œ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì™¸ë¶€ ì„œë¹„ìŠ¤ì— ì—°ê²° ë¬¸ì œë¥¼ ê²½í—˜í•˜ê±°ë‚˜ ì•¡ì„¸ìŠ¤ì— ì‹¤íŒ¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003ch1\u003eì¿ ë²„ë„¤í‹°ìŠ¤ì˜ CoreDNS:\u003c/h1\u003e\n\u003cp\u003eCoreDNSëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ DNS ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ëŠ” ë° ì¤‘ìš”í•œ ì—­í• ì„ í•©ë‹ˆë‹¤. Kubernetes v1.13 ì´í›„ ê¸°ë³¸ DNS ì œê³µìë¡œ ì‚¬ìš©ë˜ì–´ ì˜¨ CoreDNSëŠ” DNS ì´ë¦„ ëŒ€ì‹  IP ì£¼ì†Œ ëŒ€ì‹  DNS ì´ë¦„ì„ ì‚¬ìš©í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë¹„ìŠ¤ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆë„ë¡ í•¨ìœ¼ë¡œì¨ í´ëŸ¬ìŠ¤í„° ë„¤íŠ¸ì›Œí‚¹ì„ ê°„ì†Œí™”í•©ë‹ˆë‹¤. ê·¸ëŠ” ë„ë©”ì¸ ì´ë¦„ ìš”ì²­ì„ í•´ê²°í•˜ê³  í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ ì„œë¹„ìŠ¤ ê²€ìƒ‰ì„ ìš©ì´í•˜ê²Œ í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003ch1\u003eì½”ì–´ë””ì—”ì—ìŠ¤ì˜ ì‘ë™ ë°©ì‹:\u003c/h1\u003e\n\u003cp\u003eì½”ì–´ë””ì—”ì—ìŠ¤ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ DNS ìš”ì²­ì˜ ë¦¬ì¡¸ë²„ ë° í¬ì›Œë”ë¡œ ì‘ë™í•©ë‹ˆë‹¤. íŒŒë“œê°€ ë‹¤ë¥¸ ì„œë¹„ìŠ¤ì™€ í†µì‹ í•´ì•¼ í•  ë•Œ, ëŒ€ìƒ ì„œë¹„ìŠ¤ì˜ ë„ë©”ì¸ ì´ë¦„ì„ ì§€ì •í•˜ì—¬ DNS ì¿¼ë¦¬ë¥¼ ì½”ì–´ë””ì—”ì—ìŠ¤ì— ë³´ëƒ…ë‹ˆë‹¤. ê·¸ëŸ¼ ì½”ì–´ë””ì—”ì—ìŠ¤ëŠ” ë‚´ë¶€ ë ˆì½”ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ë„ë©”ì¸ ì´ë¦„ì„ í•´ë‹¹ IP ì£¼ì†Œë¡œ ë§¤í•‘í•˜ì—¬ ì´ ì¿¼ë¦¬ë¥¼ í•´ê²°í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eì½”ì–´ë””ì—”ì—ìŠ¤ê°€ ê¶Œí•œì´ ì—†ëŠ” ì™¸ë¶€ ë„ë©”ì¸ ì´ë¦„ì— ëŒ€í•´ì„œëŠ”, ì´ë¥¼ ê³µê°œ ë¦¬ì¡¸ë²„ë‚˜ ìƒìœ„ DNS ì„œë²„ë¡œ ì „ë‹¬í•˜ì—¬ í•´ê²°í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¤ê³  ëŒ€ê¸° ì‹œê°„ì„ ì¤„ì´ê¸° ìœ„í•´ ì½”ì–´ë””ì—”ì—ìŠ¤ëŠ” ìì£¼ ì•¡ì„¸ìŠ¤í•˜ëŠ” ë„ë©”ì¸ ì´ë¦„ì— ëŒ€í•œ DNS ì‘ë‹µì„ ìºì‹œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ìºì‹± ë©”ì»¤ë‹ˆì¦˜ì€ DNS ì¿¼ë¦¬ì˜ ì‘ë‹µ ì†ë„ë¥¼ í–¥ìƒì‹œí‚¤ê³  ìƒìœ„ DNS ì„œë²„ì˜ ë¶€í•˜ë¥¼ ì¤„ì…ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eCoreDNSëŠ” ì´ ê¸°ëŠ¥ì„ ëª¨ë“ˆì‹ ì•„í‚¤í…ì²˜ì™€ í™•ì¥ ê°€ëŠ¥í•œ í”ŒëŸ¬ê·¸ì¸ ì‹œìŠ¤í…œì„ í†µí•´ êµ¬í˜„í•˜ë©°, ìš´ì˜ìê°€ ë…ìì ì¸ ìš”êµ¬ ì‚¬í•­ì— ë”°ë¼ DNS í•´ìƒë„ë¥¼ ì‚¬ìš©ì ì •ì˜í•˜ê³  ìµœì í™”í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003ch1\u003eAmazon EKSì—ì„œì˜ CoreDNS ì“°ë¡œí‹€ë§ ì™„í™” ë°©ë²•:\u003c/h1\u003e\n\u003cp\u003eAmazon EKS í´ëŸ¬ìŠ¤í„°ì—ì„œ CoreDNSì™€ DNS ì“°ë¡œí‹€ë§ ë¬¸ì œëŠ” ì‹ë³„í•˜ê³  í•´ê²°í•˜ê¸° ì–´ë ¤ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë§ì€ ì‚¬ìš©ìê°€ CoreDNS ë¡œê·¸ì™€ ë©”íŠ¸ë¦­ì„ ëª¨ë‹ˆí„°ë§í•˜ëŠ” ë° ì£¼ë ¥í•˜ì§€ë§Œ, ì—˜ë¼ìŠ¤í‹± ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤(ENI) ìˆ˜ì¤€ì—ì„œ ê°•ì œë˜ëŠ” ì´ˆë‹¹ 1024ê°œ íŒ¨í‚·(PPS)ì˜ í•˜ë“œ ì œí•œì„ ìì£¼ ê°„ê³¼í•©ë‹ˆë‹¤. ì´ í•œê³„ê°€ ì“°ë¡œí‹€ë§ ë¬¸ì œë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆëŠ” ë°©ì‹ì„ ì´í•´í•˜ë ¤ë©´ Kubernetes íŒŒë“œì˜ ì „í˜•ì ì¸ DNS í•´ìƒë„ íë¦„ì— ëŒ€í•œ í†µì°°ë ¥ì´ í•„ìš”í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eKubernetes í™˜ê²½ì—ì„œëŠ” íŒŒë“œê°€ í†µì‹ ì„ ê°€ëŠ¥í•˜ê²Œ í•˜ê¸° ìœ„í•´ ë‚´ë¶€ ë° ì™¸ë¶€ ì„œë¹„ìŠ¤ì˜ ë„ë©”ì¸ ì´ë¦„ì„ í•´ìƒí•´ì•¼ í•©ë‹ˆë‹¤. ì´ í•´ìƒë„ í”„ë¡œì„¸ìŠ¤ëŠ” DNS ì¿¼ë¦¬ë¥¼ ì›Œì»¤ ë…¸ë“œì˜ ENIë¥¼ í†µí•´ ë¼ìš°íŒ…í•˜ëŠ” ê²ƒì„ í¬í•¨í•˜ë©°, íŠ¹íˆ ì™¸ë¶€ ì—”ë“œí¬ì¸íŠ¸ë¥¼ í•´ìƒí•˜ëŠ” ê²½ìš°ì…ë‹ˆë‹¤. ë‚´ë¶€ ì—”ë“œí¬ì¸íŠ¸ì˜ ê²½ìš°ì—ë„ ì¿¼ë¦¬í•˜ëŠ” íŒŒë“œì™€ ë™ì¼í•œ ìœ„ì¹˜ì— CoreDNS íŒŒë“œê°€ ì—†ìœ¼ë©´ DNS íŒ¨í‚·ì´ ì—¬ì „íˆ ì›Œì»¤ ë…¸ë“œì˜ ENIë¥¼ í†µí•´ ì´ë™í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eê°‘ìê¸° DNS ì¿¼ë¦¬ê°€ ê¸‰ì¦í•˜ì—¬ PPSê°€ í•˜ë“œ ì œí•œê°’ 1024ì— ì ‘ê·¼í•˜ëŠ” ìƒí™©ì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ìƒí™©ì€ DNS ì“°ë¡œí‹€ë§ì„ ìœ ë°œí•  ìˆ˜ ìˆìœ¼ë©°, ì´ë¡œ ì¸í•´ ì˜í–¥ì„ ë°›ëŠ” ì‘ì—… ë…¸ë“œì—ì„œ ì‹¤í–‰ ì¤‘ì¸ ëª¨ë“  ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ì— ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìœ ê°ìŠ¤ëŸ½ê²Œë„, ì´ëŸ¬í•œ ë¬¸ì œ í•´ê²°ì€ ì£¼ë¡œ CoreDNS podì— ì´ˆì ì„ ë§ì¶”ëŠ” ENI ë©”íŠ¸ë¦­ë³´ë‹¤ ì–´ë ¤ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eEKS í´ëŸ¬ìŠ¤í„°ì—ì„œ DNS ì“°ë¡œí‹€ë§ ë¬¸ì œë¥¼ ì™„í™”í•˜ê¸° ìœ„í•´ì„œëŠ” ENI ìˆ˜ì¤€ì—ì„œ ë°œìƒí•˜ëŠ” íŒ¨í‚· ì†ì‹¤ì„ ì§€ì†ì ìœ¼ë¡œ ëª¨ë‹ˆí„°ë§í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤. ì´ ëª¨ë‹ˆí„°ë§ì„ í†µí•´ ì ì¬ì ì¸ ì¤‘ë‹¨ì„ ì¡°ê¸°ì— ê°ì§€í•˜ê³  ì˜ˆë°©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ì—ì„œëŠ” ë„¤íŠ¸ì›Œí¬ ì„±ëŠ¥ ë©”íŠ¸ë¦­ì„ í™œìš©í•˜ì—¬ DNS ì“°ë¡œí‹€ë§ ë¬¸ì œë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ì‹ë³„í•˜ëŠ” ì†”ë£¨ì…˜ì„ ì†Œê°œí•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003ch2\u003eí•´ê²°ì±…: ğŸ‰\u003c/h2\u003e\n\u003cp\u003eì‘ì—… ë…¸ë“œì—ì„œ DNS ì“°ë¡œí‹€ë§ ë¬¸ì œë¥¼ ì‹ë³„í•˜ëŠ” ê°„ë‹¨í•œ ë°©ë²•ì€ Elastic Network Adapter (ENA) ë“œë¼ì´ë²„ì—ì„œ ì œê³µí•˜ëŠ” linklocal_allowance_exceeded ë©”íŠ¸ë¦­ ë° ë‹¤ë¥¸ ë©”íŠ¸ë¦­ì„ ìº¡ì²˜í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003elinklocal_allowance_exceeded\u003c/code\u003eì€ ë¡œì»¬ í”„ë¡ì‹œ ì„œë¹„ìŠ¤ë¡œì˜ íŠ¸ë˜í”½ PPSê°€ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ì˜ ìµœëŒ€ë¥¼ ì´ˆê³¼í•˜ì—¬ ë“œë¡­ëœ íŒ¨í‚· ìˆ˜ì…ë‹ˆë‹¤. ì´ëŠ” DNS ì„œë¹„ìŠ¤, ì¸ìŠ¤í„´ìŠ¤ ë©”íƒ€ë°ì´í„° ì„œë¹„ìŠ¤ ë° Amazon ì‹œê°„ ë™ê¸°í™” ì„œë¹„ìŠ¤ë¡œì˜ íŠ¸ë˜í”½ì— ì˜í–¥ì„ ì¤ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eì´ ì´ë²¤íŠ¸ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ì¶”ì í•˜ëŠ” ëŒ€ì‹ , ìš°ë¦¬ëŠ” ì´ ë©”íŠ¸ë¦­ì„ Amazon Managed Service for Prometheusë¡œ ìŠ¤íŠ¸ë¦¬ë°í•˜ê³  Amazon Managed Grafanaì—ì„œ ì‹œê°í™”í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance_1.png\" alt=\"ì´ë¯¸ì§€\"\u003e\u003c/p\u003e\n\u003ch1\u003eì‹¤ì „: AWS EKSì—ì„œ CoreDNS ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ë° ì‹œê°í™”:\u003c/h1\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eCoreDNS í”„ë¡œë©”í…Œìš°ìŠ¤ í”ŒëŸ¬ê·¸ì¸ì€ OpenMetrics í˜•ì‹ìœ¼ë¡œ ë©”íŠ¸ë¦­ì„ ë…¸ì¶œí•˜ë©°, ì´ëŠ” í”„ë¡œë©”í…Œìš°ìŠ¤ í˜•ì‹ì—ì„œ ë°œì „í•œ í…ìŠ¤íŠ¸ ê¸°ë°˜ í‘œì¤€ì…ë‹ˆë‹¤. Kubernetes í´ëŸ¬ìŠ¤í„°ì—ì„œëŠ” í”ŒëŸ¬ê·¸ì¸ì´ ê¸°ë³¸ì ìœ¼ë¡œ í™œì„±í™”ë˜ì–´ ìˆì–´ í´ëŸ¬ìŠ¤í„°ë¥¼ ì‹œì‘í•˜ëŠ” ì¦‰ì‹œ ë§ì€ ì¤‘ìš”í•œ ë©”íŠ¸ë¦­ì„ ëª¨ë‹ˆí„°ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eê¸°ë³¸ ì„¤ì •ì—ì„œ í”„ë¡œë©”í…Œìš°ìŠ¤ í”ŒëŸ¬ê·¸ì¸ì€ ê° CoreDNS íŒŸì˜ í¬íŠ¸ 9153ì— ìˆëŠ” /metrics ì—”ë“œí¬ì¸íŠ¸ì— ë©”íŠ¸ë¦­ì„ ê¸°ë¡í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eAmazon Managed Service for Prometheus ì›Œí¬ìŠ¤í˜ì´ìŠ¤ì™€ Managed Service for Grafanaë¥¼ ìƒì„±í•˜ì„¸ìš”:\u003c/p\u003e\n\u003cp\u003eì´ ë‹¨ê³„ì—ì„œëŠ” Amazon Managed Service for Prometheus ë° Managed Service for Grafanaë¥¼ ìœ„í•œ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eì´ íŒŒì¼ êµ¬ì„±ì€ ë‹¤ìŒì„ ìƒì„±í•©ë‹ˆë‹¤:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eAMP ì‘ì—… ê³µê°„\u003c/li\u003e\n\u003cli\u003eAMP ê²½ë³´ ê´€ë¦¬ì ì •ì˜.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003emain.tf:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"prometheus\"\u003c/span\u003e {\n  source = \u003cspan class=\"hljs-string\"\u003e\"terraform-aws-modules/managed-service-prometheus/aws\"\u003c/span\u003e\n\n  workspace_alias = \u003cspan class=\"hljs-string\"\u003e\"demo-coredns\"\u003c/span\u003e\n\n  alert_manager_definition = \u0026#x3C;\u0026#x3C;-\u003cspan class=\"hljs-variable constant_\"\u003eEOT\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003ealertmanager_config\u003c/span\u003e: |\n    \u003cspan class=\"hljs-attr\"\u003eroute\u003c/span\u003e:\n      \u003cspan class=\"hljs-attr\"\u003ereceiver\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'default'\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003ereceivers\u003c/span\u003e:\n      - \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'default'\u003c/span\u003e\n  \u003cspan class=\"hljs-variable constant_\"\u003eEOT\u003c/span\u003e\n\n  rule_group_namespaces = {}\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eversions.tf:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eterraform {\n  required_version = \u003cspan class=\"hljs-string\"\u003e\"\u003e= 1.3\"\u003c/span\u003e\n\n  required_providers {\n    aws = {\n      source  = \u003cspan class=\"hljs-string\"\u003e\"hashicorp/aws\"\u003c/span\u003e\n      version = \u003cspan class=\"hljs-string\"\u003e\"\u003e= 5.32\"\u003c/span\u003e\n    }\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eí…Œë¼í¼ì„ ì‹¤í–‰í•˜ë ¤ë©´ ë‹¤ìŒì„ ì‹¤í–‰í•´ì•¼ í•©ë‹ˆë‹¤:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ terraform init\n$ terraform plan\n$ terraform apply\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eì•„ë˜ êµ¬ì„± íŒŒì¼ì€ ë‹¤ìŒê³¼ ê°™ì€ ê²ƒì„ ìƒì„±í•©ë‹ˆë‹¤:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eê¸°ë³¸ Grafana ì‘ì—… ê³µê°„ (ëª¨ë“ˆì—ì„œ ì œê³µí•˜ëŠ” ê¸°ë³¸ê°’ ì‚¬ìš©)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003emain.tf:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eprovider \u003cspan class=\"hljs-string\"\u003e\"aws\"\u003c/span\u003e {\n  region = local.\u003cspan class=\"hljs-property\"\u003eregion\u003c/span\u003e\n}\n\ndata \u003cspan class=\"hljs-string\"\u003e\"aws_availability_zones\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"available\"\u003c/span\u003e {}\n\nlocals {\n  region      = \u003cspan class=\"hljs-string\"\u003e\"eu-west-1\"\u003c/span\u003e\n  name        = \u003cspan class=\"hljs-string\"\u003e\"amg-ex-${replace(basename(path.cwd), \"\u003c/span\u003e_\u003cspan class=\"hljs-string\"\u003e\", \"\u003c/span\u003e-\u003cspan class=\"hljs-string\"\u003e\")}\"\u003c/span\u003e\n  description = \u003cspan class=\"hljs-string\"\u003e\"AWS Managed Grafana service for ${local.name}\"\u003c/span\u003e\n\n  vpc_cidr = \u003cspan class=\"hljs-string\"\u003e\"10.0.0.0/16\"\u003c/span\u003e\n  azs      = \u003cspan class=\"hljs-title function_\"\u003eslice\u003c/span\u003e(data.\u003cspan class=\"hljs-property\"\u003eaws_availability_zones\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eavailable\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003enames\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e)\n}\n\n################################################################################\n# \u003cspan class=\"hljs-title class_\"\u003eManaged\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eGrafana\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eModule\u003c/span\u003e\n################################################################################\n\n\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"managed_grafana\"\u003c/span\u003e {\n  source = \u003cspan class=\"hljs-string\"\u003e\"terraform-aws-modules/managed-service-grafana/aws\"\u003c/span\u003e\n\n  # \u003cspan class=\"hljs-title class_\"\u003eWorkspace\u003c/span\u003e\n  name                      = local.\u003cspan class=\"hljs-property\"\u003ename\u003c/span\u003e\n  associate_license         = \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e\n  description               = local.\u003cspan class=\"hljs-property\"\u003edescription\u003c/span\u003e\n  account_access_type       = \u003cspan class=\"hljs-string\"\u003e\"CURRENT_ACCOUNT\"\u003c/span\u003e\n  authentication_providers  = [\u003cspan class=\"hljs-string\"\u003e\"AWS_SSO\"\u003c/span\u003e]\n  permission_type           = \u003cspan class=\"hljs-string\"\u003e\"SERVICE_MANAGED\"\u003c/span\u003e\n  data_sources              = [\u003cspan class=\"hljs-string\"\u003e\"CLOUDWATCH\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"PROMETHEUS\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"XRAY\"\u003c/span\u003e]\n  notification_destinations = [\u003cspan class=\"hljs-string\"\u003e\"SNS\"\u003c/span\u003e]\n  stack_set_name            = local.\u003cspan class=\"hljs-property\"\u003ename\u003c/span\u003e\n  grafana_version           = \u003cspan class=\"hljs-string\"\u003e\"9.4\"\u003c/span\u003e\n\n  configuration = \u003cspan class=\"hljs-title function_\"\u003ejsonencode\u003c/span\u003e({\n    unifiedAlerting = {\n      enabled = \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e\n    },\n    plugins = {\n      pluginAdminEnabled = \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e\n    }\n  })\n\n  # vpc configuration\n  vpc_configuration = {\n    subnet_ids = \u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eprivate_subnets\u003c/span\u003e\n  }\n  security_group_rules = {\n    egress_postgresql = {\n      description = \u003cspan class=\"hljs-string\"\u003e\"Allow egress to PostgreSQL\"\u003c/span\u003e\n      from_port   = \u003cspan class=\"hljs-number\"\u003e5432\u003c/span\u003e\n      to_port     = \u003cspan class=\"hljs-number\"\u003e5432\u003c/span\u003e\n      protocol    = \u003cspan class=\"hljs-string\"\u003e\"tcp\"\u003c/span\u003e\n      cidr_blocks = \u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eprivate_subnets_cidr_blocks\u003c/span\u003e\n    }\n  }\n\n  # \u003cspan class=\"hljs-title class_\"\u003eWorkspace\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eAPI\u003c/span\u003e keys\n  workspace_api_keys = {\n    viewer = {\n      key_name        = \u003cspan class=\"hljs-string\"\u003e\"viewer\"\u003c/span\u003e\n      key_role        = \u003cspan class=\"hljs-string\"\u003e\"VIEWER\"\u003c/span\u003e\n      seconds_to_live = \u003cspan class=\"hljs-number\"\u003e3600\u003c/span\u003e\n    }\n    editor = {\n      key_name        = \u003cspan class=\"hljs-string\"\u003e\"editor\"\u003c/span\u003e\n      key_role        = \u003cspan class=\"hljs-string\"\u003e\"EDITOR\"\u003c/span\u003e\n      seconds_to_live = \u003cspan class=\"hljs-number\"\u003e3600\u003c/span\u003e\n    }\n    admin = {\n      key_name        = \u003cspan class=\"hljs-string\"\u003e\"admin\"\u003c/span\u003e\n      key_role        = \u003cspan class=\"hljs-string\"\u003e\"ADMIN\"\u003c/span\u003e\n      seconds_to_live = \u003cspan class=\"hljs-number\"\u003e3600\u003c/span\u003e\n    }\n  }\n\n  # \u003cspan class=\"hljs-title class_\"\u003eWorkspace\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eIAM\u003c/span\u003e role\n  create_iam_role                = \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e\n  iam_role_name                  = local.\u003cspan class=\"hljs-property\"\u003ename\u003c/span\u003e\n  use_iam_role_name_prefix       = \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e\n  iam_role_description           = local.\u003cspan class=\"hljs-property\"\u003edescription\u003c/span\u003e\n  iam_role_path                  = \u003cspan class=\"hljs-string\"\u003e\"/grafana/\"\u003c/span\u003e\n  iam_role_force_detach_policies = \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e\n  iam_role_max_session_duration  = \u003cspan class=\"hljs-number\"\u003e7200\u003c/span\u003e\n  iam_role_tags                  = { role = \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e }\n\n\n  tags = local.\u003cspan class=\"hljs-property\"\u003etags\u003c/span\u003e\n}\n\n\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"managed_grafana_default\"\u003c/span\u003e {\n  source = \u003cspan class=\"hljs-string\"\u003e\"terraform-aws-modules/managed-service-grafana/aws\"\u003c/span\u003e\n\n  name              = \u003cspan class=\"hljs-string\"\u003e\"${local.name}-default\"\u003c/span\u003e\n  associate_license = \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e\n\n  tags = local.\u003cspan class=\"hljs-property\"\u003etags\u003c/span\u003e\n}\n\n\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"managed_grafana_disabled\"\u003c/span\u003e {\n  source = \u003cspan class=\"hljs-string\"\u003e\"terraform-aws-modules/managed-service-grafana/aws\"\u003c/span\u003e\n\n  name   = local.\u003cspan class=\"hljs-property\"\u003ename\u003c/span\u003e\n  create = \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e\n}\n\n################################################################################\n# \u003cspan class=\"hljs-title class_\"\u003eSupporting\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eResources\u003c/span\u003e\n################################################################################\n\n\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"vpc\"\u003c/span\u003e {\n  source  = \u003cspan class=\"hljs-string\"\u003e\"terraform-aws-modules/vpc/aws\"\u003c/span\u003e\n  version = \u003cspan class=\"hljs-string\"\u003e\"~\u003e 5.0\"\u003c/span\u003e\n\n  name = local.\u003cspan class=\"hljs-property\"\u003ename\u003c/span\u003e\n  cidr = local.\u003cspan class=\"hljs-property\"\u003evpc_cidr\u003c/span\u003e\n\n  azs             = local.\u003cspan class=\"hljs-property\"\u003eazs\u003c/span\u003e\n  private_subnets = [\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e k, v \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e local.\u003cspan class=\"hljs-property\"\u003eazs\u003c/span\u003e : \u003cspan class=\"hljs-title function_\"\u003ecidrsubnet\u003c/span\u003e(local.\u003cspan class=\"hljs-property\"\u003evpc_cidr\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e, k)]\n  public_subnets  = [\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e k, v \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e local.\u003cspan class=\"hljs-property\"\u003eazs\u003c/span\u003e : \u003cspan class=\"hljs-title function_\"\u003ecidrsubnet\u003c/span\u003e(local.\u003cspan class=\"hljs-property\"\u003evpc_cidr\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e, k + \u003cspan class=\"hljs-number\"\u003e48\u003c/span\u003e)]\n\n  enable_nat_gateway = \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e\n  single_nat_gateway = \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e\n\n  tags = local.\u003cspan class=\"hljs-property\"\u003etags\u003c/span\u003e\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003e\"versions.tf\" íŒŒì¼ì…ë‹ˆë‹¤:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eterraform {\n  required_version = \u003cspan class=\"hljs-string\"\u003e\"\u003e= 1.0\"\u003c/span\u003e\n\n  required_providers {\n    aws = {\n      source  = \u003cspan class=\"hljs-string\"\u003e\"hashicorp/aws\"\u003c/span\u003e\n      version = \u003cspan class=\"hljs-string\"\u003e\"\u003e= 5.0\"\u003c/span\u003e\n    }\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eì´ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë ¤ë©´ ë‹¤ìŒì„ ì‹¤í–‰í•´ì•¼ í•©ë‹ˆë‹¤:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ terraform init\n$ terraform plan\n$ terraform apply\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eí”„ë¡œë©”í…Œìš°ìŠ¤ ethtool ìµìŠ¤í¬í„° ë°°ì¹˜:\u003c/p\u003e\n\u003cp\u003eethtoolì€ ì›Œì»¤ ë…¸ë“œì˜ ì´ë”ë„· ì¥ì¹˜ì— ëŒ€í•œ ì •ë³´ë¥¼ êµ¬ì„±í•˜ê³  ìˆ˜ì§‘í•˜ëŠ” ë¦¬ëˆ…ìŠ¤ ë„êµ¬ì…ë‹ˆë‹¤. ìš°ë¦¬ëŠ” ethtoolì˜ ì¶œë ¥ì„ ì‚¬ìš©í•˜ì—¬ íŒ¨í‚· ì†ì‹¤ì„ ê°ì§€í•˜ê³  ì´ë¥¼ í”„ë¡œë©”í…Œìš°ìŠ¤ ethtool ìµìŠ¤í¬í„° ìœ í‹¸ë¦¬í‹°ë¥¼ ì‚¬ìš©í•˜ì—¬ í”„ë¡œë©”í…Œìš°ìŠ¤ í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•  ê²ƒì…ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eë°°í¬ì—ëŠ” ethtoolì—ì„œ ì •ë³´ë¥¼ ê°€ì ¸ ì™€ì„œ í”„ë¡œë©”í…Œìš°ìŠ¤ í˜•ì‹ìœ¼ë¡œ ê²Œì‹œí•˜ëŠ” Python ìŠ¤í¬ë¦½íŠ¸ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003ekubectl apply -f \u003cspan class=\"hljs-attr\"\u003ehttps\u003c/span\u003e:\u003cspan class=\"hljs-comment\"\u003e//raw.githubusercontent.com/Showmax/prometheus-ethtool-exporter/master/deploy/k8s-daemonset.yaml\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eì´ì œ ADOT ìˆ˜ì§‘ê¸°ë¥¼ ë°°í¬í•˜ê³  ADOT ìˆ˜ì§‘ê¸°ë¥¼ êµ¬ì„±í•˜ì—¬ Amazon Managed Service for Prometheusë¡œ ë©”íŠ¸ë¦­ì„ ìˆ˜ì§‘í•  ê²ƒì…ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eìš°ë¦¬ëŠ” Amazon EKS ì• ë“œì˜¨ì„ ì‚¬ìš©í•˜ì—¬ ADOT ì˜¤í¼ë ˆì´í„°ë¥¼ CoreDNS ëª¨ë‹ˆí„°ë§ì„ ìœ„í•´ ë©”íŠ¸ë¦­ \"linklocal_allowance_exceeded\"ë¥¼ Amazon Managed Service for Prometheusë¡œ ë³´ë‚´ê²Œ ë  ê²ƒì…ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eIAM ì—­í• ê³¼ Amazon EKS ì„œë¹„ìŠ¤ ê³„ì •ì„ ìƒì„±í•˜ì„¸ìš”.\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eADOT ìˆ˜ì§‘ê¸°ë¥¼ Kubernetes ì„œë¹„ìŠ¤ ê³„ì • \"adot-collector\"ì˜ ì‹ ì›ìœ¼ë¡œ ë°°í¬í•  ì˜ˆì •ì…ë‹ˆë‹¤. ì„œë¹„ìŠ¤ ê³„ì •ì— IAM ì—­í• (IRSA)ì„ ì—°ê²°í•˜ì—¬ Kubernetes ì„œë¹„ìŠ¤ ê³„ì •ì— AmazonPrometheusRemoteWriteAccess ì—­í• ì„ í• ë‹¹í•¨ìœ¼ë¡œì¨ í•´ë‹¹ ì„œë¹„ìŠ¤ ê³„ì •ì„ í™œìš©í•˜ëŠ” ëª¨ë“  íŒŒë“œê°€ Amazon Managed Service for Prometheusì— ë©”íŠ¸ë¦­ì„ ìˆ˜ì§‘í•˜ëŠ” ë° í•„ìš”í•œ IAM ê¶Œí•œì„ ë¶€ì—¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ë ¤ë©´ kubectl ë° eksctl CLI ë„êµ¬ê°€ í•„ìš”í•©ë‹ˆë‹¤. ì´ ë„êµ¬ë“¤ì€ Amazon EKS í´ëŸ¬ìŠ¤í„°ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆë„ë¡ êµ¬ì„±ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eeksctl create iamserviceaccount \\\n--name adot-collector \\\n--namespace \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e \\\n--region eu-west-\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\\\n--cluster coredns-monitoring-demo\\\n--attach-policy-arn \u003cspan class=\"hljs-attr\"\u003earn\u003c/span\u003e:\u003cspan class=\"hljs-attr\"\u003eaws\u003c/span\u003e:\u003cspan class=\"hljs-attr\"\u003eiam\u003c/span\u003e::\u003cspan class=\"hljs-attr\"\u003eaws\u003c/span\u003e:policy/\u003cspan class=\"hljs-title class_\"\u003eAmazonPrometheusRemoteWriteAccess\u003c/span\u003e \\\n--approve \\\n--override-existing-serviceaccounts\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eADOT ì• ë“œì˜¨ ì„¤ì¹˜í•˜ê¸°:\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eì—¬ëŸ¬ë¶„ì€ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ Amazon EKSì˜ ë‹¤ë¥¸ ë²„ì „ì— í™œì„±í™”ëœ ì• ë“œì˜¨ ëª©ë¡ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\u003c/p\u003e\n\u003cp\u003eí´ëŸ¬ìŠ¤í„° ë²„ì „ì—ì„œ ì§€ì›í•˜ëŠ” ADOT ë²„ì „ì„ í™•ì¸í•˜ì‹­ì‹œì˜¤.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eaws eks describe-addon-versions --addon-name adot --kubernetes-version \u003cspan class=\"hljs-number\"\u003e1.28\u003c/span\u003e \\\n  --query \u003cspan class=\"hljs-string\"\u003e\"addons[].addonVersions[].[addonVersion, compatibilities[].defaultVersion]\"\u003c/span\u003e --output text\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ ADOT ì• ë“œì˜¨ì„ ì„¤ì¹˜í•˜ì‹­ì‹œì˜¤. ìœ„ ë‹¨ê³„ì—ì„œ ê¸°ìˆ ëœ ê²ƒì— ë”°ë¼ --addon-version í”Œë˜ê·¸ë¥¼ êµì²´í•˜ì‹­ì‹œì˜¤.\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eaws eks create-addon --addon-name adot --addon-version v0\u003cspan class=\"hljs-number\"\u003e.66\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e-eksbuild\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e --cluster-name coredns-monitoring-demo\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ ADOT ì• ë“œì˜¨ì´ ì¤€ë¹„ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003ekubectl get po -n opentelemetry-operator-system\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eë‹¤ìŒ ì ˆì°¨ëŠ” ë°°í¬ë¥¼ ëª¨ë“œ ê°’ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ì˜ˆì œ YAML íŒŒì¼ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ì´ëŠ” ê¸°ë³¸ ëª¨ë“œì´ë©° ADOT Collectorë¥¼ ë…ë¦½ ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ ìœ ì‚¬í•˜ê²Œ ë°°í¬í•©ë‹ˆë‹¤. ì´ êµ¬ì„±ì€ ìƒ˜í”Œ ì• í”Œë¦¬ì¼€ì´ì…˜ìœ¼ë¡œë¶€í„° OTLP ë©”íŠ¸ë¦­ì„ ìˆ˜ì‹ í•˜ê³  í´ëŸ¬ìŠ¤í„°ì˜ podì—ì„œ ìŠ¤í¬ë˜í•‘ëœ Amazon Managed Service for Prometheus ë©”íŠ¸ë¦­ì„ ìˆ˜ì‹ í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003ecurl -o collector-config-amp.yaml \u003ca href=\"https://raw.githubusercontent.com/aws-observability/aws-otel-community/master/sample-configs/operator/collector-config-amp.yaml\" rel=\"nofollow\" target=\"_blank\"\u003ehttps://raw.githubusercontent.com/aws-observability/aws-otel-community/master/sample-configs/operator/collector-config-amp.yaml\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003ecollector-config-amp.yaml íŒŒì¼ì—ì„œ ë‹¤ìŒì„ ë³¸ì¸ì˜ ê°’ìœ¼ë¡œ ë°”ê¿”ì£¼ì„¸ìš”: _ mode: deployment _ serviceAccount: adot-collector _ endpoint: \"\" _ region: \"\" * name: adot-collector\u003c/p\u003e\n\u003cp\u003ekubectl apply -f collector-config-amp.yaml\u003c/p\u003e\n\u003cp\u003eadot collectorê°€ ë°°í¬ë˜ë©´ ë©”íŠ¸ë¦­ì´ Amazon Prometheusì— ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eAmazon Managed Grafanaì—ì„œ ethtool ë©”íŠ¸ë¦­ì„ ì‹œê°í™”í•´ë³´ì„¸ìš”:\u003c/p\u003e\n\u003cp\u003eAmazon Managed Grafana ì½˜ì†” ë‚´ì—ì„œ Prometheus ì›Œí¬ìŠ¤í˜ì´ìŠ¤ë¥¼ ë°ì´í„° ì†ŒìŠ¤ë¡œ êµ¬ì„±í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eì´ì œ Amazon Managed Grafanaì—ì„œ ë©”íŠ¸ë¦­ì„ ì‚´í´ë´…ì‹œë‹¤: \"íƒìƒ‰\" ë²„íŠ¼ì„ í´ë¦­í•œ í›„ ethtoolì„ ê²€ìƒ‰í•˜ì„¸ìš”:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance_2.png\" alt=\"ì´ë¯¸ì§€\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eë§í¬ë¡œì»¬ í• ë‹¹ ì´ˆê³¼ ë©”íŠ¸ë¦­ì„ ì‚¬ìš©í•˜ì—¬ ëŒ€ì‹œë³´ë“œë¥¼ ë§Œë“¤ì–´ ë´…ì‹œë‹¤. ì¿¼ë¦¬ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-title function_\"\u003erate\u003c/span\u003e(node_net_ethtool{device=\u003cspan class=\"hljs-string\"\u003e\"eth0\"\u003c/span\u003e,type=\u003cspan class=\"hljs-string\"\u003e\"linklocal_allowance_exceeded\"\u003c/span\u003e} [30s])\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance_3.png\" alt=\"ì´ë¯¸ì§€\"\u003e\u003c/p\u003e\n\u003cp\u003eê°’ì´ 0ì´ê¸° ë•Œë¬¸ì— ë“œëëœ íŒ¨í‚·ì´ ì—†ë‹¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Amazon Managed Service for Prometheusì˜ ê²½ê³  ê´€ë¦¬ìì—ì„œ ì•Œë¦¼ì„ êµ¬ì„±í•˜ì—¬ ì•Œë¦¼ì„ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003ch1\u003eê²°ë¡ :\u003c/h1\u003e\n\u003cp\u003eì´ ê¸€ì—ì„œëŠ” AWS Distro for OpenTelemetry (ADOT), Amazon Managed Service for Prometheus ë° Amazon Managed Grafanaë¥¼ ì‚¬ìš©í•˜ì—¬ CoreDNS ì“°ë¡œí‹€ë§ ë¬¸ì œë¥¼ ëª¨ë‹ˆí„°ë§í•˜ê³  ê²½ê³ ë¥¼ ìƒì„±í•˜ëŠ” ë°©ë²•ì„ ë³´ì—¬ë“œë ¸ìŠµë‹ˆë‹¤. CoreDNS ë©”íŠ¸ë¦­ì„ ëª¨ë‹ˆí„°ë§í•¨ìœ¼ë¡œì¨ ê³ ê°ì€ íŒ¨í‚· ì†ì‹¤ì„ ì‚¬ì „ì— ê°ì§€í•˜ê³  ì˜ˆë°© ì¡°ì¹˜ë¥¼ ì·¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eë‹¤ìŒì— ë˜ ë§Œë‚˜ìš” ğŸ‡µğŸ‡¸ ğŸ‰\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance_4.png\" alt=\"ì´ë¯¸ì§€\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eì½ì–´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤!! ğŸ™ŒğŸ»ğŸ˜ğŸ“ƒ, ë‹¤ìŒ ë¸”ë¡œê·¸ì—ì„œ ë§Œë‚˜ìš”.ğŸ¤˜ğŸ‡µğŸ‡¸\u003c/p\u003e\n\u003cp\u003eğŸš€ ëê¹Œì§€ í•¨ê»˜í•´ ì¤˜ì„œ ê°ì‚¬í•©ë‹ˆë‹¤. ì´ ë¸”ë¡œê·¸ì— ê´€í•œ ì§ˆë¬¸/í”¼ë“œë°±ì´ ìˆìœ¼ë©´ ì–¸ì œë“ ì§€ ì—°ë½í•´ ì£¼ì„¸ìš”:\u003c/p\u003e\n\u003cp\u003eâ™»ï¸ ğŸ‡µğŸ‡¸LinkedIn: \u003ca href=\"https://www.linkedin.com/in/rajhi-saif/\" rel=\"nofollow\" target=\"_blank\"\u003ehttps://www.linkedin.com/in/rajhi-saif/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eâ™»ï¸ğŸ‡µğŸ‡¸ Twitter : \u003ca href=\"https://twitter.com/rajhisaifeddine\" rel=\"nofollow\" target=\"_blank\"\u003ehttps://twitter.com/rajhisaifeddine\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eë! âœŒğŸ»\u003c/p\u003e\n\u003ch1\u003eğŸ”° ê³„ì† ë°°ìš°ê³ !! ê³„ì† ê³µìœ í•´ìš”!! ğŸ”°\u003c/h1\u003e\n\u003ch1\u003eì°¸ê³ :\u003c/h1\u003e\n\u003cp\u003e\u003ca href=\"https://aws.amazon.com/blogs/mt/monitoring-coredns-for-dns-throttling-issues-using-aws-open-source-monitoring-services/\" rel=\"nofollow\" target=\"_blank\"\u003ehttps://aws.amazon.com/blogs/mt/monitoring-coredns-for-dns-throttling-issues-using-aws-open-source-monitoring-services/\u003c/a\u003e\u003c/p\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance"},"buildId":"bb_yO9GbCvdfc_n71SfUf","isFallback":false,"gsp":true,"scriptLoader":[{"async":true,"src":"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4877378276818686","strategy":"lazyOnload","crossOrigin":"anonymous"}]}</script></body></html>