<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>TryHackMe Writeup - CyberLens를 번역해보겠습니다 | ui-station</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://ui-station.github.io///post/2024-05-20-TryHackMeWriteup-CyberLens" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="TryHackMe Writeup - CyberLens를 번역해보겠습니다 | ui-station" data-gatsby-head="true"/><meta property="og:title" content="TryHackMe Writeup - CyberLens를 번역해보겠습니다 | ui-station" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-05-20-TryHackMeWriteup-CyberLens_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://ui-station.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://ui-station.github.io///post/2024-05-20-TryHackMeWriteup-CyberLens" data-gatsby-head="true"/><meta name="twitter:title" content="TryHackMe Writeup - CyberLens를 번역해보겠습니다 | ui-station" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-05-20-TryHackMeWriteup-CyberLens_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | ui-station" data-gatsby-head="true"/><meta name="article:published_time" content="2024-05-20 18:10" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-BHFR6GTH9P"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
          
            gtag('config', 'G-BHFR6GTH9P');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b8ef307c9aee1e34.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b8ef307c9aee1e34.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-4a646156c659a948.js" defer=""></script><script src="/_next/static/chunks/348-d11c34b645b13f5b.js" defer=""></script><script src="/_next/static/chunks/162-4172e84c8e2aa747.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-4f7b40c1114f0d09.js" defer=""></script><script src="/_next/static/o1YmnmSuZvAX2O4TI9r41/_buildManifest.js" defer=""></script><script src="/_next/static/o1YmnmSuZvAX2O4TI9r41/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">UI STATION</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">TryHackMe Writeup - CyberLens를 번역해보겠습니다</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="TryHackMe Writeup - CyberLens를 번역해보겠습니다" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">UI STATION</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On May 20, 2024</span><span class="posts_reading_time__f7YPP">6<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-05-20-TryHackMeWriteup-CyberLens&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<h2>CyberLens 웹 서버를 악용하고 숨겨진 플래그를 발견할 수 있을까요?</h2>
<p>"사이버 렌즈" CTF 룸에 오신 것을 환영합니다!</p>
<p>2024년 5월 17일에 공개된 이 CTF 챌린지는 약 120분 정도 소요되며 "쉬움" 난이도로 평가됩니다.
하지만 제 개인적인 경험에 따르면, 완료하는 데 2시간이 넘게 걸렸어요.</p>
<p>🕵️‍♂️ 준비가 되셨나요? 룸을 찾을 수 있습니다.</p>
<p>🔍 챌린지 설명 확인: 챌린지에 대한 자세한 내용은 방의 내용을 확인하세요.</p>
<p><img src="/assets/img/2024-05-20-TryHackMeWriteup-CyberLens_0.png" alt="이미지"></p>
<h2>주의 사항</h2>
<ol>
<li>IP를 /etc/hosts 파일에 추가하세요: <code>sudo echo [IP] cyberlens.thm >> /etc/hosts</code></li>
</ol>
<p>이 공간은 CyberLens 및 그들의 전문 도구에 대해 다루며, 스테가노그래피에 초점을 맞출 수도 있습니다. 화법 및 메타데이터를 위해 이미지를 분석하거나 숨겨진 플래그를 찾기 위해 이러한 도구 내의 취약점을 이용할 수도 있습니다.</p>
<h2>열거</h2>
<p>우리는 빠른 스캔을 위해 올드스쿨 nmap으로 시작합니다.
그리고 흥미로운 포트가 열려 있는 것을 발견합니다</p>
<pre><code class="hljs language-js">─# nmap <span class="hljs-number">10.10</span><span class="hljs-number">.189</span><span class="hljs-number">.206</span> -A
<span class="hljs-title class_">Starting</span> <span class="hljs-title class_">Nmap</span> <span class="hljs-number">7.</span>94SVN ( <span class="hljs-attr">https</span>:<span class="hljs-comment">//nmap.org ) at 2024-05-18 09:40 EDT</span>
<span class="hljs-title class_">Nmap</span> scan report <span class="hljs-keyword">for</span> cyberlens.<span class="hljs-property">thm</span> (<span class="hljs-number">10.10</span><span class="hljs-number">.189</span><span class="hljs-number">.206</span>)
<span class="hljs-title class_">Host</span> is up (<span class="hljs-number">0.</span>10s latency).
<span class="hljs-title class_">Not</span> <span class="hljs-attr">shown</span>: <span class="hljs-number">995</span> closed tcp ports (reset)
<span class="hljs-variable constant_">PORT</span>     <span class="hljs-variable constant_">STATE</span> <span class="hljs-variable constant_">SERVICE</span>       <span class="hljs-variable constant_">VERSION</span>
<span class="hljs-number">80</span>/tcp   open  http          <span class="hljs-title class_">Apache</span> httpd <span class="hljs-number">2.4</span><span class="hljs-number">.57</span> ((<span class="hljs-title class_">Win64</span>))
|_http-server-<span class="hljs-attr">header</span>: <span class="hljs-title class_">Apache</span>/<span class="hljs-number">2.4</span><span class="hljs-number">.57</span> (<span class="hljs-title class_">Win64</span>)
| http-<span class="hljs-attr">methods</span>: 
|_  <span class="hljs-title class_">Potentially</span> risky <span class="hljs-attr">methods</span>: <span class="hljs-variable constant_">TRACE</span>
|_http-<span class="hljs-attr">title</span>: <span class="hljs-title class_">CyberLens</span>: <span class="hljs-title class_">Unveiling</span> the <span class="hljs-title class_">Hidden</span> <span class="hljs-title class_">Matrix</span>
<span class="hljs-number">135</span>/tcp  open  msrpc         <span class="hljs-title class_">Microsoft</span> <span class="hljs-title class_">Windows</span> <span class="hljs-variable constant_">RPC</span>
<span class="hljs-number">139</span>/tcp  open  netbios-ssn   <span class="hljs-title class_">Microsoft</span> <span class="hljs-title class_">Windows</span> netbios-ssn
<span class="hljs-number">445</span>/tcp  open  microsoft-ds?
<span class="hljs-number">3389</span>/tcp open  ms-wbt-server <span class="hljs-title class_">Microsoft</span> <span class="hljs-title class_">Terminal</span> <span class="hljs-title class_">Services</span>
| ssl-<span class="hljs-attr">cert</span>: <span class="hljs-title class_">Subject</span>: commonName=<span class="hljs-title class_">CyberLens</span>
| <span class="hljs-title class_">Not</span> valid <span class="hljs-attr">before</span>: <span class="hljs-number">2024</span>-<span class="hljs-number">05</span>-17<span class="hljs-attr">T13</span>:<span class="hljs-number">10</span>:<span class="hljs-number">13</span>
|_Not valid <span class="hljs-attr">after</span>:  <span class="hljs-number">2024</span>-<span class="hljs-number">11</span>-16<span class="hljs-attr">T13</span>:<span class="hljs-number">10</span>:<span class="hljs-number">13</span>
| rdp-ntlm-<span class="hljs-attr">info</span>: 
|   <span class="hljs-title class_">Target</span><span class="hljs-attr">_Name</span>: <span class="hljs-variable constant_">CYBERLENS</span>
|   <span class="hljs-title class_">NetBIOS</span><span class="hljs-attr">_Domain_Name</span>: <span class="hljs-variable constant_">CYBERLENS</span>
|   <span class="hljs-title class_">NetBIOS</span><span class="hljs-attr">_Computer_Name</span>: <span class="hljs-variable constant_">CYBERLENS</span>
|   <span class="hljs-attr">DNS_Domain_Name</span>: <span class="hljs-title class_">CyberLens</span>
|   <span class="hljs-attr">DNS_Computer_Name</span>: <span class="hljs-title class_">CyberLens</span>
|   <span class="hljs-title class_">Product</span><span class="hljs-attr">_Version</span>: <span class="hljs-number">10.0</span><span class="hljs-number">.17763</span>
|_  <span class="hljs-title class_">System</span><span class="hljs-attr">_Time</span>: <span class="hljs-number">2024</span>-<span class="hljs-number">05</span>-18<span class="hljs-attr">T13</span>:<span class="hljs-number">47</span>:<span class="hljs-number">39</span>+<span class="hljs-number">00</span>:<span class="hljs-number">00</span>
|_ssl-<span class="hljs-attr">date</span>: <span class="hljs-number">2024</span>-<span class="hljs-number">05</span>-18<span class="hljs-attr">T13</span>:<span class="hljs-number">47</span>:<span class="hljs-number">47</span>+<span class="hljs-number">00</span>:<span class="hljs-number">00</span>; -10s <span class="hljs-keyword">from</span> scanner time.
<span class="hljs-title class_">No</span> exact <span class="hljs-variable constant_">OS</span> matches <span class="hljs-keyword">for</span> host (<span class="hljs-title class_">If</span> you know what <span class="hljs-variable constant_">OS</span> is running on it, see <span class="hljs-attr">https</span>:<span class="hljs-comment">//nmap.org/submit/ ).</span>
<span class="hljs-variable constant_">TCP</span>/<span class="hljs-variable constant_">IP</span> <span class="hljs-attr">fingerprint</span>:
<span class="hljs-attr">OS</span>:<span class="hljs-title function_">SCAN</span>(V=<span class="hljs-number">7</span>)... redacted ...

<span class="hljs-title class_">Network</span> <span class="hljs-title class_">Distance</span>: <span class="hljs-number">2</span> hops
<span class="hljs-title class_">Service</span> <span class="hljs-title class_">Info</span>: <span class="hljs-attr">OS</span>: <span class="hljs-title class_">Windows</span>; <span class="hljs-attr">CPE</span>: <span class="hljs-attr">cpe</span>:/<span class="hljs-attr">o</span>:<span class="hljs-attr">microsoft</span>:windows

<span class="hljs-title class_">Host</span> script <span class="hljs-attr">results</span>:
| smb2-<span class="hljs-attr">time</span>: 
|   <span class="hljs-attr">date</span>: <span class="hljs-number">2024</span>-<span class="hljs-number">05</span>-18<span class="hljs-attr">T13</span>:<span class="hljs-number">47</span>:<span class="hljs-number">41</span>
|_  <span class="hljs-attr">start_date</span>: N/A
|_clock-<span class="hljs-attr">skew</span>: <span class="hljs-attr">mean</span>: -10s, <span class="hljs-attr">deviation</span>: 0s, <span class="hljs-attr">median</span>: -10s
| smb2-security-<span class="hljs-attr">mode</span>: 
|   <span class="hljs-number">3</span>:<span class="hljs-number">1</span>:<span class="hljs-number">1</span>: 
|_    <span class="hljs-title class_">Message</span> signing enabled but not required

<span class="hljs-variable constant_">TRACEROUTE</span> (using port <span class="hljs-number">587</span>/tcp)
<span class="hljs-variable constant_">HOP</span> <span class="hljs-variable constant_">RTT</span>       <span class="hljs-variable constant_">ADDRESS</span>
<span class="hljs-number">1</span>   <span class="hljs-number">125.60</span> ms <span class="hljs-number">10.9</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>
<span class="hljs-number">2</span>   <span class="hljs-number">121.35</span> ms cyberlens.<span class="hljs-property">thm</span> (<span class="hljs-number">10.10</span><span class="hljs-number">.189</span><span class="hljs-number">.206</span>)

<span class="hljs-variable constant_">OS</span> and <span class="hljs-title class_">Service</span> detection performed. <span class="hljs-title class_">Please</span> report any incorrect results at <span class="hljs-attr">https</span>:<span class="hljs-comment">//nmap.org/submit/ .</span>
<span class="hljs-title class_">Nmap</span> <span class="hljs-attr">done</span>: <span class="hljs-number">1</span> <span class="hljs-variable constant_">IP</span> address (<span class="hljs-number">1</span> host up) scanned <span class="hljs-keyword">in</span> <span class="hljs-number">464.64</span> seconds
</code></pre>
<ul>
<li>80/tcp: Apache httpd 2.4.57에서 오픈된 HTTP — CVE 발견 안 됨</li>
<li>135/tcp: Microsoft Windows RPC 오픈</li>
<li>139/tcp: Microsoft Windows netbios-ssn 오픈</li>
<li>445/tcp: Microsoft-DS 오픈</li>
<li>3389/tcp: Microsoft Terminal Services (RDP) 오픈</li>
</ul>
<p>우리는 웹사이트를 돌아다니다가, dirb를 실행하여 새로운 디렉토리를 발견하였어요.</p>
<p><img src="/assets/img/2024-05-20-TryHackMeWriteup-CyberLens_1.png" alt="이미지"></p>
<p>우리의 관심을 끄는 두 가지 발견:</p>
<ol>
<li>연락 양식: 현재 유용한 정보가 없습니다.</li>
<li>이미지 추출기: 저희 조사에 대한 잠재적인 통찰력을 약속하는 온라인 메타데이터 추출 서비스입니다.</li>
</ol>
<p><img src="/assets/img/2024-05-20-TryHackMeWriteup-CyberLens_2.png" alt="이미지"></p>
<p>나는 <a href="http://cyberlens.thm/images/%EC%97%90%EC%84%9C" rel="nofollow" target="_blank">http://cyberlens.thm/images/에서</a> 찾은 이미지를 힌트를 얻기 위해 도구에 업로드했지만 유용한 메타데이터를 찾을 수 없었습니다.</p>
<p>다음으로 "메타데이터 가져오기" 버튼을 조사하고 해당 이벤트를 추적했습니다. 이로써 다음이 드러났습니다:</p>
<p>nmap 결과에 이 포트가 나오지 않았어요. 이 포트는 일반적이지 않은 포트라서이고, -p- 플래그를 사용하지 않았기 때문입니다. 일반적으로는 권장되지 않아요.</p>
<p>첫 번째로는 해당 아파치 티카 버전에 대한 CVE를 찾아보는 거에요.</p>
<p>Metasploit을 시작하고,</p>
<p><img src="/assets/img/2024-05-20-TryHackMeWriteup-CyberLens_5.png" alt="CyberLens_5"></p>
<h2>접근 방법</h2>
<p>Metasploit을 구성하고 (set RHOSTS, RPORT, LPORT), 그런 다음 exploit을 실행합니다. 그리고 바로 Meterpreter 세션을 열었습니다. 와우!</p>
<p><img src="/assets/img/2024-05-20-TryHackMeWriteup-CyberLens_6.png" alt="이미지"></p>
<p>우선 CyberLens의 문서에서 깃발을 찾으려고 했어요. 대신 관리 부분을 우연히 발견했어요. 거기에서 승격을 위해 사용할 자격 증명을 찾았어요.</p>
<p><img src="/assets/img/2024-05-20-TryHackMeWriteup-CyberLens_7.png" alt="이미지"></p>
<p>힌트에서 이해한대로 대부분의 Windows 깃발은 데스크톱에 있기 때문에 거기로 가서 첫 번째 깃발을 얻었어요.</p>
<h2>권한 상슨</h2>
<p>이전에 찾은 자격 증명을 다시 보면, 원격 데스크톱 프로토콜(RDP) 포트 3389과 일치합니다.
그래서 remmina를 실행하지만, 동일한 사용자로 굳어 버린 것을 발견합니다. 이는 클래식한 실수였습니다. 사용자 이름에 주의를 기울이지 않았기 때문입니다. 권한 상슨이 내가 희망했던 만큼 간단하지 않을 것이라는 것을 알게 되었습니다. 그럼에도 불구하고 GUI 인터페이스를 보유하고 있기 때문에 이제 시스템을 쉽게 탐색할 방법이 제공되었습니다.</p>
<p>다음으로 모든 서비스를 나열했습니다:</p>
<pre><code class="hljs language-js">sc.<span class="hljs-property">exe</span> query state=all
</code></pre>
<p>하지만 리스트가 굉장히 길었고, 수작업으로 걸러내는 대신 더 포괄적인 분석을 위해 WinPEAS를 실행하기로 결정했습니다.</p>
<p>이미 존재하는 Metasploit 쉘을 고려할 때, 나는 나의 접근 방식을 전환했습니다. WinPEAS 대신 Metasploit의 multi/recon/local_exploit_suggester 모듈을 사용하여 권한 상승을 위한 잠재적인 취약점을 식별했습니다.</p>
<p>세션을 설정하고 모듈을 실행하여 총 세 가지 취약점을 발견했어요. 먼저 첫 번째 취약점부터 시작해서 해당 옵션을 구성한 후(exploit를 실행하기 전에 LHOST, LPORT, SESSION을 설정해주세요).</p>
<p>그리고 이제 NT AUTHORITY\SYSTEM으로 권한 상승했어요.</p>
<p><img src="/assets/img/2024-05-20-TryHackMeWriteup-CyberLens_10.png" alt="TryHackMeWriteup-CyberLens_10"></p>
<p>관리자의 데스크톱에 깃발이 있을 거에요.</p>
<h1>결론</h1>
<ul>
<li>주의 깊은 열거: 중요한 서비스를 식별하면서 모든 포트를 스캔하는 것을 잊지 마세요 (-p-).</li>
<li>수동 열거: 잠재적으로 간과된 단서를 잡는 데 중요합니다.</li>
<li>도전의 조합: 웹 취약점 분석과 권한 상승을 결합했습니다.</li>
<li>적응성 있는 전략: 수동 서비스 분석 및 WinPEAS에서 Metasploit의 익스플로잇 제안자로 전환했습니다.</li>
<li>주요 발견: 취약점을 발견하고 악용하여 사용자와 관리자 깃발을 얻었습니다.</li>
<li>필수 기술: 적응적 전략 및 실용적 사이버 보안 기술을 강화했습니다.</li>
</ul>
<p>LinkedIn에서 저와 연결하세요.</p>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"TryHackMe Writeup - CyberLens를 번역해보겠습니다","description":"","date":"2024-05-20 18:10","slug":"2024-05-20-TryHackMeWriteup-CyberLens","content":"\n\n## CyberLens 웹 서버를 악용하고 숨겨진 플래그를 발견할 수 있을까요?\n\n\"사이버 렌즈\" CTF 룸에 오신 것을 환영합니다!\n\n2024년 5월 17일에 공개된 이 CTF 챌린지는 약 120분 정도 소요되며 \"쉬움\" 난이도로 평가됩니다.\n하지만 제 개인적인 경험에 따르면, 완료하는 데 2시간이 넘게 걸렸어요.\n\n🕵️‍♂️ 준비가 되셨나요? 룸을 찾을 수 있습니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n🔍 챌린지 설명 확인: 챌린지에 대한 자세한 내용은 방의 내용을 확인하세요.\n\n![이미지](/assets/img/2024-05-20-TryHackMeWriteup-CyberLens_0.png)\n\n## 주의 사항\n\n1. IP를 /etc/hosts 파일에 추가하세요: `sudo echo [IP] cyberlens.thm \u003e\u003e /etc/hosts`\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n\n이 공간은 CyberLens 및 그들의 전문 도구에 대해 다루며, 스테가노그래피에 초점을 맞출 수도 있습니다. 화법 및 메타데이터를 위해 이미지를 분석하거나 숨겨진 플래그를 찾기 위해 이러한 도구 내의 취약점을 이용할 수도 있습니다.\n\n## 열거\n\n우리는 빠른 스캔을 위해 올드스쿨 nmap으로 시작합니다.\n그리고 흥미로운 포트가 열려 있는 것을 발견합니다\n\n```js\n─# nmap 10.10.189.206 -A\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-18 09:40 EDT\nNmap scan report for cyberlens.thm (10.10.189.206)\nHost is up (0.10s latency).\nNot shown: 995 closed tcp ports (reset)\nPORT     STATE SERVICE       VERSION\n80/tcp   open  http          Apache httpd 2.4.57 ((Win64))\n|_http-server-header: Apache/2.4.57 (Win64)\n| http-methods: \n|_  Potentially risky methods: TRACE\n|_http-title: CyberLens: Unveiling the Hidden Matrix\n135/tcp  open  msrpc         Microsoft Windows RPC\n139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn\n445/tcp  open  microsoft-ds?\n3389/tcp open  ms-wbt-server Microsoft Terminal Services\n| ssl-cert: Subject: commonName=CyberLens\n| Not valid before: 2024-05-17T13:10:13\n|_Not valid after:  2024-11-16T13:10:13\n| rdp-ntlm-info: \n|   Target_Name: CYBERLENS\n|   NetBIOS_Domain_Name: CYBERLENS\n|   NetBIOS_Computer_Name: CYBERLENS\n|   DNS_Domain_Name: CyberLens\n|   DNS_Computer_Name: CyberLens\n|   Product_Version: 10.0.17763\n|_  System_Time: 2024-05-18T13:47:39+00:00\n|_ssl-date: 2024-05-18T13:47:47+00:00; -10s from scanner time.\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7)... redacted ...\n\nNetwork Distance: 2 hops\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-time: \n|   date: 2024-05-18T13:47:41\n|_  start_date: N/A\n|_clock-skew: mean: -10s, deviation: 0s, median: -10s\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled but not required\n\nTRACEROUTE (using port 587/tcp)\nHOP RTT       ADDRESS\n1   125.60 ms 10.9.0.1\n2   121.35 ms cyberlens.thm (10.10.189.206)\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 464.64 seconds\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n- 80/tcp: Apache httpd 2.4.57에서 오픈된 HTTP — CVE 발견 안 됨\n- 135/tcp: Microsoft Windows RPC 오픈\n- 139/tcp: Microsoft Windows netbios-ssn 오픈\n- 445/tcp: Microsoft-DS 오픈\n- 3389/tcp: Microsoft Terminal Services (RDP) 오픈\n\n우리는 웹사이트를 돌아다니다가, dirb를 실행하여 새로운 디렉토리를 발견하였어요.\n\n![이미지](/assets/img/2024-05-20-TryHackMeWriteup-CyberLens_1.png)\n\n우리의 관심을 끄는 두 가지 발견:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n1. 연락 양식: 현재 유용한 정보가 없습니다.\n2. 이미지 추출기: 저희 조사에 대한 잠재적인 통찰력을 약속하는 온라인 메타데이터 추출 서비스입니다.\n\n![이미지](/assets/img/2024-05-20-TryHackMeWriteup-CyberLens_2.png)\n\n나는 http://cyberlens.thm/images/에서 찾은 이미지를 힌트를 얻기 위해 도구에 업로드했지만 유용한 메타데이터를 찾을 수 없었습니다.\n\n다음으로 \"메타데이터 가져오기\" 버튼을 조사하고 해당 이벤트를 추적했습니다. 이로써 다음이 드러났습니다:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n\u003cimg src=\"/assets/img/2024-05-20-TryHackMeWriteup-CyberLens_3.png\" /\u003e\n\nnmap 결과에 이 포트가 나오지 않았어요. 이 포트는 일반적이지 않은 포트라서이고, -p- 플래그를 사용하지 않았기 때문입니다. 일반적으로는 권장되지 않아요.\n\n\u003cimg src=\"/assets/img/2024-05-20-TryHackMeWriteup-CyberLens_4.png\" /\u003e\n\n첫 번째로는 해당 아파치 티카 버전에 대한 CVE를 찾아보는 거에요.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nMetasploit을 시작하고,\n\n![CyberLens_5](/assets/img/2024-05-20-TryHackMeWriteup-CyberLens_5.png)\n\n## 접근 방법\n\nMetasploit을 구성하고 (set RHOSTS, RPORT, LPORT), 그런 다음 exploit을 실행합니다. 그리고 바로 Meterpreter 세션을 열었습니다. 와우!\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n![이미지](/assets/img/2024-05-20-TryHackMeWriteup-CyberLens_6.png)\n\n우선 CyberLens의 문서에서 깃발을 찾으려고 했어요. 대신 관리 부분을 우연히 발견했어요. 거기에서 승격을 위해 사용할 자격 증명을 찾았어요.\n\n![이미지](/assets/img/2024-05-20-TryHackMeWriteup-CyberLens_7.png)\n\n힌트에서 이해한대로 대부분의 Windows 깃발은 데스크톱에 있기 때문에 거기로 가서 첫 번째 깃발을 얻었어요.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n\u003cimg src=\"/assets/img/2024-05-20-TryHackMeWriteup-CyberLens_8.png\" /\u003e\n\n## 권한 상슨\n\n이전에 찾은 자격 증명을 다시 보면, 원격 데스크톱 프로토콜(RDP) 포트 3389과 일치합니다.\n그래서 remmina를 실행하지만, 동일한 사용자로 굳어 버린 것을 발견합니다. 이는 클래식한 실수였습니다. 사용자 이름에 주의를 기울이지 않았기 때문입니다. 권한 상슨이 내가 희망했던 만큼 간단하지 않을 것이라는 것을 알게 되었습니다. 그럼에도 불구하고 GUI 인터페이스를 보유하고 있기 때문에 이제 시스템을 쉽게 탐색할 방법이 제공되었습니다.\n\n다음으로 모든 서비스를 나열했습니다:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\nsc.exe query state=all\n```\n\n하지만 리스트가 굉장히 길었고, 수작업으로 걸러내는 대신 더 포괄적인 분석을 위해 WinPEAS를 실행하기로 결정했습니다.\n\n이미 존재하는 Metasploit 쉘을 고려할 때, 나는 나의 접근 방식을 전환했습니다. WinPEAS 대신 Metasploit의 multi/recon/local_exploit_suggester 모듈을 사용하여 권한 상승을 위한 잠재적인 취약점을 식별했습니다.\n\n\u003cimg src=\"/assets/img/2024-05-20-TryHackMeWriteup-CyberLens_9.png\" /\u003e\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n세션을 설정하고 모듈을 실행하여 총 세 가지 취약점을 발견했어요. 먼저 첫 번째 취약점부터 시작해서 해당 옵션을 구성한 후(exploit를 실행하기 전에 LHOST, LPORT, SESSION을 설정해주세요).\n\n그리고 이제 NT AUTHORITY\\SYSTEM으로 권한 상승했어요.\n\n![TryHackMeWriteup-CyberLens_10](/assets/img/2024-05-20-TryHackMeWriteup-CyberLens_10.png)\n\n관리자의 데스크톱에 깃발이 있을 거에요.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# 결론\n\n- 주의 깊은 열거: 중요한 서비스를 식별하면서 모든 포트를 스캔하는 것을 잊지 마세요 (-p-).\n- 수동 열거: 잠재적으로 간과된 단서를 잡는 데 중요합니다.\n- 도전의 조합: 웹 취약점 분석과 권한 상승을 결합했습니다.\n- 적응성 있는 전략: 수동 서비스 분석 및 WinPEAS에서 Metasploit의 익스플로잇 제안자로 전환했습니다.\n- 주요 발견: 취약점을 발견하고 악용하여 사용자와 관리자 깃발을 얻었습니다.\n- 필수 기술: 적응적 전략 및 실용적 사이버 보안 기술을 강화했습니다.\n\nLinkedIn에서 저와 연결하세요.","ogImage":{"url":"/assets/img/2024-05-20-TryHackMeWriteup-CyberLens_0.png"},"coverImage":"/assets/img/2024-05-20-TryHackMeWriteup-CyberLens_0.png","tag":["Tech"],"readingTime":6},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003ch2\u003eCyberLens 웹 서버를 악용하고 숨겨진 플래그를 발견할 수 있을까요?\u003c/h2\u003e\n\u003cp\u003e\"사이버 렌즈\" CTF 룸에 오신 것을 환영합니다!\u003c/p\u003e\n\u003cp\u003e2024년 5월 17일에 공개된 이 CTF 챌린지는 약 120분 정도 소요되며 \"쉬움\" 난이도로 평가됩니다.\n하지만 제 개인적인 경험에 따르면, 완료하는 데 2시간이 넘게 걸렸어요.\u003c/p\u003e\n\u003cp\u003e🕵️‍♂️ 준비가 되셨나요? 룸을 찾을 수 있습니다.\u003c/p\u003e\n\u003cp\u003e🔍 챌린지 설명 확인: 챌린지에 대한 자세한 내용은 방의 내용을 확인하세요.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-05-20-TryHackMeWriteup-CyberLens_0.png\" alt=\"이미지\"\u003e\u003c/p\u003e\n\u003ch2\u003e주의 사항\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003eIP를 /etc/hosts 파일에 추가하세요: \u003ccode\u003esudo echo [IP] cyberlens.thm \u003e\u003e /etc/hosts\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e이 공간은 CyberLens 및 그들의 전문 도구에 대해 다루며, 스테가노그래피에 초점을 맞출 수도 있습니다. 화법 및 메타데이터를 위해 이미지를 분석하거나 숨겨진 플래그를 찾기 위해 이러한 도구 내의 취약점을 이용할 수도 있습니다.\u003c/p\u003e\n\u003ch2\u003e열거\u003c/h2\u003e\n\u003cp\u003e우리는 빠른 스캔을 위해 올드스쿨 nmap으로 시작합니다.\n그리고 흥미로운 포트가 열려 있는 것을 발견합니다\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e─# nmap \u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.189\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.206\u003c/span\u003e -A\n\u003cspan class=\"hljs-title class_\"\u003eStarting\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eNmap\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e7.\u003c/span\u003e94SVN ( \u003cspan class=\"hljs-attr\"\u003ehttps\u003c/span\u003e:\u003cspan class=\"hljs-comment\"\u003e//nmap.org ) at 2024-05-18 09:40 EDT\u003c/span\u003e\n\u003cspan class=\"hljs-title class_\"\u003eNmap\u003c/span\u003e scan report \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e cyberlens.\u003cspan class=\"hljs-property\"\u003ethm\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.189\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.206\u003c/span\u003e)\n\u003cspan class=\"hljs-title class_\"\u003eHost\u003c/span\u003e is up (\u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e10s latency).\n\u003cspan class=\"hljs-title class_\"\u003eNot\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eshown\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e995\u003c/span\u003e closed tcp ports (reset)\n\u003cspan class=\"hljs-variable constant_\"\u003ePORT\u003c/span\u003e     \u003cspan class=\"hljs-variable constant_\"\u003eSTATE\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eSERVICE\u003c/span\u003e       \u003cspan class=\"hljs-variable constant_\"\u003eVERSION\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e/tcp   open  http          \u003cspan class=\"hljs-title class_\"\u003eApache\u003c/span\u003e httpd \u003cspan class=\"hljs-number\"\u003e2.4\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.57\u003c/span\u003e ((\u003cspan class=\"hljs-title class_\"\u003eWin64\u003c/span\u003e))\n|_http-server-\u003cspan class=\"hljs-attr\"\u003eheader\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eApache\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e2.4\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.57\u003c/span\u003e (\u003cspan class=\"hljs-title class_\"\u003eWin64\u003c/span\u003e)\n| http-\u003cspan class=\"hljs-attr\"\u003emethods\u003c/span\u003e: \n|_  \u003cspan class=\"hljs-title class_\"\u003ePotentially\u003c/span\u003e risky \u003cspan class=\"hljs-attr\"\u003emethods\u003c/span\u003e: \u003cspan class=\"hljs-variable constant_\"\u003eTRACE\u003c/span\u003e\n|_http-\u003cspan class=\"hljs-attr\"\u003etitle\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eCyberLens\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eUnveiling\u003c/span\u003e the \u003cspan class=\"hljs-title class_\"\u003eHidden\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eMatrix\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e135\u003c/span\u003e/tcp  open  msrpc         \u003cspan class=\"hljs-title class_\"\u003eMicrosoft\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eWindows\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eRPC\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e139\u003c/span\u003e/tcp  open  netbios-ssn   \u003cspan class=\"hljs-title class_\"\u003eMicrosoft\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eWindows\u003c/span\u003e netbios-ssn\n\u003cspan class=\"hljs-number\"\u003e445\u003c/span\u003e/tcp  open  microsoft-ds?\n\u003cspan class=\"hljs-number\"\u003e3389\u003c/span\u003e/tcp open  ms-wbt-server \u003cspan class=\"hljs-title class_\"\u003eMicrosoft\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eTerminal\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eServices\u003c/span\u003e\n| ssl-\u003cspan class=\"hljs-attr\"\u003ecert\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eSubject\u003c/span\u003e: commonName=\u003cspan class=\"hljs-title class_\"\u003eCyberLens\u003c/span\u003e\n| \u003cspan class=\"hljs-title class_\"\u003eNot\u003c/span\u003e valid \u003cspan class=\"hljs-attr\"\u003ebefore\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e05\u003c/span\u003e-17\u003cspan class=\"hljs-attr\"\u003eT13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e\n|_Not valid \u003cspan class=\"hljs-attr\"\u003eafter\u003c/span\u003e:  \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e-16\u003cspan class=\"hljs-attr\"\u003eT13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e\n| rdp-ntlm-\u003cspan class=\"hljs-attr\"\u003einfo\u003c/span\u003e: \n|   \u003cspan class=\"hljs-title class_\"\u003eTarget\u003c/span\u003e\u003cspan class=\"hljs-attr\"\u003e_Name\u003c/span\u003e: \u003cspan class=\"hljs-variable constant_\"\u003eCYBERLENS\u003c/span\u003e\n|   \u003cspan class=\"hljs-title class_\"\u003eNetBIOS\u003c/span\u003e\u003cspan class=\"hljs-attr\"\u003e_Domain_Name\u003c/span\u003e: \u003cspan class=\"hljs-variable constant_\"\u003eCYBERLENS\u003c/span\u003e\n|   \u003cspan class=\"hljs-title class_\"\u003eNetBIOS\u003c/span\u003e\u003cspan class=\"hljs-attr\"\u003e_Computer_Name\u003c/span\u003e: \u003cspan class=\"hljs-variable constant_\"\u003eCYBERLENS\u003c/span\u003e\n|   \u003cspan class=\"hljs-attr\"\u003eDNS_Domain_Name\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eCyberLens\u003c/span\u003e\n|   \u003cspan class=\"hljs-attr\"\u003eDNS_Computer_Name\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eCyberLens\u003c/span\u003e\n|   \u003cspan class=\"hljs-title class_\"\u003eProduct\u003c/span\u003e\u003cspan class=\"hljs-attr\"\u003e_Version\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e10.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.17763\u003c/span\u003e\n|_  \u003cspan class=\"hljs-title class_\"\u003eSystem\u003c/span\u003e\u003cspan class=\"hljs-attr\"\u003e_Time\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e05\u003c/span\u003e-18\u003cspan class=\"hljs-attr\"\u003eT13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e47\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e39\u003c/span\u003e+\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e\n|_ssl-\u003cspan class=\"hljs-attr\"\u003edate\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e05\u003c/span\u003e-18\u003cspan class=\"hljs-attr\"\u003eT13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e47\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e47\u003c/span\u003e+\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e; -10s \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e scanner time.\n\u003cspan class=\"hljs-title class_\"\u003eNo\u003c/span\u003e exact \u003cspan class=\"hljs-variable constant_\"\u003eOS\u003c/span\u003e matches \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e host (\u003cspan class=\"hljs-title class_\"\u003eIf\u003c/span\u003e you know what \u003cspan class=\"hljs-variable constant_\"\u003eOS\u003c/span\u003e is running on it, see \u003cspan class=\"hljs-attr\"\u003ehttps\u003c/span\u003e:\u003cspan class=\"hljs-comment\"\u003e//nmap.org/submit/ ).\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eTCP\u003c/span\u003e/\u003cspan class=\"hljs-variable constant_\"\u003eIP\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003efingerprint\u003c/span\u003e:\n\u003cspan class=\"hljs-attr\"\u003eOS\u003c/span\u003e:\u003cspan class=\"hljs-title function_\"\u003eSCAN\u003c/span\u003e(V=\u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e)... redacted ...\n\n\u003cspan class=\"hljs-title class_\"\u003eNetwork\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eDistance\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e hops\n\u003cspan class=\"hljs-title class_\"\u003eService\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eInfo\u003c/span\u003e: \u003cspan class=\"hljs-attr\"\u003eOS\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eWindows\u003c/span\u003e; \u003cspan class=\"hljs-attr\"\u003eCPE\u003c/span\u003e: \u003cspan class=\"hljs-attr\"\u003ecpe\u003c/span\u003e:/\u003cspan class=\"hljs-attr\"\u003eo\u003c/span\u003e:\u003cspan class=\"hljs-attr\"\u003emicrosoft\u003c/span\u003e:windows\n\n\u003cspan class=\"hljs-title class_\"\u003eHost\u003c/span\u003e script \u003cspan class=\"hljs-attr\"\u003eresults\u003c/span\u003e:\n| smb2-\u003cspan class=\"hljs-attr\"\u003etime\u003c/span\u003e: \n|   \u003cspan class=\"hljs-attr\"\u003edate\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2024\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e05\u003c/span\u003e-18\u003cspan class=\"hljs-attr\"\u003eT13\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e47\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e41\u003c/span\u003e\n|_  \u003cspan class=\"hljs-attr\"\u003estart_date\u003c/span\u003e: N/A\n|_clock-\u003cspan class=\"hljs-attr\"\u003eskew\u003c/span\u003e: \u003cspan class=\"hljs-attr\"\u003emean\u003c/span\u003e: -10s, \u003cspan class=\"hljs-attr\"\u003edeviation\u003c/span\u003e: 0s, \u003cspan class=\"hljs-attr\"\u003emedian\u003c/span\u003e: -10s\n| smb2-security-\u003cspan class=\"hljs-attr\"\u003emode\u003c/span\u003e: \n|   \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e: \n|_    \u003cspan class=\"hljs-title class_\"\u003eMessage\u003c/span\u003e signing enabled but not required\n\n\u003cspan class=\"hljs-variable constant_\"\u003eTRACEROUTE\u003c/span\u003e (using port \u003cspan class=\"hljs-number\"\u003e587\u003c/span\u003e/tcp)\n\u003cspan class=\"hljs-variable constant_\"\u003eHOP\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eRTT\u003c/span\u003e       \u003cspan class=\"hljs-variable constant_\"\u003eADDRESS\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e125.60\u003c/span\u003e ms \u003cspan class=\"hljs-number\"\u003e10.9\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e121.35\u003c/span\u003e ms cyberlens.\u003cspan class=\"hljs-property\"\u003ethm\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e10.10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.189\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.206\u003c/span\u003e)\n\n\u003cspan class=\"hljs-variable constant_\"\u003eOS\u003c/span\u003e and \u003cspan class=\"hljs-title class_\"\u003eService\u003c/span\u003e detection performed. \u003cspan class=\"hljs-title class_\"\u003ePlease\u003c/span\u003e report any incorrect results at \u003cspan class=\"hljs-attr\"\u003ehttps\u003c/span\u003e:\u003cspan class=\"hljs-comment\"\u003e//nmap.org/submit/ .\u003c/span\u003e\n\u003cspan class=\"hljs-title class_\"\u003eNmap\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003edone\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eIP\u003c/span\u003e address (\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e host up) scanned \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e464.64\u003c/span\u003e seconds\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e80/tcp: Apache httpd 2.4.57에서 오픈된 HTTP — CVE 발견 안 됨\u003c/li\u003e\n\u003cli\u003e135/tcp: Microsoft Windows RPC 오픈\u003c/li\u003e\n\u003cli\u003e139/tcp: Microsoft Windows netbios-ssn 오픈\u003c/li\u003e\n\u003cli\u003e445/tcp: Microsoft-DS 오픈\u003c/li\u003e\n\u003cli\u003e3389/tcp: Microsoft Terminal Services (RDP) 오픈\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e우리는 웹사이트를 돌아다니다가, dirb를 실행하여 새로운 디렉토리를 발견하였어요.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-05-20-TryHackMeWriteup-CyberLens_1.png\" alt=\"이미지\"\u003e\u003c/p\u003e\n\u003cp\u003e우리의 관심을 끄는 두 가지 발견:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e연락 양식: 현재 유용한 정보가 없습니다.\u003c/li\u003e\n\u003cli\u003e이미지 추출기: 저희 조사에 대한 잠재적인 통찰력을 약속하는 온라인 메타데이터 추출 서비스입니다.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-05-20-TryHackMeWriteup-CyberLens_2.png\" alt=\"이미지\"\u003e\u003c/p\u003e\n\u003cp\u003e나는 \u003ca href=\"http://cyberlens.thm/images/%EC%97%90%EC%84%9C\" rel=\"nofollow\" target=\"_blank\"\u003ehttp://cyberlens.thm/images/에서\u003c/a\u003e 찾은 이미지를 힌트를 얻기 위해 도구에 업로드했지만 유용한 메타데이터를 찾을 수 없었습니다.\u003c/p\u003e\n\u003cp\u003e다음으로 \"메타데이터 가져오기\" 버튼을 조사하고 해당 이벤트를 추적했습니다. 이로써 다음이 드러났습니다:\u003c/p\u003e\n\u003cp\u003enmap 결과에 이 포트가 나오지 않았어요. 이 포트는 일반적이지 않은 포트라서이고, -p- 플래그를 사용하지 않았기 때문입니다. 일반적으로는 권장되지 않아요.\u003c/p\u003e\n\u003cp\u003e첫 번째로는 해당 아파치 티카 버전에 대한 CVE를 찾아보는 거에요.\u003c/p\u003e\n\u003cp\u003eMetasploit을 시작하고,\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-05-20-TryHackMeWriteup-CyberLens_5.png\" alt=\"CyberLens_5\"\u003e\u003c/p\u003e\n\u003ch2\u003e접근 방법\u003c/h2\u003e\n\u003cp\u003eMetasploit을 구성하고 (set RHOSTS, RPORT, LPORT), 그런 다음 exploit을 실행합니다. 그리고 바로 Meterpreter 세션을 열었습니다. 와우!\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-05-20-TryHackMeWriteup-CyberLens_6.png\" alt=\"이미지\"\u003e\u003c/p\u003e\n\u003cp\u003e우선 CyberLens의 문서에서 깃발을 찾으려고 했어요. 대신 관리 부분을 우연히 발견했어요. 거기에서 승격을 위해 사용할 자격 증명을 찾았어요.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-05-20-TryHackMeWriteup-CyberLens_7.png\" alt=\"이미지\"\u003e\u003c/p\u003e\n\u003cp\u003e힌트에서 이해한대로 대부분의 Windows 깃발은 데스크톱에 있기 때문에 거기로 가서 첫 번째 깃발을 얻었어요.\u003c/p\u003e\n\u003ch2\u003e권한 상슨\u003c/h2\u003e\n\u003cp\u003e이전에 찾은 자격 증명을 다시 보면, 원격 데스크톱 프로토콜(RDP) 포트 3389과 일치합니다.\n그래서 remmina를 실행하지만, 동일한 사용자로 굳어 버린 것을 발견합니다. 이는 클래식한 실수였습니다. 사용자 이름에 주의를 기울이지 않았기 때문입니다. 권한 상슨이 내가 희망했던 만큼 간단하지 않을 것이라는 것을 알게 되었습니다. 그럼에도 불구하고 GUI 인터페이스를 보유하고 있기 때문에 이제 시스템을 쉽게 탐색할 방법이 제공되었습니다.\u003c/p\u003e\n\u003cp\u003e다음으로 모든 서비스를 나열했습니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003esc.\u003cspan class=\"hljs-property\"\u003eexe\u003c/span\u003e query state=all\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e하지만 리스트가 굉장히 길었고, 수작업으로 걸러내는 대신 더 포괄적인 분석을 위해 WinPEAS를 실행하기로 결정했습니다.\u003c/p\u003e\n\u003cp\u003e이미 존재하는 Metasploit 쉘을 고려할 때, 나는 나의 접근 방식을 전환했습니다. WinPEAS 대신 Metasploit의 multi/recon/local_exploit_suggester 모듈을 사용하여 권한 상승을 위한 잠재적인 취약점을 식별했습니다.\u003c/p\u003e\n\u003cp\u003e세션을 설정하고 모듈을 실행하여 총 세 가지 취약점을 발견했어요. 먼저 첫 번째 취약점부터 시작해서 해당 옵션을 구성한 후(exploit를 실행하기 전에 LHOST, LPORT, SESSION을 설정해주세요).\u003c/p\u003e\n\u003cp\u003e그리고 이제 NT AUTHORITY\\SYSTEM으로 권한 상승했어요.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-05-20-TryHackMeWriteup-CyberLens_10.png\" alt=\"TryHackMeWriteup-CyberLens_10\"\u003e\u003c/p\u003e\n\u003cp\u003e관리자의 데스크톱에 깃발이 있을 거에요.\u003c/p\u003e\n\u003ch1\u003e결론\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003e주의 깊은 열거: 중요한 서비스를 식별하면서 모든 포트를 스캔하는 것을 잊지 마세요 (-p-).\u003c/li\u003e\n\u003cli\u003e수동 열거: 잠재적으로 간과된 단서를 잡는 데 중요합니다.\u003c/li\u003e\n\u003cli\u003e도전의 조합: 웹 취약점 분석과 권한 상승을 결합했습니다.\u003c/li\u003e\n\u003cli\u003e적응성 있는 전략: 수동 서비스 분석 및 WinPEAS에서 Metasploit의 익스플로잇 제안자로 전환했습니다.\u003c/li\u003e\n\u003cli\u003e주요 발견: 취약점을 발견하고 악용하여 사용자와 관리자 깃발을 얻었습니다.\u003c/li\u003e\n\u003cli\u003e필수 기술: 적응적 전략 및 실용적 사이버 보안 기술을 강화했습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eLinkedIn에서 저와 연결하세요.\u003c/p\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-05-20-TryHackMeWriteup-CyberLens"},"buildId":"o1YmnmSuZvAX2O4TI9r41","isFallback":false,"gsp":true,"scriptLoader":[{"async":true,"src":"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4877378276818686","strategy":"lazyOnload","crossOrigin":"anonymous"}]}</script></body></html>