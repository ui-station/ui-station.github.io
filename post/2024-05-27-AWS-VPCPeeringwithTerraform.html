<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>í…Œë¼í¼ìœ¼ë¡œ AWS-VPC í”¼ì–´ë§í•˜ê¸° | ui-station</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://ui-station.github.io///post/2024-05-27-AWS-VPCPeeringwithTerraform" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="í…Œë¼í¼ìœ¼ë¡œ AWS-VPC í”¼ì–´ë§í•˜ê¸° | ui-station" data-gatsby-head="true"/><meta property="og:title" content="í…Œë¼í¼ìœ¼ë¡œ AWS-VPC í”¼ì–´ë§í•˜ê¸° | ui-station" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-05-27-AWS-VPCPeeringwithTerraform_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://ui-station.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://ui-station.github.io///post/2024-05-27-AWS-VPCPeeringwithTerraform" data-gatsby-head="true"/><meta name="twitter:title" content="í…Œë¼í¼ìœ¼ë¡œ AWS-VPC í”¼ì–´ë§í•˜ê¸° | ui-station" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-05-27-AWS-VPCPeeringwithTerraform_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | ui-station" data-gatsby-head="true"/><meta name="article:published_time" content="2024-05-27 17:35" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-BHFR6GTH9P"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
          
            gtag('config', 'G-BHFR6GTH9P');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b8ef307c9aee1e34.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b8ef307c9aee1e34.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-4a646156c659a948.js" defer=""></script><script src="/_next/static/chunks/348-d11c34b645b13f5b.js" defer=""></script><script src="/_next/static/chunks/162-4172e84c8e2aa747.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-4f7b40c1114f0d09.js" defer=""></script><script src="/_next/static/-dPCbnM2yhdKNgXe92VJV/_buildManifest.js" defer=""></script><script src="/_next/static/-dPCbnM2yhdKNgXe92VJV/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">UI STATION</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">í…Œë¼í¼ìœ¼ë¡œ AWS-VPC í”¼ì–´ë§í•˜ê¸°</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="í…Œë¼í¼ìœ¼ë¡œ AWS-VPC í”¼ì–´ë§í•˜ê¸°" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">UI STATION</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On May 27, 2024</span><span class="posts_reading_time__f7YPP">22<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-05-27-AWS-VPCPeeringwithTerraform&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<p><img src="/assets/img/2024-05-27-AWS-VPCPeeringwithTerraform_0.png" alt="AWS VPC Peering with Terraform"></p>
<p>AWSì—ì„œ VPCëŠ” ë¬´ì—‡ì¸ê°€ìš”?</p>
<p>AWSì—ì„œ VPC í”¼ì–´ë§ì´ë€ ë¬´ì—‡ì¸ê°€ìš”?</p>
<p>Terraformì€ ë¬´ì—‡ì¸ê°€ìš”?</p>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>ì´ ê¸€ì—ì„œëŠ” AWSì—ì„œ Terraformì„ ì‚¬ìš©í•˜ì—¬ VPC í”¼ì–´ë§ í”„ë¡œì„¸ìŠ¤ë¥¼ ìë™í™”í•˜ëŠ” ë‹¨ê³„ë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.</p>
<p>AWSì—ì„œ ìƒì„±ëœ ìì› ëª©ë¡</p>
<ul>
<li>EC2 (2ëŒ€)</li>
<li>VPC (2ê°œ)</li>
<li>Internet Gateways (2ê°œ)</li>
<li>ë³´ì•ˆ ê·¸ë£¹ (4ê°œ)</li>
<li>VPC í”¼ì–´ë§ ì—°ê²° (1ê°œ)</li>
<li>ë¼ìš°íŠ¸ í…Œì´ë¸” (2ê°œ)</li>
</ul>
<h1>í”„ë¡œì íŠ¸ êµ¬ì¡°</h1>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>terraform_project/
â”‚
â”œâ”€â”€ module/
â”‚ â”œâ”€â”€ ec2/
â”‚ â”‚ â”œâ”€â”€ main.tf
â”‚ â”‚ â”œâ”€â”€ output.tf
â”‚ â”‚ â””â”€â”€ variables.tf
â”‚ â”œâ”€â”€ vpc/
â”‚ â”‚ â”œâ”€â”€ main.tf
â”‚ â”‚ â”œâ”€â”€ output.tf
â”‚ â”‚ â””â”€â”€ variables.tf
â”‚ â””â”€â”€ ...
â”‚
â”œâ”€â”€ main.tf
â”œâ”€â”€ variables.tf
â””â”€â”€ variable.tfvars/
â”œâ”€â”€ dev-env.tfvars
â”œâ”€â”€ stage-env.tfvars
â””â”€â”€ prod-env.tfvars</p>
<h2>ë‹¨ê³„ 1: VPCë¥¼ ìœ„í•œ ëª¨ë“ˆ ìƒì„± ë° ê°€ì ¸ì˜¤ê¸°</h2>
<p>modules/vpc-peering/main.tf</p>
<pre><code class="hljs language-js">terraform {
  required_providers {
    aws = {
      source                = <span class="hljs-string">"hashicorp/aws"</span>
      version               = <span class="hljs-string">"~> 5.0"</span>
      configuration_aliases = [aws.<span class="hljs-property">us_west</span>]
    }
  }
}

provider <span class="hljs-string">"aws"</span> {
  alias  = <span class="hljs-string">"us_west"</span>
  region = <span class="hljs-string">"us-west-1"</span>
}

resource <span class="hljs-string">"aws_vpc"</span> <span class="hljs-string">"main_vpc"</span> {
  cidr_block = <span class="hljs-keyword">var</span>.<span class="hljs-property">vpc_cidr</span>

  tags = {
    <span class="hljs-title class_">Name</span>       = <span class="hljs-keyword">var</span>.<span class="hljs-property">vpc_name</span>
    created_by = <span class="hljs-keyword">var</span>.<span class="hljs-property">owner_name</span>
  }
}
</code></pre>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>ì§€ê¸ˆ, í”„ë¡œì íŠ¸ ë£¨íŠ¸ì˜ main.tf íŒŒì¼ì— ëª¨ë“ˆì„ ê°€ì ¸ì˜¤ê² ìŠµë‹ˆë‹¤.</p>
<pre><code class="hljs language-js">terraform {
  required_providers {
    aws = {
      source  = <span class="hljs-string">"hashicorp/aws"</span>
      version = <span class="hljs-string">"~> 5.0"</span>
    }
  }
}

provider <span class="hljs-string">"aws"</span> {
  region = <span class="hljs-string">"us-east-1"</span>
}

provider <span class="hljs-string">"aws"</span> {
  alias  = <span class="hljs-string">"us_west"</span>
  region = <span class="hljs-string">"us-west-1"</span>
}

<span class="hljs-variable language_">module</span> <span class="hljs-string">"vpc_A"</span> {
  source     = <span class="hljs-string">"./modules/vpc"</span>
  vpc_name   = <span class="hljs-keyword">var</span>.<span class="hljs-property">vpcs</span>[<span class="hljs-string">"vpc_A"</span>][<span class="hljs-string">"vpc_name"</span>]
  vpc_cidr   = <span class="hljs-keyword">var</span>.<span class="hljs-property">vpcs</span>[<span class="hljs-string">"vpc_A"</span>][<span class="hljs-string">"cidr_block"</span>]
  owner_name = <span class="hljs-keyword">var</span>.<span class="hljs-property">owner_name</span>
}

<span class="hljs-variable language_">module</span> <span class="hljs-string">"vpc_B"</span> {
  source     = <span class="hljs-string">"./modules/vpc"</span>
  vpc_name   = <span class="hljs-keyword">var</span>.<span class="hljs-property">vpcs</span>[<span class="hljs-string">"vpc_B"</span>][<span class="hljs-string">"vpc_name"</span>]
  vpc_cidr   = <span class="hljs-keyword">var</span>.<span class="hljs-property">vpcs</span>[<span class="hljs-string">"vpc_B"</span>][<span class="hljs-string">"cidr_block"</span>]
  owner_name = <span class="hljs-keyword">var</span>.<span class="hljs-property">owner_name</span>
  providers = {
    aws = aws.<span class="hljs-property">us_west</span>
  }
}
</code></pre>
<h2>Step 2: Subnetsìš© ëª¨ë“ˆì„ ë§Œë“¤ì–´ importí•´ë³´ì„¸ìš”.</h2>
<p>modules/subnets/main.tf</p>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-js">terraform {
  required_providers {
    aws = {
      source  = <span class="hljs-string">"hashicorp/aws"</span>
      version = <span class="hljs-string">"~> 5.0"</span>
      # configuration_aliases = [aws.<span class="hljs-property">us_west</span>]
    }
  }
}

provider <span class="hljs-string">"aws"</span> {
  alias  = <span class="hljs-string">"us_west"</span>
  region = <span class="hljs-string">"us-west-1"</span>
}

resource <span class="hljs-string">"aws_subnet"</span> <span class="hljs-string">"main_subnet"</span> {
  vpc_id            = <span class="hljs-keyword">var</span>.<span class="hljs-property">vpc_id</span>
  cidr_block        = <span class="hljs-keyword">var</span>.<span class="hljs-property">subnet_cidr</span>
  availability_zone = <span class="hljs-keyword">var</span>.<span class="hljs-property">availability_zone</span>

  tags = {
    <span class="hljs-title class_">Name</span>       = <span class="hljs-keyword">var</span>.<span class="hljs-property">subnet_name</span>
    created_by = <span class="hljs-keyword">var</span>.<span class="hljs-property">owner_name</span>
  }
}
</code></pre>
<p>ì´ì œ í”„ë¡œì íŠ¸ ë£¨íŠ¸ì˜ main.tf íŒŒì¼ì— ëª¨ë“ˆì„ ê°€ì ¸ ì˜¤ê² ìŠµë‹ˆë‹¤.</p>
<pre><code class="hljs language-js"><span class="hljs-variable language_">module</span> <span class="hljs-string">"subnetsForvpc_A"</span> {
  for_each          = <span class="hljs-keyword">var</span>.<span class="hljs-property">subnetsForvpc_A</span>
  source            = <span class="hljs-string">"./modules/subnets"</span>
  vpc_id            = <span class="hljs-variable language_">module</span>.<span class="hljs-property">vpc_A</span>.<span class="hljs-property">vpc_id</span>
  subnet_cidr       = <span class="hljs-keyword">var</span>.<span class="hljs-property">subnetsForvpc_A</span>[each.<span class="hljs-property">key</span>][<span class="hljs-string">"subnet_cidr"</span>]
  subnet_name       = <span class="hljs-keyword">var</span>.<span class="hljs-property">subnetsForvpc_A</span>[each.<span class="hljs-property">key</span>][<span class="hljs-string">"subnet_name"</span>]
  availability_zone = <span class="hljs-keyword">var</span>.<span class="hljs-property">subnetsForvpc_A</span>[each.<span class="hljs-property">key</span>][<span class="hljs-string">"availability_zone"</span>]
  owner_name        = <span class="hljs-keyword">var</span>.<span class="hljs-property">owner_name</span>
}

<span class="hljs-variable language_">module</span> <span class="hljs-string">"subnetsForvpc_B"</span> {
  for_each          = <span class="hljs-keyword">var</span>.<span class="hljs-property">subnetsForvpc_B</span>
  source            = <span class="hljs-string">"./modules/subnets"</span>
  vpc_id            = <span class="hljs-variable language_">module</span>.<span class="hljs-property">vpc_B</span>.<span class="hljs-property">vpc_id</span>
  subnet_cidr       = <span class="hljs-keyword">var</span>.<span class="hljs-property">subnetsForvpc_B</span>[each.<span class="hljs-property">key</span>][<span class="hljs-string">"subnet_cidr"</span>]
  subnet_name       = <span class="hljs-keyword">var</span>.<span class="hljs-property">subnetsForvpc_B</span>[each.<span class="hljs-property">key</span>][<span class="hljs-string">"subnet_name"</span>]
  availability_zone = <span class="hljs-keyword">var</span>.<span class="hljs-property">subnetsForvpc_B</span>[each.<span class="hljs-property">key</span>][<span class="hljs-string">"availability_zone"</span>]
  owner_name        = <span class="hljs-keyword">var</span>.<span class="hljs-property">owner_name</span>
  providers = {
    aws = aws.<span class="hljs-property">us_west</span>
  }
}
</code></pre>
<h2>ë‹¨ê³„ 3: ë³´ì•ˆ ê·¸ë£¹ ëª¨ë“ˆì„ ìƒì„±í•˜ê³  ê°€ì ¸ ì˜¤ê¸°</h2>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>modules/security-groups/main.tf</p>
<pre><code class="hljs language-js">terraform {
  required_providers {
    aws = {
      source                = <span class="hljs-string">"hashicorp/aws"</span>
      version               = <span class="hljs-string">"~> 5.0"</span>
      configuration_aliases = [aws.<span class="hljs-property">us_west</span>]
    }
  }
}

provider <span class="hljs-string">"aws"</span> {
  alias  = <span class="hljs-string">"us_west"</span>
  region = <span class="hljs-string">"us-west-1"</span>
}

resource <span class="hljs-string">"aws_security_group"</span> <span class="hljs-string">"allow_ssh"</span> {
  name        = <span class="hljs-keyword">var</span>.<span class="hljs-property">sg_name</span>
  description = <span class="hljs-keyword">var</span>.<span class="hljs-property">sg_description</span>
  vpc_id      = <span class="hljs-keyword">var</span>.<span class="hljs-property">vpc_id</span>

  ingress {
    description = <span class="hljs-keyword">var</span>.<span class="hljs-property">ingress_description</span>
    from_port   = <span class="hljs-keyword">var</span>.<span class="hljs-property">ingress_from_port</span>
    to_port     = <span class="hljs-keyword">var</span>.<span class="hljs-property">ingress_to_port</span>
    protocol    = <span class="hljs-keyword">var</span>.<span class="hljs-property">ingress_protocol</span>
    cidr_blocks = <span class="hljs-keyword">var</span>.<span class="hljs-property">ingress_cidr_blocks</span>
  }

  egress {
    from_port   = <span class="hljs-string">"0"</span>
    to_port     = <span class="hljs-string">"0"</span>
    protocol    = <span class="hljs-string">"-1"</span>
    cidr_blocks = [<span class="hljs-string">"0.0.0.0/0"</span>]
  }

  tags = {
    <span class="hljs-title class_">Name</span>       = <span class="hljs-keyword">var</span>.<span class="hljs-property">sg_name</span>
    created_by = <span class="hljs-keyword">var</span>.<span class="hljs-property">owner_name</span>
  }
}
</code></pre>
<p>ë³´ì•ˆ ê·¸ë£¹ì„ ìœ„í•´, ì €ëŠ” main.tf íŒŒì¼ì—ì„œ í”„ë¡œì íŠ¸ ë£¨íŠ¸ë¡œ ëª¨ë“ˆì„ ë‘ ë²ˆ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤. ì²« ë²ˆì§¸ ë³´ì•ˆ ê·¸ë£¹ì€ EC2ë¡œ SSHë¥¼ í—ˆìš©í•˜ê³ , ë‘ ë²ˆì§¸ëŠ” EC2ì—ì„œ ICMP íŒ¨í‚·ì˜ íë¦„ì„ í—ˆìš©í•©ë‹ˆë‹¤.</p>
<pre><code class="hljs language-js"><span class="hljs-variable language_">module</span> <span class="hljs-string">"ssh_sg_vpcA"</span> {
  source              = <span class="hljs-string">"./modules/security-groups"</span>
  sg_name             = <span class="hljs-keyword">var</span>.<span class="hljs-property">sgs</span>[<span class="hljs-string">"ssh_sg"</span>][<span class="hljs-string">"sg_name"</span>]
  sg_description      = <span class="hljs-keyword">var</span>.<span class="hljs-property">sgs</span>[<span class="hljs-string">"ssh_sg"</span>][<span class="hljs-string">"sg_description"</span>]
  ingress_description = <span class="hljs-keyword">var</span>.<span class="hljs-property">sgs</span>[<span class="hljs-string">"ssh_sg"</span>][<span class="hljs-string">"ingress_description"</span>]
  ingress_from_port   = <span class="hljs-keyword">var</span>.<span class="hljs-property">sgs</span>[<span class="hljs-string">"ssh_sg"</span>][<span class="hljs-string">"ingress_from_port"</span>]
  ingress_to_port     = <span class="hljs-keyword">var</span>.<span class="hljs-property">sgs</span>[<span class="hljs-string">"ssh_sg"</span>][<span class="hljs-string">"ingress_to_port"</span>]
  ingress_protocol    = <span class="hljs-keyword">var</span>.<span class="hljs-property">sgs</span>[<span class="hljs-string">"ssh_sg"</span>][<span class="hljs-string">"ingress_protocol"</span>]
  ingress_cidr_blocks = <span class="hljs-keyword">var</span>.<span class="hljs-property">sg_cidr_blocks</span>[<span class="hljs-string">"ssh_sg"</span>][<span class="hljs-string">"ingress_cidr_blocks"</span>]
  owner_name          = <span class="hljs-keyword">var</span>.<span class="hljs-property">owner_name</span>
  vpc_id              = <span class="hljs-variable language_">module</span>.<span class="hljs-property">vpc_A</span>.<span class="hljs-property">vpc_id</span>
}

<span class="hljs-variable language_">module</span> <span class="hljs-string">"ssh_sg_vpcB"</span> {
  source              = <span class="hljs-string">"./modules/security-groups"</span>
  sg_name             = <span class="hljs-keyword">var</span>.<span class="hljs-property">sgs</span>[<span class="hljs-string">"ssh_sg"</span>][<span class="hljs-string">"sg_name"</span>]
  sg_description      = <span class="hljs-keyword">var</span>.<span class="hljs-property">sgs</span>[<span class="hljs-string">"ssh_sg"</span>][<span class="hljs-string">"sg_description"</span>]
  ingress_description = <span class="hljs-keyword">var</span>.<span class="hljs-property">sgs</span>[<span class="hljs-string">"ssh_sg"</span>][<span class="hljs-string">"ingress_description"</span>]
  ingress_from_port   = <span class="hljs-keyword">var</span>.<span class="hljs-property">sgs</span>[<span class="hljs-string">"ssh_sg"</span>][<span class="hljs-string">"ingress_from_port"</span>]
  ingress_to_port     = <span class="hljs-keyword">var</span>.<span class="hljs-property">sgs</span>[<span class="hljs-string">"ssh_sg"</span>][<span class="hljs-string">"ingress_to_port"</span>]
  ingress_protocol    = <span class="hljs-keyword">var</span>.<span class="hljs-property">sgs</span>[<span class="hljs-string">"ssh_sg"</span>][<span class="hljs-string">"ingress_protocol"</span>]
  ingress_cidr_blocks = <span class="hljs-keyword">var</span>.<span class="hljs-property">sg_cidr_blocks</span>[<span class="hljs-string">"ssh_sg"</span>][<span class="hljs-string">"ingress_cidr_blocks"</span>]
  owner_name          = <span class="hljs-keyword">var</span>.<span class="hljs-property">owner_name</span>
  vpc_id              = <span class="hljs-variable language_">module</span>.<span class="hljs-property">vpc_B</span>.<span class="hljs-property">vpc_id</span>
  providers = {
    aws = aws.<span class="hljs-property">us_west</span>
  }
}

<span class="hljs-variable language_">module</span> <span class="hljs-string">"icmp_sg_vpcA"</span> {
  source              = <span class="hljs-string">"./modules/security-groups"</span>
  sg_name             = <span class="hljs-keyword">var</span>.<span class="hljs-property">sgs</span>[<span class="hljs-string">"icmp_sg"</span>][<span class="hljs-string">"sg_name"</span>]
  sg_description      = <span class="hljs-keyword">var</span>.<span class="hljs-property">sgs</span>[<span class="hljs-string">"icmp_sg"</span>][<span class="hljs-string">"sg_description"</span>]
  ingress_description = <span class="hljs-keyword">var</span>.<span class="hljs-property">sgs</span>[<span class="hljs-string">"icmp_sg"</span>][<span class="hljs-string">"ingress_description"</span>]
  ingress_from_port   = <span class="hljs-keyword">var</span>.<span class="hljs-property">sgs</span>[<span class="hljs-string">"icmp_sg"</span>][<span class="hljs-string">"ingress_from_port"</span>]
  ingress_to_port     = <span class="hljs-keyword">var</span>.<span class="hljs-property">sgs</span>[<span class="hljs-string">"icmp_sg"</span>][<span class="hljs-string">"ingress_to_port"</span>]
  ingress_protocol    = <span class="hljs-keyword">var</span>.<span class="hljs-property">sgs</span>[<span class="hljs-string">"icmp_sg"</span>][<span class="hljs-string">"ingress_protocol"</span>]
  ingress_cidr_blocks = <span class="hljs-keyword">var</span>.<span class="hljs-property">sg_cidr_blocks</span>[<span class="hljs-string">"icmp_sg"</span>][<span class="hljs-string">"ingress_cidr_blocks_for_vpcA"</span>]
  owner_name          = <span class="hljs-keyword">var</span>.<span class="hljs-property">owner_name</span>
  vpc_id              = <span class="hljs-variable language_">module</span>.<span class="hljs-property">vpc_A</span>.<span class="hljs-property">vpc_id</span>
}

<span class="hljs-variable language_">module</span> <span class="hljs-string">"icmp_sg_vpcB"</span> {
  source              = <span class="hljs-string">"./modules/security-groups"</span>
  sg_name             = <span class="hljs-keyword">var</span>.<span class="hljs-property">sgs</span>[<span class="hljs-string">"icmp_sg"</span>][<span class="hljs-string">"sg_name"</span>]
  sg_description      = <span class="hljs-keyword">var</span>.<span class="hljs-property">sgs</span>[<span class="hljs-string">"icmp_sg"</span>][<span class="hljs-string">"sg_description"</span>]
  ingress_description = <span class="hljs-keyword">var</span>.<span class="hljs-property">sgs</span>[<span class="hljs-string">"icmp_sg"</span>][<span class="hljs-string">"ingress_description"</span>]
  ingress_from_port   = <span class="hljs-keyword">var</span>.<span class="hljs-property">sgs</span>[<span class="hljs-string">"icmp_sg"</span>][<span class="hljs-string">"ingress_from_port"</span>]
  ingress_to_port     = <span class="hljs-keyword">var</span>.<span class="hljs-property">sgs</span>[<span class="hljs-string">"icmp_sg"</span>][<span class="hljs-string">"ingress_to_port"</span>]
  ingress_protocol    = <span class="hljs-keyword">var</span>.<span class="hljs-property">sgs</span>[<span class="hljs-string">"icmp_sg"</span>][<span class="hljs-string">"ingress_protocol"</span>]
  ingress_cidr_blocks = <span class="hljs-keyword">var</span>.<span class="hljs-property">sg_cidr_blocks</span>[<span class="hljs-string">"icmp_sg"</span>][<span class="hljs-string">"ingress_cidr_blocks_for_vpcB"</span>]
  owner_name          = <span class="hljs-keyword">var</span>.<span class="hljs-property">owner_name</span>
  vpc_id              = <span class="hljs-variable language_">module</span>.<span class="hljs-property">vpc_B</span>.<span class="hljs-property">vpc_id</span>
  providers = {
    aws = aws.<span class="hljs-property">us_west</span>
  }
}
</code></pre>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2>ë‹¨ê³„ 4: EC2ë¥¼ ìœ„í•œ ëª¨ë“ˆ ìƒì„± ë° ê°€ì ¸ì˜¤ê¸°</h2>
<p>modules/ec2/main.tf</p>
<pre><code class="hljs language-js">terraform {
  required_providers {
    aws = {
      source                = <span class="hljs-string">"hashicorp/aws"</span>
      version               = <span class="hljs-string">"~> 5.0"</span>
      configuration_aliases = [aws.<span class="hljs-property">us_west</span>]
    }
  }
}

provider <span class="hljs-string">"aws"</span> {
  alias  = <span class="hljs-string">"us_west"</span>
  region = <span class="hljs-string">"us-west-1"</span>
}

resource <span class="hljs-string">"aws_instance"</span> <span class="hljs-string">"my_ec2"</span> {

  ami                         = <span class="hljs-keyword">var</span>.<span class="hljs-property">ami_id</span>
  instance_type               = <span class="hljs-keyword">var</span>.<span class="hljs-property">instance_type</span>
  subnet_id                   = <span class="hljs-keyword">var</span>.<span class="hljs-property">subnet_id</span>
  associate_public_ip_address = <span class="hljs-literal">true</span>
  key_name                    = <span class="hljs-keyword">var</span>.<span class="hljs-property">key_name</span>

  tags = {
    <span class="hljs-title class_">Name</span>       = <span class="hljs-keyword">var</span>.<span class="hljs-property">ec2_name</span>
    created_by = <span class="hljs-keyword">var</span>.<span class="hljs-property">owner_name</span>
  }
}

resource <span class="hljs-string">"aws_network_interface_sg_attachment"</span> <span class="hljs-string">"ssh_sg_attachment"</span> {
  security_group_id    = <span class="hljs-keyword">var</span>.<span class="hljs-property">ssh_sg_id</span>
  network_interface_id = aws_instance.<span class="hljs-property">my_ec2</span>.<span class="hljs-property">primary_network_interface_id</span>
}

resource <span class="hljs-string">"aws_network_interface_sg_attachment"</span> <span class="hljs-string">"icmp_sg_attachment"</span> {
  security_group_id    = <span class="hljs-keyword">var</span>.<span class="hljs-property">icmp_sg_id</span>
  network_interface_id = aws_instance.<span class="hljs-property">my_ec2</span>.<span class="hljs-property">primary_network_interface_id</span>
}
</code></pre>
<p>ì´ì œ ëª¨ë“ˆì„ í”„ë¡œì íŠ¸ ë£¨íŠ¸ì˜ main.tf íŒŒì¼ì— ê°€ì ¸ì˜¤ê² ìŠµë‹ˆë‹¤.</p>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>module "ec2_vpcA" {
source = "./modules/ec2"
subnet_id = module.subnetsForvpc_A["subnet1"].subnet_id
ami_id = var.ec2s["ec2_vpcA"]["ami_id"]
instance_type = var.ec2s["ec2_vpcA"]["instance_type"]
ec2_name = var.ec2s["ec2_vpcA"]["ec2_name"]
key_name = var.ec2s["ec2_vpcA"]["key_name"]
ssh_sg_id = module.ssh_sg_vpcA.sg_id
icmp_sg_id = module.icmp_sg_vpcA.sg_id
owner_name = var.owner_name
}</p>
<p>module "ec2_vpcB" {
source = "./modules/ec2"
subnet_id = module.subnetsForvpc_B["subnet1"].subnet_id
ami_id = var.ec2s["ec2_vpcB"]["ami_id"]
instance_type = var.ec2s["ec2_vpcB"]["instance_type"]
ec2_name = var.ec2s["ec2_vpcB"]["ec2_name"]
key_name = var.ec2s["ec2_vpcB"]["key_name"]
ssh_sg_id = module.ssh_sg_vpcB.sg_id
icmp_sg_id = module.icmp_sg_vpcB.sg_id
owner_name = var.owner_name
providers = {
aws = aws.us_west
}
}</p>
<h2>Step 5: Create modules for Internet Gateways and importing them</h2>
<p>modules/internet-gateways/main.tf</p>
<p>terraform {
required_providers {
aws = {
source = "hashicorp/aws"
version = "~> 5.0"
configuration_aliases = [aws.us_west]
}
}
}</p>
<p>provider "aws" {
alias = "us_west"
region = "us-west-1"
}</p>
<p>resource "aws_internet_gateway" "i_gw" {
vpc_id = var.vpc_id</p>
<p>tags = {
Name = var.igw_name
created_by = var.owner_name
}
}</p>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>ì´ì œ, í”„ë¡œì íŠ¸ ë£¨íŠ¸ì˜ main.tf íŒŒì¼ì— ëª¨ë“ˆì„ ê°€ì ¸ì˜¤ê² ìŠµë‹ˆë‹¤.</p>
<pre><code class="hljs language-js"><span class="hljs-variable language_">module</span> <span class="hljs-string">"igw_vpcA"</span> {
  source     = <span class="hljs-string">"./modules/internet-gateways"</span>
  vpc_id     = <span class="hljs-variable language_">module</span>.<span class="hljs-property">vpc_A</span>.<span class="hljs-property">vpc_id</span>
  igw_name   = <span class="hljs-keyword">var</span>.<span class="hljs-property">igws</span>[<span class="hljs-string">"igw_vpcA"</span>][<span class="hljs-string">"name"</span>]
  owner_name = <span class="hljs-keyword">var</span>.<span class="hljs-property">owner_name</span>
}

<span class="hljs-variable language_">module</span> <span class="hljs-string">"igw_vpcB"</span> {
  source     = <span class="hljs-string">"./modules/internet-gateways"</span>
  vpc_id     = <span class="hljs-variable language_">module</span>.<span class="hljs-property">vpc_B</span>.<span class="hljs-property">vpc_id</span>
  igw_name   = <span class="hljs-keyword">var</span>.<span class="hljs-property">igws</span>[<span class="hljs-string">"igw_vpcB"</span>][<span class="hljs-string">"name"</span>]
  owner_name = <span class="hljs-keyword">var</span>.<span class="hljs-property">owner_name</span>
  providers = {
    aws = aws.<span class="hljs-property">us_west</span>
  }
}
</code></pre>
<h2>ë‹¨ê³„ 6: VPC Peering, VPC Peering accepter, VPC Peering configureìš© ëª¨ë“ˆ ìƒì„± ë° ê°€ì ¸ì˜¤ê¸°</h2>
<p>ëª¨ë“ˆ - VPC Peering (modules/vpc-peering/main.tf)</p>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-kotlin">í…Œë¼í¼ {
  í•„ìˆ˜_ì œê³µì {
    aws = {
      ì†ŒìŠ¤ = <span class="hljs-string">"hashicorp/aws"</span>
      ë²„ì „ = <span class="hljs-string">"~> 5.0"</span>
      êµ¬ì„±_ë³„ì¹­ = [aws.us_west]
    }
  }
}

ì œê³µì <span class="hljs-string">"aws"</span> {
  ë³„ì¹­  = <span class="hljs-string">"us_west"</span>
  ì§€ì—­ = <span class="hljs-string">"us-west-1"</span>
}

ë¦¬ì†ŒìŠ¤ <span class="hljs-string">"aws_vpc_peering_connection"</span> <span class="hljs-string">"vpc_peering"</span> {
  peer_vpc_id = <span class="hljs-keyword">var</span>.peer_vpc_id
  vpc_id      = <span class="hljs-keyword">var</span>.vpc_id
  peer_region = <span class="hljs-string">"us-west-1"</span>
  tags = {
    ì´ë¦„       = <span class="hljs-keyword">var</span>.vpcpeer_name
    ìƒì„±ì = <span class="hljs-keyword">var</span>.owner_name
  }
}
</code></pre>
<p>ëª¨ë“ˆ â€” VPC í”¼ì–´ë§ ìˆ˜ë½ì (modules/vpc-peering-accepter/main.tf)</p>
<pre><code class="hljs language-kotlin">í…Œë¼í¼ {
  í•„ìˆ˜_ì œê³µì {
    aws = {
      ì†ŒìŠ¤ = <span class="hljs-string">"hashicorp/aws"</span>
      ë²„ì „ = <span class="hljs-string">"~> 5.0"</span>
      êµ¬ì„±_ë³„ì¹­ = [aws.us_west]
    }
  }
}

ì œê³µì <span class="hljs-string">"aws"</span> {
  ë³„ì¹­  = <span class="hljs-string">"us_west"</span>
  ì§€ì—­ = <span class="hljs-string">"us-west-1"</span>
}

ë¦¬ì†ŒìŠ¤ <span class="hljs-string">"aws_vpc_peering_connection_accepter"</span> <span class="hljs-string">"peer_vpc_AB"</span> {
  provider = aws.us_west

  vpc_peering_connection_id = <span class="hljs-keyword">var</span>.vpc_peering_id
  auto_accept               = <span class="hljs-literal">true</span>

  tags = {
    ìª½       = <span class="hljs-string">"ìˆ˜ë½ì"</span>
    ì†Œìœ ì_ì´ë¦„ = <span class="hljs-keyword">var</span>.owner_name
  }
}
</code></pre>
<p>ëª¨ë“ˆ â€” VPC í”¼ì–´ë§ êµ¬ì„± (modules/vpc-peering-configure/main.tf)</p>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-js">terraform {
  required_providers {
    aws = {
      source                = <span class="hljs-string">"hashicorp/aws"</span>
      version               = <span class="hljs-string">"~> 5.0"</span>
      configuration_aliases = [aws.<span class="hljs-property">us_west</span>]
    }
  }
}

provider <span class="hljs-string">"aws"</span> {
  alias  = <span class="hljs-string">"us_west"</span>
  region = <span class="hljs-string">"us-west-1"</span>
}

resource <span class="hljs-string">"aws_vpc_peering_connection_options"</span> <span class="hljs-string">"vpc_peering_configure"</span> {
  vpc_peering_connection_id = <span class="hljs-keyword">var</span>.<span class="hljs-property">vpc_peering_connection_id</span>
}
</code></pre>
<p>ì´ì œ, ìœ„ì˜ ëª¨ë“  ëª¨ë“ˆì„ ë£¨íŠ¸ì˜ main.tf íŒŒì¼ë¡œ ê°€ì ¸ì˜¤ê² ìŠµë‹ˆë‹¤.</p>
<pre><code class="hljs language-js"><span class="hljs-variable language_">module</span> <span class="hljs-string">"vpc_peering"</span> {
  source       = <span class="hljs-string">"./modules/vpc-peering"</span>
  peer_vpc_id  = <span class="hljs-variable language_">module</span>.<span class="hljs-property">vpc_B</span>.<span class="hljs-property">vpc_id</span>
  vpc_id       = <span class="hljs-variable language_">module</span>.<span class="hljs-property">vpc_A</span>.<span class="hljs-property">vpc_id</span>
  vpcpeer_name = <span class="hljs-keyword">var</span>.<span class="hljs-property">vpcpeer_name</span>
  owner_name   = <span class="hljs-keyword">var</span>.<span class="hljs-property">owner_name</span>
}

<span class="hljs-variable language_">module</span> <span class="hljs-string">"vpc_peering_accepter"</span> {
  source         = <span class="hljs-string">"./modules/vpc-peering-accepter"</span>
  vpc_peering_id = <span class="hljs-variable language_">module</span>.<span class="hljs-property">vpc_peering</span>.<span class="hljs-property">aws_vpc_peering_connection_id</span>
  owner_name     = <span class="hljs-keyword">var</span>.<span class="hljs-property">owner_name</span>
  providers = {
    aws = aws.<span class="hljs-property">us_west</span>
  }
}

<span class="hljs-variable language_">module</span> <span class="hljs-string">"vpc_peering_configureA"</span> {
  source                    = <span class="hljs-string">"./modules/vpc_peer_configure"</span>
  vpc_peering_connection_id = <span class="hljs-variable language_">module</span>.<span class="hljs-property">vpc_peering_accepter</span>.<span class="hljs-property">aws_vpc_peering_connection_accepter</span>
}

<span class="hljs-variable language_">module</span> <span class="hljs-string">"vpc_peering_configureB"</span> {
  source                    = <span class="hljs-string">"./modules/vpc_peer_configure"</span>
  vpc_peering_connection_id = <span class="hljs-variable language_">module</span>.<span class="hljs-property">vpc_peering_accepter</span>.<span class="hljs-property">aws_vpc_peering_connection_accepter</span>
  providers = {
    aws = aws.<span class="hljs-property">us_west</span>
  }
}
</code></pre>
<h2>ë‹¨ê³„ 7: ë¼ìš°íŠ¸ í…Œì´ë¸”ì„ ìœ„í•œ ëª¨ë“ˆ ë§Œë“¤ê¸° ë° ê°€ì ¸ì˜¤ê¸°</h2>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>modules/route-tables/main.tf</p>
<pre><code class="hljs language-js">terraform {
  required_providers {
    aws = {
      source                = <span class="hljs-string">"hashicorp/aws"</span>
      version               = <span class="hljs-string">"~> 5.0"</span>
      configuration_aliases = [aws.<span class="hljs-property">us_west</span>]
    }
  }
}

provider <span class="hljs-string">"aws"</span> {
  alias  = <span class="hljs-string">"us_west"</span>
  region = <span class="hljs-string">"us-west-1"</span>
}

resource <span class="hljs-string">"aws_route"</span> <span class="hljs-string">"route"</span> {
  route_table_id            = <span class="hljs-keyword">var</span>.<span class="hljs-property">route_table_id</span>
  destination_cidr_block    = <span class="hljs-keyword">var</span>.<span class="hljs-property">destination_cidr_block</span>
  gateway_id                = <span class="hljs-keyword">var</span>.<span class="hljs-property">gateway_id</span> != <span class="hljs-string">""</span> ? <span class="hljs-keyword">var</span>.<span class="hljs-property">gateway_id</span> : <span class="hljs-literal">null</span>
  vpc_peering_connection_id = <span class="hljs-keyword">var</span>.<span class="hljs-property">vpc_peering_connection_id</span> != <span class="hljs-string">""</span> ? <span class="hljs-keyword">var</span>.<span class="hljs-property">vpc_peering_connection_id</span> : <span class="hljs-literal">null</span>
}
</code></pre>
<p>ì´ì œ í”„ë¡œì íŠ¸ ë£¨íŠ¸ì˜ main.tf íŒŒì¼ì— ëª¨ë“ˆì„ ê°€ì ¸ì™€ë³´ê² ìŠµë‹ˆë‹¤.</p>
<pre><code class="hljs language-js"><span class="hljs-variable language_">module</span> <span class="hljs-string">"route_table_vpcA_pcgw"</span> {
  source                    = <span class="hljs-string">"./modules/route-table"</span>
  route_table_id            = <span class="hljs-variable language_">module</span>.<span class="hljs-property">vpc_A</span>.<span class="hljs-property">default_route_table_id</span>
  destination_cidr_block    = <span class="hljs-keyword">var</span>.<span class="hljs-property">destination_cidr_blocks_for_routetable</span>[<span class="hljs-string">"for_route_vpcA"</span>][<span class="hljs-string">"pcgw_cidr"</span>]
  vpc_peering_connection_id = <span class="hljs-variable language_">module</span>.<span class="hljs-property">vpc_peering</span>.<span class="hljs-property">aws_vpc_peering_connection_id</span>
  gateway_id                = <span class="hljs-string">""</span>
}

<span class="hljs-variable language_">module</span> <span class="hljs-string">"route_table_vpcB_pcgw"</span> {
  source                    = <span class="hljs-string">"./modules/route-table"</span>
  route_table_id            = <span class="hljs-variable language_">module</span>.<span class="hljs-property">vpc_B</span>.<span class="hljs-property">default_route_table_id</span>
  destination_cidr_block    = <span class="hljs-keyword">var</span>.<span class="hljs-property">destination_cidr_blocks_for_routetable</span>[<span class="hljs-string">"for_route_vpcB"</span>][<span class="hljs-string">"pcgw_cidr"</span>]
  vpc_peering_connection_id = <span class="hljs-variable language_">module</span>.<span class="hljs-property">vpc_peering</span>.<span class="hljs-property">aws_vpc_peering_connection_id</span>
  gateway_id                = <span class="hljs-string">""</span>
  providers = {
    aws = aws.<span class="hljs-property">us_west</span>
  }
}

<span class="hljs-variable language_">module</span> <span class="hljs-string">"route_table_vpcA_igw"</span> {
  source                    = <span class="hljs-string">"./modules/route-table"</span>
  route_table_id            = <span class="hljs-variable language_">module</span>.<span class="hljs-property">vpc_A</span>.<span class="hljs-property">default_route_table_id</span>
  destination_cidr_block    = <span class="hljs-keyword">var</span>.<span class="hljs-property">destination_cidr_blocks_for_routetable</span>[<span class="hljs-string">"for_route_vpcA"</span>][<span class="hljs-string">"igw_cidr"</span>]
  gateway_id                = <span class="hljs-variable language_">module</span>.<span class="hljs-property">igw_vpcA</span>.<span class="hljs-property">igw_id</span>
  vpc_peering_connection_id = <span class="hljs-string">""</span>
}

<span class="hljs-variable language_">module</span> <span class="hljs-string">"route_table_vpcB_igw"</span> {
  source                    = <span class="hljs-string">"./modules/route-table"</span>
  route_table_id            = <span class="hljs-variable language_">module</span>.<span class="hljs-property">vpc_B</span>.<span class="hljs-property">default_route_table_id</span>
  destination_cidr_block    = <span class="hljs-keyword">var</span>.<span class="hljs-property">destination_cidr_blocks_for_routetable</span>[<span class="hljs-string">"for_route_vpcB"</span>][<span class="hljs-string">"igw_cidr"</span>]
  gateway_id                = <span class="hljs-variable language_">module</span>.<span class="hljs-property">igw_vpcB</span>.<span class="hljs-property">igw_id</span>
  vpc_peering_connection_id = <span class="hljs-string">""</span>
  providers = {
    aws = aws.<span class="hljs-property">us_west</span>
  }
}
</code></pre>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2>ë‹¨ê³„ 8: dev-env.tfvars íŒŒì¼ ì‘ì„±</h2>
<p>variable.tfvars/dev-env.tfvars</p>
<pre><code class="hljs language-js">owner_name = <span class="hljs-string">"NIKUNJ"</span>

vpcs = {
  <span class="hljs-string">"vpc_A"</span> = {
    vpc_name   = <span class="hljs-string">"vpc-us-east1"</span>
    cidr_block = <span class="hljs-string">"10.1.0.0/16"</span>
  }
  <span class="hljs-string">"vpc_B"</span> = {
    vpc_name   = <span class="hljs-string">"vpc-us-west1"</span>
    cidr_block = <span class="hljs-string">"10.2.0.0/16"</span>
  }
}

vpc_Aì— ëŒ€í•œ ì„œë¸Œë„· ëª©ë¡ = {
  <span class="hljs-string">"subnet1"</span> = {
    subnet_cidr       = <span class="hljs-string">"10.1.0.0/20"</span>
    subnet_name       = <span class="hljs-string">"subnet-us-east1a"</span>
    availability_zone = <span class="hljs-string">"us-east-1a"</span>
  }
  <span class="hljs-string">"subnet2"</span> = {
    subnet_cidr       = <span class="hljs-string">"10.1.16.0/20"</span>
    subnet_name       = <span class="hljs-string">"subnet-us-east1b"</span>
    availability_zone = <span class="hljs-string">"us-east-1b"</span>
  }
  <span class="hljs-string">"subnet3"</span> = {
    subnet_cidr       = <span class="hljs-string">"10.1.32.0/20"</span>
    subnet_name       = <span class="hljs-string">"subnet-us-east1c"</span>
    availability_zone = <span class="hljs-string">"us-east-1c"</span>
  }
}

vpc_Bì— ëŒ€í•œ ì„œë¸Œë„· ëª©ë¡ = {
  <span class="hljs-string">"subnet1"</span> = {
    subnet_cidr       = <span class="hljs-string">"10.2.0.0/20"</span>
    subnet_name       = <span class="hljs-string">"subnet-us-west1a"</span>
    availability_zone = <span class="hljs-string">"us-west-1a"</span>
  }
  <span class="hljs-string">"subnet2"</span> = {
    subnet_cidr       = <span class="hljs-string">"10.2.16.0/20"</span>
    subnet_name       = <span class="hljs-string">"subnet-us-west1b"</span>
    availability_zone = <span class="hljs-string">"us-west-1b"</span>
  }
}

ë³´ì•ˆ ê·¸ë£¹ ëª©ë¡ = {
  <span class="hljs-string">"ssh_sg"</span> = {
    sg_name             = <span class="hljs-string">"allow_ssh"</span>
    sg_description      = <span class="hljs-string">"ë‚´ IPì—ì„œ SSH í—ˆìš©"</span>
    ingress_description = <span class="hljs-string">"ë‚´ IPë¥¼ ìœ„í•œ SSH"</span>
    ingress_from_port   = <span class="hljs-string">"22"</span>
    ingress_to_port     = <span class="hljs-string">"22"</span>
    ingress_protocol    = <span class="hljs-string">"tcp"</span>
  }
  <span class="hljs-string">"icmp_sg"</span> = {
    sg_name             = <span class="hljs-string">"allow_ping_traffic"</span>
    sg_description      = <span class="hljs-string">"ë‚´ IPì—ì„œ ping í—ˆìš©"</span>
    ingress_description = <span class="hljs-string">"ë‚´ IPë¡œë¶€í„°ì˜ ping"</span>
    ingress_from_port   = <span class="hljs-string">"8"</span>
    ingress_to_port     = <span class="hljs-string">"0"</span>
    ingress_protocol    = <span class="hljs-string">"icmp"</span>
  }
}

sg_cidr_blocks = {
  <span class="hljs-string">"ssh_sg"</span> = {
    ingress_cidr_blocks = [<span class="hljs-string">"12.34.56.78/32"</span>] # ec2ë¡œì˜ <span class="hljs-variable constant_">SSH</span>ê°€ í—ˆìš©ëœ <span class="hljs-variable constant_">IP</span>ë¥¼ ì–¸ê¸‰
  }
  <span class="hljs-string">"icmp_sg"</span> = {
    ingress_cidr_blocks_for_vpcA = [<span class="hljs-string">"10.2.0.0/16"</span>]
    ingress_cidr_blocks_for_vpcB = [<span class="hljs-string">"10.1.0.0/16"</span>]
  }
}

ec2 ëª©ë¡ = {
  <span class="hljs-string">"ec2_vpcA"</span> = {
    ami_id        = <span class="hljs-string">"ami-0e8a34246278c21e4"</span>
    instance_type = <span class="hljs-string">"t2.micro"</span>
    ec2_name      = <span class="hljs-string">"ec2-us-east1"</span>
    key_name      = <span class="hljs-string">"us-east-1-demo"</span>
  }
  <span class="hljs-string">"ec2_vpcB"</span> = {
    ami_id        = <span class="hljs-string">"ami-09ab9d570789dfdd4"</span>
    instance_type = <span class="hljs-string">"t2.micro"</span>
    ec2_name      = <span class="hljs-string">"ec2-us-west1"</span>
    key_name      = <span class="hljs-string">"us-west-1-demo"</span>
  }
}

ì¸í„°ë„· ê²Œì´íŠ¸ì›¨ì´ ëª©ë¡ = {
  <span class="hljs-string">"igw_vpcA"</span> = {
    name = <span class="hljs-string">"igw_vpcA"</span>
  }
  <span class="hljs-string">"igw_vpcB"</span> = {
    name = <span class="hljs-string">"igw_vpcB"</span>
  }
}

<span class="hljs-variable constant_">VPC</span> í”¼ì–´ë§ ì´ë¦„ = <span class="hljs-string">"vpc_AB_peering"</span>

route í…Œì´ë¸”ìš© ëŒ€ìƒ <span class="hljs-variable constant_">CIDR</span> ë¸”ë¡ = {
  <span class="hljs-string">"for_route_vpcA"</span> = {
    pcgw_cidr = <span class="hljs-string">"10.2.0.0/16"</span>
    igw_cidr  = <span class="hljs-string">"0.0.0.0/0"</span>
  }
  <span class="hljs-string">"for_route_vpcB"</span> = {
    pcgw_cidr = <span class="hljs-string">"10.1.0.0/16"</span>
    igw_cidr  = <span class="hljs-string">"0.0.0.0/0"</span>
  }
}
</code></pre>
<h2>ë‹¨ê³„ 9: ì‘ì—… ë””ë ‰í† ë¦¬ ì´ˆê¸°í™”</h2>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<ul>
<li>ì‘ì—… ë””ë ‰í† ë¦¬ì—ì„œ terraform init ëª…ë ¹ì„ ì‹¤í–‰í•˜ì„¸ìš”. ì´ ëª…ë ¹ì€ í•„ìš”í•œ ëª¨ë“  ê³µê¸‰ì ë° ëª¨ë“ˆì„ ë‹¤ìš´ë¡œë“œí•˜ê³  ë°±ì—”ë“œë¥¼ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.</li>
</ul>
<h2>ë‹¨ê³„ 10: í…Œë¼í¼ ì‹¤í–‰ ê³„íš ìƒì„±</h2>
<ul>
<li>ì‘ì—… ë””ë ‰í† ë¦¬ì—ì„œ terraform plan ëª…ë ¹ì„ ì‹¤í–‰í•˜ì„¸ìš”. ì‹¤í–‰ ê³„íšì„ ì œê³µí•©ë‹ˆë‹¤.</li>
</ul>
<h2>ë‹¨ê³„ 11: terraform apply ì‹¤í–‰</h2>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<ul>
<li>ì‘ì—… ë””ë ‰í† ë¦¬ì—ì„œ terraform apply ëª…ë ¹ì„ ì‹¤í–‰í•˜ë©´ AWSì— í•„ìš”í•œ ëª¨ë“  ë¦¬ì†ŒìŠ¤ê°€ ìƒì„±ë©ë‹ˆë‹¤.</li>
</ul>
<h2>ë‹¨ê³„ 12: ì—°ê²° í™•ì¸</h2>
<ul>
<li>SSHë¥¼ ì‚¬ìš©í•˜ì—¬ EC2 ì¸ìŠ¤í„´ìŠ¤ ì¤‘ í•˜ë‚˜ì— ì—°ê²°í•˜ê³  ë‹¤ë¥¸ EC2 ì¸ìŠ¤í„´ìŠ¤ì˜ ì‚¬ì„¤ IPë¥¼ ì‚¬ìš©í•˜ì—¬ í•‘ì„ ë³´ëƒ…ë‹ˆë‹¤.</li>
<li>ëª¨ë“  ê²ƒì´ ì˜ ë˜ì—ˆë‹¤ë©´ ICMP ë°ì´í„° íŒ¨í‚·ì´ ì„±ê³µì ìœ¼ë¡œ ì „ì†¡ë©ë‹ˆë‹¤.</li>
</ul>
<p>ì—¬ê¸°ê¹Œì§€ì…ë‹ˆë‹¤. ì´ì œ Terraformì„ ì‚¬ìš©í•˜ì—¬ AWS VPC í”¼ì–´ë§ ì—°ê²°ì„ ìƒì„±í•˜ëŠ” ë°©ë²•ì„ ë°°ì› ìŠµë‹ˆë‹¤. ì´ì œ ì—¬ëŸ¬ë¶„ì€ ì´ê²ƒì„ ì‚¬ìš©í•˜ê³  í•„ìš”ì— ë”°ë¼ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<!-- ui-station ì‚¬ê°í˜• -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>ì „ì²´ ì½”ë“œëŠ” ì—¬ê¸°ì—ì„œ ì°¾ì„ ìˆ˜ ìˆì–´ìš”.</p>
<p>ì´ ê°€ì´ë“œê°€ ë„ì›€ì´ ë˜ì—ˆë‹¤ë©´ ğŸ‘ ë²„íŠ¼ì„ í´ë¦­í•´ ì£¼ì„¸ìš”. ëŒ“ê¸€ë„ ììœ ë¡­ê²Œ ë‚¨ê²¨ì£¼ì„¸ìš”.</p>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"í…Œë¼í¼ìœ¼ë¡œ AWS-VPC í”¼ì–´ë§í•˜ê¸°","description":"","date":"2024-05-27 17:35","slug":"2024-05-27-AWS-VPCPeeringwithTerraform","content":"\n![AWS VPC Peering with Terraform](/assets/img/2024-05-27-AWS-VPCPeeringwithTerraform_0.png)\n\nAWSì—ì„œ VPCëŠ” ë¬´ì—‡ì¸ê°€ìš”?\n\nAWSì—ì„œ VPC í”¼ì–´ë§ì´ë€ ë¬´ì—‡ì¸ê°€ìš”?\n\nTerraformì€ ë¬´ì—‡ì¸ê°€ìš”?\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nì´ ê¸€ì—ì„œëŠ” AWSì—ì„œ Terraformì„ ì‚¬ìš©í•˜ì—¬ VPC í”¼ì–´ë§ í”„ë¡œì„¸ìŠ¤ë¥¼ ìë™í™”í•˜ëŠ” ë‹¨ê³„ë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\n\nAWSì—ì„œ ìƒì„±ëœ ìì› ëª©ë¡\n\n- EC2 (2ëŒ€)\n- VPC (2ê°œ)\n- Internet Gateways (2ê°œ)\n- ë³´ì•ˆ ê·¸ë£¹ (4ê°œ)\n- VPC í”¼ì–´ë§ ì—°ê²° (1ê°œ)\n- ë¼ìš°íŠ¸ í…Œì´ë¸” (2ê°œ)\n\n# í”„ë¡œì íŠ¸ êµ¬ì¡°\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nterraform_project/\nâ”‚\nâ”œâ”€â”€ module/\nâ”‚ â”œâ”€â”€ ec2/\nâ”‚ â”‚ â”œâ”€â”€ main.tf\nâ”‚ â”‚ â”œâ”€â”€ output.tf\nâ”‚ â”‚ â””â”€â”€ variables.tf\nâ”‚ â”œâ”€â”€ vpc/\nâ”‚ â”‚ â”œâ”€â”€ main.tf\nâ”‚ â”‚ â”œâ”€â”€ output.tf\nâ”‚ â”‚ â””â”€â”€ variables.tf\nâ”‚ â””â”€â”€ ...\nâ”‚\nâ”œâ”€â”€ main.tf\nâ”œâ”€â”€ variables.tf\nâ””â”€â”€ variable.tfvars/\nâ”œâ”€â”€ dev-env.tfvars\nâ”œâ”€â”€ stage-env.tfvars\nâ””â”€â”€ prod-env.tfvars\n\n## ë‹¨ê³„ 1: VPCë¥¼ ìœ„í•œ ëª¨ë“ˆ ìƒì„± ë° ê°€ì ¸ì˜¤ê¸°\n\nmodules/vpc-peering/main.tf\n\n```js\nterraform {\n  required_providers {\n    aws = {\n      source                = \"hashicorp/aws\"\n      version               = \"~\u003e 5.0\"\n      configuration_aliases = [aws.us_west]\n    }\n  }\n}\n\nprovider \"aws\" {\n  alias  = \"us_west\"\n  region = \"us-west-1\"\n}\n\nresource \"aws_vpc\" \"main_vpc\" {\n  cidr_block = var.vpc_cidr\n\n  tags = {\n    Name       = var.vpc_name\n    created_by = var.owner_name\n  }\n}\n```\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nì§€ê¸ˆ, í”„ë¡œì íŠ¸ ë£¨íŠ¸ì˜ main.tf íŒŒì¼ì— ëª¨ë“ˆì„ ê°€ì ¸ì˜¤ê² ìŠµë‹ˆë‹¤.\n\n```js\nterraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~\u003e 5.0\"\n    }\n  }\n}\n\nprovider \"aws\" {\n  region = \"us-east-1\"\n}\n\nprovider \"aws\" {\n  alias  = \"us_west\"\n  region = \"us-west-1\"\n}\n\nmodule \"vpc_A\" {\n  source     = \"./modules/vpc\"\n  vpc_name   = var.vpcs[\"vpc_A\"][\"vpc_name\"]\n  vpc_cidr   = var.vpcs[\"vpc_A\"][\"cidr_block\"]\n  owner_name = var.owner_name\n}\n\nmodule \"vpc_B\" {\n  source     = \"./modules/vpc\"\n  vpc_name   = var.vpcs[\"vpc_B\"][\"vpc_name\"]\n  vpc_cidr   = var.vpcs[\"vpc_B\"][\"cidr_block\"]\n  owner_name = var.owner_name\n  providers = {\n    aws = aws.us_west\n  }\n}\n```\n\n## Step 2: Subnetsìš© ëª¨ë“ˆì„ ë§Œë“¤ì–´ importí•´ë³´ì„¸ìš”.\n\nmodules/subnets/main.tf\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\nterraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~\u003e 5.0\"\n      # configuration_aliases = [aws.us_west]\n    }\n  }\n}\n\nprovider \"aws\" {\n  alias  = \"us_west\"\n  region = \"us-west-1\"\n}\n\nresource \"aws_subnet\" \"main_subnet\" {\n  vpc_id            = var.vpc_id\n  cidr_block        = var.subnet_cidr\n  availability_zone = var.availability_zone\n\n  tags = {\n    Name       = var.subnet_name\n    created_by = var.owner_name\n  }\n}\n```\n\nì´ì œ í”„ë¡œì íŠ¸ ë£¨íŠ¸ì˜ main.tf íŒŒì¼ì— ëª¨ë“ˆì„ ê°€ì ¸ ì˜¤ê² ìŠµë‹ˆë‹¤.\n\n```js\nmodule \"subnetsForvpc_A\" {\n  for_each          = var.subnetsForvpc_A\n  source            = \"./modules/subnets\"\n  vpc_id            = module.vpc_A.vpc_id\n  subnet_cidr       = var.subnetsForvpc_A[each.key][\"subnet_cidr\"]\n  subnet_name       = var.subnetsForvpc_A[each.key][\"subnet_name\"]\n  availability_zone = var.subnetsForvpc_A[each.key][\"availability_zone\"]\n  owner_name        = var.owner_name\n}\n\nmodule \"subnetsForvpc_B\" {\n  for_each          = var.subnetsForvpc_B\n  source            = \"./modules/subnets\"\n  vpc_id            = module.vpc_B.vpc_id\n  subnet_cidr       = var.subnetsForvpc_B[each.key][\"subnet_cidr\"]\n  subnet_name       = var.subnetsForvpc_B[each.key][\"subnet_name\"]\n  availability_zone = var.subnetsForvpc_B[each.key][\"availability_zone\"]\n  owner_name        = var.owner_name\n  providers = {\n    aws = aws.us_west\n  }\n}\n```\n\n## ë‹¨ê³„ 3: ë³´ì•ˆ ê·¸ë£¹ ëª¨ë“ˆì„ ìƒì„±í•˜ê³  ê°€ì ¸ ì˜¤ê¸°\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nmodules/security-groups/main.tf\n\n```js\nterraform {\n  required_providers {\n    aws = {\n      source                = \"hashicorp/aws\"\n      version               = \"~\u003e 5.0\"\n      configuration_aliases = [aws.us_west]\n    }\n  }\n}\n\nprovider \"aws\" {\n  alias  = \"us_west\"\n  region = \"us-west-1\"\n}\n\nresource \"aws_security_group\" \"allow_ssh\" {\n  name        = var.sg_name\n  description = var.sg_description\n  vpc_id      = var.vpc_id\n\n  ingress {\n    description = var.ingress_description\n    from_port   = var.ingress_from_port\n    to_port     = var.ingress_to_port\n    protocol    = var.ingress_protocol\n    cidr_blocks = var.ingress_cidr_blocks\n  }\n\n  egress {\n    from_port   = \"0\"\n    to_port     = \"0\"\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name       = var.sg_name\n    created_by = var.owner_name\n  }\n}\n```\n\në³´ì•ˆ ê·¸ë£¹ì„ ìœ„í•´, ì €ëŠ” main.tf íŒŒì¼ì—ì„œ í”„ë¡œì íŠ¸ ë£¨íŠ¸ë¡œ ëª¨ë“ˆì„ ë‘ ë²ˆ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤. ì²« ë²ˆì§¸ ë³´ì•ˆ ê·¸ë£¹ì€ EC2ë¡œ SSHë¥¼ í—ˆìš©í•˜ê³ , ë‘ ë²ˆì§¸ëŠ” EC2ì—ì„œ ICMP íŒ¨í‚·ì˜ íë¦„ì„ í—ˆìš©í•©ë‹ˆë‹¤.\n\n```js\nmodule \"ssh_sg_vpcA\" {\n  source              = \"./modules/security-groups\"\n  sg_name             = var.sgs[\"ssh_sg\"][\"sg_name\"]\n  sg_description      = var.sgs[\"ssh_sg\"][\"sg_description\"]\n  ingress_description = var.sgs[\"ssh_sg\"][\"ingress_description\"]\n  ingress_from_port   = var.sgs[\"ssh_sg\"][\"ingress_from_port\"]\n  ingress_to_port     = var.sgs[\"ssh_sg\"][\"ingress_to_port\"]\n  ingress_protocol    = var.sgs[\"ssh_sg\"][\"ingress_protocol\"]\n  ingress_cidr_blocks = var.sg_cidr_blocks[\"ssh_sg\"][\"ingress_cidr_blocks\"]\n  owner_name          = var.owner_name\n  vpc_id              = module.vpc_A.vpc_id\n}\n\nmodule \"ssh_sg_vpcB\" {\n  source              = \"./modules/security-groups\"\n  sg_name             = var.sgs[\"ssh_sg\"][\"sg_name\"]\n  sg_description      = var.sgs[\"ssh_sg\"][\"sg_description\"]\n  ingress_description = var.sgs[\"ssh_sg\"][\"ingress_description\"]\n  ingress_from_port   = var.sgs[\"ssh_sg\"][\"ingress_from_port\"]\n  ingress_to_port     = var.sgs[\"ssh_sg\"][\"ingress_to_port\"]\n  ingress_protocol    = var.sgs[\"ssh_sg\"][\"ingress_protocol\"]\n  ingress_cidr_blocks = var.sg_cidr_blocks[\"ssh_sg\"][\"ingress_cidr_blocks\"]\n  owner_name          = var.owner_name\n  vpc_id              = module.vpc_B.vpc_id\n  providers = {\n    aws = aws.us_west\n  }\n}\n\nmodule \"icmp_sg_vpcA\" {\n  source              = \"./modules/security-groups\"\n  sg_name             = var.sgs[\"icmp_sg\"][\"sg_name\"]\n  sg_description      = var.sgs[\"icmp_sg\"][\"sg_description\"]\n  ingress_description = var.sgs[\"icmp_sg\"][\"ingress_description\"]\n  ingress_from_port   = var.sgs[\"icmp_sg\"][\"ingress_from_port\"]\n  ingress_to_port     = var.sgs[\"icmp_sg\"][\"ingress_to_port\"]\n  ingress_protocol    = var.sgs[\"icmp_sg\"][\"ingress_protocol\"]\n  ingress_cidr_blocks = var.sg_cidr_blocks[\"icmp_sg\"][\"ingress_cidr_blocks_for_vpcA\"]\n  owner_name          = var.owner_name\n  vpc_id              = module.vpc_A.vpc_id\n}\n\nmodule \"icmp_sg_vpcB\" {\n  source              = \"./modules/security-groups\"\n  sg_name             = var.sgs[\"icmp_sg\"][\"sg_name\"]\n  sg_description      = var.sgs[\"icmp_sg\"][\"sg_description\"]\n  ingress_description = var.sgs[\"icmp_sg\"][\"ingress_description\"]\n  ingress_from_port   = var.sgs[\"icmp_sg\"][\"ingress_from_port\"]\n  ingress_to_port     = var.sgs[\"icmp_sg\"][\"ingress_to_port\"]\n  ingress_protocol    = var.sgs[\"icmp_sg\"][\"ingress_protocol\"]\n  ingress_cidr_blocks = var.sg_cidr_blocks[\"icmp_sg\"][\"ingress_cidr_blocks_for_vpcB\"]\n  owner_name          = var.owner_name\n  vpc_id              = module.vpc_B.vpc_id\n  providers = {\n    aws = aws.us_west\n  }\n}\n```\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## ë‹¨ê³„ 4: EC2ë¥¼ ìœ„í•œ ëª¨ë“ˆ ìƒì„± ë° ê°€ì ¸ì˜¤ê¸°\n\nmodules/ec2/main.tf\n\n```js\nterraform {\n  required_providers {\n    aws = {\n      source                = \"hashicorp/aws\"\n      version               = \"~\u003e 5.0\"\n      configuration_aliases = [aws.us_west]\n    }\n  }\n}\n\nprovider \"aws\" {\n  alias  = \"us_west\"\n  region = \"us-west-1\"\n}\n\nresource \"aws_instance\" \"my_ec2\" {\n\n  ami                         = var.ami_id\n  instance_type               = var.instance_type\n  subnet_id                   = var.subnet_id\n  associate_public_ip_address = true\n  key_name                    = var.key_name\n\n  tags = {\n    Name       = var.ec2_name\n    created_by = var.owner_name\n  }\n}\n\nresource \"aws_network_interface_sg_attachment\" \"ssh_sg_attachment\" {\n  security_group_id    = var.ssh_sg_id\n  network_interface_id = aws_instance.my_ec2.primary_network_interface_id\n}\n\nresource \"aws_network_interface_sg_attachment\" \"icmp_sg_attachment\" {\n  security_group_id    = var.icmp_sg_id\n  network_interface_id = aws_instance.my_ec2.primary_network_interface_id\n}\n```\n\nì´ì œ ëª¨ë“ˆì„ í”„ë¡œì íŠ¸ ë£¨íŠ¸ì˜ main.tf íŒŒì¼ì— ê°€ì ¸ì˜¤ê² ìŠµë‹ˆë‹¤.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nmodule \"ec2_vpcA\" {\nsource = \"./modules/ec2\"\nsubnet_id = module.subnetsForvpc_A[\"subnet1\"].subnet_id\nami_id = var.ec2s[\"ec2_vpcA\"][\"ami_id\"]\ninstance_type = var.ec2s[\"ec2_vpcA\"][\"instance_type\"]\nec2_name = var.ec2s[\"ec2_vpcA\"][\"ec2_name\"]\nkey_name = var.ec2s[\"ec2_vpcA\"][\"key_name\"]\nssh_sg_id = module.ssh_sg_vpcA.sg_id\nicmp_sg_id = module.icmp_sg_vpcA.sg_id\nowner_name = var.owner_name\n}\n\nmodule \"ec2_vpcB\" {\nsource = \"./modules/ec2\"\nsubnet_id = module.subnetsForvpc_B[\"subnet1\"].subnet_id\nami_id = var.ec2s[\"ec2_vpcB\"][\"ami_id\"]\ninstance_type = var.ec2s[\"ec2_vpcB\"][\"instance_type\"]\nec2_name = var.ec2s[\"ec2_vpcB\"][\"ec2_name\"]\nkey_name = var.ec2s[\"ec2_vpcB\"][\"key_name\"]\nssh_sg_id = module.ssh_sg_vpcB.sg_id\nicmp_sg_id = module.icmp_sg_vpcB.sg_id\nowner_name = var.owner_name\nproviders = {\naws = aws.us_west\n}\n}\n\n## Step 5: Create modules for Internet Gateways and importing them\n\nmodules/internet-gateways/main.tf\n\nterraform {\nrequired_providers {\naws = {\nsource = \"hashicorp/aws\"\nversion = \"~\u003e 5.0\"\nconfiguration_aliases = [aws.us_west]\n}\n}\n}\n\nprovider \"aws\" {\nalias = \"us_west\"\nregion = \"us-west-1\"\n}\n\nresource \"aws_internet_gateway\" \"i_gw\" {\nvpc_id = var.vpc_id\n\ntags = {\nName = var.igw_name\ncreated_by = var.owner_name\n}\n}\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nì´ì œ, í”„ë¡œì íŠ¸ ë£¨íŠ¸ì˜ main.tf íŒŒì¼ì— ëª¨ë“ˆì„ ê°€ì ¸ì˜¤ê² ìŠµë‹ˆë‹¤.\n\n```js\nmodule \"igw_vpcA\" {\n  source     = \"./modules/internet-gateways\"\n  vpc_id     = module.vpc_A.vpc_id\n  igw_name   = var.igws[\"igw_vpcA\"][\"name\"]\n  owner_name = var.owner_name\n}\n\nmodule \"igw_vpcB\" {\n  source     = \"./modules/internet-gateways\"\n  vpc_id     = module.vpc_B.vpc_id\n  igw_name   = var.igws[\"igw_vpcB\"][\"name\"]\n  owner_name = var.owner_name\n  providers = {\n    aws = aws.us_west\n  }\n}\n```\n\n## ë‹¨ê³„ 6: VPC Peering, VPC Peering accepter, VPC Peering configureìš© ëª¨ë“ˆ ìƒì„± ë° ê°€ì ¸ì˜¤ê¸°\n\nëª¨ë“ˆ - VPC Peering (modules/vpc-peering/main.tf)\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```kotlin\ní…Œë¼í¼ {\n  í•„ìˆ˜_ì œê³µì {\n    aws = {\n      ì†ŒìŠ¤ = \"hashicorp/aws\"\n      ë²„ì „ = \"~\u003e 5.0\"\n      êµ¬ì„±_ë³„ì¹­ = [aws.us_west]\n    }\n  }\n}\n\nì œê³µì \"aws\" {\n  ë³„ì¹­  = \"us_west\"\n  ì§€ì—­ = \"us-west-1\"\n}\n\në¦¬ì†ŒìŠ¤ \"aws_vpc_peering_connection\" \"vpc_peering\" {\n  peer_vpc_id = var.peer_vpc_id\n  vpc_id      = var.vpc_id\n  peer_region = \"us-west-1\"\n  tags = {\n    ì´ë¦„       = var.vpcpeer_name\n    ìƒì„±ì = var.owner_name\n  }\n}\n```\n\nëª¨ë“ˆ â€” VPC í”¼ì–´ë§ ìˆ˜ë½ì (modules/vpc-peering-accepter/main.tf)\n\n```kotlin\ní…Œë¼í¼ {\n  í•„ìˆ˜_ì œê³µì {\n    aws = {\n      ì†ŒìŠ¤ = \"hashicorp/aws\"\n      ë²„ì „ = \"~\u003e 5.0\"\n      êµ¬ì„±_ë³„ì¹­ = [aws.us_west]\n    }\n  }\n}\n\nì œê³µì \"aws\" {\n  ë³„ì¹­  = \"us_west\"\n  ì§€ì—­ = \"us-west-1\"\n}\n\në¦¬ì†ŒìŠ¤ \"aws_vpc_peering_connection_accepter\" \"peer_vpc_AB\" {\n  provider = aws.us_west\n\n  vpc_peering_connection_id = var.vpc_peering_id\n  auto_accept               = true\n\n  tags = {\n    ìª½       = \"ìˆ˜ë½ì\"\n    ì†Œìœ ì_ì´ë¦„ = var.owner_name\n  }\n}\n```\n\nëª¨ë“ˆ â€” VPC í”¼ì–´ë§ êµ¬ì„± (modules/vpc-peering-configure/main.tf)\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\nterraform {\n  required_providers {\n    aws = {\n      source                = \"hashicorp/aws\"\n      version               = \"~\u003e 5.0\"\n      configuration_aliases = [aws.us_west]\n    }\n  }\n}\n\nprovider \"aws\" {\n  alias  = \"us_west\"\n  region = \"us-west-1\"\n}\n\nresource \"aws_vpc_peering_connection_options\" \"vpc_peering_configure\" {\n  vpc_peering_connection_id = var.vpc_peering_connection_id\n}\n```\n\nì´ì œ, ìœ„ì˜ ëª¨ë“  ëª¨ë“ˆì„ ë£¨íŠ¸ì˜ main.tf íŒŒì¼ë¡œ ê°€ì ¸ì˜¤ê² ìŠµë‹ˆë‹¤.\n\n```js\nmodule \"vpc_peering\" {\n  source       = \"./modules/vpc-peering\"\n  peer_vpc_id  = module.vpc_B.vpc_id\n  vpc_id       = module.vpc_A.vpc_id\n  vpcpeer_name = var.vpcpeer_name\n  owner_name   = var.owner_name\n}\n\nmodule \"vpc_peering_accepter\" {\n  source         = \"./modules/vpc-peering-accepter\"\n  vpc_peering_id = module.vpc_peering.aws_vpc_peering_connection_id\n  owner_name     = var.owner_name\n  providers = {\n    aws = aws.us_west\n  }\n}\n\nmodule \"vpc_peering_configureA\" {\n  source                    = \"./modules/vpc_peer_configure\"\n  vpc_peering_connection_id = module.vpc_peering_accepter.aws_vpc_peering_connection_accepter\n}\n\nmodule \"vpc_peering_configureB\" {\n  source                    = \"./modules/vpc_peer_configure\"\n  vpc_peering_connection_id = module.vpc_peering_accepter.aws_vpc_peering_connection_accepter\n  providers = {\n    aws = aws.us_west\n  }\n}\n```\n\n## ë‹¨ê³„ 7: ë¼ìš°íŠ¸ í…Œì´ë¸”ì„ ìœ„í•œ ëª¨ë“ˆ ë§Œë“¤ê¸° ë° ê°€ì ¸ì˜¤ê¸°\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nmodules/route-tables/main.tf\n\n```js\nterraform {\n  required_providers {\n    aws = {\n      source                = \"hashicorp/aws\"\n      version               = \"~\u003e 5.0\"\n      configuration_aliases = [aws.us_west]\n    }\n  }\n}\n\nprovider \"aws\" {\n  alias  = \"us_west\"\n  region = \"us-west-1\"\n}\n\nresource \"aws_route\" \"route\" {\n  route_table_id            = var.route_table_id\n  destination_cidr_block    = var.destination_cidr_block\n  gateway_id                = var.gateway_id != \"\" ? var.gateway_id : null\n  vpc_peering_connection_id = var.vpc_peering_connection_id != \"\" ? var.vpc_peering_connection_id : null\n}\n```\n\nì´ì œ í”„ë¡œì íŠ¸ ë£¨íŠ¸ì˜ main.tf íŒŒì¼ì— ëª¨ë“ˆì„ ê°€ì ¸ì™€ë³´ê² ìŠµë‹ˆë‹¤.\n\n```js\nmodule \"route_table_vpcA_pcgw\" {\n  source                    = \"./modules/route-table\"\n  route_table_id            = module.vpc_A.default_route_table_id\n  destination_cidr_block    = var.destination_cidr_blocks_for_routetable[\"for_route_vpcA\"][\"pcgw_cidr\"]\n  vpc_peering_connection_id = module.vpc_peering.aws_vpc_peering_connection_id\n  gateway_id                = \"\"\n}\n\nmodule \"route_table_vpcB_pcgw\" {\n  source                    = \"./modules/route-table\"\n  route_table_id            = module.vpc_B.default_route_table_id\n  destination_cidr_block    = var.destination_cidr_blocks_for_routetable[\"for_route_vpcB\"][\"pcgw_cidr\"]\n  vpc_peering_connection_id = module.vpc_peering.aws_vpc_peering_connection_id\n  gateway_id                = \"\"\n  providers = {\n    aws = aws.us_west\n  }\n}\n\nmodule \"route_table_vpcA_igw\" {\n  source                    = \"./modules/route-table\"\n  route_table_id            = module.vpc_A.default_route_table_id\n  destination_cidr_block    = var.destination_cidr_blocks_for_routetable[\"for_route_vpcA\"][\"igw_cidr\"]\n  gateway_id                = module.igw_vpcA.igw_id\n  vpc_peering_connection_id = \"\"\n}\n\nmodule \"route_table_vpcB_igw\" {\n  source                    = \"./modules/route-table\"\n  route_table_id            = module.vpc_B.default_route_table_id\n  destination_cidr_block    = var.destination_cidr_blocks_for_routetable[\"for_route_vpcB\"][\"igw_cidr\"]\n  gateway_id                = module.igw_vpcB.igw_id\n  vpc_peering_connection_id = \"\"\n  providers = {\n    aws = aws.us_west\n  }\n}\n```\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## ë‹¨ê³„ 8: dev-env.tfvars íŒŒì¼ ì‘ì„±\n\nvariable.tfvars/dev-env.tfvars\n\n```js\nowner_name = \"NIKUNJ\"\n\nvpcs = {\n  \"vpc_A\" = {\n    vpc_name   = \"vpc-us-east1\"\n    cidr_block = \"10.1.0.0/16\"\n  }\n  \"vpc_B\" = {\n    vpc_name   = \"vpc-us-west1\"\n    cidr_block = \"10.2.0.0/16\"\n  }\n}\n\nvpc_Aì— ëŒ€í•œ ì„œë¸Œë„· ëª©ë¡ = {\n  \"subnet1\" = {\n    subnet_cidr       = \"10.1.0.0/20\"\n    subnet_name       = \"subnet-us-east1a\"\n    availability_zone = \"us-east-1a\"\n  }\n  \"subnet2\" = {\n    subnet_cidr       = \"10.1.16.0/20\"\n    subnet_name       = \"subnet-us-east1b\"\n    availability_zone = \"us-east-1b\"\n  }\n  \"subnet3\" = {\n    subnet_cidr       = \"10.1.32.0/20\"\n    subnet_name       = \"subnet-us-east1c\"\n    availability_zone = \"us-east-1c\"\n  }\n}\n\nvpc_Bì— ëŒ€í•œ ì„œë¸Œë„· ëª©ë¡ = {\n  \"subnet1\" = {\n    subnet_cidr       = \"10.2.0.0/20\"\n    subnet_name       = \"subnet-us-west1a\"\n    availability_zone = \"us-west-1a\"\n  }\n  \"subnet2\" = {\n    subnet_cidr       = \"10.2.16.0/20\"\n    subnet_name       = \"subnet-us-west1b\"\n    availability_zone = \"us-west-1b\"\n  }\n}\n\në³´ì•ˆ ê·¸ë£¹ ëª©ë¡ = {\n  \"ssh_sg\" = {\n    sg_name             = \"allow_ssh\"\n    sg_description      = \"ë‚´ IPì—ì„œ SSH í—ˆìš©\"\n    ingress_description = \"ë‚´ IPë¥¼ ìœ„í•œ SSH\"\n    ingress_from_port   = \"22\"\n    ingress_to_port     = \"22\"\n    ingress_protocol    = \"tcp\"\n  }\n  \"icmp_sg\" = {\n    sg_name             = \"allow_ping_traffic\"\n    sg_description      = \"ë‚´ IPì—ì„œ ping í—ˆìš©\"\n    ingress_description = \"ë‚´ IPë¡œë¶€í„°ì˜ ping\"\n    ingress_from_port   = \"8\"\n    ingress_to_port     = \"0\"\n    ingress_protocol    = \"icmp\"\n  }\n}\n\nsg_cidr_blocks = {\n  \"ssh_sg\" = {\n    ingress_cidr_blocks = [\"12.34.56.78/32\"] # ec2ë¡œì˜ SSHê°€ í—ˆìš©ëœ IPë¥¼ ì–¸ê¸‰\n  }\n  \"icmp_sg\" = {\n    ingress_cidr_blocks_for_vpcA = [\"10.2.0.0/16\"]\n    ingress_cidr_blocks_for_vpcB = [\"10.1.0.0/16\"]\n  }\n}\n\nec2 ëª©ë¡ = {\n  \"ec2_vpcA\" = {\n    ami_id        = \"ami-0e8a34246278c21e4\"\n    instance_type = \"t2.micro\"\n    ec2_name      = \"ec2-us-east1\"\n    key_name      = \"us-east-1-demo\"\n  }\n  \"ec2_vpcB\" = {\n    ami_id        = \"ami-09ab9d570789dfdd4\"\n    instance_type = \"t2.micro\"\n    ec2_name      = \"ec2-us-west1\"\n    key_name      = \"us-west-1-demo\"\n  }\n}\n\nì¸í„°ë„· ê²Œì´íŠ¸ì›¨ì´ ëª©ë¡ = {\n  \"igw_vpcA\" = {\n    name = \"igw_vpcA\"\n  }\n  \"igw_vpcB\" = {\n    name = \"igw_vpcB\"\n  }\n}\n\nVPC í”¼ì–´ë§ ì´ë¦„ = \"vpc_AB_peering\"\n\nroute í…Œì´ë¸”ìš© ëŒ€ìƒ CIDR ë¸”ë¡ = {\n  \"for_route_vpcA\" = {\n    pcgw_cidr = \"10.2.0.0/16\"\n    igw_cidr  = \"0.0.0.0/0\"\n  }\n  \"for_route_vpcB\" = {\n    pcgw_cidr = \"10.1.0.0/16\"\n    igw_cidr  = \"0.0.0.0/0\"\n  }\n}\n```\n\n## ë‹¨ê³„ 9: ì‘ì—… ë””ë ‰í† ë¦¬ ì´ˆê¸°í™”\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n- ì‘ì—… ë””ë ‰í† ë¦¬ì—ì„œ terraform init ëª…ë ¹ì„ ì‹¤í–‰í•˜ì„¸ìš”. ì´ ëª…ë ¹ì€ í•„ìš”í•œ ëª¨ë“  ê³µê¸‰ì ë° ëª¨ë“ˆì„ ë‹¤ìš´ë¡œë“œí•˜ê³  ë°±ì—”ë“œë¥¼ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.\n\n## ë‹¨ê³„ 10: í…Œë¼í¼ ì‹¤í–‰ ê³„íš ìƒì„±\n\n- ì‘ì—… ë””ë ‰í† ë¦¬ì—ì„œ terraform plan ëª…ë ¹ì„ ì‹¤í–‰í•˜ì„¸ìš”. ì‹¤í–‰ ê³„íšì„ ì œê³µí•©ë‹ˆë‹¤.\n\n## ë‹¨ê³„ 11: terraform apply ì‹¤í–‰\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n- ì‘ì—… ë””ë ‰í† ë¦¬ì—ì„œ terraform apply ëª…ë ¹ì„ ì‹¤í–‰í•˜ë©´ AWSì— í•„ìš”í•œ ëª¨ë“  ë¦¬ì†ŒìŠ¤ê°€ ìƒì„±ë©ë‹ˆë‹¤.\n\n## ë‹¨ê³„ 12: ì—°ê²° í™•ì¸\n\n- SSHë¥¼ ì‚¬ìš©í•˜ì—¬ EC2 ì¸ìŠ¤í„´ìŠ¤ ì¤‘ í•˜ë‚˜ì— ì—°ê²°í•˜ê³  ë‹¤ë¥¸ EC2 ì¸ìŠ¤í„´ìŠ¤ì˜ ì‚¬ì„¤ IPë¥¼ ì‚¬ìš©í•˜ì—¬ í•‘ì„ ë³´ëƒ…ë‹ˆë‹¤.\n- ëª¨ë“  ê²ƒì´ ì˜ ë˜ì—ˆë‹¤ë©´ ICMP ë°ì´í„° íŒ¨í‚·ì´ ì„±ê³µì ìœ¼ë¡œ ì „ì†¡ë©ë‹ˆë‹¤.\n\nì—¬ê¸°ê¹Œì§€ì…ë‹ˆë‹¤. ì´ì œ Terraformì„ ì‚¬ìš©í•˜ì—¬ AWS VPC í”¼ì–´ë§ ì—°ê²°ì„ ìƒì„±í•˜ëŠ” ë°©ë²•ì„ ë°°ì› ìŠµë‹ˆë‹¤. ì´ì œ ì—¬ëŸ¬ë¶„ì€ ì´ê²ƒì„ ì‚¬ìš©í•˜ê³  í•„ìš”ì— ë”°ë¼ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nì „ì²´ ì½”ë“œëŠ” ì—¬ê¸°ì—ì„œ ì°¾ì„ ìˆ˜ ìˆì–´ìš”.\n\nì´ ê°€ì´ë“œê°€ ë„ì›€ì´ ë˜ì—ˆë‹¤ë©´ ğŸ‘ ë²„íŠ¼ì„ í´ë¦­í•´ ì£¼ì„¸ìš”. ëŒ“ê¸€ë„ ììœ ë¡­ê²Œ ë‚¨ê²¨ì£¼ì„¸ìš”.\n","ogImage":{"url":"/assets/img/2024-05-27-AWS-VPCPeeringwithTerraform_0.png"},"coverImage":"/assets/img/2024-05-27-AWS-VPCPeeringwithTerraform_0.png","tag":["Tech"],"readingTime":22},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-05-27-AWS-VPCPeeringwithTerraform_0.png\" alt=\"AWS VPC Peering with Terraform\"\u003e\u003c/p\u003e\n\u003cp\u003eAWSì—ì„œ VPCëŠ” ë¬´ì—‡ì¸ê°€ìš”?\u003c/p\u003e\n\u003cp\u003eAWSì—ì„œ VPC í”¼ì–´ë§ì´ë€ ë¬´ì—‡ì¸ê°€ìš”?\u003c/p\u003e\n\u003cp\u003eTerraformì€ ë¬´ì—‡ì¸ê°€ìš”?\u003c/p\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eì´ ê¸€ì—ì„œëŠ” AWSì—ì„œ Terraformì„ ì‚¬ìš©í•˜ì—¬ VPC í”¼ì–´ë§ í”„ë¡œì„¸ìŠ¤ë¥¼ ìë™í™”í•˜ëŠ” ë‹¨ê³„ë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eAWSì—ì„œ ìƒì„±ëœ ìì› ëª©ë¡\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eEC2 (2ëŒ€)\u003c/li\u003e\n\u003cli\u003eVPC (2ê°œ)\u003c/li\u003e\n\u003cli\u003eInternet Gateways (2ê°œ)\u003c/li\u003e\n\u003cli\u003eë³´ì•ˆ ê·¸ë£¹ (4ê°œ)\u003c/li\u003e\n\u003cli\u003eVPC í”¼ì–´ë§ ì—°ê²° (1ê°œ)\u003c/li\u003e\n\u003cli\u003eë¼ìš°íŠ¸ í…Œì´ë¸” (2ê°œ)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1\u003eí”„ë¡œì íŠ¸ êµ¬ì¡°\u003c/h1\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eterraform_project/\nâ”‚\nâ”œâ”€â”€ module/\nâ”‚ â”œâ”€â”€ ec2/\nâ”‚ â”‚ â”œâ”€â”€ main.tf\nâ”‚ â”‚ â”œâ”€â”€ output.tf\nâ”‚ â”‚ â””â”€â”€ variables.tf\nâ”‚ â”œâ”€â”€ vpc/\nâ”‚ â”‚ â”œâ”€â”€ main.tf\nâ”‚ â”‚ â”œâ”€â”€ output.tf\nâ”‚ â”‚ â””â”€â”€ variables.tf\nâ”‚ â””â”€â”€ ...\nâ”‚\nâ”œâ”€â”€ main.tf\nâ”œâ”€â”€ variables.tf\nâ””â”€â”€ variable.tfvars/\nâ”œâ”€â”€ dev-env.tfvars\nâ”œâ”€â”€ stage-env.tfvars\nâ””â”€â”€ prod-env.tfvars\u003c/p\u003e\n\u003ch2\u003eë‹¨ê³„ 1: VPCë¥¼ ìœ„í•œ ëª¨ë“ˆ ìƒì„± ë° ê°€ì ¸ì˜¤ê¸°\u003c/h2\u003e\n\u003cp\u003emodules/vpc-peering/main.tf\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eterraform {\n  required_providers {\n    aws = {\n      source                = \u003cspan class=\"hljs-string\"\u003e\"hashicorp/aws\"\u003c/span\u003e\n      version               = \u003cspan class=\"hljs-string\"\u003e\"~\u003e 5.0\"\u003c/span\u003e\n      configuration_aliases = [aws.\u003cspan class=\"hljs-property\"\u003eus_west\u003c/span\u003e]\n    }\n  }\n}\n\nprovider \u003cspan class=\"hljs-string\"\u003e\"aws\"\u003c/span\u003e {\n  alias  = \u003cspan class=\"hljs-string\"\u003e\"us_west\"\u003c/span\u003e\n  region = \u003cspan class=\"hljs-string\"\u003e\"us-west-1\"\u003c/span\u003e\n}\n\nresource \u003cspan class=\"hljs-string\"\u003e\"aws_vpc\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"main_vpc\"\u003c/span\u003e {\n  cidr_block = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_cidr\u003c/span\u003e\n\n  tags = {\n    \u003cspan class=\"hljs-title class_\"\u003eName\u003c/span\u003e       = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_name\u003c/span\u003e\n    created_by = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eowner_name\u003c/span\u003e\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eì§€ê¸ˆ, í”„ë¡œì íŠ¸ ë£¨íŠ¸ì˜ main.tf íŒŒì¼ì— ëª¨ë“ˆì„ ê°€ì ¸ì˜¤ê² ìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eterraform {\n  required_providers {\n    aws = {\n      source  = \u003cspan class=\"hljs-string\"\u003e\"hashicorp/aws\"\u003c/span\u003e\n      version = \u003cspan class=\"hljs-string\"\u003e\"~\u003e 5.0\"\u003c/span\u003e\n    }\n  }\n}\n\nprovider \u003cspan class=\"hljs-string\"\u003e\"aws\"\u003c/span\u003e {\n  region = \u003cspan class=\"hljs-string\"\u003e\"us-east-1\"\u003c/span\u003e\n}\n\nprovider \u003cspan class=\"hljs-string\"\u003e\"aws\"\u003c/span\u003e {\n  alias  = \u003cspan class=\"hljs-string\"\u003e\"us_west\"\u003c/span\u003e\n  region = \u003cspan class=\"hljs-string\"\u003e\"us-west-1\"\u003c/span\u003e\n}\n\n\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"vpc_A\"\u003c/span\u003e {\n  source     = \u003cspan class=\"hljs-string\"\u003e\"./modules/vpc\"\u003c/span\u003e\n  vpc_name   = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpcs\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"vpc_A\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"vpc_name\"\u003c/span\u003e]\n  vpc_cidr   = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpcs\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"vpc_A\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"cidr_block\"\u003c/span\u003e]\n  owner_name = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eowner_name\u003c/span\u003e\n}\n\n\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"vpc_B\"\u003c/span\u003e {\n  source     = \u003cspan class=\"hljs-string\"\u003e\"./modules/vpc\"\u003c/span\u003e\n  vpc_name   = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpcs\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"vpc_B\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"vpc_name\"\u003c/span\u003e]\n  vpc_cidr   = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpcs\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"vpc_B\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"cidr_block\"\u003c/span\u003e]\n  owner_name = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eowner_name\u003c/span\u003e\n  providers = {\n    aws = aws.\u003cspan class=\"hljs-property\"\u003eus_west\u003c/span\u003e\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eStep 2: Subnetsìš© ëª¨ë“ˆì„ ë§Œë“¤ì–´ importí•´ë³´ì„¸ìš”.\u003c/h2\u003e\n\u003cp\u003emodules/subnets/main.tf\u003c/p\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eterraform {\n  required_providers {\n    aws = {\n      source  = \u003cspan class=\"hljs-string\"\u003e\"hashicorp/aws\"\u003c/span\u003e\n      version = \u003cspan class=\"hljs-string\"\u003e\"~\u003e 5.0\"\u003c/span\u003e\n      # configuration_aliases = [aws.\u003cspan class=\"hljs-property\"\u003eus_west\u003c/span\u003e]\n    }\n  }\n}\n\nprovider \u003cspan class=\"hljs-string\"\u003e\"aws\"\u003c/span\u003e {\n  alias  = \u003cspan class=\"hljs-string\"\u003e\"us_west\"\u003c/span\u003e\n  region = \u003cspan class=\"hljs-string\"\u003e\"us-west-1\"\u003c/span\u003e\n}\n\nresource \u003cspan class=\"hljs-string\"\u003e\"aws_subnet\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"main_subnet\"\u003c/span\u003e {\n  vpc_id            = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_id\u003c/span\u003e\n  cidr_block        = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esubnet_cidr\u003c/span\u003e\n  availability_zone = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eavailability_zone\u003c/span\u003e\n\n  tags = {\n    \u003cspan class=\"hljs-title class_\"\u003eName\u003c/span\u003e       = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esubnet_name\u003c/span\u003e\n    created_by = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eowner_name\u003c/span\u003e\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eì´ì œ í”„ë¡œì íŠ¸ ë£¨íŠ¸ì˜ main.tf íŒŒì¼ì— ëª¨ë“ˆì„ ê°€ì ¸ ì˜¤ê² ìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"subnetsForvpc_A\"\u003c/span\u003e {\n  for_each          = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esubnetsForvpc_A\u003c/span\u003e\n  source            = \u003cspan class=\"hljs-string\"\u003e\"./modules/subnets\"\u003c/span\u003e\n  vpc_id            = \u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_A\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_id\u003c/span\u003e\n  subnet_cidr       = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esubnetsForvpc_A\u003c/span\u003e[each.\u003cspan class=\"hljs-property\"\u003ekey\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"subnet_cidr\"\u003c/span\u003e]\n  subnet_name       = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esubnetsForvpc_A\u003c/span\u003e[each.\u003cspan class=\"hljs-property\"\u003ekey\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"subnet_name\"\u003c/span\u003e]\n  availability_zone = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esubnetsForvpc_A\u003c/span\u003e[each.\u003cspan class=\"hljs-property\"\u003ekey\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"availability_zone\"\u003c/span\u003e]\n  owner_name        = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eowner_name\u003c/span\u003e\n}\n\n\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"subnetsForvpc_B\"\u003c/span\u003e {\n  for_each          = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esubnetsForvpc_B\u003c/span\u003e\n  source            = \u003cspan class=\"hljs-string\"\u003e\"./modules/subnets\"\u003c/span\u003e\n  vpc_id            = \u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_B\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_id\u003c/span\u003e\n  subnet_cidr       = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esubnetsForvpc_B\u003c/span\u003e[each.\u003cspan class=\"hljs-property\"\u003ekey\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"subnet_cidr\"\u003c/span\u003e]\n  subnet_name       = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esubnetsForvpc_B\u003c/span\u003e[each.\u003cspan class=\"hljs-property\"\u003ekey\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"subnet_name\"\u003c/span\u003e]\n  availability_zone = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esubnetsForvpc_B\u003c/span\u003e[each.\u003cspan class=\"hljs-property\"\u003ekey\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"availability_zone\"\u003c/span\u003e]\n  owner_name        = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eowner_name\u003c/span\u003e\n  providers = {\n    aws = aws.\u003cspan class=\"hljs-property\"\u003eus_west\u003c/span\u003e\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eë‹¨ê³„ 3: ë³´ì•ˆ ê·¸ë£¹ ëª¨ë“ˆì„ ìƒì„±í•˜ê³  ê°€ì ¸ ì˜¤ê¸°\u003c/h2\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003emodules/security-groups/main.tf\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eterraform {\n  required_providers {\n    aws = {\n      source                = \u003cspan class=\"hljs-string\"\u003e\"hashicorp/aws\"\u003c/span\u003e\n      version               = \u003cspan class=\"hljs-string\"\u003e\"~\u003e 5.0\"\u003c/span\u003e\n      configuration_aliases = [aws.\u003cspan class=\"hljs-property\"\u003eus_west\u003c/span\u003e]\n    }\n  }\n}\n\nprovider \u003cspan class=\"hljs-string\"\u003e\"aws\"\u003c/span\u003e {\n  alias  = \u003cspan class=\"hljs-string\"\u003e\"us_west\"\u003c/span\u003e\n  region = \u003cspan class=\"hljs-string\"\u003e\"us-west-1\"\u003c/span\u003e\n}\n\nresource \u003cspan class=\"hljs-string\"\u003e\"aws_security_group\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"allow_ssh\"\u003c/span\u003e {\n  name        = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esg_name\u003c/span\u003e\n  description = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esg_description\u003c/span\u003e\n  vpc_id      = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_id\u003c/span\u003e\n\n  ingress {\n    description = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eingress_description\u003c/span\u003e\n    from_port   = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eingress_from_port\u003c/span\u003e\n    to_port     = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eingress_to_port\u003c/span\u003e\n    protocol    = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eingress_protocol\u003c/span\u003e\n    cidr_blocks = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eingress_cidr_blocks\u003c/span\u003e\n  }\n\n  egress {\n    from_port   = \u003cspan class=\"hljs-string\"\u003e\"0\"\u003c/span\u003e\n    to_port     = \u003cspan class=\"hljs-string\"\u003e\"0\"\u003c/span\u003e\n    protocol    = \u003cspan class=\"hljs-string\"\u003e\"-1\"\u003c/span\u003e\n    cidr_blocks = [\u003cspan class=\"hljs-string\"\u003e\"0.0.0.0/0\"\u003c/span\u003e]\n  }\n\n  tags = {\n    \u003cspan class=\"hljs-title class_\"\u003eName\u003c/span\u003e       = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esg_name\u003c/span\u003e\n    created_by = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eowner_name\u003c/span\u003e\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eë³´ì•ˆ ê·¸ë£¹ì„ ìœ„í•´, ì €ëŠ” main.tf íŒŒì¼ì—ì„œ í”„ë¡œì íŠ¸ ë£¨íŠ¸ë¡œ ëª¨ë“ˆì„ ë‘ ë²ˆ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤. ì²« ë²ˆì§¸ ë³´ì•ˆ ê·¸ë£¹ì€ EC2ë¡œ SSHë¥¼ í—ˆìš©í•˜ê³ , ë‘ ë²ˆì§¸ëŠ” EC2ì—ì„œ ICMP íŒ¨í‚·ì˜ íë¦„ì„ í—ˆìš©í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"ssh_sg_vpcA\"\u003c/span\u003e {\n  source              = \u003cspan class=\"hljs-string\"\u003e\"./modules/security-groups\"\u003c/span\u003e\n  sg_name             = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esgs\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"ssh_sg\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"sg_name\"\u003c/span\u003e]\n  sg_description      = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esgs\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"ssh_sg\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"sg_description\"\u003c/span\u003e]\n  ingress_description = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esgs\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"ssh_sg\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"ingress_description\"\u003c/span\u003e]\n  ingress_from_port   = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esgs\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"ssh_sg\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"ingress_from_port\"\u003c/span\u003e]\n  ingress_to_port     = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esgs\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"ssh_sg\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"ingress_to_port\"\u003c/span\u003e]\n  ingress_protocol    = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esgs\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"ssh_sg\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"ingress_protocol\"\u003c/span\u003e]\n  ingress_cidr_blocks = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esg_cidr_blocks\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"ssh_sg\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"ingress_cidr_blocks\"\u003c/span\u003e]\n  owner_name          = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eowner_name\u003c/span\u003e\n  vpc_id              = \u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_A\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_id\u003c/span\u003e\n}\n\n\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"ssh_sg_vpcB\"\u003c/span\u003e {\n  source              = \u003cspan class=\"hljs-string\"\u003e\"./modules/security-groups\"\u003c/span\u003e\n  sg_name             = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esgs\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"ssh_sg\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"sg_name\"\u003c/span\u003e]\n  sg_description      = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esgs\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"ssh_sg\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"sg_description\"\u003c/span\u003e]\n  ingress_description = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esgs\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"ssh_sg\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"ingress_description\"\u003c/span\u003e]\n  ingress_from_port   = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esgs\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"ssh_sg\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"ingress_from_port\"\u003c/span\u003e]\n  ingress_to_port     = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esgs\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"ssh_sg\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"ingress_to_port\"\u003c/span\u003e]\n  ingress_protocol    = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esgs\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"ssh_sg\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"ingress_protocol\"\u003c/span\u003e]\n  ingress_cidr_blocks = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esg_cidr_blocks\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"ssh_sg\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"ingress_cidr_blocks\"\u003c/span\u003e]\n  owner_name          = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eowner_name\u003c/span\u003e\n  vpc_id              = \u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_B\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_id\u003c/span\u003e\n  providers = {\n    aws = aws.\u003cspan class=\"hljs-property\"\u003eus_west\u003c/span\u003e\n  }\n}\n\n\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"icmp_sg_vpcA\"\u003c/span\u003e {\n  source              = \u003cspan class=\"hljs-string\"\u003e\"./modules/security-groups\"\u003c/span\u003e\n  sg_name             = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esgs\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"icmp_sg\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"sg_name\"\u003c/span\u003e]\n  sg_description      = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esgs\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"icmp_sg\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"sg_description\"\u003c/span\u003e]\n  ingress_description = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esgs\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"icmp_sg\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"ingress_description\"\u003c/span\u003e]\n  ingress_from_port   = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esgs\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"icmp_sg\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"ingress_from_port\"\u003c/span\u003e]\n  ingress_to_port     = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esgs\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"icmp_sg\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"ingress_to_port\"\u003c/span\u003e]\n  ingress_protocol    = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esgs\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"icmp_sg\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"ingress_protocol\"\u003c/span\u003e]\n  ingress_cidr_blocks = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esg_cidr_blocks\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"icmp_sg\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"ingress_cidr_blocks_for_vpcA\"\u003c/span\u003e]\n  owner_name          = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eowner_name\u003c/span\u003e\n  vpc_id              = \u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_A\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_id\u003c/span\u003e\n}\n\n\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"icmp_sg_vpcB\"\u003c/span\u003e {\n  source              = \u003cspan class=\"hljs-string\"\u003e\"./modules/security-groups\"\u003c/span\u003e\n  sg_name             = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esgs\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"icmp_sg\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"sg_name\"\u003c/span\u003e]\n  sg_description      = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esgs\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"icmp_sg\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"sg_description\"\u003c/span\u003e]\n  ingress_description = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esgs\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"icmp_sg\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"ingress_description\"\u003c/span\u003e]\n  ingress_from_port   = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esgs\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"icmp_sg\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"ingress_from_port\"\u003c/span\u003e]\n  ingress_to_port     = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esgs\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"icmp_sg\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"ingress_to_port\"\u003c/span\u003e]\n  ingress_protocol    = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esgs\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"icmp_sg\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"ingress_protocol\"\u003c/span\u003e]\n  ingress_cidr_blocks = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esg_cidr_blocks\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"icmp_sg\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"ingress_cidr_blocks_for_vpcB\"\u003c/span\u003e]\n  owner_name          = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eowner_name\u003c/span\u003e\n  vpc_id              = \u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_B\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_id\u003c/span\u003e\n  providers = {\n    aws = aws.\u003cspan class=\"hljs-property\"\u003eus_west\u003c/span\u003e\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch2\u003eë‹¨ê³„ 4: EC2ë¥¼ ìœ„í•œ ëª¨ë“ˆ ìƒì„± ë° ê°€ì ¸ì˜¤ê¸°\u003c/h2\u003e\n\u003cp\u003emodules/ec2/main.tf\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eterraform {\n  required_providers {\n    aws = {\n      source                = \u003cspan class=\"hljs-string\"\u003e\"hashicorp/aws\"\u003c/span\u003e\n      version               = \u003cspan class=\"hljs-string\"\u003e\"~\u003e 5.0\"\u003c/span\u003e\n      configuration_aliases = [aws.\u003cspan class=\"hljs-property\"\u003eus_west\u003c/span\u003e]\n    }\n  }\n}\n\nprovider \u003cspan class=\"hljs-string\"\u003e\"aws\"\u003c/span\u003e {\n  alias  = \u003cspan class=\"hljs-string\"\u003e\"us_west\"\u003c/span\u003e\n  region = \u003cspan class=\"hljs-string\"\u003e\"us-west-1\"\u003c/span\u003e\n}\n\nresource \u003cspan class=\"hljs-string\"\u003e\"aws_instance\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"my_ec2\"\u003c/span\u003e {\n\n  ami                         = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eami_id\u003c/span\u003e\n  instance_type               = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003einstance_type\u003c/span\u003e\n  subnet_id                   = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esubnet_id\u003c/span\u003e\n  associate_public_ip_address = \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e\n  key_name                    = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ekey_name\u003c/span\u003e\n\n  tags = {\n    \u003cspan class=\"hljs-title class_\"\u003eName\u003c/span\u003e       = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eec2_name\u003c/span\u003e\n    created_by = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eowner_name\u003c/span\u003e\n  }\n}\n\nresource \u003cspan class=\"hljs-string\"\u003e\"aws_network_interface_sg_attachment\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"ssh_sg_attachment\"\u003c/span\u003e {\n  security_group_id    = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003essh_sg_id\u003c/span\u003e\n  network_interface_id = aws_instance.\u003cspan class=\"hljs-property\"\u003emy_ec2\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eprimary_network_interface_id\u003c/span\u003e\n}\n\nresource \u003cspan class=\"hljs-string\"\u003e\"aws_network_interface_sg_attachment\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"icmp_sg_attachment\"\u003c/span\u003e {\n  security_group_id    = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eicmp_sg_id\u003c/span\u003e\n  network_interface_id = aws_instance.\u003cspan class=\"hljs-property\"\u003emy_ec2\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eprimary_network_interface_id\u003c/span\u003e\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eì´ì œ ëª¨ë“ˆì„ í”„ë¡œì íŠ¸ ë£¨íŠ¸ì˜ main.tf íŒŒì¼ì— ê°€ì ¸ì˜¤ê² ìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003emodule \"ec2_vpcA\" {\nsource = \"./modules/ec2\"\nsubnet_id = module.subnetsForvpc_A[\"subnet1\"].subnet_id\nami_id = var.ec2s[\"ec2_vpcA\"][\"ami_id\"]\ninstance_type = var.ec2s[\"ec2_vpcA\"][\"instance_type\"]\nec2_name = var.ec2s[\"ec2_vpcA\"][\"ec2_name\"]\nkey_name = var.ec2s[\"ec2_vpcA\"][\"key_name\"]\nssh_sg_id = module.ssh_sg_vpcA.sg_id\nicmp_sg_id = module.icmp_sg_vpcA.sg_id\nowner_name = var.owner_name\n}\u003c/p\u003e\n\u003cp\u003emodule \"ec2_vpcB\" {\nsource = \"./modules/ec2\"\nsubnet_id = module.subnetsForvpc_B[\"subnet1\"].subnet_id\nami_id = var.ec2s[\"ec2_vpcB\"][\"ami_id\"]\ninstance_type = var.ec2s[\"ec2_vpcB\"][\"instance_type\"]\nec2_name = var.ec2s[\"ec2_vpcB\"][\"ec2_name\"]\nkey_name = var.ec2s[\"ec2_vpcB\"][\"key_name\"]\nssh_sg_id = module.ssh_sg_vpcB.sg_id\nicmp_sg_id = module.icmp_sg_vpcB.sg_id\nowner_name = var.owner_name\nproviders = {\naws = aws.us_west\n}\n}\u003c/p\u003e\n\u003ch2\u003eStep 5: Create modules for Internet Gateways and importing them\u003c/h2\u003e\n\u003cp\u003emodules/internet-gateways/main.tf\u003c/p\u003e\n\u003cp\u003eterraform {\nrequired_providers {\naws = {\nsource = \"hashicorp/aws\"\nversion = \"~\u003e 5.0\"\nconfiguration_aliases = [aws.us_west]\n}\n}\n}\u003c/p\u003e\n\u003cp\u003eprovider \"aws\" {\nalias = \"us_west\"\nregion = \"us-west-1\"\n}\u003c/p\u003e\n\u003cp\u003eresource \"aws_internet_gateway\" \"i_gw\" {\nvpc_id = var.vpc_id\u003c/p\u003e\n\u003cp\u003etags = {\nName = var.igw_name\ncreated_by = var.owner_name\n}\n}\u003c/p\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eì´ì œ, í”„ë¡œì íŠ¸ ë£¨íŠ¸ì˜ main.tf íŒŒì¼ì— ëª¨ë“ˆì„ ê°€ì ¸ì˜¤ê² ìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"igw_vpcA\"\u003c/span\u003e {\n  source     = \u003cspan class=\"hljs-string\"\u003e\"./modules/internet-gateways\"\u003c/span\u003e\n  vpc_id     = \u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_A\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_id\u003c/span\u003e\n  igw_name   = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eigws\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"igw_vpcA\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"name\"\u003c/span\u003e]\n  owner_name = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eowner_name\u003c/span\u003e\n}\n\n\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"igw_vpcB\"\u003c/span\u003e {\n  source     = \u003cspan class=\"hljs-string\"\u003e\"./modules/internet-gateways\"\u003c/span\u003e\n  vpc_id     = \u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_B\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_id\u003c/span\u003e\n  igw_name   = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eigws\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"igw_vpcB\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"name\"\u003c/span\u003e]\n  owner_name = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eowner_name\u003c/span\u003e\n  providers = {\n    aws = aws.\u003cspan class=\"hljs-property\"\u003eus_west\u003c/span\u003e\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eë‹¨ê³„ 6: VPC Peering, VPC Peering accepter, VPC Peering configureìš© ëª¨ë“ˆ ìƒì„± ë° ê°€ì ¸ì˜¤ê¸°\u003c/h2\u003e\n\u003cp\u003eëª¨ë“ˆ - VPC Peering (modules/vpc-peering/main.tf)\u003c/p\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-kotlin\"\u003eí…Œë¼í¼ {\n  í•„ìˆ˜_ì œê³µì {\n    aws = {\n      ì†ŒìŠ¤ = \u003cspan class=\"hljs-string\"\u003e\"hashicorp/aws\"\u003c/span\u003e\n      ë²„ì „ = \u003cspan class=\"hljs-string\"\u003e\"~\u003e 5.0\"\u003c/span\u003e\n      êµ¬ì„±_ë³„ì¹­ = [aws.us_west]\n    }\n  }\n}\n\nì œê³µì \u003cspan class=\"hljs-string\"\u003e\"aws\"\u003c/span\u003e {\n  ë³„ì¹­  = \u003cspan class=\"hljs-string\"\u003e\"us_west\"\u003c/span\u003e\n  ì§€ì—­ = \u003cspan class=\"hljs-string\"\u003e\"us-west-1\"\u003c/span\u003e\n}\n\në¦¬ì†ŒìŠ¤ \u003cspan class=\"hljs-string\"\u003e\"aws_vpc_peering_connection\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"vpc_peering\"\u003c/span\u003e {\n  peer_vpc_id = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.peer_vpc_id\n  vpc_id      = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.vpc_id\n  peer_region = \u003cspan class=\"hljs-string\"\u003e\"us-west-1\"\u003c/span\u003e\n  tags = {\n    ì´ë¦„       = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.vpcpeer_name\n    ìƒì„±ì = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.owner_name\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eëª¨ë“ˆ â€” VPC í”¼ì–´ë§ ìˆ˜ë½ì (modules/vpc-peering-accepter/main.tf)\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-kotlin\"\u003eí…Œë¼í¼ {\n  í•„ìˆ˜_ì œê³µì {\n    aws = {\n      ì†ŒìŠ¤ = \u003cspan class=\"hljs-string\"\u003e\"hashicorp/aws\"\u003c/span\u003e\n      ë²„ì „ = \u003cspan class=\"hljs-string\"\u003e\"~\u003e 5.0\"\u003c/span\u003e\n      êµ¬ì„±_ë³„ì¹­ = [aws.us_west]\n    }\n  }\n}\n\nì œê³µì \u003cspan class=\"hljs-string\"\u003e\"aws\"\u003c/span\u003e {\n  ë³„ì¹­  = \u003cspan class=\"hljs-string\"\u003e\"us_west\"\u003c/span\u003e\n  ì§€ì—­ = \u003cspan class=\"hljs-string\"\u003e\"us-west-1\"\u003c/span\u003e\n}\n\në¦¬ì†ŒìŠ¤ \u003cspan class=\"hljs-string\"\u003e\"aws_vpc_peering_connection_accepter\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"peer_vpc_AB\"\u003c/span\u003e {\n  provider = aws.us_west\n\n  vpc_peering_connection_id = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.vpc_peering_id\n  auto_accept               = \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e\n\n  tags = {\n    ìª½       = \u003cspan class=\"hljs-string\"\u003e\"ìˆ˜ë½ì\"\u003c/span\u003e\n    ì†Œìœ ì_ì´ë¦„ = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.owner_name\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eëª¨ë“ˆ â€” VPC í”¼ì–´ë§ êµ¬ì„± (modules/vpc-peering-configure/main.tf)\u003c/p\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eterraform {\n  required_providers {\n    aws = {\n      source                = \u003cspan class=\"hljs-string\"\u003e\"hashicorp/aws\"\u003c/span\u003e\n      version               = \u003cspan class=\"hljs-string\"\u003e\"~\u003e 5.0\"\u003c/span\u003e\n      configuration_aliases = [aws.\u003cspan class=\"hljs-property\"\u003eus_west\u003c/span\u003e]\n    }\n  }\n}\n\nprovider \u003cspan class=\"hljs-string\"\u003e\"aws\"\u003c/span\u003e {\n  alias  = \u003cspan class=\"hljs-string\"\u003e\"us_west\"\u003c/span\u003e\n  region = \u003cspan class=\"hljs-string\"\u003e\"us-west-1\"\u003c/span\u003e\n}\n\nresource \u003cspan class=\"hljs-string\"\u003e\"aws_vpc_peering_connection_options\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"vpc_peering_configure\"\u003c/span\u003e {\n  vpc_peering_connection_id = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_peering_connection_id\u003c/span\u003e\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eì´ì œ, ìœ„ì˜ ëª¨ë“  ëª¨ë“ˆì„ ë£¨íŠ¸ì˜ main.tf íŒŒì¼ë¡œ ê°€ì ¸ì˜¤ê² ìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"vpc_peering\"\u003c/span\u003e {\n  source       = \u003cspan class=\"hljs-string\"\u003e\"./modules/vpc-peering\"\u003c/span\u003e\n  peer_vpc_id  = \u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_B\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_id\u003c/span\u003e\n  vpc_id       = \u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_A\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_id\u003c/span\u003e\n  vpcpeer_name = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpcpeer_name\u003c/span\u003e\n  owner_name   = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eowner_name\u003c/span\u003e\n}\n\n\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"vpc_peering_accepter\"\u003c/span\u003e {\n  source         = \u003cspan class=\"hljs-string\"\u003e\"./modules/vpc-peering-accepter\"\u003c/span\u003e\n  vpc_peering_id = \u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_peering\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eaws_vpc_peering_connection_id\u003c/span\u003e\n  owner_name     = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eowner_name\u003c/span\u003e\n  providers = {\n    aws = aws.\u003cspan class=\"hljs-property\"\u003eus_west\u003c/span\u003e\n  }\n}\n\n\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"vpc_peering_configureA\"\u003c/span\u003e {\n  source                    = \u003cspan class=\"hljs-string\"\u003e\"./modules/vpc_peer_configure\"\u003c/span\u003e\n  vpc_peering_connection_id = \u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_peering_accepter\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eaws_vpc_peering_connection_accepter\u003c/span\u003e\n}\n\n\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"vpc_peering_configureB\"\u003c/span\u003e {\n  source                    = \u003cspan class=\"hljs-string\"\u003e\"./modules/vpc_peer_configure\"\u003c/span\u003e\n  vpc_peering_connection_id = \u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_peering_accepter\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eaws_vpc_peering_connection_accepter\u003c/span\u003e\n  providers = {\n    aws = aws.\u003cspan class=\"hljs-property\"\u003eus_west\u003c/span\u003e\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eë‹¨ê³„ 7: ë¼ìš°íŠ¸ í…Œì´ë¸”ì„ ìœ„í•œ ëª¨ë“ˆ ë§Œë“¤ê¸° ë° ê°€ì ¸ì˜¤ê¸°\u003c/h2\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003emodules/route-tables/main.tf\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eterraform {\n  required_providers {\n    aws = {\n      source                = \u003cspan class=\"hljs-string\"\u003e\"hashicorp/aws\"\u003c/span\u003e\n      version               = \u003cspan class=\"hljs-string\"\u003e\"~\u003e 5.0\"\u003c/span\u003e\n      configuration_aliases = [aws.\u003cspan class=\"hljs-property\"\u003eus_west\u003c/span\u003e]\n    }\n  }\n}\n\nprovider \u003cspan class=\"hljs-string\"\u003e\"aws\"\u003c/span\u003e {\n  alias  = \u003cspan class=\"hljs-string\"\u003e\"us_west\"\u003c/span\u003e\n  region = \u003cspan class=\"hljs-string\"\u003e\"us-west-1\"\u003c/span\u003e\n}\n\nresource \u003cspan class=\"hljs-string\"\u003e\"aws_route\"\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"route\"\u003c/span\u003e {\n  route_table_id            = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eroute_table_id\u003c/span\u003e\n  destination_cidr_block    = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003edestination_cidr_block\u003c/span\u003e\n  gateway_id                = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003egateway_id\u003c/span\u003e != \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e ? \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003egateway_id\u003c/span\u003e : \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e\n  vpc_peering_connection_id = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_peering_connection_id\u003c/span\u003e != \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e ? \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_peering_connection_id\u003c/span\u003e : \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eì´ì œ í”„ë¡œì íŠ¸ ë£¨íŠ¸ì˜ main.tf íŒŒì¼ì— ëª¨ë“ˆì„ ê°€ì ¸ì™€ë³´ê² ìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"route_table_vpcA_pcgw\"\u003c/span\u003e {\n  source                    = \u003cspan class=\"hljs-string\"\u003e\"./modules/route-table\"\u003c/span\u003e\n  route_table_id            = \u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_A\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003edefault_route_table_id\u003c/span\u003e\n  destination_cidr_block    = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003edestination_cidr_blocks_for_routetable\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"for_route_vpcA\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"pcgw_cidr\"\u003c/span\u003e]\n  vpc_peering_connection_id = \u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_peering\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eaws_vpc_peering_connection_id\u003c/span\u003e\n  gateway_id                = \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\n}\n\n\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"route_table_vpcB_pcgw\"\u003c/span\u003e {\n  source                    = \u003cspan class=\"hljs-string\"\u003e\"./modules/route-table\"\u003c/span\u003e\n  route_table_id            = \u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_B\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003edefault_route_table_id\u003c/span\u003e\n  destination_cidr_block    = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003edestination_cidr_blocks_for_routetable\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"for_route_vpcB\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"pcgw_cidr\"\u003c/span\u003e]\n  vpc_peering_connection_id = \u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_peering\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eaws_vpc_peering_connection_id\u003c/span\u003e\n  gateway_id                = \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\n  providers = {\n    aws = aws.\u003cspan class=\"hljs-property\"\u003eus_west\u003c/span\u003e\n  }\n}\n\n\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"route_table_vpcA_igw\"\u003c/span\u003e {\n  source                    = \u003cspan class=\"hljs-string\"\u003e\"./modules/route-table\"\u003c/span\u003e\n  route_table_id            = \u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_A\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003edefault_route_table_id\u003c/span\u003e\n  destination_cidr_block    = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003edestination_cidr_blocks_for_routetable\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"for_route_vpcA\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"igw_cidr\"\u003c/span\u003e]\n  gateway_id                = \u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eigw_vpcA\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eigw_id\u003c/span\u003e\n  vpc_peering_connection_id = \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\n}\n\n\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"route_table_vpcB_igw\"\u003c/span\u003e {\n  source                    = \u003cspan class=\"hljs-string\"\u003e\"./modules/route-table\"\u003c/span\u003e\n  route_table_id            = \u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003evpc_B\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003edefault_route_table_id\u003c/span\u003e\n  destination_cidr_block    = \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003edestination_cidr_blocks_for_routetable\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e\"for_route_vpcB\"\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e\"igw_cidr\"\u003c/span\u003e]\n  gateway_id                = \u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eigw_vpcB\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eigw_id\u003c/span\u003e\n  vpc_peering_connection_id = \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\n  providers = {\n    aws = aws.\u003cspan class=\"hljs-property\"\u003eus_west\u003c/span\u003e\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch2\u003eë‹¨ê³„ 8: dev-env.tfvars íŒŒì¼ ì‘ì„±\u003c/h2\u003e\n\u003cp\u003evariable.tfvars/dev-env.tfvars\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eowner_name = \u003cspan class=\"hljs-string\"\u003e\"NIKUNJ\"\u003c/span\u003e\n\nvpcs = {\n  \u003cspan class=\"hljs-string\"\u003e\"vpc_A\"\u003c/span\u003e = {\n    vpc_name   = \u003cspan class=\"hljs-string\"\u003e\"vpc-us-east1\"\u003c/span\u003e\n    cidr_block = \u003cspan class=\"hljs-string\"\u003e\"10.1.0.0/16\"\u003c/span\u003e\n  }\n  \u003cspan class=\"hljs-string\"\u003e\"vpc_B\"\u003c/span\u003e = {\n    vpc_name   = \u003cspan class=\"hljs-string\"\u003e\"vpc-us-west1\"\u003c/span\u003e\n    cidr_block = \u003cspan class=\"hljs-string\"\u003e\"10.2.0.0/16\"\u003c/span\u003e\n  }\n}\n\nvpc_Aì— ëŒ€í•œ ì„œë¸Œë„· ëª©ë¡ = {\n  \u003cspan class=\"hljs-string\"\u003e\"subnet1\"\u003c/span\u003e = {\n    subnet_cidr       = \u003cspan class=\"hljs-string\"\u003e\"10.1.0.0/20\"\u003c/span\u003e\n    subnet_name       = \u003cspan class=\"hljs-string\"\u003e\"subnet-us-east1a\"\u003c/span\u003e\n    availability_zone = \u003cspan class=\"hljs-string\"\u003e\"us-east-1a\"\u003c/span\u003e\n  }\n  \u003cspan class=\"hljs-string\"\u003e\"subnet2\"\u003c/span\u003e = {\n    subnet_cidr       = \u003cspan class=\"hljs-string\"\u003e\"10.1.16.0/20\"\u003c/span\u003e\n    subnet_name       = \u003cspan class=\"hljs-string\"\u003e\"subnet-us-east1b\"\u003c/span\u003e\n    availability_zone = \u003cspan class=\"hljs-string\"\u003e\"us-east-1b\"\u003c/span\u003e\n  }\n  \u003cspan class=\"hljs-string\"\u003e\"subnet3\"\u003c/span\u003e = {\n    subnet_cidr       = \u003cspan class=\"hljs-string\"\u003e\"10.1.32.0/20\"\u003c/span\u003e\n    subnet_name       = \u003cspan class=\"hljs-string\"\u003e\"subnet-us-east1c\"\u003c/span\u003e\n    availability_zone = \u003cspan class=\"hljs-string\"\u003e\"us-east-1c\"\u003c/span\u003e\n  }\n}\n\nvpc_Bì— ëŒ€í•œ ì„œë¸Œë„· ëª©ë¡ = {\n  \u003cspan class=\"hljs-string\"\u003e\"subnet1\"\u003c/span\u003e = {\n    subnet_cidr       = \u003cspan class=\"hljs-string\"\u003e\"10.2.0.0/20\"\u003c/span\u003e\n    subnet_name       = \u003cspan class=\"hljs-string\"\u003e\"subnet-us-west1a\"\u003c/span\u003e\n    availability_zone = \u003cspan class=\"hljs-string\"\u003e\"us-west-1a\"\u003c/span\u003e\n  }\n  \u003cspan class=\"hljs-string\"\u003e\"subnet2\"\u003c/span\u003e = {\n    subnet_cidr       = \u003cspan class=\"hljs-string\"\u003e\"10.2.16.0/20\"\u003c/span\u003e\n    subnet_name       = \u003cspan class=\"hljs-string\"\u003e\"subnet-us-west1b\"\u003c/span\u003e\n    availability_zone = \u003cspan class=\"hljs-string\"\u003e\"us-west-1b\"\u003c/span\u003e\n  }\n}\n\në³´ì•ˆ ê·¸ë£¹ ëª©ë¡ = {\n  \u003cspan class=\"hljs-string\"\u003e\"ssh_sg\"\u003c/span\u003e = {\n    sg_name             = \u003cspan class=\"hljs-string\"\u003e\"allow_ssh\"\u003c/span\u003e\n    sg_description      = \u003cspan class=\"hljs-string\"\u003e\"ë‚´ IPì—ì„œ SSH í—ˆìš©\"\u003c/span\u003e\n    ingress_description = \u003cspan class=\"hljs-string\"\u003e\"ë‚´ IPë¥¼ ìœ„í•œ SSH\"\u003c/span\u003e\n    ingress_from_port   = \u003cspan class=\"hljs-string\"\u003e\"22\"\u003c/span\u003e\n    ingress_to_port     = \u003cspan class=\"hljs-string\"\u003e\"22\"\u003c/span\u003e\n    ingress_protocol    = \u003cspan class=\"hljs-string\"\u003e\"tcp\"\u003c/span\u003e\n  }\n  \u003cspan class=\"hljs-string\"\u003e\"icmp_sg\"\u003c/span\u003e = {\n    sg_name             = \u003cspan class=\"hljs-string\"\u003e\"allow_ping_traffic\"\u003c/span\u003e\n    sg_description      = \u003cspan class=\"hljs-string\"\u003e\"ë‚´ IPì—ì„œ ping í—ˆìš©\"\u003c/span\u003e\n    ingress_description = \u003cspan class=\"hljs-string\"\u003e\"ë‚´ IPë¡œë¶€í„°ì˜ ping\"\u003c/span\u003e\n    ingress_from_port   = \u003cspan class=\"hljs-string\"\u003e\"8\"\u003c/span\u003e\n    ingress_to_port     = \u003cspan class=\"hljs-string\"\u003e\"0\"\u003c/span\u003e\n    ingress_protocol    = \u003cspan class=\"hljs-string\"\u003e\"icmp\"\u003c/span\u003e\n  }\n}\n\nsg_cidr_blocks = {\n  \u003cspan class=\"hljs-string\"\u003e\"ssh_sg\"\u003c/span\u003e = {\n    ingress_cidr_blocks = [\u003cspan class=\"hljs-string\"\u003e\"12.34.56.78/32\"\u003c/span\u003e] # ec2ë¡œì˜ \u003cspan class=\"hljs-variable constant_\"\u003eSSH\u003c/span\u003eê°€ í—ˆìš©ëœ \u003cspan class=\"hljs-variable constant_\"\u003eIP\u003c/span\u003eë¥¼ ì–¸ê¸‰\n  }\n  \u003cspan class=\"hljs-string\"\u003e\"icmp_sg\"\u003c/span\u003e = {\n    ingress_cidr_blocks_for_vpcA = [\u003cspan class=\"hljs-string\"\u003e\"10.2.0.0/16\"\u003c/span\u003e]\n    ingress_cidr_blocks_for_vpcB = [\u003cspan class=\"hljs-string\"\u003e\"10.1.0.0/16\"\u003c/span\u003e]\n  }\n}\n\nec2 ëª©ë¡ = {\n  \u003cspan class=\"hljs-string\"\u003e\"ec2_vpcA\"\u003c/span\u003e = {\n    ami_id        = \u003cspan class=\"hljs-string\"\u003e\"ami-0e8a34246278c21e4\"\u003c/span\u003e\n    instance_type = \u003cspan class=\"hljs-string\"\u003e\"t2.micro\"\u003c/span\u003e\n    ec2_name      = \u003cspan class=\"hljs-string\"\u003e\"ec2-us-east1\"\u003c/span\u003e\n    key_name      = \u003cspan class=\"hljs-string\"\u003e\"us-east-1-demo\"\u003c/span\u003e\n  }\n  \u003cspan class=\"hljs-string\"\u003e\"ec2_vpcB\"\u003c/span\u003e = {\n    ami_id        = \u003cspan class=\"hljs-string\"\u003e\"ami-09ab9d570789dfdd4\"\u003c/span\u003e\n    instance_type = \u003cspan class=\"hljs-string\"\u003e\"t2.micro\"\u003c/span\u003e\n    ec2_name      = \u003cspan class=\"hljs-string\"\u003e\"ec2-us-west1\"\u003c/span\u003e\n    key_name      = \u003cspan class=\"hljs-string\"\u003e\"us-west-1-demo\"\u003c/span\u003e\n  }\n}\n\nì¸í„°ë„· ê²Œì´íŠ¸ì›¨ì´ ëª©ë¡ = {\n  \u003cspan class=\"hljs-string\"\u003e\"igw_vpcA\"\u003c/span\u003e = {\n    name = \u003cspan class=\"hljs-string\"\u003e\"igw_vpcA\"\u003c/span\u003e\n  }\n  \u003cspan class=\"hljs-string\"\u003e\"igw_vpcB\"\u003c/span\u003e = {\n    name = \u003cspan class=\"hljs-string\"\u003e\"igw_vpcB\"\u003c/span\u003e\n  }\n}\n\n\u003cspan class=\"hljs-variable constant_\"\u003eVPC\u003c/span\u003e í”¼ì–´ë§ ì´ë¦„ = \u003cspan class=\"hljs-string\"\u003e\"vpc_AB_peering\"\u003c/span\u003e\n\nroute í…Œì´ë¸”ìš© ëŒ€ìƒ \u003cspan class=\"hljs-variable constant_\"\u003eCIDR\u003c/span\u003e ë¸”ë¡ = {\n  \u003cspan class=\"hljs-string\"\u003e\"for_route_vpcA\"\u003c/span\u003e = {\n    pcgw_cidr = \u003cspan class=\"hljs-string\"\u003e\"10.2.0.0/16\"\u003c/span\u003e\n    igw_cidr  = \u003cspan class=\"hljs-string\"\u003e\"0.0.0.0/0\"\u003c/span\u003e\n  }\n  \u003cspan class=\"hljs-string\"\u003e\"for_route_vpcB\"\u003c/span\u003e = {\n    pcgw_cidr = \u003cspan class=\"hljs-string\"\u003e\"10.1.0.0/16\"\u003c/span\u003e\n    igw_cidr  = \u003cspan class=\"hljs-string\"\u003e\"0.0.0.0/0\"\u003c/span\u003e\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eë‹¨ê³„ 9: ì‘ì—… ë””ë ‰í† ë¦¬ ì´ˆê¸°í™”\u003c/h2\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cul\u003e\n\u003cli\u003eì‘ì—… ë””ë ‰í† ë¦¬ì—ì„œ terraform init ëª…ë ¹ì„ ì‹¤í–‰í•˜ì„¸ìš”. ì´ ëª…ë ¹ì€ í•„ìš”í•œ ëª¨ë“  ê³µê¸‰ì ë° ëª¨ë“ˆì„ ë‹¤ìš´ë¡œë“œí•˜ê³  ë°±ì—”ë“œë¥¼ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eë‹¨ê³„ 10: í…Œë¼í¼ ì‹¤í–‰ ê³„íš ìƒì„±\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eì‘ì—… ë””ë ‰í† ë¦¬ì—ì„œ terraform plan ëª…ë ¹ì„ ì‹¤í–‰í•˜ì„¸ìš”. ì‹¤í–‰ ê³„íšì„ ì œê³µí•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eë‹¨ê³„ 11: terraform apply ì‹¤í–‰\u003c/h2\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cul\u003e\n\u003cli\u003eì‘ì—… ë””ë ‰í† ë¦¬ì—ì„œ terraform apply ëª…ë ¹ì„ ì‹¤í–‰í•˜ë©´ AWSì— í•„ìš”í•œ ëª¨ë“  ë¦¬ì†ŒìŠ¤ê°€ ìƒì„±ë©ë‹ˆë‹¤.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eë‹¨ê³„ 12: ì—°ê²° í™•ì¸\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eSSHë¥¼ ì‚¬ìš©í•˜ì—¬ EC2 ì¸ìŠ¤í„´ìŠ¤ ì¤‘ í•˜ë‚˜ì— ì—°ê²°í•˜ê³  ë‹¤ë¥¸ EC2 ì¸ìŠ¤í„´ìŠ¤ì˜ ì‚¬ì„¤ IPë¥¼ ì‚¬ìš©í•˜ì—¬ í•‘ì„ ë³´ëƒ…ë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eëª¨ë“  ê²ƒì´ ì˜ ë˜ì—ˆë‹¤ë©´ ICMP ë°ì´í„° íŒ¨í‚·ì´ ì„±ê³µì ìœ¼ë¡œ ì „ì†¡ë©ë‹ˆë‹¤.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eì—¬ê¸°ê¹Œì§€ì…ë‹ˆë‹¤. ì´ì œ Terraformì„ ì‚¬ìš©í•˜ì—¬ AWS VPC í”¼ì–´ë§ ì—°ê²°ì„ ìƒì„±í•˜ëŠ” ë°©ë²•ì„ ë°°ì› ìŠµë‹ˆë‹¤. ì´ì œ ì—¬ëŸ¬ë¶„ì€ ì´ê²ƒì„ ì‚¬ìš©í•˜ê³  í•„ìš”ì— ë”°ë¼ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003eì „ì²´ ì½”ë“œëŠ” ì—¬ê¸°ì—ì„œ ì°¾ì„ ìˆ˜ ìˆì–´ìš”.\u003c/p\u003e\n\u003cp\u003eì´ ê°€ì´ë“œê°€ ë„ì›€ì´ ë˜ì—ˆë‹¤ë©´ ğŸ‘ ë²„íŠ¼ì„ í´ë¦­í•´ ì£¼ì„¸ìš”. ëŒ“ê¸€ë„ ììœ ë¡­ê²Œ ë‚¨ê²¨ì£¼ì„¸ìš”.\u003c/p\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-05-27-AWS-VPCPeeringwithTerraform"},"buildId":"-dPCbnM2yhdKNgXe92VJV","isFallback":false,"gsp":true,"scriptLoader":[{"async":true,"src":"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4877378276818686","strategy":"lazyOnload","crossOrigin":"anonymous"}]}</script></body></html>