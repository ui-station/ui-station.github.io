<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>전체 구성 Compose 파일 쉽게 설정하는 방법 | ui-station</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://ui-station.github.io///post/2024-06-23-TheWholeShebangComposeFiles" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="전체 구성 Compose 파일 쉽게 설정하는 방법 | ui-station" data-gatsby-head="true"/><meta property="og:title" content="전체 구성 Compose 파일 쉽게 설정하는 방법 | ui-station" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-06-23-TheWholeShebangComposeFiles_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://ui-station.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://ui-station.github.io///post/2024-06-23-TheWholeShebangComposeFiles" data-gatsby-head="true"/><meta name="twitter:title" content="전체 구성 Compose 파일 쉽게 설정하는 방법 | ui-station" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-06-23-TheWholeShebangComposeFiles_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | ui-station" data-gatsby-head="true"/><meta name="article:published_time" content="2024-06-23 00:30" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-BHFR6GTH9P"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
          
            gtag('config', 'G-BHFR6GTH9P');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b8ef307c9aee1e34.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b8ef307c9aee1e34.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-ac4aa08aae62f90e.js" defer=""></script><script src="/_next/static/chunks/463-0429087d4c0b0335.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-70e5ce89f3d962ac.js" defer=""></script><script src="/_next/static/wOkGEDZCvEs3S_XaNsdwr/_buildManifest.js" defer=""></script><script src="/_next/static/wOkGEDZCvEs3S_XaNsdwr/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">UI STATION</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">전체 구성 Compose 파일 쉽게 설정하는 방법</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="전체 구성 Compose 파일 쉽게 설정하는 방법" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">UI STATION</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On Jun 23, 2024</span><span class="posts_reading_time__f7YPP">55<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-06-23-TheWholeShebangComposeFiles&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<img src="/assets/img/2024-06-23-TheWholeShebangComposeFiles_0.png">
<p>요즘 Docker 및 컨테이너에 대해 많이 쓰고 가르치고 있습니다. 내 컨텐츠를 소비하고 피드백을 제공해 주시는 여러분들에게 매우 감사합니다. 여러분의 의견을 듣고 다음 주제는 당연히 Docker Compose입니다. 왜냐하면 이제 여러분은 자신의 컨테이너 이미지를 만들고 실행하는 방법을 알고 있으므로, 다음으로 논리적으로 남은 일은 복잡한 멀티 컨테이너 애플리케이션을 만들고 그 모든 것을 단일 소프트웨어로 관리하는 것입니다.</p>
<h1>Docker Compose: 그게 뭔데, 왜 필요한가요?</h1>
<p>공식 문서에서 더 많은 정보를 확인할 수 있지만, 간단히 말하면 다음과 같습니다: Docker를 사용하여 컨테이너, 이미지, 볼륨 등을 관리합니다. docker run을 실행하면 기본적으로 단일 컨테이너를 실행하는 것입니다. 만약 첫 번째 컨테이너와 상호 작용하는 두 번째 컨테이너를 시작하려면 docker run을 다시 실행해야 하며, 볼륨 및 네트워크를 별도로 처리하여 서로를 보고 통신할 수 있도록 해야 합니다.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>도커 컴포즈는 도커 위에 래퍼를 제공하여 이 모든 것을 추상화합니다 (맞아요! 도커 컴포즈는 단순히 도커를 위한 고수준 CLI입니다). 실제로 대부분의 옵션이 docker run 하위 명령어에서 사용 가능한 옵션들과 매우 유사한 방식으로 명명됩니다.</p>
<p>도커 컴포즈를 사용하면 YAML 파일인 컴포즈 파일을 통해 컨테이너(도커 컴포즈 세계에서는 서비스라고 불립니다... 단지 스웜 모드에서도 컴포즈 파일을 사용할 수 있기 때문에... 다른 글에서 설명할 예정), 볼륨 및 네트워크를 포함한 모든 것을 선언적으로 정의할 수 있습니다. 이렇게 하면 멀티 컨테이너 애플리케이션을 관리해야 할 때, 이 compose 파일만 건드리고 나머지는 도커 컴포즈가 모두 처리하도록 할 수 있습니다.</p>
<h1>컴포즈 파일</h1>
<p>우선, 멀티 컨테이너 애플리케이션을 올바르게 운영하려면 컴포즈 파일을 작성하는 방법을 익혀야 하므로 도커 컴포즈 CLI에 대해서는 다른 글에서 다룰 예정입니다.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>도커의 구성 파일 관련 문서는 매우 완벽하지만, 저는 실용주의와 경험으로부터 배우는 것을 중요하게 생각하는 사람이라서 모든 Compose 파일 옵션을 손질하고 명료한 설명과 실제 예시를 담아내려고 합니다. 여기서 시작해봅시다!</p>
<p>참고 1: 이 기사를 작성하는 시점에서 최신 버전인 v3의 Compose 파일 명세에 대한 옵션과 스키마만 다룰 예정입니다. 그러니 걱정하지 마세요.</p>
<p>참고 2: 각 옵션에 대해 일반적으로 사용되는 방법에 대한 설명과 예시만 제공할 것이며, 특정 옵션 매개변수를 사용해본 적이 없는 경우에는 "일반적이지 않음"으로 간주할 것입니다. 어떤 옵션의 적은 사용 방법 및 일반적이지 않은 매개변수를 더 자세히 알고 싶다면 공식 문서를 참조해주세요.</p>
<p>예시에 들어가기 전에, 모든 구성 파일은 작성하는 현재의 파일 스키마를 나타내는 키워드 version으로 시작됩니다. 앞서 말한대로, 저희는 최신 (버전: "3")을 사용할 것입니다.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2>빌드</h2>
<p>기본적으로 Docker Compose로 무언가를 시작할 때, Docker 이미지 또는 Dockerfile을 제공할 수 있습니다. 해당 컨테이너를 시작하기 전에 Docker가 이미지를 직접 빌드하도록 하고 싶다면 수동으로 이미지를 빌드하지 않고도 이 옵션을 사용할 수 있습니다.</p>
<p>예를 들어:</p>
<pre><code class="hljs language-js">$ cat ><span class="hljs-title class_">Dockerfile</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
# 이것은 <span class="hljs-title class_">Dockerfile</span>입니다
<span class="hljs-variable constant_">FROM</span> ubuntu
<span class="hljs-variable constant_">CMD</span> [<span class="hljs-string">"echo"</span>, <span class="hljs-string">"Hello Medium readers"</span>]
# <span class="hljs-title class_">Dockerfile</span> 끝
<span class="hljs-variable constant_">EOF</span>
$
$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  my-test-<span class="hljs-attr">container</span>:
    <span class="hljs-attr">build</span>: .
<span class="hljs-variable constant_">EOF</span>
$
$ docker-compose up
디폴트 드라이버를 사용하여 <span class="hljs-string">"mediumcom_default"</span> 네트워크 생성 중
my-test-container 빌드 중
<span class="hljs-title class_">Docker</span> 데몬으로 빌드 컨텍스트 보내는 중  <span class="hljs-number">1.</span>337MB
단계 <span class="hljs-number">1</span>/<span class="hljs-number">2</span> : <span class="hljs-variable constant_">FROM</span> ubuntu
 ---> ba6acccedd29
단계 <span class="hljs-number">2</span>/<span class="hljs-number">2</span> : <span class="hljs-variable constant_">CMD</span> [<span class="hljs-string">"echo"</span>, <span class="hljs-string">"Hello Medium readers"</span>]
 ---> 캐시 사용 중
 ---> 6c8b22fa650c
성공적으로 빌드되었습니다 6c8b22fa650c
mediumcom_my-test-<span class="hljs-attr">container</span>:latest로 성공적으로 태깅되었습니다
mediumcom_my-test-container_1 생성 중 ... 완료
mediumcom_my-test-container_1에 연결 중
my-test-container_1  | <span class="hljs-title class_">Hello</span> <span class="hljs-title class_">Medium</span> readers
mediumcom_my-test-container_1는 코드 <span class="hljs-number">0</span>으로 종료됨
$
</code></pre>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>보시다시피, Docker Compose는 Docker에게 도커파일(컴포즈 파일과 동일한 경로에 위치)로부터 이미지를 빌드하도록 지시하고, 그 후에 자동으로 컨테이너를 시작했습니다.</p>
<p>참고: 일반적으로 docker build와 함께 사용하는 일부 옵션들(빌드 인자 전달, Dockerfile의 경로 및 이름 지정 등)도 여기에서 사용할 수 있습니다. 자세한 내용은 문서를 확인해주세요.</p>
<h2>이미지</h2>
<p>어플리케이션을 실행할 때마다 Docker 이미지를 빌드할 필요는 없겠죠... 그렇게 하면 불편하겠죠. 따라서 이미지를 미리 빌드하거나 간단히 컨테이너 이미지를 지정하면 됩니다.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>예를 들어, 이전 예제의 Dockerfile과 다음의 compose 파일을 살펴보세요:</p>
<pre><code class="hljs language-js">$ # 이전 예제 정리하기 위함
$ # 이제부터 각 예제에서 다음 명령 실행해주세요
$ docker-compose down -v --remove-orphans
$
$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">build</span>: .
  <span class="hljs-attr">second</span>:
    <span class="hljs-attr">image</span>: hello-world
<span class="hljs-variable constant_">EOF</span>
$ # <span class="hljs-title class_">Dockerfile</span>이 변경되지 않았기 때문에 첫 번째 이미지가 다시 빌드되지 않습니다
$ docker-compose up
네트워크 <span class="hljs-string">"mediumcom_default"</span> 생성 중
mediumcom_first_1  ... 생성됨
mediumcom_second_1 ... 생성됨
mediumcom_second_1, mediumcom_first_1에 연결 중
first_1   | <span class="hljs-title class_">Hello</span> <span class="hljs-title class_">Medium</span> readers
second_1  |
second_1  | <span class="hljs-title class_">Hello</span> <span class="hljs-keyword">from</span> <span class="hljs-title class_">Docker</span>!
second_1  | <span class="hljs-title class_">This</span> message shows that your installation appears to be working correctly.
second_1  |
second_1  | <span class="hljs-title class_">To</span> generate <span class="hljs-variable language_">this</span> message, <span class="hljs-title class_">Docker</span> took the following <span class="hljs-attr">steps</span>:
second_1  |  <span class="hljs-number">1.</span> <span class="hljs-title class_">The</span> <span class="hljs-title class_">Docker</span> client contacted the <span class="hljs-title class_">Docker</span> daemon.
second_1  |  <span class="hljs-number">2.</span> <span class="hljs-title class_">The</span> <span class="hljs-title class_">Docker</span> daemon pulled the <span class="hljs-string">"hello-world"</span> image <span class="hljs-keyword">from</span> the <span class="hljs-title class_">Docker</span> <span class="hljs-title class_">Hub</span>.
second_1  |     (amd64)
second_1  |  <span class="hljs-number">3.</span> <span class="hljs-title class_">The</span> <span class="hljs-title class_">Docker</span> daemon created a <span class="hljs-keyword">new</span> container <span class="hljs-keyword">from</span> that image which runs the
second_1  |     executable that produces the output you are currently reading.
second_1  |  <span class="hljs-number">4.</span> <span class="hljs-title class_">The</span> <span class="hljs-title class_">Docker</span> daemon streamed that output to the <span class="hljs-title class_">Docker</span> client, which sent it
second_1  |     to your terminal.
second_1  |
second_1  | <span class="hljs-title class_">To</span> <span class="hljs-keyword">try</span> something more ambitious, you can run an <span class="hljs-title class_">Ubuntu</span> container <span class="hljs-attr">with</span>:
second_1  |  $ docker run -it ubuntu bash
second_1  |
second_1  | <span class="hljs-title class_">Share</span> images, automate workflows, and more <span class="hljs-keyword">with</span> a free <span class="hljs-title class_">Docker</span> <span class="hljs-attr">ID</span>:
second_1  |  <span class="hljs-attr">https</span>:<span class="hljs-comment">//hub.docker.com/</span>
second_1  |
second_1  | <span class="hljs-title class_">For</span> more examples and ideas, <span class="hljs-attr">visit</span>:
second_1  |  <span class="hljs-attr">https</span>:<span class="hljs-comment">//docs.docker.com/get-started/</span>
second_1  |
mediumcom_second_1이 코드 <span class="hljs-number">0</span>으로 종료됨
mediumcom_first_1이 코드 <span class="hljs-number">0</span>으로 종료됨
</code></pre>
<p>여기서 보듯이, 이제 하나의 Compose 파일과 하나의 docker-compose 명령을 사용하여 동일한 다중 컨테이너 애플리케이션 내에서 병렬로 2개의 컨테이너를 실행했습니다. 하나의 컨테이너는 "Hello Medium readers"라고 말하는 사용자 지정 Docker 이미지를 사용했고, 다른 하나는 Docker Hub에서 "hello-world" 이미지를 가져와 자체 Hello World 메시지를 출력했습니다.</p>
<h2>명령</h2>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>이를 통해 컨테이너의 명령을 정의할 수 있습니다. 따라서 Docker 이미지에 entrypoint가 정의되어 있으면 이 명령이 해당 entrypoint의 인수가 됩니다. 예시:</p>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: ubuntu
    <span class="hljs-attr">command</span>: echo <span class="hljs-string">"I am at your command!"</span>
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up
<span class="hljs-title class_">Creating</span> network <span class="hljs-string">"mediumcom_default"</span> <span class="hljs-keyword">with</span> the <span class="hljs-keyword">default</span> driver
<span class="hljs-title class_">Creating</span> mediumcom_first_1 ... done
<span class="hljs-title class_">Attaching</span> to mediumcom_first_1
first_1  | I am at your command!
mediumcom_first_1 exited <span class="hljs-keyword">with</span> code <span class="hljs-number">0</span>
</code></pre>
<p>아주 간단하지요?</p>
<h2>entrypoint</h2>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>이름에서 알 수 있듯이 해당 기능은 컨테이너의 엔트리포인트를 재정의하게 해줍니다. 예를 들어, 컨테이너가 echo 실행 파일로 실행되도록 하려면 다음과 같이 작성할 수 있어요:</p>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: ubuntu
    <span class="hljs-attr">entrypoint</span>: [<span class="hljs-string">"echo"</span>]
    <span class="hljs-attr">command</span>: <span class="hljs-string">"I am just an arg"</span>
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up
<span class="hljs-title class_">Creating</span> network <span class="hljs-string">"mediumcom_default"</span> <span class="hljs-keyword">with</span> the <span class="hljs-keyword">default</span> driver
<span class="hljs-title class_">Creating</span> mediumcom_first_1 ... done
<span class="hljs-title class_">Attaching</span> to mediumcom_first_1
first_1  | I am just an arg
mediumcom_first_1 exited <span class="hljs-keyword">with</span> code <span class="hljs-number">0</span>
</code></pre>
<p>간단하지요? 그리고 command 대 entrypoint 등에 대해 궁금해 한다면 당신만이 아닙니다. 이것은 매우 일반적인 혼란 포인트입니다. 다른 기사 "전부 다: Dockerfiles"에서 이에 대해 이야기했어요. 간단히 말해서, 저는 이 두 옵션을 조율할 때 필요한 치트 시트를 제공합니다: <a href="https://docs.docker.com/engine/reference/builder/#understand-how-cmd-and-entrypoint-interact" rel="nofollow" target="_blank">https://docs.docker.com/engine/reference/builder/#understand-how-cmd-and-entrypoint-interact</a></p>
<h2>cap_add</h2>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>만약 컨테이너에 추가 기능이 필요한 경우, 다음과 같이 추가할 수 있어요:</p>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: <span class="hljs-attr">ubuntu</span>:<span class="hljs-number">14.04</span>
    <span class="hljs-attr">command</span>: ip link add dummy0 type dummy
    <span class="hljs-attr">cap_add</span>:
     - <span class="hljs-variable constant_">NET_ADMIN</span>
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up
<span class="hljs-title class_">Recreating</span> mediumcom_first_1 ... done
<span class="hljs-title class_">Attaching</span> to mediumcom_first_1
mediumcom_first_1 exited <span class="hljs-keyword">with</span> code <span class="hljs-number">0</span>
</code></pre>
<p>이제 위와 같은 컨테이너를 실행하려고 하지만 기능이 없는 경우, 에러가 발생할 거예요:</p>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: <span class="hljs-attr">ubuntu</span>:<span class="hljs-number">14.04</span>
    <span class="hljs-attr">command</span>: ip link add dummy0 type dummy
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up
<span class="hljs-title class_">Recreating</span> mediumcom_first_1 ... done
<span class="hljs-title class_">Attaching</span> to mediumcom_first_1
first_1  | <span class="hljs-variable constant_">RTNETLINK</span> <span class="hljs-attr">answers</span>: <span class="hljs-title class_">Operation</span> not permitted
mediumcom_first_1 exited <span class="hljs-keyword">with</span> code <span class="hljs-number">2</span>
</code></pre>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2>cap_drop</h2>
<p>cap_add의 정 반대입니다. 컨테이너에서 기능을 제거하는 데 사용됩니다. 예를 들어 슈퍼 권한이 부여된 컨테이너가 있다고 가정해보겠습니다:</p>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: <span class="hljs-attr">ubuntu</span>:<span class="hljs-number">14.04</span>
    <span class="hljs-attr">command</span>: ip link add dummy0 type dummy
    <span class="hljs-attr">cap_add</span>:
     - <span class="hljs-variable constant_">ALL</span>
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up
<span class="hljs-title class_">Recreating</span> mediumcom_first_1 ... done
<span class="hljs-title class_">Attaching</span> to mediumcom_first_1
mediumcom_first_1 exited <span class="hljs-keyword">with</span> code <span class="hljs-number">0</span>
</code></pre>
<p>그러나 호스트 네트워크 스택을 관리하려고 하지 않는다면:</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-sh">$ <span class="hljs-built_in">cat</span> >docker-compose.yml &#x3C;&#x3C;<span class="hljs-string">EOF
version: "3"
services:
  first:
    image: ubuntu:14.04
    command: ip link add dummy0 type dummy
    cap_add:
     - ALL
    cap_drop:
     - NET_ADMIN
EOF</span>
$ docker-compose up
mediumcom_first_1 컨테이너를 다시 생성하는 중... 완료
mediumcom_first_1에 연결 중
first_1 | RTNETLINK 답변: 작업을 수행할 수 없습니다
mediumcom_first_1은 코드 2로 종료됨
</code></pre>
<h2>cgroup_parent</h2>
<p>cgroup에 대해 처음이라면 이곳에 관한 짧은 좋은 기사가 있습니다. 간단히 말해, Linux 커널은 제어 그룹 (cgroups)을 통해 프로세스별로 시스템 리소스의 사용량을 엄격하게 제어할 수 있는 기능을 제공합니다. Docker에서는 이를 통해 컨테이너가 특정 리소스를 얼마나 사용할 수 있는지 제어할 수 있습니다. 기본적으로 컨테이너는 가능한 많은 리소스를 사용하려고 시도할 것입니다:</p>
<pre><code class="hljs language-sh">$ <span class="hljs-built_in">cat</span> >docker-compose.yml &#x3C;&#x3C;<span class="hljs-string">EOF
version: "3"
services:
  first:
    image: ubuntu
    command: sleep 30
EOF</span>
$ docker-compose up -d
기본 드라이버로 네트워크 <span class="hljs-string">"root_default"</span>를 생성 중
root_first_1 컨테이너 생성 중... 완료
$ docker inspect root_first_1 --format <span class="hljs-string">'{.HostConfig.CgroupParent}'</span>
$
</code></pre>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>보시는 대로, 기본적으로 컨테이너에 할당된 제어 그룹이 없습니다. 하지만 우리가 할당할 수 있습니다. 심지어 우리 자신의 것을 할당할 수도 있습니다:</p>
<pre><code class="hljs language-js">$ cgcreate -g <span class="hljs-attr">cpu</span>:test-cgroup-medium
$ ls /sys/fs/cgroup/cpu
cgroup-limit           cgroup.<span class="hljs-property">sane_behavior</span>  cpu.<span class="hljs-property">shares</span>    cpuacct.<span class="hljs-property">usage</span>         cpuacct.<span class="hljs-property">usage_percpu_sys</span>   cpuacct.<span class="hljs-property">usage_user</span>  release_agent  test-cgroup-medium
cgroup.<span class="hljs-property">clone_children</span>  cpu.<span class="hljs-property">cfs_period_us</span>     cpu.<span class="hljs-property">stat</span>      cpuacct.<span class="hljs-property">usage_all</span>     cpuacct.<span class="hljs-property">usage_percpu_user</span>  docker              system.<span class="hljs-property">slice</span>   user.<span class="hljs-property">slice</span>
cgroup.<span class="hljs-property">procs</span>           cpu.<span class="hljs-property">cfs_quota_us</span>      cpuacct.<span class="hljs-property">stat</span>  cpuacct.<span class="hljs-property">usage_percpu</span>  cpuacct.<span class="hljs-property">usage_sys</span>          notify_on_release   tasks
</code></pre>
<p>그리고 이 옵션을 사용함으로써 이 컨테이너에서 CPU 사용량을 엄격하게 제어할 수 있게 될 것입니다. cgroup "cpu:test-cgroup-medium"을 통해:</p>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: ubuntu
    <span class="hljs-attr">command</span>: sleep <span class="hljs-number">30</span>
    <span class="hljs-attr">cgroup_parent</span>: <span class="hljs-string">"cpu:test-cgroup-medium"</span>
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up -d
<span class="hljs-title class_">Recreating</span> root_first_1 ... done
$ docker inspect root_first_1 --format <span class="hljs-string">'{.HostConfig.CgroupParent}'</span>
<span class="hljs-attr">cpu</span>:test-cgroup-medium
$
</code></pre>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2>container_name</h2>
<p>이 옵션에 대해 로켓 과학같은 것은 없습니다. 이 옵션은 Docker Compose 배포에서 생성된 컨테이너의 이름을 고정하는 데 사용됩니다.</p>
<p>이전에 언급한 바와 같이, 기본적으로 Docker Compose는 컨테이너에 접미사를 추가하며 이는 Docker Compose 프로젝트의 이름과 일치합니다 (프로젝트 이름을 명시적으로 지정하지 않는 경우 Docker Compose가 현재 경로를 기본값으로 삼습니다).</p>
<p>따라서 Docker Compose의 이 동작을 재정의하고 생성된 컨테이너에 자체적으로 정의한 사용자 정의 이름을 지정하려면 container_name을 사용할 수 있습니다. 예시:</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: ubuntu
    <span class="hljs-attr">container_name</span>: my-own-container-name
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up
기본 드라이버로 <span class="hljs-string">"mediumcom_default"</span> 네트워크 생성 중
my-own-container-name 생성 완료
my-own-container-name에 연결 중
my-own-container-name에서 코드 <span class="hljs-number">0</span>으로 종료됨
</code></pre>
<p>P.S.: 네, 궁금해하실 수도 있지만, 이 Docker Compose 배포 내의 다른 컨테이너들은 컨테이너 이름에 의해 서로에게 도달할 수 있습니다. 예:</p>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: sleep <span class="hljs-number">5</span>
    <span class="hljs-attr">container_name</span>: my-own-container-name
  <span class="hljs-attr">second</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: ping -c <span class="hljs-number">1</span> my-own-container-name
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up
my-own-container-name을 다시 생성 중... 완료
mediumcom_second_1 생성 중... 완료
mediumcom_second_1, my-own-container-name에 연결 중
second_1  | my-own-container-<span class="hljs-title function_">name</span>(<span class="hljs-number">172.18</span><span class="hljs-number">.0</span><span class="hljs-number">.3</span>) 핑 중: <span class="hljs-number">56</span> data bytes
second_1  | <span class="hljs-number">64</span> bytes <span class="hljs-keyword">from</span> <span class="hljs-number">172.18</span><span class="hljs-number">.0</span><span class="hljs-number">.3</span>: seq=<span class="hljs-number">0</span> ttl=<span class="hljs-number">64</span> time=<span class="hljs-number">0.743</span> ms
second_1  |
second_1  | --- my-own-container-name 핑 통계 ---
second_1  | 전송된 패킷: <span class="hljs-number">1</span>, 수신된 패킷: <span class="hljs-number">1</span>, 패킷 손실: <span class="hljs-number">0</span>%
second_1  | 왕복 최소/평균/최대 시간 = <span class="hljs-number">0.743</span>/<span class="hljs-number">0.743</span>/<span class="hljs-number">0.743</span> ms
mediumcom_second_1이 코드 <span class="hljs-number">0</span>으로 종료됨
my-own-container-name이 코드 <span class="hljs-number">0</span>으로 종료됨
</code></pre>
<h2>depends_on</h2>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>먼저 말하자면, 아니요, 이 옵션은 컨테이너 애플리케이션의 시작 순서를 제어할 수 있게 해주지 않아요! 많은 사람들이 하는 실수죠. 하지만 생각해보세요… 당신의 컨테이너는 내부에서 하나 이상의 프로세스를 실행하고 있기 때문에, Docker(컨테이너를 관리하는 주체)가 해당 컨테이너 내부에서 실행 중인 애플리케이션/프로세스의 비즈니스 로직을 완벽히 이해하고 있다고 가정하는 것은 순진한 판단일 거예요.</p>
<p>이것은 미묘한 차이가 있지만, 이 옵션이 하는 일은 대신에 Docker Compose에게 컨테이너를 시작하고 중지할 때의 순서를 명시하는 것뿐이에요.</p>
<p>예시:</p>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">depends_on</span>:
     - second
  <span class="hljs-attr">second</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">depends_on</span>:
     - first
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up
<span class="hljs-title class_">Creating</span> network <span class="hljs-string">"mediumcom_default"</span> <span class="hljs-keyword">with</span> the <span class="hljs-keyword">default</span> driver
<span class="hljs-title class_">Creating</span> mediumcom_second_1 ... done
<span class="hljs-title class_">Creating</span> mediumcom_first_1  ... done
<span class="hljs-title class_">Attaching</span> to mediumcom_second_1, mediumcom_first_1
mediumcom_second_1 exited <span class="hljs-keyword">with</span> code <span class="hljs-number">0</span>
mediumcom_first_1 exited <span class="hljs-keyword">with</span> code <span class="hljs-number">0</span>
</code></pre>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>봐요! 두 번째에 의존하는 첫 번째 컨테이너가 먼저 시작되므로, 두 번째 컨테이너가 먼저 시작됩니다. 그리고 멈출 때도 마찬가지 — 먼저 의존하는 첫 번째가 있기 때문에 두 번째가 마지막으로 내려갑니다!</p>
<pre><code class="hljs language-js">$ docker-compose down
mediumcom_first_1  ... 삭제됨
mediumcom_second_1 ... 삭제됨
mediumcom_default 네트워크 제거됨
</code></pre>
<p>추신: 만약 혼돈을 즐긴다면, 두 번째도 첫 번째에 의존하도록 만들었다면 어떻게 될까요? 😝 걱정 마세요, Docker는 똑똑해서 다음과 같은 메시지를 보여줄 거예요:</p>
<h2>볼륨</h2>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>도커 볼륨에 대해 자세히 설명하지 않을 거예요. 이 주제는 꽤 크거든요. 단지 컨테이너 애플리케이션에서 데이터를 관리할 수 있는 4가지 방법이 있다는 것만 말씀드릴게요:</p>
<ul>
<li>컨테이너의 쓰기 가능한 레이어 내에 모든 데이터를 유지합니다 (볼륨 없음)</li>
<li>호스트와 컨테이너 사이에 마운트 지점을 만듭니다 (바인드 마운트)</li>
<li>컨테이너의 수명주기와 독립적으로 데이터를 호스팅하고 관리하는 전용 도커 리소스를 생성합니다 (볼륨)</li>
<li>성능을 최적화하기 위해 데이터를 영구 저장하지 않고 메모리에 유지합니다 (tmpfs).</li>
</ul>
<p>이렇게 말씀드린 바와 같이 Compose 파일에서 이러한 타입의 볼륨을 모두 관리할 수 있어요. 지금까지 모든 예제는 컨테이너의 쓰기 가능한 레이어를 사용했지만, 나머지 3가지 데이터 관리 옵션을 다음과 같이 사용할 수 있어요:</p>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: ls /
    <span class="hljs-attr">volumes</span>:
     - <span class="hljs-regexp">/:/my</span>-hostfs
     - my-<span class="hljs-attr">volume</span>:/my-volume
     - <span class="hljs-attr">type</span>: tmpfs
       <span class="hljs-attr">target</span>: /my-tmpfs
<span class="hljs-attr">volumes</span>:
  my-<span class="hljs-attr">volume</span>:
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up
<span class="hljs-title class_">Creating</span> network <span class="hljs-string">"test_default"</span> <span class="hljs-keyword">with</span> the <span class="hljs-keyword">default</span> driver
<span class="hljs-title class_">Creating</span> volume <span class="hljs-string">"test_my-volume"</span> <span class="hljs-keyword">with</span> <span class="hljs-keyword">default</span> driver
<span class="hljs-title class_">Creating</span> test_first_1 ... done
<span class="hljs-title class_">Attaching</span> to test_first_1
first_1  | bin
first_1  | dev
first_1  | etc
first_1  | home
first_1  | lib
first_1  | media
first_1  | mnt
first_1  | my-hostfs
first_1  | my-tmpfs
first_1  | my-volume
first_1  | opt
first_1  | proc
first_1  | root
first_1  | run
first_1  | sbin
first_1  | srv
first_1  | sys
first_1  | tmp
first_1  | usr
first_1  | <span class="hljs-keyword">var</span>
test_first_1 exited <span class="hljs-keyword">with</span> code <span class="hljs-number">0</span>
</code></pre>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>여기에 세 가지 다른 유형의 마운트가 한꺼번에 나왔어요. 그런데 알아두셨나요? 제가 3가지 다른 구문을 사용했어요... 선호하는 것이나 마운트에 가장 적합한 것을 선택할 수 있어요 (여기에서 더 자세히 읽을 수 있어요).</p>
<p>추가로, tmpfs도 전용 옵션을 통해 설정할 수 있어요... 예제를 보려면 다음 섹션을 읽어보세요.</p>
<h2>tmpfs</h2>
<p>이미 이전 섹션에서 설명했지만, 알아두시면 좋아요. 이는 컨테이너를 위한 비영구적 마운트 포인트를 설정하는 또 다른 간단한 방법일 뿐이에요:</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-sh">$ <span class="hljs-built_in">cat</span> >docker-compose.yml &#x3C;&#x3C;<span class="hljs-string">EOF
version: "3"
services:
  first:
    image: alpine
    command: ls /
    tmpfs: /my-tmpfs
EOF</span>
$ docker-compose up
mediumcom_first_1 컨테이너 다시 생성 중... 완료
mediumcom_first_1에 첨부 중
first_1  | bin
first_1  | dev
first_1  | etc
first_1  | home
first_1  | lib
first_1  | media
first_1  | mnt
first_1  | my-tmpfs
first_1  | opt
first_1  | proc
first_1  | root
first_1  | run
first_1  | sbin
first_1  | srv
first_1  | sys
first_1  | tmp
first_1  | usr
first_1  | var
mediumcom_first_1가 코드 0으로 종료됨
</code></pre>
<h2>디바이스</h2>
<p>그 이름에서 알 수 있듯이, 이 옵션은 컨테이너가 시스템 디바이스를 관리하기 위한 액세스 권한을 부여합니다. 이 것이 일반적인 바인드-마운트와 어떻게 다른지 궁금할 것입니다. 단순히 디바이스를 컨테이너에 바인드-마운트할 수 있지 않을까요? 음, 그렇고 그렇지 않습니다... 컨테이너가 해당 디바이스를 어떻게 사용하는지에 따라 다릅니다. 디바이스 파일은 일반 파일 및 디렉토리와 약간 다르며 (/dev 폴더 아래에서 일반 파일처럼 보이지만), 디바이스 파일은 디바이스 드라이버 및 물리 디바이스로의 인터페이스를 제공하므로 더 세분화된 액세스 제어가 있습니다. 이는 cgroups를 통해 관리되며(여기에서 더 읽을 수 있습니다).</p>
<p>요약하면, 컨테이너가 특권 모드에서 실행되지 않는 경우에도 이 옵션을 통해 특정 디바이스 파일에 대한 컨테이너 액세스를 부여할 수 있습니다.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>우리 컴퓨터에 웹캠이 연결되어 있다고 가정해 봅시다.</p>
<pre><code class="hljs language-bash">$ lsusb -s 001:003
Bus 001 Device 003: ID 046d:0826 Logitech, Inc. HD Webcam C525
</code></pre>
<p>그리고 컨테이너 내부에서 웹캠을 사용하여 사진을 찍고 싶어합니다. 다음 시나리오를 고려해보세요:</p>
<ul>
<li>먼저, 옵션을 적용하지 않고 컨테이너 내부에서 웹캠에 액세스해보겠습니다.</li>
</ul>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: ccordeiro/<span class="hljs-attr">fswebcam</span>:armv7l
    <span class="hljs-attr">command</span>: fswebcam -r 640x480 --jpeg <span class="hljs-number">85</span> -D <span class="hljs-number">1</span> picture.<span class="hljs-property">jpg</span>
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up
네트워크 <span class="hljs-string">"tmp_default"</span>를 기본 드라이버로 생성중
tmp_first_1 를 생성중... 완료
tmp_first_1 에 연결중
first_1  | --- <span class="hljs-regexp">/dev/</span>video0 열기 중...
first_1  | <span class="hljs-attr">stat</span>: 해당 파일 또는 디렉터리가 없습니다
first_1  | tmp_first_1이 코드 <span class="hljs-number">0</span>으로 종료되었습니다
</code></pre>
<p>…그러나 분명히 컨테이너에는 어떤 장치도 보이지 않습니다…</p>
<ul>
<li>두 번째로, 장치 파일을 바인드 마운트해 봅시다</li>
</ul>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: ccordeiro/<span class="hljs-attr">fswebcam</span>:armv7l
    <span class="hljs-attr">command</span>: fswebcam -r 640x480 --jpeg <span class="hljs-number">85</span> -D <span class="hljs-number">1</span> picture.<span class="hljs-property">jpg</span>
    <span class="hljs-attr">volumes</span>:
     - <span class="hljs-regexp">/dev/</span><span class="hljs-attr">video0</span>:<span class="hljs-regexp">/dev/</span>video0
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up
tmp_first_1 재생성중... 완료
tmp_first_1 에 연결중
first_1  | --- <span class="hljs-regexp">/dev/</span>video0 열기 중...
first_1  | v4l2 모듈 시도 중...
first_1  | 기기 열기 실패: <span class="hljs-regexp">/dev/</span>video0
first_1  | 열기: 작업을 허용하지 않습니다
first_1  | v4l1 모듈 시도중...
first_1  | 기기 열기 실패: <span class="hljs-regexp">/dev/</span>video0
first_1  | 열기: 작업을 허용하지 않습니다
first_1  | <span class="hljs-regexp">/dev/</span>video0을 읽을 수 있는 소스 모듈을 찾을 수 없습니다.
first_1  | tmp_first_1이 코드 <span class="hljs-number">0</span>으로 종료되었습니다
</code></pre>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>…음, 컨테이너는 보이지만 접근할 수 있는 권한이 없네요.</p>
<ul>
<li>마지막으로 장치를 사용해 봅시다</li>
</ul>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: ccordeiro/<span class="hljs-attr">fswebcam</span>:armv7l
    <span class="hljs-attr">command</span>: fswebcam -r 640x480 --jpeg <span class="hljs-number">85</span> -D <span class="hljs-number">1</span> picture.<span class="hljs-property">jpg</span>
    <span class="hljs-attr">devices</span>:
     - <span class="hljs-regexp">/dev/</span><span class="hljs-attr">video0</span>:<span class="hljs-regexp">/dev/</span>video0
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up
<span class="hljs-title class_">Recreating</span> tmp_first_1 ... done
<span class="hljs-title class_">Attaching</span> to tmp_first_1
first_1  | --- <span class="hljs-title class_">Opening</span> /dev/video0...
first_1  | <span class="hljs-title class_">Trying</span> source <span class="hljs-variable language_">module</span> v4l2...
first_1  | <span class="hljs-regexp">/dev/</span>video0 opened.
first_1  | <span class="hljs-title class_">No</span> input was specified, using the first.
first_1  | <span class="hljs-title class_">Delaying</span> <span class="hljs-number">1</span> seconds.
first_1  | --- <span class="hljs-title class_">Capturing</span> frame...
first_1  | <span class="hljs-title class_">Captured</span> frame <span class="hljs-keyword">in</span> <span class="hljs-number">0.00</span> seconds.
first_1  | --- <span class="hljs-title class_">Processing</span> captured image...
first_1  | <span class="hljs-title class_">Setting</span> output format to <span class="hljs-variable constant_">JPEG</span>, quality <span class="hljs-number">85</span>
first_1  | <span class="hljs-title class_">Writing</span> <span class="hljs-variable constant_">JPEG</span> image to <span class="hljs-string">'picture.jpg'</span>.
first_1  | tmp_first_1 exited <span class="hljs-keyword">with</span> code <span class="hljs-number">0</span>
</code></pre>
<p>그리고 성공입니다!</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2>network_mode</h2>
<p>Docker의 네트워킹 시스템은 네트워킹 드라이버에 기반하고 있는 것을 알고 계실 것입니다. 이 옵션을 사용하여 컨테이너가 실행되어야 하는 네트워크 모드를 지정할 수 있습니다.</p>
<p>예를 들어, 기본 브릿지 네트워크에 1개의 컨테이너를, 호스트 네트워크에 1개의 컨테이너를, 첫 번째 컨테이너와 동일한 네트워크에 1개의 컨테이너를, 그리고 어떤 네트워크도 없는 상태로 1개의 컨테이너를 배포하려고 합니다. 아래는 이를 수행하는 방법입니다:</p>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: sh -c <span class="hljs-string">'ifconfig eth0 &#x26;&#x26; sleep 5'</span>
    <span class="hljs-attr">network_mode</span>: bridge
  <span class="hljs-attr">second</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: ifconfig eth0
    <span class="hljs-attr">network_mode</span>: host
  <span class="hljs-attr">third</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: ifconfig eth0
    <span class="hljs-attr">depends_on</span>:
     - first
    <span class="hljs-attr">network_mode</span>: <span class="hljs-attr">service</span>:first
  <span class="hljs-attr">fourth</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: ifconfig eth0
    <span class="hljs-attr">network_mode</span>: none
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up
<span class="hljs-title class_">Creating</span> mediumcom_first_1  ... done
<span class="hljs-title class_">Creating</span> mediumcom_fourth_1 ... done
<span class="hljs-title class_">Creating</span> mediumcom_second_1 ... done
<span class="hljs-title class_">Creating</span> mediumcom_third_1  ... done
<span class="hljs-title class_">Attaching</span> to mediumcom_second_1, mediumcom_fourth_1, mediumcom_first_1, mediumcom_third_1
first_1   | eth0      <span class="hljs-title class_">Link</span> <span class="hljs-attr">encap</span>:<span class="hljs-title class_">Ethernet</span>  <span class="hljs-title class_">HWaddr</span> <span class="hljs-number">02</span>:<span class="hljs-number">42</span>:<span class="hljs-attr">AC</span>:<span class="hljs-number">11</span>:<span class="hljs-number">00</span>:<span class="hljs-number">02</span>
first_1   |           inet <span class="hljs-attr">addr</span>:<span class="hljs-number">172.17</span><span class="hljs-number">.0</span><span class="hljs-number">.2</span>  <span class="hljs-title class_">Bcast</span>:<span class="hljs-number">172.17</span><span class="hljs-number">.255</span><span class="hljs-number">.255</span>  <span class="hljs-title class_">Mask</span>:<span class="hljs-number">255.255</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>
...
fourth_1  | <span class="hljs-attr">ifconfig</span>: <span class="hljs-attr">eth0</span>: error fetching interface <span class="hljs-attr">information</span>: <span class="hljs-title class_">Device</span> not found
...
second_1  | eth0      <span class="hljs-title class_">Link</span> <span class="hljs-attr">encap</span>:<span class="hljs-title class_">Ethernet</span>  <span class="hljs-title class_">HWaddr</span> <span class="hljs-number">02</span>:<span class="hljs-number">50</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">01</span>
second_1  |           inet <span class="hljs-attr">addr</span>:<span class="hljs-number">192.168</span><span class="hljs-number">.65</span><span class="hljs-number">.3</span>  <span class="hljs-title class_">Bcast</span>:<span class="hljs-number">192.168</span><span class="hljs-number">.65</span><span class="hljs-number">.255</span>  <span class="hljs-title class_">Mask</span>:<span class="hljs-number">255.255</span><span class="hljs-number">.255</span><span class="hljs-number">.0</span>
...
third_1   | eth0      <span class="hljs-title class_">Link</span> <span class="hljs-attr">encap</span>:<span class="hljs-title class_">Ethernet</span>  <span class="hljs-title class_">HWaddr</span> <span class="hljs-number">02</span>:<span class="hljs-number">42</span>:<span class="hljs-attr">AC</span>:<span class="hljs-number">11</span>:<span class="hljs-number">00</span>:<span class="hljs-number">02</span>
third_1   |           inet <span class="hljs-attr">addr</span>:<span class="hljs-number">172.17</span><span class="hljs-number">.0</span><span class="hljs-number">.2</span>  <span class="hljs-title class_">Bcast</span>:<span class="hljs-number">172.17</span><span class="hljs-number">.255</span><span class="hljs-number">.255</span>  <span class="hljs-title class_">Mask</span>:<span class="hljs-number">255.255</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>
...
mediumcom_fourth_1 exited <span class="hljs-keyword">with</span> code <span class="hljs-number">1</span>
mediumcom_second_1 exited <span class="hljs-keyword">with</span> code <span class="hljs-number">0</span>
mediumcom_third_1 exited <span class="hljs-keyword">with</span> code <span class="hljs-number">0</span>
mediumcom_first_1 exited <span class="hljs-keyword">with</span> code <span class="hljs-number">0</span>
</code></pre>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>그래서, 무슨 일이 있었나요? 이를 간단히 살펴보겠습니다:</p>
<ul>
<li>첫 번째 컨테이너는 브리지 모드로 들어가서 자체 eth0 개인 네트워크 인터페이스를 할당 받았습니다(IP 172.17.0.2로, Docker 브리지 서브넷의 일부입니다).</li>
<li>두 번째 컨테이너는 호스트 모드로 들어가서 호스트와 동일한 네트워크 수준에서 실행되므로 호스트의 모든 네트워킹 인터페이스를 볼 수 있습니다.</li>
<li>세 번째 컨테이너는 첫 번째 것과 동일한 네트워크를 받았습니다.</li>
<li>네 번째 컨테이너는 네트워크가 없어 eth0 인터페이스를 찾지 못하여 실패했습니다.</li>
</ul>
<h2>네트워크</h2>
<p>이제 위에서 언급한 옵션을 활용하여, 컨테이너를 사용자 정의 네트워크에 연결하려면 어떻게 해야 하나요(기존 네트워크 또는 새로 생성한 것 중)? 그럴 때는 networks를 사용하세요:</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-js">$ docker network create cjdc-test
0f5e35bf6b8d396c45c19545540957fbc5fa15ba1ca0e5fbca4add3802c7db6d
$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: sleep <span class="hljs-number">30</span>
    <span class="hljs-attr">networks</span>:
     - <span class="hljs-keyword">new</span>-net
  <span class="hljs-attr">second</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: sleep <span class="hljs-number">30</span>
    <span class="hljs-attr">networks</span>:
     - cjdc-test
<span class="hljs-attr">networks</span>:
  <span class="hljs-keyword">new</span>-<span class="hljs-attr">net</span>:
  cjdc-<span class="hljs-attr">test</span>:
    <span class="hljs-attr">external</span>: <span class="hljs-literal">true</span>
    <span class="hljs-attr">name</span>: cjdc-test
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up -d
<span class="hljs-title class_">Creating</span> network <span class="hljs-string">"mediumcom_new-net"</span> <span class="hljs-keyword">with</span> the <span class="hljs-keyword">default</span> driver
<span class="hljs-title class_">Creating</span> mediumcom_second_1 ... done
<span class="hljs-title class_">Creating</span> mediumcom_first_1  ... done
$ docker inspect --format <span class="hljs-string">'{.NetworkSettings.Networks}'</span> mediumcom_first_1
map[mediumcom_new-<span class="hljs-attr">net</span>:<span class="hljs-number">0xc0004d8f00</span>]
$ docker inspect --format <span class="hljs-string">'{.NetworkSettings.Networks}'</span> mediumcom_second_1
map[cjdc-<span class="hljs-attr">test</span>:<span class="hljs-number">0xc0003e8f00</span>]
</code></pre>
<h2>dns</h2>
<p>It basically lets you define a custom DNS server for your container. Example:</p>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: cat /etc/resolv.<span class="hljs-property">conf</span>
    <span class="hljs-attr">dns</span>: <span class="hljs-number">1.2</span><span class="hljs-number">.3</span><span class="hljs-number">.4</span>
    <span class="hljs-attr">network_mode</span>: bridge
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up
<span class="hljs-title class_">Recreating</span> mediumcom_first_1 ... done
<span class="hljs-title class_">Attaching</span> to mediumcom_first_1
first_1  | nameserver <span class="hljs-number">1.2</span><span class="hljs-number">.3</span><span class="hljs-number">.4</span>
mediumcom_first_1 exited <span class="hljs-keyword">with</span> code <span class="hljs-number">0</span>
</code></pre>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>주의: 사용자 정의 네트워크에서는 DNS 옵션이 기본적으로 동작하지 않으므로 브릿지 네트워크가 필요합니다.</p>
<h2>dns_search</h2>
<p>여기에서 사용자 맞춤 DNS 검색 도메인을 설정할 수 있습니다.</p>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: cat /etc/resolv.<span class="hljs-property">conf</span>
    <span class="hljs-attr">dns_search</span>: my.<span class="hljs-property">custom</span>.<span class="hljs-property">dns</span>
    <span class="hljs-attr">network_mode</span>: bridge
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up
<span class="hljs-title class_">Recreating</span> mediumcom_first_1 ... done
<span class="hljs-title class_">Attaching</span> to mediumcom_first_1
first_1  | search my.<span class="hljs-property">custom</span>.<span class="hljs-property">dns</span>
first_1  | nameserver <span class="hljs-number">192.168</span><span class="hljs-number">.65</span><span class="hljs-number">.5</span>
mediumcom_first_1 exited <span class="hljs-keyword">with</span> code <span class="hljs-number">0</span>
</code></pre>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2>env_file</h2>
<p>일반적으로 컨테이너 환경을 하나씩 설정하는 데 익숙할 수 있지만, 한 번에 이 작업을 수행하도록 대신 파일을 사용할 수 있습니다:</p>
<pre><code class="hljs language-js">$ cat >my-env &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-title class_">VAR1</span>=value
<span class="hljs-variable constant_">MY_VAR_FROM_FILE</span>=<span class="hljs-number">1</span>
<span class="hljs-variable constant_">FOO</span>=<span class="hljs-variable constant_">BAR</span>
<span class="hljs-variable constant_">EOF</span>
$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: env
    <span class="hljs-attr">env_file</span>:
     - my-env
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up
mediumcom_first_1 다시 만들기 ... 완료
mediumcom_first_1에 연결
first_1  | <span class="hljs-variable constant_">PATH</span>=<span class="hljs-regexp">/usr/</span>local/<span class="hljs-attr">sbin</span>:<span class="hljs-regexp">/usr/</span>local/<span class="hljs-attr">bin</span>:<span class="hljs-regexp">/usr/</span><span class="hljs-attr">sbin</span>:<span class="hljs-regexp">/usr/</span><span class="hljs-attr">bin</span>:<span class="hljs-regexp">/sbin:/</span>bin
first_1  | <span class="hljs-variable constant_">HOSTNAME</span>=157e34e4fc64
first_1  | <span class="hljs-title class_">VAR1</span>=value
first_1  | <span class="hljs-variable constant_">MY_VAR_FROM_FILE</span>=<span class="hljs-number">1</span>
first_1  | <span class="hljs-variable constant_">FOO</span>=<span class="hljs-variable constant_">BAR</span>
first_1  | <span class="hljs-variable constant_">HOME</span>=/root
mediumcom_first_1 코드 <span class="hljs-number">0</span>으로 종료
</code></pre>
<h2>environment</h2>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>이를 통해 컴포즈 파일에서 컨테이너의 환경 변수를 하나씩 직접 설정할 수 있습니다.</p>
<p>이 방법을 사용하여 env_file 옵션을 통해 로드되는 변수를 재정의할 수도 있습니다.</p>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: env
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up
<span class="hljs-title class_">Recreating</span> mediumcom_first_1 ... done
<span class="hljs-title class_">Attaching</span> to mediumcom_first_1
first_1  | <span class="hljs-variable constant_">PATH</span>=<span class="hljs-regexp">/usr/</span>local/<span class="hljs-attr">sbin</span>:<span class="hljs-regexp">/usr/</span>local/<span class="hljs-attr">bin</span>:<span class="hljs-regexp">/usr/</span><span class="hljs-attr">sbin</span>:<span class="hljs-regexp">/usr/</span><span class="hljs-attr">bin</span>:<span class="hljs-regexp">/sbin:/</span>bin
first_1  | <span class="hljs-variable constant_">HOSTNAME</span>=<span class="hljs-number">68e909013198</span>
first_1  | <span class="hljs-variable constant_">NEW_VAR</span>=yes
first_1  | <span class="hljs-variable constant_">HOME</span>=/root
mediumcom_first_1 exited <span class="hljs-keyword">with</span> code <span class="hljs-number">0</span>
</code></pre>
<h2>노출</h2>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>도커파일과 유사하게, 이 옵션은 컨테이너의 포트를 표시하고 다른 연결된 컨테이너에서 사용할 수 있도록 합니다.</p>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: sleep <span class="hljs-number">20</span>
    <span class="hljs-attr">expose</span>:
     - <span class="hljs-number">9876</span>
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up -d
<span class="hljs-title class_">Recreating</span> mediumcom_first_1 ... done
$ docker ps
<span class="hljs-variable constant_">CONTAINER</span> <span class="hljs-variable constant_">ID</span>   <span class="hljs-variable constant_">IMAGE</span>     <span class="hljs-variable constant_">COMMAND</span>      <span class="hljs-variable constant_">CREATED</span>          <span class="hljs-variable constant_">STATUS</span>          <span class="hljs-variable constant_">PORTS</span>      <span class="hljs-variable constant_">NAMES</span>
3be377f4bf6c   alpine    <span class="hljs-string">"sleep 20"</span>   <span class="hljs-number">18</span> seconds ago   <span class="hljs-title class_">Up</span> <span class="hljs-number">16</span> seconds   <span class="hljs-number">9876</span>/tcp   mediumcom_first_1
</code></pre>
<h2>external_links</h2>
<p>옵션을 건너뛰어야 합니다. 왜냐하면 1) 이것은 레거시 옵션이기 때문에, 그리고 2) 동일한 결과를 얻기 위해 네트워크를 사용할 수 있습니다(즉, 컨테이너를 외부 네트워크에 포함되어 있지 않은 다른 컨테이너에 연결할 수 있습니다).</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2>extra_hosts</h2>
<p>이 기능은 컨테이너의 /etc/hosts 파일에 새 항목을 추가할 수 있게 해줍니다. 예를 들어, 컨테이너가 "localhost"가 아닌 다른 이름으로 스스로를 호출하도록 하고 싶다면 다음과 같이 할 수 있습니다:</p>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: sh -c <span class="hljs-string">'cat /etc/hosts; ping me -c 1'</span>
    <span class="hljs-attr">extra_hosts</span>:
     - <span class="hljs-string">"myself:127.0.0.1"</span>
     - <span class="hljs-string">"me:127.0.0.1"</span>
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up
<span class="hljs-title class_">Recreating</span> mediumcom_first_1 ... done
<span class="hljs-title class_">Attaching</span> to mediumcom_first_1
first_1  | <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> localhost
first_1  | ::<span class="hljs-number">1</span> localhost ip6-localhost ip6-loopback
first_1  | <span class="hljs-attr">fe00</span>::<span class="hljs-number">0</span> ip6-localnet
first_1  | <span class="hljs-attr">ff00</span>::<span class="hljs-number">0</span> ip6-mcastprefix
first_1  | <span class="hljs-attr">ff02</span>::<span class="hljs-number">1</span> ip6-allnodes
first_1  | <span class="hljs-attr">ff02</span>::<span class="hljs-number">2</span> ip6-allrouters
first_1  | <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> myself
first_1  | <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> me
first_1  | <span class="hljs-number">172.22</span><span class="hljs-number">.0</span><span class="hljs-number">.2</span> 01d566c4380a
first_1  | <span class="hljs-variable constant_">PING</span> me (<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>): <span class="hljs-number">56</span> data bytes
first_1  | <span class="hljs-number">64</span> bytes <span class="hljs-keyword">from</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>: seq=<span class="hljs-number">0</span> ttl=<span class="hljs-number">64</span> time=<span class="hljs-number">1.192</span> ms
first_1  |
first_1  | --- me ping statistics ---
first_1  | <span class="hljs-number">1</span> packets transmitted, <span class="hljs-number">1</span> packets received, <span class="hljs-number">0</span>% packet loss
first_1  | round-trip min/avg/max = <span class="hljs-number">1.192</span>/<span class="hljs-number">1.192</span>/<span class="hljs-number">1.192</span> ms
mediumcom_first_1 exited <span class="hljs-keyword">with</span> code <span class="hljs-number">0</span>
</code></pre>
<h2>healthcheck</h2>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>당연히, 이것은 도커 파일 옵션과 매우 유사하게 작동합니다. 도커가 컨테이너가 "healthy(건강한)"인지 아닌지 평가하는 데 사용할 수 있는 사용자 정의 확인을 만들 수 있습니다.</p>
<p>그러니까, /tmp에 medium.txt라는 파일이 있을 때만 우리 컨테이너가 건강한 것으로 간주됩니다.</p>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: sh -c <span class="hljs-string">'touch /tmp/NOT_MY_FILE; sleep 10'</span>
    <span class="hljs-attr">healthcheck</span>:
      <span class="hljs-attr">test</span>: <span class="hljs-string">"[ -f /tmp/medium.txt ]"</span>
      # run asap
      <span class="hljs-attr">interval</span>: 1s
      <span class="hljs-attr">timeout</span>: 5s
      <span class="hljs-attr">retries</span>: <span class="hljs-number">1</span>
      <span class="hljs-attr">start_period</span>: 0s
  <span class="hljs-attr">second</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: sh -c <span class="hljs-string">'touch /tmp/medium.txt; sleep 10'</span>
    <span class="hljs-attr">healthcheck</span>:
      <span class="hljs-attr">test</span>: <span class="hljs-string">"[ -f /tmp/medium.txt ]"</span>
      # run asap
      <span class="hljs-attr">interval</span>: 1s
      <span class="hljs-attr">timeout</span>: 5s
      <span class="hljs-attr">retries</span>: <span class="hljs-number">1</span>
      <span class="hljs-attr">start_period</span>: 0s
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up -d
<span class="hljs-title class_">Recreating</span> mediumcom_first_1 ... done
<span class="hljs-title class_">Creating</span> mediumcom_second_1  ... done
$ docker ps
<span class="hljs-variable constant_">CONTAINER</span> <span class="hljs-variable constant_">ID</span>   <span class="hljs-variable constant_">IMAGE</span>     <span class="hljs-variable constant_">COMMAND</span>                  <span class="hljs-variable constant_">CREATED</span>         <span class="hljs-variable constant_">STATUS</span>                     <span class="hljs-variable constant_">PORTS</span>     <span class="hljs-variable constant_">NAMES</span>
b8804cbb440d   alpine    <span class="hljs-string">"sh -c 'touch /tmp/N…"</span>   <span class="hljs-number">4</span> seconds ago   <span class="hljs-title class_">Up</span> <span class="hljs-number">2</span> seconds (unhealthy)             mediumcom_first_1
604a6880f3c6   alpine    <span class="hljs-string">"sh -c 'touch /tmp/m…"</span>   <span class="hljs-number">4</span> seconds ago   <span class="hljs-title class_">Up</span> <span class="hljs-number">2</span> seconds (healthy)               mediumcom_second_1
</code></pre>
<p>그런데 여기서 볼 수 있듯이, 처음 것은 건강하지 않지만 두 번째는 건강하다고 나옵니다. 필요한 파일이 올바른 위치에 존재하기 때문입니다.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2>초기화</h2>
<p>이를 통해 Docker에게 컨테이너에 대한 init를 사용할지 여부를 알릴 수 있습니다. 참일 경우, Docker는 tini 기반의 docker-init이라는 init을 사용할 것입니다. 차이를 살펴봅시다:</p>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: ps -a
    <span class="hljs-attr">init</span>: <span class="hljs-literal">false</span>
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up
mediumcom_first_1 다시 생성 중... 완료
mediumcom_first_1에 참여 중
first_1  | <span class="hljs-variable constant_">PID</span>   <span class="hljs-variable constant_">USER</span>     <span class="hljs-variable constant_">TIME</span>  <span class="hljs-variable constant_">COMMAND</span>
first_1  |     <span class="hljs-number">1</span> root      <span class="hljs-number">0</span>:<span class="hljs-number">00</span> ps -a
mediumcom_first_1은 코드 <span class="hljs-number">0</span>으로 종료됨
</code></pre>
<p>그러나 초기화를 활성화하면 이와 같은 프로세스 래퍼를 얻게 되며, 이는 PID 1로 추가 기능이 있는 경우 (이 경우에는 docker-init)입니다:</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>$ cat >docker-compose.yml &#x3C;&#x3C;EOF
version: "3"
services:
first:
image: alpine
command: ps -a
init: true
EOF
$ docker-compose up
Starting mediumcom_first_1 ... done
Attaching to mediumcom_first_1
first_1 | PID USER TIME COMMAND
first_1 | 1 root 0:00 /sbin/docker-init -- ps -a
first_1 | 8 root 0:00 ps -a
mediumcom_first_1 exited with code 0</p>
<h2>격리</h2>
<p>리눅스의 경우, 이 옵션은 항상 기본값으로 설정됩니다. 윈도우의 경우 더 많은 옵션이 있지만, 아쉽게도 여러분을 위한 예제를 실행할 윈도우 머신이 없습니다 😛 윈도우 사용자분들 죄송해요!</p>
<h2>레이블</h2>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>콘테이너에 레이블을 설정할 수 있는 이 옵션의 이름처럼:</p>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: sleep <span class="hljs-number">10</span>
    <span class="hljs-attr">labels</span>:
     - <span class="hljs-string">"foo=bar"</span>
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up -d
<span class="hljs-title class_">Recreating</span> mediumcom_first_1 ... done
$ docker ps --filter <span class="hljs-string">'label=foo=bar'</span>
<span class="hljs-variable constant_">CONTAINER</span> <span class="hljs-variable constant_">ID</span>   <span class="hljs-variable constant_">IMAGE</span>     <span class="hljs-variable constant_">COMMAND</span>      <span class="hljs-variable constant_">CREATED</span>          <span class="hljs-variable constant_">STATUS</span>         <span class="hljs-variable constant_">PORTS</span>     <span class="hljs-variable constant_">NAMES</span>
94e844176d76   alpine    <span class="hljs-string">"sleep 10"</span>   <span class="hljs-number">30</span> seconds ago   <span class="hljs-title class_">Up</span> <span class="hljs-number">7</span> seconds             mediumcom_first_1
</code></pre>
<h2>링크</h2>
<p>외부 링크에 대한 내용은 과거의 옵션을 건너뛰겠습니다. 컨테이너 간 통신은 사용자 정의 네트워크로 쉽게 설정할 수 있습니다.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2>로깅</h2>
<p>실제로 이 옵션이 매우 중요하다고 생각해요. 대부분의 사용자들은 보통 컨테이너 애플리케이션 로그의 크기가 계속해서 커지고 있다는 사실에 충분한 주의를 기울이지 않습니다. 호스트 공간이 시간이 지남에 따라 가득 차지 않기를 원한다면, 다른 애플리케이션과 마찬가지로, 애플리케이션이 로그를 기록하는 방식도 제어해야 합니다. Docker를 통해 이 로깅 옵션을 사용하여 컨테이너 애플리케이션의 stdout 로그를 제어할 수 있습니다. 로깅 종류 뿐만 아니라 로깅 크기 제한 및 로테이션 매개변수도 제어할 수 있습니다:</p>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: sh -c <span class="hljs-string">'while true; do echo `date`; done'</span>
    <span class="hljs-attr">logging</span>:
      <span class="hljs-attr">options</span>:
        max-<span class="hljs-attr">size</span>: <span class="hljs-string">"50k"</span>
        max-<span class="hljs-attr">file</span>: <span class="hljs-string">"10"</span>
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up -d
tmp_first_1을 다시 생성 중... 완료됨
$ docker ps -f <span class="hljs-string">'name=tmp_first_1'</span>
<span class="hljs-variable constant_">CONTAINER</span> <span class="hljs-variable constant_">ID</span>   <span class="hljs-variable constant_">IMAGE</span>     <span class="hljs-variable constant_">COMMAND</span>                  <span class="hljs-variable constant_">CREATED</span>         <span class="hljs-variable constant_">STATUS</span>         <span class="hljs-variable constant_">PORTS</span>     <span class="hljs-variable constant_">NAMES</span>
2ea63dd32607   alpine    <span class="hljs-string">"sh -c 'while true; …"</span>   <span class="hljs-number">2</span> minutes ago   <span class="hljs-title class_">Up</span> <span class="hljs-number">2</span> minutes             tmp_first_1
$
$ du -h /<span class="hljs-keyword">var</span>/lib/docker/containers/2ea63dd32607*<span class="hljs-comment">/*log*
20K /var/lib/docker/containers/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60-json.log
52K /var/lib/docker/containers/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60-json.log.1
52K /var/lib/docker/containers/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60-json.log.2
52K /var/lib/docker/containers/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60-json.log.3
52K /var/lib/docker/containers/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60-json.log.4
52K /var/lib/docker/containers/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60-json.log.5
52K /var/lib/docker/containers/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60-json.log.6
52K /var/lib/docker/containers/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60-json.log.7
52K /var/lib/docker/containers/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60-json.log.8
52K /var/lib/docker/containers/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60-json.log.9
</span></code></pre>
<p>그러니까 이 예제에서 볼 수 있듯이, Docker는 최대 10개의 로그 파일만 유지하고, 그 크기가 우리가 원하는 50 Kibibytes(= 52K)를 초과하지 않는 것을 확인할 수 있어요.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2>PID</h2>
<p>요청 시, 컨테이너가 호스트와 PID 주소 공간을 공유할 수 있도록 설정할 수 있습니다. 이를 가능하게 하는 옵션은 다음과 같습니다:</p>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: ps -a
    <span class="hljs-attr">pid</span>: <span class="hljs-string">"host"</span>
  <span class="hljs-attr">second</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: ps -a
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up
<span class="hljs-title class_">Creating</span> network <span class="hljs-string">"mediumcom_default"</span> <span class="hljs-keyword">with</span> the <span class="hljs-keyword">default</span> driver
<span class="hljs-title class_">Creating</span> mediumcom_second_1 ... done
<span class="hljs-title class_">Creating</span> mediumcom_first_1  ... done
<span class="hljs-title class_">Attaching</span> to mediumcom_second_1, mediumcom_first_1
second_1  | <span class="hljs-variable constant_">PID</span>   <span class="hljs-variable constant_">USER</span>     <span class="hljs-variable constant_">TIME</span>  <span class="hljs-variable constant_">COMMAND</span>
second_1  |     <span class="hljs-number">1</span> root      <span class="hljs-number">0</span>:<span class="hljs-number">00</span> ps -a
first_1   | <span class="hljs-variable constant_">PID</span>   <span class="hljs-variable constant_">USER</span>     <span class="hljs-variable constant_">TIME</span>  <span class="hljs-variable constant_">COMMAND</span>
first_1   |     <span class="hljs-number">1</span> root      <span class="hljs-number">0</span>:<span class="hljs-number">07</span> /sbin/init
first_1   |     <span class="hljs-number">2</span> root      <span class="hljs-number">0</span>:<span class="hljs-number">00</span> [kthreadd]
first_1   |     <span class="hljs-number">3</span> root      <span class="hljs-number">0</span>:<span class="hljs-number">00</span> [rcu_gp]
first_1   |     <span class="hljs-number">4</span> root      <span class="hljs-number">0</span>:<span class="hljs-number">00</span> [rcu_par_gp]
first_1   |     <span class="hljs-number">6</span> root      <span class="hljs-number">0</span>:<span class="hljs-number">00</span> [kworker/<span class="hljs-number">0</span>:0H-ev]
first_1   |     <span class="hljs-number">8</span> root      <span class="hljs-number">0</span>:<span class="hljs-number">00</span> [mm_percpu_wq]
first_1   |     <span class="hljs-number">9</span> root      <span class="hljs-number">0</span>:<span class="hljs-number">00</span> [rcu_tasks_rude_]
first_1   |    <span class="hljs-number">10</span> root      <span class="hljs-number">0</span>:<span class="hljs-number">00</span> [rcu_tasks_trace]
first_1   |    <span class="hljs-number">11</span> root      <span class="hljs-number">0</span>:<span class="hljs-number">22</span> [ksoftirqd/<span class="hljs-number">0</span>]
first_1   |    <span class="hljs-number">12</span> root      <span class="hljs-number">0</span>:<span class="hljs-number">10</span> [rcu_sched]
first_1   |    <span class="hljs-number">13</span> root      <span class="hljs-number">0</span>:<span class="hljs-number">07</span> [migration/<span class="hljs-number">0</span>]
first_1   |    <span class="hljs-number">15</span> root      <span class="hljs-number">0</span>:<span class="hljs-number">00</span> [cpuhp/<span class="hljs-number">0</span>]
first_1   |    <span class="hljs-number">16</span> root      <span class="hljs-number">0</span>:<span class="hljs-number">00</span> [cpuhp/<span class="hljs-number">1</span>]
...
</code></pre>
<p>이것은 컨테이너 내에서 호스트 프로세스를 관리하고(포함하여 종료)할 수 있다는 의미이므로 이 옵션을 사용할 때 주의해야 합니다.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2>포트</h2>
<p>가장 인기 있는 옵션 중 하나인 이 기능을 사용하면 컨테이너 내부의 포트를 호스트로 게시할 수 있습니다 (컨테이너가 이미 "호스트" 모드에서 실행 중이지 않은 경우).</p>
<p>예를 들어, 다음과 같이 게시하려는 경우를 생각해 봅시다:</p>
<ul>
<li>포트 3000을 임의의 포트로</li>
<li>포트 범위 3005부터 3010까지</li>
<li>로컬호스트의 포트 80을 포트 80으로만</li>
<li>모든 호스트 인터페이스의 포트 443을 포트 443으로</li>
<li>호스트의 포트 3011을 UDP만을 사용하여 포트 9876로</li>
</ul>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: sleep <span class="hljs-number">10</span>
    <span class="hljs-attr">ports</span>:
     - <span class="hljs-number">3000</span>
     - <span class="hljs-number">3005</span>-<span class="hljs-number">3010</span>
     - <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">80</span>:<span class="hljs-number">80</span>
     - <span class="hljs-number">443</span>:<span class="hljs-number">443</span>
     - <span class="hljs-number">9876</span>:<span class="hljs-number">3011</span>/udp
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up -d
중복 컨테이너 <span class="hljs-string">"mediumcom_second_1"</span>를 제거하는 중
mediumcom_first_1이 시작되었습니다. ... 완료
$ docker ps --format <span class="hljs-string">'{.Ports}'</span>
<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">80</span>-><span class="hljs-number">80</span>/tcp, <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">443</span>-><span class="hljs-number">443</span>/tcp, <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">61290</span>-><span class="hljs-number">3000</span>/tcp, <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">61292</span>-><span class="hljs-number">3005</span>/tcp, <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">61293</span>-><span class="hljs-number">3006</span>/tcp, <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">61294</span>-><span class="hljs-number">3007</span>/tcp, <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">61295</span>-><span class="hljs-number">3008</span>/tcp, <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">61296</span>-><span class="hljs-number">3009</span>/tcp, <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">61291</span>-><span class="hljs-number">3010</span>/tcp, <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">9876</span>-><span class="hljs-number">3011</span>/udp
</code></pre>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2>프로필</h2>
<p>"프로필"은 컴포즈 파일 내에서 역할을 분리할 수 있는 멋진 제어 메커니즘입니다. 우리가 컴포즈 파일 내에서 일부 컨테이너가 매우 특정한 설정하에서만 실행되거나 필요할 때만 실행되도록 원한다고 가정해 봅시다 (즉, "프로필"이라고도 함). 이것이 할 수 있는 것입니다:</p>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: nginx
  <span class="hljs-attr">second</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: wget <span class="hljs-attr">http</span>:<span class="hljs-comment">//first</span>
    <span class="hljs-attr">profiles</span>: [<span class="hljs-string">"debug"</span>]
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up -d
네트워크 <span class="hljs-string">"mediumcom_default"</span>를 기본 드라이버로 생성 중
mediumcom_first_1 생성 완료
$ # 보세요? nginx 컨테이너만 시작되었습니다. 이제 <span class="hljs-string">"debug"</span>를 활성화해 봅시다
$ docker-compose --profile debug up
mediumcom_first_1 is up-to-date
mediumcom_second_1 생성 완료
mediumcom_first_1, mediumcom_second_1에 첨부
second_1  | <span class="hljs-title function_">first</span>(<span class="hljs-number">172.26</span><span class="hljs-number">.0</span><span class="hljs-number">.2</span>:<span class="hljs-number">80</span>)에 연결 중
second_1  | <span class="hljs-string">'index.html'</span> 저장 중
second_1  | index.<span class="hljs-property">html</span>           <span class="hljs-number">100</span>% |********************************|   <span class="hljs-number">615</span>  <span class="hljs-number">0</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> 남음
second_1  | <span class="hljs-string">'index.html'</span> 저장됨
first_1   | <span class="hljs-regexp">/docker-entrypoint.sh: /</span>docker-entrypoint.<span class="hljs-property">d</span>/가 비어 있지 않으므로 구성을 시도할 것입니다
(first_이하 생략)
mediumcom_second_1이 코드 <span class="hljs-number">0</span>으로 종료됨
</code></pre>
<h2>재시작</h2>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>컨테이너의 재시작 정책을 정의하는 방법입니다 (no, always, unless-stopped, on-failure 중 하나를 선택).</p>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">restart</span>: on-failure
    <span class="hljs-attr">command</span>: sleep <span class="hljs-number">4</span>
  <span class="hljs-attr">second</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: echo <span class="hljs-title class_">Hi</span> <span class="hljs-string">`date`</span>
    <span class="hljs-attr">restart</span>: always
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up
<span class="hljs-title class_">Creating</span> network <span class="hljs-string">"mediumcom_default"</span> <span class="hljs-keyword">with</span> the <span class="hljs-keyword">default</span> driver
<span class="hljs-title class_">Creating</span> mediumcom_first_1  ... done
<span class="hljs-title class_">Creating</span> mediumcom_second_1 ... done
<span class="hljs-title class_">Attaching</span> to mediumcom_first_1, mediumcom_second_1
second_1  | <span class="hljs-title class_">Hi</span> <span class="hljs-title class_">Tue</span> <span class="hljs-title class_">Feb</span> <span class="hljs-number">1</span> <span class="hljs-number">17</span>:<span class="hljs-number">21</span>:<span class="hljs-number">11</span> <span class="hljs-variable constant_">CET</span> <span class="hljs-number">2022</span>
mediumcom_second_1 exited <span class="hljs-keyword">with</span> code <span class="hljs-number">0</span>
second_1  | <span class="hljs-title class_">Hi</span> <span class="hljs-title class_">Tue</span> <span class="hljs-title class_">Feb</span> <span class="hljs-number">1</span> <span class="hljs-number">17</span>:<span class="hljs-number">21</span>:<span class="hljs-number">11</span> <span class="hljs-variable constant_">CET</span> <span class="hljs-number">2022</span>
second_1  | <span class="hljs-title class_">Hi</span> <span class="hljs-title class_">Tue</span> <span class="hljs-title class_">Feb</span> <span class="hljs-number">1</span> <span class="hljs-number">17</span>:<span class="hljs-number">21</span>:<span class="hljs-number">11</span> <span class="hljs-variable constant_">CET</span> <span class="hljs-number">2022</span>
mediumcom_second_1 exited <span class="hljs-keyword">with</span> code <span class="hljs-number">0</span>
second_1  | <span class="hljs-title class_">Hi</span> <span class="hljs-title class_">Tue</span> <span class="hljs-title class_">Feb</span> <span class="hljs-number">1</span> <span class="hljs-number">17</span>:<span class="hljs-number">21</span>:<span class="hljs-number">11</span> <span class="hljs-variable constant_">CET</span> <span class="hljs-number">2022</span>
second_1  | <span class="hljs-title class_">Hi</span> <span class="hljs-title class_">Tue</span> <span class="hljs-title class_">Feb</span> <span class="hljs-number">1</span> <span class="hljs-number">17</span>:<span class="hljs-number">21</span>:<span class="hljs-number">11</span> <span class="hljs-variable constant_">CET</span> <span class="hljs-number">2022</span>
second_1  | <span class="hljs-title class_">Hi</span> <span class="hljs-title class_">Tue</span> <span class="hljs-title class_">Feb</span> <span class="hljs-number">1</span> <span class="hljs-number">17</span>:<span class="hljs-number">21</span>:<span class="hljs-number">11</span> <span class="hljs-variable constant_">CET</span> <span class="hljs-number">2022</span>
mediumcom_second_1 exited <span class="hljs-keyword">with</span> code <span class="hljs-number">0</span>
second_1  | <span class="hljs-title class_">Hi</span> <span class="hljs-title class_">Tue</span> <span class="hljs-title class_">Feb</span> <span class="hljs-number">1</span> <span class="hljs-number">17</span>:<span class="hljs-number">21</span>:<span class="hljs-number">11</span> <span class="hljs-variable constant_">CET</span> <span class="hljs-number">2022</span>
second_1  | <span class="hljs-title class_">Hi</span> <span class="hljs-title class_">Tue</span> <span class="hljs-title class_">Feb</span> <span class="hljs-number">1</span> <span class="hljs-number">17</span>:<span class="hljs-number">21</span>:<span class="hljs-number">11</span> <span class="hljs-variable constant_">CET</span> <span class="hljs-number">2022</span>
second_1  | <span class="hljs-title class_">Hi</span> <span class="hljs-title class_">Tue</span> <span class="hljs-title class_">Feb</span> <span class="hljs-number">1</span> <span class="hljs-number">17</span>:<span class="hljs-number">21</span>:<span class="hljs-number">11</span> <span class="hljs-variable constant_">CET</span> <span class="hljs-number">2022</span>
second_1  | <span class="hljs-title class_">Hi</span> <span class="hljs-title class_">Tue</span> <span class="hljs-title class_">Feb</span> <span class="hljs-number">1</span> <span class="hljs-number">17</span>:<span class="hljs-number">21</span>:<span class="hljs-number">11</span> <span class="hljs-variable constant_">CET</span> <span class="hljs-number">2022</span>
mediumcom_first_1 exited <span class="hljs-keyword">with</span> code <span class="hljs-number">0</span>
</code></pre>
<h2>보안 설정</h2>
<p>이 옵션을 사용하면 컨테이너의 SELinux 레이블을 제어할 수 있습니다.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-bash">$ <span class="hljs-built_in">cat</span> >docker-compose.yml &#x3C;&#x3C;<span class="hljs-string">EOF
version: "3"
services:
  first:
    image: alpine
    command: sleep 30
    security_opt:
     - label:user:USER
  second:
    image: alpine
    command: sleep 30
EOF</span>
$ docker inspect mediumcom_first_1 --format <span class="hljs-string">'{ .Id }: SecurityOpt={ .HostConfig.SecurityOpt }'</span>
2808e4b2ac6a6870b372ecf06da5ce0217efdd6d14df16cef4b332e1d4fb9b6a: SecurityOpt=[label:user:USER]
$
$ docker inspect mediumcom_second_1 --format <span class="hljs-string">'{ .Id }: SecurityOpt={ .HostConfig.SecurityOpt }'</span>
ed4c417b27257cc9f793d5d3dad94672074859dba90effddd0cde49f12dd4115: SecurityOpt=&#x3C;no value>
</code></pre>
<h2>stop_grace_period</h2>
<p>기본적으로 Docker는 SIGTERM을 수신한 후 10초 내에 컨테이너가 자연스럽게 중지되지 않으면 컨테이너를 강제로 종료합니다 (예: docker stop으로 컨테이너를 의도적으로 중지시킨 후). 이 시간 간격을 stop grace period라고 하며 구성할 수 있습니다.</p>
<pre><code class="hljs language-bash">$ <span class="hljs-built_in">cat</span> >docker-compose.yml &#x3C;&#x3C;<span class="hljs-string">EOF
version: "3"
services:
  first:
    image: alpine
    command: sh -c 'while true; do sleep 5 &#x26; done'
  second:
    image: alpine
    command: sh -c 'while true; do sleep 5 &#x26; done'
    stop_grace_period: 1s
EOF</span>
$ docker-compose up -d
Recreating mediumcom_first_1  ... <span class="hljs-keyword">done</span>
Recreating mediumcom_second_1 ... <span class="hljs-keyword">done</span>
$ time docker stop mediumcom_first_1
mediumcom_first_1
real 0m10.847s
user 0m0.205s
sys 0m0.092s
$ time docker stop mediumcom_second_1
mediumcom_second_1
real 0m1.883s
user 0m0.192s
sys 0m0.105s
</code></pre>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2>stop_signal</h2>
<p>앞서 언급한 옵션에서 SIGTERM이 도커 컨테이너를 중지하는 기본 신호임을 이미 알았을 것입니다. 그러나 여러분은 <code>docker stop</code>이 컨테이너 응용 프로그램으로 원하는 사용자 정의 신호를 전송하도록 변경할 수 있습니다:</p>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: sleep <span class="hljs-number">60</span>
    <span class="hljs-attr">stop_signal</span>: <span class="hljs-title class_">SIGUSR1</span>
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up -d
<span class="hljs-title class_">Creating</span> network <span class="hljs-string">"mediumcom_default"</span> <span class="hljs-keyword">with</span> the <span class="hljs-keyword">default</span> driver
<span class="hljs-title class_">Creating</span> mediumcom_first_1 ... done
$ docker inspect mediumcom_first_1 --format <span class="hljs-string">'{.Config.StopSignal}'</span>
<span class="hljs-title class_">SIGUSR1</span>
</code></pre>
<h2>sysctls</h2>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>이 옵션은 컨테이너의 네임스페이스된 커널 매개변수를 런타임에서 구성할 수 있게 합니다.</p>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: sleep <span class="hljs-number">60</span>
    <span class="hljs-attr">sysctls</span>:
      net.<span class="hljs-property">core</span>.<span class="hljs-property">somaxconn</span>: <span class="hljs-number">1024</span>
      net.<span class="hljs-property">ipv4</span>.<span class="hljs-property">tcp_syncookies</span>: <span class="hljs-number">0</span>
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up -d
네트워크 <span class="hljs-string">"mediumcom_default"</span> 생성 중, 기본 드라이버로 설정
mediumcom_first_1 생성 중... 완료
$ docker inspect mediumcom_first_1 --format <span class="hljs-string">'{json .HostConfig.Sysctls}'</span>
{<span class="hljs-string">"net.core.somaxconn"</span>: <span class="hljs-string">"1024"</span>, <span class="hljs-string">"net.ipv4.tcp_syncookies"</span>: <span class="hljs-string">"0"</span>}
</code></pre>
<h2>ulimits</h2>
<p>컨테이너의 기본 ulimits를 재정의할 수 있게 합니다.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: sleep <span class="hljs-number">60</span>
    <span class="hljs-attr">ulimits</span>:
      <span class="hljs-attr">nproc</span>: <span class="hljs-number">65535</span>
      <span class="hljs-attr">nofile</span>:
        <span class="hljs-attr">soft</span>: <span class="hljs-number">20000</span>
        <span class="hljs-attr">hard</span>: <span class="hljs-number">40000</span>
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up -d
<span class="hljs-title class_">Recreating</span> mediumcom_first_1 ... done
$ docker inspect mediumcom_first_1 --format <span class="hljs-string">'{json .HostConfig.Ulimits}'</span>
[{<span class="hljs-string">"Name"</span>:<span class="hljs-string">"nproc"</span>,<span class="hljs-string">"Hard"</span>:<span class="hljs-number">65535</span>,<span class="hljs-string">"Soft"</span>:<span class="hljs-number">65535</span>},{<span class="hljs-string">"Name"</span>:<span class="hljs-string">"nofile"</span>,<span class="hljs-string">"Hard"</span>:<span class="hljs-number">40000</span>,<span class="hljs-string">"Soft"</span>:<span class="hljs-number">20000</span>}]
</code></pre>
<h2>userns_mode</h2>
<p>너무 깊게 파고들지 않고 Docker 데몬에서 사용자 네임스페이스를 활성화한 경우, 단일 컨테이너에서 사용자 네임스페이스를 비활성화하게 하는 옵션입니다. <code>userns_mode: "host"</code>를 사용하면 됩니다.</p>
<h2>user</h2>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>컨테이너 응용프로그램이 특정 사용자로 실행되도록 하려면 어떻게 하시겠습니까?</p>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: whoami
    <span class="hljs-attr">user</span>: nobody
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up
<span class="hljs-title class_">Recreating</span> mediumcom_first_1 ... done
<span class="hljs-title class_">Attaching</span> to mediumcom_first_1
first_1  | nobody
mediumcom_first_1 exited <span class="hljs-keyword">with</span> code <span class="hljs-number">0</span>
</code></pre>
<h2>working_dir</h2>
<p>도커 파일에서 본 적이 있을 것입니다. 이를 사용하면 컨테이너의 랜딩 경로(PWD)를 재정의할 수 있습니다. 이를 통해 엔트리포인트와 명령이 절대 경로를 사용하지 않는 경우에도 동작을 변경할 수 있습니다.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: pwd
    <span class="hljs-attr">working_dir</span>: <span class="hljs-regexp">/my/</span>custom/medium/dir
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up
mediumcom_first_1 컨테이너 다시 생성 중... 완료
mediumcom_first_1에 연결 중
first_1  | <span class="hljs-regexp">/my/</span>custom/medium/dir
mediumcom_first_1 코드 <span class="hljs-number">0</span>으로 종료됨
</code></pre>
<h2>도메인 이름</h2>
<p>당신의 컨테이너는 호스트명과 도메인명을 가지고 있다는 것을 아시죠. 호스트 모드가 아닐 때, 호스트명은 컨테이너의 ID와 동일하며, 도메인명은 예상대로 없을 것입니다. 도메인명을 설정하려면 다음과 같이 하세요:</p>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: hostname -f
    <span class="hljs-attr">domainname</span>: cristovaocordeiro.<span class="hljs-property">medium</span>.<span class="hljs-property">com</span>
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up
mediumcom_first_1 컨테이너 다시 생성 중... 완료
mediumcom_first_1에 연결 중
first_1  | 6e900c697939.<span class="hljs-property">cristovaocordeiro</span>.<span class="hljs-property">medium</span>.<span class="hljs-property">com</span>
mediumcom_first_1 코드 <span class="hljs-number">0</span>으로 종료됨
</code></pre>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2>호스트이름</h2>
<p>당연히 도메인 이름을 설정할 수 있다면 컨테이너의 호스트 이름도 설정할 수 있습니다. 이렇게 하면 기본적으로 제공되는 "충격적인" ID 형식 대신 호스트 이름을 사용할 수 있습니다 😜</p>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: hostname -f
    <span class="hljs-attr">hostname</span>: test-container
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up
<span class="hljs-title class_">Recreating</span> mediumcom_first_1 ... done
<span class="hljs-title class_">Attaching</span> to mediumcom_first_1
first_1  | test-container
mediumcom_first_1 exited <span class="hljs-keyword">with</span> code <span class="hljs-number">0</span>
</code></pre>
<h2>ipc</h2>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>컨테이너의 프로세스 간 통신을 관리할 수 있습니다(성능 조정 목적). 이 옵션을 통해 컨테이너의 IPC 네임스페이스를 설정할 수 있습니다.</p>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: sleep <span class="hljs-number">30</span>
    <span class="hljs-attr">ipc</span>: shareable
<span class="hljs-variable constant_">EOF</span>
$ docker inspect mediumcom_first_1 --format <span class="hljs-string">'{json .HostConfig.IpcMode}'</span>
<span class="hljs-string">"shareable"</span>
</code></pre>
<h2>mac_address</h2>
<p>원하는 컨테이너에 사용자 정의 MAC 주소를 설정할 수도 있습니다.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
버전: <span class="hljs-string">"3"</span>
서비스:
  <span class="hljs-attr">first</span>:
    이미지: alpine
    명령: ifconfig eth0
    <span class="hljs-attr">mac_address</span>: <span class="hljs-number">00</span>:<span class="hljs-attr">ab</span>:<span class="hljs-attr">cd</span>:<span class="hljs-number">12</span>:<span class="hljs-number">34</span>:<span class="hljs-number">56</span>
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up
mediumcom_first_1 컨테이너 다시 생성 중... 완료
mediumcom_first_1에 연결 중
first_1  | eth0 <span class="hljs-title class_">Link</span> <span class="hljs-attr">encap</span>:<span class="hljs-title class_">Ethernet</span>  <span class="hljs-title class_">HWaddr</span> <span class="hljs-number">00</span>:<span class="hljs-attr">AB</span>:<span class="hljs-attr">CD</span>:<span class="hljs-number">12</span>:<span class="hljs-number">34</span>:<span class="hljs-number">56</span>  
first_1  | inet <span class="hljs-attr">addr</span>:<span class="hljs-number">172.29</span><span class="hljs-number">.0</span><span class="hljs-number">.2</span> <span class="hljs-title class_">Bcast</span>:<span class="hljs-number">172.29</span><span class="hljs-number">.255</span><span class="hljs-number">.255</span> <span class="hljs-title class_">Mask</span>:<span class="hljs-number">255.255</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>
first_1  | <span class="hljs-variable constant_">UP</span> <span class="hljs-variable constant_">BROADCAST</span> <span class="hljs-variable constant_">RUNNING</span> <span class="hljs-variable constant_">MULTICAST</span> <span class="hljs-attr">MTU</span>:<span class="hljs-number">1500</span> <span class="hljs-title class_">Metric</span>:<span class="hljs-number">1</span>
first_1  | <span class="hljs-variable constant_">RX</span> <span class="hljs-attr">packets</span>:<span class="hljs-number">2</span> <span class="hljs-attr">errors</span>:<span class="hljs-number">0</span> <span class="hljs-attr">dropped</span>:<span class="hljs-number">0</span> <span class="hljs-attr">overruns</span>:<span class="hljs-number">0</span> <span class="hljs-attr">frame</span>:<span class="hljs-number">0</span>
first_1  | <span class="hljs-variable constant_">TX</span> <span class="hljs-attr">packets</span>:<span class="hljs-number">0</span> <span class="hljs-attr">errors</span>:<span class="hljs-number">0</span> <span class="hljs-attr">dropped</span>:<span class="hljs-number">0</span> <span class="hljs-attr">overruns</span>:<span class="hljs-number">0</span> <span class="hljs-attr">carrier</span>:<span class="hljs-number">0</span>
first_1  | <span class="hljs-attr">collisions</span>:<span class="hljs-number">0</span> <span class="hljs-attr">txqueuelen</span>:<span class="hljs-number">0</span> 
first_1  | <span class="hljs-variable constant_">RX</span> <span class="hljs-attr">bytes</span>:<span class="hljs-number">200</span> (<span class="hljs-number">200.0</span> B)  <span class="hljs-variable constant_">TX</span> <span class="hljs-attr">bytes</span>:<span class="hljs-number">0</span> (<span class="hljs-number">0.0</span> B)
first_1  |
mediumcom_first_1가 코드 <span class="hljs-number">0</span>으로 종료됨
</code></pre>
<h2>특권적</h2>
<p>위에서 "특권적" 컨테이너 상태를 몇 번 다뤘습니다. 간단히 말하면, (!!) 확실히 확신이 있고 컨테이너에 가능한 모든 기능을 부여하고 싶다면 (따라서 호스트 장치 및 기타 자원에 액세스 할 수 있음), 이 옵션을 사용할 수 있습니다.</p>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
버전: <span class="hljs-string">"3"</span>
서비스:
  <span class="hljs-attr">first</span>:
    이미지: alpine
    명령: sh -c <span class="hljs-string">'ls /dev/ | wc -l'</span>
  <span class="hljs-attr">second</span>:
    이미지: alpine
    명령: sh -c <span class="hljs-string">'ls /dev/ | wc -l'</span>
    특권적: <span class="hljs-literal">true</span>
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up
mediumcom_first_1 컨테이너 다시 생성 중... 완료
mediumcom_second_1 컨테이너 다시 생성 중... 완료
mediumcom_first_1에 연결 중, mediumcom_second_1에 연결 중
first_1  | <span class="hljs-number">15</span>
second_1  | <span class="hljs-number">150</span>
mediumcom_first_1가 코드 <span class="hljs-number">0</span>으로 종료됨
mediumcom_second_1가 코드 <span class="hljs-number">0</span>으로 종료됨
</code></pre>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2>읽기 전용</h2>
<p>컨테이너를 실행할 때 읽기 전용 이미지 레이어 위에 쓰기 가능한 레이어가 생성된다는 사실을 알고 계실 겁니다. 그러나 이 쓰기 가능한 레이어를 읽기 전용으로 바꿀 수도 있습니다.</p>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: touch /tmp/test
  <span class="hljs-attr">second</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: touch /tmp/test
    <span class="hljs-attr">read_only</span>: <span class="hljs-literal">true</span>
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up
mediumcom_first_1  ... done
mediumcom_second_1 ... done
mediumcom_first_1, mediumcom_second_1에 연결 중
second_1  | <span class="hljs-attr">touch</span>: <span class="hljs-regexp">/tmp/</span><span class="hljs-attr">test</span>: 읽기 전용 파일 시스템
mediumcom_first_1 코드 <span class="hljs-number">0</span>으로 종료
mediumcom_second_1 코드 <span class="hljs-number">1</span>로 종료
</code></pre>
<h2>shm_size</h2>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>컨테이너가 사용할 수 있는 공유 메모리 양을 지정할 수 있습니다.</p>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">command</span>: df -h /dev/shm
    <span class="hljs-attr">shm_size</span>: 123M
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up
mediumcom_first_1 컨테이너를 다시 생성 중... 완료
mediumcom_first_1에 연결 중
first_1  | 파일 시스템                크기      사용함 사용 가능함 사용률 마운트된 위치
first_1  | shm                     <span class="hljs-number">123.</span>0M         <span class="hljs-number">0</span>    <span class="hljs-number">123.</span>0M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/dev/</span>shm
mediumcom_first_1은 코드 <span class="hljs-number">0</span>으로 종료됨
</code></pre>
<h2>stdin_open</h2>
<p>이는 docker run의 -i에 해당합니다. 이를 사용하여 호스트와 컨테이너 간 상호작용이 가능한 인터랙티브 세션을 만들 수 있습니다.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-bash">$ <span class="hljs-built_in">cat</span> >docker-compose.yml &#x3C;&#x3C;<span class="hljs-string">EOF
version: "3"
services:
  first:
    image: alpine
    stdin_open: true
EOF</span>
$ docker-compose up -d
Recreating mediumcom_first_1 ... <span class="hljs-keyword">done</span>
$ docker attach mediumcom_first_1
<span class="hljs-built_in">echo</span> Hello, I am sending commands to the container
Hello, I am sending commands to the container
<span class="hljs-built_in">exit</span>
</code></pre>
<p>위와 같이 컨테이너와 상호 작용하고 있지만 호스트와 컨테이너 사이에 실제로 터미널 세션이 없습니다... 간단히 말해서 파이프일 뿐입니다.</p>
<h2>tty</h2>
<p>이것은 도커 실행에서의 -t와 동등합니다. 컨테이너에 가상 tty를 할당하고 stdin_open과 결합할 때 유용합니다.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<pre><code class="hljs language-js">$ cat >docker-compose.<span class="hljs-property">yml</span> &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>
<span class="hljs-attr">version</span>: <span class="hljs-string">"3"</span>
<span class="hljs-attr">services</span>:
  <span class="hljs-attr">first</span>:
    <span class="hljs-attr">image</span>: alpine
    <span class="hljs-attr">stdin_open</span>: <span class="hljs-literal">true</span>
    <span class="hljs-attr">tty</span>: <span class="hljs-literal">true</span>
<span class="hljs-variable constant_">EOF</span>
$ docker-compose up -d
mediumcom_first_1 컨테이너를 다시 생성합니다... 완료
$ docker attach mediumcom_first_1
/ # echo now <span class="hljs-variable language_">this</span> is a real terminal
now <span class="hljs-variable language_">this</span> is a real terminal
/ # sleep <span class="hljs-number">5</span>
^C
/ # echo $?
<span class="hljs-number">130</span>
/ # exit
</code></pre>
<p>이제 우리는 실제 터미널과 상호 작용하는 세션을 가지고 있습니다. 컨테이너 안에서 원하는 일을 할 수 있어요.</p>
<p>우와... 정말 긴 기사였죠. 죄송합니다. 밝은 면에서 말하면, 여러 기사를 넘나들며 다양한 컴포즈 파일 옵션이 무엇을 하는지 찾아보지 않아도 되겠죠?</p>
<p>스웜 모드에서 서비스에 특정한 옵션(변수 치환 및 확장 필드 같은 고유한 구조적 노하우)을 일부 뺐습니다. 이것들은 선택 사항이며, 다른 기사에서 다룰 수 있어요.</p>
<!-- ui-station 사각형 -->
<p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4877378276818686" data-ad-slot="7249294152" data-ad-format="auto" data-full-width-responsive="true"></ins></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>이 테이블 태그를 마크다운 형식으로 변경해드렸습니다.</p>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"전체 구성 Compose 파일 쉽게 설정하는 방법","description":"","date":"2024-06-23 00:30","slug":"2024-06-23-TheWholeShebangComposeFiles","content":"\n\u003cimg src=\"/assets/img/2024-06-23-TheWholeShebangComposeFiles_0.png\" /\u003e\n\n요즘 Docker 및 컨테이너에 대해 많이 쓰고 가르치고 있습니다. 내 컨텐츠를 소비하고 피드백을 제공해 주시는 여러분들에게 매우 감사합니다. 여러분의 의견을 듣고 다음 주제는 당연히 Docker Compose입니다. 왜냐하면 이제 여러분은 자신의 컨테이너 이미지를 만들고 실행하는 방법을 알고 있으므로, 다음으로 논리적으로 남은 일은 복잡한 멀티 컨테이너 애플리케이션을 만들고 그 모든 것을 단일 소프트웨어로 관리하는 것입니다.\n\n# Docker Compose: 그게 뭔데, 왜 필요한가요?\n\n공식 문서에서 더 많은 정보를 확인할 수 있지만, 간단히 말하면 다음과 같습니다: Docker를 사용하여 컨테이너, 이미지, 볼륨 등을 관리합니다. docker run을 실행하면 기본적으로 단일 컨테이너를 실행하는 것입니다. 만약 첫 번째 컨테이너와 상호 작용하는 두 번째 컨테이너를 시작하려면 docker run을 다시 실행해야 하며, 볼륨 및 네트워크를 별도로 처리하여 서로를 보고 통신할 수 있도록 해야 합니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n도커 컴포즈는 도커 위에 래퍼를 제공하여 이 모든 것을 추상화합니다 (맞아요! 도커 컴포즈는 단순히 도커를 위한 고수준 CLI입니다). 실제로 대부분의 옵션이 docker run 하위 명령어에서 사용 가능한 옵션들과 매우 유사한 방식으로 명명됩니다.\n\n도커 컴포즈를 사용하면 YAML 파일인 컴포즈 파일을 통해 컨테이너(도커 컴포즈 세계에서는 서비스라고 불립니다... 단지 스웜 모드에서도 컴포즈 파일을 사용할 수 있기 때문에... 다른 글에서 설명할 예정), 볼륨 및 네트워크를 포함한 모든 것을 선언적으로 정의할 수 있습니다. 이렇게 하면 멀티 컨테이너 애플리케이션을 관리해야 할 때, 이 compose 파일만 건드리고 나머지는 도커 컴포즈가 모두 처리하도록 할 수 있습니다.\n\n# 컴포즈 파일\n\n우선, 멀티 컨테이너 애플리케이션을 올바르게 운영하려면 컴포즈 파일을 작성하는 방법을 익혀야 하므로 도커 컴포즈 CLI에 대해서는 다른 글에서 다룰 예정입니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n도커의 구성 파일 관련 문서는 매우 완벽하지만, 저는 실용주의와 경험으로부터 배우는 것을 중요하게 생각하는 사람이라서 모든 Compose 파일 옵션을 손질하고 명료한 설명과 실제 예시를 담아내려고 합니다. 여기서 시작해봅시다!\n\n참고 1: 이 기사를 작성하는 시점에서 최신 버전인 v3의 Compose 파일 명세에 대한 옵션과 스키마만 다룰 예정입니다. 그러니 걱정하지 마세요.\n\n참고 2: 각 옵션에 대해 일반적으로 사용되는 방법에 대한 설명과 예시만 제공할 것이며, 특정 옵션 매개변수를 사용해본 적이 없는 경우에는 \"일반적이지 않음\"으로 간주할 것입니다. 어떤 옵션의 적은 사용 방법 및 일반적이지 않은 매개변수를 더 자세히 알고 싶다면 공식 문서를 참조해주세요.\n\n예시에 들어가기 전에, 모든 구성 파일은 작성하는 현재의 파일 스키마를 나타내는 키워드 version으로 시작됩니다. 앞서 말한대로, 저희는 최신 (버전: \"3\")을 사용할 것입니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## 빌드\n\n기본적으로 Docker Compose로 무언가를 시작할 때, Docker 이미지 또는 Dockerfile을 제공할 수 있습니다. 해당 컨테이너를 시작하기 전에 Docker가 이미지를 직접 빌드하도록 하고 싶다면 수동으로 이미지를 빌드하지 않고도 이 옵션을 사용할 수 있습니다.\n\n예를 들어:\n\n```js\n$ cat \u003eDockerfile \u003c\u003cEOF\n# 이것은 Dockerfile입니다\nFROM ubuntu\nCMD [\"echo\", \"Hello Medium readers\"]\n# Dockerfile 끝\nEOF\n$\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  my-test-container:\n    build: .\nEOF\n$\n$ docker-compose up\n디폴트 드라이버를 사용하여 \"mediumcom_default\" 네트워크 생성 중\nmy-test-container 빌드 중\nDocker 데몬으로 빌드 컨텍스트 보내는 중  1.337MB\n단계 1/2 : FROM ubuntu\n ---\u003e ba6acccedd29\n단계 2/2 : CMD [\"echo\", \"Hello Medium readers\"]\n ---\u003e 캐시 사용 중\n ---\u003e 6c8b22fa650c\n성공적으로 빌드되었습니다 6c8b22fa650c\nmediumcom_my-test-container:latest로 성공적으로 태깅되었습니다\nmediumcom_my-test-container_1 생성 중 ... 완료\nmediumcom_my-test-container_1에 연결 중\nmy-test-container_1  | Hello Medium readers\nmediumcom_my-test-container_1는 코드 0으로 종료됨\n$\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n보시다시피, Docker Compose는 Docker에게 도커파일(컴포즈 파일과 동일한 경로에 위치)로부터 이미지를 빌드하도록 지시하고, 그 후에 자동으로 컨테이너를 시작했습니다.\n\n참고: 일반적으로 docker build와 함께 사용하는 일부 옵션들(빌드 인자 전달, Dockerfile의 경로 및 이름 지정 등)도 여기에서 사용할 수 있습니다. 자세한 내용은 문서를 확인해주세요.\n\n## 이미지\n\n어플리케이션을 실행할 때마다 Docker 이미지를 빌드할 필요는 없겠죠... 그렇게 하면 불편하겠죠. 따라서 이미지를 미리 빌드하거나 간단히 컨테이너 이미지를 지정하면 됩니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n예를 들어, 이전 예제의 Dockerfile과 다음의 compose 파일을 살펴보세요:\n\n```js\n$ # 이전 예제 정리하기 위함\n$ # 이제부터 각 예제에서 다음 명령 실행해주세요\n$ docker-compose down -v --remove-orphans\n$\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    build: .\n  second:\n    image: hello-world\nEOF\n$ # Dockerfile이 변경되지 않았기 때문에 첫 번째 이미지가 다시 빌드되지 않습니다\n$ docker-compose up\n네트워크 \"mediumcom_default\" 생성 중\nmediumcom_first_1  ... 생성됨\nmediumcom_second_1 ... 생성됨\nmediumcom_second_1, mediumcom_first_1에 연결 중\nfirst_1   | Hello Medium readers\nsecond_1  |\nsecond_1  | Hello from Docker!\nsecond_1  | This message shows that your installation appears to be working correctly.\nsecond_1  |\nsecond_1  | To generate this message, Docker took the following steps:\nsecond_1  |  1. The Docker client contacted the Docker daemon.\nsecond_1  |  2. The Docker daemon pulled the \"hello-world\" image from the Docker Hub.\nsecond_1  |     (amd64)\nsecond_1  |  3. The Docker daemon created a new container from that image which runs the\nsecond_1  |     executable that produces the output you are currently reading.\nsecond_1  |  4. The Docker daemon streamed that output to the Docker client, which sent it\nsecond_1  |     to your terminal.\nsecond_1  |\nsecond_1  | To try something more ambitious, you can run an Ubuntu container with:\nsecond_1  |  $ docker run -it ubuntu bash\nsecond_1  |\nsecond_1  | Share images, automate workflows, and more with a free Docker ID:\nsecond_1  |  https://hub.docker.com/\nsecond_1  |\nsecond_1  | For more examples and ideas, visit:\nsecond_1  |  https://docs.docker.com/get-started/\nsecond_1  |\nmediumcom_second_1이 코드 0으로 종료됨\nmediumcom_first_1이 코드 0으로 종료됨\n```\n\n여기서 보듯이, 이제 하나의 Compose 파일과 하나의 docker-compose 명령을 사용하여 동일한 다중 컨테이너 애플리케이션 내에서 병렬로 2개의 컨테이너를 실행했습니다. 하나의 컨테이너는 \"Hello Medium readers\"라고 말하는 사용자 지정 Docker 이미지를 사용했고, 다른 하나는 Docker Hub에서 \"hello-world\" 이미지를 가져와 자체 Hello World 메시지를 출력했습니다.\n\n## 명령\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n이를 통해 컨테이너의 명령을 정의할 수 있습니다. 따라서 Docker 이미지에 entrypoint가 정의되어 있으면 이 명령이 해당 entrypoint의 인수가 됩니다. 예시:\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: ubuntu\n    command: echo \"I am at your command!\"\nEOF\n$ docker-compose up\nCreating network \"mediumcom_default\" with the default driver\nCreating mediumcom_first_1 ... done\nAttaching to mediumcom_first_1\nfirst_1  | I am at your command!\nmediumcom_first_1 exited with code 0\n```\n\n아주 간단하지요?\n\n## entrypoint\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n이름에서 알 수 있듯이 해당 기능은 컨테이너의 엔트리포인트를 재정의하게 해줍니다. 예를 들어, 컨테이너가 echo 실행 파일로 실행되도록 하려면 다음과 같이 작성할 수 있어요:\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: ubuntu\n    entrypoint: [\"echo\"]\n    command: \"I am just an arg\"\nEOF\n$ docker-compose up\nCreating network \"mediumcom_default\" with the default driver\nCreating mediumcom_first_1 ... done\nAttaching to mediumcom_first_1\nfirst_1  | I am just an arg\nmediumcom_first_1 exited with code 0\n```\n\n간단하지요? 그리고 command 대 entrypoint 등에 대해 궁금해 한다면 당신만이 아닙니다. 이것은 매우 일반적인 혼란 포인트입니다. 다른 기사 \"전부 다: Dockerfiles\"에서 이에 대해 이야기했어요. 간단히 말해서, 저는 이 두 옵션을 조율할 때 필요한 치트 시트를 제공합니다: https://docs.docker.com/engine/reference/builder/#understand-how-cmd-and-entrypoint-interact\n\n## cap_add\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n만약 컨테이너에 추가 기능이 필요한 경우, 다음과 같이 추가할 수 있어요:\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: ubuntu:14.04\n    command: ip link add dummy0 type dummy\n    cap_add:\n     - NET_ADMIN\nEOF\n$ docker-compose up\nRecreating mediumcom_first_1 ... done\nAttaching to mediumcom_first_1\nmediumcom_first_1 exited with code 0\n```\n\n이제 위와 같은 컨테이너를 실행하려고 하지만 기능이 없는 경우, 에러가 발생할 거예요:\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: ubuntu:14.04\n    command: ip link add dummy0 type dummy\nEOF\n$ docker-compose up\nRecreating mediumcom_first_1 ... done\nAttaching to mediumcom_first_1\nfirst_1  | RTNETLINK answers: Operation not permitted\nmediumcom_first_1 exited with code 2\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## cap_drop\n\ncap_add의 정 반대입니다. 컨테이너에서 기능을 제거하는 데 사용됩니다. 예를 들어 슈퍼 권한이 부여된 컨테이너가 있다고 가정해보겠습니다:\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: ubuntu:14.04\n    command: ip link add dummy0 type dummy\n    cap_add:\n     - ALL\nEOF\n$ docker-compose up\nRecreating mediumcom_first_1 ... done\nAttaching to mediumcom_first_1\nmediumcom_first_1 exited with code 0\n```\n\n그러나 호스트 네트워크 스택을 관리하려고 하지 않는다면:\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```sh\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: ubuntu:14.04\n    command: ip link add dummy0 type dummy\n    cap_add:\n     - ALL\n    cap_drop:\n     - NET_ADMIN\nEOF\n$ docker-compose up\nmediumcom_first_1 컨테이너를 다시 생성하는 중... 완료\nmediumcom_first_1에 연결 중\nfirst_1 | RTNETLINK 답변: 작업을 수행할 수 없습니다\nmediumcom_first_1은 코드 2로 종료됨\n```\n\n## cgroup_parent\n\ncgroup에 대해 처음이라면 이곳에 관한 짧은 좋은 기사가 있습니다. 간단히 말해, Linux 커널은 제어 그룹 (cgroups)을 통해 프로세스별로 시스템 리소스의 사용량을 엄격하게 제어할 수 있는 기능을 제공합니다. Docker에서는 이를 통해 컨테이너가 특정 리소스를 얼마나 사용할 수 있는지 제어할 수 있습니다. 기본적으로 컨테이너는 가능한 많은 리소스를 사용하려고 시도할 것입니다:\n\n```sh\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: ubuntu\n    command: sleep 30\nEOF\n$ docker-compose up -d\n기본 드라이버로 네트워크 \"root_default\"를 생성 중\nroot_first_1 컨테이너 생성 중... 완료\n$ docker inspect root_first_1 --format '{.HostConfig.CgroupParent}'\n$\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n보시는 대로, 기본적으로 컨테이너에 할당된 제어 그룹이 없습니다. 하지만 우리가 할당할 수 있습니다. 심지어 우리 자신의 것을 할당할 수도 있습니다:\n\n```js\n$ cgcreate -g cpu:test-cgroup-medium\n$ ls /sys/fs/cgroup/cpu\ncgroup-limit           cgroup.sane_behavior  cpu.shares    cpuacct.usage         cpuacct.usage_percpu_sys   cpuacct.usage_user  release_agent  test-cgroup-medium\ncgroup.clone_children  cpu.cfs_period_us     cpu.stat      cpuacct.usage_all     cpuacct.usage_percpu_user  docker              system.slice   user.slice\ncgroup.procs           cpu.cfs_quota_us      cpuacct.stat  cpuacct.usage_percpu  cpuacct.usage_sys          notify_on_release   tasks\n```\n\n그리고 이 옵션을 사용함으로써 이 컨테이너에서 CPU 사용량을 엄격하게 제어할 수 있게 될 것입니다. cgroup \"cpu:test-cgroup-medium\"을 통해:\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: ubuntu\n    command: sleep 30\n    cgroup_parent: \"cpu:test-cgroup-medium\"\nEOF\n$ docker-compose up -d\nRecreating root_first_1 ... done\n$ docker inspect root_first_1 --format '{.HostConfig.CgroupParent}'\ncpu:test-cgroup-medium\n$\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## container_name\n\n이 옵션에 대해 로켓 과학같은 것은 없습니다. 이 옵션은 Docker Compose 배포에서 생성된 컨테이너의 이름을 고정하는 데 사용됩니다.\n\n이전에 언급한 바와 같이, 기본적으로 Docker Compose는 컨테이너에 접미사를 추가하며 이는 Docker Compose 프로젝트의 이름과 일치합니다 (프로젝트 이름을 명시적으로 지정하지 않는 경우 Docker Compose가 현재 경로를 기본값으로 삼습니다).\n\n따라서 Docker Compose의 이 동작을 재정의하고 생성된 컨테이너에 자체적으로 정의한 사용자 정의 이름을 지정하려면 container_name을 사용할 수 있습니다. 예시:\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: ubuntu\n    container_name: my-own-container-name\nEOF\n$ docker-compose up\n기본 드라이버로 \"mediumcom_default\" 네트워크 생성 중\nmy-own-container-name 생성 완료\nmy-own-container-name에 연결 중\nmy-own-container-name에서 코드 0으로 종료됨\n```\n\nP.S.: 네, 궁금해하실 수도 있지만, 이 Docker Compose 배포 내의 다른 컨테이너들은 컨테이너 이름에 의해 서로에게 도달할 수 있습니다. 예:\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: sleep 5\n    container_name: my-own-container-name\n  second:\n    image: alpine\n    command: ping -c 1 my-own-container-name\nEOF\n$ docker-compose up\nmy-own-container-name을 다시 생성 중... 완료\nmediumcom_second_1 생성 중... 완료\nmediumcom_second_1, my-own-container-name에 연결 중\nsecond_1  | my-own-container-name(172.18.0.3) 핑 중: 56 data bytes\nsecond_1  | 64 bytes from 172.18.0.3: seq=0 ttl=64 time=0.743 ms\nsecond_1  |\nsecond_1  | --- my-own-container-name 핑 통계 ---\nsecond_1  | 전송된 패킷: 1, 수신된 패킷: 1, 패킷 손실: 0%\nsecond_1  | 왕복 최소/평균/최대 시간 = 0.743/0.743/0.743 ms\nmediumcom_second_1이 코드 0으로 종료됨\nmy-own-container-name이 코드 0으로 종료됨\n```\n\n## depends_on\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n먼저 말하자면, 아니요, 이 옵션은 컨테이너 애플리케이션의 시작 순서를 제어할 수 있게 해주지 않아요! 많은 사람들이 하는 실수죠. 하지만 생각해보세요… 당신의 컨테이너는 내부에서 하나 이상의 프로세스를 실행하고 있기 때문에, Docker(컨테이너를 관리하는 주체)가 해당 컨테이너 내부에서 실행 중인 애플리케이션/프로세스의 비즈니스 로직을 완벽히 이해하고 있다고 가정하는 것은 순진한 판단일 거예요.\n\n이것은 미묘한 차이가 있지만, 이 옵션이 하는 일은 대신에 Docker Compose에게 컨테이너를 시작하고 중지할 때의 순서를 명시하는 것뿐이에요.\n\n예시:\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    depends_on:\n     - second\n  second:\n    image: alpine\n    depends_on:\n     - first\nEOF\n$ docker-compose up\nCreating network \"mediumcom_default\" with the default driver\nCreating mediumcom_second_1 ... done\nCreating mediumcom_first_1  ... done\nAttaching to mediumcom_second_1, mediumcom_first_1\nmediumcom_second_1 exited with code 0\nmediumcom_first_1 exited with code 0\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n봐요! 두 번째에 의존하는 첫 번째 컨테이너가 먼저 시작되므로, 두 번째 컨테이너가 먼저 시작됩니다. 그리고 멈출 때도 마찬가지 — 먼저 의존하는 첫 번째가 있기 때문에 두 번째가 마지막으로 내려갑니다!\n\n```js\n$ docker-compose down\nmediumcom_first_1  ... 삭제됨\nmediumcom_second_1 ... 삭제됨\nmediumcom_default 네트워크 제거됨\n```\n\n추신: 만약 혼돈을 즐긴다면, 두 번째도 첫 번째에 의존하도록 만들었다면 어떻게 될까요? 😝 걱정 마세요, Docker는 똑똑해서 다음과 같은 메시지를 보여줄 거예요:\n\n## 볼륨\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n도커 볼륨에 대해 자세히 설명하지 않을 거예요. 이 주제는 꽤 크거든요. 단지 컨테이너 애플리케이션에서 데이터를 관리할 수 있는 4가지 방법이 있다는 것만 말씀드릴게요:\n\n- 컨테이너의 쓰기 가능한 레이어 내에 모든 데이터를 유지합니다 (볼륨 없음)\n- 호스트와 컨테이너 사이에 마운트 지점을 만듭니다 (바인드 마운트)\n- 컨테이너의 수명주기와 독립적으로 데이터를 호스팅하고 관리하는 전용 도커 리소스를 생성합니다 (볼륨)\n- 성능을 최적화하기 위해 데이터를 영구 저장하지 않고 메모리에 유지합니다 (tmpfs).\n\n이렇게 말씀드린 바와 같이 Compose 파일에서 이러한 타입의 볼륨을 모두 관리할 수 있어요. 지금까지 모든 예제는 컨테이너의 쓰기 가능한 레이어를 사용했지만, 나머지 3가지 데이터 관리 옵션을 다음과 같이 사용할 수 있어요:\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: ls /\n    volumes:\n     - /:/my-hostfs\n     - my-volume:/my-volume\n     - type: tmpfs\n       target: /my-tmpfs\nvolumes:\n  my-volume:\nEOF\n$ docker-compose up\nCreating network \"test_default\" with the default driver\nCreating volume \"test_my-volume\" with default driver\nCreating test_first_1 ... done\nAttaching to test_first_1\nfirst_1  | bin\nfirst_1  | dev\nfirst_1  | etc\nfirst_1  | home\nfirst_1  | lib\nfirst_1  | media\nfirst_1  | mnt\nfirst_1  | my-hostfs\nfirst_1  | my-tmpfs\nfirst_1  | my-volume\nfirst_1  | opt\nfirst_1  | proc\nfirst_1  | root\nfirst_1  | run\nfirst_1  | sbin\nfirst_1  | srv\nfirst_1  | sys\nfirst_1  | tmp\nfirst_1  | usr\nfirst_1  | var\ntest_first_1 exited with code 0\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n여기에 세 가지 다른 유형의 마운트가 한꺼번에 나왔어요. 그런데 알아두셨나요? 제가 3가지 다른 구문을 사용했어요... 선호하는 것이나 마운트에 가장 적합한 것을 선택할 수 있어요 (여기에서 더 자세히 읽을 수 있어요).\n\n추가로, tmpfs도 전용 옵션을 통해 설정할 수 있어요... 예제를 보려면 다음 섹션을 읽어보세요.\n\n## tmpfs\n\n이미 이전 섹션에서 설명했지만, 알아두시면 좋아요. 이는 컨테이너를 위한 비영구적 마운트 포인트를 설정하는 또 다른 간단한 방법일 뿐이에요:\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```sh\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: ls /\n    tmpfs: /my-tmpfs\nEOF\n$ docker-compose up\nmediumcom_first_1 컨테이너 다시 생성 중... 완료\nmediumcom_first_1에 첨부 중\nfirst_1  | bin\nfirst_1  | dev\nfirst_1  | etc\nfirst_1  | home\nfirst_1  | lib\nfirst_1  | media\nfirst_1  | mnt\nfirst_1  | my-tmpfs\nfirst_1  | opt\nfirst_1  | proc\nfirst_1  | root\nfirst_1  | run\nfirst_1  | sbin\nfirst_1  | srv\nfirst_1  | sys\nfirst_1  | tmp\nfirst_1  | usr\nfirst_1  | var\nmediumcom_first_1가 코드 0으로 종료됨\n```\n\n## 디바이스\n\n그 이름에서 알 수 있듯이, 이 옵션은 컨테이너가 시스템 디바이스를 관리하기 위한 액세스 권한을 부여합니다. 이 것이 일반적인 바인드-마운트와 어떻게 다른지 궁금할 것입니다. 단순히 디바이스를 컨테이너에 바인드-마운트할 수 있지 않을까요? 음, 그렇고 그렇지 않습니다... 컨테이너가 해당 디바이스를 어떻게 사용하는지에 따라 다릅니다. 디바이스 파일은 일반 파일 및 디렉토리와 약간 다르며 (/dev 폴더 아래에서 일반 파일처럼 보이지만), 디바이스 파일은 디바이스 드라이버 및 물리 디바이스로의 인터페이스를 제공하므로 더 세분화된 액세스 제어가 있습니다. 이는 cgroups를 통해 관리되며(여기에서 더 읽을 수 있습니다).\n\n요약하면, 컨테이너가 특권 모드에서 실행되지 않는 경우에도 이 옵션을 통해 특정 디바이스 파일에 대한 컨테이너 액세스를 부여할 수 있습니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n우리 컴퓨터에 웹캠이 연결되어 있다고 가정해 봅시다.\n\n```bash\n$ lsusb -s 001:003\nBus 001 Device 003: ID 046d:0826 Logitech, Inc. HD Webcam C525\n```\n\n그리고 컨테이너 내부에서 웹캠을 사용하여 사진을 찍고 싶어합니다. 다음 시나리오를 고려해보세요:\n\n- 먼저, 옵션을 적용하지 않고 컨테이너 내부에서 웹캠에 액세스해보겠습니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: ccordeiro/fswebcam:armv7l\n    command: fswebcam -r 640x480 --jpeg 85 -D 1 picture.jpg\nEOF\n$ docker-compose up\n네트워크 \"tmp_default\"를 기본 드라이버로 생성중\ntmp_first_1 를 생성중... 완료\ntmp_first_1 에 연결중\nfirst_1  | --- /dev/video0 열기 중...\nfirst_1  | stat: 해당 파일 또는 디렉터리가 없습니다\nfirst_1  | tmp_first_1이 코드 0으로 종료되었습니다\n```\n\n…그러나 분명히 컨테이너에는 어떤 장치도 보이지 않습니다…\n\n- 두 번째로, 장치 파일을 바인드 마운트해 봅시다\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: ccordeiro/fswebcam:armv7l\n    command: fswebcam -r 640x480 --jpeg 85 -D 1 picture.jpg\n    volumes:\n     - /dev/video0:/dev/video0\nEOF\n$ docker-compose up\ntmp_first_1 재생성중... 완료\ntmp_first_1 에 연결중\nfirst_1  | --- /dev/video0 열기 중...\nfirst_1  | v4l2 모듈 시도 중...\nfirst_1  | 기기 열기 실패: /dev/video0\nfirst_1  | 열기: 작업을 허용하지 않습니다\nfirst_1  | v4l1 모듈 시도중...\nfirst_1  | 기기 열기 실패: /dev/video0\nfirst_1  | 열기: 작업을 허용하지 않습니다\nfirst_1  | /dev/video0을 읽을 수 있는 소스 모듈을 찾을 수 없습니다.\nfirst_1  | tmp_first_1이 코드 0으로 종료되었습니다\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n…음, 컨테이너는 보이지만 접근할 수 있는 권한이 없네요.\n\n- 마지막으로 장치를 사용해 봅시다\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: ccordeiro/fswebcam:armv7l\n    command: fswebcam -r 640x480 --jpeg 85 -D 1 picture.jpg\n    devices:\n     - /dev/video0:/dev/video0\nEOF\n$ docker-compose up\nRecreating tmp_first_1 ... done\nAttaching to tmp_first_1\nfirst_1  | --- Opening /dev/video0...\nfirst_1  | Trying source module v4l2...\nfirst_1  | /dev/video0 opened.\nfirst_1  | No input was specified, using the first.\nfirst_1  | Delaying 1 seconds.\nfirst_1  | --- Capturing frame...\nfirst_1  | Captured frame in 0.00 seconds.\nfirst_1  | --- Processing captured image...\nfirst_1  | Setting output format to JPEG, quality 85\nfirst_1  | Writing JPEG image to 'picture.jpg'.\nfirst_1  | tmp_first_1 exited with code 0\n```\n\n그리고 성공입니다!\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## network_mode\n\nDocker의 네트워킹 시스템은 네트워킹 드라이버에 기반하고 있는 것을 알고 계실 것입니다. 이 옵션을 사용하여 컨테이너가 실행되어야 하는 네트워크 모드를 지정할 수 있습니다.\n\n예를 들어, 기본 브릿지 네트워크에 1개의 컨테이너를, 호스트 네트워크에 1개의 컨테이너를, 첫 번째 컨테이너와 동일한 네트워크에 1개의 컨테이너를, 그리고 어떤 네트워크도 없는 상태로 1개의 컨테이너를 배포하려고 합니다. 아래는 이를 수행하는 방법입니다:\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: sh -c 'ifconfig eth0 \u0026\u0026 sleep 5'\n    network_mode: bridge\n  second:\n    image: alpine\n    command: ifconfig eth0\n    network_mode: host\n  third:\n    image: alpine\n    command: ifconfig eth0\n    depends_on:\n     - first\n    network_mode: service:first\n  fourth:\n    image: alpine\n    command: ifconfig eth0\n    network_mode: none\nEOF\n$ docker-compose up\nCreating mediumcom_first_1  ... done\nCreating mediumcom_fourth_1 ... done\nCreating mediumcom_second_1 ... done\nCreating mediumcom_third_1  ... done\nAttaching to mediumcom_second_1, mediumcom_fourth_1, mediumcom_first_1, mediumcom_third_1\nfirst_1   | eth0      Link encap:Ethernet  HWaddr 02:42:AC:11:00:02\nfirst_1   |           inet addr:172.17.0.2  Bcast:172.17.255.255  Mask:255.255.0.0\n...\nfourth_1  | ifconfig: eth0: error fetching interface information: Device not found\n...\nsecond_1  | eth0      Link encap:Ethernet  HWaddr 02:50:00:00:00:01\nsecond_1  |           inet addr:192.168.65.3  Bcast:192.168.65.255  Mask:255.255.255.0\n...\nthird_1   | eth0      Link encap:Ethernet  HWaddr 02:42:AC:11:00:02\nthird_1   |           inet addr:172.17.0.2  Bcast:172.17.255.255  Mask:255.255.0.0\n...\nmediumcom_fourth_1 exited with code 1\nmediumcom_second_1 exited with code 0\nmediumcom_third_1 exited with code 0\nmediumcom_first_1 exited with code 0\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n그래서, 무슨 일이 있었나요? 이를 간단히 살펴보겠습니다:\n\n- 첫 번째 컨테이너는 브리지 모드로 들어가서 자체 eth0 개인 네트워크 인터페이스를 할당 받았습니다(IP 172.17.0.2로, Docker 브리지 서브넷의 일부입니다).\n- 두 번째 컨테이너는 호스트 모드로 들어가서 호스트와 동일한 네트워크 수준에서 실행되므로 호스트의 모든 네트워킹 인터페이스를 볼 수 있습니다.\n- 세 번째 컨테이너는 첫 번째 것과 동일한 네트워크를 받았습니다.\n- 네 번째 컨테이너는 네트워크가 없어 eth0 인터페이스를 찾지 못하여 실패했습니다.\n\n## 네트워크\n\n이제 위에서 언급한 옵션을 활용하여, 컨테이너를 사용자 정의 네트워크에 연결하려면 어떻게 해야 하나요(기존 네트워크 또는 새로 생성한 것 중)? 그럴 때는 networks를 사용하세요:\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\n$ docker network create cjdc-test\n0f5e35bf6b8d396c45c19545540957fbc5fa15ba1ca0e5fbca4add3802c7db6d\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: sleep 30\n    networks:\n     - new-net\n  second:\n    image: alpine\n    command: sleep 30\n    networks:\n     - cjdc-test\nnetworks:\n  new-net:\n  cjdc-test:\n    external: true\n    name: cjdc-test\nEOF\n$ docker-compose up -d\nCreating network \"mediumcom_new-net\" with the default driver\nCreating mediumcom_second_1 ... done\nCreating mediumcom_first_1  ... done\n$ docker inspect --format '{.NetworkSettings.Networks}' mediumcom_first_1\nmap[mediumcom_new-net:0xc0004d8f00]\n$ docker inspect --format '{.NetworkSettings.Networks}' mediumcom_second_1\nmap[cjdc-test:0xc0003e8f00]\n```\n\n## dns\n\nIt basically lets you define a custom DNS server for your container. Example:\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: cat /etc/resolv.conf\n    dns: 1.2.3.4\n    network_mode: bridge\nEOF\n$ docker-compose up\nRecreating mediumcom_first_1 ... done\nAttaching to mediumcom_first_1\nfirst_1  | nameserver 1.2.3.4\nmediumcom_first_1 exited with code 0\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n주의: 사용자 정의 네트워크에서는 DNS 옵션이 기본적으로 동작하지 않으므로 브릿지 네트워크가 필요합니다.\n\n## dns_search\n\n여기에서 사용자 맞춤 DNS 검색 도메인을 설정할 수 있습니다.\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: cat /etc/resolv.conf\n    dns_search: my.custom.dns\n    network_mode: bridge\nEOF\n$ docker-compose up\nRecreating mediumcom_first_1 ... done\nAttaching to mediumcom_first_1\nfirst_1  | search my.custom.dns\nfirst_1  | nameserver 192.168.65.5\nmediumcom_first_1 exited with code 0\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## env_file\n\n일반적으로 컨테이너 환경을 하나씩 설정하는 데 익숙할 수 있지만, 한 번에 이 작업을 수행하도록 대신 파일을 사용할 수 있습니다:\n\n```js\n$ cat \u003emy-env \u003c\u003cEOF\nVAR1=value\nMY_VAR_FROM_FILE=1\nFOO=BAR\nEOF\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: env\n    env_file:\n     - my-env\nEOF\n$ docker-compose up\nmediumcom_first_1 다시 만들기 ... 완료\nmediumcom_first_1에 연결\nfirst_1  | PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\nfirst_1  | HOSTNAME=157e34e4fc64\nfirst_1  | VAR1=value\nfirst_1  | MY_VAR_FROM_FILE=1\nfirst_1  | FOO=BAR\nfirst_1  | HOME=/root\nmediumcom_first_1 코드 0으로 종료\n```\n\n## environment\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n이를 통해 컴포즈 파일에서 컨테이너의 환경 변수를 하나씩 직접 설정할 수 있습니다.\n\n이 방법을 사용하여 env_file 옵션을 통해 로드되는 변수를 재정의할 수도 있습니다.\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: env\nEOF\n$ docker-compose up\nRecreating mediumcom_first_1 ... done\nAttaching to mediumcom_first_1\nfirst_1  | PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\nfirst_1  | HOSTNAME=68e909013198\nfirst_1  | NEW_VAR=yes\nfirst_1  | HOME=/root\nmediumcom_first_1 exited with code 0\n```\n\n## 노출\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n도커파일과 유사하게, 이 옵션은 컨테이너의 포트를 표시하고 다른 연결된 컨테이너에서 사용할 수 있도록 합니다.\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: sleep 20\n    expose:\n     - 9876\nEOF\n$ docker-compose up -d\nRecreating mediumcom_first_1 ... done\n$ docker ps\nCONTAINER ID   IMAGE     COMMAND      CREATED          STATUS          PORTS      NAMES\n3be377f4bf6c   alpine    \"sleep 20\"   18 seconds ago   Up 16 seconds   9876/tcp   mediumcom_first_1\n```\n\n## external_links\n\n옵션을 건너뛰어야 합니다. 왜냐하면 1) 이것은 레거시 옵션이기 때문에, 그리고 2) 동일한 결과를 얻기 위해 네트워크를 사용할 수 있습니다(즉, 컨테이너를 외부 네트워크에 포함되어 있지 않은 다른 컨테이너에 연결할 수 있습니다).\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## extra_hosts\n\n이 기능은 컨테이너의 /etc/hosts 파일에 새 항목을 추가할 수 있게 해줍니다. 예를 들어, 컨테이너가 \"localhost\"가 아닌 다른 이름으로 스스로를 호출하도록 하고 싶다면 다음과 같이 할 수 있습니다:\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: sh -c 'cat /etc/hosts; ping me -c 1'\n    extra_hosts:\n     - \"myself:127.0.0.1\"\n     - \"me:127.0.0.1\"\nEOF\n$ docker-compose up\nRecreating mediumcom_first_1 ... done\nAttaching to mediumcom_first_1\nfirst_1  | 127.0.0.1 localhost\nfirst_1  | ::1 localhost ip6-localhost ip6-loopback\nfirst_1  | fe00::0 ip6-localnet\nfirst_1  | ff00::0 ip6-mcastprefix\nfirst_1  | ff02::1 ip6-allnodes\nfirst_1  | ff02::2 ip6-allrouters\nfirst_1  | 127.0.0.1 myself\nfirst_1  | 127.0.0.1 me\nfirst_1  | 172.22.0.2 01d566c4380a\nfirst_1  | PING me (127.0.0.1): 56 data bytes\nfirst_1  | 64 bytes from 127.0.0.1: seq=0 ttl=64 time=1.192 ms\nfirst_1  |\nfirst_1  | --- me ping statistics ---\nfirst_1  | 1 packets transmitted, 1 packets received, 0% packet loss\nfirst_1  | round-trip min/avg/max = 1.192/1.192/1.192 ms\nmediumcom_first_1 exited with code 0\n```\n\n## healthcheck\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n당연히, 이것은 도커 파일 옵션과 매우 유사하게 작동합니다. 도커가 컨테이너가 \"healthy(건강한)\"인지 아닌지 평가하는 데 사용할 수 있는 사용자 정의 확인을 만들 수 있습니다.\n\n그러니까, /tmp에 medium.txt라는 파일이 있을 때만 우리 컨테이너가 건강한 것으로 간주됩니다.\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: sh -c 'touch /tmp/NOT_MY_FILE; sleep 10'\n    healthcheck:\n      test: \"[ -f /tmp/medium.txt ]\"\n      # run asap\n      interval: 1s\n      timeout: 5s\n      retries: 1\n      start_period: 0s\n  second:\n    image: alpine\n    command: sh -c 'touch /tmp/medium.txt; sleep 10'\n    healthcheck:\n      test: \"[ -f /tmp/medium.txt ]\"\n      # run asap\n      interval: 1s\n      timeout: 5s\n      retries: 1\n      start_period: 0s\nEOF\n$ docker-compose up -d\nRecreating mediumcom_first_1 ... done\nCreating mediumcom_second_1  ... done\n$ docker ps\nCONTAINER ID   IMAGE     COMMAND                  CREATED         STATUS                     PORTS     NAMES\nb8804cbb440d   alpine    \"sh -c 'touch /tmp/N…\"   4 seconds ago   Up 2 seconds (unhealthy)             mediumcom_first_1\n604a6880f3c6   alpine    \"sh -c 'touch /tmp/m…\"   4 seconds ago   Up 2 seconds (healthy)               mediumcom_second_1\n```\n\n그런데 여기서 볼 수 있듯이, 처음 것은 건강하지 않지만 두 번째는 건강하다고 나옵니다. 필요한 파일이 올바른 위치에 존재하기 때문입니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## 초기화\n\n이를 통해 Docker에게 컨테이너에 대한 init를 사용할지 여부를 알릴 수 있습니다. 참일 경우, Docker는 tini 기반의 docker-init이라는 init을 사용할 것입니다. 차이를 살펴봅시다:\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: ps -a\n    init: false\nEOF\n$ docker-compose up\nmediumcom_first_1 다시 생성 중... 완료\nmediumcom_first_1에 참여 중\nfirst_1  | PID   USER     TIME  COMMAND\nfirst_1  |     1 root      0:00 ps -a\nmediumcom_first_1은 코드 0으로 종료됨\n```\n\n그러나 초기화를 활성화하면 이와 같은 프로세스 래퍼를 얻게 되며, 이는 PID 1로 추가 기능이 있는 경우 (이 경우에는 docker-init)입니다:\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\nfirst:\nimage: alpine\ncommand: ps -a\ninit: true\nEOF\n$ docker-compose up\nStarting mediumcom_first_1 ... done\nAttaching to mediumcom_first_1\nfirst_1 | PID USER TIME COMMAND\nfirst_1 | 1 root 0:00 /sbin/docker-init -- ps -a\nfirst_1 | 8 root 0:00 ps -a\nmediumcom_first_1 exited with code 0\n\n## 격리\n\n리눅스의 경우, 이 옵션은 항상 기본값으로 설정됩니다. 윈도우의 경우 더 많은 옵션이 있지만, 아쉽게도 여러분을 위한 예제를 실행할 윈도우 머신이 없습니다 😛 윈도우 사용자분들 죄송해요!\n\n## 레이블\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n콘테이너에 레이블을 설정할 수 있는 이 옵션의 이름처럼:\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: sleep 10\n    labels:\n     - \"foo=bar\"\nEOF\n$ docker-compose up -d\nRecreating mediumcom_first_1 ... done\n$ docker ps --filter 'label=foo=bar'\nCONTAINER ID   IMAGE     COMMAND      CREATED          STATUS         PORTS     NAMES\n94e844176d76   alpine    \"sleep 10\"   30 seconds ago   Up 7 seconds             mediumcom_first_1\n```\n\n## 링크\n\n외부 링크에 대한 내용은 과거의 옵션을 건너뛰겠습니다. 컨테이너 간 통신은 사용자 정의 네트워크로 쉽게 설정할 수 있습니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## 로깅\n\n실제로 이 옵션이 매우 중요하다고 생각해요. 대부분의 사용자들은 보통 컨테이너 애플리케이션 로그의 크기가 계속해서 커지고 있다는 사실에 충분한 주의를 기울이지 않습니다. 호스트 공간이 시간이 지남에 따라 가득 차지 않기를 원한다면, 다른 애플리케이션과 마찬가지로, 애플리케이션이 로그를 기록하는 방식도 제어해야 합니다. Docker를 통해 이 로깅 옵션을 사용하여 컨테이너 애플리케이션의 stdout 로그를 제어할 수 있습니다. 로깅 종류 뿐만 아니라 로깅 크기 제한 및 로테이션 매개변수도 제어할 수 있습니다:\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: sh -c 'while true; do echo `date`; done'\n    logging:\n      options:\n        max-size: \"50k\"\n        max-file: \"10\"\nEOF\n$ docker-compose up -d\ntmp_first_1을 다시 생성 중... 완료됨\n$ docker ps -f 'name=tmp_first_1'\nCONTAINER ID   IMAGE     COMMAND                  CREATED         STATUS         PORTS     NAMES\n2ea63dd32607   alpine    \"sh -c 'while true; …\"   2 minutes ago   Up 2 minutes             tmp_first_1\n$\n$ du -h /var/lib/docker/containers/2ea63dd32607*/*log*\n20K /var/lib/docker/containers/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60-json.log\n52K /var/lib/docker/containers/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60-json.log.1\n52K /var/lib/docker/containers/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60-json.log.2\n52K /var/lib/docker/containers/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60-json.log.3\n52K /var/lib/docker/containers/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60-json.log.4\n52K /var/lib/docker/containers/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60-json.log.5\n52K /var/lib/docker/containers/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60-json.log.6\n52K /var/lib/docker/containers/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60-json.log.7\n52K /var/lib/docker/containers/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60-json.log.8\n52K /var/lib/docker/containers/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60-json.log.9\n```\n\n그러니까 이 예제에서 볼 수 있듯이, Docker는 최대 10개의 로그 파일만 유지하고, 그 크기가 우리가 원하는 50 Kibibytes(= 52K)를 초과하지 않는 것을 확인할 수 있어요.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## PID\n\n요청 시, 컨테이너가 호스트와 PID 주소 공간을 공유할 수 있도록 설정할 수 있습니다. 이를 가능하게 하는 옵션은 다음과 같습니다:\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: ps -a\n    pid: \"host\"\n  second:\n    image: alpine\n    command: ps -a\nEOF\n$ docker-compose up\nCreating network \"mediumcom_default\" with the default driver\nCreating mediumcom_second_1 ... done\nCreating mediumcom_first_1  ... done\nAttaching to mediumcom_second_1, mediumcom_first_1\nsecond_1  | PID   USER     TIME  COMMAND\nsecond_1  |     1 root      0:00 ps -a\nfirst_1   | PID   USER     TIME  COMMAND\nfirst_1   |     1 root      0:07 /sbin/init\nfirst_1   |     2 root      0:00 [kthreadd]\nfirst_1   |     3 root      0:00 [rcu_gp]\nfirst_1   |     4 root      0:00 [rcu_par_gp]\nfirst_1   |     6 root      0:00 [kworker/0:0H-ev]\nfirst_1   |     8 root      0:00 [mm_percpu_wq]\nfirst_1   |     9 root      0:00 [rcu_tasks_rude_]\nfirst_1   |    10 root      0:00 [rcu_tasks_trace]\nfirst_1   |    11 root      0:22 [ksoftirqd/0]\nfirst_1   |    12 root      0:10 [rcu_sched]\nfirst_1   |    13 root      0:07 [migration/0]\nfirst_1   |    15 root      0:00 [cpuhp/0]\nfirst_1   |    16 root      0:00 [cpuhp/1]\n...\n```\n\n이것은 컨테이너 내에서 호스트 프로세스를 관리하고(포함하여 종료)할 수 있다는 의미이므로 이 옵션을 사용할 때 주의해야 합니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## 포트\n\n가장 인기 있는 옵션 중 하나인 이 기능을 사용하면 컨테이너 내부의 포트를 호스트로 게시할 수 있습니다 (컨테이너가 이미 \"호스트\" 모드에서 실행 중이지 않은 경우).\n\n예를 들어, 다음과 같이 게시하려는 경우를 생각해 봅시다:\n\n- 포트 3000을 임의의 포트로\n- 포트 범위 3005부터 3010까지\n- 로컬호스트의 포트 80을 포트 80으로만\n- 모든 호스트 인터페이스의 포트 443을 포트 443으로\n- 호스트의 포트 3011을 UDP만을 사용하여 포트 9876로\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: sleep 10\n    ports:\n     - 3000\n     - 3005-3010\n     - 127.0.0.1:80:80\n     - 443:443\n     - 9876:3011/udp\nEOF\n$ docker-compose up -d\n중복 컨테이너 \"mediumcom_second_1\"를 제거하는 중\nmediumcom_first_1이 시작되었습니다. ... 완료\n$ docker ps --format '{.Ports}'\n127.0.0.1:80-\u003e80/tcp, 0.0.0.0:443-\u003e443/tcp, 0.0.0.0:61290-\u003e3000/tcp, 0.0.0.0:61292-\u003e3005/tcp, 0.0.0.0:61293-\u003e3006/tcp, 0.0.0.0:61294-\u003e3007/tcp, 0.0.0.0:61295-\u003e3008/tcp, 0.0.0.0:61296-\u003e3009/tcp, 0.0.0.0:61291-\u003e3010/tcp, 0.0.0.0:9876-\u003e3011/udp\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## 프로필\n\n\"프로필\"은 컴포즈 파일 내에서 역할을 분리할 수 있는 멋진 제어 메커니즘입니다. 우리가 컴포즈 파일 내에서 일부 컨테이너가 매우 특정한 설정하에서만 실행되거나 필요할 때만 실행되도록 원한다고 가정해 봅시다 (즉, \"프로필\"이라고도 함). 이것이 할 수 있는 것입니다:\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: nginx\n  second:\n    image: alpine\n    command: wget http://first\n    profiles: [\"debug\"]\nEOF\n$ docker-compose up -d\n네트워크 \"mediumcom_default\"를 기본 드라이버로 생성 중\nmediumcom_first_1 생성 완료\n$ # 보세요? nginx 컨테이너만 시작되었습니다. 이제 \"debug\"를 활성화해 봅시다\n$ docker-compose --profile debug up\nmediumcom_first_1 is up-to-date\nmediumcom_second_1 생성 완료\nmediumcom_first_1, mediumcom_second_1에 첨부\nsecond_1  | first(172.26.0.2:80)에 연결 중\nsecond_1  | 'index.html' 저장 중\nsecond_1  | index.html           100% |********************************|   615  0:00:00 남음\nsecond_1  | 'index.html' 저장됨\nfirst_1   | /docker-entrypoint.sh: /docker-entrypoint.d/가 비어 있지 않으므로 구성을 시도할 것입니다\n(first_이하 생략)\nmediumcom_second_1이 코드 0으로 종료됨\n```\n\n## 재시작\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n컨테이너의 재시작 정책을 정의하는 방법입니다 (no, always, unless-stopped, on-failure 중 하나를 선택).\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    restart: on-failure\n    command: sleep 4\n  second:\n    image: alpine\n    command: echo Hi `date`\n    restart: always\nEOF\n$ docker-compose up\nCreating network \"mediumcom_default\" with the default driver\nCreating mediumcom_first_1  ... done\nCreating mediumcom_second_1 ... done\nAttaching to mediumcom_first_1, mediumcom_second_1\nsecond_1  | Hi Tue Feb 1 17:21:11 CET 2022\nmediumcom_second_1 exited with code 0\nsecond_1  | Hi Tue Feb 1 17:21:11 CET 2022\nsecond_1  | Hi Tue Feb 1 17:21:11 CET 2022\nmediumcom_second_1 exited with code 0\nsecond_1  | Hi Tue Feb 1 17:21:11 CET 2022\nsecond_1  | Hi Tue Feb 1 17:21:11 CET 2022\nsecond_1  | Hi Tue Feb 1 17:21:11 CET 2022\nmediumcom_second_1 exited with code 0\nsecond_1  | Hi Tue Feb 1 17:21:11 CET 2022\nsecond_1  | Hi Tue Feb 1 17:21:11 CET 2022\nsecond_1  | Hi Tue Feb 1 17:21:11 CET 2022\nsecond_1  | Hi Tue Feb 1 17:21:11 CET 2022\nmediumcom_first_1 exited with code 0\n```\n\n## 보안 설정\n\n이 옵션을 사용하면 컨테이너의 SELinux 레이블을 제어할 수 있습니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```bash\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: sleep 30\n    security_opt:\n     - label:user:USER\n  second:\n    image: alpine\n    command: sleep 30\nEOF\n$ docker inspect mediumcom_first_1 --format '{ .Id }: SecurityOpt={ .HostConfig.SecurityOpt }'\n2808e4b2ac6a6870b372ecf06da5ce0217efdd6d14df16cef4b332e1d4fb9b6a: SecurityOpt=[label:user:USER]\n$\n$ docker inspect mediumcom_second_1 --format '{ .Id }: SecurityOpt={ .HostConfig.SecurityOpt }'\ned4c417b27257cc9f793d5d3dad94672074859dba90effddd0cde49f12dd4115: SecurityOpt=\u003cno value\u003e\n```\n\n## stop_grace_period\n\n기본적으로 Docker는 SIGTERM을 수신한 후 10초 내에 컨테이너가 자연스럽게 중지되지 않으면 컨테이너를 강제로 종료합니다 (예: docker stop으로 컨테이너를 의도적으로 중지시킨 후). 이 시간 간격을 stop grace period라고 하며 구성할 수 있습니다.\n\n```bash\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: sh -c 'while true; do sleep 5 \u0026 done'\n  second:\n    image: alpine\n    command: sh -c 'while true; do sleep 5 \u0026 done'\n    stop_grace_period: 1s\nEOF\n$ docker-compose up -d\nRecreating mediumcom_first_1  ... done\nRecreating mediumcom_second_1 ... done\n$ time docker stop mediumcom_first_1\nmediumcom_first_1\nreal 0m10.847s\nuser 0m0.205s\nsys 0m0.092s\n$ time docker stop mediumcom_second_1\nmediumcom_second_1\nreal 0m1.883s\nuser 0m0.192s\nsys 0m0.105s\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## stop_signal\n\n앞서 언급한 옵션에서 SIGTERM이 도커 컨테이너를 중지하는 기본 신호임을 이미 알았을 것입니다. 그러나 여러분은 `docker stop`이 컨테이너 응용 프로그램으로 원하는 사용자 정의 신호를 전송하도록 변경할 수 있습니다:\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: sleep 60\n    stop_signal: SIGUSR1\nEOF\n$ docker-compose up -d\nCreating network \"mediumcom_default\" with the default driver\nCreating mediumcom_first_1 ... done\n$ docker inspect mediumcom_first_1 --format '{.Config.StopSignal}'\nSIGUSR1\n```\n\n## sysctls\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n이 옵션은 컨테이너의 네임스페이스된 커널 매개변수를 런타임에서 구성할 수 있게 합니다.\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: sleep 60\n    sysctls:\n      net.core.somaxconn: 1024\n      net.ipv4.tcp_syncookies: 0\nEOF\n$ docker-compose up -d\n네트워크 \"mediumcom_default\" 생성 중, 기본 드라이버로 설정\nmediumcom_first_1 생성 중... 완료\n$ docker inspect mediumcom_first_1 --format '{json .HostConfig.Sysctls}'\n{\"net.core.somaxconn\": \"1024\", \"net.ipv4.tcp_syncookies\": \"0\"}\n```\n\n## ulimits\n\n컨테이너의 기본 ulimits를 재정의할 수 있게 합니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: sleep 60\n    ulimits:\n      nproc: 65535\n      nofile:\n        soft: 20000\n        hard: 40000\nEOF\n$ docker-compose up -d\nRecreating mediumcom_first_1 ... done\n$ docker inspect mediumcom_first_1 --format '{json .HostConfig.Ulimits}'\n[{\"Name\":\"nproc\",\"Hard\":65535,\"Soft\":65535},{\"Name\":\"nofile\",\"Hard\":40000,\"Soft\":20000}]\n```\n\n## userns_mode\n\n너무 깊게 파고들지 않고 Docker 데몬에서 사용자 네임스페이스를 활성화한 경우, 단일 컨테이너에서 사용자 네임스페이스를 비활성화하게 하는 옵션입니다. `userns_mode: \"host\"`를 사용하면 됩니다.\n\n## user\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n컨테이너 응용프로그램이 특정 사용자로 실행되도록 하려면 어떻게 하시겠습니까?\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: whoami\n    user: nobody\nEOF\n$ docker-compose up\nRecreating mediumcom_first_1 ... done\nAttaching to mediumcom_first_1\nfirst_1  | nobody\nmediumcom_first_1 exited with code 0\n```\n\n## working_dir\n\n도커 파일에서 본 적이 있을 것입니다. 이를 사용하면 컨테이너의 랜딩 경로(PWD)를 재정의할 수 있습니다. 이를 통해 엔트리포인트와 명령이 절대 경로를 사용하지 않는 경우에도 동작을 변경할 수 있습니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: pwd\n    working_dir: /my/custom/medium/dir\nEOF\n$ docker-compose up\nmediumcom_first_1 컨테이너 다시 생성 중... 완료\nmediumcom_first_1에 연결 중\nfirst_1  | /my/custom/medium/dir\nmediumcom_first_1 코드 0으로 종료됨\n```\n\n## 도메인 이름\n\n당신의 컨테이너는 호스트명과 도메인명을 가지고 있다는 것을 아시죠. 호스트 모드가 아닐 때, 호스트명은 컨테이너의 ID와 동일하며, 도메인명은 예상대로 없을 것입니다. 도메인명을 설정하려면 다음과 같이 하세요:\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: hostname -f\n    domainname: cristovaocordeiro.medium.com\nEOF\n$ docker-compose up\nmediumcom_first_1 컨테이너 다시 생성 중... 완료\nmediumcom_first_1에 연결 중\nfirst_1  | 6e900c697939.cristovaocordeiro.medium.com\nmediumcom_first_1 코드 0으로 종료됨\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## 호스트이름\n\n당연히 도메인 이름을 설정할 수 있다면 컨테이너의 호스트 이름도 설정할 수 있습니다. 이렇게 하면 기본적으로 제공되는 \"충격적인\" ID 형식 대신 호스트 이름을 사용할 수 있습니다 😜\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: hostname -f\n    hostname: test-container\nEOF\n$ docker-compose up\nRecreating mediumcom_first_1 ... done\nAttaching to mediumcom_first_1\nfirst_1  | test-container\nmediumcom_first_1 exited with code 0\n```\n\n## ipc\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n컨테이너의 프로세스 간 통신을 관리할 수 있습니다(성능 조정 목적). 이 옵션을 통해 컨테이너의 IPC 네임스페이스를 설정할 수 있습니다.\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: sleep 30\n    ipc: shareable\nEOF\n$ docker inspect mediumcom_first_1 --format '{json .HostConfig.IpcMode}'\n\"shareable\"\n```\n\n## mac_address\n\n원하는 컨테이너에 사용자 정의 MAC 주소를 설정할 수도 있습니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\n버전: \"3\"\n서비스:\n  first:\n    이미지: alpine\n    명령: ifconfig eth0\n    mac_address: 00:ab:cd:12:34:56\nEOF\n$ docker-compose up\nmediumcom_first_1 컨테이너 다시 생성 중... 완료\nmediumcom_first_1에 연결 중\nfirst_1  | eth0 Link encap:Ethernet  HWaddr 00:AB:CD:12:34:56  \nfirst_1  | inet addr:172.29.0.2 Bcast:172.29.255.255 Mask:255.255.0.0\nfirst_1  | UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1\nfirst_1  | RX packets:2 errors:0 dropped:0 overruns:0 frame:0\nfirst_1  | TX packets:0 errors:0 dropped:0 overruns:0 carrier:0\nfirst_1  | collisions:0 txqueuelen:0 \nfirst_1  | RX bytes:200 (200.0 B)  TX bytes:0 (0.0 B)\nfirst_1  |\nmediumcom_first_1가 코드 0으로 종료됨\n```\n\n## 특권적\n\n위에서 \"특권적\" 컨테이너 상태를 몇 번 다뤘습니다. 간단히 말하면, (!!) 확실히 확신이 있고 컨테이너에 가능한 모든 기능을 부여하고 싶다면 (따라서 호스트 장치 및 기타 자원에 액세스 할 수 있음), 이 옵션을 사용할 수 있습니다.\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\n버전: \"3\"\n서비스:\n  first:\n    이미지: alpine\n    명령: sh -c 'ls /dev/ | wc -l'\n  second:\n    이미지: alpine\n    명령: sh -c 'ls /dev/ | wc -l'\n    특권적: true\nEOF\n$ docker-compose up\nmediumcom_first_1 컨테이너 다시 생성 중... 완료\nmediumcom_second_1 컨테이너 다시 생성 중... 완료\nmediumcom_first_1에 연결 중, mediumcom_second_1에 연결 중\nfirst_1  | 15\nsecond_1  | 150\nmediumcom_first_1가 코드 0으로 종료됨\nmediumcom_second_1가 코드 0으로 종료됨\n```\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## 읽기 전용\n\n컨테이너를 실행할 때 읽기 전용 이미지 레이어 위에 쓰기 가능한 레이어가 생성된다는 사실을 알고 계실 겁니다. 그러나 이 쓰기 가능한 레이어를 읽기 전용으로 바꿀 수도 있습니다.\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: touch /tmp/test\n  second:\n    image: alpine\n    command: touch /tmp/test\n    read_only: true\nEOF\n$ docker-compose up\nmediumcom_first_1  ... done\nmediumcom_second_1 ... done\nmediumcom_first_1, mediumcom_second_1에 연결 중\nsecond_1  | touch: /tmp/test: 읽기 전용 파일 시스템\nmediumcom_first_1 코드 0으로 종료\nmediumcom_second_1 코드 1로 종료\n```\n\n## shm_size\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n컨테이너가 사용할 수 있는 공유 메모리 양을 지정할 수 있습니다.\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: df -h /dev/shm\n    shm_size: 123M\nEOF\n$ docker-compose up\nmediumcom_first_1 컨테이너를 다시 생성 중... 완료\nmediumcom_first_1에 연결 중\nfirst_1  | 파일 시스템                크기      사용함 사용 가능함 사용률 마운트된 위치\nfirst_1  | shm                     123.0M         0    123.0M   0% /dev/shm\nmediumcom_first_1은 코드 0으로 종료됨\n```\n\n## stdin_open\n\n이는 docker run의 -i에 해당합니다. 이를 사용하여 호스트와 컨테이너 간 상호작용이 가능한 인터랙티브 세션을 만들 수 있습니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```bash\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    stdin_open: true\nEOF\n$ docker-compose up -d\nRecreating mediumcom_first_1 ... done\n$ docker attach mediumcom_first_1\necho Hello, I am sending commands to the container\nHello, I am sending commands to the container\nexit\n```\n\n위와 같이 컨테이너와 상호 작용하고 있지만 호스트와 컨테이너 사이에 실제로 터미널 세션이 없습니다... 간단히 말해서 파이프일 뿐입니다.\n\n## tty\n\n이것은 도커 실행에서의 -t와 동등합니다. 컨테이너에 가상 tty를 할당하고 stdin_open과 결합할 때 유용합니다.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\n$ cat \u003edocker-compose.yml \u003c\u003cEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    stdin_open: true\n    tty: true\nEOF\n$ docker-compose up -d\nmediumcom_first_1 컨테이너를 다시 생성합니다... 완료\n$ docker attach mediumcom_first_1\n/ # echo now this is a real terminal\nnow this is a real terminal\n/ # sleep 5\n^C\n/ # echo $?\n130\n/ # exit\n```\n\n이제 우리는 실제 터미널과 상호 작용하는 세션을 가지고 있습니다. 컨테이너 안에서 원하는 일을 할 수 있어요.\n\n우와... 정말 긴 기사였죠. 죄송합니다. 밝은 면에서 말하면, 여러 기사를 넘나들며 다양한 컴포즈 파일 옵션이 무엇을 하는지 찾아보지 않아도 되겠죠?\n\n스웜 모드에서 서비스에 특정한 옵션(변수 치환 및 확장 필드 같은 고유한 구조적 노하우)을 일부 뺐습니다. 이것들은 선택 사항이며, 다른 기사에서 다룰 수 있어요.\n\n\u003c!-- ui-station 사각형 --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n이 테이블 태그를 마크다운 형식으로 변경해드렸습니다.\n","ogImage":{"url":"/assets/img/2024-06-23-TheWholeShebangComposeFiles_0.png"},"coverImage":"/assets/img/2024-06-23-TheWholeShebangComposeFiles_0.png","tag":["Tech"],"readingTime":55},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cimg src=\"/assets/img/2024-06-23-TheWholeShebangComposeFiles_0.png\"\u003e\n\u003cp\u003e요즘 Docker 및 컨테이너에 대해 많이 쓰고 가르치고 있습니다. 내 컨텐츠를 소비하고 피드백을 제공해 주시는 여러분들에게 매우 감사합니다. 여러분의 의견을 듣고 다음 주제는 당연히 Docker Compose입니다. 왜냐하면 이제 여러분은 자신의 컨테이너 이미지를 만들고 실행하는 방법을 알고 있으므로, 다음으로 논리적으로 남은 일은 복잡한 멀티 컨테이너 애플리케이션을 만들고 그 모든 것을 단일 소프트웨어로 관리하는 것입니다.\u003c/p\u003e\n\u003ch1\u003eDocker Compose: 그게 뭔데, 왜 필요한가요?\u003c/h1\u003e\n\u003cp\u003e공식 문서에서 더 많은 정보를 확인할 수 있지만, 간단히 말하면 다음과 같습니다: Docker를 사용하여 컨테이너, 이미지, 볼륨 등을 관리합니다. docker run을 실행하면 기본적으로 단일 컨테이너를 실행하는 것입니다. 만약 첫 번째 컨테이너와 상호 작용하는 두 번째 컨테이너를 시작하려면 docker run을 다시 실행해야 하며, 볼륨 및 네트워크를 별도로 처리하여 서로를 보고 통신할 수 있도록 해야 합니다.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e도커 컴포즈는 도커 위에 래퍼를 제공하여 이 모든 것을 추상화합니다 (맞아요! 도커 컴포즈는 단순히 도커를 위한 고수준 CLI입니다). 실제로 대부분의 옵션이 docker run 하위 명령어에서 사용 가능한 옵션들과 매우 유사한 방식으로 명명됩니다.\u003c/p\u003e\n\u003cp\u003e도커 컴포즈를 사용하면 YAML 파일인 컴포즈 파일을 통해 컨테이너(도커 컴포즈 세계에서는 서비스라고 불립니다... 단지 스웜 모드에서도 컴포즈 파일을 사용할 수 있기 때문에... 다른 글에서 설명할 예정), 볼륨 및 네트워크를 포함한 모든 것을 선언적으로 정의할 수 있습니다. 이렇게 하면 멀티 컨테이너 애플리케이션을 관리해야 할 때, 이 compose 파일만 건드리고 나머지는 도커 컴포즈가 모두 처리하도록 할 수 있습니다.\u003c/p\u003e\n\u003ch1\u003e컴포즈 파일\u003c/h1\u003e\n\u003cp\u003e우선, 멀티 컨테이너 애플리케이션을 올바르게 운영하려면 컴포즈 파일을 작성하는 방법을 익혀야 하므로 도커 컴포즈 CLI에 대해서는 다른 글에서 다룰 예정입니다.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e도커의 구성 파일 관련 문서는 매우 완벽하지만, 저는 실용주의와 경험으로부터 배우는 것을 중요하게 생각하는 사람이라서 모든 Compose 파일 옵션을 손질하고 명료한 설명과 실제 예시를 담아내려고 합니다. 여기서 시작해봅시다!\u003c/p\u003e\n\u003cp\u003e참고 1: 이 기사를 작성하는 시점에서 최신 버전인 v3의 Compose 파일 명세에 대한 옵션과 스키마만 다룰 예정입니다. 그러니 걱정하지 마세요.\u003c/p\u003e\n\u003cp\u003e참고 2: 각 옵션에 대해 일반적으로 사용되는 방법에 대한 설명과 예시만 제공할 것이며, 특정 옵션 매개변수를 사용해본 적이 없는 경우에는 \"일반적이지 않음\"으로 간주할 것입니다. 어떤 옵션의 적은 사용 방법 및 일반적이지 않은 매개변수를 더 자세히 알고 싶다면 공식 문서를 참조해주세요.\u003c/p\u003e\n\u003cp\u003e예시에 들어가기 전에, 모든 구성 파일은 작성하는 현재의 파일 스키마를 나타내는 키워드 version으로 시작됩니다. 앞서 말한대로, 저희는 최신 (버전: \"3\")을 사용할 것입니다.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch2\u003e빌드\u003c/h2\u003e\n\u003cp\u003e기본적으로 Docker Compose로 무언가를 시작할 때, Docker 이미지 또는 Dockerfile을 제공할 수 있습니다. 해당 컨테이너를 시작하기 전에 Docker가 이미지를 직접 빌드하도록 하고 싶다면 수동으로 이미지를 빌드하지 않고도 이 옵션을 사용할 수 있습니다.\u003c/p\u003e\n\u003cp\u003e예를 들어:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003e\u003cspan class=\"hljs-title class_\"\u003eDockerfile\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n# 이것은 \u003cspan class=\"hljs-title class_\"\u003eDockerfile\u003c/span\u003e입니다\n\u003cspan class=\"hljs-variable constant_\"\u003eFROM\u003c/span\u003e ubuntu\n\u003cspan class=\"hljs-variable constant_\"\u003eCMD\u003c/span\u003e [\u003cspan class=\"hljs-string\"\u003e\"echo\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"Hello Medium readers\"\u003c/span\u003e]\n# \u003cspan class=\"hljs-title class_\"\u003eDockerfile\u003c/span\u003e 끝\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$\n$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  my-test-\u003cspan class=\"hljs-attr\"\u003econtainer\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003ebuild\u003c/span\u003e: .\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$\n$ docker-compose up\n디폴트 드라이버를 사용하여 \u003cspan class=\"hljs-string\"\u003e\"mediumcom_default\"\u003c/span\u003e 네트워크 생성 중\nmy-test-container 빌드 중\n\u003cspan class=\"hljs-title class_\"\u003eDocker\u003c/span\u003e 데몬으로 빌드 컨텍스트 보내는 중  \u003cspan class=\"hljs-number\"\u003e1.\u003c/span\u003e337MB\n단계 \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e : \u003cspan class=\"hljs-variable constant_\"\u003eFROM\u003c/span\u003e ubuntu\n ---\u003e ba6acccedd29\n단계 \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e : \u003cspan class=\"hljs-variable constant_\"\u003eCMD\u003c/span\u003e [\u003cspan class=\"hljs-string\"\u003e\"echo\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"Hello Medium readers\"\u003c/span\u003e]\n ---\u003e 캐시 사용 중\n ---\u003e 6c8b22fa650c\n성공적으로 빌드되었습니다 6c8b22fa650c\nmediumcom_my-test-\u003cspan class=\"hljs-attr\"\u003econtainer\u003c/span\u003e:latest로 성공적으로 태깅되었습니다\nmediumcom_my-test-container_1 생성 중 ... 완료\nmediumcom_my-test-container_1에 연결 중\nmy-test-container_1  | \u003cspan class=\"hljs-title class_\"\u003eHello\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eMedium\u003c/span\u003e readers\nmediumcom_my-test-container_1는 코드 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e으로 종료됨\n$\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e보시다시피, Docker Compose는 Docker에게 도커파일(컴포즈 파일과 동일한 경로에 위치)로부터 이미지를 빌드하도록 지시하고, 그 후에 자동으로 컨테이너를 시작했습니다.\u003c/p\u003e\n\u003cp\u003e참고: 일반적으로 docker build와 함께 사용하는 일부 옵션들(빌드 인자 전달, Dockerfile의 경로 및 이름 지정 등)도 여기에서 사용할 수 있습니다. 자세한 내용은 문서를 확인해주세요.\u003c/p\u003e\n\u003ch2\u003e이미지\u003c/h2\u003e\n\u003cp\u003e어플리케이션을 실행할 때마다 Docker 이미지를 빌드할 필요는 없겠죠... 그렇게 하면 불편하겠죠. 따라서 이미지를 미리 빌드하거나 간단히 컨테이너 이미지를 지정하면 됩니다.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e예를 들어, 이전 예제의 Dockerfile과 다음의 compose 파일을 살펴보세요:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ # 이전 예제 정리하기 위함\n$ # 이제부터 각 예제에서 다음 명령 실행해주세요\n$ docker-compose down -v --remove-orphans\n$\n$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003ebuild\u003c/span\u003e: .\n  \u003cspan class=\"hljs-attr\"\u003esecond\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: hello-world\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ # \u003cspan class=\"hljs-title class_\"\u003eDockerfile\u003c/span\u003e이 변경되지 않았기 때문에 첫 번째 이미지가 다시 빌드되지 않습니다\n$ docker-compose up\n네트워크 \u003cspan class=\"hljs-string\"\u003e\"mediumcom_default\"\u003c/span\u003e 생성 중\nmediumcom_first_1  ... 생성됨\nmediumcom_second_1 ... 생성됨\nmediumcom_second_1, mediumcom_first_1에 연결 중\nfirst_1   | \u003cspan class=\"hljs-title class_\"\u003eHello\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eMedium\u003c/span\u003e readers\nsecond_1  |\nsecond_1  | \u003cspan class=\"hljs-title class_\"\u003eHello\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eDocker\u003c/span\u003e!\nsecond_1  | \u003cspan class=\"hljs-title class_\"\u003eThis\u003c/span\u003e message shows that your installation appears to be working correctly.\nsecond_1  |\nsecond_1  | \u003cspan class=\"hljs-title class_\"\u003eTo\u003c/span\u003e generate \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e message, \u003cspan class=\"hljs-title class_\"\u003eDocker\u003c/span\u003e took the following \u003cspan class=\"hljs-attr\"\u003esteps\u003c/span\u003e:\nsecond_1  |  \u003cspan class=\"hljs-number\"\u003e1.\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eThe\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eDocker\u003c/span\u003e client contacted the \u003cspan class=\"hljs-title class_\"\u003eDocker\u003c/span\u003e daemon.\nsecond_1  |  \u003cspan class=\"hljs-number\"\u003e2.\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eThe\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eDocker\u003c/span\u003e daemon pulled the \u003cspan class=\"hljs-string\"\u003e\"hello-world\"\u003c/span\u003e image \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e the \u003cspan class=\"hljs-title class_\"\u003eDocker\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eHub\u003c/span\u003e.\nsecond_1  |     (amd64)\nsecond_1  |  \u003cspan class=\"hljs-number\"\u003e3.\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eThe\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eDocker\u003c/span\u003e daemon created a \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e container \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e that image which runs the\nsecond_1  |     executable that produces the output you are currently reading.\nsecond_1  |  \u003cspan class=\"hljs-number\"\u003e4.\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eThe\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eDocker\u003c/span\u003e daemon streamed that output to the \u003cspan class=\"hljs-title class_\"\u003eDocker\u003c/span\u003e client, which sent it\nsecond_1  |     to your terminal.\nsecond_1  |\nsecond_1  | \u003cspan class=\"hljs-title class_\"\u003eTo\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003etry\u003c/span\u003e something more ambitious, you can run an \u003cspan class=\"hljs-title class_\"\u003eUbuntu\u003c/span\u003e container \u003cspan class=\"hljs-attr\"\u003ewith\u003c/span\u003e:\nsecond_1  |  $ docker run -it ubuntu bash\nsecond_1  |\nsecond_1  | \u003cspan class=\"hljs-title class_\"\u003eShare\u003c/span\u003e images, automate workflows, and more \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e a free \u003cspan class=\"hljs-title class_\"\u003eDocker\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eID\u003c/span\u003e:\nsecond_1  |  \u003cspan class=\"hljs-attr\"\u003ehttps\u003c/span\u003e:\u003cspan class=\"hljs-comment\"\u003e//hub.docker.com/\u003c/span\u003e\nsecond_1  |\nsecond_1  | \u003cspan class=\"hljs-title class_\"\u003eFor\u003c/span\u003e more examples and ideas, \u003cspan class=\"hljs-attr\"\u003evisit\u003c/span\u003e:\nsecond_1  |  \u003cspan class=\"hljs-attr\"\u003ehttps\u003c/span\u003e:\u003cspan class=\"hljs-comment\"\u003e//docs.docker.com/get-started/\u003c/span\u003e\nsecond_1  |\nmediumcom_second_1이 코드 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e으로 종료됨\nmediumcom_first_1이 코드 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e으로 종료됨\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e여기서 보듯이, 이제 하나의 Compose 파일과 하나의 docker-compose 명령을 사용하여 동일한 다중 컨테이너 애플리케이션 내에서 병렬로 2개의 컨테이너를 실행했습니다. 하나의 컨테이너는 \"Hello Medium readers\"라고 말하는 사용자 지정 Docker 이미지를 사용했고, 다른 하나는 Docker Hub에서 \"hello-world\" 이미지를 가져와 자체 Hello World 메시지를 출력했습니다.\u003c/p\u003e\n\u003ch2\u003e명령\u003c/h2\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e이를 통해 컨테이너의 명령을 정의할 수 있습니다. 따라서 Docker 이미지에 entrypoint가 정의되어 있으면 이 명령이 해당 entrypoint의 인수가 됩니다. 예시:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: ubuntu\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: echo \u003cspan class=\"hljs-string\"\u003e\"I am at your command!\"\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up\n\u003cspan class=\"hljs-title class_\"\u003eCreating\u003c/span\u003e network \u003cspan class=\"hljs-string\"\u003e\"mediumcom_default\"\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e the \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e driver\n\u003cspan class=\"hljs-title class_\"\u003eCreating\u003c/span\u003e mediumcom_first_1 ... done\n\u003cspan class=\"hljs-title class_\"\u003eAttaching\u003c/span\u003e to mediumcom_first_1\nfirst_1  | I am at your command!\nmediumcom_first_1 exited \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e code \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e아주 간단하지요?\u003c/p\u003e\n\u003ch2\u003eentrypoint\u003c/h2\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e이름에서 알 수 있듯이 해당 기능은 컨테이너의 엔트리포인트를 재정의하게 해줍니다. 예를 들어, 컨테이너가 echo 실행 파일로 실행되도록 하려면 다음과 같이 작성할 수 있어요:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: ubuntu\n    \u003cspan class=\"hljs-attr\"\u003eentrypoint\u003c/span\u003e: [\u003cspan class=\"hljs-string\"\u003e\"echo\"\u003c/span\u003e]\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"I am just an arg\"\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up\n\u003cspan class=\"hljs-title class_\"\u003eCreating\u003c/span\u003e network \u003cspan class=\"hljs-string\"\u003e\"mediumcom_default\"\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e the \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e driver\n\u003cspan class=\"hljs-title class_\"\u003eCreating\u003c/span\u003e mediumcom_first_1 ... done\n\u003cspan class=\"hljs-title class_\"\u003eAttaching\u003c/span\u003e to mediumcom_first_1\nfirst_1  | I am just an arg\nmediumcom_first_1 exited \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e code \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e간단하지요? 그리고 command 대 entrypoint 등에 대해 궁금해 한다면 당신만이 아닙니다. 이것은 매우 일반적인 혼란 포인트입니다. 다른 기사 \"전부 다: Dockerfiles\"에서 이에 대해 이야기했어요. 간단히 말해서, 저는 이 두 옵션을 조율할 때 필요한 치트 시트를 제공합니다: \u003ca href=\"https://docs.docker.com/engine/reference/builder/#understand-how-cmd-and-entrypoint-interact\" rel=\"nofollow\" target=\"_blank\"\u003ehttps://docs.docker.com/engine/reference/builder/#understand-how-cmd-and-entrypoint-interact\u003c/a\u003e\u003c/p\u003e\n\u003ch2\u003ecap_add\u003c/h2\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e만약 컨테이너에 추가 기능이 필요한 경우, 다음과 같이 추가할 수 있어요:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: \u003cspan class=\"hljs-attr\"\u003eubuntu\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e14.04\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: ip link add dummy0 type dummy\n    \u003cspan class=\"hljs-attr\"\u003ecap_add\u003c/span\u003e:\n     - \u003cspan class=\"hljs-variable constant_\"\u003eNET_ADMIN\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up\n\u003cspan class=\"hljs-title class_\"\u003eRecreating\u003c/span\u003e mediumcom_first_1 ... done\n\u003cspan class=\"hljs-title class_\"\u003eAttaching\u003c/span\u003e to mediumcom_first_1\nmediumcom_first_1 exited \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e code \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e이제 위와 같은 컨테이너를 실행하려고 하지만 기능이 없는 경우, 에러가 발생할 거예요:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: \u003cspan class=\"hljs-attr\"\u003eubuntu\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e14.04\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: ip link add dummy0 type dummy\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up\n\u003cspan class=\"hljs-title class_\"\u003eRecreating\u003c/span\u003e mediumcom_first_1 ... done\n\u003cspan class=\"hljs-title class_\"\u003eAttaching\u003c/span\u003e to mediumcom_first_1\nfirst_1  | \u003cspan class=\"hljs-variable constant_\"\u003eRTNETLINK\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eanswers\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eOperation\u003c/span\u003e not permitted\nmediumcom_first_1 exited \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e code \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch2\u003ecap_drop\u003c/h2\u003e\n\u003cp\u003ecap_add의 정 반대입니다. 컨테이너에서 기능을 제거하는 데 사용됩니다. 예를 들어 슈퍼 권한이 부여된 컨테이너가 있다고 가정해보겠습니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: \u003cspan class=\"hljs-attr\"\u003eubuntu\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e14.04\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: ip link add dummy0 type dummy\n    \u003cspan class=\"hljs-attr\"\u003ecap_add\u003c/span\u003e:\n     - \u003cspan class=\"hljs-variable constant_\"\u003eALL\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up\n\u003cspan class=\"hljs-title class_\"\u003eRecreating\u003c/span\u003e mediumcom_first_1 ... done\n\u003cspan class=\"hljs-title class_\"\u003eAttaching\u003c/span\u003e to mediumcom_first_1\nmediumcom_first_1 exited \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e code \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e그러나 호스트 네트워크 스택을 관리하려고 하지 않는다면:\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-sh\"\u003e$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e \u003edocker-compose.yml \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-string\"\u003eEOF\nversion: \"3\"\nservices:\n  first:\n    image: ubuntu:14.04\n    command: ip link add dummy0 type dummy\n    cap_add:\n     - ALL\n    cap_drop:\n     - NET_ADMIN\nEOF\u003c/span\u003e\n$ docker-compose up\nmediumcom_first_1 컨테이너를 다시 생성하는 중... 완료\nmediumcom_first_1에 연결 중\nfirst_1 | RTNETLINK 답변: 작업을 수행할 수 없습니다\nmediumcom_first_1은 코드 2로 종료됨\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003ecgroup_parent\u003c/h2\u003e\n\u003cp\u003ecgroup에 대해 처음이라면 이곳에 관한 짧은 좋은 기사가 있습니다. 간단히 말해, Linux 커널은 제어 그룹 (cgroups)을 통해 프로세스별로 시스템 리소스의 사용량을 엄격하게 제어할 수 있는 기능을 제공합니다. Docker에서는 이를 통해 컨테이너가 특정 리소스를 얼마나 사용할 수 있는지 제어할 수 있습니다. 기본적으로 컨테이너는 가능한 많은 리소스를 사용하려고 시도할 것입니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-sh\"\u003e$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e \u003edocker-compose.yml \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-string\"\u003eEOF\nversion: \"3\"\nservices:\n  first:\n    image: ubuntu\n    command: sleep 30\nEOF\u003c/span\u003e\n$ docker-compose up -d\n기본 드라이버로 네트워크 \u003cspan class=\"hljs-string\"\u003e\"root_default\"\u003c/span\u003e를 생성 중\nroot_first_1 컨테이너 생성 중... 완료\n$ docker inspect root_first_1 --format \u003cspan class=\"hljs-string\"\u003e'{.HostConfig.CgroupParent}'\u003c/span\u003e\n$\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e보시는 대로, 기본적으로 컨테이너에 할당된 제어 그룹이 없습니다. 하지만 우리가 할당할 수 있습니다. 심지어 우리 자신의 것을 할당할 수도 있습니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cgcreate -g \u003cspan class=\"hljs-attr\"\u003ecpu\u003c/span\u003e:test-cgroup-medium\n$ ls /sys/fs/cgroup/cpu\ncgroup-limit           cgroup.\u003cspan class=\"hljs-property\"\u003esane_behavior\u003c/span\u003e  cpu.\u003cspan class=\"hljs-property\"\u003eshares\u003c/span\u003e    cpuacct.\u003cspan class=\"hljs-property\"\u003eusage\u003c/span\u003e         cpuacct.\u003cspan class=\"hljs-property\"\u003eusage_percpu_sys\u003c/span\u003e   cpuacct.\u003cspan class=\"hljs-property\"\u003eusage_user\u003c/span\u003e  release_agent  test-cgroup-medium\ncgroup.\u003cspan class=\"hljs-property\"\u003eclone_children\u003c/span\u003e  cpu.\u003cspan class=\"hljs-property\"\u003ecfs_period_us\u003c/span\u003e     cpu.\u003cspan class=\"hljs-property\"\u003estat\u003c/span\u003e      cpuacct.\u003cspan class=\"hljs-property\"\u003eusage_all\u003c/span\u003e     cpuacct.\u003cspan class=\"hljs-property\"\u003eusage_percpu_user\u003c/span\u003e  docker              system.\u003cspan class=\"hljs-property\"\u003eslice\u003c/span\u003e   user.\u003cspan class=\"hljs-property\"\u003eslice\u003c/span\u003e\ncgroup.\u003cspan class=\"hljs-property\"\u003eprocs\u003c/span\u003e           cpu.\u003cspan class=\"hljs-property\"\u003ecfs_quota_us\u003c/span\u003e      cpuacct.\u003cspan class=\"hljs-property\"\u003estat\u003c/span\u003e  cpuacct.\u003cspan class=\"hljs-property\"\u003eusage_percpu\u003c/span\u003e  cpuacct.\u003cspan class=\"hljs-property\"\u003eusage_sys\u003c/span\u003e          notify_on_release   tasks\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e그리고 이 옵션을 사용함으로써 이 컨테이너에서 CPU 사용량을 엄격하게 제어할 수 있게 될 것입니다. cgroup \"cpu:test-cgroup-medium\"을 통해:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: ubuntu\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: sleep \u003cspan class=\"hljs-number\"\u003e30\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003ecgroup_parent\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"cpu:test-cgroup-medium\"\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up -d\n\u003cspan class=\"hljs-title class_\"\u003eRecreating\u003c/span\u003e root_first_1 ... done\n$ docker inspect root_first_1 --format \u003cspan class=\"hljs-string\"\u003e'{.HostConfig.CgroupParent}'\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003ecpu\u003c/span\u003e:test-cgroup-medium\n$\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch2\u003econtainer_name\u003c/h2\u003e\n\u003cp\u003e이 옵션에 대해 로켓 과학같은 것은 없습니다. 이 옵션은 Docker Compose 배포에서 생성된 컨테이너의 이름을 고정하는 데 사용됩니다.\u003c/p\u003e\n\u003cp\u003e이전에 언급한 바와 같이, 기본적으로 Docker Compose는 컨테이너에 접미사를 추가하며 이는 Docker Compose 프로젝트의 이름과 일치합니다 (프로젝트 이름을 명시적으로 지정하지 않는 경우 Docker Compose가 현재 경로를 기본값으로 삼습니다).\u003c/p\u003e\n\u003cp\u003e따라서 Docker Compose의 이 동작을 재정의하고 생성된 컨테이너에 자체적으로 정의한 사용자 정의 이름을 지정하려면 container_name을 사용할 수 있습니다. 예시:\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: ubuntu\n    \u003cspan class=\"hljs-attr\"\u003econtainer_name\u003c/span\u003e: my-own-container-name\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up\n기본 드라이버로 \u003cspan class=\"hljs-string\"\u003e\"mediumcom_default\"\u003c/span\u003e 네트워크 생성 중\nmy-own-container-name 생성 완료\nmy-own-container-name에 연결 중\nmy-own-container-name에서 코드 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e으로 종료됨\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eP.S.: 네, 궁금해하실 수도 있지만, 이 Docker Compose 배포 내의 다른 컨테이너들은 컨테이너 이름에 의해 서로에게 도달할 수 있습니다. 예:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: sleep \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003econtainer_name\u003c/span\u003e: my-own-container-name\n  \u003cspan class=\"hljs-attr\"\u003esecond\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: ping -c \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e my-own-container-name\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up\nmy-own-container-name을 다시 생성 중... 완료\nmediumcom_second_1 생성 중... 완료\nmediumcom_second_1, my-own-container-name에 연결 중\nsecond_1  | my-own-container-\u003cspan class=\"hljs-title function_\"\u003ename\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e172.18\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.3\u003c/span\u003e) 핑 중: \u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e data bytes\nsecond_1  | \u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003e bytes \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e172.18\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.3\u003c/span\u003e: seq=\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e ttl=\u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003e time=\u003cspan class=\"hljs-number\"\u003e0.743\u003c/span\u003e ms\nsecond_1  |\nsecond_1  | --- my-own-container-name 핑 통계 ---\nsecond_1  | 전송된 패킷: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, 수신된 패킷: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, 패킷 손실: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e%\nsecond_1  | 왕복 최소/평균/최대 시간 = \u003cspan class=\"hljs-number\"\u003e0.743\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e0.743\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e0.743\u003c/span\u003e ms\nmediumcom_second_1이 코드 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e으로 종료됨\nmy-own-container-name이 코드 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e으로 종료됨\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003edepends_on\u003c/h2\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e먼저 말하자면, 아니요, 이 옵션은 컨테이너 애플리케이션의 시작 순서를 제어할 수 있게 해주지 않아요! 많은 사람들이 하는 실수죠. 하지만 생각해보세요… 당신의 컨테이너는 내부에서 하나 이상의 프로세스를 실행하고 있기 때문에, Docker(컨테이너를 관리하는 주체)가 해당 컨테이너 내부에서 실행 중인 애플리케이션/프로세스의 비즈니스 로직을 완벽히 이해하고 있다고 가정하는 것은 순진한 판단일 거예요.\u003c/p\u003e\n\u003cp\u003e이것은 미묘한 차이가 있지만, 이 옵션이 하는 일은 대신에 Docker Compose에게 컨테이너를 시작하고 중지할 때의 순서를 명시하는 것뿐이에요.\u003c/p\u003e\n\u003cp\u003e예시:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003edepends_on\u003c/span\u003e:\n     - second\n  \u003cspan class=\"hljs-attr\"\u003esecond\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003edepends_on\u003c/span\u003e:\n     - first\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up\n\u003cspan class=\"hljs-title class_\"\u003eCreating\u003c/span\u003e network \u003cspan class=\"hljs-string\"\u003e\"mediumcom_default\"\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e the \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e driver\n\u003cspan class=\"hljs-title class_\"\u003eCreating\u003c/span\u003e mediumcom_second_1 ... done\n\u003cspan class=\"hljs-title class_\"\u003eCreating\u003c/span\u003e mediumcom_first_1  ... done\n\u003cspan class=\"hljs-title class_\"\u003eAttaching\u003c/span\u003e to mediumcom_second_1, mediumcom_first_1\nmediumcom_second_1 exited \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e code \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\nmediumcom_first_1 exited \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e code \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e봐요! 두 번째에 의존하는 첫 번째 컨테이너가 먼저 시작되므로, 두 번째 컨테이너가 먼저 시작됩니다. 그리고 멈출 때도 마찬가지 — 먼저 의존하는 첫 번째가 있기 때문에 두 번째가 마지막으로 내려갑니다!\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ docker-compose down\nmediumcom_first_1  ... 삭제됨\nmediumcom_second_1 ... 삭제됨\nmediumcom_default 네트워크 제거됨\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e추신: 만약 혼돈을 즐긴다면, 두 번째도 첫 번째에 의존하도록 만들었다면 어떻게 될까요? 😝 걱정 마세요, Docker는 똑똑해서 다음과 같은 메시지를 보여줄 거예요:\u003c/p\u003e\n\u003ch2\u003e볼륨\u003c/h2\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e도커 볼륨에 대해 자세히 설명하지 않을 거예요. 이 주제는 꽤 크거든요. 단지 컨테이너 애플리케이션에서 데이터를 관리할 수 있는 4가지 방법이 있다는 것만 말씀드릴게요:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e컨테이너의 쓰기 가능한 레이어 내에 모든 데이터를 유지합니다 (볼륨 없음)\u003c/li\u003e\n\u003cli\u003e호스트와 컨테이너 사이에 마운트 지점을 만듭니다 (바인드 마운트)\u003c/li\u003e\n\u003cli\u003e컨테이너의 수명주기와 독립적으로 데이터를 호스팅하고 관리하는 전용 도커 리소스를 생성합니다 (볼륨)\u003c/li\u003e\n\u003cli\u003e성능을 최적화하기 위해 데이터를 영구 저장하지 않고 메모리에 유지합니다 (tmpfs).\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e이렇게 말씀드린 바와 같이 Compose 파일에서 이러한 타입의 볼륨을 모두 관리할 수 있어요. 지금까지 모든 예제는 컨테이너의 쓰기 가능한 레이어를 사용했지만, 나머지 3가지 데이터 관리 옵션을 다음과 같이 사용할 수 있어요:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: ls /\n    \u003cspan class=\"hljs-attr\"\u003evolumes\u003c/span\u003e:\n     - \u003cspan class=\"hljs-regexp\"\u003e/:/my\u003c/span\u003e-hostfs\n     - my-\u003cspan class=\"hljs-attr\"\u003evolume\u003c/span\u003e:/my-volume\n     - \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e: tmpfs\n       \u003cspan class=\"hljs-attr\"\u003etarget\u003c/span\u003e: /my-tmpfs\n\u003cspan class=\"hljs-attr\"\u003evolumes\u003c/span\u003e:\n  my-\u003cspan class=\"hljs-attr\"\u003evolume\u003c/span\u003e:\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up\n\u003cspan class=\"hljs-title class_\"\u003eCreating\u003c/span\u003e network \u003cspan class=\"hljs-string\"\u003e\"test_default\"\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e the \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e driver\n\u003cspan class=\"hljs-title class_\"\u003eCreating\u003c/span\u003e volume \u003cspan class=\"hljs-string\"\u003e\"test_my-volume\"\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e driver\n\u003cspan class=\"hljs-title class_\"\u003eCreating\u003c/span\u003e test_first_1 ... done\n\u003cspan class=\"hljs-title class_\"\u003eAttaching\u003c/span\u003e to test_first_1\nfirst_1  | bin\nfirst_1  | dev\nfirst_1  | etc\nfirst_1  | home\nfirst_1  | lib\nfirst_1  | media\nfirst_1  | mnt\nfirst_1  | my-hostfs\nfirst_1  | my-tmpfs\nfirst_1  | my-volume\nfirst_1  | opt\nfirst_1  | proc\nfirst_1  | root\nfirst_1  | run\nfirst_1  | sbin\nfirst_1  | srv\nfirst_1  | sys\nfirst_1  | tmp\nfirst_1  | usr\nfirst_1  | \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e\ntest_first_1 exited \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e code \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e여기에 세 가지 다른 유형의 마운트가 한꺼번에 나왔어요. 그런데 알아두셨나요? 제가 3가지 다른 구문을 사용했어요... 선호하는 것이나 마운트에 가장 적합한 것을 선택할 수 있어요 (여기에서 더 자세히 읽을 수 있어요).\u003c/p\u003e\n\u003cp\u003e추가로, tmpfs도 전용 옵션을 통해 설정할 수 있어요... 예제를 보려면 다음 섹션을 읽어보세요.\u003c/p\u003e\n\u003ch2\u003etmpfs\u003c/h2\u003e\n\u003cp\u003e이미 이전 섹션에서 설명했지만, 알아두시면 좋아요. 이는 컨테이너를 위한 비영구적 마운트 포인트를 설정하는 또 다른 간단한 방법일 뿐이에요:\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-sh\"\u003e$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e \u003edocker-compose.yml \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-string\"\u003eEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: ls /\n    tmpfs: /my-tmpfs\nEOF\u003c/span\u003e\n$ docker-compose up\nmediumcom_first_1 컨테이너 다시 생성 중... 완료\nmediumcom_first_1에 첨부 중\nfirst_1  | bin\nfirst_1  | dev\nfirst_1  | etc\nfirst_1  | home\nfirst_1  | lib\nfirst_1  | media\nfirst_1  | mnt\nfirst_1  | my-tmpfs\nfirst_1  | opt\nfirst_1  | proc\nfirst_1  | root\nfirst_1  | run\nfirst_1  | sbin\nfirst_1  | srv\nfirst_1  | sys\nfirst_1  | tmp\nfirst_1  | usr\nfirst_1  | var\nmediumcom_first_1가 코드 0으로 종료됨\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e디바이스\u003c/h2\u003e\n\u003cp\u003e그 이름에서 알 수 있듯이, 이 옵션은 컨테이너가 시스템 디바이스를 관리하기 위한 액세스 권한을 부여합니다. 이 것이 일반적인 바인드-마운트와 어떻게 다른지 궁금할 것입니다. 단순히 디바이스를 컨테이너에 바인드-마운트할 수 있지 않을까요? 음, 그렇고 그렇지 않습니다... 컨테이너가 해당 디바이스를 어떻게 사용하는지에 따라 다릅니다. 디바이스 파일은 일반 파일 및 디렉토리와 약간 다르며 (/dev 폴더 아래에서 일반 파일처럼 보이지만), 디바이스 파일은 디바이스 드라이버 및 물리 디바이스로의 인터페이스를 제공하므로 더 세분화된 액세스 제어가 있습니다. 이는 cgroups를 통해 관리되며(여기에서 더 읽을 수 있습니다).\u003c/p\u003e\n\u003cp\u003e요약하면, 컨테이너가 특권 모드에서 실행되지 않는 경우에도 이 옵션을 통해 특정 디바이스 파일에 대한 컨테이너 액세스를 부여할 수 있습니다.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e우리 컴퓨터에 웹캠이 연결되어 있다고 가정해 봅시다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e$ lsusb -s 001:003\nBus 001 Device 003: ID 046d:0826 Logitech, Inc. HD Webcam C525\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e그리고 컨테이너 내부에서 웹캠을 사용하여 사진을 찍고 싶어합니다. 다음 시나리오를 고려해보세요:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e먼저, 옵션을 적용하지 않고 컨테이너 내부에서 웹캠에 액세스해보겠습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: ccordeiro/\u003cspan class=\"hljs-attr\"\u003efswebcam\u003c/span\u003e:armv7l\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: fswebcam -r 640x480 --jpeg \u003cspan class=\"hljs-number\"\u003e85\u003c/span\u003e -D \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e picture.\u003cspan class=\"hljs-property\"\u003ejpg\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up\n네트워크 \u003cspan class=\"hljs-string\"\u003e\"tmp_default\"\u003c/span\u003e를 기본 드라이버로 생성중\ntmp_first_1 를 생성중... 완료\ntmp_first_1 에 연결중\nfirst_1  | --- \u003cspan class=\"hljs-regexp\"\u003e/dev/\u003c/span\u003evideo0 열기 중...\nfirst_1  | \u003cspan class=\"hljs-attr\"\u003estat\u003c/span\u003e: 해당 파일 또는 디렉터리가 없습니다\nfirst_1  | tmp_first_1이 코드 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e으로 종료되었습니다\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e…그러나 분명히 컨테이너에는 어떤 장치도 보이지 않습니다…\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e두 번째로, 장치 파일을 바인드 마운트해 봅시다\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: ccordeiro/\u003cspan class=\"hljs-attr\"\u003efswebcam\u003c/span\u003e:armv7l\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: fswebcam -r 640x480 --jpeg \u003cspan class=\"hljs-number\"\u003e85\u003c/span\u003e -D \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e picture.\u003cspan class=\"hljs-property\"\u003ejpg\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003evolumes\u003c/span\u003e:\n     - \u003cspan class=\"hljs-regexp\"\u003e/dev/\u003c/span\u003e\u003cspan class=\"hljs-attr\"\u003evideo0\u003c/span\u003e:\u003cspan class=\"hljs-regexp\"\u003e/dev/\u003c/span\u003evideo0\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up\ntmp_first_1 재생성중... 완료\ntmp_first_1 에 연결중\nfirst_1  | --- \u003cspan class=\"hljs-regexp\"\u003e/dev/\u003c/span\u003evideo0 열기 중...\nfirst_1  | v4l2 모듈 시도 중...\nfirst_1  | 기기 열기 실패: \u003cspan class=\"hljs-regexp\"\u003e/dev/\u003c/span\u003evideo0\nfirst_1  | 열기: 작업을 허용하지 않습니다\nfirst_1  | v4l1 모듈 시도중...\nfirst_1  | 기기 열기 실패: \u003cspan class=\"hljs-regexp\"\u003e/dev/\u003c/span\u003evideo0\nfirst_1  | 열기: 작업을 허용하지 않습니다\nfirst_1  | \u003cspan class=\"hljs-regexp\"\u003e/dev/\u003c/span\u003evideo0을 읽을 수 있는 소스 모듈을 찾을 수 없습니다.\nfirst_1  | tmp_first_1이 코드 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e으로 종료되었습니다\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e…음, 컨테이너는 보이지만 접근할 수 있는 권한이 없네요.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e마지막으로 장치를 사용해 봅시다\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: ccordeiro/\u003cspan class=\"hljs-attr\"\u003efswebcam\u003c/span\u003e:armv7l\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: fswebcam -r 640x480 --jpeg \u003cspan class=\"hljs-number\"\u003e85\u003c/span\u003e -D \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e picture.\u003cspan class=\"hljs-property\"\u003ejpg\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003edevices\u003c/span\u003e:\n     - \u003cspan class=\"hljs-regexp\"\u003e/dev/\u003c/span\u003e\u003cspan class=\"hljs-attr\"\u003evideo0\u003c/span\u003e:\u003cspan class=\"hljs-regexp\"\u003e/dev/\u003c/span\u003evideo0\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up\n\u003cspan class=\"hljs-title class_\"\u003eRecreating\u003c/span\u003e tmp_first_1 ... done\n\u003cspan class=\"hljs-title class_\"\u003eAttaching\u003c/span\u003e to tmp_first_1\nfirst_1  | --- \u003cspan class=\"hljs-title class_\"\u003eOpening\u003c/span\u003e /dev/video0...\nfirst_1  | \u003cspan class=\"hljs-title class_\"\u003eTrying\u003c/span\u003e source \u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e v4l2...\nfirst_1  | \u003cspan class=\"hljs-regexp\"\u003e/dev/\u003c/span\u003evideo0 opened.\nfirst_1  | \u003cspan class=\"hljs-title class_\"\u003eNo\u003c/span\u003e input was specified, using the first.\nfirst_1  | \u003cspan class=\"hljs-title class_\"\u003eDelaying\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e seconds.\nfirst_1  | --- \u003cspan class=\"hljs-title class_\"\u003eCapturing\u003c/span\u003e frame...\nfirst_1  | \u003cspan class=\"hljs-title class_\"\u003eCaptured\u003c/span\u003e frame \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.00\u003c/span\u003e seconds.\nfirst_1  | --- \u003cspan class=\"hljs-title class_\"\u003eProcessing\u003c/span\u003e captured image...\nfirst_1  | \u003cspan class=\"hljs-title class_\"\u003eSetting\u003c/span\u003e output format to \u003cspan class=\"hljs-variable constant_\"\u003eJPEG\u003c/span\u003e, quality \u003cspan class=\"hljs-number\"\u003e85\u003c/span\u003e\nfirst_1  | \u003cspan class=\"hljs-title class_\"\u003eWriting\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eJPEG\u003c/span\u003e image to \u003cspan class=\"hljs-string\"\u003e'picture.jpg'\u003c/span\u003e.\nfirst_1  | tmp_first_1 exited \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e code \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e그리고 성공입니다!\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch2\u003enetwork_mode\u003c/h2\u003e\n\u003cp\u003eDocker의 네트워킹 시스템은 네트워킹 드라이버에 기반하고 있는 것을 알고 계실 것입니다. 이 옵션을 사용하여 컨테이너가 실행되어야 하는 네트워크 모드를 지정할 수 있습니다.\u003c/p\u003e\n\u003cp\u003e예를 들어, 기본 브릿지 네트워크에 1개의 컨테이너를, 호스트 네트워크에 1개의 컨테이너를, 첫 번째 컨테이너와 동일한 네트워크에 1개의 컨테이너를, 그리고 어떤 네트워크도 없는 상태로 1개의 컨테이너를 배포하려고 합니다. 아래는 이를 수행하는 방법입니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: sh -c \u003cspan class=\"hljs-string\"\u003e'ifconfig eth0 \u0026#x26;\u0026#x26; sleep 5'\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003enetwork_mode\u003c/span\u003e: bridge\n  \u003cspan class=\"hljs-attr\"\u003esecond\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: ifconfig eth0\n    \u003cspan class=\"hljs-attr\"\u003enetwork_mode\u003c/span\u003e: host\n  \u003cspan class=\"hljs-attr\"\u003ethird\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: ifconfig eth0\n    \u003cspan class=\"hljs-attr\"\u003edepends_on\u003c/span\u003e:\n     - first\n    \u003cspan class=\"hljs-attr\"\u003enetwork_mode\u003c/span\u003e: \u003cspan class=\"hljs-attr\"\u003eservice\u003c/span\u003e:first\n  \u003cspan class=\"hljs-attr\"\u003efourth\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: ifconfig eth0\n    \u003cspan class=\"hljs-attr\"\u003enetwork_mode\u003c/span\u003e: none\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up\n\u003cspan class=\"hljs-title class_\"\u003eCreating\u003c/span\u003e mediumcom_first_1  ... done\n\u003cspan class=\"hljs-title class_\"\u003eCreating\u003c/span\u003e mediumcom_fourth_1 ... done\n\u003cspan class=\"hljs-title class_\"\u003eCreating\u003c/span\u003e mediumcom_second_1 ... done\n\u003cspan class=\"hljs-title class_\"\u003eCreating\u003c/span\u003e mediumcom_third_1  ... done\n\u003cspan class=\"hljs-title class_\"\u003eAttaching\u003c/span\u003e to mediumcom_second_1, mediumcom_fourth_1, mediumcom_first_1, mediumcom_third_1\nfirst_1   | eth0      \u003cspan class=\"hljs-title class_\"\u003eLink\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eencap\u003c/span\u003e:\u003cspan class=\"hljs-title class_\"\u003eEthernet\u003c/span\u003e  \u003cspan class=\"hljs-title class_\"\u003eHWaddr\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e02\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e42\u003c/span\u003e:\u003cspan class=\"hljs-attr\"\u003eAC\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e02\u003c/span\u003e\nfirst_1   |           inet \u003cspan class=\"hljs-attr\"\u003eaddr\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e172.17\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.2\u003c/span\u003e  \u003cspan class=\"hljs-title class_\"\u003eBcast\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e172.17\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.255\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.255\u003c/span\u003e  \u003cspan class=\"hljs-title class_\"\u003eMask\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e255.255\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\n...\nfourth_1  | \u003cspan class=\"hljs-attr\"\u003eifconfig\u003c/span\u003e: \u003cspan class=\"hljs-attr\"\u003eeth0\u003c/span\u003e: error fetching interface \u003cspan class=\"hljs-attr\"\u003einformation\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eDevice\u003c/span\u003e not found\n...\nsecond_1  | eth0      \u003cspan class=\"hljs-title class_\"\u003eLink\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eencap\u003c/span\u003e:\u003cspan class=\"hljs-title class_\"\u003eEthernet\u003c/span\u003e  \u003cspan class=\"hljs-title class_\"\u003eHWaddr\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e02\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e01\u003c/span\u003e\nsecond_1  |           inet \u003cspan class=\"hljs-attr\"\u003eaddr\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.65\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.3\u003c/span\u003e  \u003cspan class=\"hljs-title class_\"\u003eBcast\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.65\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.255\u003c/span\u003e  \u003cspan class=\"hljs-title class_\"\u003eMask\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e255.255\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.255\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\n...\nthird_1   | eth0      \u003cspan class=\"hljs-title class_\"\u003eLink\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eencap\u003c/span\u003e:\u003cspan class=\"hljs-title class_\"\u003eEthernet\u003c/span\u003e  \u003cspan class=\"hljs-title class_\"\u003eHWaddr\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e02\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e42\u003c/span\u003e:\u003cspan class=\"hljs-attr\"\u003eAC\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e02\u003c/span\u003e\nthird_1   |           inet \u003cspan class=\"hljs-attr\"\u003eaddr\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e172.17\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.2\u003c/span\u003e  \u003cspan class=\"hljs-title class_\"\u003eBcast\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e172.17\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.255\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.255\u003c/span\u003e  \u003cspan class=\"hljs-title class_\"\u003eMask\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e255.255\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\n...\nmediumcom_fourth_1 exited \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e code \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\nmediumcom_second_1 exited \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e code \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\nmediumcom_third_1 exited \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e code \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\nmediumcom_first_1 exited \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e code \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e그래서, 무슨 일이 있었나요? 이를 간단히 살펴보겠습니다:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e첫 번째 컨테이너는 브리지 모드로 들어가서 자체 eth0 개인 네트워크 인터페이스를 할당 받았습니다(IP 172.17.0.2로, Docker 브리지 서브넷의 일부입니다).\u003c/li\u003e\n\u003cli\u003e두 번째 컨테이너는 호스트 모드로 들어가서 호스트와 동일한 네트워크 수준에서 실행되므로 호스트의 모든 네트워킹 인터페이스를 볼 수 있습니다.\u003c/li\u003e\n\u003cli\u003e세 번째 컨테이너는 첫 번째 것과 동일한 네트워크를 받았습니다.\u003c/li\u003e\n\u003cli\u003e네 번째 컨테이너는 네트워크가 없어 eth0 인터페이스를 찾지 못하여 실패했습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003e네트워크\u003c/h2\u003e\n\u003cp\u003e이제 위에서 언급한 옵션을 활용하여, 컨테이너를 사용자 정의 네트워크에 연결하려면 어떻게 해야 하나요(기존 네트워크 또는 새로 생성한 것 중)? 그럴 때는 networks를 사용하세요:\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ docker network create cjdc-test\n0f5e35bf6b8d396c45c19545540957fbc5fa15ba1ca0e5fbca4add3802c7db6d\n$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: sleep \u003cspan class=\"hljs-number\"\u003e30\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003enetworks\u003c/span\u003e:\n     - \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e-net\n  \u003cspan class=\"hljs-attr\"\u003esecond\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: sleep \u003cspan class=\"hljs-number\"\u003e30\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003enetworks\u003c/span\u003e:\n     - cjdc-test\n\u003cspan class=\"hljs-attr\"\u003enetworks\u003c/span\u003e:\n  \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e-\u003cspan class=\"hljs-attr\"\u003enet\u003c/span\u003e:\n  cjdc-\u003cspan class=\"hljs-attr\"\u003etest\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eexternal\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: cjdc-test\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up -d\n\u003cspan class=\"hljs-title class_\"\u003eCreating\u003c/span\u003e network \u003cspan class=\"hljs-string\"\u003e\"mediumcom_new-net\"\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e the \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e driver\n\u003cspan class=\"hljs-title class_\"\u003eCreating\u003c/span\u003e mediumcom_second_1 ... done\n\u003cspan class=\"hljs-title class_\"\u003eCreating\u003c/span\u003e mediumcom_first_1  ... done\n$ docker inspect --format \u003cspan class=\"hljs-string\"\u003e'{.NetworkSettings.Networks}'\u003c/span\u003e mediumcom_first_1\nmap[mediumcom_new-\u003cspan class=\"hljs-attr\"\u003enet\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0xc0004d8f00\u003c/span\u003e]\n$ docker inspect --format \u003cspan class=\"hljs-string\"\u003e'{.NetworkSettings.Networks}'\u003c/span\u003e mediumcom_second_1\nmap[cjdc-\u003cspan class=\"hljs-attr\"\u003etest\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0xc0003e8f00\u003c/span\u003e]\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003edns\u003c/h2\u003e\n\u003cp\u003eIt basically lets you define a custom DNS server for your container. Example:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: cat /etc/resolv.\u003cspan class=\"hljs-property\"\u003econf\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003edns\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1.2\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.3\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.4\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003enetwork_mode\u003c/span\u003e: bridge\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up\n\u003cspan class=\"hljs-title class_\"\u003eRecreating\u003c/span\u003e mediumcom_first_1 ... done\n\u003cspan class=\"hljs-title class_\"\u003eAttaching\u003c/span\u003e to mediumcom_first_1\nfirst_1  | nameserver \u003cspan class=\"hljs-number\"\u003e1.2\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.3\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.4\u003c/span\u003e\nmediumcom_first_1 exited \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e code \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e주의: 사용자 정의 네트워크에서는 DNS 옵션이 기본적으로 동작하지 않으므로 브릿지 네트워크가 필요합니다.\u003c/p\u003e\n\u003ch2\u003edns_search\u003c/h2\u003e\n\u003cp\u003e여기에서 사용자 맞춤 DNS 검색 도메인을 설정할 수 있습니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: cat /etc/resolv.\u003cspan class=\"hljs-property\"\u003econf\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003edns_search\u003c/span\u003e: my.\u003cspan class=\"hljs-property\"\u003ecustom\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003edns\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003enetwork_mode\u003c/span\u003e: bridge\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up\n\u003cspan class=\"hljs-title class_\"\u003eRecreating\u003c/span\u003e mediumcom_first_1 ... done\n\u003cspan class=\"hljs-title class_\"\u003eAttaching\u003c/span\u003e to mediumcom_first_1\nfirst_1  | search my.\u003cspan class=\"hljs-property\"\u003ecustom\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003edns\u003c/span\u003e\nfirst_1  | nameserver \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.65\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.5\u003c/span\u003e\nmediumcom_first_1 exited \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e code \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch2\u003eenv_file\u003c/h2\u003e\n\u003cp\u003e일반적으로 컨테이너 환경을 하나씩 설정하는 데 익숙할 수 있지만, 한 번에 이 작업을 수행하도록 대신 파일을 사용할 수 있습니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003emy-env \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-title class_\"\u003eVAR1\u003c/span\u003e=value\n\u003cspan class=\"hljs-variable constant_\"\u003eMY_VAR_FROM_FILE\u003c/span\u003e=\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eFOO\u003c/span\u003e=\u003cspan class=\"hljs-variable constant_\"\u003eBAR\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: env\n    \u003cspan class=\"hljs-attr\"\u003eenv_file\u003c/span\u003e:\n     - my-env\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up\nmediumcom_first_1 다시 만들기 ... 완료\nmediumcom_first_1에 연결\nfirst_1  | \u003cspan class=\"hljs-variable constant_\"\u003ePATH\u003c/span\u003e=\u003cspan class=\"hljs-regexp\"\u003e/usr/\u003c/span\u003elocal/\u003cspan class=\"hljs-attr\"\u003esbin\u003c/span\u003e:\u003cspan class=\"hljs-regexp\"\u003e/usr/\u003c/span\u003elocal/\u003cspan class=\"hljs-attr\"\u003ebin\u003c/span\u003e:\u003cspan class=\"hljs-regexp\"\u003e/usr/\u003c/span\u003e\u003cspan class=\"hljs-attr\"\u003esbin\u003c/span\u003e:\u003cspan class=\"hljs-regexp\"\u003e/usr/\u003c/span\u003e\u003cspan class=\"hljs-attr\"\u003ebin\u003c/span\u003e:\u003cspan class=\"hljs-regexp\"\u003e/sbin:/\u003c/span\u003ebin\nfirst_1  | \u003cspan class=\"hljs-variable constant_\"\u003eHOSTNAME\u003c/span\u003e=157e34e4fc64\nfirst_1  | \u003cspan class=\"hljs-title class_\"\u003eVAR1\u003c/span\u003e=value\nfirst_1  | \u003cspan class=\"hljs-variable constant_\"\u003eMY_VAR_FROM_FILE\u003c/span\u003e=\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\nfirst_1  | \u003cspan class=\"hljs-variable constant_\"\u003eFOO\u003c/span\u003e=\u003cspan class=\"hljs-variable constant_\"\u003eBAR\u003c/span\u003e\nfirst_1  | \u003cspan class=\"hljs-variable constant_\"\u003eHOME\u003c/span\u003e=/root\nmediumcom_first_1 코드 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e으로 종료\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eenvironment\u003c/h2\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e이를 통해 컴포즈 파일에서 컨테이너의 환경 변수를 하나씩 직접 설정할 수 있습니다.\u003c/p\u003e\n\u003cp\u003e이 방법을 사용하여 env_file 옵션을 통해 로드되는 변수를 재정의할 수도 있습니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: env\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up\n\u003cspan class=\"hljs-title class_\"\u003eRecreating\u003c/span\u003e mediumcom_first_1 ... done\n\u003cspan class=\"hljs-title class_\"\u003eAttaching\u003c/span\u003e to mediumcom_first_1\nfirst_1  | \u003cspan class=\"hljs-variable constant_\"\u003ePATH\u003c/span\u003e=\u003cspan class=\"hljs-regexp\"\u003e/usr/\u003c/span\u003elocal/\u003cspan class=\"hljs-attr\"\u003esbin\u003c/span\u003e:\u003cspan class=\"hljs-regexp\"\u003e/usr/\u003c/span\u003elocal/\u003cspan class=\"hljs-attr\"\u003ebin\u003c/span\u003e:\u003cspan class=\"hljs-regexp\"\u003e/usr/\u003c/span\u003e\u003cspan class=\"hljs-attr\"\u003esbin\u003c/span\u003e:\u003cspan class=\"hljs-regexp\"\u003e/usr/\u003c/span\u003e\u003cspan class=\"hljs-attr\"\u003ebin\u003c/span\u003e:\u003cspan class=\"hljs-regexp\"\u003e/sbin:/\u003c/span\u003ebin\nfirst_1  | \u003cspan class=\"hljs-variable constant_\"\u003eHOSTNAME\u003c/span\u003e=\u003cspan class=\"hljs-number\"\u003e68e909013198\u003c/span\u003e\nfirst_1  | \u003cspan class=\"hljs-variable constant_\"\u003eNEW_VAR\u003c/span\u003e=yes\nfirst_1  | \u003cspan class=\"hljs-variable constant_\"\u003eHOME\u003c/span\u003e=/root\nmediumcom_first_1 exited \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e code \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e노출\u003c/h2\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e도커파일과 유사하게, 이 옵션은 컨테이너의 포트를 표시하고 다른 연결된 컨테이너에서 사용할 수 있도록 합니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: sleep \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003eexpose\u003c/span\u003e:\n     - \u003cspan class=\"hljs-number\"\u003e9876\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up -d\n\u003cspan class=\"hljs-title class_\"\u003eRecreating\u003c/span\u003e mediumcom_first_1 ... done\n$ docker ps\n\u003cspan class=\"hljs-variable constant_\"\u003eCONTAINER\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eID\u003c/span\u003e   \u003cspan class=\"hljs-variable constant_\"\u003eIMAGE\u003c/span\u003e     \u003cspan class=\"hljs-variable constant_\"\u003eCOMMAND\u003c/span\u003e      \u003cspan class=\"hljs-variable constant_\"\u003eCREATED\u003c/span\u003e          \u003cspan class=\"hljs-variable constant_\"\u003eSTATUS\u003c/span\u003e          \u003cspan class=\"hljs-variable constant_\"\u003ePORTS\u003c/span\u003e      \u003cspan class=\"hljs-variable constant_\"\u003eNAMES\u003c/span\u003e\n3be377f4bf6c   alpine    \u003cspan class=\"hljs-string\"\u003e\"sleep 20\"\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e18\u003c/span\u003e seconds ago   \u003cspan class=\"hljs-title class_\"\u003eUp\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e seconds   \u003cspan class=\"hljs-number\"\u003e9876\u003c/span\u003e/tcp   mediumcom_first_1\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eexternal_links\u003c/h2\u003e\n\u003cp\u003e옵션을 건너뛰어야 합니다. 왜냐하면 1) 이것은 레거시 옵션이기 때문에, 그리고 2) 동일한 결과를 얻기 위해 네트워크를 사용할 수 있습니다(즉, 컨테이너를 외부 네트워크에 포함되어 있지 않은 다른 컨테이너에 연결할 수 있습니다).\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch2\u003eextra_hosts\u003c/h2\u003e\n\u003cp\u003e이 기능은 컨테이너의 /etc/hosts 파일에 새 항목을 추가할 수 있게 해줍니다. 예를 들어, 컨테이너가 \"localhost\"가 아닌 다른 이름으로 스스로를 호출하도록 하고 싶다면 다음과 같이 할 수 있습니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: sh -c \u003cspan class=\"hljs-string\"\u003e'cat /etc/hosts; ping me -c 1'\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003eextra_hosts\u003c/span\u003e:\n     - \u003cspan class=\"hljs-string\"\u003e\"myself:127.0.0.1\"\u003c/span\u003e\n     - \u003cspan class=\"hljs-string\"\u003e\"me:127.0.0.1\"\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up\n\u003cspan class=\"hljs-title class_\"\u003eRecreating\u003c/span\u003e mediumcom_first_1 ... done\n\u003cspan class=\"hljs-title class_\"\u003eAttaching\u003c/span\u003e to mediumcom_first_1\nfirst_1  | \u003cspan class=\"hljs-number\"\u003e127.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e localhost\nfirst_1  | ::\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e localhost ip6-localhost ip6-loopback\nfirst_1  | \u003cspan class=\"hljs-attr\"\u003efe00\u003c/span\u003e::\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e ip6-localnet\nfirst_1  | \u003cspan class=\"hljs-attr\"\u003eff00\u003c/span\u003e::\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e ip6-mcastprefix\nfirst_1  | \u003cspan class=\"hljs-attr\"\u003eff02\u003c/span\u003e::\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e ip6-allnodes\nfirst_1  | \u003cspan class=\"hljs-attr\"\u003eff02\u003c/span\u003e::\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e ip6-allrouters\nfirst_1  | \u003cspan class=\"hljs-number\"\u003e127.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e myself\nfirst_1  | \u003cspan class=\"hljs-number\"\u003e127.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e me\nfirst_1  | \u003cspan class=\"hljs-number\"\u003e172.22\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.2\u003c/span\u003e 01d566c4380a\nfirst_1  | \u003cspan class=\"hljs-variable constant_\"\u003ePING\u003c/span\u003e me (\u003cspan class=\"hljs-number\"\u003e127.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e): \u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e data bytes\nfirst_1  | \u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003e bytes \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e127.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e: seq=\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e ttl=\u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003e time=\u003cspan class=\"hljs-number\"\u003e1.192\u003c/span\u003e ms\nfirst_1  |\nfirst_1  | --- me ping statistics ---\nfirst_1  | \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e packets transmitted, \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e packets received, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e% packet loss\nfirst_1  | round-trip min/avg/max = \u003cspan class=\"hljs-number\"\u003e1.192\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e1.192\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e1.192\u003c/span\u003e ms\nmediumcom_first_1 exited \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e code \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003ehealthcheck\u003c/h2\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e당연히, 이것은 도커 파일 옵션과 매우 유사하게 작동합니다. 도커가 컨테이너가 \"healthy(건강한)\"인지 아닌지 평가하는 데 사용할 수 있는 사용자 정의 확인을 만들 수 있습니다.\u003c/p\u003e\n\u003cp\u003e그러니까, /tmp에 medium.txt라는 파일이 있을 때만 우리 컨테이너가 건강한 것으로 간주됩니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: sh -c \u003cspan class=\"hljs-string\"\u003e'touch /tmp/NOT_MY_FILE; sleep 10'\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003ehealthcheck\u003c/span\u003e:\n      \u003cspan class=\"hljs-attr\"\u003etest\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"[ -f /tmp/medium.txt ]\"\u003c/span\u003e\n      # run asap\n      \u003cspan class=\"hljs-attr\"\u003einterval\u003c/span\u003e: 1s\n      \u003cspan class=\"hljs-attr\"\u003etimeout\u003c/span\u003e: 5s\n      \u003cspan class=\"hljs-attr\"\u003eretries\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n      \u003cspan class=\"hljs-attr\"\u003estart_period\u003c/span\u003e: 0s\n  \u003cspan class=\"hljs-attr\"\u003esecond\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: sh -c \u003cspan class=\"hljs-string\"\u003e'touch /tmp/medium.txt; sleep 10'\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003ehealthcheck\u003c/span\u003e:\n      \u003cspan class=\"hljs-attr\"\u003etest\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"[ -f /tmp/medium.txt ]\"\u003c/span\u003e\n      # run asap\n      \u003cspan class=\"hljs-attr\"\u003einterval\u003c/span\u003e: 1s\n      \u003cspan class=\"hljs-attr\"\u003etimeout\u003c/span\u003e: 5s\n      \u003cspan class=\"hljs-attr\"\u003eretries\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n      \u003cspan class=\"hljs-attr\"\u003estart_period\u003c/span\u003e: 0s\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up -d\n\u003cspan class=\"hljs-title class_\"\u003eRecreating\u003c/span\u003e mediumcom_first_1 ... done\n\u003cspan class=\"hljs-title class_\"\u003eCreating\u003c/span\u003e mediumcom_second_1  ... done\n$ docker ps\n\u003cspan class=\"hljs-variable constant_\"\u003eCONTAINER\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eID\u003c/span\u003e   \u003cspan class=\"hljs-variable constant_\"\u003eIMAGE\u003c/span\u003e     \u003cspan class=\"hljs-variable constant_\"\u003eCOMMAND\u003c/span\u003e                  \u003cspan class=\"hljs-variable constant_\"\u003eCREATED\u003c/span\u003e         \u003cspan class=\"hljs-variable constant_\"\u003eSTATUS\u003c/span\u003e                     \u003cspan class=\"hljs-variable constant_\"\u003ePORTS\u003c/span\u003e     \u003cspan class=\"hljs-variable constant_\"\u003eNAMES\u003c/span\u003e\nb8804cbb440d   alpine    \u003cspan class=\"hljs-string\"\u003e\"sh -c 'touch /tmp/N…\"\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e seconds ago   \u003cspan class=\"hljs-title class_\"\u003eUp\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e seconds (unhealthy)             mediumcom_first_1\n604a6880f3c6   alpine    \u003cspan class=\"hljs-string\"\u003e\"sh -c 'touch /tmp/m…\"\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e seconds ago   \u003cspan class=\"hljs-title class_\"\u003eUp\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e seconds (healthy)               mediumcom_second_1\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e그런데 여기서 볼 수 있듯이, 처음 것은 건강하지 않지만 두 번째는 건강하다고 나옵니다. 필요한 파일이 올바른 위치에 존재하기 때문입니다.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch2\u003e초기화\u003c/h2\u003e\n\u003cp\u003e이를 통해 Docker에게 컨테이너에 대한 init를 사용할지 여부를 알릴 수 있습니다. 참일 경우, Docker는 tini 기반의 docker-init이라는 init을 사용할 것입니다. 차이를 살펴봅시다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: ps -a\n    \u003cspan class=\"hljs-attr\"\u003einit\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up\nmediumcom_first_1 다시 생성 중... 완료\nmediumcom_first_1에 참여 중\nfirst_1  | \u003cspan class=\"hljs-variable constant_\"\u003ePID\u003c/span\u003e   \u003cspan class=\"hljs-variable constant_\"\u003eUSER\u003c/span\u003e     \u003cspan class=\"hljs-variable constant_\"\u003eTIME\u003c/span\u003e  \u003cspan class=\"hljs-variable constant_\"\u003eCOMMAND\u003c/span\u003e\nfirst_1  |     \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e root      \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e ps -a\nmediumcom_first_1은 코드 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e으로 종료됨\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e그러나 초기화를 활성화하면 이와 같은 프로세스 래퍼를 얻게 되며, 이는 PID 1로 추가 기능이 있는 경우 (이 경우에는 docker-init)입니다:\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e$ cat \u003edocker-compose.yml \u0026#x3C;\u0026#x3C;EOF\nversion: \"3\"\nservices:\nfirst:\nimage: alpine\ncommand: ps -a\ninit: true\nEOF\n$ docker-compose up\nStarting mediumcom_first_1 ... done\nAttaching to mediumcom_first_1\nfirst_1 | PID USER TIME COMMAND\nfirst_1 | 1 root 0:00 /sbin/docker-init -- ps -a\nfirst_1 | 8 root 0:00 ps -a\nmediumcom_first_1 exited with code 0\u003c/p\u003e\n\u003ch2\u003e격리\u003c/h2\u003e\n\u003cp\u003e리눅스의 경우, 이 옵션은 항상 기본값으로 설정됩니다. 윈도우의 경우 더 많은 옵션이 있지만, 아쉽게도 여러분을 위한 예제를 실행할 윈도우 머신이 없습니다 😛 윈도우 사용자분들 죄송해요!\u003c/p\u003e\n\u003ch2\u003e레이블\u003c/h2\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e콘테이너에 레이블을 설정할 수 있는 이 옵션의 이름처럼:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: sleep \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003elabels\u003c/span\u003e:\n     - \u003cspan class=\"hljs-string\"\u003e\"foo=bar\"\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up -d\n\u003cspan class=\"hljs-title class_\"\u003eRecreating\u003c/span\u003e mediumcom_first_1 ... done\n$ docker ps --filter \u003cspan class=\"hljs-string\"\u003e'label=foo=bar'\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eCONTAINER\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eID\u003c/span\u003e   \u003cspan class=\"hljs-variable constant_\"\u003eIMAGE\u003c/span\u003e     \u003cspan class=\"hljs-variable constant_\"\u003eCOMMAND\u003c/span\u003e      \u003cspan class=\"hljs-variable constant_\"\u003eCREATED\u003c/span\u003e          \u003cspan class=\"hljs-variable constant_\"\u003eSTATUS\u003c/span\u003e         \u003cspan class=\"hljs-variable constant_\"\u003ePORTS\u003c/span\u003e     \u003cspan class=\"hljs-variable constant_\"\u003eNAMES\u003c/span\u003e\n94e844176d76   alpine    \u003cspan class=\"hljs-string\"\u003e\"sleep 10\"\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e30\u003c/span\u003e seconds ago   \u003cspan class=\"hljs-title class_\"\u003eUp\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e seconds             mediumcom_first_1\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e링크\u003c/h2\u003e\n\u003cp\u003e외부 링크에 대한 내용은 과거의 옵션을 건너뛰겠습니다. 컨테이너 간 통신은 사용자 정의 네트워크로 쉽게 설정할 수 있습니다.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch2\u003e로깅\u003c/h2\u003e\n\u003cp\u003e실제로 이 옵션이 매우 중요하다고 생각해요. 대부분의 사용자들은 보통 컨테이너 애플리케이션 로그의 크기가 계속해서 커지고 있다는 사실에 충분한 주의를 기울이지 않습니다. 호스트 공간이 시간이 지남에 따라 가득 차지 않기를 원한다면, 다른 애플리케이션과 마찬가지로, 애플리케이션이 로그를 기록하는 방식도 제어해야 합니다. Docker를 통해 이 로깅 옵션을 사용하여 컨테이너 애플리케이션의 stdout 로그를 제어할 수 있습니다. 로깅 종류 뿐만 아니라 로깅 크기 제한 및 로테이션 매개변수도 제어할 수 있습니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: sh -c \u003cspan class=\"hljs-string\"\u003e'while true; do echo `date`; done'\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003elogging\u003c/span\u003e:\n      \u003cspan class=\"hljs-attr\"\u003eoptions\u003c/span\u003e:\n        max-\u003cspan class=\"hljs-attr\"\u003esize\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"50k\"\u003c/span\u003e\n        max-\u003cspan class=\"hljs-attr\"\u003efile\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"10\"\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up -d\ntmp_first_1을 다시 생성 중... 완료됨\n$ docker ps -f \u003cspan class=\"hljs-string\"\u003e'name=tmp_first_1'\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eCONTAINER\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eID\u003c/span\u003e   \u003cspan class=\"hljs-variable constant_\"\u003eIMAGE\u003c/span\u003e     \u003cspan class=\"hljs-variable constant_\"\u003eCOMMAND\u003c/span\u003e                  \u003cspan class=\"hljs-variable constant_\"\u003eCREATED\u003c/span\u003e         \u003cspan class=\"hljs-variable constant_\"\u003eSTATUS\u003c/span\u003e         \u003cspan class=\"hljs-variable constant_\"\u003ePORTS\u003c/span\u003e     \u003cspan class=\"hljs-variable constant_\"\u003eNAMES\u003c/span\u003e\n2ea63dd32607   alpine    \u003cspan class=\"hljs-string\"\u003e\"sh -c 'while true; …\"\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e minutes ago   \u003cspan class=\"hljs-title class_\"\u003eUp\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e minutes             tmp_first_1\n$\n$ du -h /\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e/lib/docker/containers/2ea63dd32607*\u003cspan class=\"hljs-comment\"\u003e/*log*\n20K /var/lib/docker/containers/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60-json.log\n52K /var/lib/docker/containers/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60-json.log.1\n52K /var/lib/docker/containers/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60-json.log.2\n52K /var/lib/docker/containers/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60-json.log.3\n52K /var/lib/docker/containers/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60-json.log.4\n52K /var/lib/docker/containers/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60-json.log.5\n52K /var/lib/docker/containers/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60-json.log.6\n52K /var/lib/docker/containers/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60-json.log.7\n52K /var/lib/docker/containers/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60-json.log.8\n52K /var/lib/docker/containers/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60/2ea63dd32607ea5c5b3238ed4da2233a049c41422cfff96b6a2e45c818f96f60-json.log.9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e그러니까 이 예제에서 볼 수 있듯이, Docker는 최대 10개의 로그 파일만 유지하고, 그 크기가 우리가 원하는 50 Kibibytes(= 52K)를 초과하지 않는 것을 확인할 수 있어요.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch2\u003ePID\u003c/h2\u003e\n\u003cp\u003e요청 시, 컨테이너가 호스트와 PID 주소 공간을 공유할 수 있도록 설정할 수 있습니다. 이를 가능하게 하는 옵션은 다음과 같습니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: ps -a\n    \u003cspan class=\"hljs-attr\"\u003epid\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"host\"\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003esecond\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: ps -a\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up\n\u003cspan class=\"hljs-title class_\"\u003eCreating\u003c/span\u003e network \u003cspan class=\"hljs-string\"\u003e\"mediumcom_default\"\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e the \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e driver\n\u003cspan class=\"hljs-title class_\"\u003eCreating\u003c/span\u003e mediumcom_second_1 ... done\n\u003cspan class=\"hljs-title class_\"\u003eCreating\u003c/span\u003e mediumcom_first_1  ... done\n\u003cspan class=\"hljs-title class_\"\u003eAttaching\u003c/span\u003e to mediumcom_second_1, mediumcom_first_1\nsecond_1  | \u003cspan class=\"hljs-variable constant_\"\u003ePID\u003c/span\u003e   \u003cspan class=\"hljs-variable constant_\"\u003eUSER\u003c/span\u003e     \u003cspan class=\"hljs-variable constant_\"\u003eTIME\u003c/span\u003e  \u003cspan class=\"hljs-variable constant_\"\u003eCOMMAND\u003c/span\u003e\nsecond_1  |     \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e root      \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e ps -a\nfirst_1   | \u003cspan class=\"hljs-variable constant_\"\u003ePID\u003c/span\u003e   \u003cspan class=\"hljs-variable constant_\"\u003eUSER\u003c/span\u003e     \u003cspan class=\"hljs-variable constant_\"\u003eTIME\u003c/span\u003e  \u003cspan class=\"hljs-variable constant_\"\u003eCOMMAND\u003c/span\u003e\nfirst_1   |     \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e root      \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e /sbin/init\nfirst_1   |     \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e root      \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e [kthreadd]\nfirst_1   |     \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e root      \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e [rcu_gp]\nfirst_1   |     \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e root      \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e [rcu_par_gp]\nfirst_1   |     \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e root      \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e [kworker/\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e:0H-ev]\nfirst_1   |     \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e root      \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e [mm_percpu_wq]\nfirst_1   |     \u003cspan class=\"hljs-number\"\u003e9\u003c/span\u003e root      \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e [rcu_tasks_rude_]\nfirst_1   |    \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e root      \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e [rcu_tasks_trace]\nfirst_1   |    \u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e root      \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e [ksoftirqd/\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e]\nfirst_1   |    \u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e root      \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e [rcu_sched]\nfirst_1   |    \u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e root      \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e [migration/\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e]\nfirst_1   |    \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e root      \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e [cpuhp/\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e]\nfirst_1   |    \u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e root      \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e [cpuhp/\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e]\n...\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e이것은 컨테이너 내에서 호스트 프로세스를 관리하고(포함하여 종료)할 수 있다는 의미이므로 이 옵션을 사용할 때 주의해야 합니다.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch2\u003e포트\u003c/h2\u003e\n\u003cp\u003e가장 인기 있는 옵션 중 하나인 이 기능을 사용하면 컨테이너 내부의 포트를 호스트로 게시할 수 있습니다 (컨테이너가 이미 \"호스트\" 모드에서 실행 중이지 않은 경우).\u003c/p\u003e\n\u003cp\u003e예를 들어, 다음과 같이 게시하려는 경우를 생각해 봅시다:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e포트 3000을 임의의 포트로\u003c/li\u003e\n\u003cli\u003e포트 범위 3005부터 3010까지\u003c/li\u003e\n\u003cli\u003e로컬호스트의 포트 80을 포트 80으로만\u003c/li\u003e\n\u003cli\u003e모든 호스트 인터페이스의 포트 443을 포트 443으로\u003c/li\u003e\n\u003cli\u003e호스트의 포트 3011을 UDP만을 사용하여 포트 9876로\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: sleep \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003eports\u003c/span\u003e:\n     - \u003cspan class=\"hljs-number\"\u003e3000\u003c/span\u003e\n     - \u003cspan class=\"hljs-number\"\u003e3005\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e3010\u003c/span\u003e\n     - \u003cspan class=\"hljs-number\"\u003e127.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e\n     - \u003cspan class=\"hljs-number\"\u003e443\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e443\u003c/span\u003e\n     - \u003cspan class=\"hljs-number\"\u003e9876\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e3011\u003c/span\u003e/udp\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up -d\n중복 컨테이너 \u003cspan class=\"hljs-string\"\u003e\"mediumcom_second_1\"\u003c/span\u003e를 제거하는 중\nmediumcom_first_1이 시작되었습니다. ... 완료\n$ docker ps --format \u003cspan class=\"hljs-string\"\u003e'{.Ports}'\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e127.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.1\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e-\u003e\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e/tcp, \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e443\u003c/span\u003e-\u003e\u003cspan class=\"hljs-number\"\u003e443\u003c/span\u003e/tcp, \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e61290\u003c/span\u003e-\u003e\u003cspan class=\"hljs-number\"\u003e3000\u003c/span\u003e/tcp, \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e61292\u003c/span\u003e-\u003e\u003cspan class=\"hljs-number\"\u003e3005\u003c/span\u003e/tcp, \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e61293\u003c/span\u003e-\u003e\u003cspan class=\"hljs-number\"\u003e3006\u003c/span\u003e/tcp, \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e61294\u003c/span\u003e-\u003e\u003cspan class=\"hljs-number\"\u003e3007\u003c/span\u003e/tcp, \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e61295\u003c/span\u003e-\u003e\u003cspan class=\"hljs-number\"\u003e3008\u003c/span\u003e/tcp, \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e61296\u003c/span\u003e-\u003e\u003cspan class=\"hljs-number\"\u003e3009\u003c/span\u003e/tcp, \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e61291\u003c/span\u003e-\u003e\u003cspan class=\"hljs-number\"\u003e3010\u003c/span\u003e/tcp, \u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e9876\u003c/span\u003e-\u003e\u003cspan class=\"hljs-number\"\u003e3011\u003c/span\u003e/udp\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch2\u003e프로필\u003c/h2\u003e\n\u003cp\u003e\"프로필\"은 컴포즈 파일 내에서 역할을 분리할 수 있는 멋진 제어 메커니즘입니다. 우리가 컴포즈 파일 내에서 일부 컨테이너가 매우 특정한 설정하에서만 실행되거나 필요할 때만 실행되도록 원한다고 가정해 봅시다 (즉, \"프로필\"이라고도 함). 이것이 할 수 있는 것입니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: nginx\n  \u003cspan class=\"hljs-attr\"\u003esecond\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: wget \u003cspan class=\"hljs-attr\"\u003ehttp\u003c/span\u003e:\u003cspan class=\"hljs-comment\"\u003e//first\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003eprofiles\u003c/span\u003e: [\u003cspan class=\"hljs-string\"\u003e\"debug\"\u003c/span\u003e]\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up -d\n네트워크 \u003cspan class=\"hljs-string\"\u003e\"mediumcom_default\"\u003c/span\u003e를 기본 드라이버로 생성 중\nmediumcom_first_1 생성 완료\n$ # 보세요? nginx 컨테이너만 시작되었습니다. 이제 \u003cspan class=\"hljs-string\"\u003e\"debug\"\u003c/span\u003e를 활성화해 봅시다\n$ docker-compose --profile debug up\nmediumcom_first_1 is up-to-date\nmediumcom_second_1 생성 완료\nmediumcom_first_1, mediumcom_second_1에 첨부\nsecond_1  | \u003cspan class=\"hljs-title function_\"\u003efirst\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e172.26\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.2\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e)에 연결 중\nsecond_1  | \u003cspan class=\"hljs-string\"\u003e'index.html'\u003c/span\u003e 저장 중\nsecond_1  | index.\u003cspan class=\"hljs-property\"\u003ehtml\u003c/span\u003e           \u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e% |********************************|   \u003cspan class=\"hljs-number\"\u003e615\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e 남음\nsecond_1  | \u003cspan class=\"hljs-string\"\u003e'index.html'\u003c/span\u003e 저장됨\nfirst_1   | \u003cspan class=\"hljs-regexp\"\u003e/docker-entrypoint.sh: /\u003c/span\u003edocker-entrypoint.\u003cspan class=\"hljs-property\"\u003ed\u003c/span\u003e/가 비어 있지 않으므로 구성을 시도할 것입니다\n(first_이하 생략)\nmediumcom_second_1이 코드 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e으로 종료됨\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e재시작\u003c/h2\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e컨테이너의 재시작 정책을 정의하는 방법입니다 (no, always, unless-stopped, on-failure 중 하나를 선택).\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003erestart\u003c/span\u003e: on-failure\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: sleep \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003esecond\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: echo \u003cspan class=\"hljs-title class_\"\u003eHi\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e`date`\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003erestart\u003c/span\u003e: always\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up\n\u003cspan class=\"hljs-title class_\"\u003eCreating\u003c/span\u003e network \u003cspan class=\"hljs-string\"\u003e\"mediumcom_default\"\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e the \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e driver\n\u003cspan class=\"hljs-title class_\"\u003eCreating\u003c/span\u003e mediumcom_first_1  ... done\n\u003cspan class=\"hljs-title class_\"\u003eCreating\u003c/span\u003e mediumcom_second_1 ... done\n\u003cspan class=\"hljs-title class_\"\u003eAttaching\u003c/span\u003e to mediumcom_first_1, mediumcom_second_1\nsecond_1  | \u003cspan class=\"hljs-title class_\"\u003eHi\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eTue\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eFeb\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eCET\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e\nmediumcom_second_1 exited \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e code \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\nsecond_1  | \u003cspan class=\"hljs-title class_\"\u003eHi\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eTue\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eFeb\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eCET\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e\nsecond_1  | \u003cspan class=\"hljs-title class_\"\u003eHi\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eTue\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eFeb\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eCET\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e\nmediumcom_second_1 exited \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e code \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\nsecond_1  | \u003cspan class=\"hljs-title class_\"\u003eHi\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eTue\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eFeb\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eCET\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e\nsecond_1  | \u003cspan class=\"hljs-title class_\"\u003eHi\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eTue\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eFeb\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eCET\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e\nsecond_1  | \u003cspan class=\"hljs-title class_\"\u003eHi\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eTue\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eFeb\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eCET\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e\nmediumcom_second_1 exited \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e code \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\nsecond_1  | \u003cspan class=\"hljs-title class_\"\u003eHi\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eTue\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eFeb\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eCET\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e\nsecond_1  | \u003cspan class=\"hljs-title class_\"\u003eHi\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eTue\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eFeb\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eCET\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e\nsecond_1  | \u003cspan class=\"hljs-title class_\"\u003eHi\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eTue\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eFeb\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eCET\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e\nsecond_1  | \u003cspan class=\"hljs-title class_\"\u003eHi\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eTue\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eFeb\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e21\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eCET\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e\nmediumcom_first_1 exited \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e code \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e보안 설정\u003c/h2\u003e\n\u003cp\u003e이 옵션을 사용하면 컨테이너의 SELinux 레이블을 제어할 수 있습니다.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e \u003edocker-compose.yml \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-string\"\u003eEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: sleep 30\n    security_opt:\n     - label:user:USER\n  second:\n    image: alpine\n    command: sleep 30\nEOF\u003c/span\u003e\n$ docker inspect mediumcom_first_1 --format \u003cspan class=\"hljs-string\"\u003e'{ .Id }: SecurityOpt={ .HostConfig.SecurityOpt }'\u003c/span\u003e\n2808e4b2ac6a6870b372ecf06da5ce0217efdd6d14df16cef4b332e1d4fb9b6a: SecurityOpt=[label:user:USER]\n$\n$ docker inspect mediumcom_second_1 --format \u003cspan class=\"hljs-string\"\u003e'{ .Id }: SecurityOpt={ .HostConfig.SecurityOpt }'\u003c/span\u003e\ned4c417b27257cc9f793d5d3dad94672074859dba90effddd0cde49f12dd4115: SecurityOpt=\u0026#x3C;no value\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003estop_grace_period\u003c/h2\u003e\n\u003cp\u003e기본적으로 Docker는 SIGTERM을 수신한 후 10초 내에 컨테이너가 자연스럽게 중지되지 않으면 컨테이너를 강제로 종료합니다 (예: docker stop으로 컨테이너를 의도적으로 중지시킨 후). 이 시간 간격을 stop grace period라고 하며 구성할 수 있습니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e \u003edocker-compose.yml \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-string\"\u003eEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    command: sh -c 'while true; do sleep 5 \u0026#x26; done'\n  second:\n    image: alpine\n    command: sh -c 'while true; do sleep 5 \u0026#x26; done'\n    stop_grace_period: 1s\nEOF\u003c/span\u003e\n$ docker-compose up -d\nRecreating mediumcom_first_1  ... \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e\nRecreating mediumcom_second_1 ... \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e\n$ time docker stop mediumcom_first_1\nmediumcom_first_1\nreal 0m10.847s\nuser 0m0.205s\nsys 0m0.092s\n$ time docker stop mediumcom_second_1\nmediumcom_second_1\nreal 0m1.883s\nuser 0m0.192s\nsys 0m0.105s\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch2\u003estop_signal\u003c/h2\u003e\n\u003cp\u003e앞서 언급한 옵션에서 SIGTERM이 도커 컨테이너를 중지하는 기본 신호임을 이미 알았을 것입니다. 그러나 여러분은 \u003ccode\u003edocker stop\u003c/code\u003e이 컨테이너 응용 프로그램으로 원하는 사용자 정의 신호를 전송하도록 변경할 수 있습니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: sleep \u003cspan class=\"hljs-number\"\u003e60\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003estop_signal\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eSIGUSR1\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up -d\n\u003cspan class=\"hljs-title class_\"\u003eCreating\u003c/span\u003e network \u003cspan class=\"hljs-string\"\u003e\"mediumcom_default\"\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e the \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e driver\n\u003cspan class=\"hljs-title class_\"\u003eCreating\u003c/span\u003e mediumcom_first_1 ... done\n$ docker inspect mediumcom_first_1 --format \u003cspan class=\"hljs-string\"\u003e'{.Config.StopSignal}'\u003c/span\u003e\n\u003cspan class=\"hljs-title class_\"\u003eSIGUSR1\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003esysctls\u003c/h2\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e이 옵션은 컨테이너의 네임스페이스된 커널 매개변수를 런타임에서 구성할 수 있게 합니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: sleep \u003cspan class=\"hljs-number\"\u003e60\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003esysctls\u003c/span\u003e:\n      net.\u003cspan class=\"hljs-property\"\u003ecore\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esomaxconn\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1024\u003c/span\u003e\n      net.\u003cspan class=\"hljs-property\"\u003eipv4\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003etcp_syncookies\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up -d\n네트워크 \u003cspan class=\"hljs-string\"\u003e\"mediumcom_default\"\u003c/span\u003e 생성 중, 기본 드라이버로 설정\nmediumcom_first_1 생성 중... 완료\n$ docker inspect mediumcom_first_1 --format \u003cspan class=\"hljs-string\"\u003e'{json .HostConfig.Sysctls}'\u003c/span\u003e\n{\u003cspan class=\"hljs-string\"\u003e\"net.core.somaxconn\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"1024\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"net.ipv4.tcp_syncookies\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"0\"\u003c/span\u003e}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eulimits\u003c/h2\u003e\n\u003cp\u003e컨테이너의 기본 ulimits를 재정의할 수 있게 합니다.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: sleep \u003cspan class=\"hljs-number\"\u003e60\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003eulimits\u003c/span\u003e:\n      \u003cspan class=\"hljs-attr\"\u003enproc\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e65535\u003c/span\u003e\n      \u003cspan class=\"hljs-attr\"\u003enofile\u003c/span\u003e:\n        \u003cspan class=\"hljs-attr\"\u003esoft\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e20000\u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003ehard\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e40000\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up -d\n\u003cspan class=\"hljs-title class_\"\u003eRecreating\u003c/span\u003e mediumcom_first_1 ... done\n$ docker inspect mediumcom_first_1 --format \u003cspan class=\"hljs-string\"\u003e'{json .HostConfig.Ulimits}'\u003c/span\u003e\n[{\u003cspan class=\"hljs-string\"\u003e\"Name\"\u003c/span\u003e:\u003cspan class=\"hljs-string\"\u003e\"nproc\"\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"Hard\"\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e65535\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"Soft\"\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e65535\u003c/span\u003e},{\u003cspan class=\"hljs-string\"\u003e\"Name\"\u003c/span\u003e:\u003cspan class=\"hljs-string\"\u003e\"nofile\"\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"Hard\"\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e40000\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"Soft\"\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e20000\u003c/span\u003e}]\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003euserns_mode\u003c/h2\u003e\n\u003cp\u003e너무 깊게 파고들지 않고 Docker 데몬에서 사용자 네임스페이스를 활성화한 경우, 단일 컨테이너에서 사용자 네임스페이스를 비활성화하게 하는 옵션입니다. \u003ccode\u003euserns_mode: \"host\"\u003c/code\u003e를 사용하면 됩니다.\u003c/p\u003e\n\u003ch2\u003euser\u003c/h2\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e컨테이너 응용프로그램이 특정 사용자로 실행되도록 하려면 어떻게 하시겠습니까?\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: whoami\n    \u003cspan class=\"hljs-attr\"\u003euser\u003c/span\u003e: nobody\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up\n\u003cspan class=\"hljs-title class_\"\u003eRecreating\u003c/span\u003e mediumcom_first_1 ... done\n\u003cspan class=\"hljs-title class_\"\u003eAttaching\u003c/span\u003e to mediumcom_first_1\nfirst_1  | nobody\nmediumcom_first_1 exited \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e code \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eworking_dir\u003c/h2\u003e\n\u003cp\u003e도커 파일에서 본 적이 있을 것입니다. 이를 사용하면 컨테이너의 랜딩 경로(PWD)를 재정의할 수 있습니다. 이를 통해 엔트리포인트와 명령이 절대 경로를 사용하지 않는 경우에도 동작을 변경할 수 있습니다.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: pwd\n    \u003cspan class=\"hljs-attr\"\u003eworking_dir\u003c/span\u003e: \u003cspan class=\"hljs-regexp\"\u003e/my/\u003c/span\u003ecustom/medium/dir\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up\nmediumcom_first_1 컨테이너 다시 생성 중... 완료\nmediumcom_first_1에 연결 중\nfirst_1  | \u003cspan class=\"hljs-regexp\"\u003e/my/\u003c/span\u003ecustom/medium/dir\nmediumcom_first_1 코드 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e으로 종료됨\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e도메인 이름\u003c/h2\u003e\n\u003cp\u003e당신의 컨테이너는 호스트명과 도메인명을 가지고 있다는 것을 아시죠. 호스트 모드가 아닐 때, 호스트명은 컨테이너의 ID와 동일하며, 도메인명은 예상대로 없을 것입니다. 도메인명을 설정하려면 다음과 같이 하세요:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: hostname -f\n    \u003cspan class=\"hljs-attr\"\u003edomainname\u003c/span\u003e: cristovaocordeiro.\u003cspan class=\"hljs-property\"\u003emedium\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ecom\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up\nmediumcom_first_1 컨테이너 다시 생성 중... 완료\nmediumcom_first_1에 연결 중\nfirst_1  | 6e900c697939.\u003cspan class=\"hljs-property\"\u003ecristovaocordeiro\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003emedium\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ecom\u003c/span\u003e\nmediumcom_first_1 코드 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e으로 종료됨\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch2\u003e호스트이름\u003c/h2\u003e\n\u003cp\u003e당연히 도메인 이름을 설정할 수 있다면 컨테이너의 호스트 이름도 설정할 수 있습니다. 이렇게 하면 기본적으로 제공되는 \"충격적인\" ID 형식 대신 호스트 이름을 사용할 수 있습니다 😜\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: hostname -f\n    \u003cspan class=\"hljs-attr\"\u003ehostname\u003c/span\u003e: test-container\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up\n\u003cspan class=\"hljs-title class_\"\u003eRecreating\u003c/span\u003e mediumcom_first_1 ... done\n\u003cspan class=\"hljs-title class_\"\u003eAttaching\u003c/span\u003e to mediumcom_first_1\nfirst_1  | test-container\nmediumcom_first_1 exited \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e code \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eipc\u003c/h2\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e컨테이너의 프로세스 간 통신을 관리할 수 있습니다(성능 조정 목적). 이 옵션을 통해 컨테이너의 IPC 네임스페이스를 설정할 수 있습니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: sleep \u003cspan class=\"hljs-number\"\u003e30\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003eipc\u003c/span\u003e: shareable\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker inspect mediumcom_first_1 --format \u003cspan class=\"hljs-string\"\u003e'{json .HostConfig.IpcMode}'\u003c/span\u003e\n\u003cspan class=\"hljs-string\"\u003e\"shareable\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003emac_address\u003c/h2\u003e\n\u003cp\u003e원하는 컨테이너에 사용자 정의 MAC 주소를 설정할 수도 있습니다.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n버전: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n서비스:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    이미지: alpine\n    명령: ifconfig eth0\n    \u003cspan class=\"hljs-attr\"\u003emac_address\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-attr\"\u003eab\u003c/span\u003e:\u003cspan class=\"hljs-attr\"\u003ecd\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e34\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up\nmediumcom_first_1 컨테이너 다시 생성 중... 완료\nmediumcom_first_1에 연결 중\nfirst_1  | eth0 \u003cspan class=\"hljs-title class_\"\u003eLink\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eencap\u003c/span\u003e:\u003cspan class=\"hljs-title class_\"\u003eEthernet\u003c/span\u003e  \u003cspan class=\"hljs-title class_\"\u003eHWaddr\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-attr\"\u003eAB\u003c/span\u003e:\u003cspan class=\"hljs-attr\"\u003eCD\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e34\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e56\u003c/span\u003e  \nfirst_1  | inet \u003cspan class=\"hljs-attr\"\u003eaddr\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e172.29\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.2\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eBcast\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e172.29\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.255\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.255\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eMask\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e255.255\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\nfirst_1  | \u003cspan class=\"hljs-variable constant_\"\u003eUP\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eBROADCAST\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eRUNNING\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eMULTICAST\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eMTU\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e1500\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eMetric\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\nfirst_1  | \u003cspan class=\"hljs-variable constant_\"\u003eRX\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003epackets\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eerrors\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003edropped\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eoverruns\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eframe\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\nfirst_1  | \u003cspan class=\"hljs-variable constant_\"\u003eTX\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003epackets\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eerrors\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003edropped\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eoverruns\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ecarrier\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\nfirst_1  | \u003cspan class=\"hljs-attr\"\u003ecollisions\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003etxqueuelen\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \nfirst_1  | \u003cspan class=\"hljs-variable constant_\"\u003eRX\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ebytes\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e200.0\u003c/span\u003e B)  \u003cspan class=\"hljs-variable constant_\"\u003eTX\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ebytes\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0.0\u003c/span\u003e B)\nfirst_1  |\nmediumcom_first_1가 코드 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e으로 종료됨\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e특권적\u003c/h2\u003e\n\u003cp\u003e위에서 \"특권적\" 컨테이너 상태를 몇 번 다뤘습니다. 간단히 말하면, (!!) 확실히 확신이 있고 컨테이너에 가능한 모든 기능을 부여하고 싶다면 (따라서 호스트 장치 및 기타 자원에 액세스 할 수 있음), 이 옵션을 사용할 수 있습니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n버전: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n서비스:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    이미지: alpine\n    명령: sh -c \u003cspan class=\"hljs-string\"\u003e'ls /dev/ | wc -l'\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003esecond\u003c/span\u003e:\n    이미지: alpine\n    명령: sh -c \u003cspan class=\"hljs-string\"\u003e'ls /dev/ | wc -l'\u003c/span\u003e\n    특권적: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up\nmediumcom_first_1 컨테이너 다시 생성 중... 완료\nmediumcom_second_1 컨테이너 다시 생성 중... 완료\nmediumcom_first_1에 연결 중, mediumcom_second_1에 연결 중\nfirst_1  | \u003cspan class=\"hljs-number\"\u003e15\u003c/span\u003e\nsecond_1  | \u003cspan class=\"hljs-number\"\u003e150\u003c/span\u003e\nmediumcom_first_1가 코드 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e으로 종료됨\nmediumcom_second_1가 코드 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e으로 종료됨\n\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003ch2\u003e읽기 전용\u003c/h2\u003e\n\u003cp\u003e컨테이너를 실행할 때 읽기 전용 이미지 레이어 위에 쓰기 가능한 레이어가 생성된다는 사실을 알고 계실 겁니다. 그러나 이 쓰기 가능한 레이어를 읽기 전용으로 바꿀 수도 있습니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: touch /tmp/test\n  \u003cspan class=\"hljs-attr\"\u003esecond\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: touch /tmp/test\n    \u003cspan class=\"hljs-attr\"\u003eread_only\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up\nmediumcom_first_1  ... done\nmediumcom_second_1 ... done\nmediumcom_first_1, mediumcom_second_1에 연결 중\nsecond_1  | \u003cspan class=\"hljs-attr\"\u003etouch\u003c/span\u003e: \u003cspan class=\"hljs-regexp\"\u003e/tmp/\u003c/span\u003e\u003cspan class=\"hljs-attr\"\u003etest\u003c/span\u003e: 읽기 전용 파일 시스템\nmediumcom_first_1 코드 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e으로 종료\nmediumcom_second_1 코드 \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e로 종료\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eshm_size\u003c/h2\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e컨테이너가 사용할 수 있는 공유 메모리 양을 지정할 수 있습니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003ecommand\u003c/span\u003e: df -h /dev/shm\n    \u003cspan class=\"hljs-attr\"\u003eshm_size\u003c/span\u003e: 123M\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up\nmediumcom_first_1 컨테이너를 다시 생성 중... 완료\nmediumcom_first_1에 연결 중\nfirst_1  | 파일 시스템                크기      사용함 사용 가능함 사용률 마운트된 위치\nfirst_1  | shm                     \u003cspan class=\"hljs-number\"\u003e123.\u003c/span\u003e0M         \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e    \u003cspan class=\"hljs-number\"\u003e123.\u003c/span\u003e0M   \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e% \u003cspan class=\"hljs-regexp\"\u003e/dev/\u003c/span\u003eshm\nmediumcom_first_1은 코드 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e으로 종료됨\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003estdin_open\u003c/h2\u003e\n\u003cp\u003e이는 docker run의 -i에 해당합니다. 이를 사용하여 호스트와 컨테이너 간 상호작용이 가능한 인터랙티브 세션을 만들 수 있습니다.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e$ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e \u003edocker-compose.yml \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-string\"\u003eEOF\nversion: \"3\"\nservices:\n  first:\n    image: alpine\n    stdin_open: true\nEOF\u003c/span\u003e\n$ docker-compose up -d\nRecreating mediumcom_first_1 ... \u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e\n$ docker attach mediumcom_first_1\n\u003cspan class=\"hljs-built_in\"\u003eecho\u003c/span\u003e Hello, I am sending commands to the container\nHello, I am sending commands to the container\n\u003cspan class=\"hljs-built_in\"\u003eexit\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e위와 같이 컨테이너와 상호 작용하고 있지만 호스트와 컨테이너 사이에 실제로 터미널 세션이 없습니다... 간단히 말해서 파이프일 뿐입니다.\u003c/p\u003e\n\u003ch2\u003etty\u003c/h2\u003e\n\u003cp\u003e이것은 도커 실행에서의 -t와 동등합니다. 컨테이너에 가상 tty를 할당하고 stdin_open과 결합할 때 유용합니다.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ cat \u003edocker-compose.\u003cspan class=\"hljs-property\"\u003eyml\u003c/span\u003e \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eversion\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eservices\u003c/span\u003e:\n  \u003cspan class=\"hljs-attr\"\u003efirst\u003c/span\u003e:\n    \u003cspan class=\"hljs-attr\"\u003eimage\u003c/span\u003e: alpine\n    \u003cspan class=\"hljs-attr\"\u003estdin_open\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003etty\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n$ docker-compose up -d\nmediumcom_first_1 컨테이너를 다시 생성합니다... 완료\n$ docker attach mediumcom_first_1\n/ # echo now \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e is a real terminal\nnow \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e is a real terminal\n/ # sleep \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e\n^C\n/ # echo $?\n\u003cspan class=\"hljs-number\"\u003e130\u003c/span\u003e\n/ # exit\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e이제 우리는 실제 터미널과 상호 작용하는 세션을 가지고 있습니다. 컨테이너 안에서 원하는 일을 할 수 있어요.\u003c/p\u003e\n\u003cp\u003e우와... 정말 긴 기사였죠. 죄송합니다. 밝은 면에서 말하면, 여러 기사를 넘나들며 다양한 컴포즈 파일 옵션이 무엇을 하는지 찾아보지 않아도 되겠죠?\u003c/p\u003e\n\u003cp\u003e스웜 모드에서 서비스에 특정한 옵션(변수 치환 및 확장 필드 같은 고유한 구조적 노하우)을 일부 뺐습니다. 이것들은 선택 사항이며, 다른 기사에서 다룰 수 있어요.\u003c/p\u003e\n\u003c!-- ui-station 사각형 --\u003e\n\u003cp\u003e\u003cins class=\"adsbygoogle\" style=\"display:block\" data-ad-client=\"ca-pub-4877378276818686\" data-ad-slot=\"7249294152\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\u003c/p\u003e\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\u003cp\u003e이 테이블 태그를 마크다운 형식으로 변경해드렸습니다.\u003c/p\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-06-23-TheWholeShebangComposeFiles"},"buildId":"wOkGEDZCvEs3S_XaNsdwr","isFallback":false,"gsp":true,"scriptLoader":[{"async":true,"src":"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4877378276818686","strategy":"lazyOnload","crossOrigin":"anonymous"}]}</script></body></html>