<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ì€ ì—”ì§€ë‹ˆì–´ë¥¼ ìœ„í•œ ê²ƒì…ë‹ˆë‹¤  ì•„ë‹ˆì—ìš” | ui-station</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://ui-station.github.io///post/2024-05-18-DataEngineeringisforEngineersNOT" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ì€ ì—”ì§€ë‹ˆì–´ë¥¼ ìœ„í•œ ê²ƒì…ë‹ˆë‹¤  ì•„ë‹ˆì—ìš” | ui-station" data-gatsby-head="true"/><meta property="og:title" content="ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ì€ ì—”ì§€ë‹ˆì–´ë¥¼ ìœ„í•œ ê²ƒì…ë‹ˆë‹¤  ì•„ë‹ˆì—ìš” | ui-station" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://ui-station.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://ui-station.github.io///post/2024-05-18-DataEngineeringisforEngineersNOT" data-gatsby-head="true"/><meta name="twitter:title" content="ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ì€ ì—”ì§€ë‹ˆì–´ë¥¼ ìœ„í•œ ê²ƒì…ë‹ˆë‹¤  ì•„ë‹ˆì—ìš” | ui-station" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | ui-station" data-gatsby-head="true"/><meta name="article:published_time" content="2024-05-18 18:24" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-BHFR6GTH9P"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
          
            gtag('config', 'G-BHFR6GTH9P');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b8ef307c9aee1e34.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b8ef307c9aee1e34.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-4a646156c659a948.js" defer=""></script><script src="/_next/static/chunks/348-d11c34b645b13f5b.js" defer=""></script><script src="/_next/static/chunks/162-4172e84c8e2aa747.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-4f7b40c1114f0d09.js" defer=""></script><script src="/_next/static/bb_yO9GbCvdfc_n71SfUf/_buildManifest.js" defer=""></script><script src="/_next/static/bb_yO9GbCvdfc_n71SfUf/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">UI STATION</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ì€ ì—”ì§€ë‹ˆì–´ë¥¼ ìœ„í•œ ê²ƒì…ë‹ˆë‹¤  ì•„ë‹ˆì—ìš”</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ì€ ì—”ì§€ë‹ˆì–´ë¥¼ ìœ„í•œ ê²ƒì…ë‹ˆë‹¤  ì•„ë‹ˆì—ìš”" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">UI STATION</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On May 18, 2024</span><span class="posts_reading_time__f7YPP">30<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-05-18-DataEngineeringisforEngineersNOT&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<h2>ê¸€ì„ ì“°ëŠ” ì‚¬ëŒì´ ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ë„ ë°°ìš¸ ìˆ˜ ìˆì„ ê±°ë¼ê³  ìƒê°í•´ìš”.</h2>
<p>"ì´ê²Œ ë¬´ìŠ¨ ì¼ì´ì£ ."</p>
<p>ì²˜ìŒ ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ ì—…ë¬´ë¥¼ ë§¡ì•˜ì„ ë•Œ ë‚˜ëŠ” ì´ë ‡ê²Œ ìƒê°í–ˆì–´ìš”. í•˜ì§€ë§Œ ì–¼ë§ˆ í›„, ìš°ë¦¬ê°€ í•˜ë‚˜ì”© ìœ„í‚¤í”¼ë””ì•„ì—ì„œ ì§‘ì–´ë‚¼ ëª‡ ê°€ì§€ ìˆ«ìë¥¼ ê°€ì ¸ì˜¤ëŠ” ê²ƒì´ ì²« ë²ˆì§¸ ë‹¨ê³„ì˜€ë‹¤ëŠ” ê²ƒì„ ê¹¨ë‹¬ì•˜ì£ .</p>
<p>íŒŒì´ì¬ì—ì„œ ì‘ì—…ì„ í•´ì£¼ì…”ì•¼ê² ë‹¤ê³  ë§ì”€í•˜ì…”ì•¼ í–ˆë˜ ì²« ë²ˆì§¸ ì–´ë ¤ì›€ì´ ìˆì—ˆì–´ìš”! ì¦‰, ë°ì´í„°ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ê°€ì ¸ì˜¤ëŠ” ë‚ ì´ ëë‚¬ë‹¤ëŠ” ê±°ì£ . ì¸ë‚´ì‹¬ì„ ê°€ì§€ê³  ìì‹ ì—ê²Œ ì´ëŸ° ë§ì„ í•´ë³´ì„¸ìš”. ê´œì°®ì•„, ì´ ì¼ ì˜ í•  ìˆ˜ ìˆì–´ìš”!</p>
<p></p>
<p>ë¬¸ì œ: ì‚¬íšŒê³¼í•™ ì¡¸ì—…ìƒì´ ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ì„ ëŠ¥ìˆ™í•˜ê²Œ ìˆ˜í–‰í•  ìˆ˜ ìˆì„ê¹Œìš”? ìë™í™”ëœ ë°ì´í„° íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•˜ê³  ì•ˆì „í•˜ê²Œ í´ë¼ìš°ë“œì— ë³´ê´€í•  ìˆ˜ ìˆì„ê¹Œìš”?</p>
<p>ê·€ë¬´ê°€ì„¤: ì—”ì§€ë‹ˆì–´ëŠ” ìƒì—…ìœ¼ë¡œ ê¸€ì„ ì“°ëŠ” ì‚¬ëŒë§Œí¼ ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>ì´ ê°€ì„¤ì„ ê¸°ê°í•´ì•¼ í• ê¹Œìš”? ë‚´ ì§ê°ì€ "ì˜ˆ"ë¼ê³  ë§í–ˆìŠµë‹ˆë‹¤. IT ë¹„ì „ë¬¸ê°€ì¸ ë‚˜ ê°™ì€ ì‚¬ëŒì´ ê·¸ë ‡ê²Œ í•  ìˆ˜ëŠ” ì—†ì„ ê²ƒ ê°™ì•„ìš”.</p>
<p>ëŒ€ì•ˆ ê°€ì„¤ì€ ì•„ë§ˆë„ ì´ë ‡ê²Œ í•  ìˆ˜ ìˆì„ ê²ƒ ê°™ì•„ìš”: ìƒì—…ìœ¼ë¡œ ê¸€ì“°ëŠ” ì‚¬ëŒë„ ì—”ì§€ë‹ˆì–´ì²˜ëŸ¼ ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ì„ ë°°ìš¸ ìˆ˜ ìˆë‹¤ë©´ìš”.</p>
<p></p>
<p>ì—¬ê¸°ì„œ ì‹œì‘í•´ìš”...</p>
<h2>ìš°ë¦¬ ë¹„ì¦ˆë‹ˆìŠ¤ ì¼€ì´ìŠ¤</h2>
<p>ì´ ì‘ì—…ì€ ì£¼ë¡œ ì „ê¸° ì´ë™ì„±ì— ê´€ë ¨ëœ ì‚¬ì—…ì„ í•˜ëŠ” "Gans" íšŒì‚¬ë¥¼ ìœ„í•œ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ìƒì„±í•˜ëŠ” ê²ƒì„ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤. íŠ¹ì • ì‹œê°„ì— ì¶©ë¶„í•œ ì´ë™ì„± ë‹¨ìœ„ë¥¼ ì œê³µí•˜ê¸° ìœ„í•´ ë‚ ì”¨ ìš”ì†Œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìˆ˜ìš”ë¥¼ ì¸¡ì •í•˜ê¸° ìœ„í•œ ë°ì´í„° ê³¼í•™ìë¥¼ í•„ìš”ë¡œ í•©ë‹ˆë‹¤.</p>
<p>íšŒì‚¬ì˜ ì£¼ìš” ì‚¬ì—…ì€ ë…ì¼ì—ì„œ ìŠ¤ì¿ í„°ë¥¼ ëŒ€ì—¬í•˜ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì— ë¹„ê°€ ì˜¤ê±°ë‚˜ ëˆˆì´ ì˜¤ëŠ” ê²½ìš°ì—ëŠ” ì¼ë°˜ì ìœ¼ë¡œ ìˆ˜ìš”ê°€ ì¤„ì–´ë“¤ê²Œ ë©ë‹ˆë‹¤. ë¹„ë‚˜ ëˆˆì´ ì˜ˆë³´ëœ ê²½ìš°, ì„ì‹œ ìˆ˜ìš”ë„ ì¦ê°€í•  ê²ƒì…ë‹ˆë‹¤.</p>
<p></p>
<p>ë”°ë¼ì„œ, í˜„ì¬ ê³¼ì œëŠ” ë„ì‹œì™€ ë‚ ì”¨ ì •ë³´ë¡œ ì±„ì›Œì§„ ê°„ë‹¨í•œ SQL ë°ì´í„°ë² ì´ìŠ¤ë¥¼ êµ¬ì¶•í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. íšŒì‚¬ì˜ ìš´ì˜ ë¶€ì„œëŠ” ë§¤ì¼ì´ ì´ ë°ì´í„°ë² ì´ìŠ¤ì— ì•¡ì„¸ìŠ¤í•˜ì—¬ ì´ë™ ê°€ëŠ¥ ì°¨ëŸ‰ì˜ ì§€ë¦¬ì  ê°€ìš©ì„±ì— ê´€í•œ íŒë‹¨ì„ ë‚´ë¦´ ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤.</p>
<p>ë‚˜ì¤‘ì— ë°ì´í„°ë² ì´ìŠ¤ëŠ” ê´€ê´‘ê° ë°©ë¬¸ ì˜ˆìƒ ë“±ì„ ì œê³µí•˜ê¸° ìœ„í•´ ê³µê³µ êµí†µ ë„ì°© ì •ë³´(ì˜ˆ: í•­ê³µí¸, ê¸°ì°¨, ë˜ëŠ” ë²„ìŠ¤ API ì‚¬ìš©)ê°€ í¬í•¨ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë“¤ì€ íšŒì‚¬ì˜ ì ì¬ì  ê³ ê° ì¤‘ ì¼ë¶€ì…ë‹ˆë‹¤.</p>
<p>ë‹¤ìŒì€ ë‚ ì”¨ì™€ í•­ê³µí¸ APIë¥¼ í¬í•¨í•œ ì§€ë„ í”„ë¡œì íŠ¸ì˜ ëª¨ìŠµì…ë‹ˆë‹¤:</p>
<p></p>
<p>ì´ ê¸°ì‚¬ì—ì„œëŠ” ë‚ ì”¨ ë°ì´í„° í†µí•©ë§Œ ë‹¤ë£¨ê³  ë‚˜ì¤‘ì— ì „ì†¡ ë¶€ë¶„ì€ ë‚˜ì¤‘ì— ê°œì„ í•  ê²ƒì…ë‹ˆë‹¤.</p>
<p>ì‹œì‘í•˜ê¸° ì „ì— Pythonì—ì„œ í•„ìš”í•œ ëª¨ë“  ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ê°€ì ¸ì™€ì•¼ í•©ë‹ˆë‹¤:</p>
<pre><code class="hljs language-python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup
<span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime
<span class="hljs-keyword">from</span> pytz <span class="hljs-keyword">import</span> timezone
</code></pre>
<h2>ì›¹ ìŠ¤í¬ë˜í•‘ 101: HTML ì½”ë“œë¥¼ ê°€ì ¸ì˜¤ëŠ” ë°©ë²•?</h2>
<p></p>
<p>ë¨¼ì €, ë‹¤ë¥¸ í…Œì´ë¸”ê³¼ ê´€ë ¨í•˜ëŠ” ì£¼ìš” í…Œì´ë¸”ë¡œ ì‘ìš©í•˜ëŠ” ë„ì‹œ ì •ë³´ê°€ í¬í•¨ëœ í…Œì´ë¸”ì„ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤. ì´ í…Œì´ë¸”ì€ ì£¼ê¸°ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•  í•„ìš”ê°€ ì—†ëŠ” ì •ì  í…Œì´ë¸”ì´ ë  ê²ƒì…ë‹ˆë‹¤. ì´ í…Œì´ë¸”ì„ "cities_info"ë¼ê³  ë¶€ë¥¼ ê²ƒì…ë‹ˆë‹¤.</p>
<p>ê° ë„ì‹œì— ëŒ€í•´ ê³ ìœ í•œ ë„ì‹œ ID, ë„ì‹œ ì´ë¦„, ë…ì¼ì˜ ì†Œì† ì£¼(State), ìœ„ë„ ë° ê²½ë„ê°€ í¬í•¨ëœ 5ê°œ ì—´ì´ ìˆì„ ê²ƒì…ë‹ˆë‹¤. ê° ë„ì‹œì— ëŒ€í•œ ì´ ì •ë³´ëŠ” ì˜ì–´ ìœ„í‚¤í”¼ë””ì•„ ì‚¬ì´íŠ¸ì—ì„œ ìŠ¤í¬ë˜í•‘í•˜ì—¬ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆì‚°ì´ í—ˆìš©í•œë‹¤ë©´, ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ì™€ ë°©ë²•ë¡ ì  ì •ë³´ê°€ í¬í•¨ëœ ë„ì‹œì˜ APIë¥¼ êµ¬ë§¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ í”„ë¡œì íŠ¸ì—ì„œëŠ” ìœ„í‚¤í”¼ë””ì•„ë¥¼ ì‚¬ìš©í•˜ì—¬ ìŠ¤í¬ë˜í•‘ ê¸°ìˆ ì„ ì—°ìŠµí•  ê²ƒì…ë‹ˆë‹¤.</p>
<p>ì²˜ìŒì—ëŠ” ê° ì›¹ì‚¬ì´íŠ¸ë§ˆë‹¤ HTML ì½”ë“œë¥¼ ìˆ˜ë™ìœ¼ë¡œ ë‚´ë³´ë‚´ê³  Vs Codeì— ë³µì‚¬í•´ì•¼ í•œë‹¤ëŠ” ìƒê°ì´ ì••ë„ì ì´ì—ˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ë‹¤í–‰íˆ íŒŒì´ì¬ì˜ "requests" ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ë©´ ìë™ìœ¼ë¡œ ìˆ˜í–‰í•  ìˆ˜ ìˆìŒì„ ì•Œê²Œ ë˜ì–´ ì•ˆë„í–ˆìŠµë‹ˆë‹¤:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">import</span> requests
berlin_url = <span class="hljs-string">"https://en.wikipedia.org/wiki/Berlin"</span>
berlin_response = requests.<span class="hljs-title function_">get</span>(berlin_url)
berlin_soup = <span class="hljs-title class_">BeautifulSoup</span>(berlin_response.<span class="hljs-property">content</span>, <span class="hljs-string">'html.parser'</span>)
<span class="hljs-title function_">print</span>(berlin_soup.<span class="hljs-property">prettify</span>)
</code></pre>
<p></p>
<p>íŒŒì´ì¬: 1 - ë‚˜: 0</p>
<h2>ë£¨í”„ì™€ í•¨ìˆ˜</h2>
<p>ì´í„°ë ˆì´ì…˜ì˜ ì„±ë°°ì…ë‹ˆë‹¤. ì´ë“¤ ì—†ì´ëŠ” ë™ì¼í•œ ì½”ë“œë¥¼ ì¬ìƒì‚°í•˜ê³  ë‹¤ë¥¸ URLì— ë™ì‹œì— ì ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì´ê²ƒì´ ì›¹ ìŠ¤í¬ë ˆì´í•‘ì„ ìë™í™”í•˜ëŠ” ì—´ì‡ ì…ë‹ˆë‹¤.</p>
<p>ì—¬ê¸°ì—ëŠ” ê° ìœ„í‚¤í”¼ë””ì•„ ì‚¬ì´íŠ¸ì˜ HTML ì½”ë“œë¥¼ ê²€ìƒ‰í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•œ ë£¨í”„ì˜ ì˜ˆì‹œê°€ ìˆìŠµë‹ˆë‹¤:</p>
<p></p>
<pre><code class="hljs language-js">cities_list = [<span class="hljs-string">"Berlin"</span>, <span class="hljs-string">"Hamburg"</span>, <span class="hljs-string">"Munich"</span>, <span class="hljs-string">"Cologne"</span>, <span class="hljs-string">"Frankfurt"</span>]

<span class="hljs-keyword">for</span> city <span class="hljs-keyword">in</span> <span class="hljs-attr">cities_list</span>:
  url = f<span class="hljs-string">"https://www.wikipedia.org/wiki/{city}"</span>   # urlì„ f ë¬¸ìì—´ë¡œ ë³€í™˜í•˜ì—¬ ë„ì‹œë¥¼ ë³€ìˆ˜ë¡œ ë„£ì–´ í•´ë‹¹ ë„ì‹œì—ì„œ ë‹¤ë¥¸ ë„ì‹œë¡œ ë³€ê²½ë¨
  response = requests.<span class="hljs-title function_">get</span>(url)          # ìœ„í‚¤ë°±ê³¼ í˜ì´ì§€ì˜ ëª¨ë“  ë‚´ìš©ì„ ê°€ì ¸ì™€ responseì— ì €ì¥
  city_soup = <span class="hljs-title class_">BeautifulSoup</span>(response.<span class="hljs-property">content</span>, <span class="hljs-string">'html.parser'</span>)
</code></pre>
<p>ì§€ê¸ˆì€ í•¨ìˆ˜ê°€ ë¬´ì„œì›Œì„œ ìµœëŒ€í•œ í”¼í•˜ê³  ìˆì–´ìš” ğŸ˜…</p>
<p>íŒŒì´ì¬: 1,000 â€” ë‚˜: 0</p>
<h2>HTMLì—ì„œ ë¬´ì—‡ì„ ì ‘ê·¼í•˜ë‚˜ìš”?</h2>
<p></p>
<p>HTMLì—ì„œ "p íƒœê·¸"ë¼ëŠ” ê²ƒì´ ìˆì–´ìš”. ì´ë¥¼ ì•¡ì„¸ìŠ¤í•˜ëŠ” ë° ìœ ìš©í•©ë‹ˆë‹¤. ë‹¤ìŒ ì½”ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ê·¸ë ‡ê²Œ í•  ìˆ˜ ìˆì–´ìš”:</p>
<pre><code class="hljs language-js"><span class="hljs-title function_">print</span>(soup.<span class="hljs-property">p</span>)   # ì²« ë²ˆì§¸ p íƒœê·¸ ìì²´ì— ì ‘ê·¼
<span class="hljs-title function_">print</span>(soup.<span class="hljs-property">p</span>.<span class="hljs-property">string</span>)  # ì²« ë²ˆì§¸ p íƒœê·¸ì™€ ê´€ë ¨ëœ ë¬¸ìì—´ì— ì ‘ê·¼
</code></pre>
<pre><code class="hljs language-js"><span class="hljs-keyword">for</span> child <span class="hljs-keyword">in</span> soup.<span class="hljs-property">div</span>:  # <span class="hljs-number">1</span>ë²ˆì§¸ divì—ì„œ ê° ìì‹ì„ ì°¾ì•„ì„œ ì¸ì‡„í•˜ëŠ” ì˜ˆì œ
    <span class="hljs-title function_">print</span>(child)
</code></pre>
<h2>Pythonì—ì„œ ë°ì´í„°í”„ë ˆì„ ë° SQLì—ì„œ í•´ë‹¹ í…Œì´ë¸” ë§Œë“¤ê¸°</h2>
<p></p>
<p>HTML ë° ì›¹ ìŠ¤í¬ë˜í•‘ ê¸°ìˆ ì„ ì—°ë§ˆí•œ í›„, ì²« ë‘ í…Œì´ë¸”ì— í•„ìš”í•œ ëª¨ë“  ì •ë³´ë¥¼ ì–»ê¸° ìœ„í•´ ì´ ë£¨í”„ë¥¼ ë§Œë“¤ì—ˆì–´ìš”.</p>
<p>ì²« ë²ˆì§¸ ë°ì´í„°í”„ë ˆì„ì€ ì •ì  ì¸ë±ìŠ¤ë¡œ ì‘ë™í•  ê²ƒì´ê³  (ì¦‰, ì •ë³´ë¥¼ ì •ê¸°ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•  í•„ìš”ê°€ ì—†ì–´ìš”): cities_info</p>
<pre><code class="hljs language-js">cities_list = [<span class="hljs-string">"ë² ë¥¼ë¦°"</span>, <span class="hljs-string">"í•¨ë¶€ë¥´í¬"</span>, <span class="hljs-string">"ë®Œí—¨"</span>, <span class="hljs-string">"ì¾°ë¥¸"</span>, <span class="hljs-string">"í”„ë‘í¬í‘¸ë¥´íŠ¸"</span>]
states = []
latitudes = []
longitudes = []

<span class="hljs-keyword">for</span> city <span class="hljs-keyword">in</span> <span class="hljs-attr">cities_list</span>:
  url = f<span class="hljs-string">"https://www.wikipedia.org/wiki/{city}"</span>
  city_soup = <span class="hljs-title class_">BeautifulSoup</span>(response.<span class="hljs-property">content</span>, <span class="hljs-string">'html.parser'</span>)    # (ìœ„í‚¤ë°±ê³¼ ì‚¬ì´íŠ¸ì˜ ë‚´ìš©ì„ city_soup ë³€ìˆ˜ì— ì €ì¥í•˜ëŠ”) ë‚´ìš©ì„ êµ¬ë¬¸ ë¶„ì„í•©ë‹ˆë‹¤.

  # ë„ì‹œê°€ ì†í•œ ì£¼ë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤
  <span class="hljs-keyword">if</span> city not <span class="hljs-keyword">in</span> [<span class="hljs-string">"í•¨ë¶€ë¥´í¬"</span>, <span class="hljs-string">"ë² ë¥¼ë¦°"</span>]:         # ë² ë¥¼ë¦°ì˜ ê²½ìš° ì¼ë°˜ì ì¸ .<span class="hljs-property">find</span> ê³µì‹ë„ ì‘ë™í•  ê±°ì˜ˆìš”! ì£¼ ì„¹ì…˜ì´ ì—†ëŠ” <span class="hljs-string">"í•¨ë¶€ë¥´í¬"</span>ë§Œì´ ì˜ˆì™¸ì—ìš”
    city_state = city_soup.<span class="hljs-title function_">find</span>(<span class="hljs-string">"table"</span>, class_=<span class="hljs-string">"vcard"</span>).<span class="hljs-title function_">find</span>(string=<span class="hljs-string">"ì£¼"</span>).<span class="hljs-title function_">find_next</span>(<span class="hljs-string">"td"</span>).<span class="hljs-title function_">get_text</span>()  # ë‹¤ë¥¸ ì£¼ ì´ë¦„ì„ ê°€ì§„ ë„ì‹œì— ëŒ€í•œ ì£¼ë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤
  <span class="hljs-attr">else</span>:
    city_state = city     # í•¨ë¶€ë¥´í¬ì™€ ë² ë¥¼ë¦°ì˜ ê²½ìš°, ë™ëª…ì˜ ë„ì‹œ ì´ë¦„ì„ ê°€ì ¸ì˜¬ ê±°ì˜ˆìš”
  states.<span class="hljs-title function_">append</span>(city_state)

  # ê° ë„ì‹œì˜ ìœ„ë„ë¥¼ ê²€ìƒ‰í•˜ì—¬ ìœ„ë„ ì—´ì— ì¶”ê°€í•©ë‹ˆë‹¤
  city_latitude = city_soup.<span class="hljs-title function_">find</span>(class_=<span class="hljs-string">"latitude"</span>).<span class="hljs-title function_">get_text</span>()
  latitudes.<span class="hljs-title function_">append</span>(city_latitude)

   # ê° ë„ì‹œì˜ ê²½ë„ë¥¼ ê²€ìƒ‰í•˜ì—¬ ê²½ë„ ì—´ì— ì¶”ê°€í•©ë‹ˆë‹¤
  city_longitude = city_soup.<span class="hljs-title function_">find</span>(class_=<span class="hljs-string">"longitude"</span>).<span class="hljs-title function_">get_text</span>()
  longitudes.<span class="hljs-title function_">append</span>(city_longitude)

cities_info_non_rel = pd.<span class="hljs-title class_">DataFrame</span>({         # ì´ê²ƒì´ cities_info ë°ì´í„°í”„ë ˆì„ì´ì—ìš”
    <span class="hljs-string">"ë„ì‹œ ì´ë¦„"</span>: cities_list,
    <span class="hljs-string">"ë…ì¼ ì£¼"</span>: states,
    <span class="hljs-string">"ìœ„ë„"</span>: latitudes,
    <span class="hljs-string">"ê²½ë„"</span>: longitudes
})

<span class="hljs-title function_">display</span>(cities_info_non_rel)    # í‘œì‹œí•˜ë©´ í…Œì´ë¸”ì´ ë” ì˜ˆì˜ê²Œ ë³´ì—¬ìš”
</code></pre>
<p>ë˜í•œ, ì—°ê°„ í•œ ë²ˆì”© ì—…ë°ì´íŠ¸ë  ê²ƒìœ¼ë¡œ ì˜ˆìƒë˜ëŠ” ì¸êµ¬ ë°ì´í„°ë¥¼ í¬í•¨í•˜ëŠ” ë‘ ë²ˆì§¸ ë°ì´í„°í”„ë ˆì„ë„ ìƒì„±í–ˆì–´ìš”: cities_population</p>
<p></p>
<pre><code class="hljs language-sql"><span class="hljs-comment">/***************************
í™˜ê²½ ì„¤ì •
***************************/</span>

<span class="hljs-comment">-- ë°ì´í„°ë² ì´ìŠ¤ê°€ ì´ë¯¸ ìˆëŠ” ê²½ìš° ì‚­ì œ</span>
<span class="hljs-keyword">DROP</span> DATABASE IF <span class="hljs-keyword">EXISTS</span> gans;

<span class="hljs-comment">-- ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±</span>
<span class="hljs-keyword">CREATE</span> DATABASE gans;

<span class="hljs-comment">-- ë°ì´í„°ë² ì´ìŠ¤ ì‚¬ìš©</span>
USE gans;


<span class="hljs-comment">/***************************
ì²« ë²ˆì§¸ í…Œì´ë¸” ìƒì„±
***************************/</span>

<span class="hljs-comment">-- 'cities_info' í…Œì´ë¸” ìƒì„±</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> cities_info (
    cities_id <span class="hljs-type">INT</span> AUTO_INCREMENT, <span class="hljs-comment">-- ë„ì‹œë§ˆë‹¤ ìë™ìœ¼ë¡œ ìƒì„±ëœ ID</span>
    city_name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>, <span class="hljs-comment">-- ë„ì‹œ ì´ë¦„</span>
    german_state <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>, <span class="hljs-comment">-- ì£¼ ì´ë¦„</span>
    latitude <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>, <span class="hljs-comment">-- ìœ„ë„ ì¢Œí‘œ</span>
    longitude <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>, <span class="hljs-comment">-- ê²½ë„ ì¢Œí‘œ</span>
    <span class="hljs-keyword">PRIMARY</span> KEY (cities_id) <span class="hljs-comment">-- ê° ë„ì‹œë¥¼ ê³ ìœ í•˜ê²Œ ì‹ë³„í•˜ê¸° ìœ„í•œ ê¸°ë³¸ í‚¤</span>
    );


<span class="hljs-comment">/***************************
ë‘ ë²ˆì§¸ í…Œì´ë¸” ìƒì„±
***************************/</span>

<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> cities_population (
    cities_id <span class="hljs-type">INT</span>,
    population <span class="hljs-type">INT</span>, <span class="hljs-comment">-- ì¸êµ¬ìˆ˜</span>
    year_data_retrieved <span class="hljs-type">INT</span>, <span class="hljs-comment">-- ì¸êµ¬ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•œ í•´ë‹¹ ë…„ë„</span>
    <span class="hljs-keyword">FOREIGN</span> KEY (cities_id) <span class="hljs-keyword">REFERENCES</span> cities_info(cities_id)
);
</code></pre>
<p>ì´ì œ Pythonì—ì„œ ë°ì´í„°ë¥¼ ì²« ë²ˆì§¸ SQL í…Œì´ë¸”ë¡œ ì „ì†¡í•©ë‹ˆë‹¤:</p>
<p></p>
<pre><code class="hljs language-js">schema = <span class="hljs-string">"gans"</span>     # ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„
host = <span class="hljs-string">"xxx.x.x.x"</span>
user = <span class="hljs-string">"root"</span>               # ì‚¬ìš©ì ì´ë¦„
password = <span class="hljs-string">"xxxx"</span>           # <span class="hljs-variable constant_">SQL</span> ì•”í˜¸ ì§ì ‘ ì§€ì • ë˜ëŠ” ë‹¤ë¥¸ ë…¸íŠ¸ë¶ì—ì„œ ê°€ì ¸ì˜¤ê¸° (<span class="hljs-string">"from xxxfile import my_password"</span>)
port = <span class="hljs-number">3306</span>

connection_string = f<span class="hljs-string">'mysql+pymysql://{user}:{password}@{host}:{port}/{schema}'</span>
# ì´ê±´ íŒŒì´ì¬ ë…¸íŠ¸ë¶ì„ <span class="hljs-variable constant_">SQL</span> <span class="hljs-title class_">Workbench</span>ì— ì—°ê²°í•˜ëŠ” ë°©ë²•ì´ì—ìš”
</code></pre>
<pre><code class="hljs language-js">cities_info_non_rel.<span class="hljs-title function_">to_sql</span>(<span class="hljs-string">'cities_info'</span>,   # íŒŒì´ì¬ì—ì„œ <span class="hljs-variable constant_">SQL</span>ë¡œ ë°ì´í„°ë¥¼ ë³´ë‚´ëŠ” ë°©ë²•
                  if_exists=<span class="hljs-string">'append'</span>,       # ë®ì–´ì“°ì§€ ì•Šê³  ê¸°ì¡´ ë°ì´í„°ì— ì¶”ê°€í•˜ê¸° ìœ„í•¨
                  con=connection_string,    # <span class="hljs-variable constant_">SQL</span> <span class="hljs-title class_">Workbench</span>ì— ì—°ê²°í•  ë•Œ í•„ìš”í•œ ì¸ì
                  index=<span class="hljs-title class_">False</span>)
</code></pre>
<p>ì²« ë²ˆì§¸ ì‹œë„ëŠ” ë¡œì»¬ì—ì„œ ì´ë£¨ì–´ì¡ŒìŠµë‹ˆë‹¤. ë‚˜ì¤‘ì— Google Cloud Platform ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì¶”ê°€í•˜ë©´ "host" í•„ë“œë¥¼ í¸ì§‘í•˜ì—¬ ì´ ë°ì´í„°ë¥¼ í´ë¼ìš°ë“œì— ì§ì ‘ ì „ì†¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>SQLì— ì²« ë²ˆì§¸ í…Œì´ë¸”ì´ ìƒì„±ë˜ë©´ cities_infoì— í¬í•¨ëœ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•˜ì—¬ ë‘ ë²ˆì§¸ cities_population ë°ì´í„° í”„ë ˆì„ì—ì„œ í•´ë‹¹ cities_id ì—´ì„ ì¸ë±ìŠ¤ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<p></p>
<pre><code class="hljs language-js">cities_info = pd.<span class="hljs-title function_">read_sql</span>(<span class="hljs-string">"cities_info"</span>, con=connection_string)   # ì´ ì½”ë“œëŠ” <span class="hljs-variable constant_">SQL</span>ì— ì €ì¥ëœ ì •ë³´ë¥¼ <span class="hljs-string">"ì½ì–´ì˜µë‹ˆë‹¤"</span>
cities_info
</code></pre>
<p>ë‹¤ìŒì€ cities_infoì˜ ëª¨ìŠµì…ë‹ˆë‹¤:</p>
<p>ë‘ ë²ˆì§¸ ë°ì´í„°í”„ë ˆì„ì˜ ë‚´ìš©ì„ SQLë¡œ ë„£ê¸° ì „ì—, ìƒˆë¡œ ìƒì„±ëœ cities_id ì—´ì„ ì‚¬ìš©í•˜ì—¬ cities_populations ë°ì´í„°í”„ë ˆì„ì— ì¶”ê°€í•´ì•¼ í•©ë‹ˆë‹¤.</p>
<p></p>
<p>ì•„ë˜ëŠ” ì¹¼ëŸ¼ ìˆœì„œë¥¼ ì¬ì¡°ì •í•˜ê³ , ì´ì œ cities_populations ë°ì´í„°í”„ë ˆì„ì— cities_id ì¹¼ëŸ¼ì´ ìˆê¸° ë•Œë¬¸ì— ë” ì´ìƒ city_name ì¹¼ëŸ¼ì´ í•„ìš”í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì‚­ì œí–ˆìŠµë‹ˆë‹¤:</p>
<pre><code class="hljs language-js"># ë‹¤ë¥¸ ì¸êµ¬ ë°ì´í„°í”„ë ˆì„ì— cities_id ì¹¼ëŸ¼ì„ ì¶”ê°€í•©ë‹ˆë‹¤
cities_population[<span class="hljs-string">"cities_id"</span>] = cities_info_non_rel[<span class="hljs-string">"cities_id"</span>]
cities_population

# city_name ì¹¼ëŸ¼ì€ ë” ì´ìƒ í•„ìš”í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ì‚­ì œí•˜ê³  ì¹¼ëŸ¼ ìˆœì„œë¥¼ ë°”ê¿” ë” ì§ê´€ì ìœ¼ë¡œ ë§Œë“­ë‹ˆë‹¤
cities_population = cities_population[[<span class="hljs-string">"cities_id"</span>, <span class="hljs-string">"population"</span>, <span class="hljs-string">"year_data_retrieved"</span>]]
cities_population
</code></pre>
<p>ê·¸ë¦¬ê³  ì œ ë‘ ë²ˆì§¸ ë°ì´í„°í”„ë ˆì„ì´ ìˆìŠµë‹ˆë‹¤. ì´ ë°ì´í„°í”„ë ˆì„ì€ ì¼ë¶€ ë™ì ì…ë‹ˆë‹¤(ë°ì´í„°ê°€ ë•Œë•Œë¡œ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤. ì˜ˆ: ì—°ê°„ í•œ ë²ˆ):</p>
<p><img src="/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_2.png" alt="ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ì€ ì—”ì§€ë‹ˆì–´ë¥¼ ìœ„í•œ ê²ƒ"></p>
<p></p>
<p>ë‹¹ë¶„ê°„ì€, ë‹¤ìŒ í•´ê¹Œì§€ ì—…ë°ì´íŠ¸ë˜ì§€ ì•Šì„ ë™ì ì´ ì•„ë‹Œ cities_population í…Œì´ë¸”ë¡œ ê°„ì£¼í•˜ê² ìŠµë‹ˆë‹¤.</p>
<p>ì´ì œ ìš°ë¦¬ëŠ” ë¡œì»¬ SQL ì¸ìŠ¤í„´ìŠ¤ë¡œ ë‚´ìš©ì„ í‘¸ì‹œí•  ì¤€ë¹„ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤:</p>
<pre><code class="hljs language-js"># ë‘ ë²ˆì§¸ í…Œì´ë¸” ë‚´ìš©ì„ <span class="hljs-variable constant_">SQL</span>ë¡œ í‘¸ì‹œí•©ë‹ˆë‹¤
cities_population.<span class="hljs-title function_">to_sql</span>(<span class="hljs-string">'cities_population'</span>,   # ì´ë ‡ê²Œ í•˜ë©´ <span class="hljs-title class_">Python</span>ì—ì„œ <span class="hljs-variable constant_">SQL</span>ë¡œ í‘¸ì‹œí•©ë‹ˆë‹¤
                  if_exists=<span class="hljs-string">'append'</span>,       # ë®ì–´ì“°ê¸°ë¥¼ ì›í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ, ê¸°ì¡´ ë°ì´í„°ì—ë§Œ ë°ì´í„°ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤
                  con=connection_string,    # conì€ sql workbenchì— ì—°ê²°í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ì¸ìì…ë‹ˆë‹¤
                  index=<span class="hljs-title class_">False</span>)
</code></pre>
<p>SQLì—ì„œ ëª¨ë“  ê²ƒì„ ì‹¤í–‰í•˜ê³  "ì—­ê³µí•™" ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë©´, ìš°ë¦¬ì˜ ìŠ¤í‚¤ë§ˆì˜ ê°€ì¥ ì´ˆê¸° ë²„ì „ì„ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<p></p>
<p>ìš°ë¦¬ëŠ” í•™ìŠµ ê³¡ì„  ì†ìœ¼ë¡œ ë” ê¹Šì´ íŒŒê³ ë“¤ê³  ìˆì–´ìš”.</p>
<p>ë‹¤ìŒ ë‹¨ê³„: APIë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— í†µí•©í•˜ê¸°. ì§€êµ¬ìƒì˜ ëª¨ë“  ë°ì´í„° ê³¼í•™ìì˜ ë³¸ì§ˆì´ë¼ê³  í•  ìˆ˜ ìˆì£ .</p>
<p>AIê°€ ë”°ë¼ì¡ê¸° ì „ì— ì–´ë–»ê²Œ í•´ì•¼ í• ì§€ ë°°ì›Œì•¼ê² ë„¤ìš”! (ë˜ëŠ” ì™¸ê³„ì¸ì´ ê·¸ë“¤ì˜ ë°ì´í„° ìš”êµ¬ë¥¼ ì–´ë–»ê²Œ ì²˜ë¦¬í•˜ëŠ”ì§€ë¥¼ ë³´ì¼ ë•Œê¹Œì§€) ğŸ‘½</p>
<p></p>
<h2>ë‚ ì”¨ API ì‚¬ìš©í•˜ê¸°</h2>
<p>ì´ í”„ë¡œì íŠ¸ì˜ ì„¸ ë²ˆì§¸ í° ë‹¨ê³„ëŠ” í˜„ì¬ ì¡´ì¬í•˜ëŠ” ë°ì´í„° ì €ì¥ì†Œì—ì„œ ë‚ ì”¨ ë°ì´í„°ë¥¼ ì¶”ì¶œí•˜ê³  SQL ë°ì´í„°ë² ì´ìŠ¤ì— í†µí•©í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ëŸ¬í•œ ì €ì¥ì†Œë“¤ì€ APIë¥¼ í†µí•´ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. APIëŠ” Application Programming Interfaceì˜ ì•½ìë¡œ, ì„œë¡œ ë‹¤ë¥¸ ì†Œí”„íŠ¸ì›¨ì–´ ì‘ìš© í”„ë¡œê·¸ë¨ ê°„ì— í†µì‹ í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê·œì¹™ê³¼ í”„ë¡œí† ì½œì˜ ì§‘í•©ì…ë‹ˆë‹¤.</p>
<p>ì´ë¥¼ ìœ„í•´ ìš°ë¦¬ëŠ” openweathermap.org ì›¹ì‚¬ì´íŠ¸ë¥¼ ì‚¬ìš©í•  ê²ƒì…ë‹ˆë‹¤. ì´ ì‚¬ì´íŠ¸ë¥¼ í†µí•´ ì „ ì„¸ê³„ ì–´ëŠ ìœ„ì¹˜ì˜ ë¬´ë£Œ ë‚ ì”¨ ì˜ˆë³´ì—ë„ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìš°ë¦¬ëŠ” 5ì¼ ë‚ ì”¨ ì˜ˆë³´ APIë¥¼ ì‚¬ìš©í•  ê²ƒì´ë©°, 3ì‹œê°„ ê°„ê²©ì˜ ì˜ˆë³´ ë°ì´í„°ë¥¼ í¬í•¨í•©ë‹ˆë‹¤: <a href="https://openweathermap.org/forecast5" rel="nofollow" target="_blank">https://openweathermap.org/forecast5</a></p>
<p>ì´ì œ ìš°ë¦¬ í”„ë¡œì íŠ¸ì˜ í•µì‹¬ ì‘ì—…ì— ì§ë©´í–ˆìŠµë‹ˆë‹¤: ìš°ë¦¬ê°€ ì›í•˜ëŠ” ë‚ ì”¨ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•˜ê³  SQL ë°ì´í„°ë² ì´ìŠ¤ë¡œ ì „ì†¡í•˜ê¸° ìœ„í•œ í•„ìš”í•œ ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ìˆ˜ì‹­ ì‹œê°„ ë™ì•ˆ ê³ êµ°ë¶„íˆ¬í•œ ê²°ê³¼, ê°€ì¥ ê´€ë ¨ì„± ìˆëŠ” ë‚ ì”¨ ë°ì´í„°ë¥¼ ì¶”ì¶œí•˜ê¸° ìœ„í•œ ì´ ì½”ë“œë¥¼ ê°œë°œí•´ëƒˆìŠµë‹ˆë‹¤:</p>
<p></p>
<pre><code class="hljs language-js">def <span class="hljs-title function_">get_weather_data</span>(cities):
  # í´ë¼ìš°ë“œì—ì„œ ì‘ì—…í•  ì˜ˆì •ì´ë¯€ë¡œ ì»´í“¨í„°ëŠ” ì–´ë””ì— ìˆì„ì§€ ëª¨ë¦…ë‹ˆë‹¤ - ì»´í“¨í„° ì‹œê°„ëŒ€ë¥¼ ìš°ë¦¬ ì§€ì—­ ì‹œê°„ëŒ€ë¡œ ìˆ˜ì •í•©ì‹œë‹¤.
  berlin_timezone = <span class="hljs-title function_">timezone</span>(<span class="hljs-string">"Europe/Berlin"</span>)
  API_key = <span class="hljs-string">"7e5623c79f102b6c08b15c8hjib4cc9l"</span>    # ì´ê²ƒì€ ì‹¤ì œ ê°’ì´ ì•„ë‹™ë‹ˆë‹¤.
  weather_items = []

  <span class="hljs-keyword">for</span> city <span class="hljs-keyword">in</span> <span class="hljs-attr">cities</span>:
    url = (f<span class="hljs-string">"http://api.openweathermap.org/data/2.5/forecast?q={city}&#x26;appid={API_key}&#x26;units=metric"</span>)
    response = requests.<span class="hljs-title function_">get</span>(url)
    json = response.<span class="hljs-title function_">json</span>()

    # ì˜ˆë³´ë¥¼ ì‘ì„±í•œ ì‹œê°„ì„ ì•Œê¸° ìœ„í•´ ê²€ìƒ‰ ì‹œê°„ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.
    retrieval_time = datetime.<span class="hljs-title function_">now</span>(berlin_timezone).<span class="hljs-title function_">strftime</span>(<span class="hljs-string">"%Y-%m-%d %H:%M:%S"</span>)

    # ì´ì œ ìš°ë¦¬ì˜ ê´€ë ¨ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ, ë„ì‹œëŠ” ë„ì‹œ ì´ë¦„ì´ ì•„ë‹Œ ë„ì‹œ <span class="hljs-variable constant_">ID</span>ë¥¼ ë°˜ì˜í•´ì•¼ í•©ë‹ˆë‹¤.
    city_id = cities_info.<span class="hljs-property">loc</span>[cities_info[<span class="hljs-string">"city_name"</span>] == city, <span class="hljs-string">"city_id"</span>].<span class="hljs-property">values</span>[<span class="hljs-number">0</span>]  # ì—¬ê¸°ì—ì„œ ê°’ë“¤ì„ ê²€ìƒ‰í•´ì•¼ í•˜ë©°, ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ì‹œë¦¬ì¦ˆë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.

    <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> json[<span class="hljs-string">"list"</span>]:
        weather_item = {
            # ì—¬ëŸ¬ ë„ì‹œë¥¼ ê³ ë ¤í•  ë•Œ ì •ë³´ë¥¼ ëª…í™•íˆ ì•Œ ìˆ˜ ìˆê²Œ ë„ì‹œ ì´ë¦„ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.
            <span class="hljs-string">"city_id"</span>: city_id,
            <span class="hljs-string">"forecast_time"</span>: item.<span class="hljs-title function_">get</span>(<span class="hljs-string">"dt_txt"</span>, <span class="hljs-title class_">None</span>),
            <span class="hljs-string">"temperature"</span>: item[<span class="hljs-string">"main"</span>].<span class="hljs-title function_">get</span>(<span class="hljs-string">"temp"</span>, <span class="hljs-title class_">None</span>),
            <span class="hljs-string">"feels_like"</span>: item[<span class="hljs-string">"main"</span>].<span class="hljs-title function_">get</span>(<span class="hljs-string">"feels_like"</span>, <span class="hljs-title class_">None</span>),
            <span class="hljs-string">"forecast"</span>: item[<span class="hljs-string">"weather"</span>][<span class="hljs-number">0</span>].<span class="hljs-title function_">get</span>(<span class="hljs-string">"main"</span>, <span class="hljs-title class_">None</span>),
            <span class="hljs-string">"humidity"</span>: item[<span class="hljs-string">"main"</span>].<span class="hljs-title function_">get</span>(<span class="hljs-string">"humidity"</span>, <span class="hljs-title class_">None</span>),
            <span class="hljs-string">"rain_in_last_3h"</span>: item.<span class="hljs-title function_">get</span>(<span class="hljs-string">"rain"</span>, {}).<span class="hljs-title function_">get</span>(<span class="hljs-string">"3h"</span>, <span class="hljs-number">0</span>),
            <span class="hljs-string">"risk_of_rain"</span>: item[<span class="hljs-string">"pop"</span>],
            <span class="hljs-string">"snow_in_last_3h"</span>: item.<span class="hljs-title function_">get</span>(<span class="hljs-string">"snow"</span>, {}).<span class="hljs-title function_">get</span>(<span class="hljs-string">"3h"</span>, <span class="hljs-number">0</span>),
            <span class="hljs-string">"wind_speed"</span>: item[<span class="hljs-string">"wind"</span>].<span class="hljs-title function_">get</span>(<span class="hljs-string">"speed"</span>, <span class="hljs-title class_">None</span>),
            <span class="hljs-string">"data_retrieved_at"</span>: retrieval_time
        }

        weather_items.<span class="hljs-title function_">append</span>(weather_item)

  weather_df = pd.<span class="hljs-title class_">DataFrame</span>(weather_items)
  weather_df[<span class="hljs-string">"forecast_time"</span>] = pd.<span class="hljs-title function_">to_datetime</span>(weather_df[<span class="hljs-string">"forecast_time"</span>])
  weather_df[<span class="hljs-string">"data_retrieved_at"</span>] = pd.<span class="hljs-title function_">to_datetime</span>(weather_df[<span class="hljs-string">"data_retrieved_at"</span>])
  weather_df[<span class="hljs-string">"snow_in_last_3h"</span>] = pd.<span class="hljs-title function_">to_numeric</span>(weather_df[<span class="hljs-string">"snow_in_last_3h"</span>], downcast=<span class="hljs-string">"float."</span>)

  <span class="hljs-keyword">return</span> weather_df

weather_df = <span class="hljs-title function_">get_weather_data</span>([<span class="hljs-string">"Berlin"</span>, <span class="hljs-string">"Hamburg"</span>, <span class="hljs-string">"Munich"</span>, <span class="hljs-string">"Cologne"</span>, <span class="hljs-string">"Frankfurt"</span>])
weather_df     # í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒˆë¡œìš´ ë°ì´í„°í”„ë ˆì„ ìƒì„±
</code></pre>
<p>ë‚ ì”¨ ë°ì´í„°í”„ë ˆì„ ë° í…Œì´ë¸”ì˜ ì¤‘ìš” ê¸°ëŠ¥ ì¤‘ í•˜ë‚˜ëŠ” ë°ì´í„° ê²€ìƒ‰ ì‹œê°„ì„ ê¸°ë¡í•˜ëŠ” ì—´ì„ í¬í•¨í•´ì•¼ í•œë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ í•„í„°ë§ ë° ì¼ì •í•œ ê¸°ê°„ í›„ ìë™ìœ¼ë¡œ ì´ì „ ë°ì´í„°ê°€ ì‚­ì œë˜ë„ë¡ SQLì—ì„œ í”„ë¡œì‹œì €ë‚˜ í•¨ìˆ˜ë¥¼ ì‘ì„±í•˜ê±°ë‚˜ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ë°ì´í„° ì¼ê´€ì„± ëª©ì ìœ¼ë¡œ ë‚ ì”¨ì™€ ë°ì´í„° ê²€ìƒ‰ ì‹œê°„ì´ í•­ìƒ ì˜ˆë³´ì— ëŒ€í•œ ë‚ ì§œ/ì‹œê°„ê³¼ ë‹¤ë¥¸ ê²ƒì„ì„ í•­ìƒ ì¸ì‹í•  ìˆ˜ ìˆë„ë¡ í•˜ê¸° ìœ„í•œ ê²ƒì…ë‹ˆë‹¤.</p>
<p>ì´ê²ƒì´ Pythonì—ì„œ ìƒˆë¡œìš´ ë‚ ì”¨ ë°ì´í„°í”„ë ˆì„ì´ ë³´ì´ëŠ” ë°©ì‹ì…ë‹ˆë‹¤:</p>
<p></p>
<p>ì¼ë‹¨ ë‚ ì”¨ ë°ì´í„°í”„ë ˆì„ êµ¬ì¡°ë¥¼ ê°€ì§€ê³  ìˆì—ˆì„ ë•Œ, SQLì—ì„œ ë‚ ì”¨ í…Œì´ë¸”ì„ ìƒì„±í•˜ëŠ” ì‘ì—…ì„ ì‹œì‘í–ˆìŠµë‹ˆë‹¤:</p>
<pre><code class="hljs language-js"><span class="hljs-comment">/***************************
ë‚ ì”¨ í…Œì´ë¸”ì„ ìƒì„±í•©ë‹ˆë‹¤
***************************/</span>

<span class="hljs-variable constant_">CREATE</span> <span class="hljs-variable constant_">TABLE</span> weather (
    city_id <span class="hljs-variable constant_">INT</span>,
    forecast_time datetime,
    temperature float,
    feels_like float,
    forecast <span class="hljs-title function_">VARCHAR</span>(<span class="hljs-number">255</span>) <span class="hljs-variable constant_">NOT</span> <span class="hljs-variable constant_">NULL</span>,
    humidity <span class="hljs-variable constant_">INT</span>,
    rain_in_last_3h <span class="hljs-variable constant_">FLOAT</span>,
    risk_of_rain <span class="hljs-variable constant_">FLOAT</span>,
    snow_in_last_3h <span class="hljs-variable constant_">FLOAT</span>,
    wind_speed <span class="hljs-variable constant_">FLOAT</span>,
    data_retrieved_at <span class="hljs-variable constant_">DATETIME</span>,
    <span class="hljs-variable constant_">FOREIGN</span> <span class="hljs-variable constant_">KEY</span> (city_id) <span class="hljs-variable constant_">REFERENCES</span> <span class="hljs-title function_">cities_info</span>(city_id)
    );

-- <span class="hljs-variable constant_">TRUNCATE</span> <span class="hljs-variable constant_">TABLE</span> weather;   -- í…Œì´ë¸”ì´ ë„ˆë¬´ ì»¤ì§€ê³  ë°ì´í„°ê°€ ì˜¤ë˜ë˜ì—ˆì„ ë•Œ ëª¨ë“  í–‰ì„ ì§€ì›Œì•¼ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤
</code></pre>
<p>ì´ê²ƒì€ ì—”ì§€ë‹ˆì–´ë§ì„ í†µí•´ ì—­ ê³µí•™ì„ ê±°ì³ ì—…ë°ì´íŠ¸ëœ SQL ìŠ¤í‚¤ë§ˆì…ë‹ˆë‹¤:</p>
<p></p>
<h2>ì§€ì—­ì—ì„œ ì „ì—­ìœ¼ë¡œ</h2>
<p>ìš°ë¦¬ì˜ ì½”ë“œë¥¼ í´ë¼ìš°ë“œì— ì˜¬ë¦¬ê¸° ì „ì—, ë‚ ì”¨ ë°ì´í„° ê²€ìƒ‰ ì½”ë“œê°€ ë¡œì»¬ì—ì„œ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤. Pythonìœ¼ë¡œ ì½”ë“œë¥¼ ì‘ì„±í•œ í›„, ë¡œì»¬ SQL ì¸ìŠ¤í„´ìŠ¤ë¡œ ì „ì†¡í•´ë³´ê² ìŠµë‹ˆë‹¤:</p>
<pre><code class="hljs language-python">weather_df.to_sql(<span class="hljs-string">"weather"</span>,
                  if_exists=<span class="hljs-string">'append'</span>,
                  con=connection_string,
                  index=<span class="hljs-literal">False</span>)
</code></pre>
<p>ë§Œì•½ ìƒˆ ë°ì´í„°ê°€ ìš°ë¦¬ì˜ SQL í…Œì´ë¸”ì— ì¶”ê°€ëœë‹¤ë©´, ì‘ë™í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤!</p>
<p></p>
<p>íŒŒì´ì¬ì„ í†µí•´ ë¡œì»¬ ë°ì´í„°ë¥¼ ì…ë ¥í•œ í›„ SQL ë‚ ì”¨ í…Œì´ë¸”ì´ ì–´ë–»ê²Œ ë³´ì´ëŠ”ì§€ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:</p>
<p><img src="/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_6.png" alt="Weather Table"></p>
<h2>Google Cloud Platform í†µí•©</h2>
<p>ë¡œì»¬ì—ì„œ ì½”ë“œê°€ ì‘ë™í•˜ëŠ” ê²ƒì„ í™•ì¸í•˜ë©´, ì´ì œ í´ë¼ìš°ë“œì— ì˜¬ë ¤ë³´ëŠ” ì‹œê°„ì…ë‹ˆë‹¤.</p>
<p></p>
<p>êµ¬ê¸€ í´ë¼ìš°ë“œ í”Œë«í¼(GCP) ê³„ì •ì„ ì—´ê³  í´ë¼ìš°ë“œ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” ìì„¸íˆ ë‹¤ë£¨ì§€ëŠ” ì•Šê² ì§€ë§Œ MySQLì„ ì‚¬ìš©í•œ ì¢‹ì€ ë‹¨ê³„ë³„ ì„¤ëª…ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤: <a href="https://support.google.com/appsheet/answer/10107301?hl=en" rel="nofollow" target="_blank">https://support.google.com/appsheet/answer/10107301?hl=en</a></p>
<p>ì œê²Œ ê°€ì¥ ì¤‘ìš”í•œ ë‹¨ê³„ ì¤‘ í•˜ë‚˜ëŠ” íŒŒì´ì¬ ë…¸íŠ¸ë¶ì—ì„œ ë¡œì»¬ IP í˜¸ìŠ¤íŠ¸ë¥¼ êµ¬ê¸€ IP í˜¸ìŠ¤íŠ¸ë¡œ ë³€ê²½í•˜ëŠ” ê²ƒì´ì—ˆìŠµë‹ˆë‹¤. êµ¬ì²´ì ìœ¼ë¡œ, ë°ì´í„°ë¥¼ SQLë¡œ ì „ì†¡í•˜ëŠ” ì½”ë“œ ë¸”ë¡ì—ì„œ ë³€ê²½í–ˆìŠµë‹ˆë‹¤:</p>
<pre><code class="hljs language-js">schema = <span class="hljs-string">"gans"</span>         # ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„
host = <span class="hljs-string">"XX.XXX.XX.XX"</span>   # ë¡œì»¬ í˜¸ìŠ¤íŠ¸:<span class="hljs-string">"xxx.x.x.x"</span> (í´ë¼ìš°ë“œë¡œ ë³€ê²½í•˜ê¸° ì „)
user = <span class="hljs-string">"root"</span>           # ì‚¬ìš©ì ì´ë¦„ (ê°€ì´ë“œ ì°¸ì¡°)
password = <span class="hljs-string">"XXXX"</span>       # ë¹„ë°€ë²ˆí˜¸ ì§ì ‘ ì…ë ¥í•˜ê±°ë‚˜ ë‹¤ë¥¸ ë…¸íŠ¸ë¶ì—ì„œ ê°€ì ¸ì˜µë‹ˆë‹¤ (<span class="hljs-string">"from xxxfile import my_password"</span>)
port = <span class="hljs-number">3306</span>

connection_string = f<span class="hljs-string">'mysql+pymysql://{user}:{password}@{host}:{port}/{schema}'</span>     # ì´ ë¶€ë¶„ì´ íŒŒì´ì¬ ë…¸íŠ¸ë¶ì„ <span class="hljs-variable constant_">SQL</span> ì›Œí¬ë²¤ì¹˜ì— ì—°ê²°í•˜ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤
</code></pre>
<p>ì´ë ‡ê²Œ í•¨ìœ¼ë¡œì¨, ì´ì „ì— ìƒì„±í•œ ì •ì  í…Œì´ë¸”ì„ í´ë¼ìš°ë“œì— ìë™ìœ¼ë¡œ ì—…ë¡œë“œí•˜ê³  íŒŒì´ì¬ì—ì„œ ì½”ë“œë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•˜ì§€ ì•Šê³  ì´ë¯¸ ì¡´ì¬í•˜ëŠ” SQL í…Œì´ë¸”ì— ë°ì´í„°ë¥¼ ì±„ìš¸ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. ì•„ë‹ˆë©´ ì ì–´ë„ íŒŒì´ì¬ì—ì„œ ì½”ë“œë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤. í˜¹ì€ ìƒˆë¡œìš´ ë¹„ë™ì  í…Œì´ë¸”(ë„ì‹œ ì •ë³´ ë° ë„ì‹œ ì¸êµ¬)ì„ ì—…ë°ì´íŠ¸í•˜ê¸°ë¡œ ê²°ì •í•  ë•Œê¹Œì§€ì…ë‹ˆë‹¤.</p>
<p></p>
<p>ì´ í”„ë¡œì íŠ¸ì˜ ëª©ì ìœ¼ë¡œ, Pythonì—ì„œ ì´ ë‘ í‘œë¥¼ GCPë¡œ ì—…ë¡œë“œí•˜ë ¤ë©´ í˜¸ìŠ¤íŠ¸ IPë¥¼ ë³€ê²½í•˜ëŠ” ê²ƒìœ¼ë¡œ ì¶©ë¶„í•©ë‹ˆë‹¤. ë˜ ë‹¤ë¥¸ ë°©ë²•ì€ ë‘ í‘œë¥¼ ë§Œë“œëŠ” ì½”ë“œë¥¼ í´ë¼ìš°ë“œì— ì—…ë¡œë“œí•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ ê²½ìš°, ìš°ë¦¬ëŠ” í´ë¼ìš°ë“œì— ë™ì  í‘œ ë‚ ì”¨ë¥¼ ë§Œë“¤ê³  ì±„ìš°ëŠ” ì½”ë“œë§Œ ì˜¬ë¦´ ê²ƒì…ë‹ˆë‹¤.</p>
<p>GCPì˜ "Cloud Functions" í•„ë“œì— í•¨ìˆ˜ë¥¼ ë§Œë“  í›„ ì—¬ëŸ¬ ë²ˆì˜ ì‹œí–‰ì°©ì˜¤ ëì— ì½”ë“œê°€ ë§ˆì¹¨ë‚´ ì‘ë™í–ˆìŠµë‹ˆë‹¤:</p>
<p><img src="/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_7.png" alt="cloud_function_image"></p>
<p>í•˜ì§€ë§Œ ì½”ë“œê°€ ì‘ë™í•˜ê¸° ì „ì— í´ë¼ìš°ë“œ ì¸ìŠ¤í„´ìŠ¤ì— í•¨ìˆ˜ë¥¼ ì—°ê²°í•´ì•¼í•©ë‹ˆë‹¤. ì•„ë˜ ë‹¨ê³„ë¥¼ ë”°ë¼ì•¼í•©ë‹ˆë‹¤:</p>
<p></p>
<p>ì‘ì—…ì´ ì˜ë˜ì—ˆëŠ”ì§€ ì–´ë–»ê²Œ ì•Œ ìˆ˜ ìˆì„ê¹Œìš”? ê°€ì¥ ì¢‹ì€ ì†Œì‹ì€ ë‹¤ìŒê³¼ ê°™ì´ ë³´ì…ë‹ˆë‹¤:</p>
<p>ë¡œì»¬ì—ì„œ í…ŒìŠ¤íŠ¸í•œ ì½”ë“œì™€ ë¹„êµí•´ ìƒë‹¹í•œ ìˆ˜ì •ì´ í•„ìš”í–ˆìŠµë‹ˆë‹¤. ìµœì¢… ì½”ë“œëŠ” ì´ë ‡ê²Œ ë³´ì…ë‹ˆë‹¤:</p>
<p></p>
<pre><code class="hljs language-python"><span class="hljs-keyword">import</span> functions_framework
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> sqlalchemy
<span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">from</span> pytz <span class="hljs-keyword">import</span> timezone
<span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime

<span class="hljs-meta">@functions_framework.http</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">insert</span>(<span class="hljs-params">request</span>):
  connection_string = connection()
  insert_into_weather(connection_string)
  <span class="hljs-keyword">return</span> <span class="hljs-string">'Data successfully added'</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">connection</span>():
  connection_name = <span class="hljs-string">"flying-dove-416317:europe-west1:wbs-mysql-db"</span>    <span class="hljs-comment"># this is not a real one</span>
  db_user = <span class="hljs-string">"root"</span>
  db_password = <span class="hljs-string">"xxxx"</span>   <span class="hljs-comment"># fill in with your SQL password</span>
  schema_name = <span class="hljs-string">"gans"</span>

  driver_name = <span class="hljs-string">'mysql+pymysql'</span>
  query_string = {<span class="hljs-string">"unix_socket"</span>: <span class="hljs-string">f"/cloudsql/<span class="hljs-subst">{connection_name}</span>"</span>}

  db = sqlalchemy.create_engine(
      sqlalchemy.engine.url.URL(
          drivername = driver_name,
          username = db_user,
          password = db_password,
          database = schema_name,
          query = query_string,
      )
  )
  <span class="hljs-keyword">return</span> db


<span class="hljs-comment"># HERE STARTS THE WEATHER DATA RETRIEVAL FUNCTION:</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">extract_city</span>(<span class="hljs-params">connection_string</span>):
    <span class="hljs-keyword">return</span> pd.read_sql(<span class="hljs-string">"cities_info"</span>, con=connection_string)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_weather_data</span>(<span class="hljs-params">cities_df</span>):
  berlin_timezone = timezone(<span class="hljs-string">"Europe/Berlin"</span>)
  API_key = <span class="hljs-string">"7e5623c79f102b6c08b15c8hjib4cc9l"</span>    <span class="hljs-comment"># this is not a real one</span>
  weather_items = []

  <span class="hljs-keyword">for</span> city <span class="hljs-keyword">in</span> cities_df[<span class="hljs-string">"city_name"</span>]:
    url = (<span class="hljs-string">f"http://api.openweathermap.org/data/2.5/forecast?q=<span class="hljs-subst">{city}</span>&#x26;appid=<span class="hljs-subst">{API_key}</span>&#x26;units=metric"</span>)
    response = requests.get(url)
    json = response.json()

    <span class="hljs-comment"># Added the time retrieved so we know when the forecast was made</span>
    retrieval_time = datetime.now(berlin_timezone).strftime(<span class="hljs-string">"%Y-%m-%d %H:%M:%S"</span>)

    <span class="hljs-comment"># As we are now using the data from our relational database, the city should reflect the city_id and not the city name</span>
    city_id = cities_df.loc[cities_df[<span class="hljs-string">"city_name"</span>] == city, <span class="hljs-string">"city_id"</span>].values[<span class="hljs-number">0</span>]  <span class="hljs-comment"># here we need to retrieve the values, otherwise it shows us the series</span>

    <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> json[<span class="hljs-string">"list"</span>]:
        weather_item = {
            <span class="hljs-comment"># Added the city name, so the information is clear when looking at multiple cities</span>
            <span class="hljs-string">"city_id"</span>: city_id,
            <span class="hljs-string">"forecast_time"</span>: item.get(<span class="hljs-string">"dt_txt"</span>, <span class="hljs-literal">None</span>),
            <span class="hljs-string">"temperature"</span>: item[<span class="hljs-string">"main"</span>].get(<span class="hljs-string">"temp"</span>, <span class="hljs-literal">None</span>),
            <span class="hljs-string">"feels_like"</span>: item[<span class="hljs-string">"main"</span>].get(<span class="hljs-string">"feels_like"</span>, <span class="hljs-literal">None</span>),
            <span class="hljs-string">"forecast"</span>: item[<span class="hljs-string">"weather"</span>][<span class="hljs-number">0</span>].get(<span class="hljs-string">"main"</span>, <span class="hljs-literal">None</span>),
            <span class="hljs-string">"humidity"</span>: item[<span class="hljs-string">"main"</span>].get(<span class="hljs-string">"humidity"</span>, <span class="hljs-literal">None</span>),
            <span class="hljs-string">"rain_in_last_3h"</span>: item.get(<span class="hljs-string">"rain"</span>, {}).get(<span class="hljs-string">"3h"</span>, <span class="hljs-number">0</span>),
            <span class="hljs-string">"risk_of_rain"</span>: item[<span class="hljs-string">"pop"</span>],
            <span class="hljs-string">"snow_in_last_3h"</span>: item.get(<span class="hljs-string">"snow"</span>, {}).get(<span class="hljs-string">"3h"</span>, <span class="hljs-number">0</span>),
            <span class="hljs-string">"wind_speed"</span>: item[<span class="hljs-string">"wind"</span>].get(<span class="hljs-string">"speed"</span>, <span class="hljs-literal">None</span>),
            <span class="hljs-string">"data_retrieved_at"</span>: retrieval_time
        }

        weather_items.append(weather_item)

  weather_df = pd.DataFrame(weather_items)
  weather_df[<span class="hljs-string">"forecast_time"</span>] = pd.to_datetime(weather_df[<span class="hljs-string">"forecast_time"</span>])
  weather_df[<span class="hljs-string">"data_retrieved_at"</span>] = pd.to_datetime(weather_df[<span class="hljs-string">"data_retrieved_at"</span>])
  weather_df[<span class="hljs-string">"snow_in_last_3h"</span>] = pd.to_numeric(weather_df[<span class="hljs-string">"snow_in_last_3h"</span>], downcast=<span class="hljs-string">"float"</span>)

  <span class="hljs-keyword">return</span> weather_df

<span class="hljs-keyword">def</span> <span class="hljs-title function_">insert_into_weather</span>(<span class="hljs-params">connection_string</span>):
  cities_df = extract_city(connection_string)
  weather_df = get_weather_data(cities_df)    <span class="hljs-comment"># we create the new dataframe using the function</span>
  weather_df.to_sql(<span class="hljs-string">"weather"</span>,
            if_exists=<span class="hljs-string">"append"</span>,
            con=connection_string,
            index=<span class="hljs-literal">False</span>)
</code></pre>
<h2>Lessons learned from making our code cloud-worthy</h2>
<h3>1. Dependencies:</h3>
<p>We need to add the right dependencies to the <code>requirements.txt</code> file. This was one of the main initial reasons preventing our code from working properly. It is important to note that some libraries are already uploaded on GCP by default and should not be included in the <code>.txt</code> file, but still need to be added as a library in our source code, e.g.:</p>
<p></p>
<pre><code class="hljs language-js"><span class="hljs-keyword">from</span> pytz <span class="hljs-keyword">import</span> timezone
<span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime
</code></pre>
<p>ë§Œì•½ ë°°í¬ë¥¼ ì‹œë„í•œ í›„ì— ë¹¨ê°„ ë°°ë„ˆ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤ë©´, ëŒ€ë¶€ë¶„ì˜ ê²½ìš° requirements.txt íŒŒì¼ì— ëª…ì‹œë˜ì–´ ìˆì§€ ì•Šì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ importí•˜ëŠ” ê²ƒì´ ì›ì¸ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<p><img src="/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_10.png" alt="image"></p>
<p>requirements ì„¹ì…˜ì—ì„œëŠ” Python ëª¨ë“ˆì´ ì•„ë‹Œ íŒ¨í‚¤ì§€ë§Œ ì¶”ê°€í•´ì•¼ í•©ë‹ˆë‹¤. ë¯¸ë¦¬ ì•Œë ¤ë“œë¦¬ìë©´, ì—¬ê¸° Python ëª¨ë“ˆë“¤ì˜ ì¢…í•© ëª©ë¡ì´ ìˆìŠµë‹ˆë‹¤: <a href="https://docs.python.org/3/py-modindex.html" rel="nofollow" target="_blank">Python ëª¨ë“ˆ ëª©ë¡</a></p>
<p></p>
<p>ë‹¤ë¥¸ ìœ ìš©í•œ íŒì€ ì½”ë“œì—ì„œ ì‚¬ìš© ì¤‘ì¸ ëª¨ë“  ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì¶œë ¥í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ë…¸íŠ¸ë¶ì—ì„œ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œ í›„ì—ëŠ” ë‹¤ìŒì„ ì‹¤í–‰í•´ì•¼ í•©ë‹ˆë‹¤:</p>
<pre><code class="hljs language-js"><span class="hljs-title function_">print</span>(<span class="hljs-string">'\n'</span>.<span class="hljs-title function_">join</span>(f<span class="hljs-string">'{m.__name__}=={m.__version__}'</span> <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> <span class="hljs-title function_">globals</span>().<span class="hljs-title function_">values</span>() <span class="hljs-keyword">if</span> <span class="hljs-title function_">getattr</span>(m, <span class="hljs-string">'__version__'</span>, <span class="hljs-title class_">None</span>)))
</code></pre>
<p>ê·¸ëŸ° ë‹¤ìŒ ì ì ˆí•œ ì¢…ì†ì„±ìœ¼ë¡œ requirements.txtì— ì§ì ‘ ë³µì‚¬í•˜ì—¬ ë¶™ì—¬ë„£ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<p><img src="/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_11.png" alt="ì´ë¯¸ì§€"></p>
<p></p>
<p>ì´ í”„ë¡œì íŠ¸ë¥¼ ìœ„í•´ í•„ìš”í•œ ì˜ì¡´ì„±ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤ .txt íŒŒì¼:</p>
<pre><code class="hljs language-js">functions-framework==<span class="hljs-number">3.</span>*
<span class="hljs-title class_">SQLAlchemy</span>==<span class="hljs-number">1.4</span><span class="hljs-number">.37</span>
<span class="hljs-title class_">PyMySQL</span>==<span class="hljs-number">1.0</span><span class="hljs-number">.2</span>
pandas==<span class="hljs-number">1.5</span><span class="hljs-number">.2</span>
requests==<span class="hljs-number">2.31</span><span class="hljs-number">.0</span>
</code></pre>
<h2>2. ì—°ê²° ì½”ë“œ í…ŒìŠ¤íŠ¸</h2>
<p>ë°ì´í„° ê²€ìƒ‰ í•¨ìˆ˜ë¥¼ ì¶”ê°€í•˜ê¸° ì „ì— ì—°ê²° ì½”ë“œê°€ ì‘ë™í•˜ëŠ”ì§€ ë¨¼ì € í…ŒìŠ¤íŠ¸í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ë¬¸ì œê°€ ì—°ê²° ì„¤ì •ì— ìˆëŠ”ì§€ ì•„ë‹Œì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p></p>
<p>ë¡œì»¬ ìŠ¤í¬ë¦½íŠ¸ë¥¼ GCPë¡œ ì´ë™í•  ë•Œ ì¢‹ì€ ì‹œì‘ ë°©ë²•ì€ "ë”ë¯¸" í•¨ìˆ˜ë¥¼ ë§Œë“¤ê³  í…ŒìŠ¤íŠ¸í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">import</span> functions_framework
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> sqlalchemy

@functions_framework.<span class="hljs-property">http</span>
def <span class="hljs-title function_">insert</span>(request):
  connection_string = <span class="hljs-title function_">connection</span>()
  <span class="hljs-title function_">insert_into_test_table</span>(connection_string)
  <span class="hljs-keyword">return</span> <span class="hljs-string">'Data successfully added'</span>

def <span class="hljs-title function_">connection</span>():
  connection_name = <span class="hljs-string">"YOUR_DB_CON_NAME"</span>  # ë³€ê²½í•´ì£¼ì„¸ìš”
  db_user = <span class="hljs-string">"root"</span>                      # ë³€ê²½
  db_password = <span class="hljs-string">"YOUR_PASSWORD"</span>         # ë³€ê²½
  schema_name = <span class="hljs-string">"test_schema"</span>           # ë³€ê²½

  driver_name = <span class="hljs-string">'mysql+pymysql'</span>
  query_string = {<span class="hljs-string">"unix_socket"</span>: f<span class="hljs-string">"/cloudsql/{connection_name}"</span>}

  db = sqlalchemy.<span class="hljs-title function_">create_engine</span>(
      sqlalchemy.<span class="hljs-property">engine</span>.<span class="hljs-property">url</span>.<span class="hljs-title function_">URL</span>(
          drivername = driver_name,
          username = db_user,
          password = db_password,
          database = schema_name,
          query = query_string,
      )
  )
  <span class="hljs-keyword">return</span> db

def <span class="hljs-title function_">insert_into_test_table</span>(con_str):
  data = {<span class="hljs-string">'FirstName'</span>: [<span class="hljs-string">'Function'</span>, <span class="hljs-string">'Test'</span>],
          <span class="hljs-string">'City'</span>: [<span class="hljs-string">'Cloud'</span>, <span class="hljs-string">'Complete'</span>]}
  df = pd.<span class="hljs-title class_">DataFrame</span>(data)
  df.<span class="hljs-title function_">to_sql</span>(name=<span class="hljs-string">"test_table"</span>, con=con_str, if_exists=<span class="hljs-string">'append'</span>, index=<span class="hljs-title class_">False</span>)
</code></pre>
<p>ì´ ê°„ë‹¨í•œ í•¨ìˆ˜ê°€ ì‘ë™í•˜ë©´ ì—°ê²°ì´ ì‘ë™í•˜ëŠ” ê²ƒì´ê³ , í•  ì¼ì€ ì‹¤ì œ ì½”ë“œë¥¼ ì¶”ê°€í•˜ê³  í†µí•©í•˜ëŠ” ê²ƒë¿ì…ë‹ˆë‹¤.</p>
<p>ë‹¤ìŒ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´ ìš°ë¦¬ì˜ ì½”ë“œì— ë¬¸ì œê°€ ìˆìŒì„ ê°€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p></p>
<h2>3. ìš°ë¦¬ ì‹¤ì œ ì½”ë“œì˜ ë¬¸ì œì </h2>
<p>ë‚´ ì½”ë“œë¥¼ ì˜¨ë¼ì¸ì— ì˜¬ë¦´ ë•Œ ì‹¤ìˆ˜í•œ ì£¼ìš”í•œ ë¶€ë¶„ì€ "ë”ë¯¸" í…œí”Œë¦¿ì„ ê¸°ë°˜ìœ¼ë¡œ ì½”ë“œë¥¼ ì¡°ì •í•˜ê³  ì‹¤ì œë¡œ ì •ì˜ë˜ì§€ ì•Šì€ "insert_into_weather" í•¨ìˆ˜ë¥¼ "@functions_framework.http" ì•„ë˜ì—ì„œ í˜¸ì¶œí–ˆë‹¤ëŠ” ê²ƒì´ì—ˆìŠµë‹ˆë‹¤.</p>
<p>ì´ í•¨ìˆ˜ë¥¼ ì¶”ê°€í•œ í›„ì—ë„ ì½”ë“œê°€ ì‘ë™í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì´ëŠ” í•„ìš”í•œ ë„ì‹œë¥¼ ìˆ˜ë™ìœ¼ë¡œ ëª…ëª…í–ˆê¸° ë•Œë¬¸ì— ë„ì‹œ ì •ë³´ ë°ì´í„°í”„ë ˆì„ì—ì„œ ì´ë¯¸ ê°€ì ¸ì˜¤ëŠ” ëŒ€ì‹ ì— ë„ì‹œ ì´ë¦„ì„ ìˆ˜ë™ìœ¼ë¡œ ì§€ì •í•´ì„œ ì˜¤ëŠ” ì ê³¼ ê´€ë ¨ì´ ìˆì—ˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ë‚˜ëŠ” ë¨¼ì € "extract_city"ë¼ëŠ” ë˜ ë‹¤ë¥¸ í•¨ìˆ˜ë¥¼ ì¶”ê°€í•´ì•¼ í–ˆê³ , ì´ í•¨ìˆ˜ê°€ ë¡œì»¬ì—ì„œ ì‘ë™í•˜ëŠ” ê²ƒì„ í™•ì¸ í›„ì— ì½”ë“œë¥¼ ì˜¨ë¼ì¸ì— ë°°í¬í•´ì•¼ í–ˆìŠµë‹ˆë‹¤.</p>
<p>ë„ì‹œ ì´ë¦„ì„ ì–»ê¸° ìœ„í•´ cities_info í…Œì´ë¸”ì„ ì‚¬ìš©í•œ í›„ì—, ë„ì‹œ ì´ë¦„ì„ ì¶”ì¶œí•˜ì§€ ì•Šì€ ì „ ë°˜ë³µë¬¸ì„ ì—…ë°ì´íŠ¸í•˜ì§€ ì•Šì€ ë‹¤ë¥¸ ì‹¤ìˆ˜ë¥¼ í–ˆìŠµë‹ˆë‹¤. ì´ì œ ë„ì‹œ ì´ë¦„ì„ ì´ì „ì— ëª©ë¡ì—ì„œ ê°€ì ¸ì˜¤ì§€ ì•Šê³  ë°ì´í„°í”„ë ˆì„ì—ì„œ ê°€ì ¸ì™€ì•¼ í–ˆê³ , ì´ì „ ì¸ìˆ˜ë¡œëŠ” ë„ì‹œ ì´ë¦„ì„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.</p>
<p></p>
<h1>ë§ˆì§€ë§‰ ë‹¨ê³„</h1>
<p>ìš°ë¦¬ í”„ë¡œì íŠ¸ë¥¼ ì™„ì „íˆ ê¸°ëŠ¥ì ì´ê³  ìë™í™”í•˜ê¸° ìœ„í•´ ì£¼ê¸°ì ìœ¼ë¡œ ì‹¤í–‰í•  í•¨ìˆ˜ë¥¼ ì˜ˆì•½í•´ì•¼ í•©ë‹ˆë‹¤. GCPì˜ "Cloud Scheduler" ë©”ë‰´ë¥¼ ì‚¬ìš©í•˜ë©´ ìƒë‹¹íˆ ì‰½ìŠµë‹ˆë‹¤.</p>
<p>ì´ë¥¼ ìœ„í•´ "ì‘ì—… ì˜ˆì•½"ì„ í•˜ê³  ëª‡ ê°€ì§€ ë§¤ê°œë³€ìˆ˜ë¥¼ ì œê³µí•˜ê³  ë¹ˆë„ë¥¼ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤(ë§¤ì£¼ í•œ ë²ˆ ë˜ëŠ” Cron í‘œí˜„ì‹ì„ ì‚¬ìš©í•˜ì—¬ íŠ¹ì • ì‹œê°„ì— íŠ¹ì • ìš”ì¼ì— ì‹¤í–‰í•˜ë„ë¡ ì„¤ì •). ì´ë ‡ê²Œ í•˜ë©´ í•´ë‹¹ ì‹œê°„ì— í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ì–´ SQL í…Œì´ë¸”ì— í•„ìš”í•œ ë°ì´í„°ë¥¼ ì±„ì›ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì—¬ê¸°ì„œëŠ” ë§¤ì£¼ ì›”ìš”ì¼ ì˜¤í›„ 3ì‹œì— ì‹¤í–‰ë˜ë„ë¡ ì„¤ì •í–ˆìŠµë‹ˆë‹¤:</p>
<p><img src="/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_12.png" alt="ì´ë¯¸ì§€"></p>
<p></p>
<p>SQLì—ì„œ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”:</p>
<p><img src="/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_13.png" alt="image"></p>
<p>ì²« ë²ˆì§¸ SQL-to-Python-to-GCP í”„ë¡œì íŠ¸ì™€ ì‘ë³„í•˜ê¸° ì „ì—, ë¬´ë£Œ í¬ë ˆë”§ì„ ì†Œë¹„í•˜ì§€ ì•Šë„ë¡ GCP ê³„ì •ì—ì„œ ë°ì´í„°ë¥¼ ì‚­ì œí•´ì•¼ í•´ìš”. ì´ëŠ” í´ë¼ìš°ë“œ ì¸ìŠ¤í„´ìŠ¤, í•¨ìˆ˜ ë° ì˜ˆì•½ëœ ì‘ì—…ì„ í¬í•¨í•´ìš”.</p>
<h1>ë</h1>
<p></p>
<p>ì´ ê¸€ì„ ì“°ë©´ì„œ SQL, Python ë° í´ë¼ìš°ë“œ ì»´í“¨íŒ…ì„ ê²°í•©í•œ ë§¤ìš° ê¸°ë³¸ì ì¸ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ êµ¬ì¶•í•˜ëŠ” ë°©ë²•ì„ ë°°ì› ì–´ìš”.</p>
<p>ì´ í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í•  ë•Œ êµ¬ê¸€ í´ë¼ìš°ë“œ í”Œë«í¼ ë˜ëŠ” ë‹¤ë¥¸ í´ë¼ìš°ë“œ ì»´í“¨íŒ… í”Œë«í¼ì— ëŒ€í•´ ì „í˜€ ì•Œì§€ ëª°ëì–´ìš”. ì„œë²„, í˜¸ìŠ¤íŠ¸, ì¸ìŠ¤í„´ìŠ¤ ë˜ëŠ” ì†Œí”„íŠ¸ì›¨ì–´ ì—°ê²°ì— ëŒ€í•´ ì•„ë¬´ê²ƒë„ ëª¨ë¥´ê³  ìˆì—ˆì–´ìš” (ì§€ê¸ˆë„ìš”). SQLê³¼ Pythonì˜ ê¸°ë³¸ì ì¸ ì§€ì‹ë§Œ ìˆì—ˆì–´ìš”.</p>
<p>ì´ë ‡ê²Œ ì´ˆë³´ìë¡œ ì‹œì‘í–ˆì„ ë•Œ, ìë™í™”ëœ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ìƒì„±í•˜ê³  ì£¼ê¸°ì ìœ¼ë¡œ ê°€ì¹˜ ìˆëŠ” ë°ì´í„°ë¡œ ì±„ìš°ëŠ” ì¼ì´ ë„ˆë¬´ ì–´ë ¤ìš¸ ê²ƒì´ë¼ê³  íšŒì˜ì ì´ì—ˆì–´ìš”. ì´ì œ ë‚´ê°€ í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ì•Œê²Œ ë˜ì—ˆì–´ìš”!</p>
<p>ì•ìœ¼ë¡œì˜ ê³„íšì€ ë‹¤ë¥¸ APIì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ GCP ê¸°ëŠ¥ì— ê²°í•©í•˜ì—¬ ë” ì™„ì „í•˜ê³  ìœ ìš©í•œ ìµœì¢… ì œí’ˆì„ ë§Œë“¤ê³  ì‹¶ì–´í•´ìš”.</p>
<p></p>
<p>ê¸€ì„ ì“°ëŠ” ì‚¬ëŒì´ë¼ê³  í•˜ë”ë¼ë„ ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ì„ ì†Œí”„íŠ¸ì›¨ì–´ ì—”ì§€ë‹ˆì–´ë§Œí¼ ì˜ í•  ìˆ˜ëŠ” ì—†ì„ ì§€ë„ ëª¨ë¥´ê² ì–´ìš”. í•˜ì§€ë§Œ ìš°ë¦¬ëŠ” ê¸°ì´ˆë¥¼ ë°°ìš°ê³  ê±°ê¸°ì„œë¶€í„° ì„±ì¥í•  ìˆ˜ ìˆì£ .</p>
<h1>Stackademic ğŸ“</h1>
<p>ëê¹Œì§€ ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤. ë– ë‚˜ì‹œê¸° ì „ì—:</p>
<ul>
<li>ì €ìë¥¼ í´ë©í•˜ì‹œê³  íŒ”ë¡œìš°í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ‘</li>
<li>ìš°ë¦¬ë¥¼ íŒ”ë¡œìš°í•´ì£¼ì„¸ìš” X | LinkedIn | YouTube | Discord</li>
<li>ë‹¤ë¥¸ í”Œë«í¼ì—ì„œë„ ë§Œë‚˜ë³´ì„¸ìš”: In Plain English | CoFeed | Venture | Cubed</li>
<li>ë” ë§ì€ ì½˜í…ì¸ ëŠ” Stackademic.comì—ì„œ í™•ì¸í•˜ì„¸ìš”</li>
</ul>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ì€ ì—”ì§€ë‹ˆì–´ë¥¼ ìœ„í•œ ê²ƒì…ë‹ˆë‹¤  ì•„ë‹ˆì—ìš”","description":"","date":"2024-05-18 18:24","slug":"2024-05-18-DataEngineeringisforEngineersNOT","content":"\n## ê¸€ì„ ì“°ëŠ” ì‚¬ëŒì´ ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ë„ ë°°ìš¸ ìˆ˜ ìˆì„ ê±°ë¼ê³  ìƒê°í•´ìš”.\n\n\"ì´ê²Œ ë¬´ìŠ¨ ì¼ì´ì£ .\"\n\nì²˜ìŒ ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ ì—…ë¬´ë¥¼ ë§¡ì•˜ì„ ë•Œ ë‚˜ëŠ” ì´ë ‡ê²Œ ìƒê°í–ˆì–´ìš”. í•˜ì§€ë§Œ ì–¼ë§ˆ í›„, ìš°ë¦¬ê°€ í•˜ë‚˜ì”© ìœ„í‚¤í”¼ë””ì•„ì—ì„œ ì§‘ì–´ë‚¼ ëª‡ ê°€ì§€ ìˆ«ìë¥¼ ê°€ì ¸ì˜¤ëŠ” ê²ƒì´ ì²« ë²ˆì§¸ ë‹¨ê³„ì˜€ë‹¤ëŠ” ê²ƒì„ ê¹¨ë‹¬ì•˜ì£ .\n\níŒŒì´ì¬ì—ì„œ ì‘ì—…ì„ í•´ì£¼ì…”ì•¼ê² ë‹¤ê³  ë§ì”€í•˜ì…”ì•¼ í–ˆë˜ ì²« ë²ˆì§¸ ì–´ë ¤ì›€ì´ ìˆì—ˆì–´ìš”! ì¦‰, ë°ì´í„°ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ê°€ì ¸ì˜¤ëŠ” ë‚ ì´ ëë‚¬ë‹¤ëŠ” ê±°ì£ . ì¸ë‚´ì‹¬ì„ ê°€ì§€ê³  ìì‹ ì—ê²Œ ì´ëŸ° ë§ì„ í•´ë³´ì„¸ìš”. ê´œì°®ì•„, ì´ ì¼ ì˜ í•  ìˆ˜ ìˆì–´ìš”!\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\në¬¸ì œ: ì‚¬íšŒê³¼í•™ ì¡¸ì—…ìƒì´ ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ì„ ëŠ¥ìˆ™í•˜ê²Œ ìˆ˜í–‰í•  ìˆ˜ ìˆì„ê¹Œìš”? ìë™í™”ëœ ë°ì´í„° íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•˜ê³  ì•ˆì „í•˜ê²Œ í´ë¼ìš°ë“œì— ë³´ê´€í•  ìˆ˜ ìˆì„ê¹Œìš”?\n\nê·€ë¬´ê°€ì„¤: ì—”ì§€ë‹ˆì–´ëŠ” ìƒì—…ìœ¼ë¡œ ê¸€ì„ ì“°ëŠ” ì‚¬ëŒë§Œí¼ ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nì´ ê°€ì„¤ì„ ê¸°ê°í•´ì•¼ í• ê¹Œìš”? ë‚´ ì§ê°ì€ \"ì˜ˆ\"ë¼ê³  ë§í–ˆìŠµë‹ˆë‹¤. IT ë¹„ì „ë¬¸ê°€ì¸ ë‚˜ ê°™ì€ ì‚¬ëŒì´ ê·¸ë ‡ê²Œ í•  ìˆ˜ëŠ” ì—†ì„ ê²ƒ ê°™ì•„ìš”.\n\nëŒ€ì•ˆ ê°€ì„¤ì€ ì•„ë§ˆë„ ì´ë ‡ê²Œ í•  ìˆ˜ ìˆì„ ê²ƒ ê°™ì•„ìš”: ìƒì—…ìœ¼ë¡œ ê¸€ì“°ëŠ” ì‚¬ëŒë„ ì—”ì§€ë‹ˆì–´ì²˜ëŸ¼ ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ì„ ë°°ìš¸ ìˆ˜ ìˆë‹¤ë©´ìš”.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nì—¬ê¸°ì„œ ì‹œì‘í•´ìš”...\n\n## ìš°ë¦¬ ë¹„ì¦ˆë‹ˆìŠ¤ ì¼€ì´ìŠ¤\n\nì´ ì‘ì—…ì€ ì£¼ë¡œ ì „ê¸° ì´ë™ì„±ì— ê´€ë ¨ëœ ì‚¬ì—…ì„ í•˜ëŠ” \"Gans\" íšŒì‚¬ë¥¼ ìœ„í•œ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ìƒì„±í•˜ëŠ” ê²ƒì„ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤. íŠ¹ì • ì‹œê°„ì— ì¶©ë¶„í•œ ì´ë™ì„± ë‹¨ìœ„ë¥¼ ì œê³µí•˜ê¸° ìœ„í•´ ë‚ ì”¨ ìš”ì†Œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìˆ˜ìš”ë¥¼ ì¸¡ì •í•˜ê¸° ìœ„í•œ ë°ì´í„° ê³¼í•™ìë¥¼ í•„ìš”ë¡œ í•©ë‹ˆë‹¤.\n\níšŒì‚¬ì˜ ì£¼ìš” ì‚¬ì—…ì€ ë…ì¼ì—ì„œ ìŠ¤ì¿ í„°ë¥¼ ëŒ€ì—¬í•˜ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì— ë¹„ê°€ ì˜¤ê±°ë‚˜ ëˆˆì´ ì˜¤ëŠ” ê²½ìš°ì—ëŠ” ì¼ë°˜ì ìœ¼ë¡œ ìˆ˜ìš”ê°€ ì¤„ì–´ë“¤ê²Œ ë©ë‹ˆë‹¤. ë¹„ë‚˜ ëˆˆì´ ì˜ˆë³´ëœ ê²½ìš°, ì„ì‹œ ìˆ˜ìš”ë„ ì¦ê°€í•  ê²ƒì…ë‹ˆë‹¤.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\në”°ë¼ì„œ, í˜„ì¬ ê³¼ì œëŠ” ë„ì‹œì™€ ë‚ ì”¨ ì •ë³´ë¡œ ì±„ì›Œì§„ ê°„ë‹¨í•œ SQL ë°ì´í„°ë² ì´ìŠ¤ë¥¼ êµ¬ì¶•í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. íšŒì‚¬ì˜ ìš´ì˜ ë¶€ì„œëŠ” ë§¤ì¼ì´ ì´ ë°ì´í„°ë² ì´ìŠ¤ì— ì•¡ì„¸ìŠ¤í•˜ì—¬ ì´ë™ ê°€ëŠ¥ ì°¨ëŸ‰ì˜ ì§€ë¦¬ì  ê°€ìš©ì„±ì— ê´€í•œ íŒë‹¨ì„ ë‚´ë¦´ ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤.\n\në‚˜ì¤‘ì— ë°ì´í„°ë² ì´ìŠ¤ëŠ” ê´€ê´‘ê° ë°©ë¬¸ ì˜ˆìƒ ë“±ì„ ì œê³µí•˜ê¸° ìœ„í•´ ê³µê³µ êµí†µ ë„ì°© ì •ë³´(ì˜ˆ: í•­ê³µí¸, ê¸°ì°¨, ë˜ëŠ” ë²„ìŠ¤ API ì‚¬ìš©)ê°€ í¬í•¨ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë“¤ì€ íšŒì‚¬ì˜ ì ì¬ì  ê³ ê° ì¤‘ ì¼ë¶€ì…ë‹ˆë‹¤.\n\në‹¤ìŒì€ ë‚ ì”¨ì™€ í•­ê³µí¸ APIë¥¼ í¬í•¨í•œ ì§€ë„ í”„ë¡œì íŠ¸ì˜ ëª¨ìŠµì…ë‹ˆë‹¤:\n\n\u003cimg src=\"/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_0.png\" /\u003e\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nì´ ê¸°ì‚¬ì—ì„œëŠ” ë‚ ì”¨ ë°ì´í„° í†µí•©ë§Œ ë‹¤ë£¨ê³  ë‚˜ì¤‘ì— ì „ì†¡ ë¶€ë¶„ì€ ë‚˜ì¤‘ì— ê°œì„ í•  ê²ƒì…ë‹ˆë‹¤.\n\nì‹œì‘í•˜ê¸° ì „ì— Pythonì—ì„œ í•„ìš”í•œ ëª¨ë“  ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ê°€ì ¸ì™€ì•¼ í•©ë‹ˆë‹¤:\n\n```python\nimport pandas as pd\nimport requests\nfrom bs4 import BeautifulSoup\nfrom datetime import datetime\nfrom pytz import timezone\n```\n\n## ì›¹ ìŠ¤í¬ë˜í•‘ 101: HTML ì½”ë“œë¥¼ ê°€ì ¸ì˜¤ëŠ” ë°©ë²•?\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\në¨¼ì €, ë‹¤ë¥¸ í…Œì´ë¸”ê³¼ ê´€ë ¨í•˜ëŠ” ì£¼ìš” í…Œì´ë¸”ë¡œ ì‘ìš©í•˜ëŠ” ë„ì‹œ ì •ë³´ê°€ í¬í•¨ëœ í…Œì´ë¸”ì„ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤. ì´ í…Œì´ë¸”ì€ ì£¼ê¸°ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•  í•„ìš”ê°€ ì—†ëŠ” ì •ì  í…Œì´ë¸”ì´ ë  ê²ƒì…ë‹ˆë‹¤. ì´ í…Œì´ë¸”ì„ \"cities_info\"ë¼ê³  ë¶€ë¥¼ ê²ƒì…ë‹ˆë‹¤.\n\nê° ë„ì‹œì— ëŒ€í•´ ê³ ìœ í•œ ë„ì‹œ ID, ë„ì‹œ ì´ë¦„, ë…ì¼ì˜ ì†Œì† ì£¼(State), ìœ„ë„ ë° ê²½ë„ê°€ í¬í•¨ëœ 5ê°œ ì—´ì´ ìˆì„ ê²ƒì…ë‹ˆë‹¤. ê° ë„ì‹œì— ëŒ€í•œ ì´ ì •ë³´ëŠ” ì˜ì–´ ìœ„í‚¤í”¼ë””ì•„ ì‚¬ì´íŠ¸ì—ì„œ ìŠ¤í¬ë˜í•‘í•˜ì—¬ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆì‚°ì´ í—ˆìš©í•œë‹¤ë©´, ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ì™€ ë°©ë²•ë¡ ì  ì •ë³´ê°€ í¬í•¨ëœ ë„ì‹œì˜ APIë¥¼ êµ¬ë§¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ í”„ë¡œì íŠ¸ì—ì„œëŠ” ìœ„í‚¤í”¼ë””ì•„ë¥¼ ì‚¬ìš©í•˜ì—¬ ìŠ¤í¬ë˜í•‘ ê¸°ìˆ ì„ ì—°ìŠµí•  ê²ƒì…ë‹ˆë‹¤.\n\nì²˜ìŒì—ëŠ” ê° ì›¹ì‚¬ì´íŠ¸ë§ˆë‹¤ HTML ì½”ë“œë¥¼ ìˆ˜ë™ìœ¼ë¡œ ë‚´ë³´ë‚´ê³  Vs Codeì— ë³µì‚¬í•´ì•¼ í•œë‹¤ëŠ” ìƒê°ì´ ì••ë„ì ì´ì—ˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ë‹¤í–‰íˆ íŒŒì´ì¬ì˜ \"requests\" ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ë©´ ìë™ìœ¼ë¡œ ìˆ˜í–‰í•  ìˆ˜ ìˆìŒì„ ì•Œê²Œ ë˜ì–´ ì•ˆë„í–ˆìŠµë‹ˆë‹¤:\n\n```js\nimport requests\nberlin_url = \"https://en.wikipedia.org/wiki/Berlin\"\nberlin_response = requests.get(berlin_url)\nberlin_soup = BeautifulSoup(berlin_response.content, 'html.parser')\nprint(berlin_soup.prettify)\n```\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\níŒŒì´ì¬: 1 - ë‚˜: 0\n\n## ë£¨í”„ì™€ í•¨ìˆ˜\n\nì´í„°ë ˆì´ì…˜ì˜ ì„±ë°°ì…ë‹ˆë‹¤. ì´ë“¤ ì—†ì´ëŠ” ë™ì¼í•œ ì½”ë“œë¥¼ ì¬ìƒì‚°í•˜ê³  ë‹¤ë¥¸ URLì— ë™ì‹œì— ì ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì´ê²ƒì´ ì›¹ ìŠ¤í¬ë ˆì´í•‘ì„ ìë™í™”í•˜ëŠ” ì—´ì‡ ì…ë‹ˆë‹¤.\n\nì—¬ê¸°ì—ëŠ” ê° ìœ„í‚¤í”¼ë””ì•„ ì‚¬ì´íŠ¸ì˜ HTML ì½”ë“œë¥¼ ê²€ìƒ‰í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•œ ë£¨í”„ì˜ ì˜ˆì‹œê°€ ìˆìŠµë‹ˆë‹¤:\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\ncities_list = [\"Berlin\", \"Hamburg\", \"Munich\", \"Cologne\", \"Frankfurt\"]\n\nfor city in cities_list:\n  url = f\"https://www.wikipedia.org/wiki/{city}\"   # urlì„ f ë¬¸ìì—´ë¡œ ë³€í™˜í•˜ì—¬ ë„ì‹œë¥¼ ë³€ìˆ˜ë¡œ ë„£ì–´ í•´ë‹¹ ë„ì‹œì—ì„œ ë‹¤ë¥¸ ë„ì‹œë¡œ ë³€ê²½ë¨\n  response = requests.get(url)          # ìœ„í‚¤ë°±ê³¼ í˜ì´ì§€ì˜ ëª¨ë“  ë‚´ìš©ì„ ê°€ì ¸ì™€ responseì— ì €ì¥\n  city_soup = BeautifulSoup(response.content, 'html.parser')\n```\n\nì§€ê¸ˆì€ í•¨ìˆ˜ê°€ ë¬´ì„œì›Œì„œ ìµœëŒ€í•œ í”¼í•˜ê³  ìˆì–´ìš” ğŸ˜…\n\níŒŒì´ì¬: 1,000 â€” ë‚˜: 0\n\n## HTMLì—ì„œ ë¬´ì—‡ì„ ì ‘ê·¼í•˜ë‚˜ìš”?\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nHTMLì—ì„œ \"p íƒœê·¸\"ë¼ëŠ” ê²ƒì´ ìˆì–´ìš”. ì´ë¥¼ ì•¡ì„¸ìŠ¤í•˜ëŠ” ë° ìœ ìš©í•©ë‹ˆë‹¤. ë‹¤ìŒ ì½”ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ê·¸ë ‡ê²Œ í•  ìˆ˜ ìˆì–´ìš”:\n\n```js\nprint(soup.p)   # ì²« ë²ˆì§¸ p íƒœê·¸ ìì²´ì— ì ‘ê·¼\nprint(soup.p.string)  # ì²« ë²ˆì§¸ p íƒœê·¸ì™€ ê´€ë ¨ëœ ë¬¸ìì—´ì— ì ‘ê·¼\n```\n\n```js\nfor child in soup.div:  # 1ë²ˆì§¸ divì—ì„œ ê° ìì‹ì„ ì°¾ì•„ì„œ ì¸ì‡„í•˜ëŠ” ì˜ˆì œ\n    print(child)\n```\n\n## Pythonì—ì„œ ë°ì´í„°í”„ë ˆì„ ë° SQLì—ì„œ í•´ë‹¹ í…Œì´ë¸” ë§Œë“¤ê¸°\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nHTML ë° ì›¹ ìŠ¤í¬ë˜í•‘ ê¸°ìˆ ì„ ì—°ë§ˆí•œ í›„, ì²« ë‘ í…Œì´ë¸”ì— í•„ìš”í•œ ëª¨ë“  ì •ë³´ë¥¼ ì–»ê¸° ìœ„í•´ ì´ ë£¨í”„ë¥¼ ë§Œë“¤ì—ˆì–´ìš”.\n\nì²« ë²ˆì§¸ ë°ì´í„°í”„ë ˆì„ì€ ì •ì  ì¸ë±ìŠ¤ë¡œ ì‘ë™í•  ê²ƒì´ê³  (ì¦‰, ì •ë³´ë¥¼ ì •ê¸°ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•  í•„ìš”ê°€ ì—†ì–´ìš”): cities_info\n\n```js\ncities_list = [\"ë² ë¥¼ë¦°\", \"í•¨ë¶€ë¥´í¬\", \"ë®Œí—¨\", \"ì¾°ë¥¸\", \"í”„ë‘í¬í‘¸ë¥´íŠ¸\"]\nstates = []\nlatitudes = []\nlongitudes = []\n\nfor city in cities_list:\n  url = f\"https://www.wikipedia.org/wiki/{city}\"\n  city_soup = BeautifulSoup(response.content, 'html.parser')    # (ìœ„í‚¤ë°±ê³¼ ì‚¬ì´íŠ¸ì˜ ë‚´ìš©ì„ city_soup ë³€ìˆ˜ì— ì €ì¥í•˜ëŠ”) ë‚´ìš©ì„ êµ¬ë¬¸ ë¶„ì„í•©ë‹ˆë‹¤.\n\n  # ë„ì‹œê°€ ì†í•œ ì£¼ë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤\n  if city not in [\"í•¨ë¶€ë¥´í¬\", \"ë² ë¥¼ë¦°\"]:         # ë² ë¥¼ë¦°ì˜ ê²½ìš° ì¼ë°˜ì ì¸ .find ê³µì‹ë„ ì‘ë™í•  ê±°ì˜ˆìš”! ì£¼ ì„¹ì…˜ì´ ì—†ëŠ” \"í•¨ë¶€ë¥´í¬\"ë§Œì´ ì˜ˆì™¸ì—ìš”\n    city_state = city_soup.find(\"table\", class_=\"vcard\").find(string=\"ì£¼\").find_next(\"td\").get_text()  # ë‹¤ë¥¸ ì£¼ ì´ë¦„ì„ ê°€ì§„ ë„ì‹œì— ëŒ€í•œ ì£¼ë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤\n  else:\n    city_state = city     # í•¨ë¶€ë¥´í¬ì™€ ë² ë¥¼ë¦°ì˜ ê²½ìš°, ë™ëª…ì˜ ë„ì‹œ ì´ë¦„ì„ ê°€ì ¸ì˜¬ ê±°ì˜ˆìš”\n  states.append(city_state)\n\n  # ê° ë„ì‹œì˜ ìœ„ë„ë¥¼ ê²€ìƒ‰í•˜ì—¬ ìœ„ë„ ì—´ì— ì¶”ê°€í•©ë‹ˆë‹¤\n  city_latitude = city_soup.find(class_=\"latitude\").get_text()\n  latitudes.append(city_latitude)\n\n   # ê° ë„ì‹œì˜ ê²½ë„ë¥¼ ê²€ìƒ‰í•˜ì—¬ ê²½ë„ ì—´ì— ì¶”ê°€í•©ë‹ˆë‹¤\n  city_longitude = city_soup.find(class_=\"longitude\").get_text()\n  longitudes.append(city_longitude)\n\ncities_info_non_rel = pd.DataFrame({         # ì´ê²ƒì´ cities_info ë°ì´í„°í”„ë ˆì„ì´ì—ìš”\n    \"ë„ì‹œ ì´ë¦„\": cities_list,\n    \"ë…ì¼ ì£¼\": states,\n    \"ìœ„ë„\": latitudes,\n    \"ê²½ë„\": longitudes\n})\n\ndisplay(cities_info_non_rel)    # í‘œì‹œí•˜ë©´ í…Œì´ë¸”ì´ ë” ì˜ˆì˜ê²Œ ë³´ì—¬ìš”\n```\n\në˜í•œ, ì—°ê°„ í•œ ë²ˆì”© ì—…ë°ì´íŠ¸ë  ê²ƒìœ¼ë¡œ ì˜ˆìƒë˜ëŠ” ì¸êµ¬ ë°ì´í„°ë¥¼ í¬í•¨í•˜ëŠ” ë‘ ë²ˆì§¸ ë°ì´í„°í”„ë ˆì„ë„ ìƒì„±í–ˆì–´ìš”: cities_population\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```sql\n/***************************\ní™˜ê²½ ì„¤ì •\n***************************/\n\n-- ë°ì´í„°ë² ì´ìŠ¤ê°€ ì´ë¯¸ ìˆëŠ” ê²½ìš° ì‚­ì œ\nDROP DATABASE IF EXISTS gans;\n\n-- ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±\nCREATE DATABASE gans;\n\n-- ë°ì´í„°ë² ì´ìŠ¤ ì‚¬ìš©\nUSE gans;\n\n\n/***************************\nì²« ë²ˆì§¸ í…Œì´ë¸” ìƒì„±\n***************************/\n\n-- 'cities_info' í…Œì´ë¸” ìƒì„±\nCREATE TABLE cities_info (\n    cities_id INT AUTO_INCREMENT, -- ë„ì‹œë§ˆë‹¤ ìë™ìœ¼ë¡œ ìƒì„±ëœ ID\n    city_name VARCHAR(255) NOT NULL, -- ë„ì‹œ ì´ë¦„\n    german_state VARCHAR(255) NOT NULL, -- ì£¼ ì´ë¦„\n    latitude VARCHAR(255) NOT NULL, -- ìœ„ë„ ì¢Œí‘œ\n    longitude VARCHAR(255) NOT NULL, -- ê²½ë„ ì¢Œí‘œ\n    PRIMARY KEY (cities_id) -- ê° ë„ì‹œë¥¼ ê³ ìœ í•˜ê²Œ ì‹ë³„í•˜ê¸° ìœ„í•œ ê¸°ë³¸ í‚¤\n    );\n\n\n/***************************\në‘ ë²ˆì§¸ í…Œì´ë¸” ìƒì„±\n***************************/\n\nCREATE TABLE cities_population (\n    cities_id INT,\n    population INT, -- ì¸êµ¬ìˆ˜\n    year_data_retrieved INT, -- ì¸êµ¬ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•œ í•´ë‹¹ ë…„ë„\n    FOREIGN KEY (cities_id) REFERENCES cities_info(cities_id)\n);\n```\n\nì´ì œ Pythonì—ì„œ ë°ì´í„°ë¥¼ ì²« ë²ˆì§¸ SQL í…Œì´ë¸”ë¡œ ì „ì†¡í•©ë‹ˆë‹¤:\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\nschema = \"gans\"     # ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„\nhost = \"xxx.x.x.x\"\nuser = \"root\"               # ì‚¬ìš©ì ì´ë¦„\npassword = \"xxxx\"           # SQL ì•”í˜¸ ì§ì ‘ ì§€ì • ë˜ëŠ” ë‹¤ë¥¸ ë…¸íŠ¸ë¶ì—ì„œ ê°€ì ¸ì˜¤ê¸° (\"from xxxfile import my_password\")\nport = 3306\n\nconnection_string = f'mysql+pymysql://{user}:{password}@{host}:{port}/{schema}'\n# ì´ê±´ íŒŒì´ì¬ ë…¸íŠ¸ë¶ì„ SQL Workbenchì— ì—°ê²°í•˜ëŠ” ë°©ë²•ì´ì—ìš”\n```\n\n```js\ncities_info_non_rel.to_sql('cities_info',   # íŒŒì´ì¬ì—ì„œ SQLë¡œ ë°ì´í„°ë¥¼ ë³´ë‚´ëŠ” ë°©ë²•\n                  if_exists='append',       # ë®ì–´ì“°ì§€ ì•Šê³  ê¸°ì¡´ ë°ì´í„°ì— ì¶”ê°€í•˜ê¸° ìœ„í•¨\n                  con=connection_string,    # SQL Workbenchì— ì—°ê²°í•  ë•Œ í•„ìš”í•œ ì¸ì\n                  index=False)\n```\n\nì²« ë²ˆì§¸ ì‹œë„ëŠ” ë¡œì»¬ì—ì„œ ì´ë£¨ì–´ì¡ŒìŠµë‹ˆë‹¤. ë‚˜ì¤‘ì— Google Cloud Platform ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì¶”ê°€í•˜ë©´ \"host\" í•„ë“œë¥¼ í¸ì§‘í•˜ì—¬ ì´ ë°ì´í„°ë¥¼ í´ë¼ìš°ë“œì— ì§ì ‘ ì „ì†¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nSQLì— ì²« ë²ˆì§¸ í…Œì´ë¸”ì´ ìƒì„±ë˜ë©´ cities_infoì— í¬í•¨ëœ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•˜ì—¬ ë‘ ë²ˆì§¸ cities_population ë°ì´í„° í”„ë ˆì„ì—ì„œ í•´ë‹¹ cities_id ì—´ì„ ì¸ë±ìŠ¤ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\ncities_info = pd.read_sql(\"cities_info\", con=connection_string)   # ì´ ì½”ë“œëŠ” SQLì— ì €ì¥ëœ ì •ë³´ë¥¼ \"ì½ì–´ì˜µë‹ˆë‹¤\"\ncities_info\n```\n\në‹¤ìŒì€ cities_infoì˜ ëª¨ìŠµì…ë‹ˆë‹¤:\n\n\u003cimg src=\"/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_1.png\" /\u003e\n\në‘ ë²ˆì§¸ ë°ì´í„°í”„ë ˆì„ì˜ ë‚´ìš©ì„ SQLë¡œ ë„£ê¸° ì „ì—, ìƒˆë¡œ ìƒì„±ëœ cities_id ì—´ì„ ì‚¬ìš©í•˜ì—¬ cities_populations ë°ì´í„°í”„ë ˆì„ì— ì¶”ê°€í•´ì•¼ í•©ë‹ˆë‹¤.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nì•„ë˜ëŠ” ì¹¼ëŸ¼ ìˆœì„œë¥¼ ì¬ì¡°ì •í•˜ê³ , ì´ì œ cities_populations ë°ì´í„°í”„ë ˆì„ì— cities_id ì¹¼ëŸ¼ì´ ìˆê¸° ë•Œë¬¸ì— ë” ì´ìƒ city_name ì¹¼ëŸ¼ì´ í•„ìš”í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì‚­ì œí–ˆìŠµë‹ˆë‹¤:\n\n```js\n# ë‹¤ë¥¸ ì¸êµ¬ ë°ì´í„°í”„ë ˆì„ì— cities_id ì¹¼ëŸ¼ì„ ì¶”ê°€í•©ë‹ˆë‹¤\ncities_population[\"cities_id\"] = cities_info_non_rel[\"cities_id\"]\ncities_population\n\n# city_name ì¹¼ëŸ¼ì€ ë” ì´ìƒ í•„ìš”í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ì‚­ì œí•˜ê³  ì¹¼ëŸ¼ ìˆœì„œë¥¼ ë°”ê¿” ë” ì§ê´€ì ìœ¼ë¡œ ë§Œë“­ë‹ˆë‹¤\ncities_population = cities_population[[\"cities_id\", \"population\", \"year_data_retrieved\"]]\ncities_population\n```\n\nê·¸ë¦¬ê³  ì œ ë‘ ë²ˆì§¸ ë°ì´í„°í”„ë ˆì„ì´ ìˆìŠµë‹ˆë‹¤. ì´ ë°ì´í„°í”„ë ˆì„ì€ ì¼ë¶€ ë™ì ì…ë‹ˆë‹¤(ë°ì´í„°ê°€ ë•Œë•Œë¡œ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤. ì˜ˆ: ì—°ê°„ í•œ ë²ˆ):\n\n![ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ì€ ì—”ì§€ë‹ˆì–´ë¥¼ ìœ„í•œ ê²ƒ](/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_2.png)\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\në‹¹ë¶„ê°„ì€, ë‹¤ìŒ í•´ê¹Œì§€ ì—…ë°ì´íŠ¸ë˜ì§€ ì•Šì„ ë™ì ì´ ì•„ë‹Œ cities_population í…Œì´ë¸”ë¡œ ê°„ì£¼í•˜ê² ìŠµë‹ˆë‹¤.\n\nì´ì œ ìš°ë¦¬ëŠ” ë¡œì»¬ SQL ì¸ìŠ¤í„´ìŠ¤ë¡œ ë‚´ìš©ì„ í‘¸ì‹œí•  ì¤€ë¹„ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤:\n\n```js\n# ë‘ ë²ˆì§¸ í…Œì´ë¸” ë‚´ìš©ì„ SQLë¡œ í‘¸ì‹œí•©ë‹ˆë‹¤\ncities_population.to_sql('cities_population',   # ì´ë ‡ê²Œ í•˜ë©´ Pythonì—ì„œ SQLë¡œ í‘¸ì‹œí•©ë‹ˆë‹¤\n                  if_exists='append',       # ë®ì–´ì“°ê¸°ë¥¼ ì›í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ, ê¸°ì¡´ ë°ì´í„°ì—ë§Œ ë°ì´í„°ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤\n                  con=connection_string,    # conì€ sql workbenchì— ì—°ê²°í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ì¸ìì…ë‹ˆë‹¤\n                  index=False)\n```\n\nSQLì—ì„œ ëª¨ë“  ê²ƒì„ ì‹¤í–‰í•˜ê³  \"ì—­ê³µí•™\" ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë©´, ìš°ë¦¬ì˜ ìŠ¤í‚¤ë§ˆì˜ ê°€ì¥ ì´ˆê¸° ë²„ì „ì„ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n\u003cimg src=\"/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_3.png\" /\u003e\n\nìš°ë¦¬ëŠ” í•™ìŠµ ê³¡ì„  ì†ìœ¼ë¡œ ë” ê¹Šì´ íŒŒê³ ë“¤ê³  ìˆì–´ìš”.\n\në‹¤ìŒ ë‹¨ê³„: APIë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— í†µí•©í•˜ê¸°. ì§€êµ¬ìƒì˜ ëª¨ë“  ë°ì´í„° ê³¼í•™ìì˜ ë³¸ì§ˆì´ë¼ê³  í•  ìˆ˜ ìˆì£ .\n\nAIê°€ ë”°ë¼ì¡ê¸° ì „ì— ì–´ë–»ê²Œ í•´ì•¼ í• ì§€ ë°°ì›Œì•¼ê² ë„¤ìš”! (ë˜ëŠ” ì™¸ê³„ì¸ì´ ê·¸ë“¤ì˜ ë°ì´í„° ìš”êµ¬ë¥¼ ì–´ë–»ê²Œ ì²˜ë¦¬í•˜ëŠ”ì§€ë¥¼ ë³´ì¼ ë•Œê¹Œì§€) ğŸ‘½\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## ë‚ ì”¨ API ì‚¬ìš©í•˜ê¸°\n\nì´ í”„ë¡œì íŠ¸ì˜ ì„¸ ë²ˆì§¸ í° ë‹¨ê³„ëŠ” í˜„ì¬ ì¡´ì¬í•˜ëŠ” ë°ì´í„° ì €ì¥ì†Œì—ì„œ ë‚ ì”¨ ë°ì´í„°ë¥¼ ì¶”ì¶œí•˜ê³  SQL ë°ì´í„°ë² ì´ìŠ¤ì— í†µí•©í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ëŸ¬í•œ ì €ì¥ì†Œë“¤ì€ APIë¥¼ í†µí•´ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. APIëŠ” Application Programming Interfaceì˜ ì•½ìë¡œ, ì„œë¡œ ë‹¤ë¥¸ ì†Œí”„íŠ¸ì›¨ì–´ ì‘ìš© í”„ë¡œê·¸ë¨ ê°„ì— í†µì‹ í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê·œì¹™ê³¼ í”„ë¡œí† ì½œì˜ ì§‘í•©ì…ë‹ˆë‹¤.\n\nì´ë¥¼ ìœ„í•´ ìš°ë¦¬ëŠ” openweathermap.org ì›¹ì‚¬ì´íŠ¸ë¥¼ ì‚¬ìš©í•  ê²ƒì…ë‹ˆë‹¤. ì´ ì‚¬ì´íŠ¸ë¥¼ í†µí•´ ì „ ì„¸ê³„ ì–´ëŠ ìœ„ì¹˜ì˜ ë¬´ë£Œ ë‚ ì”¨ ì˜ˆë³´ì—ë„ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìš°ë¦¬ëŠ” 5ì¼ ë‚ ì”¨ ì˜ˆë³´ APIë¥¼ ì‚¬ìš©í•  ê²ƒì´ë©°, 3ì‹œê°„ ê°„ê²©ì˜ ì˜ˆë³´ ë°ì´í„°ë¥¼ í¬í•¨í•©ë‹ˆë‹¤: [https://openweathermap.org/forecast5](https://openweathermap.org/forecast5)\n\nì´ì œ ìš°ë¦¬ í”„ë¡œì íŠ¸ì˜ í•µì‹¬ ì‘ì—…ì— ì§ë©´í–ˆìŠµë‹ˆë‹¤: ìš°ë¦¬ê°€ ì›í•˜ëŠ” ë‚ ì”¨ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•˜ê³  SQL ë°ì´í„°ë² ì´ìŠ¤ë¡œ ì „ì†¡í•˜ê¸° ìœ„í•œ í•„ìš”í•œ ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ìˆ˜ì‹­ ì‹œê°„ ë™ì•ˆ ê³ êµ°ë¶„íˆ¬í•œ ê²°ê³¼, ê°€ì¥ ê´€ë ¨ì„± ìˆëŠ” ë‚ ì”¨ ë°ì´í„°ë¥¼ ì¶”ì¶œí•˜ê¸° ìœ„í•œ ì´ ì½”ë“œë¥¼ ê°œë°œí•´ëƒˆìŠµë‹ˆë‹¤:\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\ndef get_weather_data(cities):\n  # í´ë¼ìš°ë“œì—ì„œ ì‘ì—…í•  ì˜ˆì •ì´ë¯€ë¡œ ì»´í“¨í„°ëŠ” ì–´ë””ì— ìˆì„ì§€ ëª¨ë¦…ë‹ˆë‹¤ - ì»´í“¨í„° ì‹œê°„ëŒ€ë¥¼ ìš°ë¦¬ ì§€ì—­ ì‹œê°„ëŒ€ë¡œ ìˆ˜ì •í•©ì‹œë‹¤.\n  berlin_timezone = timezone(\"Europe/Berlin\")\n  API_key = \"7e5623c79f102b6c08b15c8hjib4cc9l\"    # ì´ê²ƒì€ ì‹¤ì œ ê°’ì´ ì•„ë‹™ë‹ˆë‹¤.\n  weather_items = []\n\n  for city in cities:\n    url = (f\"http://api.openweathermap.org/data/2.5/forecast?q={city}\u0026appid={API_key}\u0026units=metric\")\n    response = requests.get(url)\n    json = response.json()\n\n    # ì˜ˆë³´ë¥¼ ì‘ì„±í•œ ì‹œê°„ì„ ì•Œê¸° ìœ„í•´ ê²€ìƒ‰ ì‹œê°„ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.\n    retrieval_time = datetime.now(berlin_timezone).strftime(\"%Y-%m-%d %H:%M:%S\")\n\n    # ì´ì œ ìš°ë¦¬ì˜ ê´€ë ¨ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ, ë„ì‹œëŠ” ë„ì‹œ ì´ë¦„ì´ ì•„ë‹Œ ë„ì‹œ IDë¥¼ ë°˜ì˜í•´ì•¼ í•©ë‹ˆë‹¤.\n    city_id = cities_info.loc[cities_info[\"city_name\"] == city, \"city_id\"].values[0]  # ì—¬ê¸°ì—ì„œ ê°’ë“¤ì„ ê²€ìƒ‰í•´ì•¼ í•˜ë©°, ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ì‹œë¦¬ì¦ˆë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.\n\n    for item in json[\"list\"]:\n        weather_item = {\n            # ì—¬ëŸ¬ ë„ì‹œë¥¼ ê³ ë ¤í•  ë•Œ ì •ë³´ë¥¼ ëª…í™•íˆ ì•Œ ìˆ˜ ìˆê²Œ ë„ì‹œ ì´ë¦„ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.\n            \"city_id\": city_id,\n            \"forecast_time\": item.get(\"dt_txt\", None),\n            \"temperature\": item[\"main\"].get(\"temp\", None),\n            \"feels_like\": item[\"main\"].get(\"feels_like\", None),\n            \"forecast\": item[\"weather\"][0].get(\"main\", None),\n            \"humidity\": item[\"main\"].get(\"humidity\", None),\n            \"rain_in_last_3h\": item.get(\"rain\", {}).get(\"3h\", 0),\n            \"risk_of_rain\": item[\"pop\"],\n            \"snow_in_last_3h\": item.get(\"snow\", {}).get(\"3h\", 0),\n            \"wind_speed\": item[\"wind\"].get(\"speed\", None),\n            \"data_retrieved_at\": retrieval_time\n        }\n\n        weather_items.append(weather_item)\n\n  weather_df = pd.DataFrame(weather_items)\n  weather_df[\"forecast_time\"] = pd.to_datetime(weather_df[\"forecast_time\"])\n  weather_df[\"data_retrieved_at\"] = pd.to_datetime(weather_df[\"data_retrieved_at\"])\n  weather_df[\"snow_in_last_3h\"] = pd.to_numeric(weather_df[\"snow_in_last_3h\"], downcast=\"float.\")\n\n  return weather_df\n\nweather_df = get_weather_data([\"Berlin\", \"Hamburg\", \"Munich\", \"Cologne\", \"Frankfurt\"])\nweather_df     # í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒˆë¡œìš´ ë°ì´í„°í”„ë ˆì„ ìƒì„±\n```\n\në‚ ì”¨ ë°ì´í„°í”„ë ˆì„ ë° í…Œì´ë¸”ì˜ ì¤‘ìš” ê¸°ëŠ¥ ì¤‘ í•˜ë‚˜ëŠ” ë°ì´í„° ê²€ìƒ‰ ì‹œê°„ì„ ê¸°ë¡í•˜ëŠ” ì—´ì„ í¬í•¨í•´ì•¼ í•œë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ í•„í„°ë§ ë° ì¼ì •í•œ ê¸°ê°„ í›„ ìë™ìœ¼ë¡œ ì´ì „ ë°ì´í„°ê°€ ì‚­ì œë˜ë„ë¡ SQLì—ì„œ í”„ë¡œì‹œì €ë‚˜ í•¨ìˆ˜ë¥¼ ì‘ì„±í•˜ê±°ë‚˜ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ë°ì´í„° ì¼ê´€ì„± ëª©ì ìœ¼ë¡œ ë‚ ì”¨ì™€ ë°ì´í„° ê²€ìƒ‰ ì‹œê°„ì´ í•­ìƒ ì˜ˆë³´ì— ëŒ€í•œ ë‚ ì§œ/ì‹œê°„ê³¼ ë‹¤ë¥¸ ê²ƒì„ì„ í•­ìƒ ì¸ì‹í•  ìˆ˜ ìˆë„ë¡ í•˜ê¸° ìœ„í•œ ê²ƒì…ë‹ˆë‹¤.\n\nì´ê²ƒì´ Pythonì—ì„œ ìƒˆë¡œìš´ ë‚ ì”¨ ë°ì´í„°í”„ë ˆì„ì´ ë³´ì´ëŠ” ë°©ì‹ì…ë‹ˆë‹¤:\n\n\u003cimg src=\"/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_4.png\" /\u003e\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nì¼ë‹¨ ë‚ ì”¨ ë°ì´í„°í”„ë ˆì„ êµ¬ì¡°ë¥¼ ê°€ì§€ê³  ìˆì—ˆì„ ë•Œ, SQLì—ì„œ ë‚ ì”¨ í…Œì´ë¸”ì„ ìƒì„±í•˜ëŠ” ì‘ì—…ì„ ì‹œì‘í–ˆìŠµë‹ˆë‹¤:\n\n```js\n/***************************\në‚ ì”¨ í…Œì´ë¸”ì„ ìƒì„±í•©ë‹ˆë‹¤\n***************************/\n\nCREATE TABLE weather (\n    city_id INT,\n    forecast_time datetime,\n    temperature float,\n    feels_like float,\n    forecast VARCHAR(255) NOT NULL,\n    humidity INT,\n    rain_in_last_3h FLOAT,\n    risk_of_rain FLOAT,\n    snow_in_last_3h FLOAT,\n    wind_speed FLOAT,\n    data_retrieved_at DATETIME,\n    FOREIGN KEY (city_id) REFERENCES cities_info(city_id)\n    );\n\n-- TRUNCATE TABLE weather;   -- í…Œì´ë¸”ì´ ë„ˆë¬´ ì»¤ì§€ê³  ë°ì´í„°ê°€ ì˜¤ë˜ë˜ì—ˆì„ ë•Œ ëª¨ë“  í–‰ì„ ì§€ì›Œì•¼ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤\n```\n\nì´ê²ƒì€ ì—”ì§€ë‹ˆì–´ë§ì„ í†µí•´ ì—­ ê³µí•™ì„ ê±°ì³ ì—…ë°ì´íŠ¸ëœ SQL ìŠ¤í‚¤ë§ˆì…ë‹ˆë‹¤:\n\n\u003cimg src=\"/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_5.png\" /\u003e\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## ì§€ì—­ì—ì„œ ì „ì—­ìœ¼ë¡œ\n\nìš°ë¦¬ì˜ ì½”ë“œë¥¼ í´ë¼ìš°ë“œì— ì˜¬ë¦¬ê¸° ì „ì—, ë‚ ì”¨ ë°ì´í„° ê²€ìƒ‰ ì½”ë“œê°€ ë¡œì»¬ì—ì„œ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤. Pythonìœ¼ë¡œ ì½”ë“œë¥¼ ì‘ì„±í•œ í›„, ë¡œì»¬ SQL ì¸ìŠ¤í„´ìŠ¤ë¡œ ì „ì†¡í•´ë³´ê² ìŠµë‹ˆë‹¤:\n\n```python\nweather_df.to_sql(\"weather\",\n                  if_exists='append',\n                  con=connection_string,\n                  index=False)\n```\n\në§Œì•½ ìƒˆ ë°ì´í„°ê°€ ìš°ë¦¬ì˜ SQL í…Œì´ë¸”ì— ì¶”ê°€ëœë‹¤ë©´, ì‘ë™í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤!\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\níŒŒì´ì¬ì„ í†µí•´ ë¡œì»¬ ë°ì´í„°ë¥¼ ì…ë ¥í•œ í›„ SQL ë‚ ì”¨ í…Œì´ë¸”ì´ ì–´ë–»ê²Œ ë³´ì´ëŠ”ì§€ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:\n\n![Weather Table](/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_6.png)\n\n## Google Cloud Platform í†µí•©\n\në¡œì»¬ì—ì„œ ì½”ë“œê°€ ì‘ë™í•˜ëŠ” ê²ƒì„ í™•ì¸í•˜ë©´, ì´ì œ í´ë¼ìš°ë“œì— ì˜¬ë ¤ë³´ëŠ” ì‹œê°„ì…ë‹ˆë‹¤.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nêµ¬ê¸€ í´ë¼ìš°ë“œ í”Œë«í¼(GCP) ê³„ì •ì„ ì—´ê³  í´ë¼ìš°ë“œ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” ìì„¸íˆ ë‹¤ë£¨ì§€ëŠ” ì•Šê² ì§€ë§Œ MySQLì„ ì‚¬ìš©í•œ ì¢‹ì€ ë‹¨ê³„ë³„ ì„¤ëª…ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤: https://support.google.com/appsheet/answer/10107301?hl=en\n\nì œê²Œ ê°€ì¥ ì¤‘ìš”í•œ ë‹¨ê³„ ì¤‘ í•˜ë‚˜ëŠ” íŒŒì´ì¬ ë…¸íŠ¸ë¶ì—ì„œ ë¡œì»¬ IP í˜¸ìŠ¤íŠ¸ë¥¼ êµ¬ê¸€ IP í˜¸ìŠ¤íŠ¸ë¡œ ë³€ê²½í•˜ëŠ” ê²ƒì´ì—ˆìŠµë‹ˆë‹¤. êµ¬ì²´ì ìœ¼ë¡œ, ë°ì´í„°ë¥¼ SQLë¡œ ì „ì†¡í•˜ëŠ” ì½”ë“œ ë¸”ë¡ì—ì„œ ë³€ê²½í–ˆìŠµë‹ˆë‹¤:\n\n```js\nschema = \"gans\"         # ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„\nhost = \"XX.XXX.XX.XX\"   # ë¡œì»¬ í˜¸ìŠ¤íŠ¸:\"xxx.x.x.x\" (í´ë¼ìš°ë“œë¡œ ë³€ê²½í•˜ê¸° ì „)\nuser = \"root\"           # ì‚¬ìš©ì ì´ë¦„ (ê°€ì´ë“œ ì°¸ì¡°)\npassword = \"XXXX\"       # ë¹„ë°€ë²ˆí˜¸ ì§ì ‘ ì…ë ¥í•˜ê±°ë‚˜ ë‹¤ë¥¸ ë…¸íŠ¸ë¶ì—ì„œ ê°€ì ¸ì˜µë‹ˆë‹¤ (\"from xxxfile import my_password\")\nport = 3306\n\nconnection_string = f'mysql+pymysql://{user}:{password}@{host}:{port}/{schema}'     # ì´ ë¶€ë¶„ì´ íŒŒì´ì¬ ë…¸íŠ¸ë¶ì„ SQL ì›Œí¬ë²¤ì¹˜ì— ì—°ê²°í•˜ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤\n```\n\nì´ë ‡ê²Œ í•¨ìœ¼ë¡œì¨, ì´ì „ì— ìƒì„±í•œ ì •ì  í…Œì´ë¸”ì„ í´ë¼ìš°ë“œì— ìë™ìœ¼ë¡œ ì—…ë¡œë“œí•˜ê³  íŒŒì´ì¬ì—ì„œ ì½”ë“œë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•˜ì§€ ì•Šê³  ì´ë¯¸ ì¡´ì¬í•˜ëŠ” SQL í…Œì´ë¸”ì— ë°ì´í„°ë¥¼ ì±„ìš¸ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. ì•„ë‹ˆë©´ ì ì–´ë„ íŒŒì´ì¬ì—ì„œ ì½”ë“œë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤. í˜¹ì€ ìƒˆë¡œìš´ ë¹„ë™ì  í…Œì´ë¸”(ë„ì‹œ ì •ë³´ ë° ë„ì‹œ ì¸êµ¬)ì„ ì—…ë°ì´íŠ¸í•˜ê¸°ë¡œ ê²°ì •í•  ë•Œê¹Œì§€ì…ë‹ˆë‹¤.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nì´ í”„ë¡œì íŠ¸ì˜ ëª©ì ìœ¼ë¡œ, Pythonì—ì„œ ì´ ë‘ í‘œë¥¼ GCPë¡œ ì—…ë¡œë“œí•˜ë ¤ë©´ í˜¸ìŠ¤íŠ¸ IPë¥¼ ë³€ê²½í•˜ëŠ” ê²ƒìœ¼ë¡œ ì¶©ë¶„í•©ë‹ˆë‹¤. ë˜ ë‹¤ë¥¸ ë°©ë²•ì€ ë‘ í‘œë¥¼ ë§Œë“œëŠ” ì½”ë“œë¥¼ í´ë¼ìš°ë“œì— ì—…ë¡œë“œí•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ ê²½ìš°, ìš°ë¦¬ëŠ” í´ë¼ìš°ë“œì— ë™ì  í‘œ ë‚ ì”¨ë¥¼ ë§Œë“¤ê³  ì±„ìš°ëŠ” ì½”ë“œë§Œ ì˜¬ë¦´ ê²ƒì…ë‹ˆë‹¤.\n\nGCPì˜ \"Cloud Functions\" í•„ë“œì— í•¨ìˆ˜ë¥¼ ë§Œë“  í›„ ì—¬ëŸ¬ ë²ˆì˜ ì‹œí–‰ì°©ì˜¤ ëì— ì½”ë“œê°€ ë§ˆì¹¨ë‚´ ì‘ë™í–ˆìŠµë‹ˆë‹¤:\n\n![cloud_function_image](/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_7.png)\n\ní•˜ì§€ë§Œ ì½”ë“œê°€ ì‘ë™í•˜ê¸° ì „ì— í´ë¼ìš°ë“œ ì¸ìŠ¤í„´ìŠ¤ì— í•¨ìˆ˜ë¥¼ ì—°ê²°í•´ì•¼í•©ë‹ˆë‹¤. ì•„ë˜ ë‹¨ê³„ë¥¼ ë”°ë¼ì•¼í•©ë‹ˆë‹¤:\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n\u003cimg src=\"/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_8.png\" /\u003e\n\nì‘ì—…ì´ ì˜ë˜ì—ˆëŠ”ì§€ ì–´ë–»ê²Œ ì•Œ ìˆ˜ ìˆì„ê¹Œìš”? ê°€ì¥ ì¢‹ì€ ì†Œì‹ì€ ë‹¤ìŒê³¼ ê°™ì´ ë³´ì…ë‹ˆë‹¤:\n\n\u003cimg src=\"/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_9.png\" /\u003e\n\në¡œì»¬ì—ì„œ í…ŒìŠ¤íŠ¸í•œ ì½”ë“œì™€ ë¹„êµí•´ ìƒë‹¹í•œ ìˆ˜ì •ì´ í•„ìš”í–ˆìŠµë‹ˆë‹¤. ìµœì¢… ì½”ë“œëŠ” ì´ë ‡ê²Œ ë³´ì…ë‹ˆë‹¤:\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```python\nimport functions_framework\nimport pandas as pd\nimport sqlalchemy\nimport requests\nfrom pytz import timezone\nfrom datetime import datetime\n\n@functions_framework.http\ndef insert(request):\n  connection_string = connection()\n  insert_into_weather(connection_string)\n  return 'Data successfully added'\n\ndef connection():\n  connection_name = \"flying-dove-416317:europe-west1:wbs-mysql-db\"    # this is not a real one\n  db_user = \"root\"\n  db_password = \"xxxx\"   # fill in with your SQL password\n  schema_name = \"gans\"\n\n  driver_name = 'mysql+pymysql'\n  query_string = {\"unix_socket\": f\"/cloudsql/{connection_name}\"}\n\n  db = sqlalchemy.create_engine(\n      sqlalchemy.engine.url.URL(\n          drivername = driver_name,\n          username = db_user,\n          password = db_password,\n          database = schema_name,\n          query = query_string,\n      )\n  )\n  return db\n\n\n# HERE STARTS THE WEATHER DATA RETRIEVAL FUNCTION:\n\ndef extract_city(connection_string):\n    return pd.read_sql(\"cities_info\", con=connection_string)\n\ndef get_weather_data(cities_df):\n  berlin_timezone = timezone(\"Europe/Berlin\")\n  API_key = \"7e5623c79f102b6c08b15c8hjib4cc9l\"    # this is not a real one\n  weather_items = []\n\n  for city in cities_df[\"city_name\"]:\n    url = (f\"http://api.openweathermap.org/data/2.5/forecast?q={city}\u0026appid={API_key}\u0026units=metric\")\n    response = requests.get(url)\n    json = response.json()\n\n    # Added the time retrieved so we know when the forecast was made\n    retrieval_time = datetime.now(berlin_timezone).strftime(\"%Y-%m-%d %H:%M:%S\")\n\n    # As we are now using the data from our relational database, the city should reflect the city_id and not the city name\n    city_id = cities_df.loc[cities_df[\"city_name\"] == city, \"city_id\"].values[0]  # here we need to retrieve the values, otherwise it shows us the series\n\n    for item in json[\"list\"]:\n        weather_item = {\n            # Added the city name, so the information is clear when looking at multiple cities\n            \"city_id\": city_id,\n            \"forecast_time\": item.get(\"dt_txt\", None),\n            \"temperature\": item[\"main\"].get(\"temp\", None),\n            \"feels_like\": item[\"main\"].get(\"feels_like\", None),\n            \"forecast\": item[\"weather\"][0].get(\"main\", None),\n            \"humidity\": item[\"main\"].get(\"humidity\", None),\n            \"rain_in_last_3h\": item.get(\"rain\", {}).get(\"3h\", 0),\n            \"risk_of_rain\": item[\"pop\"],\n            \"snow_in_last_3h\": item.get(\"snow\", {}).get(\"3h\", 0),\n            \"wind_speed\": item[\"wind\"].get(\"speed\", None),\n            \"data_retrieved_at\": retrieval_time\n        }\n\n        weather_items.append(weather_item)\n\n  weather_df = pd.DataFrame(weather_items)\n  weather_df[\"forecast_time\"] = pd.to_datetime(weather_df[\"forecast_time\"])\n  weather_df[\"data_retrieved_at\"] = pd.to_datetime(weather_df[\"data_retrieved_at\"])\n  weather_df[\"snow_in_last_3h\"] = pd.to_numeric(weather_df[\"snow_in_last_3h\"], downcast=\"float\")\n\n  return weather_df\n\ndef insert_into_weather(connection_string):\n  cities_df = extract_city(connection_string)\n  weather_df = get_weather_data(cities_df)    # we create the new dataframe using the function\n  weather_df.to_sql(\"weather\",\n            if_exists=\"append\",\n            con=connection_string,\n            index=False)\n```\n\n## Lessons learned from making our code cloud-worthy\n\n### 1. Dependencies:\n\nWe need to add the right dependencies to the `requirements.txt` file. This was one of the main initial reasons preventing our code from working properly. It is important to note that some libraries are already uploaded on GCP by default and should not be included in the `.txt` file, but still need to be added as a library in our source code, e.g.:\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n```js\nfrom pytz import timezone\nfrom datetime import datetime\n```\n\në§Œì•½ ë°°í¬ë¥¼ ì‹œë„í•œ í›„ì— ë¹¨ê°„ ë°°ë„ˆ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤ë©´, ëŒ€ë¶€ë¶„ì˜ ê²½ìš° requirements.txt íŒŒì¼ì— ëª…ì‹œë˜ì–´ ìˆì§€ ì•Šì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ importí•˜ëŠ” ê²ƒì´ ì›ì¸ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n![image](/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_10.png)\n\nrequirements ì„¹ì…˜ì—ì„œëŠ” Python ëª¨ë“ˆì´ ì•„ë‹Œ íŒ¨í‚¤ì§€ë§Œ ì¶”ê°€í•´ì•¼ í•©ë‹ˆë‹¤. ë¯¸ë¦¬ ì•Œë ¤ë“œë¦¬ìë©´, ì—¬ê¸° Python ëª¨ë“ˆë“¤ì˜ ì¢…í•© ëª©ë¡ì´ ìˆìŠµë‹ˆë‹¤: [Python ëª¨ë“ˆ ëª©ë¡](https://docs.python.org/3/py-modindex.html)\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\në‹¤ë¥¸ ìœ ìš©í•œ íŒì€ ì½”ë“œì—ì„œ ì‚¬ìš© ì¤‘ì¸ ëª¨ë“  ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì¶œë ¥í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ë…¸íŠ¸ë¶ì—ì„œ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œ í›„ì—ëŠ” ë‹¤ìŒì„ ì‹¤í–‰í•´ì•¼ í•©ë‹ˆë‹¤:\n\n```js\nprint('\\n'.join(f'{m.__name__}=={m.__version__}' for m in globals().values() if getattr(m, '__version__', None)))\n```\n\nê·¸ëŸ° ë‹¤ìŒ ì ì ˆí•œ ì¢…ì†ì„±ìœ¼ë¡œ requirements.txtì— ì§ì ‘ ë³µì‚¬í•˜ì—¬ ë¶™ì—¬ë„£ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n![ì´ë¯¸ì§€](/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_11.png)\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nì´ í”„ë¡œì íŠ¸ë¥¼ ìœ„í•´ í•„ìš”í•œ ì˜ì¡´ì„±ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤ .txt íŒŒì¼:\n\n```js\nfunctions-framework==3.*\nSQLAlchemy==1.4.37\nPyMySQL==1.0.2\npandas==1.5.2\nrequests==2.31.0\n```\n\n## 2. ì—°ê²° ì½”ë“œ í…ŒìŠ¤íŠ¸\n\në°ì´í„° ê²€ìƒ‰ í•¨ìˆ˜ë¥¼ ì¶”ê°€í•˜ê¸° ì „ì— ì—°ê²° ì½”ë“œê°€ ì‘ë™í•˜ëŠ”ì§€ ë¨¼ì € í…ŒìŠ¤íŠ¸í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ë¬¸ì œê°€ ì—°ê²° ì„¤ì •ì— ìˆëŠ”ì§€ ì•„ë‹Œì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\në¡œì»¬ ìŠ¤í¬ë¦½íŠ¸ë¥¼ GCPë¡œ ì´ë™í•  ë•Œ ì¢‹ì€ ì‹œì‘ ë°©ë²•ì€ \"ë”ë¯¸\" í•¨ìˆ˜ë¥¼ ë§Œë“¤ê³  í…ŒìŠ¤íŠ¸í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´:\n\n```js\nimport functions_framework\nimport pandas as pd\nimport sqlalchemy\n\n@functions_framework.http\ndef insert(request):\n  connection_string = connection()\n  insert_into_test_table(connection_string)\n  return 'Data successfully added'\n\ndef connection():\n  connection_name = \"YOUR_DB_CON_NAME\"  # ë³€ê²½í•´ì£¼ì„¸ìš”\n  db_user = \"root\"                      # ë³€ê²½\n  db_password = \"YOUR_PASSWORD\"         # ë³€ê²½\n  schema_name = \"test_schema\"           # ë³€ê²½\n\n  driver_name = 'mysql+pymysql'\n  query_string = {\"unix_socket\": f\"/cloudsql/{connection_name}\"}\n\n  db = sqlalchemy.create_engine(\n      sqlalchemy.engine.url.URL(\n          drivername = driver_name,\n          username = db_user,\n          password = db_password,\n          database = schema_name,\n          query = query_string,\n      )\n  )\n  return db\n\ndef insert_into_test_table(con_str):\n  data = {'FirstName': ['Function', 'Test'],\n          'City': ['Cloud', 'Complete']}\n  df = pd.DataFrame(data)\n  df.to_sql(name=\"test_table\", con=con_str, if_exists='append', index=False)\n```\n\nì´ ê°„ë‹¨í•œ í•¨ìˆ˜ê°€ ì‘ë™í•˜ë©´ ì—°ê²°ì´ ì‘ë™í•˜ëŠ” ê²ƒì´ê³ , í•  ì¼ì€ ì‹¤ì œ ì½”ë“œë¥¼ ì¶”ê°€í•˜ê³  í†µí•©í•˜ëŠ” ê²ƒë¿ì…ë‹ˆë‹¤.\n\në‹¤ìŒ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´ ìš°ë¦¬ì˜ ì½”ë“œì— ë¬¸ì œê°€ ìˆìŒì„ ê°€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n## 3. ìš°ë¦¬ ì‹¤ì œ ì½”ë“œì˜ ë¬¸ì œì \n\në‚´ ì½”ë“œë¥¼ ì˜¨ë¼ì¸ì— ì˜¬ë¦´ ë•Œ ì‹¤ìˆ˜í•œ ì£¼ìš”í•œ ë¶€ë¶„ì€ \"ë”ë¯¸\" í…œí”Œë¦¿ì„ ê¸°ë°˜ìœ¼ë¡œ ì½”ë“œë¥¼ ì¡°ì •í•˜ê³  ì‹¤ì œë¡œ ì •ì˜ë˜ì§€ ì•Šì€ \"insert_into_weather\" í•¨ìˆ˜ë¥¼ \"@functions_framework.http\" ì•„ë˜ì—ì„œ í˜¸ì¶œí–ˆë‹¤ëŠ” ê²ƒì´ì—ˆìŠµë‹ˆë‹¤.\n\nì´ í•¨ìˆ˜ë¥¼ ì¶”ê°€í•œ í›„ì—ë„ ì½”ë“œê°€ ì‘ë™í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì´ëŠ” í•„ìš”í•œ ë„ì‹œë¥¼ ìˆ˜ë™ìœ¼ë¡œ ëª…ëª…í–ˆê¸° ë•Œë¬¸ì— ë„ì‹œ ì •ë³´ ë°ì´í„°í”„ë ˆì„ì—ì„œ ì´ë¯¸ ê°€ì ¸ì˜¤ëŠ” ëŒ€ì‹ ì— ë„ì‹œ ì´ë¦„ì„ ìˆ˜ë™ìœ¼ë¡œ ì§€ì •í•´ì„œ ì˜¤ëŠ” ì ê³¼ ê´€ë ¨ì´ ìˆì—ˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ë‚˜ëŠ” ë¨¼ì € \"extract_city\"ë¼ëŠ” ë˜ ë‹¤ë¥¸ í•¨ìˆ˜ë¥¼ ì¶”ê°€í•´ì•¼ í–ˆê³ , ì´ í•¨ìˆ˜ê°€ ë¡œì»¬ì—ì„œ ì‘ë™í•˜ëŠ” ê²ƒì„ í™•ì¸ í›„ì— ì½”ë“œë¥¼ ì˜¨ë¼ì¸ì— ë°°í¬í•´ì•¼ í–ˆìŠµë‹ˆë‹¤.\n\në„ì‹œ ì´ë¦„ì„ ì–»ê¸° ìœ„í•´ cities_info í…Œì´ë¸”ì„ ì‚¬ìš©í•œ í›„ì—, ë„ì‹œ ì´ë¦„ì„ ì¶”ì¶œí•˜ì§€ ì•Šì€ ì „ ë°˜ë³µë¬¸ì„ ì—…ë°ì´íŠ¸í•˜ì§€ ì•Šì€ ë‹¤ë¥¸ ì‹¤ìˆ˜ë¥¼ í–ˆìŠµë‹ˆë‹¤. ì´ì œ ë„ì‹œ ì´ë¦„ì„ ì´ì „ì— ëª©ë¡ì—ì„œ ê°€ì ¸ì˜¤ì§€ ì•Šê³  ë°ì´í„°í”„ë ˆì„ì—ì„œ ê°€ì ¸ì™€ì•¼ í–ˆê³ , ì´ì „ ì¸ìˆ˜ë¡œëŠ” ë„ì‹œ ì´ë¦„ì„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\n# ë§ˆì§€ë§‰ ë‹¨ê³„\n\nìš°ë¦¬ í”„ë¡œì íŠ¸ë¥¼ ì™„ì „íˆ ê¸°ëŠ¥ì ì´ê³  ìë™í™”í•˜ê¸° ìœ„í•´ ì£¼ê¸°ì ìœ¼ë¡œ ì‹¤í–‰í•  í•¨ìˆ˜ë¥¼ ì˜ˆì•½í•´ì•¼ í•©ë‹ˆë‹¤. GCPì˜ \"Cloud Scheduler\" ë©”ë‰´ë¥¼ ì‚¬ìš©í•˜ë©´ ìƒë‹¹íˆ ì‰½ìŠµë‹ˆë‹¤.\n\nì´ë¥¼ ìœ„í•´ \"ì‘ì—… ì˜ˆì•½\"ì„ í•˜ê³  ëª‡ ê°€ì§€ ë§¤ê°œë³€ìˆ˜ë¥¼ ì œê³µí•˜ê³  ë¹ˆë„ë¥¼ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤(ë§¤ì£¼ í•œ ë²ˆ ë˜ëŠ” Cron í‘œí˜„ì‹ì„ ì‚¬ìš©í•˜ì—¬ íŠ¹ì • ì‹œê°„ì— íŠ¹ì • ìš”ì¼ì— ì‹¤í–‰í•˜ë„ë¡ ì„¤ì •). ì´ë ‡ê²Œ í•˜ë©´ í•´ë‹¹ ì‹œê°„ì— í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ì–´ SQL í…Œì´ë¸”ì— í•„ìš”í•œ ë°ì´í„°ë¥¼ ì±„ì›ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì—¬ê¸°ì„œëŠ” ë§¤ì£¼ ì›”ìš”ì¼ ì˜¤í›„ 3ì‹œì— ì‹¤í–‰ë˜ë„ë¡ ì„¤ì •í–ˆìŠµë‹ˆë‹¤:\n\n![ì´ë¯¸ì§€](/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_12.png)\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nSQLì—ì„œ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”:\n\n![image](/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_13.png)\n\nì²« ë²ˆì§¸ SQL-to-Python-to-GCP í”„ë¡œì íŠ¸ì™€ ì‘ë³„í•˜ê¸° ì „ì—, ë¬´ë£Œ í¬ë ˆë”§ì„ ì†Œë¹„í•˜ì§€ ì•Šë„ë¡ GCP ê³„ì •ì—ì„œ ë°ì´í„°ë¥¼ ì‚­ì œí•´ì•¼ í•´ìš”. ì´ëŠ” í´ë¼ìš°ë“œ ì¸ìŠ¤í„´ìŠ¤, í•¨ìˆ˜ ë° ì˜ˆì•½ëœ ì‘ì—…ì„ í¬í•¨í•´ìš”.\n\n# ë\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nì´ ê¸€ì„ ì“°ë©´ì„œ SQL, Python ë° í´ë¼ìš°ë“œ ì»´í“¨íŒ…ì„ ê²°í•©í•œ ë§¤ìš° ê¸°ë³¸ì ì¸ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ êµ¬ì¶•í•˜ëŠ” ë°©ë²•ì„ ë°°ì› ì–´ìš”.\n\nì´ í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í•  ë•Œ êµ¬ê¸€ í´ë¼ìš°ë“œ í”Œë«í¼ ë˜ëŠ” ë‹¤ë¥¸ í´ë¼ìš°ë“œ ì»´í“¨íŒ… í”Œë«í¼ì— ëŒ€í•´ ì „í˜€ ì•Œì§€ ëª°ëì–´ìš”. ì„œë²„, í˜¸ìŠ¤íŠ¸, ì¸ìŠ¤í„´ìŠ¤ ë˜ëŠ” ì†Œí”„íŠ¸ì›¨ì–´ ì—°ê²°ì— ëŒ€í•´ ì•„ë¬´ê²ƒë„ ëª¨ë¥´ê³  ìˆì—ˆì–´ìš” (ì§€ê¸ˆë„ìš”). SQLê³¼ Pythonì˜ ê¸°ë³¸ì ì¸ ì§€ì‹ë§Œ ìˆì—ˆì–´ìš”.\n\nì´ë ‡ê²Œ ì´ˆë³´ìë¡œ ì‹œì‘í–ˆì„ ë•Œ, ìë™í™”ëœ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ìƒì„±í•˜ê³  ì£¼ê¸°ì ìœ¼ë¡œ ê°€ì¹˜ ìˆëŠ” ë°ì´í„°ë¡œ ì±„ìš°ëŠ” ì¼ì´ ë„ˆë¬´ ì–´ë ¤ìš¸ ê²ƒì´ë¼ê³  íšŒì˜ì ì´ì—ˆì–´ìš”. ì´ì œ ë‚´ê°€ í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ì•Œê²Œ ë˜ì—ˆì–´ìš”!\n\nì•ìœ¼ë¡œì˜ ê³„íšì€ ë‹¤ë¥¸ APIì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ GCP ê¸°ëŠ¥ì— ê²°í•©í•˜ì—¬ ë” ì™„ì „í•˜ê³  ìœ ìš©í•œ ìµœì¢… ì œí’ˆì„ ë§Œë“¤ê³  ì‹¶ì–´í•´ìš”.\n\n\u003c!-- ui-station ì‚¬ê°í˜• --\u003e\n\n\u003cins class=\"adsbygoogle\"\nstyle=\"display:block\"\ndata-ad-client=\"ca-pub-4877378276818686\"\ndata-ad-slot=\"7249294152\"\ndata-ad-format=\"auto\"\ndata-full-width-responsive=\"true\"\u003e\u003c/ins\u003e\n\n\u003cscript\u003e\n(adsbygoogle = window.adsbygoogle || []).push({});\n\u003c/script\u003e\n\nê¸€ì„ ì“°ëŠ” ì‚¬ëŒì´ë¼ê³  í•˜ë”ë¼ë„ ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ì„ ì†Œí”„íŠ¸ì›¨ì–´ ì—”ì§€ë‹ˆì–´ë§Œí¼ ì˜ í•  ìˆ˜ëŠ” ì—†ì„ ì§€ë„ ëª¨ë¥´ê² ì–´ìš”. í•˜ì§€ë§Œ ìš°ë¦¬ëŠ” ê¸°ì´ˆë¥¼ ë°°ìš°ê³  ê±°ê¸°ì„œë¶€í„° ì„±ì¥í•  ìˆ˜ ìˆì£ .\n\n# Stackademic ğŸ“\n\nëê¹Œì§€ ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤. ë– ë‚˜ì‹œê¸° ì „ì—:\n\n- ì €ìë¥¼ í´ë©í•˜ì‹œê³  íŒ”ë¡œìš°í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ‘\n- ìš°ë¦¬ë¥¼ íŒ”ë¡œìš°í•´ì£¼ì„¸ìš” X | LinkedIn | YouTube | Discord\n- ë‹¤ë¥¸ í”Œë«í¼ì—ì„œë„ ë§Œë‚˜ë³´ì„¸ìš”: In Plain English | CoFeed | Venture | Cubed\n- ë” ë§ì€ ì½˜í…ì¸ ëŠ” Stackademic.comì—ì„œ í™•ì¸í•˜ì„¸ìš”\n","ogImage":{"url":"/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_0.png"},"coverImage":"/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_0.png","tag":["Tech"],"readingTime":30},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003ch2\u003eê¸€ì„ ì“°ëŠ” ì‚¬ëŒì´ ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ë„ ë°°ìš¸ ìˆ˜ ìˆì„ ê±°ë¼ê³  ìƒê°í•´ìš”.\u003c/h2\u003e\n\u003cp\u003e\"ì´ê²Œ ë¬´ìŠ¨ ì¼ì´ì£ .\"\u003c/p\u003e\n\u003cp\u003eì²˜ìŒ ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ ì—…ë¬´ë¥¼ ë§¡ì•˜ì„ ë•Œ ë‚˜ëŠ” ì´ë ‡ê²Œ ìƒê°í–ˆì–´ìš”. í•˜ì§€ë§Œ ì–¼ë§ˆ í›„, ìš°ë¦¬ê°€ í•˜ë‚˜ì”© ìœ„í‚¤í”¼ë””ì•„ì—ì„œ ì§‘ì–´ë‚¼ ëª‡ ê°€ì§€ ìˆ«ìë¥¼ ê°€ì ¸ì˜¤ëŠ” ê²ƒì´ ì²« ë²ˆì§¸ ë‹¨ê³„ì˜€ë‹¤ëŠ” ê²ƒì„ ê¹¨ë‹¬ì•˜ì£ .\u003c/p\u003e\n\u003cp\u003eíŒŒì´ì¬ì—ì„œ ì‘ì—…ì„ í•´ì£¼ì…”ì•¼ê² ë‹¤ê³  ë§ì”€í•˜ì…”ì•¼ í–ˆë˜ ì²« ë²ˆì§¸ ì–´ë ¤ì›€ì´ ìˆì—ˆì–´ìš”! ì¦‰, ë°ì´í„°ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ê°€ì ¸ì˜¤ëŠ” ë‚ ì´ ëë‚¬ë‹¤ëŠ” ê±°ì£ . ì¸ë‚´ì‹¬ì„ ê°€ì§€ê³  ìì‹ ì—ê²Œ ì´ëŸ° ë§ì„ í•´ë³´ì„¸ìš”. ê´œì°®ì•„, ì´ ì¼ ì˜ í•  ìˆ˜ ìˆì–´ìš”!\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eë¬¸ì œ: ì‚¬íšŒê³¼í•™ ì¡¸ì—…ìƒì´ ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ì„ ëŠ¥ìˆ™í•˜ê²Œ ìˆ˜í–‰í•  ìˆ˜ ìˆì„ê¹Œìš”? ìë™í™”ëœ ë°ì´í„° íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•˜ê³  ì•ˆì „í•˜ê²Œ í´ë¼ìš°ë“œì— ë³´ê´€í•  ìˆ˜ ìˆì„ê¹Œìš”?\u003c/p\u003e\n\u003cp\u003eê·€ë¬´ê°€ì„¤: ì—”ì§€ë‹ˆì–´ëŠ” ìƒì—…ìœ¼ë¡œ ê¸€ì„ ì“°ëŠ” ì‚¬ëŒë§Œí¼ ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eì´ ê°€ì„¤ì„ ê¸°ê°í•´ì•¼ í• ê¹Œìš”? ë‚´ ì§ê°ì€ \"ì˜ˆ\"ë¼ê³  ë§í–ˆìŠµë‹ˆë‹¤. IT ë¹„ì „ë¬¸ê°€ì¸ ë‚˜ ê°™ì€ ì‚¬ëŒì´ ê·¸ë ‡ê²Œ í•  ìˆ˜ëŠ” ì—†ì„ ê²ƒ ê°™ì•„ìš”.\u003c/p\u003e\n\u003cp\u003eëŒ€ì•ˆ ê°€ì„¤ì€ ì•„ë§ˆë„ ì´ë ‡ê²Œ í•  ìˆ˜ ìˆì„ ê²ƒ ê°™ì•„ìš”: ìƒì—…ìœ¼ë¡œ ê¸€ì“°ëŠ” ì‚¬ëŒë„ ì—”ì§€ë‹ˆì–´ì²˜ëŸ¼ ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ì„ ë°°ìš¸ ìˆ˜ ìˆë‹¤ë©´ìš”.\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eì—¬ê¸°ì„œ ì‹œì‘í•´ìš”...\u003c/p\u003e\n\u003ch2\u003eìš°ë¦¬ ë¹„ì¦ˆë‹ˆìŠ¤ ì¼€ì´ìŠ¤\u003c/h2\u003e\n\u003cp\u003eì´ ì‘ì—…ì€ ì£¼ë¡œ ì „ê¸° ì´ë™ì„±ì— ê´€ë ¨ëœ ì‚¬ì—…ì„ í•˜ëŠ” \"Gans\" íšŒì‚¬ë¥¼ ìœ„í•œ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ìƒì„±í•˜ëŠ” ê²ƒì„ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤. íŠ¹ì • ì‹œê°„ì— ì¶©ë¶„í•œ ì´ë™ì„± ë‹¨ìœ„ë¥¼ ì œê³µí•˜ê¸° ìœ„í•´ ë‚ ì”¨ ìš”ì†Œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìˆ˜ìš”ë¥¼ ì¸¡ì •í•˜ê¸° ìœ„í•œ ë°ì´í„° ê³¼í•™ìë¥¼ í•„ìš”ë¡œ í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eíšŒì‚¬ì˜ ì£¼ìš” ì‚¬ì—…ì€ ë…ì¼ì—ì„œ ìŠ¤ì¿ í„°ë¥¼ ëŒ€ì—¬í•˜ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì— ë¹„ê°€ ì˜¤ê±°ë‚˜ ëˆˆì´ ì˜¤ëŠ” ê²½ìš°ì—ëŠ” ì¼ë°˜ì ìœ¼ë¡œ ìˆ˜ìš”ê°€ ì¤„ì–´ë“¤ê²Œ ë©ë‹ˆë‹¤. ë¹„ë‚˜ ëˆˆì´ ì˜ˆë³´ëœ ê²½ìš°, ì„ì‹œ ìˆ˜ìš”ë„ ì¦ê°€í•  ê²ƒì…ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eë”°ë¼ì„œ, í˜„ì¬ ê³¼ì œëŠ” ë„ì‹œì™€ ë‚ ì”¨ ì •ë³´ë¡œ ì±„ì›Œì§„ ê°„ë‹¨í•œ SQL ë°ì´í„°ë² ì´ìŠ¤ë¥¼ êµ¬ì¶•í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. íšŒì‚¬ì˜ ìš´ì˜ ë¶€ì„œëŠ” ë§¤ì¼ì´ ì´ ë°ì´í„°ë² ì´ìŠ¤ì— ì•¡ì„¸ìŠ¤í•˜ì—¬ ì´ë™ ê°€ëŠ¥ ì°¨ëŸ‰ì˜ ì§€ë¦¬ì  ê°€ìš©ì„±ì— ê´€í•œ íŒë‹¨ì„ ë‚´ë¦´ ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eë‚˜ì¤‘ì— ë°ì´í„°ë² ì´ìŠ¤ëŠ” ê´€ê´‘ê° ë°©ë¬¸ ì˜ˆìƒ ë“±ì„ ì œê³µí•˜ê¸° ìœ„í•´ ê³µê³µ êµí†µ ë„ì°© ì •ë³´(ì˜ˆ: í•­ê³µí¸, ê¸°ì°¨, ë˜ëŠ” ë²„ìŠ¤ API ì‚¬ìš©)ê°€ í¬í•¨ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë“¤ì€ íšŒì‚¬ì˜ ì ì¬ì  ê³ ê° ì¤‘ ì¼ë¶€ì…ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eë‹¤ìŒì€ ë‚ ì”¨ì™€ í•­ê³µí¸ APIë¥¼ í¬í•¨í•œ ì§€ë„ í”„ë¡œì íŠ¸ì˜ ëª¨ìŠµì…ë‹ˆë‹¤:\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eì´ ê¸°ì‚¬ì—ì„œëŠ” ë‚ ì”¨ ë°ì´í„° í†µí•©ë§Œ ë‹¤ë£¨ê³  ë‚˜ì¤‘ì— ì „ì†¡ ë¶€ë¶„ì€ ë‚˜ì¤‘ì— ê°œì„ í•  ê²ƒì…ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eì‹œì‘í•˜ê¸° ì „ì— Pythonì—ì„œ í•„ìš”í•œ ëª¨ë“  ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ê°€ì ¸ì™€ì•¼ í•©ë‹ˆë‹¤:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e pandas \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e pd\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e requests\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e bs4 \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e BeautifulSoup\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e datetime \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e datetime\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e pytz \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e timezone\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eì›¹ ìŠ¤í¬ë˜í•‘ 101: HTML ì½”ë“œë¥¼ ê°€ì ¸ì˜¤ëŠ” ë°©ë²•?\u003c/h2\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eë¨¼ì €, ë‹¤ë¥¸ í…Œì´ë¸”ê³¼ ê´€ë ¨í•˜ëŠ” ì£¼ìš” í…Œì´ë¸”ë¡œ ì‘ìš©í•˜ëŠ” ë„ì‹œ ì •ë³´ê°€ í¬í•¨ëœ í…Œì´ë¸”ì„ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤. ì´ í…Œì´ë¸”ì€ ì£¼ê¸°ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•  í•„ìš”ê°€ ì—†ëŠ” ì •ì  í…Œì´ë¸”ì´ ë  ê²ƒì…ë‹ˆë‹¤. ì´ í…Œì´ë¸”ì„ \"cities_info\"ë¼ê³  ë¶€ë¥¼ ê²ƒì…ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eê° ë„ì‹œì— ëŒ€í•´ ê³ ìœ í•œ ë„ì‹œ ID, ë„ì‹œ ì´ë¦„, ë…ì¼ì˜ ì†Œì† ì£¼(State), ìœ„ë„ ë° ê²½ë„ê°€ í¬í•¨ëœ 5ê°œ ì—´ì´ ìˆì„ ê²ƒì…ë‹ˆë‹¤. ê° ë„ì‹œì— ëŒ€í•œ ì´ ì •ë³´ëŠ” ì˜ì–´ ìœ„í‚¤í”¼ë””ì•„ ì‚¬ì´íŠ¸ì—ì„œ ìŠ¤í¬ë˜í•‘í•˜ì—¬ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆì‚°ì´ í—ˆìš©í•œë‹¤ë©´, ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ì™€ ë°©ë²•ë¡ ì  ì •ë³´ê°€ í¬í•¨ëœ ë„ì‹œì˜ APIë¥¼ êµ¬ë§¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ í”„ë¡œì íŠ¸ì—ì„œëŠ” ìœ„í‚¤í”¼ë””ì•„ë¥¼ ì‚¬ìš©í•˜ì—¬ ìŠ¤í¬ë˜í•‘ ê¸°ìˆ ì„ ì—°ìŠµí•  ê²ƒì…ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eì²˜ìŒì—ëŠ” ê° ì›¹ì‚¬ì´íŠ¸ë§ˆë‹¤ HTML ì½”ë“œë¥¼ ìˆ˜ë™ìœ¼ë¡œ ë‚´ë³´ë‚´ê³  Vs Codeì— ë³µì‚¬í•´ì•¼ í•œë‹¤ëŠ” ìƒê°ì´ ì••ë„ì ì´ì—ˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ë‹¤í–‰íˆ íŒŒì´ì¬ì˜ \"requests\" ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ë©´ ìë™ìœ¼ë¡œ ìˆ˜í–‰í•  ìˆ˜ ìˆìŒì„ ì•Œê²Œ ë˜ì–´ ì•ˆë„í–ˆìŠµë‹ˆë‹¤:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e requests\nberlin_url = \u003cspan class=\"hljs-string\"\u003e\"https://en.wikipedia.org/wiki/Berlin\"\u003c/span\u003e\nberlin_response = requests.\u003cspan class=\"hljs-title function_\"\u003eget\u003c/span\u003e(berlin_url)\nberlin_soup = \u003cspan class=\"hljs-title class_\"\u003eBeautifulSoup\u003c/span\u003e(berlin_response.\u003cspan class=\"hljs-property\"\u003econtent\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'html.parser'\u003c/span\u003e)\n\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(berlin_soup.\u003cspan class=\"hljs-property\"\u003eprettify\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eíŒŒì´ì¬: 1 - ë‚˜: 0\u003c/p\u003e\n\u003ch2\u003eë£¨í”„ì™€ í•¨ìˆ˜\u003c/h2\u003e\n\u003cp\u003eì´í„°ë ˆì´ì…˜ì˜ ì„±ë°°ì…ë‹ˆë‹¤. ì´ë“¤ ì—†ì´ëŠ” ë™ì¼í•œ ì½”ë“œë¥¼ ì¬ìƒì‚°í•˜ê³  ë‹¤ë¥¸ URLì— ë™ì‹œì— ì ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì´ê²ƒì´ ì›¹ ìŠ¤í¬ë ˆì´í•‘ì„ ìë™í™”í•˜ëŠ” ì—´ì‡ ì…ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eì—¬ê¸°ì—ëŠ” ê° ìœ„í‚¤í”¼ë””ì•„ ì‚¬ì´íŠ¸ì˜ HTML ì½”ë“œë¥¼ ê²€ìƒ‰í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•œ ë£¨í”„ì˜ ì˜ˆì‹œê°€ ìˆìŠµë‹ˆë‹¤:\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003ecities_list = [\u003cspan class=\"hljs-string\"\u003e\"Berlin\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"Hamburg\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"Munich\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"Cologne\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"Frankfurt\"\u003c/span\u003e]\n\n\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e city \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ecities_list\u003c/span\u003e:\n  url = f\u003cspan class=\"hljs-string\"\u003e\"https://www.wikipedia.org/wiki/{city}\"\u003c/span\u003e   # urlì„ f ë¬¸ìì—´ë¡œ ë³€í™˜í•˜ì—¬ ë„ì‹œë¥¼ ë³€ìˆ˜ë¡œ ë„£ì–´ í•´ë‹¹ ë„ì‹œì—ì„œ ë‹¤ë¥¸ ë„ì‹œë¡œ ë³€ê²½ë¨\n  response = requests.\u003cspan class=\"hljs-title function_\"\u003eget\u003c/span\u003e(url)          # ìœ„í‚¤ë°±ê³¼ í˜ì´ì§€ì˜ ëª¨ë“  ë‚´ìš©ì„ ê°€ì ¸ì™€ responseì— ì €ì¥\n  city_soup = \u003cspan class=\"hljs-title class_\"\u003eBeautifulSoup\u003c/span\u003e(response.\u003cspan class=\"hljs-property\"\u003econtent\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'html.parser'\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eì§€ê¸ˆì€ í•¨ìˆ˜ê°€ ë¬´ì„œì›Œì„œ ìµœëŒ€í•œ í”¼í•˜ê³  ìˆì–´ìš” ğŸ˜…\u003c/p\u003e\n\u003cp\u003eíŒŒì´ì¬: 1,000 â€” ë‚˜: 0\u003c/p\u003e\n\u003ch2\u003eHTMLì—ì„œ ë¬´ì—‡ì„ ì ‘ê·¼í•˜ë‚˜ìš”?\u003c/h2\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eHTMLì—ì„œ \"p íƒœê·¸\"ë¼ëŠ” ê²ƒì´ ìˆì–´ìš”. ì´ë¥¼ ì•¡ì„¸ìŠ¤í•˜ëŠ” ë° ìœ ìš©í•©ë‹ˆë‹¤. ë‹¤ìŒ ì½”ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ê·¸ë ‡ê²Œ í•  ìˆ˜ ìˆì–´ìš”:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(soup.\u003cspan class=\"hljs-property\"\u003ep\u003c/span\u003e)   # ì²« ë²ˆì§¸ p íƒœê·¸ ìì²´ì— ì ‘ê·¼\n\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(soup.\u003cspan class=\"hljs-property\"\u003ep\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003estring\u003c/span\u003e)  # ì²« ë²ˆì§¸ p íƒœê·¸ì™€ ê´€ë ¨ëœ ë¬¸ìì—´ì— ì ‘ê·¼\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e child \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e soup.\u003cspan class=\"hljs-property\"\u003ediv\u003c/span\u003e:  # \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003eë²ˆì§¸ divì—ì„œ ê° ìì‹ì„ ì°¾ì•„ì„œ ì¸ì‡„í•˜ëŠ” ì˜ˆì œ\n    \u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(child)\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003ePythonì—ì„œ ë°ì´í„°í”„ë ˆì„ ë° SQLì—ì„œ í•´ë‹¹ í…Œì´ë¸” ë§Œë“¤ê¸°\u003c/h2\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eHTML ë° ì›¹ ìŠ¤í¬ë˜í•‘ ê¸°ìˆ ì„ ì—°ë§ˆí•œ í›„, ì²« ë‘ í…Œì´ë¸”ì— í•„ìš”í•œ ëª¨ë“  ì •ë³´ë¥¼ ì–»ê¸° ìœ„í•´ ì´ ë£¨í”„ë¥¼ ë§Œë“¤ì—ˆì–´ìš”.\u003c/p\u003e\n\u003cp\u003eì²« ë²ˆì§¸ ë°ì´í„°í”„ë ˆì„ì€ ì •ì  ì¸ë±ìŠ¤ë¡œ ì‘ë™í•  ê²ƒì´ê³  (ì¦‰, ì •ë³´ë¥¼ ì •ê¸°ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•  í•„ìš”ê°€ ì—†ì–´ìš”): cities_info\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003ecities_list = [\u003cspan class=\"hljs-string\"\u003e\"ë² ë¥¼ë¦°\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"í•¨ë¶€ë¥´í¬\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"ë®Œí—¨\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"ì¾°ë¥¸\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"í”„ë‘í¬í‘¸ë¥´íŠ¸\"\u003c/span\u003e]\nstates = []\nlatitudes = []\nlongitudes = []\n\n\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e city \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ecities_list\u003c/span\u003e:\n  url = f\u003cspan class=\"hljs-string\"\u003e\"https://www.wikipedia.org/wiki/{city}\"\u003c/span\u003e\n  city_soup = \u003cspan class=\"hljs-title class_\"\u003eBeautifulSoup\u003c/span\u003e(response.\u003cspan class=\"hljs-property\"\u003econtent\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'html.parser'\u003c/span\u003e)    # (ìœ„í‚¤ë°±ê³¼ ì‚¬ì´íŠ¸ì˜ ë‚´ìš©ì„ city_soup ë³€ìˆ˜ì— ì €ì¥í•˜ëŠ”) ë‚´ìš©ì„ êµ¬ë¬¸ ë¶„ì„í•©ë‹ˆë‹¤.\n\n  # ë„ì‹œê°€ ì†í•œ ì£¼ë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e city not \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e [\u003cspan class=\"hljs-string\"\u003e\"í•¨ë¶€ë¥´í¬\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"ë² ë¥¼ë¦°\"\u003c/span\u003e]:         # ë² ë¥¼ë¦°ì˜ ê²½ìš° ì¼ë°˜ì ì¸ .\u003cspan class=\"hljs-property\"\u003efind\u003c/span\u003e ê³µì‹ë„ ì‘ë™í•  ê±°ì˜ˆìš”! ì£¼ ì„¹ì…˜ì´ ì—†ëŠ” \u003cspan class=\"hljs-string\"\u003e\"í•¨ë¶€ë¥´í¬\"\u003c/span\u003eë§Œì´ ì˜ˆì™¸ì—ìš”\n    city_state = city_soup.\u003cspan class=\"hljs-title function_\"\u003efind\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"table\"\u003c/span\u003e, class_=\u003cspan class=\"hljs-string\"\u003e\"vcard\"\u003c/span\u003e).\u003cspan class=\"hljs-title function_\"\u003efind\u003c/span\u003e(string=\u003cspan class=\"hljs-string\"\u003e\"ì£¼\"\u003c/span\u003e).\u003cspan class=\"hljs-title function_\"\u003efind_next\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"td\"\u003c/span\u003e).\u003cspan class=\"hljs-title function_\"\u003eget_text\u003c/span\u003e()  # ë‹¤ë¥¸ ì£¼ ì´ë¦„ì„ ê°€ì§„ ë„ì‹œì— ëŒ€í•œ ì£¼ë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤\n  \u003cspan class=\"hljs-attr\"\u003eelse\u003c/span\u003e:\n    city_state = city     # í•¨ë¶€ë¥´í¬ì™€ ë² ë¥¼ë¦°ì˜ ê²½ìš°, ë™ëª…ì˜ ë„ì‹œ ì´ë¦„ì„ ê°€ì ¸ì˜¬ ê±°ì˜ˆìš”\n  states.\u003cspan class=\"hljs-title function_\"\u003eappend\u003c/span\u003e(city_state)\n\n  # ê° ë„ì‹œì˜ ìœ„ë„ë¥¼ ê²€ìƒ‰í•˜ì—¬ ìœ„ë„ ì—´ì— ì¶”ê°€í•©ë‹ˆë‹¤\n  city_latitude = city_soup.\u003cspan class=\"hljs-title function_\"\u003efind\u003c/span\u003e(class_=\u003cspan class=\"hljs-string\"\u003e\"latitude\"\u003c/span\u003e).\u003cspan class=\"hljs-title function_\"\u003eget_text\u003c/span\u003e()\n  latitudes.\u003cspan class=\"hljs-title function_\"\u003eappend\u003c/span\u003e(city_latitude)\n\n   # ê° ë„ì‹œì˜ ê²½ë„ë¥¼ ê²€ìƒ‰í•˜ì—¬ ê²½ë„ ì—´ì— ì¶”ê°€í•©ë‹ˆë‹¤\n  city_longitude = city_soup.\u003cspan class=\"hljs-title function_\"\u003efind\u003c/span\u003e(class_=\u003cspan class=\"hljs-string\"\u003e\"longitude\"\u003c/span\u003e).\u003cspan class=\"hljs-title function_\"\u003eget_text\u003c/span\u003e()\n  longitudes.\u003cspan class=\"hljs-title function_\"\u003eappend\u003c/span\u003e(city_longitude)\n\ncities_info_non_rel = pd.\u003cspan class=\"hljs-title class_\"\u003eDataFrame\u003c/span\u003e({         # ì´ê²ƒì´ cities_info ë°ì´í„°í”„ë ˆì„ì´ì—ìš”\n    \u003cspan class=\"hljs-string\"\u003e\"ë„ì‹œ ì´ë¦„\"\u003c/span\u003e: cities_list,\n    \u003cspan class=\"hljs-string\"\u003e\"ë…ì¼ ì£¼\"\u003c/span\u003e: states,\n    \u003cspan class=\"hljs-string\"\u003e\"ìœ„ë„\"\u003c/span\u003e: latitudes,\n    \u003cspan class=\"hljs-string\"\u003e\"ê²½ë„\"\u003c/span\u003e: longitudes\n})\n\n\u003cspan class=\"hljs-title function_\"\u003edisplay\u003c/span\u003e(cities_info_non_rel)    # í‘œì‹œí•˜ë©´ í…Œì´ë¸”ì´ ë” ì˜ˆì˜ê²Œ ë³´ì—¬ìš”\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eë˜í•œ, ì—°ê°„ í•œ ë²ˆì”© ì—…ë°ì´íŠ¸ë  ê²ƒìœ¼ë¡œ ì˜ˆìƒë˜ëŠ” ì¸êµ¬ ë°ì´í„°ë¥¼ í¬í•¨í•˜ëŠ” ë‘ ë²ˆì§¸ ë°ì´í„°í”„ë ˆì„ë„ ìƒì„±í–ˆì–´ìš”: cities_population\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-sql\"\u003e\u003cspan class=\"hljs-comment\"\u003e/***************************\ní™˜ê²½ ì„¤ì •\n***************************/\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e-- ë°ì´í„°ë² ì´ìŠ¤ê°€ ì´ë¯¸ ìˆëŠ” ê²½ìš° ì‚­ì œ\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eDROP\u003c/span\u003e DATABASE IF \u003cspan class=\"hljs-keyword\"\u003eEXISTS\u003c/span\u003e gans;\n\n\u003cspan class=\"hljs-comment\"\u003e-- ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eCREATE\u003c/span\u003e DATABASE gans;\n\n\u003cspan class=\"hljs-comment\"\u003e-- ë°ì´í„°ë² ì´ìŠ¤ ì‚¬ìš©\u003c/span\u003e\nUSE gans;\n\n\n\u003cspan class=\"hljs-comment\"\u003e/***************************\nì²« ë²ˆì§¸ í…Œì´ë¸” ìƒì„±\n***************************/\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e-- 'cities_info' í…Œì´ë¸” ìƒì„±\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eCREATE\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eTABLE\u003c/span\u003e cities_info (\n    cities_id \u003cspan class=\"hljs-type\"\u003eINT\u003c/span\u003e AUTO_INCREMENT, \u003cspan class=\"hljs-comment\"\u003e-- ë„ì‹œë§ˆë‹¤ ìë™ìœ¼ë¡œ ìƒì„±ëœ ID\u003c/span\u003e\n    city_name \u003cspan class=\"hljs-type\"\u003eVARCHAR\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e255\u003c/span\u003e) \u003cspan class=\"hljs-keyword\"\u003eNOT\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eNULL\u003c/span\u003e, \u003cspan class=\"hljs-comment\"\u003e-- ë„ì‹œ ì´ë¦„\u003c/span\u003e\n    german_state \u003cspan class=\"hljs-type\"\u003eVARCHAR\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e255\u003c/span\u003e) \u003cspan class=\"hljs-keyword\"\u003eNOT\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eNULL\u003c/span\u003e, \u003cspan class=\"hljs-comment\"\u003e-- ì£¼ ì´ë¦„\u003c/span\u003e\n    latitude \u003cspan class=\"hljs-type\"\u003eVARCHAR\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e255\u003c/span\u003e) \u003cspan class=\"hljs-keyword\"\u003eNOT\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eNULL\u003c/span\u003e, \u003cspan class=\"hljs-comment\"\u003e-- ìœ„ë„ ì¢Œí‘œ\u003c/span\u003e\n    longitude \u003cspan class=\"hljs-type\"\u003eVARCHAR\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e255\u003c/span\u003e) \u003cspan class=\"hljs-keyword\"\u003eNOT\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eNULL\u003c/span\u003e, \u003cspan class=\"hljs-comment\"\u003e-- ê²½ë„ ì¢Œí‘œ\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003ePRIMARY\u003c/span\u003e KEY (cities_id) \u003cspan class=\"hljs-comment\"\u003e-- ê° ë„ì‹œë¥¼ ê³ ìœ í•˜ê²Œ ì‹ë³„í•˜ê¸° ìœ„í•œ ê¸°ë³¸ í‚¤\u003c/span\u003e\n    );\n\n\n\u003cspan class=\"hljs-comment\"\u003e/***************************\në‘ ë²ˆì§¸ í…Œì´ë¸” ìƒì„±\n***************************/\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003eCREATE\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eTABLE\u003c/span\u003e cities_population (\n    cities_id \u003cspan class=\"hljs-type\"\u003eINT\u003c/span\u003e,\n    population \u003cspan class=\"hljs-type\"\u003eINT\u003c/span\u003e, \u003cspan class=\"hljs-comment\"\u003e-- ì¸êµ¬ìˆ˜\u003c/span\u003e\n    year_data_retrieved \u003cspan class=\"hljs-type\"\u003eINT\u003c/span\u003e, \u003cspan class=\"hljs-comment\"\u003e-- ì¸êµ¬ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•œ í•´ë‹¹ ë…„ë„\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eFOREIGN\u003c/span\u003e KEY (cities_id) \u003cspan class=\"hljs-keyword\"\u003eREFERENCES\u003c/span\u003e cities_info(cities_id)\n);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eì´ì œ Pythonì—ì„œ ë°ì´í„°ë¥¼ ì²« ë²ˆì§¸ SQL í…Œì´ë¸”ë¡œ ì „ì†¡í•©ë‹ˆë‹¤:\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eschema = \u003cspan class=\"hljs-string\"\u003e\"gans\"\u003c/span\u003e     # ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„\nhost = \u003cspan class=\"hljs-string\"\u003e\"xxx.x.x.x\"\u003c/span\u003e\nuser = \u003cspan class=\"hljs-string\"\u003e\"root\"\u003c/span\u003e               # ì‚¬ìš©ì ì´ë¦„\npassword = \u003cspan class=\"hljs-string\"\u003e\"xxxx\"\u003c/span\u003e           # \u003cspan class=\"hljs-variable constant_\"\u003eSQL\u003c/span\u003e ì•”í˜¸ ì§ì ‘ ì§€ì • ë˜ëŠ” ë‹¤ë¥¸ ë…¸íŠ¸ë¶ì—ì„œ ê°€ì ¸ì˜¤ê¸° (\u003cspan class=\"hljs-string\"\u003e\"from xxxfile import my_password\"\u003c/span\u003e)\nport = \u003cspan class=\"hljs-number\"\u003e3306\u003c/span\u003e\n\nconnection_string = f\u003cspan class=\"hljs-string\"\u003e'mysql+pymysql://{user}:{password}@{host}:{port}/{schema}'\u003c/span\u003e\n# ì´ê±´ íŒŒì´ì¬ ë…¸íŠ¸ë¶ì„ \u003cspan class=\"hljs-variable constant_\"\u003eSQL\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eWorkbench\u003c/span\u003eì— ì—°ê²°í•˜ëŠ” ë°©ë²•ì´ì—ìš”\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003ecities_info_non_rel.\u003cspan class=\"hljs-title function_\"\u003eto_sql\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'cities_info'\u003c/span\u003e,   # íŒŒì´ì¬ì—ì„œ \u003cspan class=\"hljs-variable constant_\"\u003eSQL\u003c/span\u003eë¡œ ë°ì´í„°ë¥¼ ë³´ë‚´ëŠ” ë°©ë²•\n                  if_exists=\u003cspan class=\"hljs-string\"\u003e'append'\u003c/span\u003e,       # ë®ì–´ì“°ì§€ ì•Šê³  ê¸°ì¡´ ë°ì´í„°ì— ì¶”ê°€í•˜ê¸° ìœ„í•¨\n                  con=connection_string,    # \u003cspan class=\"hljs-variable constant_\"\u003eSQL\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eWorkbench\u003c/span\u003eì— ì—°ê²°í•  ë•Œ í•„ìš”í•œ ì¸ì\n                  index=\u003cspan class=\"hljs-title class_\"\u003eFalse\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eì²« ë²ˆì§¸ ì‹œë„ëŠ” ë¡œì»¬ì—ì„œ ì´ë£¨ì–´ì¡ŒìŠµë‹ˆë‹¤. ë‚˜ì¤‘ì— Google Cloud Platform ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì¶”ê°€í•˜ë©´ \"host\" í•„ë“œë¥¼ í¸ì§‘í•˜ì—¬ ì´ ë°ì´í„°ë¥¼ í´ë¼ìš°ë“œì— ì§ì ‘ ì „ì†¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eSQLì— ì²« ë²ˆì§¸ í…Œì´ë¸”ì´ ìƒì„±ë˜ë©´ cities_infoì— í¬í•¨ëœ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•˜ì—¬ ë‘ ë²ˆì§¸ cities_population ë°ì´í„° í”„ë ˆì„ì—ì„œ í•´ë‹¹ cities_id ì—´ì„ ì¸ë±ìŠ¤ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003ecities_info = pd.\u003cspan class=\"hljs-title function_\"\u003eread_sql\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"cities_info\"\u003c/span\u003e, con=connection_string)   # ì´ ì½”ë“œëŠ” \u003cspan class=\"hljs-variable constant_\"\u003eSQL\u003c/span\u003eì— ì €ì¥ëœ ì •ë³´ë¥¼ \u003cspan class=\"hljs-string\"\u003e\"ì½ì–´ì˜µë‹ˆë‹¤\"\u003c/span\u003e\ncities_info\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eë‹¤ìŒì€ cities_infoì˜ ëª¨ìŠµì…ë‹ˆë‹¤:\u003c/p\u003e\n\u003cp\u003eë‘ ë²ˆì§¸ ë°ì´í„°í”„ë ˆì„ì˜ ë‚´ìš©ì„ SQLë¡œ ë„£ê¸° ì „ì—, ìƒˆë¡œ ìƒì„±ëœ cities_id ì—´ì„ ì‚¬ìš©í•˜ì—¬ cities_populations ë°ì´í„°í”„ë ˆì„ì— ì¶”ê°€í•´ì•¼ í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eì•„ë˜ëŠ” ì¹¼ëŸ¼ ìˆœì„œë¥¼ ì¬ì¡°ì •í•˜ê³ , ì´ì œ cities_populations ë°ì´í„°í”„ë ˆì„ì— cities_id ì¹¼ëŸ¼ì´ ìˆê¸° ë•Œë¬¸ì— ë” ì´ìƒ city_name ì¹¼ëŸ¼ì´ í•„ìš”í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì‚­ì œí–ˆìŠµë‹ˆë‹¤:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e# ë‹¤ë¥¸ ì¸êµ¬ ë°ì´í„°í”„ë ˆì„ì— cities_id ì¹¼ëŸ¼ì„ ì¶”ê°€í•©ë‹ˆë‹¤\ncities_population[\u003cspan class=\"hljs-string\"\u003e\"cities_id\"\u003c/span\u003e] = cities_info_non_rel[\u003cspan class=\"hljs-string\"\u003e\"cities_id\"\u003c/span\u003e]\ncities_population\n\n# city_name ì¹¼ëŸ¼ì€ ë” ì´ìƒ í•„ìš”í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ì‚­ì œí•˜ê³  ì¹¼ëŸ¼ ìˆœì„œë¥¼ ë°”ê¿” ë” ì§ê´€ì ìœ¼ë¡œ ë§Œë“­ë‹ˆë‹¤\ncities_population = cities_population[[\u003cspan class=\"hljs-string\"\u003e\"cities_id\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"population\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"year_data_retrieved\"\u003c/span\u003e]]\ncities_population\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eê·¸ë¦¬ê³  ì œ ë‘ ë²ˆì§¸ ë°ì´í„°í”„ë ˆì„ì´ ìˆìŠµë‹ˆë‹¤. ì´ ë°ì´í„°í”„ë ˆì„ì€ ì¼ë¶€ ë™ì ì…ë‹ˆë‹¤(ë°ì´í„°ê°€ ë•Œë•Œë¡œ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤. ì˜ˆ: ì—°ê°„ í•œ ë²ˆ):\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_2.png\" alt=\"ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ì€ ì—”ì§€ë‹ˆì–´ë¥¼ ìœ„í•œ ê²ƒ\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eë‹¹ë¶„ê°„ì€, ë‹¤ìŒ í•´ê¹Œì§€ ì—…ë°ì´íŠ¸ë˜ì§€ ì•Šì„ ë™ì ì´ ì•„ë‹Œ cities_population í…Œì´ë¸”ë¡œ ê°„ì£¼í•˜ê² ìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eì´ì œ ìš°ë¦¬ëŠ” ë¡œì»¬ SQL ì¸ìŠ¤í„´ìŠ¤ë¡œ ë‚´ìš©ì„ í‘¸ì‹œí•  ì¤€ë¹„ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e# ë‘ ë²ˆì§¸ í…Œì´ë¸” ë‚´ìš©ì„ \u003cspan class=\"hljs-variable constant_\"\u003eSQL\u003c/span\u003eë¡œ í‘¸ì‹œí•©ë‹ˆë‹¤\ncities_population.\u003cspan class=\"hljs-title function_\"\u003eto_sql\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'cities_population'\u003c/span\u003e,   # ì´ë ‡ê²Œ í•˜ë©´ \u003cspan class=\"hljs-title class_\"\u003ePython\u003c/span\u003eì—ì„œ \u003cspan class=\"hljs-variable constant_\"\u003eSQL\u003c/span\u003eë¡œ í‘¸ì‹œí•©ë‹ˆë‹¤\n                  if_exists=\u003cspan class=\"hljs-string\"\u003e'append'\u003c/span\u003e,       # ë®ì–´ì“°ê¸°ë¥¼ ì›í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ, ê¸°ì¡´ ë°ì´í„°ì—ë§Œ ë°ì´í„°ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤\n                  con=connection_string,    # conì€ sql workbenchì— ì—°ê²°í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ì¸ìì…ë‹ˆë‹¤\n                  index=\u003cspan class=\"hljs-title class_\"\u003eFalse\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eSQLì—ì„œ ëª¨ë“  ê²ƒì„ ì‹¤í–‰í•˜ê³  \"ì—­ê³µí•™\" ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë©´, ìš°ë¦¬ì˜ ìŠ¤í‚¤ë§ˆì˜ ê°€ì¥ ì´ˆê¸° ë²„ì „ì„ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eìš°ë¦¬ëŠ” í•™ìŠµ ê³¡ì„  ì†ìœ¼ë¡œ ë” ê¹Šì´ íŒŒê³ ë“¤ê³  ìˆì–´ìš”.\u003c/p\u003e\n\u003cp\u003eë‹¤ìŒ ë‹¨ê³„: APIë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— í†µí•©í•˜ê¸°. ì§€êµ¬ìƒì˜ ëª¨ë“  ë°ì´í„° ê³¼í•™ìì˜ ë³¸ì§ˆì´ë¼ê³  í•  ìˆ˜ ìˆì£ .\u003c/p\u003e\n\u003cp\u003eAIê°€ ë”°ë¼ì¡ê¸° ì „ì— ì–´ë–»ê²Œ í•´ì•¼ í• ì§€ ë°°ì›Œì•¼ê² ë„¤ìš”! (ë˜ëŠ” ì™¸ê³„ì¸ì´ ê·¸ë“¤ì˜ ë°ì´í„° ìš”êµ¬ë¥¼ ì–´ë–»ê²Œ ì²˜ë¦¬í•˜ëŠ”ì§€ë¥¼ ë³´ì¼ ë•Œê¹Œì§€) ğŸ‘½\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003ch2\u003eë‚ ì”¨ API ì‚¬ìš©í•˜ê¸°\u003c/h2\u003e\n\u003cp\u003eì´ í”„ë¡œì íŠ¸ì˜ ì„¸ ë²ˆì§¸ í° ë‹¨ê³„ëŠ” í˜„ì¬ ì¡´ì¬í•˜ëŠ” ë°ì´í„° ì €ì¥ì†Œì—ì„œ ë‚ ì”¨ ë°ì´í„°ë¥¼ ì¶”ì¶œí•˜ê³  SQL ë°ì´í„°ë² ì´ìŠ¤ì— í†µí•©í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ëŸ¬í•œ ì €ì¥ì†Œë“¤ì€ APIë¥¼ í†µí•´ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. APIëŠ” Application Programming Interfaceì˜ ì•½ìë¡œ, ì„œë¡œ ë‹¤ë¥¸ ì†Œí”„íŠ¸ì›¨ì–´ ì‘ìš© í”„ë¡œê·¸ë¨ ê°„ì— í†µì‹ í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê·œì¹™ê³¼ í”„ë¡œí† ì½œì˜ ì§‘í•©ì…ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eì´ë¥¼ ìœ„í•´ ìš°ë¦¬ëŠ” openweathermap.org ì›¹ì‚¬ì´íŠ¸ë¥¼ ì‚¬ìš©í•  ê²ƒì…ë‹ˆë‹¤. ì´ ì‚¬ì´íŠ¸ë¥¼ í†µí•´ ì „ ì„¸ê³„ ì–´ëŠ ìœ„ì¹˜ì˜ ë¬´ë£Œ ë‚ ì”¨ ì˜ˆë³´ì—ë„ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìš°ë¦¬ëŠ” 5ì¼ ë‚ ì”¨ ì˜ˆë³´ APIë¥¼ ì‚¬ìš©í•  ê²ƒì´ë©°, 3ì‹œê°„ ê°„ê²©ì˜ ì˜ˆë³´ ë°ì´í„°ë¥¼ í¬í•¨í•©ë‹ˆë‹¤: \u003ca href=\"https://openweathermap.org/forecast5\" rel=\"nofollow\" target=\"_blank\"\u003ehttps://openweathermap.org/forecast5\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eì´ì œ ìš°ë¦¬ í”„ë¡œì íŠ¸ì˜ í•µì‹¬ ì‘ì—…ì— ì§ë©´í–ˆìŠµë‹ˆë‹¤: ìš°ë¦¬ê°€ ì›í•˜ëŠ” ë‚ ì”¨ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•˜ê³  SQL ë°ì´í„°ë² ì´ìŠ¤ë¡œ ì „ì†¡í•˜ê¸° ìœ„í•œ í•„ìš”í•œ ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ìˆ˜ì‹­ ì‹œê°„ ë™ì•ˆ ê³ êµ°ë¶„íˆ¬í•œ ê²°ê³¼, ê°€ì¥ ê´€ë ¨ì„± ìˆëŠ” ë‚ ì”¨ ë°ì´í„°ë¥¼ ì¶”ì¶œí•˜ê¸° ìœ„í•œ ì´ ì½”ë“œë¥¼ ê°œë°œí•´ëƒˆìŠµë‹ˆë‹¤:\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003edef \u003cspan class=\"hljs-title function_\"\u003eget_weather_data\u003c/span\u003e(cities):\n  # í´ë¼ìš°ë“œì—ì„œ ì‘ì—…í•  ì˜ˆì •ì´ë¯€ë¡œ ì»´í“¨í„°ëŠ” ì–´ë””ì— ìˆì„ì§€ ëª¨ë¦…ë‹ˆë‹¤ - ì»´í“¨í„° ì‹œê°„ëŒ€ë¥¼ ìš°ë¦¬ ì§€ì—­ ì‹œê°„ëŒ€ë¡œ ìˆ˜ì •í•©ì‹œë‹¤.\n  berlin_timezone = \u003cspan class=\"hljs-title function_\"\u003etimezone\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Europe/Berlin\"\u003c/span\u003e)\n  API_key = \u003cspan class=\"hljs-string\"\u003e\"7e5623c79f102b6c08b15c8hjib4cc9l\"\u003c/span\u003e    # ì´ê²ƒì€ ì‹¤ì œ ê°’ì´ ì•„ë‹™ë‹ˆë‹¤.\n  weather_items = []\n\n  \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e city \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ecities\u003c/span\u003e:\n    url = (f\u003cspan class=\"hljs-string\"\u003e\"http://api.openweathermap.org/data/2.5/forecast?q={city}\u0026#x26;appid={API_key}\u0026#x26;units=metric\"\u003c/span\u003e)\n    response = requests.\u003cspan class=\"hljs-title function_\"\u003eget\u003c/span\u003e(url)\n    json = response.\u003cspan class=\"hljs-title function_\"\u003ejson\u003c/span\u003e()\n\n    # ì˜ˆë³´ë¥¼ ì‘ì„±í•œ ì‹œê°„ì„ ì•Œê¸° ìœ„í•´ ê²€ìƒ‰ ì‹œê°„ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.\n    retrieval_time = datetime.\u003cspan class=\"hljs-title function_\"\u003enow\u003c/span\u003e(berlin_timezone).\u003cspan class=\"hljs-title function_\"\u003estrftime\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"%Y-%m-%d %H:%M:%S\"\u003c/span\u003e)\n\n    # ì´ì œ ìš°ë¦¬ì˜ ê´€ë ¨ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ, ë„ì‹œëŠ” ë„ì‹œ ì´ë¦„ì´ ì•„ë‹Œ ë„ì‹œ \u003cspan class=\"hljs-variable constant_\"\u003eID\u003c/span\u003eë¥¼ ë°˜ì˜í•´ì•¼ í•©ë‹ˆë‹¤.\n    city_id = cities_info.\u003cspan class=\"hljs-property\"\u003eloc\u003c/span\u003e[cities_info[\u003cspan class=\"hljs-string\"\u003e\"city_name\"\u003c/span\u003e] == city, \u003cspan class=\"hljs-string\"\u003e\"city_id\"\u003c/span\u003e].\u003cspan class=\"hljs-property\"\u003evalues\u003c/span\u003e[\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e]  # ì—¬ê¸°ì—ì„œ ê°’ë“¤ì„ ê²€ìƒ‰í•´ì•¼ í•˜ë©°, ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ì‹œë¦¬ì¦ˆë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.\n\n    \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e item \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e json[\u003cspan class=\"hljs-string\"\u003e\"list\"\u003c/span\u003e]:\n        weather_item = {\n            # ì—¬ëŸ¬ ë„ì‹œë¥¼ ê³ ë ¤í•  ë•Œ ì •ë³´ë¥¼ ëª…í™•íˆ ì•Œ ìˆ˜ ìˆê²Œ ë„ì‹œ ì´ë¦„ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.\n            \u003cspan class=\"hljs-string\"\u003e\"city_id\"\u003c/span\u003e: city_id,\n            \u003cspan class=\"hljs-string\"\u003e\"forecast_time\"\u003c/span\u003e: item.\u003cspan class=\"hljs-title function_\"\u003eget\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"dt_txt\"\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eNone\u003c/span\u003e),\n            \u003cspan class=\"hljs-string\"\u003e\"temperature\"\u003c/span\u003e: item[\u003cspan class=\"hljs-string\"\u003e\"main\"\u003c/span\u003e].\u003cspan class=\"hljs-title function_\"\u003eget\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"temp\"\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eNone\u003c/span\u003e),\n            \u003cspan class=\"hljs-string\"\u003e\"feels_like\"\u003c/span\u003e: item[\u003cspan class=\"hljs-string\"\u003e\"main\"\u003c/span\u003e].\u003cspan class=\"hljs-title function_\"\u003eget\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"feels_like\"\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eNone\u003c/span\u003e),\n            \u003cspan class=\"hljs-string\"\u003e\"forecast\"\u003c/span\u003e: item[\u003cspan class=\"hljs-string\"\u003e\"weather\"\u003c/span\u003e][\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e].\u003cspan class=\"hljs-title function_\"\u003eget\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"main\"\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eNone\u003c/span\u003e),\n            \u003cspan class=\"hljs-string\"\u003e\"humidity\"\u003c/span\u003e: item[\u003cspan class=\"hljs-string\"\u003e\"main\"\u003c/span\u003e].\u003cspan class=\"hljs-title function_\"\u003eget\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"humidity\"\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eNone\u003c/span\u003e),\n            \u003cspan class=\"hljs-string\"\u003e\"rain_in_last_3h\"\u003c/span\u003e: item.\u003cspan class=\"hljs-title function_\"\u003eget\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"rain\"\u003c/span\u003e, {}).\u003cspan class=\"hljs-title function_\"\u003eget\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"3h\"\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e),\n            \u003cspan class=\"hljs-string\"\u003e\"risk_of_rain\"\u003c/span\u003e: item[\u003cspan class=\"hljs-string\"\u003e\"pop\"\u003c/span\u003e],\n            \u003cspan class=\"hljs-string\"\u003e\"snow_in_last_3h\"\u003c/span\u003e: item.\u003cspan class=\"hljs-title function_\"\u003eget\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"snow\"\u003c/span\u003e, {}).\u003cspan class=\"hljs-title function_\"\u003eget\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"3h\"\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e),\n            \u003cspan class=\"hljs-string\"\u003e\"wind_speed\"\u003c/span\u003e: item[\u003cspan class=\"hljs-string\"\u003e\"wind\"\u003c/span\u003e].\u003cspan class=\"hljs-title function_\"\u003eget\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"speed\"\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eNone\u003c/span\u003e),\n            \u003cspan class=\"hljs-string\"\u003e\"data_retrieved_at\"\u003c/span\u003e: retrieval_time\n        }\n\n        weather_items.\u003cspan class=\"hljs-title function_\"\u003eappend\u003c/span\u003e(weather_item)\n\n  weather_df = pd.\u003cspan class=\"hljs-title class_\"\u003eDataFrame\u003c/span\u003e(weather_items)\n  weather_df[\u003cspan class=\"hljs-string\"\u003e\"forecast_time\"\u003c/span\u003e] = pd.\u003cspan class=\"hljs-title function_\"\u003eto_datetime\u003c/span\u003e(weather_df[\u003cspan class=\"hljs-string\"\u003e\"forecast_time\"\u003c/span\u003e])\n  weather_df[\u003cspan class=\"hljs-string\"\u003e\"data_retrieved_at\"\u003c/span\u003e] = pd.\u003cspan class=\"hljs-title function_\"\u003eto_datetime\u003c/span\u003e(weather_df[\u003cspan class=\"hljs-string\"\u003e\"data_retrieved_at\"\u003c/span\u003e])\n  weather_df[\u003cspan class=\"hljs-string\"\u003e\"snow_in_last_3h\"\u003c/span\u003e] = pd.\u003cspan class=\"hljs-title function_\"\u003eto_numeric\u003c/span\u003e(weather_df[\u003cspan class=\"hljs-string\"\u003e\"snow_in_last_3h\"\u003c/span\u003e], downcast=\u003cspan class=\"hljs-string\"\u003e\"float.\"\u003c/span\u003e)\n\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e weather_df\n\nweather_df = \u003cspan class=\"hljs-title function_\"\u003eget_weather_data\u003c/span\u003e([\u003cspan class=\"hljs-string\"\u003e\"Berlin\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"Hamburg\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"Munich\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"Cologne\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"Frankfurt\"\u003c/span\u003e])\nweather_df     # í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒˆë¡œìš´ ë°ì´í„°í”„ë ˆì„ ìƒì„±\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eë‚ ì”¨ ë°ì´í„°í”„ë ˆì„ ë° í…Œì´ë¸”ì˜ ì¤‘ìš” ê¸°ëŠ¥ ì¤‘ í•˜ë‚˜ëŠ” ë°ì´í„° ê²€ìƒ‰ ì‹œê°„ì„ ê¸°ë¡í•˜ëŠ” ì—´ì„ í¬í•¨í•´ì•¼ í•œë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ í•„í„°ë§ ë° ì¼ì •í•œ ê¸°ê°„ í›„ ìë™ìœ¼ë¡œ ì´ì „ ë°ì´í„°ê°€ ì‚­ì œë˜ë„ë¡ SQLì—ì„œ í”„ë¡œì‹œì €ë‚˜ í•¨ìˆ˜ë¥¼ ì‘ì„±í•˜ê±°ë‚˜ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ë°ì´í„° ì¼ê´€ì„± ëª©ì ìœ¼ë¡œ ë‚ ì”¨ì™€ ë°ì´í„° ê²€ìƒ‰ ì‹œê°„ì´ í•­ìƒ ì˜ˆë³´ì— ëŒ€í•œ ë‚ ì§œ/ì‹œê°„ê³¼ ë‹¤ë¥¸ ê²ƒì„ì„ í•­ìƒ ì¸ì‹í•  ìˆ˜ ìˆë„ë¡ í•˜ê¸° ìœ„í•œ ê²ƒì…ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eì´ê²ƒì´ Pythonì—ì„œ ìƒˆë¡œìš´ ë‚ ì”¨ ë°ì´í„°í”„ë ˆì„ì´ ë³´ì´ëŠ” ë°©ì‹ì…ë‹ˆë‹¤:\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eì¼ë‹¨ ë‚ ì”¨ ë°ì´í„°í”„ë ˆì„ êµ¬ì¡°ë¥¼ ê°€ì§€ê³  ìˆì—ˆì„ ë•Œ, SQLì—ì„œ ë‚ ì”¨ í…Œì´ë¸”ì„ ìƒì„±í•˜ëŠ” ì‘ì—…ì„ ì‹œì‘í–ˆìŠµë‹ˆë‹¤:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e/***************************\në‚ ì”¨ í…Œì´ë¸”ì„ ìƒì„±í•©ë‹ˆë‹¤\n***************************/\u003c/span\u003e\n\n\u003cspan class=\"hljs-variable constant_\"\u003eCREATE\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eTABLE\u003c/span\u003e weather (\n    city_id \u003cspan class=\"hljs-variable constant_\"\u003eINT\u003c/span\u003e,\n    forecast_time datetime,\n    temperature float,\n    feels_like float,\n    forecast \u003cspan class=\"hljs-title function_\"\u003eVARCHAR\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e255\u003c/span\u003e) \u003cspan class=\"hljs-variable constant_\"\u003eNOT\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eNULL\u003c/span\u003e,\n    humidity \u003cspan class=\"hljs-variable constant_\"\u003eINT\u003c/span\u003e,\n    rain_in_last_3h \u003cspan class=\"hljs-variable constant_\"\u003eFLOAT\u003c/span\u003e,\n    risk_of_rain \u003cspan class=\"hljs-variable constant_\"\u003eFLOAT\u003c/span\u003e,\n    snow_in_last_3h \u003cspan class=\"hljs-variable constant_\"\u003eFLOAT\u003c/span\u003e,\n    wind_speed \u003cspan class=\"hljs-variable constant_\"\u003eFLOAT\u003c/span\u003e,\n    data_retrieved_at \u003cspan class=\"hljs-variable constant_\"\u003eDATETIME\u003c/span\u003e,\n    \u003cspan class=\"hljs-variable constant_\"\u003eFOREIGN\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eKEY\u003c/span\u003e (city_id) \u003cspan class=\"hljs-variable constant_\"\u003eREFERENCES\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003ecities_info\u003c/span\u003e(city_id)\n    );\n\n-- \u003cspan class=\"hljs-variable constant_\"\u003eTRUNCATE\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eTABLE\u003c/span\u003e weather;   -- í…Œì´ë¸”ì´ ë„ˆë¬´ ì»¤ì§€ê³  ë°ì´í„°ê°€ ì˜¤ë˜ë˜ì—ˆì„ ë•Œ ëª¨ë“  í–‰ì„ ì§€ì›Œì•¼ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eì´ê²ƒì€ ì—”ì§€ë‹ˆì–´ë§ì„ í†µí•´ ì—­ ê³µí•™ì„ ê±°ì³ ì—…ë°ì´íŠ¸ëœ SQL ìŠ¤í‚¤ë§ˆì…ë‹ˆë‹¤:\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003ch2\u003eì§€ì—­ì—ì„œ ì „ì—­ìœ¼ë¡œ\u003c/h2\u003e\n\u003cp\u003eìš°ë¦¬ì˜ ì½”ë“œë¥¼ í´ë¼ìš°ë“œì— ì˜¬ë¦¬ê¸° ì „ì—, ë‚ ì”¨ ë°ì´í„° ê²€ìƒ‰ ì½”ë“œê°€ ë¡œì»¬ì—ì„œ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤. Pythonìœ¼ë¡œ ì½”ë“œë¥¼ ì‘ì„±í•œ í›„, ë¡œì»¬ SQL ì¸ìŠ¤í„´ìŠ¤ë¡œ ì „ì†¡í•´ë³´ê² ìŠµë‹ˆë‹¤:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eweather_df.to_sql(\u003cspan class=\"hljs-string\"\u003e\"weather\"\u003c/span\u003e,\n                  if_exists=\u003cspan class=\"hljs-string\"\u003e'append'\u003c/span\u003e,\n                  con=connection_string,\n                  index=\u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eë§Œì•½ ìƒˆ ë°ì´í„°ê°€ ìš°ë¦¬ì˜ SQL í…Œì´ë¸”ì— ì¶”ê°€ëœë‹¤ë©´, ì‘ë™í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤!\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eíŒŒì´ì¬ì„ í†µí•´ ë¡œì»¬ ë°ì´í„°ë¥¼ ì…ë ¥í•œ í›„ SQL ë‚ ì”¨ í…Œì´ë¸”ì´ ì–´ë–»ê²Œ ë³´ì´ëŠ”ì§€ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_6.png\" alt=\"Weather Table\"\u003e\u003c/p\u003e\n\u003ch2\u003eGoogle Cloud Platform í†µí•©\u003c/h2\u003e\n\u003cp\u003eë¡œì»¬ì—ì„œ ì½”ë“œê°€ ì‘ë™í•˜ëŠ” ê²ƒì„ í™•ì¸í•˜ë©´, ì´ì œ í´ë¼ìš°ë“œì— ì˜¬ë ¤ë³´ëŠ” ì‹œê°„ì…ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eêµ¬ê¸€ í´ë¼ìš°ë“œ í”Œë«í¼(GCP) ê³„ì •ì„ ì—´ê³  í´ë¼ìš°ë“œ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” ìì„¸íˆ ë‹¤ë£¨ì§€ëŠ” ì•Šê² ì§€ë§Œ MySQLì„ ì‚¬ìš©í•œ ì¢‹ì€ ë‹¨ê³„ë³„ ì„¤ëª…ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤: \u003ca href=\"https://support.google.com/appsheet/answer/10107301?hl=en\" rel=\"nofollow\" target=\"_blank\"\u003ehttps://support.google.com/appsheet/answer/10107301?hl=en\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eì œê²Œ ê°€ì¥ ì¤‘ìš”í•œ ë‹¨ê³„ ì¤‘ í•˜ë‚˜ëŠ” íŒŒì´ì¬ ë…¸íŠ¸ë¶ì—ì„œ ë¡œì»¬ IP í˜¸ìŠ¤íŠ¸ë¥¼ êµ¬ê¸€ IP í˜¸ìŠ¤íŠ¸ë¡œ ë³€ê²½í•˜ëŠ” ê²ƒì´ì—ˆìŠµë‹ˆë‹¤. êµ¬ì²´ì ìœ¼ë¡œ, ë°ì´í„°ë¥¼ SQLë¡œ ì „ì†¡í•˜ëŠ” ì½”ë“œ ë¸”ë¡ì—ì„œ ë³€ê²½í–ˆìŠµë‹ˆë‹¤:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eschema = \u003cspan class=\"hljs-string\"\u003e\"gans\"\u003c/span\u003e         # ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„\nhost = \u003cspan class=\"hljs-string\"\u003e\"XX.XXX.XX.XX\"\u003c/span\u003e   # ë¡œì»¬ í˜¸ìŠ¤íŠ¸:\u003cspan class=\"hljs-string\"\u003e\"xxx.x.x.x\"\u003c/span\u003e (í´ë¼ìš°ë“œë¡œ ë³€ê²½í•˜ê¸° ì „)\nuser = \u003cspan class=\"hljs-string\"\u003e\"root\"\u003c/span\u003e           # ì‚¬ìš©ì ì´ë¦„ (ê°€ì´ë“œ ì°¸ì¡°)\npassword = \u003cspan class=\"hljs-string\"\u003e\"XXXX\"\u003c/span\u003e       # ë¹„ë°€ë²ˆí˜¸ ì§ì ‘ ì…ë ¥í•˜ê±°ë‚˜ ë‹¤ë¥¸ ë…¸íŠ¸ë¶ì—ì„œ ê°€ì ¸ì˜µë‹ˆë‹¤ (\u003cspan class=\"hljs-string\"\u003e\"from xxxfile import my_password\"\u003c/span\u003e)\nport = \u003cspan class=\"hljs-number\"\u003e3306\u003c/span\u003e\n\nconnection_string = f\u003cspan class=\"hljs-string\"\u003e'mysql+pymysql://{user}:{password}@{host}:{port}/{schema}'\u003c/span\u003e     # ì´ ë¶€ë¶„ì´ íŒŒì´ì¬ ë…¸íŠ¸ë¶ì„ \u003cspan class=\"hljs-variable constant_\"\u003eSQL\u003c/span\u003e ì›Œí¬ë²¤ì¹˜ì— ì—°ê²°í•˜ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eì´ë ‡ê²Œ í•¨ìœ¼ë¡œì¨, ì´ì „ì— ìƒì„±í•œ ì •ì  í…Œì´ë¸”ì„ í´ë¼ìš°ë“œì— ìë™ìœ¼ë¡œ ì—…ë¡œë“œí•˜ê³  íŒŒì´ì¬ì—ì„œ ì½”ë“œë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•˜ì§€ ì•Šê³  ì´ë¯¸ ì¡´ì¬í•˜ëŠ” SQL í…Œì´ë¸”ì— ë°ì´í„°ë¥¼ ì±„ìš¸ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. ì•„ë‹ˆë©´ ì ì–´ë„ íŒŒì´ì¬ì—ì„œ ì½”ë“œë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤. í˜¹ì€ ìƒˆë¡œìš´ ë¹„ë™ì  í…Œì´ë¸”(ë„ì‹œ ì •ë³´ ë° ë„ì‹œ ì¸êµ¬)ì„ ì—…ë°ì´íŠ¸í•˜ê¸°ë¡œ ê²°ì •í•  ë•Œê¹Œì§€ì…ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eì´ í”„ë¡œì íŠ¸ì˜ ëª©ì ìœ¼ë¡œ, Pythonì—ì„œ ì´ ë‘ í‘œë¥¼ GCPë¡œ ì—…ë¡œë“œí•˜ë ¤ë©´ í˜¸ìŠ¤íŠ¸ IPë¥¼ ë³€ê²½í•˜ëŠ” ê²ƒìœ¼ë¡œ ì¶©ë¶„í•©ë‹ˆë‹¤. ë˜ ë‹¤ë¥¸ ë°©ë²•ì€ ë‘ í‘œë¥¼ ë§Œë“œëŠ” ì½”ë“œë¥¼ í´ë¼ìš°ë“œì— ì—…ë¡œë“œí•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ ê²½ìš°, ìš°ë¦¬ëŠ” í´ë¼ìš°ë“œì— ë™ì  í‘œ ë‚ ì”¨ë¥¼ ë§Œë“¤ê³  ì±„ìš°ëŠ” ì½”ë“œë§Œ ì˜¬ë¦´ ê²ƒì…ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eGCPì˜ \"Cloud Functions\" í•„ë“œì— í•¨ìˆ˜ë¥¼ ë§Œë“  í›„ ì—¬ëŸ¬ ë²ˆì˜ ì‹œí–‰ì°©ì˜¤ ëì— ì½”ë“œê°€ ë§ˆì¹¨ë‚´ ì‘ë™í–ˆìŠµë‹ˆë‹¤:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_7.png\" alt=\"cloud_function_image\"\u003e\u003c/p\u003e\n\u003cp\u003eí•˜ì§€ë§Œ ì½”ë“œê°€ ì‘ë™í•˜ê¸° ì „ì— í´ë¼ìš°ë“œ ì¸ìŠ¤í„´ìŠ¤ì— í•¨ìˆ˜ë¥¼ ì—°ê²°í•´ì•¼í•©ë‹ˆë‹¤. ì•„ë˜ ë‹¨ê³„ë¥¼ ë”°ë¼ì•¼í•©ë‹ˆë‹¤:\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eì‘ì—…ì´ ì˜ë˜ì—ˆëŠ”ì§€ ì–´ë–»ê²Œ ì•Œ ìˆ˜ ìˆì„ê¹Œìš”? ê°€ì¥ ì¢‹ì€ ì†Œì‹ì€ ë‹¤ìŒê³¼ ê°™ì´ ë³´ì…ë‹ˆë‹¤:\u003c/p\u003e\n\u003cp\u003eë¡œì»¬ì—ì„œ í…ŒìŠ¤íŠ¸í•œ ì½”ë“œì™€ ë¹„êµí•´ ìƒë‹¹í•œ ìˆ˜ì •ì´ í•„ìš”í–ˆìŠµë‹ˆë‹¤. ìµœì¢… ì½”ë“œëŠ” ì´ë ‡ê²Œ ë³´ì…ë‹ˆë‹¤:\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e functions_framework\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e pandas \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e pd\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e sqlalchemy\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e requests\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e pytz \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e timezone\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e datetime \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e datetime\n\n\u003cspan class=\"hljs-meta\"\u003e@functions_framework.http\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003einsert\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003erequest\u003c/span\u003e):\n  connection_string = connection()\n  insert_into_weather(connection_string)\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'Data successfully added'\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003econnection\u003c/span\u003e():\n  connection_name = \u003cspan class=\"hljs-string\"\u003e\"flying-dove-416317:europe-west1:wbs-mysql-db\"\u003c/span\u003e    \u003cspan class=\"hljs-comment\"\u003e# this is not a real one\u003c/span\u003e\n  db_user = \u003cspan class=\"hljs-string\"\u003e\"root\"\u003c/span\u003e\n  db_password = \u003cspan class=\"hljs-string\"\u003e\"xxxx\"\u003c/span\u003e   \u003cspan class=\"hljs-comment\"\u003e# fill in with your SQL password\u003c/span\u003e\n  schema_name = \u003cspan class=\"hljs-string\"\u003e\"gans\"\u003c/span\u003e\n\n  driver_name = \u003cspan class=\"hljs-string\"\u003e'mysql+pymysql'\u003c/span\u003e\n  query_string = {\u003cspan class=\"hljs-string\"\u003e\"unix_socket\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003ef\"/cloudsql/\u003cspan class=\"hljs-subst\"\u003e{connection_name}\u003c/span\u003e\"\u003c/span\u003e}\n\n  db = sqlalchemy.create_engine(\n      sqlalchemy.engine.url.URL(\n          drivername = driver_name,\n          username = db_user,\n          password = db_password,\n          database = schema_name,\n          query = query_string,\n      )\n  )\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e db\n\n\n\u003cspan class=\"hljs-comment\"\u003e# HERE STARTS THE WEATHER DATA RETRIEVAL FUNCTION:\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eextract_city\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003econnection_string\u003c/span\u003e):\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e pd.read_sql(\u003cspan class=\"hljs-string\"\u003e\"cities_info\"\u003c/span\u003e, con=connection_string)\n\n\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eget_weather_data\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003ecities_df\u003c/span\u003e):\n  berlin_timezone = timezone(\u003cspan class=\"hljs-string\"\u003e\"Europe/Berlin\"\u003c/span\u003e)\n  API_key = \u003cspan class=\"hljs-string\"\u003e\"7e5623c79f102b6c08b15c8hjib4cc9l\"\u003c/span\u003e    \u003cspan class=\"hljs-comment\"\u003e# this is not a real one\u003c/span\u003e\n  weather_items = []\n\n  \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e city \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e cities_df[\u003cspan class=\"hljs-string\"\u003e\"city_name\"\u003c/span\u003e]:\n    url = (\u003cspan class=\"hljs-string\"\u003ef\"http://api.openweathermap.org/data/2.5/forecast?q=\u003cspan class=\"hljs-subst\"\u003e{city}\u003c/span\u003e\u0026#x26;appid=\u003cspan class=\"hljs-subst\"\u003e{API_key}\u003c/span\u003e\u0026#x26;units=metric\"\u003c/span\u003e)\n    response = requests.get(url)\n    json = response.json()\n\n    \u003cspan class=\"hljs-comment\"\u003e# Added the time retrieved so we know when the forecast was made\u003c/span\u003e\n    retrieval_time = datetime.now(berlin_timezone).strftime(\u003cspan class=\"hljs-string\"\u003e\"%Y-%m-%d %H:%M:%S\"\u003c/span\u003e)\n\n    \u003cspan class=\"hljs-comment\"\u003e# As we are now using the data from our relational database, the city should reflect the city_id and not the city name\u003c/span\u003e\n    city_id = cities_df.loc[cities_df[\u003cspan class=\"hljs-string\"\u003e\"city_name\"\u003c/span\u003e] == city, \u003cspan class=\"hljs-string\"\u003e\"city_id\"\u003c/span\u003e].values[\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e]  \u003cspan class=\"hljs-comment\"\u003e# here we need to retrieve the values, otherwise it shows us the series\u003c/span\u003e\n\n    \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e item \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e json[\u003cspan class=\"hljs-string\"\u003e\"list\"\u003c/span\u003e]:\n        weather_item = {\n            \u003cspan class=\"hljs-comment\"\u003e# Added the city name, so the information is clear when looking at multiple cities\u003c/span\u003e\n            \u003cspan class=\"hljs-string\"\u003e\"city_id\"\u003c/span\u003e: city_id,\n            \u003cspan class=\"hljs-string\"\u003e\"forecast_time\"\u003c/span\u003e: item.get(\u003cspan class=\"hljs-string\"\u003e\"dt_txt\"\u003c/span\u003e, \u003cspan class=\"hljs-literal\"\u003eNone\u003c/span\u003e),\n            \u003cspan class=\"hljs-string\"\u003e\"temperature\"\u003c/span\u003e: item[\u003cspan class=\"hljs-string\"\u003e\"main\"\u003c/span\u003e].get(\u003cspan class=\"hljs-string\"\u003e\"temp\"\u003c/span\u003e, \u003cspan class=\"hljs-literal\"\u003eNone\u003c/span\u003e),\n            \u003cspan class=\"hljs-string\"\u003e\"feels_like\"\u003c/span\u003e: item[\u003cspan class=\"hljs-string\"\u003e\"main\"\u003c/span\u003e].get(\u003cspan class=\"hljs-string\"\u003e\"feels_like\"\u003c/span\u003e, \u003cspan class=\"hljs-literal\"\u003eNone\u003c/span\u003e),\n            \u003cspan class=\"hljs-string\"\u003e\"forecast\"\u003c/span\u003e: item[\u003cspan class=\"hljs-string\"\u003e\"weather\"\u003c/span\u003e][\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e].get(\u003cspan class=\"hljs-string\"\u003e\"main\"\u003c/span\u003e, \u003cspan class=\"hljs-literal\"\u003eNone\u003c/span\u003e),\n            \u003cspan class=\"hljs-string\"\u003e\"humidity\"\u003c/span\u003e: item[\u003cspan class=\"hljs-string\"\u003e\"main\"\u003c/span\u003e].get(\u003cspan class=\"hljs-string\"\u003e\"humidity\"\u003c/span\u003e, \u003cspan class=\"hljs-literal\"\u003eNone\u003c/span\u003e),\n            \u003cspan class=\"hljs-string\"\u003e\"rain_in_last_3h\"\u003c/span\u003e: item.get(\u003cspan class=\"hljs-string\"\u003e\"rain\"\u003c/span\u003e, {}).get(\u003cspan class=\"hljs-string\"\u003e\"3h\"\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e),\n            \u003cspan class=\"hljs-string\"\u003e\"risk_of_rain\"\u003c/span\u003e: item[\u003cspan class=\"hljs-string\"\u003e\"pop\"\u003c/span\u003e],\n            \u003cspan class=\"hljs-string\"\u003e\"snow_in_last_3h\"\u003c/span\u003e: item.get(\u003cspan class=\"hljs-string\"\u003e\"snow\"\u003c/span\u003e, {}).get(\u003cspan class=\"hljs-string\"\u003e\"3h\"\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e),\n            \u003cspan class=\"hljs-string\"\u003e\"wind_speed\"\u003c/span\u003e: item[\u003cspan class=\"hljs-string\"\u003e\"wind\"\u003c/span\u003e].get(\u003cspan class=\"hljs-string\"\u003e\"speed\"\u003c/span\u003e, \u003cspan class=\"hljs-literal\"\u003eNone\u003c/span\u003e),\n            \u003cspan class=\"hljs-string\"\u003e\"data_retrieved_at\"\u003c/span\u003e: retrieval_time\n        }\n\n        weather_items.append(weather_item)\n\n  weather_df = pd.DataFrame(weather_items)\n  weather_df[\u003cspan class=\"hljs-string\"\u003e\"forecast_time\"\u003c/span\u003e] = pd.to_datetime(weather_df[\u003cspan class=\"hljs-string\"\u003e\"forecast_time\"\u003c/span\u003e])\n  weather_df[\u003cspan class=\"hljs-string\"\u003e\"data_retrieved_at\"\u003c/span\u003e] = pd.to_datetime(weather_df[\u003cspan class=\"hljs-string\"\u003e\"data_retrieved_at\"\u003c/span\u003e])\n  weather_df[\u003cspan class=\"hljs-string\"\u003e\"snow_in_last_3h\"\u003c/span\u003e] = pd.to_numeric(weather_df[\u003cspan class=\"hljs-string\"\u003e\"snow_in_last_3h\"\u003c/span\u003e], downcast=\u003cspan class=\"hljs-string\"\u003e\"float\"\u003c/span\u003e)\n\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e weather_df\n\n\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003einsert_into_weather\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003econnection_string\u003c/span\u003e):\n  cities_df = extract_city(connection_string)\n  weather_df = get_weather_data(cities_df)    \u003cspan class=\"hljs-comment\"\u003e# we create the new dataframe using the function\u003c/span\u003e\n  weather_df.to_sql(\u003cspan class=\"hljs-string\"\u003e\"weather\"\u003c/span\u003e,\n            if_exists=\u003cspan class=\"hljs-string\"\u003e\"append\"\u003c/span\u003e,\n            con=connection_string,\n            index=\u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eLessons learned from making our code cloud-worthy\u003c/h2\u003e\n\u003ch3\u003e1. Dependencies:\u003c/h3\u003e\n\u003cp\u003eWe need to add the right dependencies to the \u003ccode\u003erequirements.txt\u003c/code\u003e file. This was one of the main initial reasons preventing our code from working properly. It is important to note that some libraries are already uploaded on GCP by default and should not be included in the \u003ccode\u003e.txt\u003c/code\u003e file, but still need to be added as a library in our source code, e.g.:\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e pytz \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e timezone\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e datetime \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e datetime\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eë§Œì•½ ë°°í¬ë¥¼ ì‹œë„í•œ í›„ì— ë¹¨ê°„ ë°°ë„ˆ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤ë©´, ëŒ€ë¶€ë¶„ì˜ ê²½ìš° requirements.txt íŒŒì¼ì— ëª…ì‹œë˜ì–´ ìˆì§€ ì•Šì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ importí•˜ëŠ” ê²ƒì´ ì›ì¸ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_10.png\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cp\u003erequirements ì„¹ì…˜ì—ì„œëŠ” Python ëª¨ë“ˆì´ ì•„ë‹Œ íŒ¨í‚¤ì§€ë§Œ ì¶”ê°€í•´ì•¼ í•©ë‹ˆë‹¤. ë¯¸ë¦¬ ì•Œë ¤ë“œë¦¬ìë©´, ì—¬ê¸° Python ëª¨ë“ˆë“¤ì˜ ì¢…í•© ëª©ë¡ì´ ìˆìŠµë‹ˆë‹¤: \u003ca href=\"https://docs.python.org/3/py-modindex.html\" rel=\"nofollow\" target=\"_blank\"\u003ePython ëª¨ë“ˆ ëª©ë¡\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eë‹¤ë¥¸ ìœ ìš©í•œ íŒì€ ì½”ë“œì—ì„œ ì‚¬ìš© ì¤‘ì¸ ëª¨ë“  ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì¶œë ¥í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ë…¸íŠ¸ë¶ì—ì„œ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œ í›„ì—ëŠ” ë‹¤ìŒì„ ì‹¤í–‰í•´ì•¼ í•©ë‹ˆë‹¤:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'\\n'\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003ejoin\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e'{m.__name__}=={m.__version__}'\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e m \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eglobals\u003c/span\u003e().\u003cspan class=\"hljs-title function_\"\u003evalues\u003c/span\u003e() \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003egetattr\u003c/span\u003e(m, \u003cspan class=\"hljs-string\"\u003e'__version__'\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eNone\u003c/span\u003e)))\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eê·¸ëŸ° ë‹¤ìŒ ì ì ˆí•œ ì¢…ì†ì„±ìœ¼ë¡œ requirements.txtì— ì§ì ‘ ë³µì‚¬í•˜ì—¬ ë¶™ì—¬ë„£ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_11.png\" alt=\"ì´ë¯¸ì§€\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eì´ í”„ë¡œì íŠ¸ë¥¼ ìœ„í•´ í•„ìš”í•œ ì˜ì¡´ì„±ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤ .txt íŒŒì¼:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003efunctions-framework==\u003cspan class=\"hljs-number\"\u003e3.\u003c/span\u003e*\n\u003cspan class=\"hljs-title class_\"\u003eSQLAlchemy\u003c/span\u003e==\u003cspan class=\"hljs-number\"\u003e1.4\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.37\u003c/span\u003e\n\u003cspan class=\"hljs-title class_\"\u003ePyMySQL\u003c/span\u003e==\u003cspan class=\"hljs-number\"\u003e1.0\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.2\u003c/span\u003e\npandas==\u003cspan class=\"hljs-number\"\u003e1.5\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.2\u003c/span\u003e\nrequests==\u003cspan class=\"hljs-number\"\u003e2.31\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e2. ì—°ê²° ì½”ë“œ í…ŒìŠ¤íŠ¸\u003c/h2\u003e\n\u003cp\u003eë°ì´í„° ê²€ìƒ‰ í•¨ìˆ˜ë¥¼ ì¶”ê°€í•˜ê¸° ì „ì— ì—°ê²° ì½”ë“œê°€ ì‘ë™í•˜ëŠ”ì§€ ë¨¼ì € í…ŒìŠ¤íŠ¸í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ë¬¸ì œê°€ ì—°ê²° ì„¤ì •ì— ìˆëŠ”ì§€ ì•„ë‹Œì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eë¡œì»¬ ìŠ¤í¬ë¦½íŠ¸ë¥¼ GCPë¡œ ì´ë™í•  ë•Œ ì¢‹ì€ ì‹œì‘ ë°©ë²•ì€ \"ë”ë¯¸\" í•¨ìˆ˜ë¥¼ ë§Œë“¤ê³  í…ŒìŠ¤íŠ¸í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e functions_framework\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e pandas \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e pd\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e sqlalchemy\n\n@functions_framework.\u003cspan class=\"hljs-property\"\u003ehttp\u003c/span\u003e\ndef \u003cspan class=\"hljs-title function_\"\u003einsert\u003c/span\u003e(request):\n  connection_string = \u003cspan class=\"hljs-title function_\"\u003econnection\u003c/span\u003e()\n  \u003cspan class=\"hljs-title function_\"\u003einsert_into_test_table\u003c/span\u003e(connection_string)\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'Data successfully added'\u003c/span\u003e\n\ndef \u003cspan class=\"hljs-title function_\"\u003econnection\u003c/span\u003e():\n  connection_name = \u003cspan class=\"hljs-string\"\u003e\"YOUR_DB_CON_NAME\"\u003c/span\u003e  # ë³€ê²½í•´ì£¼ì„¸ìš”\n  db_user = \u003cspan class=\"hljs-string\"\u003e\"root\"\u003c/span\u003e                      # ë³€ê²½\n  db_password = \u003cspan class=\"hljs-string\"\u003e\"YOUR_PASSWORD\"\u003c/span\u003e         # ë³€ê²½\n  schema_name = \u003cspan class=\"hljs-string\"\u003e\"test_schema\"\u003c/span\u003e           # ë³€ê²½\n\n  driver_name = \u003cspan class=\"hljs-string\"\u003e'mysql+pymysql'\u003c/span\u003e\n  query_string = {\u003cspan class=\"hljs-string\"\u003e\"unix_socket\"\u003c/span\u003e: f\u003cspan class=\"hljs-string\"\u003e\"/cloudsql/{connection_name}\"\u003c/span\u003e}\n\n  db = sqlalchemy.\u003cspan class=\"hljs-title function_\"\u003ecreate_engine\u003c/span\u003e(\n      sqlalchemy.\u003cspan class=\"hljs-property\"\u003eengine\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eurl\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eURL\u003c/span\u003e(\n          drivername = driver_name,\n          username = db_user,\n          password = db_password,\n          database = schema_name,\n          query = query_string,\n      )\n  )\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e db\n\ndef \u003cspan class=\"hljs-title function_\"\u003einsert_into_test_table\u003c/span\u003e(con_str):\n  data = {\u003cspan class=\"hljs-string\"\u003e'FirstName'\u003c/span\u003e: [\u003cspan class=\"hljs-string\"\u003e'Function'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'Test'\u003c/span\u003e],\n          \u003cspan class=\"hljs-string\"\u003e'City'\u003c/span\u003e: [\u003cspan class=\"hljs-string\"\u003e'Cloud'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'Complete'\u003c/span\u003e]}\n  df = pd.\u003cspan class=\"hljs-title class_\"\u003eDataFrame\u003c/span\u003e(data)\n  df.\u003cspan class=\"hljs-title function_\"\u003eto_sql\u003c/span\u003e(name=\u003cspan class=\"hljs-string\"\u003e\"test_table\"\u003c/span\u003e, con=con_str, if_exists=\u003cspan class=\"hljs-string\"\u003e'append'\u003c/span\u003e, index=\u003cspan class=\"hljs-title class_\"\u003eFalse\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eì´ ê°„ë‹¨í•œ í•¨ìˆ˜ê°€ ì‘ë™í•˜ë©´ ì—°ê²°ì´ ì‘ë™í•˜ëŠ” ê²ƒì´ê³ , í•  ì¼ì€ ì‹¤ì œ ì½”ë“œë¥¼ ì¶”ê°€í•˜ê³  í†µí•©í•˜ëŠ” ê²ƒë¿ì…ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eë‹¤ìŒ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´ ìš°ë¦¬ì˜ ì½”ë“œì— ë¬¸ì œê°€ ìˆìŒì„ ê°€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003ch2\u003e3. ìš°ë¦¬ ì‹¤ì œ ì½”ë“œì˜ ë¬¸ì œì \u003c/h2\u003e\n\u003cp\u003eë‚´ ì½”ë“œë¥¼ ì˜¨ë¼ì¸ì— ì˜¬ë¦´ ë•Œ ì‹¤ìˆ˜í•œ ì£¼ìš”í•œ ë¶€ë¶„ì€ \"ë”ë¯¸\" í…œí”Œë¦¿ì„ ê¸°ë°˜ìœ¼ë¡œ ì½”ë“œë¥¼ ì¡°ì •í•˜ê³  ì‹¤ì œë¡œ ì •ì˜ë˜ì§€ ì•Šì€ \"insert_into_weather\" í•¨ìˆ˜ë¥¼ \"@functions_framework.http\" ì•„ë˜ì—ì„œ í˜¸ì¶œí–ˆë‹¤ëŠ” ê²ƒì´ì—ˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eì´ í•¨ìˆ˜ë¥¼ ì¶”ê°€í•œ í›„ì—ë„ ì½”ë“œê°€ ì‘ë™í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì´ëŠ” í•„ìš”í•œ ë„ì‹œë¥¼ ìˆ˜ë™ìœ¼ë¡œ ëª…ëª…í–ˆê¸° ë•Œë¬¸ì— ë„ì‹œ ì •ë³´ ë°ì´í„°í”„ë ˆì„ì—ì„œ ì´ë¯¸ ê°€ì ¸ì˜¤ëŠ” ëŒ€ì‹ ì— ë„ì‹œ ì´ë¦„ì„ ìˆ˜ë™ìœ¼ë¡œ ì§€ì •í•´ì„œ ì˜¤ëŠ” ì ê³¼ ê´€ë ¨ì´ ìˆì—ˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ë‚˜ëŠ” ë¨¼ì € \"extract_city\"ë¼ëŠ” ë˜ ë‹¤ë¥¸ í•¨ìˆ˜ë¥¼ ì¶”ê°€í•´ì•¼ í–ˆê³ , ì´ í•¨ìˆ˜ê°€ ë¡œì»¬ì—ì„œ ì‘ë™í•˜ëŠ” ê²ƒì„ í™•ì¸ í›„ì— ì½”ë“œë¥¼ ì˜¨ë¼ì¸ì— ë°°í¬í•´ì•¼ í–ˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eë„ì‹œ ì´ë¦„ì„ ì–»ê¸° ìœ„í•´ cities_info í…Œì´ë¸”ì„ ì‚¬ìš©í•œ í›„ì—, ë„ì‹œ ì´ë¦„ì„ ì¶”ì¶œí•˜ì§€ ì•Šì€ ì „ ë°˜ë³µë¬¸ì„ ì—…ë°ì´íŠ¸í•˜ì§€ ì•Šì€ ë‹¤ë¥¸ ì‹¤ìˆ˜ë¥¼ í–ˆìŠµë‹ˆë‹¤. ì´ì œ ë„ì‹œ ì´ë¦„ì„ ì´ì „ì— ëª©ë¡ì—ì„œ ê°€ì ¸ì˜¤ì§€ ì•Šê³  ë°ì´í„°í”„ë ˆì„ì—ì„œ ê°€ì ¸ì™€ì•¼ í–ˆê³ , ì´ì „ ì¸ìˆ˜ë¡œëŠ” ë„ì‹œ ì´ë¦„ì„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003ch1\u003eë§ˆì§€ë§‰ ë‹¨ê³„\u003c/h1\u003e\n\u003cp\u003eìš°ë¦¬ í”„ë¡œì íŠ¸ë¥¼ ì™„ì „íˆ ê¸°ëŠ¥ì ì´ê³  ìë™í™”í•˜ê¸° ìœ„í•´ ì£¼ê¸°ì ìœ¼ë¡œ ì‹¤í–‰í•  í•¨ìˆ˜ë¥¼ ì˜ˆì•½í•´ì•¼ í•©ë‹ˆë‹¤. GCPì˜ \"Cloud Scheduler\" ë©”ë‰´ë¥¼ ì‚¬ìš©í•˜ë©´ ìƒë‹¹íˆ ì‰½ìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eì´ë¥¼ ìœ„í•´ \"ì‘ì—… ì˜ˆì•½\"ì„ í•˜ê³  ëª‡ ê°€ì§€ ë§¤ê°œë³€ìˆ˜ë¥¼ ì œê³µí•˜ê³  ë¹ˆë„ë¥¼ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤(ë§¤ì£¼ í•œ ë²ˆ ë˜ëŠ” Cron í‘œí˜„ì‹ì„ ì‚¬ìš©í•˜ì—¬ íŠ¹ì • ì‹œê°„ì— íŠ¹ì • ìš”ì¼ì— ì‹¤í–‰í•˜ë„ë¡ ì„¤ì •). ì´ë ‡ê²Œ í•˜ë©´ í•´ë‹¹ ì‹œê°„ì— í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ì–´ SQL í…Œì´ë¸”ì— í•„ìš”í•œ ë°ì´í„°ë¥¼ ì±„ì›ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì—¬ê¸°ì„œëŠ” ë§¤ì£¼ ì›”ìš”ì¼ ì˜¤í›„ 3ì‹œì— ì‹¤í–‰ë˜ë„ë¡ ì„¤ì •í–ˆìŠµë‹ˆë‹¤:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_12.png\" alt=\"ì´ë¯¸ì§€\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eSQLì—ì„œ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-05-18-DataEngineeringisforEngineersNOT_13.png\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cp\u003eì²« ë²ˆì§¸ SQL-to-Python-to-GCP í”„ë¡œì íŠ¸ì™€ ì‘ë³„í•˜ê¸° ì „ì—, ë¬´ë£Œ í¬ë ˆë”§ì„ ì†Œë¹„í•˜ì§€ ì•Šë„ë¡ GCP ê³„ì •ì—ì„œ ë°ì´í„°ë¥¼ ì‚­ì œí•´ì•¼ í•´ìš”. ì´ëŠ” í´ë¼ìš°ë“œ ì¸ìŠ¤í„´ìŠ¤, í•¨ìˆ˜ ë° ì˜ˆì•½ëœ ì‘ì—…ì„ í¬í•¨í•´ìš”.\u003c/p\u003e\n\u003ch1\u003eë\u003c/h1\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eì´ ê¸€ì„ ì“°ë©´ì„œ SQL, Python ë° í´ë¼ìš°ë“œ ì»´í“¨íŒ…ì„ ê²°í•©í•œ ë§¤ìš° ê¸°ë³¸ì ì¸ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ êµ¬ì¶•í•˜ëŠ” ë°©ë²•ì„ ë°°ì› ì–´ìš”.\u003c/p\u003e\n\u003cp\u003eì´ í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í•  ë•Œ êµ¬ê¸€ í´ë¼ìš°ë“œ í”Œë«í¼ ë˜ëŠ” ë‹¤ë¥¸ í´ë¼ìš°ë“œ ì»´í“¨íŒ… í”Œë«í¼ì— ëŒ€í•´ ì „í˜€ ì•Œì§€ ëª°ëì–´ìš”. ì„œë²„, í˜¸ìŠ¤íŠ¸, ì¸ìŠ¤í„´ìŠ¤ ë˜ëŠ” ì†Œí”„íŠ¸ì›¨ì–´ ì—°ê²°ì— ëŒ€í•´ ì•„ë¬´ê²ƒë„ ëª¨ë¥´ê³  ìˆì—ˆì–´ìš” (ì§€ê¸ˆë„ìš”). SQLê³¼ Pythonì˜ ê¸°ë³¸ì ì¸ ì§€ì‹ë§Œ ìˆì—ˆì–´ìš”.\u003c/p\u003e\n\u003cp\u003eì´ë ‡ê²Œ ì´ˆë³´ìë¡œ ì‹œì‘í–ˆì„ ë•Œ, ìë™í™”ëœ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ìƒì„±í•˜ê³  ì£¼ê¸°ì ìœ¼ë¡œ ê°€ì¹˜ ìˆëŠ” ë°ì´í„°ë¡œ ì±„ìš°ëŠ” ì¼ì´ ë„ˆë¬´ ì–´ë ¤ìš¸ ê²ƒì´ë¼ê³  íšŒì˜ì ì´ì—ˆì–´ìš”. ì´ì œ ë‚´ê°€ í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ì•Œê²Œ ë˜ì—ˆì–´ìš”!\u003c/p\u003e\n\u003cp\u003eì•ìœ¼ë¡œì˜ ê³„íšì€ ë‹¤ë¥¸ APIì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ GCP ê¸°ëŠ¥ì— ê²°í•©í•˜ì—¬ ë” ì™„ì „í•˜ê³  ìœ ìš©í•œ ìµœì¢… ì œí’ˆì„ ë§Œë“¤ê³  ì‹¶ì–´í•´ìš”.\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eê¸€ì„ ì“°ëŠ” ì‚¬ëŒì´ë¼ê³  í•˜ë”ë¼ë„ ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ì„ ì†Œí”„íŠ¸ì›¨ì–´ ì—”ì§€ë‹ˆì–´ë§Œí¼ ì˜ í•  ìˆ˜ëŠ” ì—†ì„ ì§€ë„ ëª¨ë¥´ê² ì–´ìš”. í•˜ì§€ë§Œ ìš°ë¦¬ëŠ” ê¸°ì´ˆë¥¼ ë°°ìš°ê³  ê±°ê¸°ì„œë¶€í„° ì„±ì¥í•  ìˆ˜ ìˆì£ .\u003c/p\u003e\n\u003ch1\u003eStackademic ğŸ“\u003c/h1\u003e\n\u003cp\u003eëê¹Œì§€ ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤. ë– ë‚˜ì‹œê¸° ì „ì—:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eì €ìë¥¼ í´ë©í•˜ì‹œê³  íŒ”ë¡œìš°í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ‘\u003c/li\u003e\n\u003cli\u003eìš°ë¦¬ë¥¼ íŒ”ë¡œìš°í•´ì£¼ì„¸ìš” X | LinkedIn | YouTube | Discord\u003c/li\u003e\n\u003cli\u003eë‹¤ë¥¸ í”Œë«í¼ì—ì„œë„ ë§Œë‚˜ë³´ì„¸ìš”: In Plain English | CoFeed | Venture | Cubed\u003c/li\u003e\n\u003cli\u003eë” ë§ì€ ì½˜í…ì¸ ëŠ” Stackademic.comì—ì„œ í™•ì¸í•˜ì„¸ìš”\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-05-18-DataEngineeringisforEngineersNOT"},"buildId":"bb_yO9GbCvdfc_n71SfUf","isFallback":false,"gsp":true,"scriptLoader":[{"async":true,"src":"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4877378276818686","strategy":"lazyOnload","crossOrigin":"anonymous"}]}</script></body></html>