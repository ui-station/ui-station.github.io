<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>ui-station</title><meta name="description" content="I develop websites, games and apps with HTML, CSS and JS."/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://ui-station.github.io///posts/19" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="ui-station" data-gatsby-head="true"/><meta property="og:title" content="ui-station" data-gatsby-head="true"/><meta property="og:description" content="I develop websites, games and apps with HTML, CSS and JS." data-gatsby-head="true"/><meta property="og:image" content="/favicons/ms-icon-310x310.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://ui-station.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://ui-station.github.io///posts/19" data-gatsby-head="true"/><meta name="twitter:title" content="ui-station" data-gatsby-head="true"/><meta name="twitter:description" content="I develop websites, games and apps with HTML, CSS and JS." data-gatsby-head="true"/><meta name="twitter:image" content="/favicons/ms-icon-310x310.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | ui-station" data-gatsby-head="true"/><meta name="next-head-count" content="18"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-BHFR6GTH9P"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
          
            gtag('config', 'G-BHFR6GTH9P');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/a22d13b8e6bc8203.css" as="style"/><link rel="stylesheet" href="/_next/static/css/a22d13b8e6bc8203.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-4a646156c659a948.js" defer=""></script><script src="/_next/static/chunks/348-d11c34b645b13f5b.js" defer=""></script><script src="/_next/static/chunks/873-a9851699c2b6bcaf.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bpage%5D-498da29379dd58dc.js" defer=""></script><script src="/_next/static/o1YmnmSuZvAX2O4TI9r41/_buildManifest.js" defer=""></script><script src="/_next/static/o1YmnmSuZvAX2O4TI9r41/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="posts_container__s9Z_H posts_-list__bsl0U"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">UI STATION</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><div class="posts_inner__HIBjT"><article><h2 class="SectionTitle_section_title__HS_xr">Posts</h2><div class="posts_project_list__oDV_y"><div class="PostList_post_list__or0rl"><a class="PostList_post_item__gAdVi" aria-label="Kubernetes K8s ConfigMap ë˜ëŠ” Secretê°€ ì—…ë°ì´íŠ¸ë  ë•Œ ë°°í¬ ìë™ ì¬ì‹œì‘í•˜ê¸°" href="/post/2024-06-19-KubernetesAutoRestartDeploymentswhenK8sConfigMaporSecretisUpdated"><div class="PostList_thumbnail_wrap__YuxdB"><img alt="Kubernetes K8s ConfigMap ë˜ëŠ” Secretê°€ ì—…ë°ì´íŠ¸ë  ë•Œ ë°°í¬ ìë™ ì¬ì‹œì‘í•˜ê¸°" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" class="PostList_thumbnail__6_oQk" style="color:transparent" src="/assets/img/2024-06-19-KubernetesAutoRestartDeploymentswhenK8sConfigMaporSecretisUpdated_0.png"/></div><div class="PostList_text_area__Hzd11"><div class="PostList_profile_area___aTjn"><div class="PostList_profile_image_wrap__tCTuE"><img alt="Kubernetes K8s ConfigMap ë˜ëŠ” Secretê°€ ì—…ë°ì´íŠ¸ë  ë•Œ ë°°í¬ ìë™ ì¬ì‹œì‘í•˜ê¸°" loading="lazy" width="20" height="20" decoding="async" data-nimg="1" class="PostList_profile__VGF_a" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><span class="writer">UI STATION</span></div><strong class="PostList_title__loLkl">Kubernetes K8s ConfigMap ë˜ëŠ” Secretê°€ ì—…ë°ì´íŠ¸ë  ë•Œ ë°°í¬ ìë™ ì¬ì‹œì‘í•˜ê¸°</strong><div class="PostList_meta__VCFLX"><span class="date">Jun 19, 2024</span><span class="PostList_reading_time__6CBMQ">13<!-- --> min read</span><span class="PostList_bookmark__PCpOK"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" aria-hidden="true"><path d="M6.75 4.5h10.5a.75.75 0 01.75.75v14.357a.375.375 0 01-.575.318L12 16.523l-5.426 3.401A.375.375 0 016 19.607V5.25a.75.75 0 01.75-.75zM16.5 6h-9v11.574l4.5-2.82 4.5 2.82V6z"></path></svg></span></div></div></a><a class="PostList_post_item__gAdVi" aria-label="ì•„ë§ˆì¡´ EKSì˜ ë¯¸ë˜" href="/post/2024-06-19-FutureofAmazonEKS"><div class="PostList_thumbnail_wrap__YuxdB"><img alt="ì•„ë§ˆì¡´ EKSì˜ ë¯¸ë˜" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" class="PostList_thumbnail__6_oQk" style="color:transparent" src="/assets/img/2024-06-19-FutureofAmazonEKS_0.png"/></div><div class="PostList_text_area__Hzd11"><div class="PostList_profile_area___aTjn"><div class="PostList_profile_image_wrap__tCTuE"><img alt="ì•„ë§ˆì¡´ EKSì˜ ë¯¸ë˜" loading="lazy" width="20" height="20" decoding="async" data-nimg="1" class="PostList_profile__VGF_a" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><span class="writer">UI STATION</span></div><strong class="PostList_title__loLkl">ì•„ë§ˆì¡´ EKSì˜ ë¯¸ë˜</strong><div class="PostList_meta__VCFLX"><span class="date">Jun 19, 2024</span><span class="PostList_reading_time__6CBMQ">5<!-- --> min read</span><span class="PostList_bookmark__PCpOK"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" aria-hidden="true"><path d="M6.75 4.5h10.5a.75.75 0 01.75.75v14.357a.375.375 0 01-.575.318L12 16.523l-5.426 3.401A.375.375 0 016 19.607V5.25a.75.75 0 01.75-.75zM16.5 6h-9v11.574l4.5-2.82 4.5 2.82V6z"></path></svg></span></div></div></a><a class="PostList_post_item__gAdVi" aria-label="ì¿ ë²„ë„¤í‹°ìŠ¤ x509 ì¸ì¦ì„œê°€ ë§Œë£Œë˜ì—ˆê±°ë‚˜ ì•„ì§ ìœ íš¨í•˜ì§€ ì•ŠìŒ ì˜¤ë¥˜" href="/post/2024-06-19-Kubernetesx509certificatehasexpiredorisnotyetvaliderror"><div class="PostList_thumbnail_wrap__YuxdB"><img alt="ì¿ ë²„ë„¤í‹°ìŠ¤ x509 ì¸ì¦ì„œê°€ ë§Œë£Œë˜ì—ˆê±°ë‚˜ ì•„ì§ ìœ íš¨í•˜ì§€ ì•ŠìŒ ì˜¤ë¥˜" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" class="PostList_thumbnail__6_oQk" style="color:transparent" src="/assets/img/2024-06-19-Kubernetesx509certificatehasexpiredorisnotyetvaliderror_0.png"/></div><div class="PostList_text_area__Hzd11"><div class="PostList_profile_area___aTjn"><div class="PostList_profile_image_wrap__tCTuE"><img alt="ì¿ ë²„ë„¤í‹°ìŠ¤ x509 ì¸ì¦ì„œê°€ ë§Œë£Œë˜ì—ˆê±°ë‚˜ ì•„ì§ ìœ íš¨í•˜ì§€ ì•ŠìŒ ì˜¤ë¥˜" loading="lazy" width="20" height="20" decoding="async" data-nimg="1" class="PostList_profile__VGF_a" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><span class="writer">UI STATION</span></div><strong class="PostList_title__loLkl">ì¿ ë²„ë„¤í‹°ìŠ¤ x509 ì¸ì¦ì„œê°€ ë§Œë£Œë˜ì—ˆê±°ë‚˜ ì•„ì§ ìœ íš¨í•˜ì§€ ì•ŠìŒ ì˜¤ë¥˜</strong><div class="PostList_meta__VCFLX"><span class="date">Jun 19, 2024</span><span class="PostList_reading_time__6CBMQ">2<!-- --> min read</span><span class="PostList_bookmark__PCpOK"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" aria-hidden="true"><path d="M6.75 4.5h10.5a.75.75 0 01.75.75v14.357a.375.375 0 01-.575.318L12 16.523l-5.426 3.401A.375.375 0 016 19.607V5.25a.75.75 0 01.75-.75zM16.5 6h-9v11.574l4.5-2.82 4.5 2.82V6z"></path></svg></span></div></div></a><a class="PostList_post_item__gAdVi" aria-label="DNS ì„±ëŠ¥ì„ ëª¨ë‹ˆí„°ë§í•˜ê¸° ìœ„í•´ ì•Œì•„ì•¼ í•  ëª¨ë“  ê²ƒ" href="/post/2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance"><div class="PostList_thumbnail_wrap__YuxdB"><img alt="DNS ì„±ëŠ¥ì„ ëª¨ë‹ˆí„°ë§í•˜ê¸° ìœ„í•´ ì•Œì•„ì•¼ í•  ëª¨ë“  ê²ƒ" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" class="PostList_thumbnail__6_oQk" style="color:transparent" src="/assets/img/2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance_0.png"/></div><div class="PostList_text_area__Hzd11"><div class="PostList_profile_area___aTjn"><div class="PostList_profile_image_wrap__tCTuE"><img alt="DNS ì„±ëŠ¥ì„ ëª¨ë‹ˆí„°ë§í•˜ê¸° ìœ„í•´ ì•Œì•„ì•¼ í•  ëª¨ë“  ê²ƒ" loading="lazy" width="20" height="20" decoding="async" data-nimg="1" class="PostList_profile__VGF_a" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><span class="writer">UI STATION</span></div><strong class="PostList_title__loLkl">DNS ì„±ëŠ¥ì„ ëª¨ë‹ˆí„°ë§í•˜ê¸° ìœ„í•´ ì•Œì•„ì•¼ í•  ëª¨ë“  ê²ƒ</strong><div class="PostList_meta__VCFLX"><span class="date">Jun 19, 2024</span><span class="PostList_reading_time__6CBMQ">13<!-- --> min read</span><span class="PostList_bookmark__PCpOK"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" aria-hidden="true"><path d="M6.75 4.5h10.5a.75.75 0 01.75.75v14.357a.375.375 0 01-.575.318L12 16.523l-5.426 3.401A.375.375 0 016 19.607V5.25a.75.75 0 01.75-.75zM16.5 6h-9v11.574l4.5-2.82 4.5 2.82V6z"></path></svg></span></div></div></a><a class="PostList_post_item__gAdVi" aria-label="Kubernetes ë³´ì•ˆ ë§ˆìŠ¤í„°í•˜ê¸° - ë‚´ Admission Controllers ì—¬í–‰" href="/post/2024-06-19-MasteringKubernetesSecurityMyJourneyWithAdmissionControllers"><div class="PostList_thumbnail_wrap__YuxdB"><img alt="Kubernetes ë³´ì•ˆ ë§ˆìŠ¤í„°í•˜ê¸° - ë‚´ Admission Controllers ì—¬í–‰" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" class="PostList_thumbnail__6_oQk" style="color:transparent" src="/assets/img/2024-06-19-MasteringKubernetesSecurityMyJourneyWithAdmissionControllers_0.png"/></div><div class="PostList_text_area__Hzd11"><div class="PostList_profile_area___aTjn"><div class="PostList_profile_image_wrap__tCTuE"><img alt="Kubernetes ë³´ì•ˆ ë§ˆìŠ¤í„°í•˜ê¸° - ë‚´ Admission Controllers ì—¬í–‰" loading="lazy" width="20" height="20" decoding="async" data-nimg="1" class="PostList_profile__VGF_a" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><span class="writer">UI STATION</span></div><strong class="PostList_title__loLkl">Kubernetes ë³´ì•ˆ ë§ˆìŠ¤í„°í•˜ê¸° - ë‚´ Admission Controllers ì—¬í–‰</strong><div class="PostList_meta__VCFLX"><span class="date">Jun 19, 2024</span><span class="PostList_reading_time__6CBMQ">7<!-- --> min read</span><span class="PostList_bookmark__PCpOK"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" aria-hidden="true"><path d="M6.75 4.5h10.5a.75.75 0 01.75.75v14.357a.375.375 0 01-.575.318L12 16.523l-5.426 3.401A.375.375 0 016 19.607V5.25a.75.75 0 01.75-.75zM16.5 6h-9v11.574l4.5-2.82 4.5 2.82V6z"></path></svg></span></div></div></a><a class="PostList_post_item__gAdVi" aria-label="ì˜¨í”„ë ˆë¯¸ìŠ¤ ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ ê´€ë¦¬í˜• ì¿ ë²„ë„¤í‹°ìŠ¤" href="/post/2024-06-19-On-PremisesKubernetesVsManagedKubernetes"><div class="PostList_thumbnail_wrap__YuxdB"><img alt="ì˜¨í”„ë ˆë¯¸ìŠ¤ ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ ê´€ë¦¬í˜• ì¿ ë²„ë„¤í‹°ìŠ¤" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" class="PostList_thumbnail__6_oQk" style="color:transparent" src="/assets/img/2024-06-19-On-PremisesKubernetesVsManagedKubernetes_0.png"/></div><div class="PostList_text_area__Hzd11"><div class="PostList_profile_area___aTjn"><div class="PostList_profile_image_wrap__tCTuE"><img alt="ì˜¨í”„ë ˆë¯¸ìŠ¤ ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ ê´€ë¦¬í˜• ì¿ ë²„ë„¤í‹°ìŠ¤" loading="lazy" width="20" height="20" decoding="async" data-nimg="1" class="PostList_profile__VGF_a" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><span class="writer">UI STATION</span></div><strong class="PostList_title__loLkl">ì˜¨í”„ë ˆë¯¸ìŠ¤ ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ ê´€ë¦¬í˜• ì¿ ë²„ë„¤í‹°ìŠ¤</strong><div class="PostList_meta__VCFLX"><span class="date">Jun 19, 2024</span><span class="PostList_reading_time__6CBMQ">4<!-- --> min read</span><span class="PostList_bookmark__PCpOK"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" aria-hidden="true"><path d="M6.75 4.5h10.5a.75.75 0 01.75.75v14.357a.375.375 0 01-.575.318L12 16.523l-5.426 3.401A.375.375 0 016 19.607V5.25a.75.75 0 01.75-.75zM16.5 6h-9v11.574l4.5-2.82 4.5 2.82V6z"></path></svg></span></div></div></a><a class="PostList_post_item__gAdVi" aria-label="ì–´ë µê²Œ ë°°ìš´ êµí›ˆ Ciliumì˜ ê¸°ë³¸ Pod CIDRì„ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”" href="/post/2024-06-19-LearneditthehardwayDontuseCiliumsdefaultPodCIDR"><div class="PostList_thumbnail_wrap__YuxdB"><img alt="ì–´ë µê²Œ ë°°ìš´ êµí›ˆ Ciliumì˜ ê¸°ë³¸ Pod CIDRì„ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" class="PostList_thumbnail__6_oQk" style="color:transparent" src="/assets/img/2024-06-19-LearneditthehardwayDontuseCiliumsdefaultPodCIDR_0.png"/></div><div class="PostList_text_area__Hzd11"><div class="PostList_profile_area___aTjn"><div class="PostList_profile_image_wrap__tCTuE"><img alt="ì–´ë µê²Œ ë°°ìš´ êµí›ˆ Ciliumì˜ ê¸°ë³¸ Pod CIDRì„ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”" loading="lazy" width="20" height="20" decoding="async" data-nimg="1" class="PostList_profile__VGF_a" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><span class="writer">UI STATION</span></div><strong class="PostList_title__loLkl">ì–´ë µê²Œ ë°°ìš´ êµí›ˆ Ciliumì˜ ê¸°ë³¸ Pod CIDRì„ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”</strong><div class="PostList_meta__VCFLX"><span class="date">Jun 19, 2024</span><span class="PostList_reading_time__6CBMQ">7<!-- --> min read</span><span class="PostList_bookmark__PCpOK"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" aria-hidden="true"><path d="M6.75 4.5h10.5a.75.75 0 01.75.75v14.357a.375.375 0 01-.575.318L12 16.523l-5.426 3.401A.375.375 0 016 19.607V5.25a.75.75 0 01.75-.75zM16.5 6h-9v11.574l4.5-2.82 4.5 2.82V6z"></path></svg></span></div></div></a><a class="PostList_post_item__gAdVi" aria-label="ë‚˜ì˜ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— MongoDB No-SQL ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì¶”ê°€í•œ ê²½í—˜" href="/post/2024-06-19-MyexperienceaddingaMongoDBNo-SQLdatabasetomyKubernetescluster"><div class="PostList_thumbnail_wrap__YuxdB"><img alt="ë‚˜ì˜ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— MongoDB No-SQL ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì¶”ê°€í•œ ê²½í—˜" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" class="PostList_thumbnail__6_oQk" style="color:transparent" src="/assets/img/2024-06-19-MyexperienceaddingaMongoDBNo-SQLdatabasetomyKubernetescluster_0.png"/></div><div class="PostList_text_area__Hzd11"><div class="PostList_profile_area___aTjn"><div class="PostList_profile_image_wrap__tCTuE"><img alt="ë‚˜ì˜ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— MongoDB No-SQL ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì¶”ê°€í•œ ê²½í—˜" loading="lazy" width="20" height="20" decoding="async" data-nimg="1" class="PostList_profile__VGF_a" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><span class="writer">UI STATION</span></div><strong class="PostList_title__loLkl">ë‚˜ì˜ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— MongoDB No-SQL ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì¶”ê°€í•œ ê²½í—˜</strong><div class="PostList_meta__VCFLX"><span class="date">Jun 19, 2024</span><span class="PostList_reading_time__6CBMQ">18<!-- --> min read</span><span class="PostList_bookmark__PCpOK"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" aria-hidden="true"><path d="M6.75 4.5h10.5a.75.75 0 01.75.75v14.357a.375.375 0 01-.575.318L12 16.523l-5.426 3.401A.375.375 0 016 19.607V5.25a.75.75 0 01.75-.75zM16.5 6h-9v11.574l4.5-2.82 4.5 2.82V6z"></path></svg></span></div></div></a><a class="PostList_post_item__gAdVi" aria-label="Argo CD v212 ë¦´ë¦¬ìŠ¤ í›„ë³´íŒ" href="/post/2024-06-19-ArgoCDv212ReleaseCandidate"><div class="PostList_thumbnail_wrap__YuxdB"><img alt="Argo CD v212 ë¦´ë¦¬ìŠ¤ í›„ë³´íŒ" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" class="PostList_thumbnail__6_oQk" style="color:transparent" src="/assets/img/2024-06-19-ArgoCDv212ReleaseCandidate_0.png"/></div><div class="PostList_text_area__Hzd11"><div class="PostList_profile_area___aTjn"><div class="PostList_profile_image_wrap__tCTuE"><img alt="Argo CD v212 ë¦´ë¦¬ìŠ¤ í›„ë³´íŒ" loading="lazy" width="20" height="20" decoding="async" data-nimg="1" class="PostList_profile__VGF_a" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><span class="writer">UI STATION</span></div><strong class="PostList_title__loLkl">Argo CD v212 ë¦´ë¦¬ìŠ¤ í›„ë³´íŒ</strong><div class="PostList_meta__VCFLX"><span class="date">Jun 19, 2024</span><span class="PostList_reading_time__6CBMQ">3<!-- --> min read</span><span class="PostList_bookmark__PCpOK"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" aria-hidden="true"><path d="M6.75 4.5h10.5a.75.75 0 01.75.75v14.357a.375.375 0 01-.575.318L12 16.523l-5.426 3.401A.375.375 0 016 19.607V5.25a.75.75 0 01.75-.75zM16.5 6h-9v11.574l4.5-2.82 4.5 2.82V6z"></path></svg></span></div></div></a><a class="PostList_post_item__gAdVi" aria-label="ë„ì»¤ì—ì„œ ìì²´ ì„œëª… ì¸ì¦ì„œë¥¼ ì‚¬ìš©í•œ NGINX" href="/post/2024-06-19-NGINXwithSelf-SignedCertificateonDocker"><div class="PostList_thumbnail_wrap__YuxdB"><img alt="ë„ì»¤ì—ì„œ ìì²´ ì„œëª… ì¸ì¦ì„œë¥¼ ì‚¬ìš©í•œ NGINX" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" class="PostList_thumbnail__6_oQk" style="color:transparent" src="/assets/img/2024-06-19-NGINXwithSelf-SignedCertificateonDocker_0.png"/></div><div class="PostList_text_area__Hzd11"><div class="PostList_profile_area___aTjn"><div class="PostList_profile_image_wrap__tCTuE"><img alt="ë„ì»¤ì—ì„œ ìì²´ ì„œëª… ì¸ì¦ì„œë¥¼ ì‚¬ìš©í•œ NGINX" loading="lazy" width="20" height="20" decoding="async" data-nimg="1" class="PostList_profile__VGF_a" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><span class="writer">UI STATION</span></div><strong class="PostList_title__loLkl">ë„ì»¤ì—ì„œ ìì²´ ì„œëª… ì¸ì¦ì„œë¥¼ ì‚¬ìš©í•œ NGINX</strong><div class="PostList_meta__VCFLX"><span class="date">Jun 19, 2024</span><span class="PostList_reading_time__6CBMQ">8<!-- --> min read</span><span class="PostList_bookmark__PCpOK"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" aria-hidden="true"><path d="M6.75 4.5h10.5a.75.75 0 01.75.75v14.357a.375.375 0 01-.575.318L12 16.523l-5.426 3.401A.375.375 0 016 19.607V5.25a.75.75 0 01.75-.75zM16.5 6h-9v11.574l4.5-2.82 4.5 2.82V6z"></path></svg></span></div></div></a></div></div></article><div class="posts_pagination__R_03T"><a class="link" href="/posts/1">1</a><a class="link" href="/posts/2">2</a><a class="link" href="/posts/3">3</a><a class="link" href="/posts/4">4</a><a class="link" href="/posts/5">5</a><a class="link" href="/posts/6">6</a><a class="link" href="/posts/7">7</a><a class="link" href="/posts/8">8</a><a class="link" href="/posts/9">9</a><a class="link" href="/posts/10">10</a><a class="link" href="/posts/11">11</a><a class="link" href="/posts/12">12</a><a class="link" href="/posts/13">13</a><a class="link" href="/posts/14">14</a><a class="link" href="/posts/15">15</a><a class="link" href="/posts/16">16</a><a class="link" href="/posts/17">17</a><a class="link" href="/posts/18">18</a><a class="link posts_-active__YVJEi" href="/posts/19">19</a><a class="link" href="/posts/20">20</a><button type="button" class="page_button -prev">&gt;</button></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"posts":[{"title":"Kubernetes K8s ConfigMap ë˜ëŠ” Secretê°€ ì—…ë°ì´íŠ¸ë  ë•Œ ë°°í¬ ìë™ ì¬ì‹œì‘í•˜ê¸°","description":"","date":"2024-06-19 13:11","slug":"2024-06-19-KubernetesAutoRestartDeploymentswhenK8sConfigMaporSecretisUpdated","content":"\n\n## ìë™ ë¡¤ì•„ì›ƒ ì¬ì‹œì‘: K8s ConfigMap ë˜ëŠ” Secretê°€ ì—…ë°ì´íŠ¸ë  ë•Œ ë°°í¬ ë‹¤ì‹œ ì‹œì‘í•˜ê¸°\n\nì¿ ë²„ë„¤í‹°ìŠ¤ ë°°í¬ëŠ” ëª¨ë“  ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì—ì„œ ê°€ì¥ ì¼ë°˜ì ì¸ ë¦¬ì†ŒìŠ¤ ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤. ìš°ë¦¬ëŠ” ëª¨ë‘ podë¥¼ K8s ë°°í¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹¤í–‰í•˜ì—¬ ë†’ì€ ê°€ìš©ì„±ì„ ë³´ì¥í•˜ê³ , podê°€ ì‚­ì œë˜ë©´ ìë™ìœ¼ë¡œ ìƒì„±ë˜ë„ë¡í•©ë‹ˆë‹¤.\n\nì• í”Œë¦¬ì¼€ì´ì…˜ì´ í•­ìƒ ì—¬ëŸ¬ í™˜ê²½ì—ì„œ ì›í™œí•˜ê²Œ ì‹¤í–‰ë˜ë„ë¡í•˜ê¸° ìœ„í•´ êµ¬ì„±ì´ í•„ìš”í•œ ê²ƒì€ ë§¤ìš° í”í•©ë‹ˆë‹¤. ë°ì´í„°ë² ì´ìŠ¤ ì‚¬ìš©ì ì´ë¦„, ë¹„ë°€ë²ˆí˜¸ ë“±ê³¼ ê°™ì€ ì¤‘ìš”í•œ ì •ë³´ê°€ í•„ìš”í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì¿ ë²„ë„¤í‹°ìŠ¤ì—ì„œëŠ” êµ¬ì„± ë§µê³¼ ì‹œí¬ë¦¿ì„ ì‚¬ìš©í•˜ì—¬ ì‘ìš© í”„ë¡œê·¸ë¨ë³„ ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³  podë¡œ ì£¼ì…í•˜ì—¬ ì‘ìš© í”„ë¡œê·¸ë¨ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nê·¸ë ‡ë‹¤ë©´ êµ¬ì„± ë§µì´ë‚˜ ì‹œí¬ë¦¿ì˜ ê°’ì„ ì—…ë°ì´íŠ¸í–ˆì„ ë•ŒëŠ” ì–´ë–¨ê¹Œìš”? ìµœì‹  ê°’ì„ ë°˜ì˜í•˜ë ¤ë©´ podë¥¼ ë‹¤ì‹œ ì‹œì‘í•´ì•¼í•©ë‹ˆë‹¤, ë§ì£ ? ë˜ëŠ” ë¡¤ì•„ì›ƒì„ ë‹¤ì‹œ ì‹œì‘í•˜ì—¬ ìƒˆë¡œìš´ podë¥¼ ìƒì„±í•˜ê²Œ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì´ì œ ìƒìƒí•´ë³´ì„¸ìš”. ê³µí†µ configmap ë˜ëŠ” secretì„ ì‚¬ìš©í•˜ëŠ” ìˆ˜ë°± ê°œì˜ ë°°í¬ê°€ ìˆê³  ê·¸ ê°’ì„ ì—…ë°ì´íŠ¸í•˜ê³  ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ìµœì‹  ê°’ì´ë¼ëŠ” ê²ƒì„ í™•ì‹¤í•˜ê²Œ í•´ì•¼í•œë‹¤ê³  ê°€ì •í•´ë³´ì„¸ìš”.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì €í¬ëŠ” AWS Secrets Managerì— ë¹„ë°€ì„ ì €ì¥í•˜ê³ , Kubernetes Secrets Store CSI Driverë¥¼ ìœ„í•´ AWS Secrets ë° êµ¬ì„± ì œê³µì(ASCP)ë¡œë¶€í„° Kubernetes Secretsë¥¼ ìƒì„±í•©ë‹ˆë‹¤. \n\nì´ ë¸”ë¡œê·¸ ê²Œì‹œë¬¼ì—ì„œëŠ” Secret ë˜ëŠ” ConfigMapì´ ì—…ë°ì´íŠ¸ë  ë•Œ Kubernetes ë°°í¬ë¥¼ ìë™ìœ¼ë¡œ ë¡¤ì•„ì›ƒ ë° ë‹¤ì‹œ ì‹œì‘í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì„¤ëª…í•˜ê² ìŠµë‹ˆë‹¤.\n\n# ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨:\n\n![Architecture Diagram](/assets/img/2024-06-19-KubernetesAutoRestartDeploymentswhenK8sConfigMaporSecretisUpdated_0.png)\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n## ì‹œì‘í•´ ë´…ì‹œë‹¤!\n\n### ì¤€ë¹„ë¬¼:\n\n- EKS í´ëŸ¬ìŠ¤í„°\n- EKSë¥¼ ìœ„í•œ OIDC ì œê³µì êµ¬ì„± í•„ìš”\n- Kubectl\n- AWS CLI\n\n### ë‹¨ê³„ 1: ASCPë¥¼ ìœ„í•œ IAM ì—­í•  ë° ì •ì±… ìƒì„±\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nASCP(Amazon EKS Security Token Service)ëŠ” Amazon EKS íŒŒë“œ IDë¥¼ ê²€ìƒ‰í•˜ì—¬ IAM ì—­í• ë¡œ êµí™˜í•©ë‹ˆë‹¤. í•´ë‹¹ IAM ì—­í• ì— ëŒ€í•œ IAM ì •ì±…ì—ì„œ ê¶Œí•œì„ ì„¤ì •í•©ë‹ˆë‹¤. ASCPê°€ IAM ì—­í• ì„ ê°€ì •í•˜ë©´ ê¶Œí•œì„ ë¶€ì—¬ë°›ì€ ì‹œí¬ë¦¿ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ì»¨í…Œì´ë„ˆëŠ” IAM ì—­í• ê³¼ ì—°ê²°ë˜ì§€ ì•ŠëŠ” í•œ ì‹œí¬ë¦¿ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n\n- IAM ì •ì±… ë¬¸ì„œ ì‘ì„±\n\"secrets_policy\"ë¼ëŠ” ì´ë¦„ì˜ íŒŒì¼ì„ ë§Œë“¤ê³  ë‹¤ìŒ ë‚´ìš©ì„ ì¶”ê°€í•˜ì‹­ì‹œì˜¤.\n\n```js\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Action\": [\n                \"secretsmanager:DescribeSecret\",\n                \"secretsmanager:GetSecretValue\"\n            ],\n            \"Effect\": \"Allow\",\n            \"Resource\": \"*\"\n        }\n}\n```\n\n2. ë‹¤ìŒ ëª…ë ¹ì„ ì‹¤í–‰í•˜ì—¬ IAM ì •ì±…ì„ ë§Œë“­ë‹ˆë‹¤.\nIAM ì •ì±…ì„ IAM ì—­í• ì— ì—°ê²°í•  ë•Œ policy ARNì„ ë©”ëª¨í•˜ì‹­ì‹œì˜¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\naws iam create-policy \\\n    --policy-name my-secret-manager-policy \\\n    --policy-document file://secrets_policy\n```\n\n3. IAM ì—­í• ì— ì‹ ë¢° ì •ì±… ìƒì„±í•˜ê¸°\n\"trust_policy\"ë¼ëŠ” ì´ë¦„ì˜ íŒŒì¼ì„ ìƒì„±í•˜ê³  ë‹¤ìŒ ë‚´ìš©ì„ ì¶”ê°€í•˜ì„¸ìš”. ì˜¬ë°”ë¥¸ ê°’ìœ¼ë¡œ ëŒ€ì²´í•´ì•¼ í•©ë‹ˆë‹¤. `SERVICE_ACCOUNT_NAME`ì€ ì„ì˜ë¡œ ì§€ì •í•  ìˆ˜ ìˆì§€ë§Œ Kubernetesì—ì„œ ì‹¤ì œ ì„œë¹„ìŠ¤ ê³„ì •ì„ ìƒì„±í•  ë•Œ ë™ì¼í•œ ì´ë¦„ì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.\n\n```js\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRoleWithWebIdentity\",\n      \"Principal\": {\n        \"Federated\": \"arn:aws:iam::\u003cAWS_ACCOUNT_ID\u003e:oidc-provider/oidc.eks.\u003cAWS_REGION\u003e.amazonaws.com/id/\u003cOIDC_ID\u003e\"\n      },\n      \"Condition\": {\n        \"StringEquals\": {\n          \"oidc.eks.\u003cAWS_REGION\u003e.amazonaws.com/id/\u003cOIDC_ID\u003e:aud\": \"sts.amazonaws.com\",\n          \"oidc.eks.\u003cAWS_REGION\u003e.amazonaws.com/id/\u003cOIDC_ID\u003e:sub\": \"system:serviceaccount:\u003cK8S_NAMESPACE\u003e:\u003cSERVICE_ACCOUNT_NAME\u003e\"\n        }\n      }\n    }\n  ]\n}\n```\n\n4. ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ IAM ì—­í• ì„ ë§Œë“œì„¸ìš”. \n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\naws iam create-role --role-name my-secret-manager-role --assume-role-policy-document file://trust_policy\n```\n\n5. Attach IAM policy to IAM Role\n\n```js\naws iam attach-role-policy --policy-arn \u003cyour_policy_arn\u003e --role-name my-secret-manager-role\n```\n\nìš°ë¦¬ëŠ” í•„ìš”í•œ ëª¨ë“  IAM ì—­í• ê³¼ ì •ì±…ì„ ìƒì„±í–ˆìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# ë‹¨ê³„ 2: ASCP ì„¤ì¹˜ ë° êµ¬ì„±\n\nì´ì œ 2ê°œì˜ Helm ì°¨íŠ¸ë¥¼ ì„¤ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.\n\n- AWS Secrets and Configuration Provider (ASCP) ì°¨íŠ¸ ì„¤ì¹˜\n\n```js\n# ASCP Helm ì°¨íŠ¸ ë¦¬í¬ì§€í† ë¦¬ ì¶”ê°€\nhelm repo add aws-secrets-manager https://aws.github.io/secrets-store-csi-driver-provider-aws\n\n# ASCP Helm ì°¨íŠ¸ ì„¤ì¹˜\nhelm install -n kube-system secrets-provider-aws aws-secrets-manager/secrets-store-csi-driver-provider-aws\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n2. Secrets Store CSI Driver ì°¨íŠ¸ ì„¤ì¹˜\n\n- Secrets Store CSI Driver ì°¨íŠ¸ë¥¼ ìœ„í•œ helm ë ˆí¬ì§€í† ë¦¬ ì¶”ê°€\n\n```js\n# Secrets Store CSI Driver ì°¨íŠ¸ ë ˆí¬ì§€í† ë¦¬ ì¶”ê°€\nhelm repo add secrets-store-csi-driver https://kubernetes-sigs.github.io/secrets-store-csi-driver/charts\n```\n\n- ê¸°ë³¸ê°’ í™•ì¸\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n\n# ê¸°ë³¸ ê°’ ê°€ì ¸ì˜¤ê¸°\nhelm show values secrets-store-csi-driver/secrets-store-csi-driver \u003e secrets-store-csi-driver.yaml\n\n\n- secrets-store-csi-driver.yaml íŒŒì¼ì—ì„œ ë‹¤ìŒ ê°’ì„ ì—…ë°ì´íŠ¸í•˜ì„¸ìš”.\n\n\n## K8S Secrets ë™ê¸°í™”ì— í•„ìš”í•œ RBAC ì—­í•  ë° ë°”ì¸ë”© ì„¤ì¹˜ ì—¬ë¶€\nsyncSecret:\n  enabled: true\n\n## ì‹œí¬ë¦¿ ë¡œí…Œì´ì…˜ ê¸°ëŠ¥ í™œì„±í™” [ì•ŒíŒŒ]\nenableSecretRotation: true\n\n\nìœ„ì˜ êµ¬ì„±ì€ \"secrets-store-csi-driver\"ê°€ AWS Secret Managerì—ì„œ ìµœì‹  ê°’ì„ ê°€ì ¸ì™€ í•´ë‹¹ ê°’ì„ Kubernetes Secrets ê°ì²´ì— ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\níšŒì „-íˆ¬í‘œ-ê°„ê²©ì€ ê¸°ë³¸ì ìœ¼ë¡œ 2ë¶„ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆì§€ë§Œ, ì†ì„± rotationPollIntervalì„ ì„¤ì •í•¨ìœ¼ë¡œì¨ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n- Helm ì°¨íŠ¸ ì„¤ì¹˜\n\n```js\n# Helm ì°¨íŠ¸ ì„¤ì¹˜\nhelm install -n kube-system csi-secrets-store secrets-store-csi-driver/secrets-store-csi-driver -f secrets-store-csi-driver.yaml\n```\n\n# ë‹¨ê³„ 3: AWS Secret Managerì— í…ŒìŠ¤íŠ¸ ì‹œí¬ë¦¿ ìƒì„±\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nAWS Secret Managerì—ì„œ í…ŒìŠ¤íŠ¸ ì‹œí¬ë¦¿ì„ ìƒì„±í•  ê²ƒì…ë‹ˆë‹¤.\n\n```js\naws secretsmanager create-secret \\\n    --name my-test-secret \\\n    --description \"CLIë¡œ ìƒì„±í•œ ë‚´ í…ŒìŠ¤íŠ¸ ì‹œí¬ë¦¿.\" \\\n    --secret-string \"{\\\"user\\\":\\\"my-user\\\",\\\"password\\\":\\\"ì˜ˆì‹œ-ë¹„ë°€ë²ˆí˜¸\\\"}\"\n```\n\n# ë‹¨ê³„ 4: Kubernetes ServiceAccount ìƒì„±\n\nì´ì œ IAM ì—­í• ì„ ê°€ì •í•  ìˆ˜ ìˆë„ë¡ íŒŒë“œì— í—ˆìš©í•˜ëŠ” ServiceAccountë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ServiceAccountëŠ” K8s ë°°í¬ì—ì„œ ì‚¬ìš©ë  ê²ƒì…ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nserviceaccount.yamlì´ë¼ëŠ” ì´ë¦„ì˜ íŒŒì¼ì„ ìƒì„±í•´ì£¼ì„¸ìš”.\n\n```yaml\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: \u003cyour_service_account_name\u003e # ì´ ì´ë¦„ì€ IAM ì‹ ë¢° ì •ì±…ì„ ë§Œë“¤ ë•Œ ì§€ì •í•œ ì´ë¦„ê³¼ ì¼ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.\n  annotations:\n    eks.amazonaws.com/role-arn: \u003cIAM_ROLE_ARN\u003e\n```\n\në‹¤ìŒ ëª…ë ¹ì„ ì‹¤í–‰í•˜ì—¬ K8sì—ì„œ ì„œë¹„ìŠ¤ ê³„ì •ì„ ìƒì„±í•©ë‹ˆë‹¤.\n\n```bash\nkubectl apply -f serviceaccount.yaml\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# ë‹¨ê³„ 5: í…ŒìŠ¤íŠ¸ ê°ì²´ ìƒì„±í•˜ê¸°\n\nì´ì œ í•„ìš”í•œ ëª¨ë“  ë¦¬ì†ŒìŠ¤ë¥¼ ë°°í¬í–ˆìŠµë‹ˆë‹¤. ì´ì œ í…ŒìŠ¤íŠ¸ ê°ì²´ë¥¼ ë§Œë“¤ì–´ ë´…ì‹œë‹¤.\n\n- ì´ë¦„ì´ â€œmy-test-secret-manifest.yamlâ€ì¸ íŒŒì¼ ìƒì„±\n\n```js\n---\napiVersion: secrets-store.csi.x-k8s.io/v1\nkind: SecretProviderClass\nmetadata:\n  name: aws-secrets-providerclass\nspec:\n  provider: aws\n  secretObjects:\n    - secretName: my-test-k8s-secret\n      type: Opaque\n      data:\n        - objectName: user\n          key: user\n        - objectName: password\n          key: password\n  parameters:\n    objects: |\n      - objectName: arn:aws:secretsmanager:\u003cAWS_REGION\u003e:\u003cAWS_ACCOUNT_ID\u003e:secret:my-test-secret\n        jmesPath:\n          - path: user\n            objectAlias: user\n          - path: password\n            objectAlias: password\n---\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: secret-rotation-test-ubuntu-deployment\n  labels:\n    app: ubuntu\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: ubuntu\n  template:\n    metadata:\n      labels:\n        app: ubuntu\n    spec:\n      serviceAccountName: \u003cyour_service_account_name\u003e # ì´ ì´ë¦„ì€ ë‹¨ê³„ 4ì—ì„œ ë§Œë“  ì„œë¹„ìŠ¤ ê³„ì • ì´ë¦„ê³¼ ì¼ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤\n      volumes:\n      - name: mount-secrets-access\n        csi:\n          driver: secrets-store.csi.k8s.io\n          readOnly: true\n          volumeAttributes:\n            secretProviderClass: \"aws-secrets-providerclass\"\n      containers:\n      - name: ubuntu\n        image: ubuntu\n        command: [\"sleep\", \"123456\"]\n        env:\n        - name: USER\n          valueFrom:\n            secretKeyRef:\n              name: my-test-k8s-secret\n              key: user\n        - name: PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: my-test-k8s-secret\n              key: password\n        volumeMounts:\n        - name: mount-secrets-access\n          mountPath: \"/mnt/aws-secrets\"\n          readOnly: true\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n2. manifestë¥¼ ì ìš©í•˜ì‹­ì‹œì˜¤\n\n```js\nkubectl apply -f my-test-secret-manifest.yaml\n```\n\n3. ë‹¤ìŒ ë¦¬ì†ŒìŠ¤ê°€ ìƒì„±ë©ë‹ˆë‹¤.\n\n- SecretProviderClass ë¦¬ì†ŒìŠ¤ - AWS Secret Managerì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ K8s Secretë¥¼ ìƒì„±í•©ë‹ˆë‹¤\n- ë³¼ë¥¨ ë§ˆìš´íŠ¸ê°€ ìˆëŠ” ë°°í¬ - SecretProviderClassë¥¼ ë³¼ë¥¨ìœ¼ë¡œ ë§ˆìš´íŠ¸í•´ì•¼ í•©ë‹ˆë‹¤\n- Kubernetes Secret - íŒŒë“œ ë‚´ì—ì„œ í™˜ê²½ ë³€ìˆ˜ë¡œ ì£¼ì…ë©ë‹ˆë‹¤\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì•„ë˜ ë‹¤ì´ì–´ê·¸ë¨ì€ YAMLì„ ì ìš©í•  ë•Œ ë’·ë‹¨ì—ì„œ ë¬´ìŠ¨ ì¼ì´ ë²Œì–´ì§€ëŠ”ì§€ ì˜ ì‹œê°í™”í•œ ê²ƒì…ë‹ˆë‹¤.\n\n![ë‹¤ì´ì–´ê·¸ë¨](/assets/img/2024-06-19-KubernetesAutoRestartDeploymentswhenK8sConfigMaporSecretisUpdated_1.png)\n\n4. ëª¨ë“  ê²ƒì´ ë°°í¬ë˜ì—ˆëŠ”ì§€ í™•ì¸í•´ë³´ì„¸ìš”.\n\n```js\n# SecretProviderClass í™•ì¸\nkubectl get SecretProviderClass aws-secrets-providerclass -o yaml\n\n# ë°°í¬ í™•ì¸\nkubectl get deploy secret-rotation-test-ubuntu-deployment -o yaml\n\n# Pod í™•ì¸\nkubectl get po \u003cpod_name\u003e -o yaml\n\n# Secret ê°€ì ¸ì˜¤ê¸°\nkubectl get secret my-test-k8s-secret -o yaml\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# ë‹¨ê³„ 6: Reloader ì„¤ì¹˜í•˜ê¸°\n\nReloaderëŠ” ConfigMapê³¼ Secretì˜ ë³€ê²½ ì‚¬í•­ì„ ê°ì§€í•˜ê³  ê´€ë ¨ëœ DeploymentConfig, Deployment, DaemonSet, StatefulSet ë° Rolloutê³¼ í•¨ê»˜ Podì˜ ë¡¤ë§ ì—…ê·¸ë ˆì´ë“œë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n- Reloader Helm Repo ì¶”ê°€\n\n```js\n# Helm Repo ì¶”ê°€\nhelm repo add stakater https://stakater.github.io/stakater-charts\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n2. ê¸°ë³¸ê°’ ê°€ì ¸ì˜¤ê¸°\n\n```js\n# ê¸°ë³¸ê°’ ê°€ì ¸ì˜¤ê¸°\nhelm show values stakater/reloader \u003e reloader.yaml\n```\n\n3. reloader.yaml íŒŒì¼ ì—…ë°ì´íŠ¸í•˜ê¸°\n\n```js\nreloader:\n  # ë¦¬ë”ì‹­ ì„ ì¶œì„ í™œì„±í™”í•˜ë ¤ë©´ trueë¡œ ì„¤ì •í•˜ì—¬ ì—¬ëŸ¬ ë ˆí”Œë¦¬ì¹´ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n  enableHA: true\n  deployment:\n    # ì—¬ëŸ¬ ë ˆí”Œë¦¬ì¹´ë¥¼ ì‹¤í–‰í•˜ë ¤ë©´ reloader.enableHA = trueë¡œ ì„¤ì •í•©ë‹ˆë‹¤.\n    replicas: 2\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n4. Helm ì°¨íŠ¸ ì„¤ì¹˜\n\n```js\n# Helm ì°¨íŠ¸ ì„¤ì¹˜\nhelm install reloader -f reloader.yaml stakater/reloader -n kube-system\n```\n\n# ë‹¨ê³„ 7: Secret ì—…ë°ì´íŠ¸ë¡œ í…ŒìŠ¤íŠ¸í•˜ê¸°\n\n- ReloaderëŠ” ì£¼ì„ì— ì˜í–¥ì„ ë°›ìŠµë‹ˆë‹¤.\nê¸°ë³¸ ì£¼ì„ reloader.stakater.com/autoëŠ” ì£¼ìš” ë©”íƒ€ë°ì´í„°ì— ìˆì–´ì•¼ í•©ë‹ˆë‹¤. ì•„ë˜ ëª…ë ¹ì„ ì‚¬ìš©í•˜ì—¬ ë°°í¬ì— ì£¼ì„ì„ ì¶”ê°€í•˜ì„¸ìš”.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\n# ë°°í¬ ì£¼ì„ ì¶”ê°€\nkubectl annotate deployment secret-rotation-test-ubuntu-deployment \"reloader.stakater.com/auto=true\"\n```\n\në˜ëŠ” ë‹¤ìŒ ë¸”ë¡ìœ¼ë¡œ ë°°í¬ íŒŒì¼ì„ í¸ì§‘í•˜ê³  ì ìš©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.\n\n```js\nmetadata:\n  annotations:\n    reloader.stakater.com/auto: \"true\"\n```\n\n2. AWS Secret Managerì—ì„œ ì‹œí¬ë¦¿ ì—…ë°ì´íŠ¸í•˜ê¸°\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\r\naws secretsmanager put-secret-value \\\n      --secret-id my-test-secret \\\n      --secret-string \"{\\\"user\\\":\\\"diegor\\\",\\\"password\\\":\\\"SAMPLE-PASSWORD\\\"}\"\r\n```\n\n3. í•œ ë²ˆ ì‹œí¬ë¦¿ì´ AWS ì‹œí¬ë¦¿ ìŠ¤í† ì–´ csi ë“œë¼ì´ë²„ì— ì—…ë°ì´íŠ¸ë˜ë©´ K8s ì‹œí¬ë¦¿ì´ ì¦‰ì‹œ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤. K8s ì‹œí¬ë¦¿ì´ ì—…ë°ì´íŠ¸ë˜ë©´ Reloaderê°€ ë¡¤ì•„ì›ƒì„ ë‹¤ì‹œ ì‹œì‘í•˜ë„ë¡ íŠ¸ë¦¬ê±°í•©ë‹ˆë‹¤.\n\n```js\r\n# K8s ì‹œí¬ë¦¿ì„ í™•ì¸í•˜ì„¸ìš”. ìƒˆë¡œìš´ ê°’ì´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.\nkubectl get secret my-test-k8s-secret -o yaml\n\n# Podë¥¼ í™•ì¸í•˜ì„¸ìš”. ëª‡ ì´ˆ ì „ì— ì‹œì‘ë˜ì—ˆì–´ì•¼ í•©ë‹ˆë‹¤.\nkubectl get po\n\n# Reloader íŒŸì˜ ë¡œê·¸ë¥¼ í™•ì¸í•˜ì„¸ìš”.\nkubectl logs \u003creloader-pod-name\u003e -n kube-system\n\n# Podë¡œ ì‹¤í–‰ í›„ ìƒˆë¡œìš´ ê°’ì„ í™•ì¸í•˜ì„¸ìš”.\nkubectl exec -it \u003cpod_name\u003e -- bash\n\n# Podì— ë“¤ì–´ê°„ í›„ `env` ëª…ë ¹ì„ ì‹¤í–‰í•˜ì„¸ìš”. Podì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ ëª¨ë“  í™˜ê²½ ë³€ìˆ˜ê°€ ì¶œë ¥ë©ë‹ˆë‹¤.\r\n```\n\n# ë‹¨ê³„ 8: ConfigMap ì—…ë°ì´íŠ¸ë¥¼ í…ŒìŠ¤íŠ¸í•˜ì„¸ìš”.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n- \"my-test-cm-manifest.yaml\" íŒŒì¼ì„ ìƒì„±í•´ì£¼ì„¸ìš”.\n\n```yaml\n---\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: my-test-k8s-cm\ndata:\n  myvalue: \"Hello World\"\n  drink: coffee\n---\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: reloader-poc-ubuntu-deployment\n  labels:\n    app: ubuntu\n  annotations:\n    reloader.stakater.com/auto: \"true\"\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: ubuntu\n  template:\n    metadata:\n      labels:\n        app: ubuntu\n    spec:\n      containers:\n      - name: ubuntu\n        image: ubuntu\n        command: [\"sleep\", \"123456\"]\n        env:\n        - name: DRINK\n          valueFrom:\n            configMapKeyRef:\n              name: my-test-k8s-cm\n              key: drink\n        - name: MYVALUE\n          valueFrom:\n            configMapKeyRef:\n              name: my-test-k8s-cm\n              key: myvalue\n```\n\n2. ë§¤ë‹ˆí˜ìŠ¤íŠ¸ ì ìš©\n\n```bash\nkubectl apply -f my-test-cm-manifest.yaml\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n3. my-test-cm-manifest.yaml íŒŒì¼ì—ì„œ configmapì„ ì—…ë°ì´íŠ¸í•˜ì„¸ìš”.\n\n```yaml\n---\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: my-test-k8s-cm\ndata:\n  myvalue: \"ì•ˆë…•í•˜ì„¸ìš”\"\n  drink: ì°¨\n```\n\n4. íŒŒì¼ì„ ë‹¤ì‹œ ì ìš©í•˜ì„¸ìš”.\n\n```yaml\nkubectl apply -f my-test-cm-manifest.yaml\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n5. í™•ì¸\n\n```js\n# ConfigMap í™•ì¸\nkubectl get cm my-test-k8s-cm -o yaml\n\n# Pod í™•ì¸\nkubectl get po\n\n# Podì— ì ‘ì†í•˜ì—¬ ìƒˆ ê°’ í™•ì¸\nkubectl exec -it \u003cpod_name\u003e -- bash\n\n# Podì— ë“¤ì–´ê°„ í›„ `env` ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ë©´ Pod ë‚´ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ ëª¨ë“  í™˜ê²½ ë³€ìˆ˜ê°€ ì¶œë ¥ë©ë‹ˆë‹¤\n```\n\nì¶•í•˜í•©ë‹ˆë‹¤!!! secret-store-csi-driverì™€ reloaderë¥¼ ì„±ê³µì ìœ¼ë¡œ êµ¬ì„±í–ˆìŠµë‹ˆë‹¤.\n\nê°ì‚¬í•©ë‹ˆë‹¤!!!\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n## ì°¸ê³  ìë£Œ:\n\n- [AWS ê³µì‹ ë¬¸ì„œ - CSI ë“œë¼ì´ë²„ í†µí•©](https://docs.aws.amazon.com/secretsmanager/latest/userguide/integrating_csi_driver.html)\n- [Bootlabs ê¸°ìˆ  ë¸”ë¡œê·¸ - AWS Secrets Manager in Kubernetes ì‹œí¬ë¦¿ íšŒì „ê³¼ ë¦¬ë¡œë”](https://blog.bootlabstech.com/aws-secrets-manager-in-kubernetes-secret-rotation-and-reloader)\n- [Secrets Store CSI ë“œë¼ì´ë²„ ê³µì‹ í™ˆí˜ì´ì§€ - ì‹œí¬ë¦¿ ìë™ íšŒì „](https://secrets-store-csi-driver.sigs.k8s.io/topics/secret-auto-rotation)\n- [Secrets Store CSI ë“œë¼ì´ë²„ ì°¨íŠ¸ ê°’ ì„¤ì • íŒŒì¼](https://github.com/kubernetes-sigs/secrets-store-csi-driver/blob/main/charts/secrets-store-csi-driver/values.yaml)\n- [Reloader GitHub ì €ì¥ì†Œ](https://github.com/stakater/Reloader/tree/master)\n- [Reloader ì‘ë™ í™•ì¸ ë¬¸ì„œ](https://github.com/stakater/Reloader/blob/master/docs/Verify-Reloader-Working.md)\n- [Reloader ì‘ë™ ë°©ì‹ ë¬¸ì„œ](https://github.com/stakater/Reloader/blob/master/docs/How-it-works.md)\n\n# ê°„ë‹¨íˆ ë§í•˜ìë©´ ğŸš€\n\nIn Plain English ì»¤ë®¤ë‹ˆí‹°ì˜ ì¼ì›ì´ ë˜ì–´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤! ê³„ì† ì°¸ì—¬í•´ ì£¼ì„¸ìš”:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n- ì‘ê°€ì—ê²Œ ë°•ìˆ˜ë¥¼ ë³´ë‚´ê³  íŒ”ë¡œìš°ë¥¼ ëˆŒëŸ¬ì£¼ì„¸ìš” ï¸ğŸ‘ï¸ï¸\n- íŒ”ë¡œìš°í•˜ê¸°: X | LinkedIn | YouTube | Discord | Newsletter\n- ë‹¤ë¥¸ í”Œë«í¼ì—ì„œ ì €í¬ë¥¼ ë§Œë‚˜ë³´ì„¸ìš”: Stackademic | CoFeed | Venture | Cubed\n- ì•Œê³ ë¦¬ì¦˜ ì½˜í…ì¸ ë¥¼ ë‹¤ë¤„ì•¼ í•˜ëŠ” ë¸”ë¡œê·¸ í”Œë«í¼ì— ì§€ì³¤ë‚˜ìš”? Differë¥¼ ì‹œë„í•´ë³´ì„¸ìš”\n- PlainEnglish.ioì—ì„œ ë” ë§ì€ ì½˜í…ì¸ ë¥¼ ë§Œë‚˜ë³´ì„¸ìš”","ogImage":{"url":"/assets/img/2024-06-19-KubernetesAutoRestartDeploymentswhenK8sConfigMaporSecretisUpdated_0.png"},"coverImage":"/assets/img/2024-06-19-KubernetesAutoRestartDeploymentswhenK8sConfigMaporSecretisUpdated_0.png","tag":["Tech"],"readingTime":13},{"title":"ì•„ë§ˆì¡´ EKSì˜ ë¯¸ë˜","description":"","date":"2024-06-19 13:10","slug":"2024-06-19-FutureofAmazonEKS","content":"\n\nAWS re:Invent 2023 ì„¸ì…˜ ì¤‘ \"Amazon EKSì˜ ë¯¸ë˜ (CON203)\"ë¥¼ Nathan Taber, AWSì˜ Kubernetes ì œí’ˆ ì´ê´„ì˜ í”„ë ˆì  í…Œì´ì…˜ì„ ì‹œì²­í•´ì•¼ í–ˆì–´ìš”. ì´ ê¸°ì‚¬ì—ì„œëŠ” ë…¼ì˜ëœ ì£¼ìš” í¬ì¸íŠ¸ë“¤ì„ ìš”ì•½í•˜ê² ìœ¼ë©°, ì´í•´ë¥¼ ë•ê¸° ìœ„í•´ ì „ì²´ ë‚´ìš©ì„ í™•ì¸í•´ ë³´ë¼ëŠ” ì£¼ì˜ë¬¸ì„ ë‹´ì„ê²Œìš”.\n\n# Kubernetesì˜ ì¤‘ìš”ì„±\n\nKubernetesëŠ” ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ì„ ìœ„í•œ ì˜¤í”ˆ ì†ŒìŠ¤ ê¸°ìˆ ë¡œ, ì¸ê¸°ë§Œ ëŒ ë¿ë§Œ ì•„ë‹ˆë¼ ì—„ì²­ë‚œ ì„±ê³µì„ ê±°ë‘ì—ˆì–´ìš”. Kubernetesì˜ ê´€ë¦¬ ì¡°ì§ì¸ Cloud Native Computing Foundation (CNCF)ì˜ ì„¤ë¬¸ ì¡°ì‚¬ì— ë”°ë¥´ë©´, ì§€ë‚œ í•´ 64%ì˜ ê¸°ì—…ì´ í”„ë¡œë•ì…˜ì—ì„œ Kubernetesë¥¼ ì‚¬ìš©í–ˆìœ¼ë©°, ì¶”ê°€ 25%ê°€ í‰ê°€ ì¤‘ì´ê±°ë‚˜ ì‹œë²”ìš´ì˜ ì¤‘ì´ì—ˆì–´ìš”. ì´ëŸ¬í•œ ì¤‘ìš”í•œ ì±„ìš©ì€ Kubernetesê°€ í˜„ëŒ€ IT ìš´ì˜ì—ì„œ ë°œíœ˜í•˜ëŠ” ì¤‘ì¶”ì  ì—­í• ì„ ë°˜ì˜í•˜ê³  ìˆì–´ìš”. ì´ ê¸°ì‚¬ì—ì„œëŠ” ì´ ì¸ê¸° ê¸‰ì¦ì˜ ì´ìœ ì™€ AWSê°€ Amazon EKSì— íˆ¬ìí•œ ë°©ëŒ€í•œ íˆ¬ìë¥¼ íƒêµ¬í•´ ë³´ê² ì–´ìš”.\n\n## ê·¸ë ‡ë‹¤ë©´, ì™œ ì‚¬ëŒë“¤ì€ Kubernetesë¥¼ ì‚¬ìš©í• ê¹Œìš”?\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n- í˜ì‹  ì£¼í–‰: ê¸°ê´€ì´ Kubernetesë¡œ ì „í™˜í•˜ëŠ” ì£¼ìš” ì´ìœ ëŠ” ê³ ê°ì„ ëŒ€ì‹ í•˜ì—¬ í˜ì‹ ì„ ì´ë£¨ëŠ” ë° ìˆìŠµë‹ˆë‹¤. ë¹ ë¥´ê²Œ ì›€ì§ì´ê³  ì•ˆì „í•˜ê³  ì‹ ì†í•˜ê²Œ ë³€í™”ë¥¼ì£¼ëŠ” ëŠ¥ë ¥ì€ í˜ì‹ ì— ëŒ€ë‹¨íˆ ì¤‘ìš”í•©ë‹ˆë‹¤. KubernetesëŠ” ê°œë°œíŒ€ì„ìœ„í•œ í‘œì¤€ ì‹œìŠ¤í…œê³¼ í‘œì¤€ ì„¸íŠ¸ë¥¼ ì œê³µí•˜ì—¬ ì¡°ì§ì´ ë³€í™”ë¥¼ ìˆ˜ìš©í•˜ê³  ì‚¬ìš©ìë¥¼ìœ„í•œ ë” ë‚˜ì€ í˜ì‹ ì„ ì´ëŒì–´ ë‚´ë„ë¡í•©ë‹ˆë‹¤.\n- ê³ ì • ë¹„ìš© ê°ì†Œ: Kubernetes ë„ì…ì˜ ë˜ ë‹¤ë¥¸ ì£¼ìš” ë™ê¸°ëŠ” ê³ ì • ë¹„ìš©ì„ ì¤„ì´ê¸° ìœ„í•œ ìš•êµ¬ì…ë‹ˆë‹¤. ì¡°ì§ì€ ì •ì  ìì›ì—ì„œ ë™ì  ê³µìœ  ìì›ìœ¼ë¡œ ì „í™˜í•˜ì—¬ ì»¨í…Œì´ë„ˆë¥¼ ì‚¬ìš©í•˜ì—¬ ë³µì¡í•œ ê³„ì•½ì„ ë¶„í•´í•˜ê³  ê´€ë¦¬ ì˜¤ë²„í—¤ë“œë¥¼ ì¤„ì…ë‹ˆë‹¤. ì´ëŸ¬í•œ ì „í™˜ì€ ë¹„ìš© ì ˆê°ì„ ê°€ì ¸ì˜¤ë©´ì„œ ìœ ì—°ì„±ê³¼ í™•ì¥ì„±ì„ ìœ ì§€í•©ë‹ˆë‹¤.\n- ì „ì²´ ì¡°ì§ í™œì„±í™”: KubernetesëŠ” ì‘ìš© í”„ë¡œê·¸ë¨ì„ ì¡°ì •í•˜ê¸° ìœ„í•œ API í‘œì¤€ì„ ì œê³µí•˜ì—¬ ë‹¤ì–‘í•œ í™˜ê²½ì— ëŒ€í•œ ê³µí†µ ê¸°ë°˜ì„ ì œê³µí•©ë‹ˆë‹¤. AWS í´ë¼ìš°ë“œì˜ ì„œë¡œ ë‹¤ë¥¸ ì§€ì—­, ì˜¨í”„ë ˆë¯¸ìŠ¤ ë˜ëŠ” ë‹¤ë¥¸ í´ë¼ìš°ë“œ ì œê³µ ì—…ì²´ì—ì„œ ì‹¤í–‰ ì¤‘ì´ë“  ìƒê´€ì—†ì´ Kubernetesë¥¼ ì‚¬ìš©í•˜ë©´ ì¡°ì§ì´ ëª¨ë“  ë°°í¬ ìœ„ì¹˜ì—ì„œ ì¼ê´€ë˜ê²Œ ìµœìƒì˜ ë°©ë²•, ê±°ë²„ë„ŒìŠ¤ ì»¨íŠ¸ë¡¤, ë³´ì•ˆ ì¡°ì¹˜, ëª¨ë‹ˆí„°ë§ ë° ë¹„ìš© ê´€ë¦¬ë¥¼ ìˆ˜ë¦½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ í‘œì¤€í™”ëŠ” ì¡°ì§ì´ ì¸ìˆ˜, í•©ë³‘ ë˜ëŠ” ë©€í‹° í´ë¼ìš°ë“œ ì„¤ì •ê³¼ ê°™ì€ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œë„ ë³µì¡ì„±ì„ ê´€ë¦¬í•  ìˆ˜ ìˆë„ë¡í•©ë‹ˆë‹¤.\n- ë¯¸ë˜ë¥¼ ëŒ€ë¹„í•˜ê³  ìœ„í—˜ ê°ì†Œ: KubernetesëŠ” ì¦‰ê°ì ì¸ ìš´ì˜ ìš”êµ¬ ì‚¬í•­ë¿ë§Œ ì•„ë‹ˆë¼ ë¯¸ë˜ë¥¼ ëŒ€ë¹„í•˜ê³  ìœ„í—˜ì„ ê°ì†Œí•˜ëŠ” ë°ë„ ë„ì›€ì„ ì¤ë‹ˆë‹¤. Kubernetesì—ì„œ ì œê³µí•˜ëŠ” í‘œì¤€ì€ ì¥ê¸° ê°œë°œ ë…¸ë ¥ì„ ì§€ì›í•˜ê³  ê¸°ìˆ  ë¶€ì±„ë¥¼ ì™„í™”í•©ë‹ˆë‹¤. ì´ëŠ” CEO ë° CTOë¿ë§Œ ì•„ë‹ˆë¼ ì—”ì§€ë‹ˆì–´ ë° ê°œë°œíŒ€ì—ê²Œë„ ì¤‘ìš”í•œ ë¬¸ì œì…ë‹ˆë‹¤.\n\nAWSì˜ Kubernetes íˆ¬ì: 5ì£¼ë…„ì„ ì¶•í•˜í•˜ëŠ” Amazon EKSëŠ” AWSì˜ Kubernetesì— ëŒ€í•œ ì¤‘ìš”í•œ íˆ¬ìë¥¼ ëŒ€í‘œí•©ë‹ˆë‹¤. AWSëŠ” EKSë¥¼ ê°•ë ¥í•œ í”Œë«í¼ìœ¼ë¡œ ë§Œë“¤ê¸° ìœ„í•´ ì„±ì‹¤íˆ ë…¸ë ¥í•˜ê³  ì„±ëŠ¥, ê·œëª¨, ì‹ ë¢°ì„± ë° ê°€ìš©ì„±ì—ì„œ ë›°ì–´ë‚©ë‹ˆë‹¤. CNCF ë° AWS ê³ ê°ì˜ ë°ì´í„°ì— ë”°ë¥´ë©´, AWSì—ì„œå®Ÿè¡Œë˜ëŠ” Kubernetes ì›Œí¬ë¡œë“œê°€ ë‹¤ë¥¸ ëª¨ë“  í”Œë«í¼ë³´ë‹¤ ë§ì´ ìˆìœ¼ë©°, ë§¤ì£¼ ìˆ˜ì‹­ì–µ ê°œì˜ EC2 ì¸ìŠ¤í„´ìŠ¤ ì‹œê°„ì´ EKSì—ì„œ ì‹¤í–‰ë©ë‹ˆë‹¤.\n\n## EKSì—ì„œ ê³ ê°ë“¤ì´ ë¬´ì—‡ì„í•˜ê³  ìˆì„ê¹Œìš”?\n\nê³ ê°ë“¤ì€ EKSë¥¼ ë‹¤ì–‘í•œ ëª©ì ìœ¼ë¡œ í™œìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. í™œë™ ë²”ìœ„ëŠ” ë ˆê±°ì‹œ .NET ë° Java ì‘ìš© í”„ë¡œê·¸ë¨ì„ í´ë¼ìš°ë“œë¡œ ì´ì „í•˜ê³  ë°ì´í„° ì²˜ë¦¬ ì‘ì—…ì„ ì‹¤í–‰í•˜ë©° ì‹¤ì‹œê°„ ë°±ì—”ë“œë¥¼ êµ¬ì¶•í•˜ê³  ì›¹ í”„ë¡ íŠ¸ ì—”ë“œë¥¼ ê°œë°œí•˜ëŠ” ë“± ë‹¤ì–‘í•©ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nìš”ì¦˜ì—ëŠ” EKSì™€ Kubernetesë¥¼ í™œìš©í•œ ê¸°ê³„ í•™ìŠµê³¼ AIì˜ ì¤‘ìš”ì„±ì´ í¬ê²Œ ëŠ˜ì–´ë‚¬ìŠµë‹ˆë‹¤. ìƒì„±ì  AIì™€ ë¡œë´‡ê³µí•™ê³¼ ê°™ì€ ë‹¤ì–‘í•œ ë¶„ì•¼ë¥¼ ë‹¤ë£¨ë©°, íŠ¹íˆ ì €ëŠ” ììœ¨ ì£¼í–‰ ì°¨ëŸ‰ì— íŠ¹íˆ í¥ë¯¸ë¥¼ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. EKSì—ì„œ ì¤‘ìš”í•œ ììœ¨ ì£¼í–‰ ì°¨ëŸ‰ í›ˆë ¨ í™œë™ì´ ì§„í–‰ ì¤‘ì´ë¼ëŠ” ì ì„ ê°•ì¡°í•˜ê³  ì‹¶ìŠµë‹ˆë‹¤. ê¸°ê³„ í•™ìŠµ, kube ray, Spark, kube flowì™€ ê°™ì€ ë„êµ¬ë¥¼ í™œìš©í•˜ì—¬ ë¯¸ë˜ ê¸°ìˆ ì„ ê°œë°œ ì¤‘ì¸ ê¸°ì—…ë“¤ì„ ê´€ì°°í•˜ëŠ” ê²ƒì€ í˜„ì¬ì˜ í™˜ê²½ì—ì„œ ì£¼ëª©í•  ë§Œí•˜ê³  í¥ë¯¸ë¡œìš´ ì¸¡ë©´ì…ë‹ˆë‹¤.\n\n## Kubernetes ìš´ì˜ ì²´ì œ\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-19-FutureofAmazonEKS_0.png)\n\nì¸í”„ë¼ ì¡°ì‚¬ì—ì„œ Kubernetesê°€ í•µì‹¬ì ì¸ ì—­í• ì„ í•˜ëŠ” ë³µì¡í•œ ê³„ì¸µì„ ê´€ì°°í•˜ë©°, ë‹¤ì–‘í•œ ì¸í”„ë¼ ìš”ì†Œë¥¼ ì¡°ìœ¨í•˜ì—¬ ì›í™œí•˜ê²Œ í†µí•©í•˜ëŠ” ëª¨ìŠµì„ ë³´ê²Œ ë©ë‹ˆë‹¤. ê³ ê°ë“¤ì€ Kubernetes ìœ„ì— ë°°í¬, ê´€ì¸¡, ê±°ë²„ë„ŒìŠ¤, íŠ¸ë˜í”½ ì œì–´, ë³´ì•ˆ ì œì–´ë¥¼ ì¶”ê°€í•˜ì—¬ ì ê·¹ ì°¸ì—¬í•˜ê³  ìˆìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\në†€ëê²Œë„ CNCF ë‚´ì—ì„œ 599ê°œì˜ í”„ë¡œì íŠ¸ê°€ Kubernetes ë‚´ë¶€ ë˜ëŠ” ì˜†ì—ì„œ ì‹¤í–‰ë©ë‹ˆë‹¤. ì´ ì¤‘ 173ê°œ í”„ë¡œì íŠ¸ëŠ” CNCFë¡œë¶€í„° ì§ì ‘ ì§€ë„ ë°›ëŠ” ê°œë°©í˜• ì§€ë°°ë¥¼ ê°–ê³  ìˆìŠµë‹ˆë‹¤. Kubernetes ìœ„ì— ì´ëŸ¬í•œ ë°©ëŒ€í•œ í”Œë«í¼ ë ˆì´ì–´ë¥¼ ê´€ë¦¬í•˜ëŠ” ê²ƒì€ ìƒë‹¹í•œ ì¼ì´ì£ .\n\nê²Œë‹¤ê°€ AWSëŠ” ìì‚¬ì˜ ì„œë¹„ìŠ¤ê°€ Kubernetesë¡œì˜ ê¸°ëŠ¥ ì œê³µì„ ì›í™œí•˜ê²Œ í•˜ëŠ” í†µí•©ì„ ê°œë°œí•˜ê¸° ìœ„í•´ ì ê·¹ì ìœ¼ë¡œ ë…¸ë ¥í•˜ê³  ìˆìŠµë‹ˆë‹¤. ë˜í•œ, í†µí•© ê°œë°œì í”Œë«í¼(IDP)ì´ Kubernetesì—ì„œ ì‘ìš© í”„ë¡œê·¸ë¨ì„ íŒ¨í‚¤ì§•í•˜ê³  ì‹¤í–‰í•˜ë©°, ë°ì´í„° ì²˜ë¦¬ ì‘ì—…ì„ ì¡°ì •í•˜ê³ , ê¸°ê³„ í•™ìŠµ ì›Œí¬í”Œë¡œë¥¼ ê´€ë¦¬í•˜ëŠ” ë° ì¤‘ìš”í•´ì§‘ë‹ˆë‹¤. ì´ ë‹¤ì–‘í•œ ë ˆì´ì–´ë¥¼ í†µí•´ íƒìƒ‰ì´ ì§„í–‰ë¨ì— ë”°ë¼ ê³ ê° ê²½í—˜ í–¥ìƒê³¼ í¬ì¥, ì»¨í…Œì´ë„ˆ, ì‹¤í–‰ ìƒíƒœê³„ ë‚´ì—ì„œ í”„ë¡œì„¸ìŠ¤ë¥¼ ì •êµí™”í•˜ëŠ” ë° ì´ˆì ì´ ë§ì¶°ì§‘ë‹ˆë‹¤.\n\n## AWS Kubernetesì˜ ëª©í‘œ\n\n- ì°¨ë³„í™”ë˜ì§€ ì•Šì€ ë¬´ê±°ìš´ ì‘ì—… ì œê±°:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n- AWSì—ì„œ Kubernetesë¥¼ ê´€ë¦¬í•˜ëŠ” ë° ì—°ê´€ëœ ë§‰ê±°ìš´ ë¬´ê±°ìš´ ì‘ì—…ì˜ ë¶€ë‹´ì—ì„œ í•´ë°©ëœ ê³ ê°ë“¤.\n- ìš´ì˜ ë³µì¡ì„±ì´ ì²˜ë¦¬ë˜ì–´ ì‚¬ìš©ìë“¤ì´ í•µì‹¬ ì—­ëŸ‰ì— ì´ˆì ì„ ë§ì¶”ê³  ë£¨í‹´ì ì¸ ì‘ì—… ê´€ë¦¬ì— ê´€ì—¬í•˜ëŠ” ëŒ€ì‹ ì— ë°©í–¥ì„ ì „í™˜í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤.\n\n2. ì‘ì—… ë‹¨ìˆœí™” ë° ì•¡ì„¸ìŠ¤ ë¶€ì—¬:\n\n- AWSì—ì„œ Kubernetes ê²½í—˜ì„ ë‹¨ìˆœí™”í•˜ì—¬ ì‚¬ìš©ìë“¤ì—ê²Œ ê°„ì†Œí™”ë˜ê³  ì‚¬ìš©ì ì¹œí™”ì ì¸ í™˜ê²½ì„ ì œê³µí•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤.\n- ì‚¬ìš©ìë“¤ì—ê²Œ í´ë¼ìš°ë“œì˜ ê·œëª¨, ì•ˆì •ì„±, ë³´ì•ˆì— ëŒ€í•œ ì™„ì „í•œ ì•¡ì„¸ìŠ¤ ê¶Œí•œì´ ë¶€ì—¬ë˜ë©°, ìš´ì˜ í™˜ê²½ì´ ì›í™œí•˜ê³  íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬ë˜ë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤.\n\n3. ì˜¤í”ˆ ì†ŒìŠ¤ í‘œì¤€ì˜ ê³„ì†ì ì¸ ìœ ì§€:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n- ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ ì˜¤í”ˆ ì†ŒìŠ¤ í‘œì¤€ì„ ê³„ì†í•´ì„œ ìœ ì§€ë³´ìˆ˜í•©ë‹ˆë‹¤.\n- ì´ëŠ” CNCF ë‚´ 599ê°œ í”„ë¡œì íŠ¸ì™€ì˜ í˜¸í™˜ì„±ì„ ë³´ì¥í•˜ë©° ë¹ ë¥¸ í˜ì‹ ì„ ê°€ëŠ¥í•˜ê²Œ í•˜ê³  ì»¤ë®¤ë‹ˆí‹° ë° íŒŒíŠ¸ë„ˆì˜ ìƒˆë¡œìš´ ê°œë°œì— ì ‘ê·¼í•˜ë©° ì»¤ë®¤ë‹ˆí‹° í‘œì¤€ì˜ ê³„ì†ëœ í–¥ìƒì„ ë„ì™€ì¤ë‹ˆë‹¤.\n\n## AWSê°€ ì–´ë–»ê²Œ Kubernetesë¥¼ ì§€ì›í•˜ë‚˜ìš”\n\nAWS ìƒíƒœê³„ ë‚´ì—ì„œ Kubernetesì— ëŒ€í•œ í¬ê´„ì ì¸ ì§€ì›ì— ì°¸ì—¬í•˜ê³  ìˆëŠ” Amazon EKSëŠ” ê´€ë¦¬ ë²„í‚·ì—ì„œ ì¤‘ìš”í•œ ìš”ì†Œë¡œ ë‘ë“œëŸ¬ì§‘ë‹ˆë‹¤. Kubernetesì— ëŒ€í•œ AWSì˜ ì•½ì†ì˜ ì¤‘ì‹¬ ì—­í• ì„ í•˜ëŠ” EKSëŠ” ê³ ê°ì— ê²¬ê³ í•˜ê³  íš¨ìœ¨ì ì¸ Kubernetes ê´€ë¦¬ ì†”ë£¨ì…˜ì„ ì œê³µí•˜ëŠ” ì˜ì§€ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤. EKS ì™¸ì—ë„ AWSëŠ” Kubernetes ë°°í¬ì˜ ê°œë°œ, Kubernetesì™€ AWS êµ¬ì„± ìš”ì†Œ ê°„ì˜ ì—°ê²°ì„ ìš©ì´í•˜ê²Œ í•´ì£¼ëŠ” ë‹¤ì–‘í•œ ë°©ì‹ì„ ì œê³µí•˜ë©° ìƒë¥˜ ê°œë°œì— ì ê·¹ì ìœ¼ë¡œ ì°¸ì—¬í•¨ìœ¼ë¡œì¨ í¬ìš©í•©ë‹ˆë‹¤.\n\nAWS íŒ€ì€ CNCFì˜ ë³´ì•ˆ í˜‘ì˜íšŒ ë° Kubernetes í”„ë¡œì íŠ¸ì— ê¸°ì—¬í•¨ìœ¼ë¡œì¨ ì•ˆì „ì— ëŒ€í•œ ì•½ì†ì„ í™•ì¥í•˜ê³  ê²¬ê³ í•œ ì•ˆì „ ì¡°ì¹˜ë¥¼ ë³´ì¥í•©ë‹ˆë‹¤. ë”ë¶ˆì–´ AWSëŠ” ê³µë™ ë¹„ìš© ì ˆê° ë° ê³µìœ  ë¦¬ì†ŒìŠ¤ì˜ ê°€ìš©ì„± í–¥ìƒì— ê¸°ì—¬í•˜ëŠ” ì»¤ë®¤ë‹ˆí‹° í”„ë¡œì íŠ¸ì— ê¸ˆìœµì  ì§€ì›ì„ ì œê³µí•¨ìœ¼ë¡œì¨ ì¤‘ìš”í•œ ì—­í• ì„ í•©ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n## ì–´ë””ì„œë‚˜ Kubernetes ì‹¤í–‰í•˜ê¸°\n\n![Future of Amazon EKS](/assets/img/2024-06-19-FutureofAmazonEKS_1.png)\n\nEKSë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ, AWSì—ì„œì˜ Kubernetes ì œê³µì€ ë‹¤ì–‘í•œ í™˜ê²½ìœ¼ë¡œ í™•ì¥ë˜ì—ˆìŠµë‹ˆë‹¤. EKSëŠ” ìš°ë¦¬ì˜ Distro ë° EKS Anywhereì— ê±¸ì³ í¼ì ¸ ìˆìœ¼ë©° ì˜¨-í”„ë ˆë¯¸ìŠ¤ Kubernetes ë°°í¬ë¥¼ ìœ„í•œ íˆ´ ì²´ì¸ì„ í¬í•¨í•©ë‹ˆë‹¤. ì „í†µì ì¸ AWS ì§€ì—­ì„ ë„˜ì–´, EKSëŠ” Snow, Outposts, ë¡œì»¬ ì¡´ ë° íŒŒì¥ê¹Œì§€ ë‹¤ì–‘í•œ í™˜ê²½ì— í™•ì¥ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ ë°©ëŒ€í•œ ì»¤ë²„ë¦¬ì§€ëŠ” ì‚¬ìš©ìê°€ AWS ì¸í”„ë¼ ë˜ëŠ” ë‹¤ì–‘í•œ ì˜¨-í”„ë ˆë¯¸ìŠ¤ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ Kubernetesë¥¼ ì‹¤í–‰í•˜ë”ë¼ë„ ì¼ê´€ë˜ê³  ì„±ëŠ¥ ì¢‹ì€ Kubernetes ê²½í—˜ì„ ì‰½ê²Œ ì–»ì„ ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤. AWSì˜ ëª©í‘œëŠ” ì‚¬ìš©ìì—ê²Œ ìœ ì—°í•œ ì˜µì…˜ì„ ì œê³µí•˜ì—¬ ì„ íƒí•œ ë°°í¬ í™˜ê²½ì— ê´€ê³„ì—†ì´ ì¼ê´€ë˜ê³  ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” Kubernetes ê²½í—˜ì„ ë³´ì¥í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.\n\n# EKS 5ì£¼ë…„\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì§€ë‚œ 5ë…„ ë™ì•ˆ ì´ ì œí’ˆì— íˆ¬ìëœ ìƒë‹¹í•œ ê°œë°œì„ ë˜ëŒì•„ë³´ë©´, 2018ë…„ EKS ë°œí‘œ ì´í›„ 222ë²ˆ ì´ìƒì˜ ë‹¤ì–‘í•œ ëŸ°ì¹­ì´ ì§„í–‰ë˜ì—ˆë‹¤ëŠ” ì‚¬ì‹¤ì„ ê°•ì¡°í•´ì•¼ í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ëŸ°ì¹­ì€ ê°€ê²© ì¸í•˜ì™€ ê·œì • ì¤€ìˆ˜ ì¡°ì¹˜ë¶€í„° ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ ì‹œì‘, í´ëŸ¬ìŠ¤í„° ìƒì„± ì‹œê°„ ê°€ì†í™”, ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤ ë° ì§€ì—­ ì§€ì› ì¶”ê°€, ì¤‘ìš”í•œ ê¸°ëŠ¥ ë„ì…ê¹Œì§€ ë‹¤ì–‘í•œ í–¥ìƒì„ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤. \n\në…¸ë°” ë¼ì¼ë¼íˆ´ ë¦¬ì¦ˆí‚¤ì•„","ogImage":{"url":"/assets/img/2024-06-19-FutureofAmazonEKS_0.png"},"coverImage":"/assets/img/2024-06-19-FutureofAmazonEKS_0.png","tag":["Tech"],"readingTime":5},{"title":"ì¿ ë²„ë„¤í‹°ìŠ¤ x509 ì¸ì¦ì„œê°€ ë§Œë£Œë˜ì—ˆê±°ë‚˜ ì•„ì§ ìœ íš¨í•˜ì§€ ì•ŠìŒ ì˜¤ë¥˜","description":"","date":"2024-06-19 13:09","slug":"2024-06-19-Kubernetesx509certificatehasexpiredorisnotyetvaliderror","content":"\n\n\n\u003cimg src=\"/assets/img/2024-06-19-Kubernetesx509certificatehasexpiredorisnotyetvaliderror_0.png\" /\u003e\n\në§Œì•½ ì˜ ì‘ë™ë˜ë˜ ì¿ ë²„ë„¤í‹°ìŠ¤ í™˜ê²½ì—ì„œ ê°‘ìê¸° \"x509: certificate has expired or is not yet valid\" ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤ë©´ ì–´ë–»ê²Œ í•˜ì‹œê² ì–´ìš”?\n\nì˜¤ëŠ˜ ë‚˜ì—ê²Œ ì¼ì–´ë‚œ ê²ƒê³¼ ë˜‘ê°™ì´ìš”. ì €ë„ ì´ ì˜¤ë¥˜ë¥¼ ê²½í—˜í–ˆì–´ìš”. ì™œ ë‚˜íƒ€ë‚˜ëŠ”ì§€ë„ ëª¨ë¥´ëŠ”ë°, ë­”ê°€ ì¡°ì¹˜ë¥¼ ì·¨í•˜ì§€ ì•Šì€ ìƒíƒœì—ì„œ ë°œìƒí•œ ë¬¸ì œì˜€ì£ !\n\nì €ëŠ” ì¸ì¦ì„œ ë§Œë£Œ ë¬¸ì œë¼ê³  ì•Œê³  ìˆì—ˆì§€ë§Œ, ë¬¸ì œë¥¼ ì–´ë–»ê²Œ í•´ê²°í• ì§€ ì•Œë ¤ê³  ë§ì€ ì‹œê°„ì„ ë³´ëƒˆì–´ìš”. ê·¸ë˜ì„œ ì´ ì£¼ì œì— ëŒ€í•´ ì§§ì€ ê¸°ì‚¬ë¥¼ ì¨ì„œ ì´ëŸ° ë¬¸ì œë¥¼ ê²ªëŠ” ë‹¤ë¥¸ ë¶„ë“¤ì—ê²Œ ë„ì›€ì´ ë˜ê¸¸ ë°”ë¼ëŠ” ë§ˆìŒìœ¼ë¡œ ì¤€ë¹„í–ˆì–´ìš”.\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nKubernetes ë¬¸ì„œì— ë”°ë¥´ë©´ kubeadmìœ¼ë¡œ ìƒì„±ëœ í´ë¼ì´ì–¸íŠ¸ ì¸ì¦ì„œëŠ” 1ë…„ í›„ì— ë§Œë£Œë©ë‹ˆë‹¤.\n\nê·¸ë˜ì„œ ì œê°€ ë¨¼ì € í•œ ì¼ì€:\n\n- ì¸ì¦ì„œ ì„¸ë¶€ ì •ë³´ í™•ì¸í•˜ê¸°\n\n```js\nkubeadm certs check-expiration\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n2. ê·¸ëŸ° ë‹¤ìŒ ëª¨ë“  ì¸ì¦ì„œë¥¼ ê°±ì‹ í–ˆì–´ìš”\n\n```js\nkubeadm certs renew all\n```\n\n3. ë§ˆì§€ë§‰ìœ¼ë¡œ kubeletì„ ë‹¤ì‹œ ì‹œì‘í–ˆì–´ìš”\n\n```js\nsudo systemctl restart kubelet\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\ní•˜ì§€ë§Œ, ì•„ë¬´ê²ƒë„ ë°”ë€Œì§€ ì•Šì•˜ë„¤ìš”! ê³„ì†í•´ì„œ ê°™ì€ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ê³  ìˆìŠµë‹ˆë‹¤.\n\nì—¬ê¸°ì„œ ë­”ê°€ ë¹ ì§„ ê²Œ ìˆëŠ” ê²ƒ ê°™ì•„ìš”.\n\nì´ ë¬¸ì œë¥¼ ì¡°ì‚¬í•˜ëŠ” ë° ì‹œê°„ì„ ë§ì´ ìŸì•˜ëŠ”ë°, ~/.kube/config íŒŒì¼ì„ ì‚´í´ë³´ë˜ ì¤‘ ì˜ˆì „ í´ë¼ì´ì–¸íŠ¸ ì¸ì¦ì„œ í•­ëª©ì„ ì‚¬ìš©í•˜ê³  ìˆë‹¤ëŠ” ê²ƒì„ ê¹¨ë‹¬ì•˜ì–´ìš”.\n\nê·¸ë¦¬ê³  kubeadmìœ¼ë¡œ í´ëŸ¬ìŠ¤í„°ë¥¼ êµ¬ì¶•í•  ë•Œ /etc/kubernetes/admin.confì„ /.kube/config íŒŒì¼ë¡œ ë³µì‚¬í•´ì•¼ í–ˆë‹¤ëŠ” ê²ƒì„ ê¸°ì–µí–ˆë„¤ìš”.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì¸ì¦ì„œë¥¼ ê°±ì‹ í•˜ë©´ /etc/kubernetes/admin.conf íŒŒì¼ì´ ì—…ë°ì´íŠ¸ë˜ë¯€ë¡œ, ë‹¹ì—°íˆ ë‚´ /.kube/config íŒŒì¼ë„ ê·¸ì— ë§ê²Œ ì—…ë°ì´íŠ¸í•´ì•¼ í–ˆì–´ìš”.\n\në‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ ë¬¸ì œë¥¼ í•´ê²°í–ˆì–´ìš”.\n\n```js\nsudo cp -i /etc/kubernetes/admin.conf ~/.kube/config\nsudo chown $(id -u):$(id -g) ~/.kube/config\n```\n\nì¿ ë²„ë„¤í‹°ìŠ¤ ë¬¸ì„œì— ë”°ë¥´ë©´:","ogImage":{"url":"/assets/img/2024-06-19-Kubernetesx509certificatehasexpiredorisnotyetvaliderror_0.png"},"coverImage":"/assets/img/2024-06-19-Kubernetesx509certificatehasexpiredorisnotyetvaliderror_0.png","tag":["Tech"],"readingTime":2},{"title":"DNS ì„±ëŠ¥ì„ ëª¨ë‹ˆí„°ë§í•˜ê¸° ìœ„í•´ ì•Œì•„ì•¼ í•  ëª¨ë“  ê²ƒ","description":"","date":"2024-06-19 13:07","slug":"2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance","content":"\n\n\n![CoreDNS Monitoring](/assets/img/2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance_0.png)\n\n# ğŸ“š ì†Œê°œ:\n\nDNS ì§‘ì¤‘ ì›Œí¬ë¡œë“œë¥¼ ì‹¤í–‰í•  ë•Œ ì¢…ì¢… DNS ì“°ë¡œí‹€ë§ì— ì˜í•œ ê°„í—ì ì¸ CoreDNS ì‹¤íŒ¨ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ë¬¸ì œëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì¤‘ëŒ€í•œ ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nì´ëŸ¬í•œ ì¤‘ë‹¨ì€ ì„œë¹„ìŠ¤ì˜ ì‹ ë¢°ì„±ê³¼ ì„±ëŠ¥ì— ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ëª¨ë‹ˆí„°ë§ ì†”ë£¨ì…˜ì´ í•„ìˆ˜ì ì…ë‹ˆë‹¤.\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nAWSëŠ” ëª¨ë‹ˆí„°ë§ ëª©ì ìœ¼ë¡œ í†µí•©í•  ìˆ˜ ìˆëŠ” ì˜¤í”ˆ ì†ŒìŠ¤ ë„êµ¬ì¸ CloudWatch, Fluentd ë° Grafanaë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì´ ë„êµ¬ë“¤ì€ CoreDNSë¥¼ ëª¨ë‹ˆí„°ë§í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n# Kubernetes DNS ì†Œê°œ:\n\nKubernetesëŠ” í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ ì„œë¹„ìŠ¤ ê²€ìƒ‰ì— DNSë¥¼ ì˜ì¡´í•©ë‹ˆë‹¤. íŒŸì—ì„œ ì‹¤í–‰ë˜ëŠ” ì‘ìš© í”„ë¡œê·¸ë¨ì´ ì„œë¡œ í†µì‹ í•´ì•¼ í•  ë•Œ, ê·¸ë“¤ì€ ì£¼ë¡œ IP ì£¼ì†Œê°€ ì•„ë‹Œ ë„ë©”ì¸ ì´ë¦„ì„ ì‚¬ìš©í•˜ì—¬ ì„œë¹„ìŠ¤ë¥¼ ì°¸ì¡°í•©ë‹ˆë‹¤.\n\nì´ ë•Œ Kubernetes DNSê°€ í•„ìš”í•©ë‹ˆë‹¤. ì´ëŠ” ë„ë©”ì¸ ì´ë¦„ì´ ì˜¬ë°”ë¥¸ IP ì£¼ì†Œë¡œ í•´ì„ë˜ë„ë¡ ë³´ì¥í•˜ì—¬ íŒŸê³¼ ì„œë¹„ìŠ¤ê°€ í†µì‹ í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nKubernetesì—ì„œëŠ” ê° íŒŒë“œë§ˆë‹¤ ì¼ì‹œì ì¸ IP ì£¼ì†Œê°€ í• ë‹¹ë©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì´ëŸ¬í•œ IP ì£¼ì†ŒëŠ” ë™ì ì´ë©° ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ ë³€ê²½ë  ìˆ˜ ìˆì–´, ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì´ë¥¼ ì¶”ì í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤.\n\nKubernetesëŠ” ì´ëŸ¬í•œ ë„ì „ì— ëŒ€ì‘í•˜ê¸° ìœ„í•´ íŒŒë“œì™€ ì„œë¹„ìŠ¤ì— ì™„ì „íˆ ì •ê·œí™”ëœ ë„ë©”ì¸ ì´ë¦„(FQDNs)ì„ í• ë‹¹í•©ë‹ˆë‹¤.\n\nKubernetesì˜ ê¸°ë³¸ DNS ì œê³µìì¸ CoreDNSëŠ” í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ DNS ì¿¼ë¦¬ë¥¼ ì²˜ë¦¬í•˜ëŠ” ì—­í• ì„ ë‹´ë‹¹í•©ë‹ˆë‹¤. ê·¸ëŠ” ì´ëŸ¬í•œ FQDNì„ í•´ë‹¹ IP ì£¼ì†Œë¡œ ë§¤í•‘í•˜ì—¬ íŒŒë“œì™€ ì„œë¹„ìŠ¤ ê°„ì˜ í†µì‹ ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.\n\n# ì™œ DNS ë¬¸ì œê°€ í”í• ê¹Œìš”:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\në„¤íŠ¸ì›Œí¬ ë¬¸ì œ í•´ê²° ì¤‘ ê³µí†µì ìœ¼ë¡œ ë°œìƒí•˜ëŠ” ë²ˆê±°ë¡œì›€ì˜ ì›ì¸ ì¤‘ í•˜ë‚˜ì¸ DNS ë¬¸ì œ! DNSëŠ” ì‚¬ëŒì´ ì½ê¸° ì‰¬ìš´ ë„ë©”ì¸ ì´ë¦„ì„ ê¸°ê³„ê°€ ì´í•´í•  ìˆ˜ ìˆëŠ” IP ì£¼ì†Œë¡œ ë³€í™˜í•˜ëŠ” ë° í° ì—­í• ì„ í•©ë‹ˆë‹¤.\n\nê·¸ëŸ¬ë‚˜ DNS ë¬¸ì œëŠ” ì„¤ì • ì˜¤ë¥˜, ë„¤íŠ¸ì›Œí¬ ë¬¸ì œ ë˜ëŠ” ì„œë²„ ì¥ì• ì™€ ê°™ì€ ì—¬ëŸ¬ ìš”ì¸ìœ¼ë¡œ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë„ë©”ì¸ ì´ë¦„ì„ ì˜¬ë°”ë¥´ê²Œ í•´ì„í•˜ì§€ ëª»í•  ë•Œ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì™¸ë¶€ ì„œë¹„ìŠ¤ì— ì—°ê²° ë¬¸ì œë¥¼ ê²½í—˜í•˜ê±°ë‚˜ ì•¡ì„¸ìŠ¤ì— ì‹¤íŒ¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n# ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ CoreDNS:\n\nCoreDNSëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ DNS ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ëŠ” ë° ì¤‘ìš”í•œ ì—­í• ì„ í•©ë‹ˆë‹¤. Kubernetes v1.13 ì´í›„ ê¸°ë³¸ DNS ì œê³µìë¡œ ì‚¬ìš©ë˜ì–´ ì˜¨ CoreDNSëŠ” DNS ì´ë¦„ ëŒ€ì‹  IP ì£¼ì†Œ ëŒ€ì‹  DNS ì´ë¦„ì„ ì‚¬ìš©í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë¹„ìŠ¤ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆë„ë¡ í•¨ìœ¼ë¡œì¨ í´ëŸ¬ìŠ¤í„° ë„¤íŠ¸ì›Œí‚¹ì„ ê°„ì†Œí™”í•©ë‹ˆë‹¤. ê·¸ëŠ” ë„ë©”ì¸ ì´ë¦„ ìš”ì²­ì„ í•´ê²°í•˜ê³  í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ ì„œë¹„ìŠ¤ ê²€ìƒ‰ì„ ìš©ì´í•˜ê²Œ í•©ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# ì½”ì–´ë””ì—”ì—ìŠ¤ì˜ ì‘ë™ ë°©ì‹:\n\nì½”ì–´ë””ì—”ì—ìŠ¤ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ DNS ìš”ì²­ì˜ ë¦¬ì¡¸ë²„ ë° í¬ì›Œë”ë¡œ ì‘ë™í•©ë‹ˆë‹¤. íŒŒë“œê°€ ë‹¤ë¥¸ ì„œë¹„ìŠ¤ì™€ í†µì‹ í•´ì•¼ í•  ë•Œ, ëŒ€ìƒ ì„œë¹„ìŠ¤ì˜ ë„ë©”ì¸ ì´ë¦„ì„ ì§€ì •í•˜ì—¬ DNS ì¿¼ë¦¬ë¥¼ ì½”ì–´ë””ì—”ì—ìŠ¤ì— ë³´ëƒ…ë‹ˆë‹¤. ê·¸ëŸ¼ ì½”ì–´ë””ì—”ì—ìŠ¤ëŠ” ë‚´ë¶€ ë ˆì½”ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ë„ë©”ì¸ ì´ë¦„ì„ í•´ë‹¹ IP ì£¼ì†Œë¡œ ë§¤í•‘í•˜ì—¬ ì´ ì¿¼ë¦¬ë¥¼ í•´ê²°í•©ë‹ˆë‹¤.\n\nì½”ì–´ë””ì—”ì—ìŠ¤ê°€ ê¶Œí•œì´ ì—†ëŠ” ì™¸ë¶€ ë„ë©”ì¸ ì´ë¦„ì— ëŒ€í•´ì„œëŠ”, ì´ë¥¼ ê³µê°œ ë¦¬ì¡¸ë²„ë‚˜ ìƒìœ„ DNS ì„œë²„ë¡œ ì „ë‹¬í•˜ì—¬ í•´ê²°í•©ë‹ˆë‹¤.\n\nì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¤ê³  ëŒ€ê¸° ì‹œê°„ì„ ì¤„ì´ê¸° ìœ„í•´ ì½”ì–´ë””ì—”ì—ìŠ¤ëŠ” ìì£¼ ì•¡ì„¸ìŠ¤í•˜ëŠ” ë„ë©”ì¸ ì´ë¦„ì— ëŒ€í•œ DNS ì‘ë‹µì„ ìºì‹œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ìºì‹± ë©”ì»¤ë‹ˆì¦˜ì€ DNS ì¿¼ë¦¬ì˜ ì‘ë‹µ ì†ë„ë¥¼ í–¥ìƒì‹œí‚¤ê³  ìƒìœ„ DNS ì„œë²„ì˜ ë¶€í•˜ë¥¼ ì¤„ì…ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nCoreDNSëŠ” ì´ ê¸°ëŠ¥ì„ ëª¨ë“ˆì‹ ì•„í‚¤í…ì²˜ì™€ í™•ì¥ ê°€ëŠ¥í•œ í”ŒëŸ¬ê·¸ì¸ ì‹œìŠ¤í…œì„ í†µí•´ êµ¬í˜„í•˜ë©°, ìš´ì˜ìê°€ ë…ìì ì¸ ìš”êµ¬ ì‚¬í•­ì— ë”°ë¼ DNS í•´ìƒë„ë¥¼ ì‚¬ìš©ì ì •ì˜í•˜ê³  ìµœì í™”í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤.\n\n# Amazon EKSì—ì„œì˜ CoreDNS ì“°ë¡œí‹€ë§ ì™„í™” ë°©ë²•:\n\nAmazon EKS í´ëŸ¬ìŠ¤í„°ì—ì„œ CoreDNSì™€ DNS ì“°ë¡œí‹€ë§ ë¬¸ì œëŠ” ì‹ë³„í•˜ê³  í•´ê²°í•˜ê¸° ì–´ë ¤ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë§ì€ ì‚¬ìš©ìê°€ CoreDNS ë¡œê·¸ì™€ ë©”íŠ¸ë¦­ì„ ëª¨ë‹ˆí„°ë§í•˜ëŠ” ë° ì£¼ë ¥í•˜ì§€ë§Œ, ì—˜ë¼ìŠ¤í‹± ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤(ENI) ìˆ˜ì¤€ì—ì„œ ê°•ì œë˜ëŠ” ì´ˆë‹¹ 1024ê°œ íŒ¨í‚·(PPS)ì˜ í•˜ë“œ ì œí•œì„ ìì£¼ ê°„ê³¼í•©ë‹ˆë‹¤. ì´ í•œê³„ê°€ ì“°ë¡œí‹€ë§ ë¬¸ì œë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆëŠ” ë°©ì‹ì„ ì´í•´í•˜ë ¤ë©´ Kubernetes íŒŒë“œì˜ ì „í˜•ì ì¸ DNS í•´ìƒë„ íë¦„ì— ëŒ€í•œ í†µì°°ë ¥ì´ í•„ìš”í•©ë‹ˆë‹¤.\n\nKubernetes í™˜ê²½ì—ì„œëŠ” íŒŒë“œê°€ í†µì‹ ì„ ê°€ëŠ¥í•˜ê²Œ í•˜ê¸° ìœ„í•´ ë‚´ë¶€ ë° ì™¸ë¶€ ì„œë¹„ìŠ¤ì˜ ë„ë©”ì¸ ì´ë¦„ì„ í•´ìƒí•´ì•¼ í•©ë‹ˆë‹¤. ì´ í•´ìƒë„ í”„ë¡œì„¸ìŠ¤ëŠ” DNS ì¿¼ë¦¬ë¥¼ ì›Œì»¤ ë…¸ë“œì˜ ENIë¥¼ í†µí•´ ë¼ìš°íŒ…í•˜ëŠ” ê²ƒì„ í¬í•¨í•˜ë©°, íŠ¹íˆ ì™¸ë¶€ ì—”ë“œí¬ì¸íŠ¸ë¥¼ í•´ìƒí•˜ëŠ” ê²½ìš°ì…ë‹ˆë‹¤. ë‚´ë¶€ ì—”ë“œí¬ì¸íŠ¸ì˜ ê²½ìš°ì—ë„ ì¿¼ë¦¬í•˜ëŠ” íŒŒë“œì™€ ë™ì¼í•œ ìœ„ì¹˜ì— CoreDNS íŒŒë“œê°€ ì—†ìœ¼ë©´ DNS íŒ¨í‚·ì´ ì—¬ì „íˆ ì›Œì»¤ ë…¸ë“œì˜ ENIë¥¼ í†µí•´ ì´ë™í•©ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nê°‘ìê¸° DNS ì¿¼ë¦¬ê°€ ê¸‰ì¦í•˜ì—¬ PPSê°€ í•˜ë“œ ì œí•œê°’ 1024ì— ì ‘ê·¼í•˜ëŠ” ìƒí™©ì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ìƒí™©ì€ DNS ì“°ë¡œí‹€ë§ì„ ìœ ë°œí•  ìˆ˜ ìˆìœ¼ë©°, ì´ë¡œ ì¸í•´ ì˜í–¥ì„ ë°›ëŠ” ì‘ì—… ë…¸ë“œì—ì„œ ì‹¤í–‰ ì¤‘ì¸ ëª¨ë“  ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ì— ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìœ ê°ìŠ¤ëŸ½ê²Œë„, ì´ëŸ¬í•œ ë¬¸ì œ í•´ê²°ì€ ì£¼ë¡œ CoreDNS podì— ì´ˆì ì„ ë§ì¶”ëŠ” ENI ë©”íŠ¸ë¦­ë³´ë‹¤ ì–´ë ¤ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nEKS í´ëŸ¬ìŠ¤í„°ì—ì„œ DNS ì“°ë¡œí‹€ë§ ë¬¸ì œë¥¼ ì™„í™”í•˜ê¸° ìœ„í•´ì„œëŠ” ENI ìˆ˜ì¤€ì—ì„œ ë°œìƒí•˜ëŠ” íŒ¨í‚· ì†ì‹¤ì„ ì§€ì†ì ìœ¼ë¡œ ëª¨ë‹ˆí„°ë§í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤. ì´ ëª¨ë‹ˆí„°ë§ì„ í†µí•´ ì ì¬ì ì¸ ì¤‘ë‹¨ì„ ì¡°ê¸°ì— ê°ì§€í•˜ê³  ì˜ˆë°©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ì—ì„œëŠ” ë„¤íŠ¸ì›Œí¬ ì„±ëŠ¥ ë©”íŠ¸ë¦­ì„ í™œìš©í•˜ì—¬ DNS ì“°ë¡œí‹€ë§ ë¬¸ì œë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ì‹ë³„í•˜ëŠ” ì†”ë£¨ì…˜ì„ ì†Œê°œí•©ë‹ˆë‹¤.\n\n## í•´ê²°ì±…: ğŸ‰\n\nì‘ì—… ë…¸ë“œì—ì„œ DNS ì“°ë¡œí‹€ë§ ë¬¸ì œë¥¼ ì‹ë³„í•˜ëŠ” ê°„ë‹¨í•œ ë°©ë²•ì€ Elastic Network Adapter (ENA) ë“œë¼ì´ë²„ì—ì„œ ì œê³µí•˜ëŠ” linklocal_allowance_exceeded ë©”íŠ¸ë¦­ ë° ë‹¤ë¥¸ ë©”íŠ¸ë¦­ì„ ìº¡ì²˜í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n`linklocal_allowance_exceeded`ì€ ë¡œì»¬ í”„ë¡ì‹œ ì„œë¹„ìŠ¤ë¡œì˜ íŠ¸ë˜í”½ PPSê°€ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ì˜ ìµœëŒ€ë¥¼ ì´ˆê³¼í•˜ì—¬ ë“œë¡­ëœ íŒ¨í‚· ìˆ˜ì…ë‹ˆë‹¤. ì´ëŠ” DNS ì„œë¹„ìŠ¤, ì¸ìŠ¤í„´ìŠ¤ ë©”íƒ€ë°ì´í„° ì„œë¹„ìŠ¤ ë° Amazon ì‹œê°„ ë™ê¸°í™” ì„œë¹„ìŠ¤ë¡œì˜ íŠ¸ë˜í”½ì— ì˜í–¥ì„ ì¤ë‹ˆë‹¤.\n\nì´ ì´ë²¤íŠ¸ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ì¶”ì í•˜ëŠ” ëŒ€ì‹ , ìš°ë¦¬ëŠ” ì´ ë©”íŠ¸ë¦­ì„ Amazon Managed Service for Prometheusë¡œ ìŠ¤íŠ¸ë¦¬ë°í•˜ê³  Amazon Managed Grafanaì—ì„œ ì‹œê°í™”í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance_1.png)\n\n# ì‹¤ì „: AWS EKSì—ì„œ CoreDNS ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ë° ì‹œê°í™”:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nCoreDNS í”„ë¡œë©”í…Œìš°ìŠ¤ í”ŒëŸ¬ê·¸ì¸ì€ OpenMetrics í˜•ì‹ìœ¼ë¡œ ë©”íŠ¸ë¦­ì„ ë…¸ì¶œí•˜ë©°, ì´ëŠ” í”„ë¡œë©”í…Œìš°ìŠ¤ í˜•ì‹ì—ì„œ ë°œì „í•œ í…ìŠ¤íŠ¸ ê¸°ë°˜ í‘œì¤€ì…ë‹ˆë‹¤. Kubernetes í´ëŸ¬ìŠ¤í„°ì—ì„œëŠ” í”ŒëŸ¬ê·¸ì¸ì´ ê¸°ë³¸ì ìœ¼ë¡œ í™œì„±í™”ë˜ì–´ ìˆì–´ í´ëŸ¬ìŠ¤í„°ë¥¼ ì‹œì‘í•˜ëŠ” ì¦‰ì‹œ ë§ì€ ì¤‘ìš”í•œ ë©”íŠ¸ë¦­ì„ ëª¨ë‹ˆí„°ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nê¸°ë³¸ ì„¤ì •ì—ì„œ í”„ë¡œë©”í…Œìš°ìŠ¤ í”ŒëŸ¬ê·¸ì¸ì€ ê° CoreDNS íŒŸì˜ í¬íŠ¸ 9153ì— ìˆëŠ” /metrics ì—”ë“œí¬ì¸íŠ¸ì— ë©”íŠ¸ë¦­ì„ ê¸°ë¡í•©ë‹ˆë‹¤.\n\nAmazon Managed Service for Prometheus ì›Œí¬ìŠ¤í˜ì´ìŠ¤ì™€ Managed Service for Grafanaë¥¼ ìƒì„±í•˜ì„¸ìš”:\n\nì´ ë‹¨ê³„ì—ì„œëŠ” Amazon Managed Service for Prometheus ë° Managed Service for Grafanaë¥¼ ìœ„í•œ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì´ íŒŒì¼ êµ¬ì„±ì€ ë‹¤ìŒì„ ìƒì„±í•©ë‹ˆë‹¤:\n\n- AMP ì‘ì—… ê³µê°„\n- AMP ê²½ë³´ ê´€ë¦¬ì ì •ì˜.\n\nmain.tf:\n\n```js\nmodule \"prometheus\" {\n  source = \"terraform-aws-modules/managed-service-prometheus/aws\"\n\n  workspace_alias = \"demo-coredns\"\n\n  alert_manager_definition = \u003c\u003c-EOT\n  alertmanager_config: |\n    route:\n      receiver: 'default'\n    receivers:\n      - name: 'default'\n  EOT\n\n  rule_group_namespaces = {}\n}\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nversions.tf:\n\n```js\nterraform {\n  required_version = \"\u003e= 1.3\"\n\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"\u003e= 5.32\"\n    }\n  }\n}\n```\n\ní…Œë¼í¼ì„ ì‹¤í–‰í•˜ë ¤ë©´ ë‹¤ìŒì„ ì‹¤í–‰í•´ì•¼ í•©ë‹ˆë‹¤:\n\n```js\n$ terraform init\n$ terraform plan\n$ terraform apply\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì•„ë˜ êµ¬ì„± íŒŒì¼ì€ ë‹¤ìŒê³¼ ê°™ì€ ê²ƒì„ ìƒì„±í•©ë‹ˆë‹¤:\n\n- ê¸°ë³¸ Grafana ì‘ì—… ê³µê°„ (ëª¨ë“ˆì—ì„œ ì œê³µí•˜ëŠ” ê¸°ë³¸ê°’ ì‚¬ìš©)\n\nmain.tf:\n\n```js\nprovider \"aws\" {\n  region = local.region\n}\n\ndata \"aws_availability_zones\" \"available\" {}\n\nlocals {\n  region      = \"eu-west-1\"\n  name        = \"amg-ex-${replace(basename(path.cwd), \"_\", \"-\")}\"\n  description = \"AWS Managed Grafana service for ${local.name}\"\n\n  vpc_cidr = \"10.0.0.0/16\"\n  azs      = slice(data.aws_availability_zones.available.names, 0, 3)\n}\n\n################################################################################\n# Managed Grafana Module\n################################################################################\n\nmodule \"managed_grafana\" {\n  source = \"terraform-aws-modules/managed-service-grafana/aws\"\n\n  # Workspace\n  name                      = local.name\n  associate_license         = false\n  description               = local.description\n  account_access_type       = \"CURRENT_ACCOUNT\"\n  authentication_providers  = [\"AWS_SSO\"]\n  permission_type           = \"SERVICE_MANAGED\"\n  data_sources              = [\"CLOUDWATCH\", \"PROMETHEUS\", \"XRAY\"]\n  notification_destinations = [\"SNS\"]\n  stack_set_name            = local.name\n  grafana_version           = \"9.4\"\n\n  configuration = jsonencode({\n    unifiedAlerting = {\n      enabled = true\n    },\n    plugins = {\n      pluginAdminEnabled = false\n    }\n  })\n\n  # vpc configuration\n  vpc_configuration = {\n    subnet_ids = module.vpc.private_subnets\n  }\n  security_group_rules = {\n    egress_postgresql = {\n      description = \"Allow egress to PostgreSQL\"\n      from_port   = 5432\n      to_port     = 5432\n      protocol    = \"tcp\"\n      cidr_blocks = module.vpc.private_subnets_cidr_blocks\n    }\n  }\n\n  # Workspace API keys\n  workspace_api_keys = {\n    viewer = {\n      key_name        = \"viewer\"\n      key_role        = \"VIEWER\"\n      seconds_to_live = 3600\n    }\n    editor = {\n      key_name        = \"editor\"\n      key_role        = \"EDITOR\"\n      seconds_to_live = 3600\n    }\n    admin = {\n      key_name        = \"admin\"\n      key_role        = \"ADMIN\"\n      seconds_to_live = 3600\n    }\n  }\n\n  # Workspace IAM role\n  create_iam_role                = true\n  iam_role_name                  = local.name\n  use_iam_role_name_prefix       = true\n  iam_role_description           = local.description\n  iam_role_path                  = \"/grafana/\"\n  iam_role_force_detach_policies = true\n  iam_role_max_session_duration  = 7200\n  iam_role_tags                  = { role = true }\n\n\n  tags = local.tags\n}\n\nmodule \"managed_grafana_default\" {\n  source = \"terraform-aws-modules/managed-service-grafana/aws\"\n\n  name              = \"${local.name}-default\"\n  associate_license = false\n\n  tags = local.tags\n}\n\nmodule \"managed_grafana_disabled\" {\n  source = \"terraform-aws-modules/managed-service-grafana/aws\"\n\n  name   = local.name\n  create = false\n}\n\n################################################################################\n# Supporting Resources\n################################################################################\n\nmodule \"vpc\" {\n  source  = \"terraform-aws-modules/vpc/aws\"\n  version = \"~\u003e 5.0\"\n\n  name = local.name\n  cidr = local.vpc_cidr\n\n  azs             = local.azs\n  private_subnets = [for k, v in local.azs : cidrsubnet(local.vpc_cidr, 4, k)]\n  public_subnets  = [for k, v in local.azs : cidrsubnet(local.vpc_cidr, 8, k + 48)]\n\n  enable_nat_gateway = false \n  single_nat_gateway = true\n\n  tags = local.tags\n}\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n\"versions.tf\" íŒŒì¼ì…ë‹ˆë‹¤:\n\n```js\nterraform {\n  required_version = \"\u003e= 1.0\"\n\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"\u003e= 5.0\"\n    }\n  }\n}\n```\n\nì´ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë ¤ë©´ ë‹¤ìŒì„ ì‹¤í–‰í•´ì•¼ í•©ë‹ˆë‹¤:\n\n```js\n$ terraform init\n$ terraform plan\n$ terraform apply\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\ní”„ë¡œë©”í…Œìš°ìŠ¤ ethtool ìµìŠ¤í¬í„° ë°°ì¹˜:\n\nethtoolì€ ì›Œì»¤ ë…¸ë“œì˜ ì´ë”ë„· ì¥ì¹˜ì— ëŒ€í•œ ì •ë³´ë¥¼ êµ¬ì„±í•˜ê³  ìˆ˜ì§‘í•˜ëŠ” ë¦¬ëˆ…ìŠ¤ ë„êµ¬ì…ë‹ˆë‹¤. ìš°ë¦¬ëŠ” ethtoolì˜ ì¶œë ¥ì„ ì‚¬ìš©í•˜ì—¬ íŒ¨í‚· ì†ì‹¤ì„ ê°ì§€í•˜ê³  ì´ë¥¼ í”„ë¡œë©”í…Œìš°ìŠ¤ ethtool ìµìŠ¤í¬í„° ìœ í‹¸ë¦¬í‹°ë¥¼ ì‚¬ìš©í•˜ì—¬ í”„ë¡œë©”í…Œìš°ìŠ¤ í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•  ê²ƒì…ë‹ˆë‹¤.\n\në°°í¬ì—ëŠ” ethtoolì—ì„œ ì •ë³´ë¥¼ ê°€ì ¸ ì™€ì„œ í”„ë¡œë©”í…Œìš°ìŠ¤ í˜•ì‹ìœ¼ë¡œ ê²Œì‹œí•˜ëŠ” Python ìŠ¤í¬ë¦½íŠ¸ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\n\n```js\nkubectl apply -f https://raw.githubusercontent.com/Showmax/prometheus-ethtool-exporter/master/deploy/k8s-daemonset.yaml\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì´ì œ ADOT ìˆ˜ì§‘ê¸°ë¥¼ ë°°í¬í•˜ê³  ADOT ìˆ˜ì§‘ê¸°ë¥¼ êµ¬ì„±í•˜ì—¬ Amazon Managed Service for Prometheusë¡œ ë©”íŠ¸ë¦­ì„ ìˆ˜ì§‘í•  ê²ƒì…ë‹ˆë‹¤.\n\nìš°ë¦¬ëŠ” Amazon EKS ì• ë“œì˜¨ì„ ì‚¬ìš©í•˜ì—¬ ADOT ì˜¤í¼ë ˆì´í„°ë¥¼ CoreDNS ëª¨ë‹ˆí„°ë§ì„ ìœ„í•´ ë©”íŠ¸ë¦­ \"linklocal_allowance_exceeded\"ë¥¼ Amazon Managed Service for Prometheusë¡œ ë³´ë‚´ê²Œ ë  ê²ƒì…ë‹ˆë‹¤.\n\nIAM ì—­í• ê³¼ Amazon EKS ì„œë¹„ìŠ¤ ê³„ì •ì„ ìƒì„±í•˜ì„¸ìš”.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nADOT ìˆ˜ì§‘ê¸°ë¥¼ Kubernetes ì„œë¹„ìŠ¤ ê³„ì • \"adot-collector\"ì˜ ì‹ ì›ìœ¼ë¡œ ë°°í¬í•  ì˜ˆì •ì…ë‹ˆë‹¤. ì„œë¹„ìŠ¤ ê³„ì •ì— IAM ì—­í• (IRSA)ì„ ì—°ê²°í•˜ì—¬ Kubernetes ì„œë¹„ìŠ¤ ê³„ì •ì— AmazonPrometheusRemoteWriteAccess ì—­í• ì„ í• ë‹¹í•¨ìœ¼ë¡œì¨ í•´ë‹¹ ì„œë¹„ìŠ¤ ê³„ì •ì„ í™œìš©í•˜ëŠ” ëª¨ë“  íŒŒë“œê°€ Amazon Managed Service for Prometheusì— ë©”íŠ¸ë¦­ì„ ìˆ˜ì§‘í•˜ëŠ” ë° í•„ìš”í•œ IAM ê¶Œí•œì„ ë¶€ì—¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ë ¤ë©´ kubectl ë° eksctl CLI ë„êµ¬ê°€ í•„ìš”í•©ë‹ˆë‹¤. ì´ ë„êµ¬ë“¤ì€ Amazon EKS í´ëŸ¬ìŠ¤í„°ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆë„ë¡ êµ¬ì„±ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.\n\n```js\neksctl create iamserviceaccount \\\n--name adot-collector \\\n--namespace default \\\n--region eu-west-1\\\n--cluster coredns-monitoring-demo\\\n--attach-policy-arn arn:aws:iam::aws:policy/AmazonPrometheusRemoteWriteAccess \\\n--approve \\\n--override-existing-serviceaccounts\n```\n\nADOT ì• ë“œì˜¨ ì„¤ì¹˜í•˜ê¸°:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì—¬ëŸ¬ë¶„ì€ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ Amazon EKSì˜ ë‹¤ë¥¸ ë²„ì „ì— í™œì„±í™”ëœ ì• ë“œì˜¨ ëª©ë¡ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\ní´ëŸ¬ìŠ¤í„° ë²„ì „ì—ì„œ ì§€ì›í•˜ëŠ” ADOT ë²„ì „ì„ í™•ì¸í•˜ì‹­ì‹œì˜¤.\n\n```js\naws eks describe-addon-versions --addon-name adot --kubernetes-version 1.28 \\\n  --query \"addons[].addonVersions[].[addonVersion, compatibilities[].defaultVersion]\" --output text\n```\n\në‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ ADOT ì• ë“œì˜¨ì„ ì„¤ì¹˜í•˜ì‹­ì‹œì˜¤. ìœ„ ë‹¨ê³„ì—ì„œ ê¸°ìˆ ëœ ê²ƒì— ë”°ë¼ --addon-version í”Œë˜ê·¸ë¥¼ êµì²´í•˜ì‹­ì‹œì˜¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\naws eks create-addon --addon-name adot --addon-version v0.66.0-eksbuild.1 --cluster-name coredns-monitoring-demo\n```\n\në‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ ADOT ì• ë“œì˜¨ì´ ì¤€ë¹„ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.\n\n```js\nkubectl get po -n opentelemetry-operator-system\n```\n\në‹¤ìŒ ì ˆì°¨ëŠ” ë°°í¬ë¥¼ ëª¨ë“œ ê°’ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ì˜ˆì œ YAML íŒŒì¼ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ì´ëŠ” ê¸°ë³¸ ëª¨ë“œì´ë©° ADOT Collectorë¥¼ ë…ë¦½ ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ ìœ ì‚¬í•˜ê²Œ ë°°í¬í•©ë‹ˆë‹¤. ì´ êµ¬ì„±ì€ ìƒ˜í”Œ ì• í”Œë¦¬ì¼€ì´ì…˜ìœ¼ë¡œë¶€í„° OTLP ë©”íŠ¸ë¦­ì„ ìˆ˜ì‹ í•˜ê³  í´ëŸ¬ìŠ¤í„°ì˜ podì—ì„œ ìŠ¤í¬ë˜í•‘ëœ Amazon Managed Service for Prometheus ë©”íŠ¸ë¦­ì„ ìˆ˜ì‹ í•©ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n\n\ncurl -o collector-config-amp.yaml https://raw.githubusercontent.com/aws-observability/aws-otel-community/master/sample-configs/operator/collector-config-amp.yaml\n\n\ncollector-config-amp.yaml íŒŒì¼ì—ì„œ ë‹¤ìŒì„ ë³¸ì¸ì˜ ê°’ìœ¼ë¡œ ë°”ê¿”ì£¼ì„¸ìš”: * mode: deployment * serviceAccount: adot-collector * endpoint: \"\" * region: \"\" * name: adot-collector\n\n\nkubectl apply -f collector-config-amp.yaml\n\n\nadot collectorê°€ ë°°í¬ë˜ë©´ ë©”íŠ¸ë¦­ì´ Amazon Prometheusì— ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤.\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nAmazon Managed Grafanaì—ì„œ ethtool ë©”íŠ¸ë¦­ì„ ì‹œê°í™”í•´ë³´ì„¸ìš”:\n\nAmazon Managed Grafana ì½˜ì†” ë‚´ì—ì„œ Prometheus ì›Œí¬ìŠ¤í˜ì´ìŠ¤ë¥¼ ë°ì´í„° ì†ŒìŠ¤ë¡œ êµ¬ì„±í•©ë‹ˆë‹¤.\n\nì´ì œ Amazon Managed Grafanaì—ì„œ ë©”íŠ¸ë¦­ì„ ì‚´í´ë´…ì‹œë‹¤: \"íƒìƒ‰\" ë²„íŠ¼ì„ í´ë¦­í•œ í›„ ethtoolì„ ê²€ìƒ‰í•˜ì„¸ìš”:\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance_2.png)\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\në§í¬ë¡œì»¬ í• ë‹¹ ì´ˆê³¼ ë©”íŠ¸ë¦­ì„ ì‚¬ìš©í•˜ì—¬ ëŒ€ì‹œë³´ë“œë¥¼ ë§Œë“¤ì–´ ë´…ì‹œë‹¤. ì¿¼ë¦¬ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\n\n```js\nrate(node_net_ethtool{device=\"eth0\",type=\"linklocal_allowance_exceeded\"} [30s])\n```\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance_3.png)\n\nê°’ì´ 0ì´ê¸° ë•Œë¬¸ì— ë“œëëœ íŒ¨í‚·ì´ ì—†ë‹¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Amazon Managed Service for Prometheusì˜ ê²½ê³  ê´€ë¦¬ìì—ì„œ ì•Œë¦¼ì„ êµ¬ì„±í•˜ì—¬ ì•Œë¦¼ì„ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# ê²°ë¡ :\n\nì´ ê¸€ì—ì„œëŠ” AWS Distro for OpenTelemetry (ADOT), Amazon Managed Service for Prometheus ë° Amazon Managed Grafanaë¥¼ ì‚¬ìš©í•˜ì—¬ CoreDNS ì“°ë¡œí‹€ë§ ë¬¸ì œë¥¼ ëª¨ë‹ˆí„°ë§í•˜ê³  ê²½ê³ ë¥¼ ìƒì„±í•˜ëŠ” ë°©ë²•ì„ ë³´ì—¬ë“œë ¸ìŠµë‹ˆë‹¤. CoreDNS ë©”íŠ¸ë¦­ì„ ëª¨ë‹ˆí„°ë§í•¨ìœ¼ë¡œì¨ ê³ ê°ì€ íŒ¨í‚· ì†ì‹¤ì„ ì‚¬ì „ì— ê°ì§€í•˜ê³  ì˜ˆë°© ì¡°ì¹˜ë¥¼ ì·¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\në‹¤ìŒì— ë˜ ë§Œë‚˜ìš” ğŸ‡µğŸ‡¸ ğŸ‰\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance_4.png)\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì½ì–´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤!! ğŸ™ŒğŸ»ğŸ˜ğŸ“ƒ, ë‹¤ìŒ ë¸”ë¡œê·¸ì—ì„œ ë§Œë‚˜ìš”.ğŸ¤˜ğŸ‡µğŸ‡¸\n\nğŸš€ ëê¹Œì§€ í•¨ê»˜í•´ ì¤˜ì„œ ê°ì‚¬í•©ë‹ˆë‹¤. ì´ ë¸”ë¡œê·¸ì— ê´€í•œ ì§ˆë¬¸/í”¼ë“œë°±ì´ ìˆìœ¼ë©´ ì–¸ì œë“ ì§€ ì—°ë½í•´ ì£¼ì„¸ìš”:\n\nâ™»ï¸ ğŸ‡µğŸ‡¸LinkedIn: https://www.linkedin.com/in/rajhi-saif/\n\nâ™»ï¸ğŸ‡µğŸ‡¸ Twitter : https://twitter.com/rajhisaifeddine\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\në! âœŒğŸ»\n\n# ğŸ”° ê³„ì† ë°°ìš°ê³ !! ê³„ì† ê³µìœ í•´ìš”!! ğŸ”°\n\n# ì°¸ê³ :\n\n[https://aws.amazon.com/blogs/mt/monitoring-coredns-for-dns-throttling-issues-using-aws-open-source-monitoring-services/](https://aws.amazon.com/blogs/mt/monitoring-coredns-for-dns-throttling-issues-using-aws-open-source-monitoring-services/)","ogImage":{"url":"/assets/img/2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance_0.png"},"coverImage":"/assets/img/2024-06-19-EverythingyouneedtoknowaboutmonitoringCoreDNSforDNSperformance_0.png","tag":["Tech"],"readingTime":13},{"title":"Kubernetes ë³´ì•ˆ ë§ˆìŠ¤í„°í•˜ê¸° - ë‚´ Admission Controllers ì—¬í–‰","description":"","date":"2024-06-19 13:06","slug":"2024-06-19-MasteringKubernetesSecurityMyJourneyWithAdmissionControllers","content":"\n\nKubernetesëŠ” Admission Controllersë¼ëŠ” í™•ì¥ í¬ì¸íŠ¸ë¥¼ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ë“¤ì€ Kubernetes í´ëŸ¬ìŠ¤í„°ì˜ ë¬¸ì§€ê¸° ì—­í• ì„ í•˜ë©° ë“¤ì–´ì˜¤ê³  ë‚˜ê°€ëŠ” ëª¨ë“  ìì› ìš”ì²­ì„ ê°ë…í•©ë‹ˆë‹¤. ë‹¨ìˆœí•œ ê°ì‹œë¿ë§Œ ì•„ë‹ˆë¼ ì´ë“¤ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ì •êµí•œ í•„í„° ì—­í• ì„ í•©ë‹ˆë‹¤.\n\nê·¸ë“¤ì€ ì¡°ì§ì˜ ì •ì±…ì„ ì§‘í–‰í•˜ê³  ê·œì • ì¤€ìˆ˜ë¥¼ ë³´ì¥í•˜ë©° ìš”ì²­ì„ ë¯¸ë¦¬ ì •ì˜ëœ í‘œì¤€ì— ë§ê²Œ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nì´ ê¸°ì‚¬ëŠ” Kubernetes ë³´ì•ˆ ì‹œë¦¬ì¦ˆì˜ ë„¤ ë²ˆì§¸ë¡œ Admission Controllersì— ì¤‘ì ì„ ë‘¡ë‹ˆë‹¤.\n\nì¸ì¦ëœ Kubernetes ë³´ì•ˆ (CKS) ìê²©ì¦ íšë“ì„ í–¥í•´ ì§„ë¡œë¥¼ ë‚˜ì•„ê°€ë©´ì„œ, CKS ì»¤ë¦¬í˜ëŸ¼ì˜ \"ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì·¨ì•½ì  ìµœì†Œí™”\" ì„¹ì…˜ì—ì„œ Admission Controllersì˜ ì¤‘ìš”ì„±ì„ íƒêµ¬í•˜ê³  ìˆìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# ì–´ë“œë¯¸ì…˜ ì»¨íŠ¸ë¡¤ëŸ¬ë€ ë¬´ì—‡ì¸ê°€ìš”?\n\nì–´ë“œë¯¸ì…˜ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ ìƒíƒœê³„ì—ì„œ ì¤‘ìš”í•œ ì—­í• ì„ í•˜ëŠ”ë°, ì¿ ë²„ë„¤í‹°ìŠ¤ API ì„œë²„ì˜ ì¶œì…êµ¬ ì—­í• ì„ í•©ë‹ˆë‹¤.\n\nì–´ë“œë¯¸ì…˜ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ìš”ì²­ì´ ì¸ì¦ë˜ê³  ê¶Œí•œì´ ë¶€ì—¬ëœ í›„ì— í˜¸ì¶œë˜ë©°, í•´ë‹¹ ê°ì²´ê°€ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— ì§€ì†ë˜ê¸° ì „ì— ì‘ë™í•©ë‹ˆë‹¤. ê·¸ë“¤ì˜ ì£¼ìš” ê¸°ëŠ¥ì€ ìš”ì²­ì„ ê°€ë¡œì±„ê³  ì²˜ë¦¬í•˜ì—¬ í´ëŸ¬ìŠ¤í„°ì˜ ìš´ì˜ ë¬´ê²°ì„±ê³¼ ë³´ì•ˆì„ ìœ ì§€í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.\n\nì¿ ë²„ë„¤í‹°ìŠ¤ì—ì„œ ì–´ë“œë¯¸ì…˜ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ í´ëŸ¬ìŠ¤í„°ì˜ ì‚¬ìš© ë°©ë²•ì„ ì§€ë°°í•˜ê³  ê°•ì œí™”í•˜ëŠ” í”ŒëŸ¬ê·¸ì¸ì…ë‹ˆë‹¤. ì´ë“¤ì€ ì¿ ë²„ë„¤í‹°ìŠ¤ API ì„œë²„ë¡œì˜ ìš”ì²­(ì˜ˆ: ë¦¬ì†ŒìŠ¤ ìƒì„±, ìˆ˜ì • ë˜ëŠ” ì‚­ì œ)ì„ ë¯¸ë¦¬ ì •ì˜ëœ ê·œì¹™ê³¼ ì •ì±…ì— ë§ì¶°í‰ê°€í•©ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n## ë‘ ê°€ì§€ ìœ í˜•ì˜ ì…ì¥ ì»¨íŠ¸ë¡¤ëŸ¬: ë³€í˜• ë° í™•ì¸\n\nì…ì¥ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ë³€í˜•ê³¼ í™•ì¸ ë‘ ê°€ì§€ ì£¼ìš” ìœ í˜•ìœ¼ë¡œ ë¶„ë¥˜ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\në³€í˜• ì…ì¥ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ê·¸ë“¤ì´ ìˆ˜ë½í•˜ëŠ” ê°ì²´ë“¤ì„ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ê°ì²´ê°€ íŠ¹ì • ê·œì¹™ì„ ì¤€ìˆ˜í•˜ê±°ë‚˜ ì¶”ê°€ ë©”íƒ€ë°ì´í„°ë¡œ ê°ì²´ë¥¼ í–¥ìƒì‹œí‚¬ ë•Œ Kubernetes API ì„œë²„ì— ì˜í•´ ì²˜ë¦¬ë˜ê¸° ì „ì— ìš”ì²­ ë‚´ìš©ì„ ë³€ê²½í•  ìˆ˜ ìˆìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.\n\nì˜ˆë¥¼ ë“¤ì–´, ë³€í˜• ì…ì¥ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ëª¨ë‹ˆí„°ë§ ì—ì´ì „íŠ¸ê°€ ëª¨ë“  ì‘ì—… ë¶€í•˜ì— ì¡´ì¬í•¨ì„ ë³´ì¥í•˜ê¸° ìœ„í•´ ì‚¬ì´ë“œì¹´ ì»¨í…Œì´ë„ˆë¥¼ ìë™ìœ¼ë¡œ ì£¼ì…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\ní•œí¸, ìœ íš¨ì„± ê²€ì‚¬ ì…í•©ê¸°ëŠ” ê°ì²´ë¥¼ ìˆ˜ì •í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ëŒ€ì‹  ìš”ì²­ì´ ëª¨ë“  í•„ìš”í•œ ê¸°ì¤€ì„ ì¶©ì¡±í•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ë°°í¬ê°€ ì´ë¯¸ì§€ì˜ ìµœì‹  ë²„ì „ì„ ì‚¬ìš©í•˜ëŠ”ì§€ ë³´ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\në§Œì•½ ìš”ì²­ì´ ì´ëŸ¬í•œ ê²€ì‚¬ë¥¼ í†µê³¼í•˜ì§€ ëª»í•˜ë©´, ìœ íš¨ì„± ê²€ì‚¬ ì…í•©ê¸°ëŠ” ì‘ì—…ì„ ê±°ë¶€í•˜ê³  ê°ì²´ê°€ ìƒì„±, ìˆ˜ì • ë˜ëŠ” ì‚­ì œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\n\nì´ í”„ë¡œì„¸ìŠ¤ëŠ” ì¡°ì§ ì •ì±…ì„ ê°•ì œí•˜ëŠ” ë° ì¤‘ìš”í•˜ë©° í´ëŸ¬ìŠ¤í„°ì— ì ìš©ë˜ëŠ” ê·œì • ì¤€ìˆ˜ ë° ì•ˆì „í•œ êµ¬ì„±ë§Œì´ ë³´ì¥ë©ë‹ˆë‹¤.\n\níŠ¹ì • ìš”êµ¬ ì‚¬í•­ì— ë§ëŠ” ì‚¬ìš©ì ì •ì˜ ìœ íš¨ì„± ê²€ì‚¬ ì…í•©ê¸°ë¥¼ ë§Œë“¤ ìˆ˜ ìˆì§€ë§Œ, Kubernetes í´ëŸ¬ìŠ¤í„°ì—ëŠ” ì´ë¯¸ ë‚´ì¥ëœ ìœ íš¨ì„± ê²€ì‚¬ ì…í•©ê¸° ìŠ¤ìœ„íŠ¸ê°€ ìˆìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì•„ë˜ ì„¹ì…˜ì—ì„œëŠ” ë¯¸ë¦¬ êµ¬ì„±ëœ ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ì—­í• ê³¼ ê¸°ëŠ¥ì„ íƒìƒ‰í•  ê²ƒì…ë‹ˆë‹¤.\n\n## Kubernetes ë‚´ì¥ Admission ì»¨íŠ¸ë¡¤ëŸ¬\n\nê¸°ë³¸ Kubernetes ì„¤ì¹˜ì—ëŠ” ìì²´ ë‚´ì¥ Admission ì»¨íŠ¸ë¡¤ëŸ¬ ëª¨ìŒì´ ìë™ìœ¼ë¡œ í¬í•¨ë˜ì–´ í™œì„±í™”ë©ë‹ˆë‹¤. ëŒ€ë¶€ë¶„ì˜ ê´€ë¦¬ìì™€ ì‚¬ìš©ìì—ê²ŒëŠ” ì´ëŸ¬í•œ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ë§Œì§€ëŠ” ì¼ì´ ê±°ì˜ ì—†ê³ , ê¸°ë³¸ì ìœ¼ë¡œ í™œì„±í™”ëœ ê²ƒì„ ë¹„í™œì„±í™”í•  í•„ìš”ë„ ê±°ì˜ ì—†ì„ ê²ƒì…ë‹ˆë‹¤.\n\nê·¸ëŸ¬ë‚˜ í´ëŸ¬ìŠ¤í„°ì˜ ë™ì‘ì„ ì‚¬ìš©ì ì •ì˜í•˜ê±°ë‚˜ í™œì„±í™”ëœ Admission ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í™•ì¸í•´ì•¼ í•˜ëŠ” ê²½ìš°, KubernetesëŠ” ì œì–´ í”Œë ˆì¸ì—ì„œ ì§ì ‘ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ê°„ë‹¨í•œ ë°©ë²•ì„ ì œê³µí•©ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\ní˜„ì¬ í™œì„±í™”ëœ ì…ì¥ ì»¨íŠ¸ë¡¤ëŸ¬ ëª©ë¡ì„ í™•ì¸í•˜ë ¤ë©´ ì œì–´ í”Œë ˆì¸ í„°ë¯¸ë„ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì„ ì‹¤í–‰í•˜ì„¸ìš”:\n\n```js\nkube-apiserver -h | grep enable-admission-plugins\n```\n\nê¸°ë³¸ì ìœ¼ë¡œ ì„¤ì¹˜ëœ ì£¼ìš” ì…ì¥ ì»¨íŠ¸ë¡¤ëŸ¬ì™€ ì¿ ë²„ë„¤í‹°ìŠ¤ ìƒíƒœê³„ì— ëŒ€í•œ ê¸°ì—¬ì— ëŒ€í•´ ê°„ëµíˆ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. ì…ì¥ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ ë²„ì „ì— ë”°ë¼ ë‹¤ì–‘í•˜ë©°, ì´ê²ƒë“¤ì€ v1.29ì—ì„œ ë‚´ì¥ëœ ê²ƒë“¤ì…ë‹ˆë‹¤.\n\n- NamespaceLifecycle â€” ì‚­ì œ ì¤‘ì¸ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ëŒ€í•œ ìš”ì²­ì„ ì°¨ë‹¨í•˜ê³  ì˜ˆì•½ëœ ì´ë¦„ê³¼ ì¼ì¹˜í•˜ëŠ” ê²½ìš° ìƒˆë¡œìš´ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ìƒì„±í•  ìˆ˜ ì—†ë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤. ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë³„ ë¦¬ì†ŒìŠ¤ì˜ ë¬´ê²°ì„±ì„ ìœ ì§€í•˜ëŠ” ë° ì¤‘ìš”í•©ë‹ˆë‹¤.\n- LimitRanger â€” LimitRange ê°œì²´ë¡œ ì§€ì •ëœ ì œì•½ ì¡°ê±´ì„ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ë‚´ì˜ Pod, Container ë° PersistentVolumeClaim ë¦¬ì†ŒìŠ¤ì— ì ìš©í•©ë‹ˆë‹¤. ê´€ë¦¬ìê°€ ì •ì˜í•œ ì œí•œì„ ì´ˆê³¼í•˜ì§€ ì•Šë„ë¡í•˜ì—¬ ìì› ì‚¬ìš©ì„ íš¨ìœ¨ì ìœ¼ë¡œ í• ë‹¹í•˜ê³  ë‚­ìš©ì„ ë°©ì§€í•©ë‹ˆë‹¤.\n- ServiceAccount â€” ëª…ì‹œì  ServiceAccountê°€ ì§€ì •ë˜ì§€ ì•Šì€ Podì— ìë™ìœ¼ë¡œ ê¸°ë³¸ ì„œë¹„ìŠ¤ ê³„ì •ì„ ì²¨ë¶€í•©ë‹ˆë‹¤. ê¶Œí•œì„ ê´€ë¦¬í•˜ê³  ì ì ˆí•œ ìˆ˜ì¤€ì˜ ì•¡ì„¸ìŠ¤ë¡œ Podê°€ Kubernetes APIì— ì•ˆì „í•˜ê²Œ ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆë„ë¡ ì¤‘ìš”í•©ë‹ˆë‹¤.\n- PersistentVolumeClaimResize â€” ê¸°ì¡´ PersistentVolumeClaim (PVC)ì˜ í¬ê¸°ë¥¼ ë‹¤ì‹œ ì¡°ì •í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤. ì´ ê¸°ëŠ¥ì„ í†µí•´ ì‘ìš© í”„ë¡œê·¸ë¨ ìš”êµ¬ ì‚¬í•­ì´ ë³€ê²½ë  ë•Œ ì €ì¥ì†Œ ë¦¬ì†ŒìŠ¤ë¥¼ ì¡°ì •í•˜ëŠ” ì‘ì—…ì´ ê°„í¸í•´ì§‘ë‹ˆë‹¤.\n- PodSecurity â€” ì‚¬ì „ ì •ì˜ëœ Pod ë³´ì•ˆ ì„¤ì •ì„ ê°•í™”í•˜ëŠ” Pod Security Standardsë¥¼ ì ìš©í•©ë‹ˆë‹¤. ì§€ì •ëœ ë³´ì•ˆ ìš”êµ¬ ì‚¬í•­ì„ ì¶©ì¡±í•˜ì§€ ì•ŠëŠ” Podì˜ ìƒì„±ì„ ë°©ì§€í•˜ì—¬ í´ëŸ¬ìŠ¤í„° ë‚´ ë³´ì•ˆ ì·¨ì•½ì„± ìœ„í—˜ì„ í¬ê²Œ ì¤„ì…ë‹ˆë‹¤.\n\nê·¸ ì™¸ì—ë„ ë‹¤ìŒê³¼ ê°™ì€ ì…ì¥ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ìˆìŠµë‹ˆë‹¤:\n\n- MutatingAdmissionWebhook ë° ValidatingAdmissionWebhook â€” ì™¸ë¶€ ì„œë¹„ìŠ¤ì— ì˜í•´ ê°•ì œëœ ì‚¬ìš©ì ì •ì˜ ì…ì¥ ì •ì±…ì„ í—ˆìš©í•˜ëŠ” ì›¹í›…ì…ë‹ˆë‹¤. ë™ì  ì…ì¥ ì œì–´ì— ëŒ€í•œ ì„¹ì…˜ì—ì„œ ë…¼ì˜í•  ì˜ˆì •ì…ë‹ˆë‹¤.\n- ResourceQuota â€” ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ë‚´ ë¦¬ì†ŒìŠ¤ í• ë‹¹ëŸ‰ ì œí•œì„ ì ìš©í•˜ì—¬ CPU, ë©”ëª¨ë¦¬, ì €ì¥ì†Œ ë° Pod, ì„œë¹„ìŠ¤ ë“±ì˜ ê°œìˆ˜ë¥¼ ë‹¤ë£¹ë‹ˆë‹¤. í´ëŸ¬ìŠ¤í„° ë¦¬ì†ŒìŠ¤ì˜ ê³µì •í•œ ì‚¬ìš©ì„ ì¥ë ¤í•˜ê³  ëª¨ë“  ì„œë¹„ìŠ¤ ë° ì‚¬ìš©ì ê°„ì— ê³µì •í•œ ì‚¬ìš©ì„ ì´‰ì§„í•©ë‹ˆë‹¤.\n- Priority â€” PriorityClass ì´ë¦„ì„ ê¸°ë°˜ìœ¼ë¡œ Podì˜ ìŠ¤ì¼€ì¤„ë§ ìš°ì„  ìˆœìœ„ë¥¼ ê²°ì •í•©ë‹ˆë‹¤. íŠ¹ì • ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì¤‘ìš”ì„±ì„ ê¸°ì¤€ìœ¼ë¡œ Pod ìŠ¤ì¼€ì¤„ë§ì˜ ìš°ì„  ìˆœìœ„ë¥¼ ì„¤ì •í•˜ì—¬ ì¤‘ìš”í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ìµœì ìœ¼ë¡œ ì‹¤í–‰ë  ìˆ˜ ìˆë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤.\n- RuntimeClass â€” ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ êµ¬ì„±ì˜ ì„ íƒì„ ì§€ì›í•©ë‹ˆë‹¤. Podì— ëŒ€í•´ ì„œë¡œ ë‹¤ë¥¸ ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ì„ í—ˆìš©í•˜ì—¬ ëŸ°íƒ€ì„ë³„ ê¸°ëŠ¥ ë° ìµœì í™”ë¥¼ ê°„ì†Œí™”í•©ë‹ˆë‹¤.\n- DefaultStorageClass, DefaultIngressClass ë° DefaultTolerationSeconds â€” ëª…ì‹œì ìœ¼ë¡œ ì§€ì •ë˜ì§€ ì•Šì€ ê²½ìš° Podì— ëŒ€í•´ ì €ì¥ì†Œ í´ë˜ìŠ¤, ì¸ê·¸ë ˆìŠ¤ í´ë˜ìŠ¤ ë° í—ˆìš© ì‹œê°„ì˜ ê¸°ë³¸ê°’ì„ ìë™ìœ¼ë¡œ ì„¤ì •í•©ë‹ˆë‹¤. êµ¬ì„±ì„ ê°„ì†Œí™”í•˜ê³  ê¸°ë³¸ ì •ì±…ì´ í´ëŸ¬ìŠ¤í„° ì „ì²´ì— ì¼ê´€ë˜ê²Œ ì ìš©ë˜ë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ ë™ì  ì…ì¥ ì œì–´: í´ëŸ¬ìŠ¤í„° ë³´ì•ˆ ë° ê´€ë¦¬ í–¥ìƒ\n\në™ì  ì…ì¥ ì œì–´ëŠ” ì‚¬ìš©ì ì •ì˜ ì •ì±…ì„ ê°•ìš”í•˜ê³  MutatingAdmissionWebhook ë° ValidatingAdmissionWebhook ë‘ ê°€ì§€ ì¤‘ìš”í•œ êµ¬ì„± ìš”ì†Œë¥¼ í†µí•´ í´ëŸ¬ìŠ¤í„° ê´€ë¦¬ë¥¼ ê°„ì†Œí™”í•˜ëŠ” ê°•ë ¥í•œ ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤.\n\n## ë™ì  ì…ì¥ ì œì–´ ì»¨íŠ¸ë¡¤ëŸ¬ ì´í•´\n\në™ì  ì…ì¥ ì œì–´ ì»¨íŠ¸ë¡¤ëŸ¬ì—ëŠ” MutatingAdmissionWebhook ë° ValidatingAdmissionWebhook ë‘ ê°€ì§€ ì¢…ë¥˜ê°€ ìˆìŠµë‹ˆë‹¤. ì´ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ì™¸ë¶€ ì„œë¹„ìŠ¤ì—ì„œ ì •ì˜ëœ ì‚¬ìš©ì ì •ì±…ì— ë”°ë¼ ì¿ ë²„ë„¤í‹°ìŠ¤ API ì„œë²„ì— ëŒ€í•œ ìš”ì²­ì„ í—ˆìš©í•˜ê±°ë‚˜ ê±°ë¶€í•˜ëŠ” ê²Œì´íŠ¸í‚¤í¼ ì—­í• ì„ í•©ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n## MutatingAdmissionWebhook: ë³€í™˜ì\n\nMutatingAdmissionWebhookëŠ” ë³€í™˜í•˜ëŠ” ì–´ë“œë¯¸ì…˜ ì»¨íŠ¸ë¡¤ëŸ¬ì´ë©°, ì´ì „ ì„¹ì…˜ì—ì„œ ë³¸ ê²ƒì²˜ëŸ¼ ì¿ ë²„ë„¤í‹°ìŠ¤ API ì„œë²„ê°€ ì²˜ë¦¬í•˜ê¸° ì „ì— ë“¤ì–´ì˜¤ëŠ” ìš”ì²­ì„ ìˆ˜ì •í•˜ê±°ë‚˜ ë³€í™˜í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. ì´ ëŠ¥ë ¥ì€ ë‹¤ìŒê³¼ ê°™ì€ ì‹œë‚˜ë¦¬ì˜¤ì— ìœ ìš©í•©ë‹ˆë‹¤:\n\n- ì‚¬ì´ë“œì¹´ ì»¨í…Œì´ë„ˆ ì£¼ì…: íŒŸì— ë³´ì¡° ì»¨í…Œì´ë„ˆë¥¼ ìë™ìœ¼ë¡œ ì¶”ê°€í•˜ì—¬ ë¡œê¹…, ëª¨ë‹ˆí„°ë§ ë˜ëŠ” ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ ì œì–´ì— ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n- êµ¬ì„± ë³€ê²½: ì¡°ì§ í‘œì¤€ì„ ì¤€ìˆ˜í•˜ë„ë¡ í¬ë“œ ì‚¬ì–‘ì„ ìˆ˜ì •í•˜ì—¬ ë ˆì´ë¸”ì´ë‚˜ í™˜ê²½ ë³€ìˆ˜ë¥¼ ì¶”ê°€í•˜ëŠ” ê²ƒê³¼ ê°™ì€ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n## ValidatingAdmissionWebhook: ê²Œì´íŠ¸í‚¤í¼\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\ní•œí¸, ValidatingAdmissionWebhookì€ ë¯¸ë¦¬ ì •ì˜ëœ ê·œì¹™ì— ëŒ€í•œ ìš”ì²­ì„ ê²€ì¦í•˜ì—¬ ê³„ì† ì§„í–‰í•˜ê¸° ì „ì— í™•ì¸í•˜ëŠ” ë° ì¤‘ì ì„ ë‘” ìœ íš¨ì„± ê²€ì‚¬ ì…ì¥ ì»¨íŠ¸ë¡¤ëŸ¬ì…ë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì€ ì¤‘ìš”í•œ ì—­í• ì„ í•©ë‹ˆë‹¤:\n\n- ì‚¬ìš©ì ì§€ì • ë¦¬ì†ŒìŠ¤ í• ë‹¹ëŸ‰ ê°•ì œ ì ìš©: ë¦¬ì†ŒìŠ¤ ìƒì„±ì´ ì¡°ì§ ì •ì±…ì—ì„œ ì„¤ì •í•œ í•œë„ë¥¼ ì´ˆê³¼í•˜ì§€ ì•Šë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤.\n- ì‚¬ìš©ì ì§€ì • ë³´ì•ˆ ì •ì±… í™•ì¸: êµ¬ì„±ì´ ë³´ì•ˆ í‘œì¤€ì„ ì¤€ìˆ˜í•˜ëŠ”ì§€ í™•ì¸í•˜ì—¬ ì»¨í…Œì´ë„ˆê°€ ë£¨íŠ¸ ì‚¬ìš©ìê°€ ì•„ë‹Œ ì‚¬ìš©ìë¡œ ì‹¤í–‰ë˜ë„ë¡ í•©ë‹ˆë‹¤.\n\n# ì›¹í›… Admission ì»¨íŠ¸ë¡¤ëŸ¬ êµ¬í˜„\n\nì‚¬ìš©ì ì •ì˜ Admission ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í†µí•©í•˜ê±°ë‚˜ ê°œë°œí•˜ëŠ” ë‘ ê°€ì§€ ë°©ë²•ì´ ìˆìŠµë‹ˆë‹¤. ì „í†µì ì¸ ë°©ë²•ì€ Goì™€ ê°™ì€ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ì ì •ì˜ Admission ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ìƒì„±í•˜ëŠ” ê²ƒì¸ë°, ì´ëŠ” ê°•ë ¥í•œ ì œì–´ë¥¼ ì œê³µí•˜ì§€ë§Œ ì‹¬ì¸µì ì¸ Kubernetes ìƒíƒœê³„ ì§€ì‹ì´ í•„ìš”í•©ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nëŒ€ì‹ , ì¿ ë²„ë„¤í‹°ìŠ¤ëŠ” MutatingAdmissionWebhook ë° ValidatingAdmissionWebhookì´ë¼ëŠ” ì›¹í›… ì–´ë“œë¯¸ì…˜ ì»¨íŠ¸ë¡¤ëŸ¬ ë•ë¶„ì— ë” ì ‘ê·¼ì„±ì´ ì¢‹ì€ ì˜µì…˜ì„ ì œê³µí•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ê°œë°œìëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ API ì„œë²„ê°€ ì›¹í›…ì„ í†µí•´ í†µì‹ í•  ìˆ˜ ìˆëŠ” REST API ì„œë¹„ìŠ¤ë¥¼ êµ¬í˜„í•˜ì—¬ ì‚¬ìš©ì ì •ì˜ ì–´ë“œë¯¸ì…˜ ë¡œì§ì„ ë„ì…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n## ë°°í¬ ìœ ì—°ì„±\n\nì›¹í›…ì„ í˜¸ìŠ¤íŒ…í•˜ëŠ” REST API ì„œë¹„ìŠ¤ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ë‚´ë¶€ë‚˜ ì™¸ë¶€ ì¤‘ ì–´ë””ì—ë‚˜ ë°°í¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ìœ ì—°ì„±ì€ ë‹¤ì–‘í•œ ë°°í¬ ì‹œë‚˜ë¦¬ì˜¤ì™€ ì•„í‚¤í…ì²˜ ë””ìì¸ì„ ì§€ì›í•©ë‹ˆë‹¤.\n\n## ì–¸ì–´ ì¤‘ë¦½ì„±\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì›¹í›… ê¸°ë°˜ ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ì¤‘ìš”í•œ ì¥ì  ì¤‘ í•˜ë‚˜ëŠ” ì–¸ì–´ì— êµ¬ì• ë°›ì§€ ì•ŠëŠ”ë‹¤ëŠ” ì ì…ë‹ˆë‹¤. ê°œë°œìë“¤ì€ Node.js, Java, C# ë˜ëŠ” ê¸°íƒ€ ì„ í˜¸í•˜ëŠ” í”„ë¡œê·¸ë˜ë° ì–¸ì–´ë¡œ REST API ì„œë¹„ìŠ¤ë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆì–´ íŒ€ì˜ ì „ë¬¸ì§€ì‹ì— ê¸°ë°˜í•œ ë” ë„“ì€ ì±„íƒê³¼ ì‚¬ìš©ì ì •ì˜ë¥¼ ìœ ë„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n## ìš´ì˜ ë©”ì»¤ë‹ˆì¦˜\n\në‘ ì¢…ë¥˜ì˜ ì›¹í›…ì€ JSON í˜•ì‹ì˜ ì§ë ¬í™”ëœ AdmissionReview ê°ì²´ì™€ ìƒí˜¸ì‘ìš©í•˜ì—¬ ì‘ë™í•©ë‹ˆë‹¤. ValidatingAdmissionWebhookì€ ê°ì²´ë¥¼ ì‚¬ìš©í•˜ì—¬ í—ˆìš©/ê±°ë¶€ ê²°ì •ì„ ë‚´ë¦´ ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.\n\në™ì‹œì— MutatingAdmissionWebhookì€ ìš”ì²­ í˜ì´ë¡œë“œë¥¼ ë³€ê²½í•˜ì—¬ Kubernetes ë¦¬ì†ŒìŠ¤ì˜ ë™ì‘ì„ ë™ì ìœ¼ë¡œ ê°•í™”í•˜ê±°ë‚˜ ìˆ˜ì •í•˜ëŠ” ë‹¤ì¬ë‹¤ëŠ¥í•œ ë©”ì»¤ë‹ˆì¦˜ì„ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nGitHubì—ì„œ ì›¹í›… êµ¬í˜„ì„ ë³´ì—¬ì£¼ëŠ” ë‹¤ì–‘í•œ ì˜ˆì œë¥¼ ì°¾ì„ ìˆ˜ ìˆì–´ìš”. ì˜ˆë¥¼ ë“¤ë©´, ì´ê²ªì€ Pythonì„ ì‚¬ìš©í•©ë‹ˆë‹¤. [https://github.com/garethr/kubernetes-webhook-examples](https://github.com/garethr/kubernetes-webhook-examples)\n\n# Admission Controllersì™€ CKS ì‹œí—˜ ì¤€ë¹„\n\nCKS (Certified Kubernetes Security Specialist) ìê²©ì¦ ì‹œí—˜ì„ í†µê³¼í•˜ê¸° ìœ„í•´ ë‚˜ì˜ ì—¬ì • ì¤‘, ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì·¨ì•½ì ì„ ìµœì†Œí™”í•˜ëŠ” ë§‰ëŒ€ ì•„ë˜ì— ìˆëŠ” Admission Controllers ì„¹ì…˜ì— ë„ë‹¬í–ˆì–´ìš”.\n\nì•„ì§ ì‹œí—˜ì„ ë³´ì§€ëŠ” ì•Šì•˜ì§€ë§Œ, ì»¤ìŠ¤í…€ Admission Controllerë¥¼ ì œë¡œë¶€í„° ë§Œë“¤ê±°ë‚˜ ê²€ì¦ì„ ìœ„í•œ ì›¹í›…ì˜ ì½”ë”© ì„¸ë¶€ ì‚¬í•­ì— ëŒ€í•´ ë¬¼ì–´ë³´ì§€ëŠ” ì•Šì„ ê±°ë¼ê³  ìƒê°í•´ìš”.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nê·¸ ëŒ€ì‹ , ë‚˜ëŠ” ë” ê°€ëŠ¥ì„±ì´ ë†’ì€ ë„ì „ ê³¼ì œì— ëŒ€ë¹„í•˜ê³  ìˆì–´ìš”: ì–´ë–¤ ì…í•™ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì¼œì ¸ ìˆëŠ”ì§€ ë„ëŠ”ì§€ ì•Œì•„ë‚´ê³  ì´ëŸ¬í•œ ì„¤ì •ì„ ì–´ë–»ê²Œ ì¡°ì •í•˜ëŠ”ì§€ ì•Œì•„ë‚´ì•¼ í•´ìš”. ì´ê²ƒì€ CKSê°€ ì¶”êµ¬í•˜ëŠ” ê²ƒê³¼ ë” ì¼ì¹˜í•˜ëŠ”ë°, ì‹¤ì œ Kubernetes ë³´ì•ˆì—ì„œ ìš”êµ¬ë˜ëŠ” ì‹¤ìš©ì ì´ê³  ì‹¤ë¬´ì ì¸ ê¸°ìˆ ì— ë¶€í•©í•©ë‹ˆë‹¤.\n\n# ë§ˆë¬´ë¦¬: Kubernetesì˜ ë¬¸ì§€ê¸°ë“¤\n\nCKS ì‹œí—˜ ì¤€ë¹„ë¥¼ ì‹œì‘í•˜ê¸° ì „ì—, ì…í•™ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì¡´ì¬í•˜ëŠ” ê²ƒì¡°ì°¨ ëª°ëì–´ìš”. ì§€ê¸ˆì€ ëª‡ ê°œì˜ ì…í•™ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°°í¬ì— ë ˆì´ë¸”ê³¼ ê°™ì€ ê¸°ë³¸ì ì¸ ê²ƒë“¤ì„ ì¶”ê°€í–ˆì–´ìš”.\n\në‚˜ì˜ ê³µë¶€ë¥¼ í†µí•´, ë‹¤ì–‘í•œ ì‘ì—…ì„ ìœ„í•´ ì…í•™ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í™œìš©í•˜ëŠ” ë§ì€ ë„êµ¬ì™€ êµ¬í˜„ì„ ë°œê²¬í–ˆì–´ìš”. ì˜ˆë¥¼ ë“¤ì–´, íŠ¹ì • ì´ë¯¸ì§€ì˜ ìµœì‹  ë²„ì „ë§Œ ì‚¬ìš©ë˜ë„ë¡ í•˜ëŠ” ê²ƒê³¼ ê°™ì´ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ìŠ¤ìº”ì„ ì…í•™ ì»¨íŠ¸ë¡¤ëŸ¬ì™€ í†µí•©í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•´ìš”.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\në” ë‚˜ì•„ê°€ ëª‡ ê°€ì§€ ë„êµ¬ëŠ” ì…í•™ ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ê¸°ì´ˆë¥¼ ê¸°ë°˜ìœ¼ë¡œí•˜ì—¬, íŠ¹ì • ë³´ì•ˆ ì •ì±…ì„ êµ¬í˜„í•˜ëŠ” ê³¼ì •ì„ ê°„ì†Œí™”í•˜ëŠ” ê³„ì¸µì„ ì¶”ê°€í•©ë‹ˆë‹¤. ì‚¬ìš©ì ì •ì˜ ì •ì±… ì„¤ëª… ì–¸ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ êµ¬ì²´ì ì¸ ë³´ì•ˆ ì •ì±…ì„ êµ¬í˜„í•˜ëŠ” ê³¼ì •ì„ ë‹¨ìˆœí™”í•˜ëŠ” ë„êµ¬ë“¤ì´ ìˆìŠµë‹ˆë‹¤.\n\nê·¸ ì¤‘ í•˜ë‚˜ê°€ OPA ë˜ëŠ” Open Policy Agentì…ë‹ˆë‹¤. ì´ëŠ” CKS ì‹œí—˜ì˜ ìš”êµ¬ ì‚¬í•­ ì¤‘ í•˜ë‚˜ì¸ ê²ƒìœ¼ë¡œ ì•Œê³  ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ê¸€ì—ì„œ OPAì— ëŒ€í•´ ìì„¸íˆ ë‹¤ë£° ê³„íšì…ë‹ˆë‹¤.\n\nì—´ì‹¬íˆ ê³µë¶€í•˜ì„¸ìš”!","ogImage":{"url":"/assets/img/2024-06-19-MasteringKubernetesSecurityMyJourneyWithAdmissionControllers_0.png"},"coverImage":"/assets/img/2024-06-19-MasteringKubernetesSecurityMyJourneyWithAdmissionControllers_0.png","tag":["Tech"],"readingTime":7},{"title":"ì˜¨í”„ë ˆë¯¸ìŠ¤ ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ ê´€ë¦¬í˜• ì¿ ë²„ë„¤í‹°ìŠ¤","description":"","date":"2024-06-19 13:04","slug":"2024-06-19-On-PremisesKubernetesVsManagedKubernetes","content":"\n\nì¿ ë²„ë„¤í‹°ìŠ¤ëŠ” ì»¨í…Œì´ë„ˆí™”ëœ ì‘ìš© í”„ë¡œê·¸ë¨ì„ ê´€ë¦¬í•˜ëŠ” ê°•ë ¥í•œ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ ë„êµ¬ë¡œ, ë‹¤ì–‘í•œ ë°©ì‹ìœ¼ë¡œ ë°°í¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê°€ì¥ í”í•œ ë‘ ê°€ì§€ ë°©ë²•ì€ ì˜¨í”„ë ˆë¯¸ìŠ¤ ì¿ ë²„ë„¤í‹°ìŠ¤ì™€ ê´€ë¦¬í˜• ì¿ ë²„ë„¤í‹°ìŠ¤ì…ë‹ˆë‹¤. ì´ ì˜µì…˜ë“¤ì„ ì¼ìƒ ìƒí™œì—ì„œì˜ ê°„ë‹¨í•œ ë¹„ìœ ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„¤ëª…í•˜ê³ , ì„œë¡œ ë‹¤ë¥¸ ì ì„ ì´í•´í•˜ê³  ì–´ë–¤ ê²ƒì´ ë‹¹ì‹ ì˜ ìƒí™©ì— ê°€ì¥ ì í•©í•œì§€ ê²°ì •í•˜ëŠ” ë° ë„ì›€ì´ ë˜ë„ë¡ í•´ë³´ê² ìŠµë‹ˆë‹¤.\n\n![ì˜¨í”„ë ˆë¯¸ìŠ¤ ì¿ ë²„ë„¤í‹°ìŠ¤ ëŒ€ ê´€ë¦¬í˜• ì¿ ë²„ë„¤í‹°ìŠ¤](/assets/img/2024-06-19-On-PremisesKubernetesVsManagedKubernetes_0.png)\n\nì˜¨í”„ë ˆë¯¸ìŠ¤ ì¿ ë²„ë„¤í‹°ìŠ¤: ì§ì ‘ ê´€ë¦¬í•˜ëŠ” ë°©ì‹\n\nì˜¨í”„ë ˆë¯¸ìŠ¤ ì¿ ë²„ë„¤í‹°ìŠ¤ëŠ” ìë™ì°¨ë¥¼ ì†Œìœ í•˜ëŠ” ê²ƒê³¼ ê°™ìŠµë‹ˆë‹¤. ìë™ì°¨ë¥¼ ì†Œìœ í•˜ë©´ì„œ í•  ìˆ˜ ìˆëŠ” ê²ƒë“¤:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n1. êµ¬ë§¤ ë° ì„¤ì •: ì°¨ëŸ‰ì„ êµ¬ë§¤í•˜ë©°, ì´ëŠ” ë¹„ìš©ì´ ë§ì´ ë“¤ ìˆ˜ ìˆìœ¼ë©° ëª¨ë¸, ìƒ‰ìƒ ë° ê¸°ëŠ¥ ì„ íƒê³¼ ê°™ì€ ëª¨ë“  ì„¤ì •ì— ì±…ì„ì´ ìˆìŠµë‹ˆë‹¤.\n\n2. ìœ ì§€ ë³´ìˆ˜: ì˜¤ì¼ êµí™˜ë¶€í„° ë¸Œë ˆì´í¬ ìˆ˜ë¦¬ê¹Œì§€ ëª¨ë“  ìœ ì§€ ë³´ìˆ˜ë¥¼ ë‹¹ì‹ ì´ ì²˜ë¦¬í•´ì•¼ í•©ë‹ˆë‹¤. ì´ëŠ” ì°¨ëŸ‰ ê´€ë¦¬ ë°©ë²•ì„ ì•Œê±°ë‚˜ ì´ë¥¼ ë‹´ë‹¹í•  ì „ë¬¸ê°€ë¥¼ ê³ ìš©í•´ì•¼ í•œë‹¤ëŠ” ëœ»ì…ë‹ˆë‹¤.\n\n3. í†µì œ: ì°¨ëŸ‰ì„ ì™„ì „íˆ í†µì œí•©ë‹ˆë‹¤. ìš´ì „ ì‹œê°„ê³¼ ì¥ì†Œë¥¼ ê²°ì •í•˜ë©° ë§ˆìŒê» ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n4. ë¹„ìš©: ì´ˆê¸° ë¹„ìš©ê³¼ ê³„ì†ë˜ëŠ” ìœ ì§€ ë³´ìˆ˜ ë¹„ìš©ì´ ìˆì§€ë§Œ ë§¤ë‹¬ ëŒ€ì—¬ë£ŒëŠ” ì—†ìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\në™ì¼í•œ ë°©ì‹ìœ¼ë¡œ, ì˜¨í”„ë ˆë¯¸ìŠ¤ KubernetesëŠ” ë‹¤ìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤:\n\n- ì¸í”„ë¼ ì†Œìœ ê¶Œ: Kubernetesê°€ ì‹¤í–‰ë˜ëŠ” ì„œë²„ì™€ í•˜ë“œì›¨ì–´ë¥¼ ì†Œìœ í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ ì¸í”„ë¼ë¥¼ êµ¬ë§¤, ì„¤ì • ë° ìœ ì§€ë³´ìˆ˜í•´ì•¼ í•©ë‹ˆë‹¤.\n\n- ì™„ì „í•œ ì œì–´: Kubernetes í™˜ê²½ì„ ì™„ì „íˆ ì œì–´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. íŠ¹ì •í•œ ìš”êµ¬ ì‚¬í•­ì— ë§ê²Œ í™•ì¥í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n- ìœ ì§€ë³´ìˆ˜ ì±…ì„: ëª¨ë“  ì—…ë°ì´íŠ¸, íŒ¨ì¹˜ ë° ì‹œìŠ¤í…œ ëª¨ë‹ˆí„°ë§ì— ëŒ€í•œ ì±…ì„ì´ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ ì ì ˆí•œ ì „ë¬¸ ì§€ì‹ì„ ê°€ì§„ íŒ€ì´ í•„ìš”í•©ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nâ€¢ ë¹„ìš© ê³ ë ¤ ì‚¬í•­: í•˜ë“œì›¨ì–´ ë° ì†Œí”„íŠ¸ì›¨ì–´ì— ìƒë‹¹í•œ ì´ˆê¸° ë¹„ìš©ì´ ë“¤ì§€ë§Œ, í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ì™€ ê´€ë ¨ëœ ë°˜ë³µ ë¹„ìš©ì„ í”¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n## ê´€ë¦¬í˜• Kubernetes: ì°¨ë¥¼ ë¹Œë¦¬ëŠ” ê²ƒ\n\nê´€ë¦¬í˜• KubernetesëŠ” ì°¨ë¥¼ ë¹Œë¦¬ëŠ” ê²ƒê³¼ ë¹„ìŠ·í•©ë‹ˆë‹¤:\n\n1. ì‰¬ìš´ ì ‘ê·¼: ë Œí„°ì¹´ íšŒì‚¬ì—ì„œ ì°¨ë¥¼ ì„ íƒí•˜ê³  ì¤€ë¹„ëœ ì°¨ëŸ‰ì„ ì œê³µë°›ìŠµë‹ˆë‹¤. êµ¬ë§¤ í”„ë¡œì„¸ìŠ¤ë¥¼ ê±±ì •í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n2. ìœ ì§€ë³´ìˆ˜ê°€ í•„ìš” ì—†ìŒ: ë Œíƒˆ íšŒì‚¬ê°€ ëª¨ë“  ìœ ì§€ë³´ìˆ˜ì™€ ìˆ˜ë¦¬ë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤. ì°¨ëŸ‰ì´ ê³ ì¥ë‚˜ë©´ ë‹¤ë¥¸ ì°¨ëŸ‰ì„ ì œê³µí•´ì¤ë‹ˆë‹¤.\n\n3. í¸ë¦¬í•¨: í•„ìš”í•  ë•Œì—ë§Œ ì°¨ëŸ‰ì„ ë Œíƒˆí•  ìˆ˜ ìˆì–´ ì¥ê¸°ê°„ì˜ ì•½ì •ì´ë‚˜ ìœ ì§€ë³´ìˆ˜ ê±±ì • ì—†ì´ ì´ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n4. ë°˜ë³µ ë¹„ìš©: ë Œíƒˆ ë¹„ìš©ì„ ì§€ë¶ˆí•˜ë©´ ì°¨ëŸ‰ ì´ìš©ê³¼ ìœ ì§€ë³´ìˆ˜ ì„œë¹„ìŠ¤ê°€ ëª¨ë‘ í¬í•¨ë©ë‹ˆë‹¤.\n\n## ê´€ë¦¬í˜• ì¿ ë²„ë„¤í‹°ìŠ¤ëŠ” ë¹„ìŠ·í•œ ë°©ì‹ìœ¼ë¡œ ì‘ë™í•©ë‹ˆë‹¤:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n- ì„œë¹„ìŠ¤ ì œê³µì—…ì²´: Google Kubernetes Engine (GKE), Amazon Elastic Kubernetes Service (EKS), ë˜ëŠ” Azure Kubernetes Service (AKS)ì™€ ê°™ì€ í´ë¼ìš°ë“œ ì œê³µì—…ì²´ê°€ ì¸í”„ë¼ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.\n\n- ì‚¬ìš© í¸ì˜ì„±: ì œê³µì—…ì²´ê°€ ì„¤ì •, ìœ ì§€ ê´€ë¦¬ ë° ì—…ë°ì´íŠ¸ë¥¼ ì²˜ë¦¬í•˜ë¯€ë¡œ ì‹œì‘í•˜ê³  ìš´ì˜í•˜ê¸° ì‰¬ì›Œì§‘ë‹ˆë‹¤.\n\n- ìœ ì§€ë³´ìˆ˜ ì—†ìŒ: í´ë¼ìš°ë“œ ì œê³µì—…ì²´ê°€ ëª¨ë“  ì—…ë°ì´íŠ¸, ë³´ì•ˆ íŒ¨ì¹˜ ë° ëª¨ë‹ˆí„°ë§ì„ ì²˜ë¦¬í•˜ì—¬ íŒ€ì— ë¶€ë‹´ì„ ì¤„ì—¬ì¤ë‹ˆë‹¤.\n\n- ì¬ë°œìƒ ë¹„ìš©: ì‚¬ìš©ëŸ‰ì— ë”°ë¼ ì„œë¹„ìŠ¤ë¥¼ ì§€ë¶ˆí•˜ë¯€ë¡œ ì¸í”„ë¼ë¥¼ ì†Œìœ í•˜ëŠ” ê²ƒë³´ë‹¤ ì˜ˆì¸¡ ê°€ëŠ¥í•˜ê³  í™•ì¥ ê°€ëŠ¥í•œ ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n## ì–´ë–¤ ê²ƒì´ ë‹¹ì‹ ì—ê²Œ ê°€ì¥ ì í•©í• ê¹Œìš”?\n\nì˜¨í”„ë ˆë¯¸ìŠ¤ì™€ ê´€ë¦¬í˜• ì¿ ë²„ë„¤í‹°ìŠ¤ ì¤‘ ì–´ë–¤ ê²ƒì„ ì„ íƒí• ì§€ëŠ” ë‹¹ì‹ ì˜ íŠ¹ì • í•„ìš”ì™€ ìƒí™©ì— ë”°ë¼ ë‹¤ë¦…ë‹ˆë‹¤. ëª‡ ê°€ì§€ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤:\n\nì˜¨í”„ë ˆë¯¸ìŠ¤ ì¿ ë²„ë„¤í‹°ìŠ¤ê°€ ê°€ì¥ ì í•©í•œ ê²½ìš°:\n1. ì™„ë²½í•œ í†µì œê°€ í•„ìš”í•œ ê²½ìš°: ê·œì œ ìš”ê±´, ë°ì´í„° ì†Œìœ ê¶Œ ë¬¸ì œ ë˜ëŠ” íŠ¹ì • ë§ì¶¤í™” ìš”êµ¬ì‚¬í•­ìœ¼ë¡œ ì¸í•´ ì¸í”„ë¼ì— ëŒ€í•œ ì™„ë²½í•œ í†µì œê°€ í•„ìš”í•œ ê²½ìš°.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n2. ê¸°ì¡´ ì¸í”„ë¼: ì˜¨í”„ë ˆë¯¸ìŠ¤ í•˜ë“œì›¨ì–´ì— ìƒë‹¹í•œ íˆ¬ìë¥¼ ì´ë¯¸ í–ˆìœ¼ë©° íš¨ìœ¨ì ìœ¼ë¡œ í™œìš©í•˜ê³  ì‹¶ìŠµë‹ˆë‹¤.\n\n3. ë¹„ìš© ê´€ë¦¬: íŠ¹íˆ í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ì™€ ê´€ë ¨ëœ ë°˜ë³µ ë¹„ìš© ëŒ€ì‹  í•˜ë“œì›¨ì–´ì— ì„ ìˆœìœ„ íˆ¬ìë¥¼ ì„ í˜¸í•©ë‹ˆë‹¤.\n\nê´€ë¦¬í˜• KubernetesëŠ” ë‹¤ìŒ ìƒí™©ì— ê°€ì¥ ì í•©í•©ë‹ˆë‹¤:\n\n- í™•ì¥ì„±: ìˆ˜ìš”ì— ë”°ë¼ ìš´ì˜ì„ ìœ ì—°í•˜ê²Œ í™•ì¥ ë˜ëŠ” ì¶•ì†Œí•  ìˆ˜ ìˆëŠ” ìœ ì—°ì„±ì´ í•„ìš”í•©ë‹ˆë‹¤. íŠ¹íˆ ì´ˆê¸°ì—ëŠ” ë¹ ë¥´ê²Œ ì„±ì¥í•˜ê±°ë‚˜ ë³€ë™í•˜ëŠ” ì›Œí¬ë¡œë“œë¥¼ ê²½í—˜í•˜ëŠ” ìŠ¤íƒ€íŠ¸ì—… ë° ê¸°ì—…ì— ìœ ë¦¬í•©ë‹ˆë‹¤.\n- ì „ë¬¸ ì§€ì‹: Kubernetes í™˜ê²½ì„ íš¨ê³¼ì ìœ¼ë¡œ ê´€ë¦¬í•˜ëŠ” ë° í•„ìš”í•œ ë‚´ë¶€ ì „ë¬¸ ì§€ì‹ì´ ë¶€ì¡±í•©ë‹ˆë‹¤. ê´€ë¦¬í˜• ì„œë¹„ìŠ¤ëŠ” Kubernetes ìš´ì˜ì˜ ë³µì¡ì„±ì„ ë‹¤ë£¨ëŠ” ì „ë¬¸ê°€ íŒ€ì— ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.\n- ì†ë„: ì˜¨í”„ë ˆë¯¸ìŠ¤ ì¸í”„ë¼ë¥¼ ì„¤ì •í•˜ê³  ìœ ì§€í•˜ëŠ” ë° ì—°ê´€ëœ ì§€ì—° ì—†ì´ ê°€ëŠ¥í•œ ë¹¨ë¦¬ ì‘ìš© í”„ë¡œê·¸ë¨ì„ ê°€ë™í•˜ê³  ì‹¶ìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n## ê²°ì • ìš”ì†Œë“¤\n\nì˜¨í”„ë ˆë¯¸ìŠ¤ì™€ ê´€ë¦¬í˜• ì¿ ë²„ë„¤í‹°ìŠ¤ ì‚¬ì´ë¥¼ ê²°ì •í•  ë•Œ ê³ ë ¤í•´ì•¼ í•  ëª‡ ê°€ì§€ ì¶”ê°€ ìš”ì†Œê°€ ìˆìŠµë‹ˆë‹¤:\n\n- ê·œì • ì¤€ìˆ˜ì™€ ë³´ì•ˆ: ê·€í•˜ì˜ ì‚°ì—…ì— ë”°ë¼ ê·œì • ìš”êµ¬ì‚¬í•­ì´ ë°ì´í„°ë¥¼ ì–´ë””ì—ì„œ ì–´ë–»ê²Œ ê´€ë¦¬í•´ì•¼ í•˜ëŠ”ì§€ë¥¼ ê²°ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í´ë¼ìš°ë“œ ì œê³µì—…ì²´ëŠ” ë†’ì€ ìˆ˜ì¤€ì˜ ë³´ì•ˆì„ ì œê³µí•˜ê³  ì¢…ì¢… ë‹¤ì–‘í•œ ê·œì •ì„ ì¤€ìˆ˜í•˜ì§€ë§Œ íŠ¹ì • ë°ì´í„°ëŠ” íŠ¹ì • ìƒí™©ì—ì„œ ë‚´ë¶€ì— ë³´ê´€í•´ì•¼ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.\n- ì¥ê¸° ë¹„ìš©: ê´€ë¦¬í˜• ì¿ ë²„ë„¤í‹°ìŠ¤ëŠ” ì¥ê¸°ì ìœ¼ë¡œ ë” ë¹„ì‹¸ì§€ë§Œ, ê·¸ ëŒ€ê°€ëŠ” ì±…ì„ì„ ì¤„ì´ê³  ì ì¬ì ìœ¼ë¡œ ë‚®ì€ ìš´ì˜ ë¦¬ìŠ¤í¬ê°€ ë”°ë¦…ë‹ˆë‹¤. ê·¸ì— ë°˜í•´, ì˜¨í”„ë ˆë¯¸ìŠ¤ ì¿ ë²„ë„¤í‹°ìŠ¤ëŠ” ì²˜ìŒì—ëŠ” ë¹„ìš©ì´ ë” ë“¤ì§€ë§Œ ì§€ì†ì ì¸ ìš´ì˜ ë¹„ìš©ì´ ë‚®ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n- í˜ì‹ ê³¼ ì—…ê·¸ë ˆì´ë“œ: í´ë¼ìš°ë“œ ì œê³µì—…ì²´ë“¤ì€ ì§€ì†ì ìœ¼ë¡œ ì„œë¹„ìŠ¤ë¥¼ ì—…ë°ì´íŠ¸í•˜ì—¬ ìµœì‹  ê¸°ëŠ¥ê³¼ ë³´ì•ˆ í–¥ìƒì„ ì œê³µí•©ë‹ˆë‹¤. ì˜¨í”„ë ˆë¯¸ìŠ¤ ì¿ ë²„ë„¤í‹°ìŠ¤ë¥¼ ì‚¬ìš©í•  ê²½ìš° ê·€í•˜ì˜ íŒ€ì€ ì´ëŸ¬í•œ ì—…ë°ì´íŠ¸ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ê´€ë¦¬í•´ì•¼ í•˜ë©°, ì´ëŠ” ìƒˆë¡œìš´ ê¸°ëŠ¥ì— ì ‘ê·¼í•˜ëŠ” ë° ì‹œê°„ì´ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nì—¬ê¸°ê¹Œì§€ì…ë‹ˆë‹¤...\nì°¨ë¥¼ êµ¬ë§¤í• ì§€ ë ŒíŠ¸í• ì§€ ì„ íƒí•˜ëŠ” ê²ƒì€ ê·€í•˜ì˜ ì¬ì •ì  ë° ê¸°ìˆ ì  ìš”êµ¬ì‚¬í•­ ë° ìƒí™©ì— ë‹¬ë ¤ ìˆìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nìœ„ ë¬¸ì„œë¥¼ ì½ì–´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤ ğŸ™ \në” ë§ì€ ìœ ìš©í•œ ì½˜í…ì¸ ë¥¼ ë³´ì‹œë ¤ë©´ ì œ ë¸”ë¡œê·¸ë¥¼ íŒ”ë¡œìš°í•´ ì£¼ì„¸ìš”. ë†“ì¹˜ì§€ ì•Šìœ¼ë ¤ë©´ êµ¬ë…ë„ ìŠì§€ ë§ì•„ ì£¼ì„¸ìš”.","ogImage":{"url":"/assets/img/2024-06-19-On-PremisesKubernetesVsManagedKubernetes_0.png"},"coverImage":"/assets/img/2024-06-19-On-PremisesKubernetesVsManagedKubernetes_0.png","tag":["Tech"],"readingTime":4},{"title":"ì–´ë µê²Œ ë°°ìš´ êµí›ˆ Ciliumì˜ ê¸°ë³¸ Pod CIDRì„ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”","description":"","date":"2024-06-19 13:03","slug":"2024-06-19-LearneditthehardwayDontuseCiliumsdefaultPodCIDR","content":"\n\nì „ eBPFì— ìƒë‹¹íˆ ì˜¤ë«ë™ì•ˆ ê´€ì—¬í•´ ì™”ìŠµë‹ˆë‹¤. ìš°ë¦¬ íŒ€ì¥ì´ Azure CNIì—ì„œ Cilium CNIë¡œ ëª¨ë“  í´ëŸ¬ìŠ¤í„°ë¥¼ ë¼ì´ë¸Œ ì´ì „í•˜ëŠ” ê²ƒì„ ì œì•ˆí–ˆì„ ë•Œ, ê¸°íšŒì— ë°”ë¡œ ë›°ì–´ë“¤ì—ˆì–´ìš”. ì´ ì¼ì€ ë‚´ê°€ ì§€ê¸ˆê¹Œì§€ ë§¡ì•˜ë˜ ê°€ì¥ í˜ë“  ì¼ ì¤‘ í•˜ë‚˜ì˜€ì§€ë§Œ, ê·¸ ì‹œê°„ ë™ì•ˆ ì¦ê±°ì› ì–´ìš”.\n\ní•˜ì§€ë§Œ, ê·¸ ì´ì•¼ê¸°ëŠ” ë‹¤ìŒì— í•˜ê¸°ë¡œ í•´ìš”. ì´ ê¸°ì‚¬ì˜ ëª©í‘œëŠ” ì œ ê°œì¸ì ì¸ k8s.af ì´ì•¼ê¸° ì¤‘ í•˜ë‚˜ë¥¼ í•´ì„¤í•˜ì—¬, ë¨¸ë¦¬ì¹´ë½ì„ ëª‡ ì¼ ì ˆì•½í•  ìˆ˜ ìˆëŠ” ëˆ„êµ°ê°€ë¥¼ ë•ëŠ” ê²ƒì…ë‹ˆë‹¤.\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-19-LearneditthehardwayDontuseCiliumsdefaultPodCIDR_0.png)\n\n## ì™œ Ciliumì„ ì„ íƒí–ˆëŠ”ê°€?\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nCiliumì„ ì„ íƒí•œ ìš°ë¦¬ì˜ ì£¼ìš” ëª©í‘œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:\n\n- ë” ë‚˜ì€ ë„¤íŠ¸ì›Œí¬ ê²©ë¦¬: ì¼ë¶€ í´ëŸ¬ìŠ¤í„°ì—ì„œëŠ” ê³ ê°ì˜ ì‘ì—… ë¶€í•˜ë¥¼ ì‹¤í–‰í•˜ê³  ìˆê¸° ë•Œë¬¸ì— ì¶œë°œ íŠ¸ë˜í”½ì„ íš¨ê³¼ì ìœ¼ë¡œ ê³µìœ í•˜ê³  ì œì–´í•´ì•¼ í–ˆìŠµë‹ˆë‹¤.\n- WireGuardë¥¼ ì‚¬ìš©í•œ íˆ¬ëª…í•œ ì•”í˜¸í™”: ê³µìœ  í´ëŸ¬ìŠ¤í„°ì—ì„œëŠ” ì œë¡œ íŠ¸ëŸ¬ìŠ¤íŠ¸ ì ‘ê·¼ ë°©ì‹ì„ ì±„íƒí•˜ê³ ì í–ˆìŠµë‹ˆë‹¤.\n- ê´€ì°° ê°€ëŠ¥ì„±: Ciliumì€ ë‹¤ì–‘í•œ ê´€ì°° ê¸°ëŠ¥ì„ ê°–ì¶”ê³  ìˆì–´ ì¶”ê°€ ê³„ì¸¡ì—†ì´ Kubernetes ì‘ì—… ë¶€í•˜ë¥¼ ëª¨ë‹ˆí„°ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n- ì„œë¹„ìŠ¤ ë©”ì‹œ ê¸°ëŠ¥: Ciliumì€ ì‚¬ì´ë“œì¹´ë¥¼ í•„ìš”ë¡œí•˜ì§€ ì•Šê³  ë‹¤ì‹œ ì‹œë„ ë° íšŒë¡œ ì°¨ë‹¨ê³¼ ê°™ì€ ì„œë¹„ìŠ¤ ë©”ì‰¬ ê¸°ëŠ¥ì„ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n- íš¨ìœ¨ì ì´ê³  ê°€ë²¼ìš´ ë„¤íŠ¸ì›Œí¬ ìŠ¤íƒ: í•˜ë“œì›¨ì–´ ë¹„ìš©ì„ ë‚®ì¶”ë©´ì„œ ë” ë‚˜ì€ ì„±ëŠ¥ì„ ì›í•˜ì‹ ë‹¤ë©´ ì €í¬ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”!\n- í´ëŸ¬ìŠ¤í„° ë§¤ì‹œ ë§: ìš°ë¦¬ëŠ” ì¸í”„ë¼ë¥¼ ë¯¸ë˜ì— ëŒ€ë¹„í•˜ê¸° ìœ„í•´ ì¤€ë¹„í•˜ê³  ì‹¶ì—ˆìŠµë‹ˆë‹¤.\n\nì´ì£¼ í›„ ëª¨ë“  ê²ƒì´ ì›í™œí–ˆìŠµë‹ˆë‹¤ (ëŒ€ë¶€ë¶„...). Ciliumì„ ê¸°ë°˜ìœ¼ë¡œ ê°œë°œí•œ ê¸°ëŠ¥ì„ ì¶œì‹œí•˜ê¸° ì‹œì‘í–ˆê³  ê³ ê°ë“¤ë¡œë¶€í„° ì¢‹ì€ í”¼ë“œë°±ì„ ë°›ì•˜ìŠµë‹ˆë‹¤.\n\nê·¸ë¦¬ê³  ëª¨ë“ ê²Œ ì¢‹ì•˜ëŠ”ë°...\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# ì‚¬ê±´\n\nì¼ë°˜ì ì¸ ì›”ìš”ì¼ ì•„ì¹¨ì´ì—ˆê³ , ë§¤ì¼ ë¦´ë¦¬ìŠ¤ ì£¼ê¸°ì˜ ì¼í™˜ìœ¼ë¡œ SRE íŒ€ì€ ì½”ì–´ ì„œë¹„ìŠ¤ì˜ ìµœì‹  ì—…ë°ì´íŠ¸ë¥¼ ìŠ¤í…Œì´ì§• í™˜ê²½ìœ¼ë¡œ í”„ë¡œëª¨ì…˜í–ˆìŠµë‹ˆë‹¤.\n\nê·¸ëŸ¬ë‚˜ í”„ë¡œëª¨ì…˜ íŒŒì´í”„ë¼ì¸ì´ ì™„ë£Œë˜ìë§ˆì ìš°ë¦¬ì˜ ì—…íƒ€ì„ ëª¨ë‹ˆí„°ë§ ì†”ë£¨ì…˜ì´ ìŠ¤í…Œì´ì§• í™˜ê²½ì— ì ‘ê·¼í•  ìˆ˜ ì—†ë‹¤ëŠ” ì´ë²¤íŠ¸ë¥¼ íŠ¸ë¦¬ê±°í•˜ë©´ì„œ ë°œìƒí–ˆìŠµë‹ˆë‹¤. SRE íŒ€ì€ ì¦‰ì‹œ ë¬¸ì œì˜ ê·¼ë³¸ ì›ì¸ì„ ì¡°ì‚¬í•˜ê¸° ì‹œì‘í–ˆìŠµë‹ˆë‹¤.\n\në” ê¹Šì´ íŒŒê³ ë“¤ê¸° ì „ì—, ë¹ ë¥¸ ë‹¤ì´ì–´ê·¸ë¨ì„ ì‚¬ìš©í•˜ì—¬ ìš°ë¦¬ì˜ ë„¤íŠ¸ì›Œí¬ ì•„í‚¤í…ì²˜(ê°„ì†Œí™”ëœ ë²„ì „)ë¥¼ ì„¤ëª…í•´ ë“œë¦¬ê² ìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n\u003cimg src=\"/assets/img/2024-06-19-LearneditthehardwayDontuseCiliumsdefaultPodCIDR_1.png\" /\u003e\n\në‘ ê°œì˜ í´ëŸ¬ìŠ¤í„°ê°€ ìˆìŠµë‹ˆë‹¤. í•˜ë‚˜ëŠ” ì™¸ë¶€ì— ê³µê°œë˜ì–´ ìˆê³ , ë‹¤ë¥¸ í•˜ë‚˜ëŠ” ë¹„ê³µê°œì…ë‹ˆë‹¤. ì™¸ë¶€ í´ëŸ¬ìŠ¤í„°ëŠ” ë°©í™”ë²½ì„ í†µí•´ ë…¸ì¶œë˜ì–´ ìˆìŠµë‹ˆë‹¤. ë¹„ê³µê°œ í´ëŸ¬ìŠ¤í„°ì˜ ì¼ë¶€ ì„œë¹„ìŠ¤ëŠ” ë¡œë“œ ë°¸ëŸ°ì„œë¥¼ í†µí•´ ì™¸ë¶€ í´ëŸ¬ìŠ¤í„°ì™€ í†µì‹ í•©ë‹ˆë‹¤.\n\nì´ˆê¸° ë””ë²„ê¹… í›„, SRE íŒ€ì€ ë¬¸ì œê°€ ë°©í™”ë²½ê³¼ í´ëŸ¬ìŠ¤í„° 1ì˜ ì¸ê·¸ë ˆìŠ¤ ì„œë¹„ìŠ¤ ê°„ì˜ ì—°ê²°ì— ìˆëŠ” ê²ƒìœ¼ë¡œ ê²°ë¡  ë‚´ë ¸ìŠµë‹ˆë‹¤. í´ëŸ¬ìŠ¤í„° 1 ë‚´ì˜ ëª¨ë“  ì„œë¹„ìŠ¤ê°€ ì‹¤í–‰ë˜ê³  í´ëŸ¬ìŠ¤í„° 1ì˜ ë¡œë“œ ë°¸ëŸ°ì„œë¥¼ í–¥í•´ ìš”ì²­ì„ ë³´ë‚´ê³  ìˆê¸° ë•Œë¬¸ì— í´ëŸ¬ìŠ¤í„° 2ì˜ podë“¤ì´ ì‘ë™ ì¤‘ì´ì—ˆìŠµë‹ˆë‹¤.\n\nWiresharkì™€ Hubbleì„ í†µí•´, ë°©í™”ë²½ì—ì„œ ì „ì†¡ëœ \"SYN\" íŒ¨í‚·ì´ ì„œë¹„ìŠ¤ì— ë„ë‹¬í–ˆì§€ë§Œ ì„œë¹„ìŠ¤ë¡œë¶€í„° í•´ë‹¹í•˜ëŠ” \"ACK\" íŒ¨í‚·ì´ ì „ì†¡ë˜ì§€ ì•Šì•˜ìŒì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\në¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ëª‡ ì°¨ë¡€ì˜ ë¬´ì‚°ëœ ì‹œë„ ëì— SRE íŒ€ì€ í”„ë¡œë•ì…˜ìœ¼ë¡œì˜ ë¦´ë¦¬ìŠ¤ë¥¼ ìŠ¹ì¸í–ˆìŠµë‹ˆë‹¤. ì¤‘ìš”í•œ ìˆ˜ì • ì‚¬í•­ì„ ê°€ëŠ¥í•œ ë¹¨ë¦¬ ë¦´ë¦¬ì¦ˆí•´ì•¼ í–ˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ì´ ê²°ì •ì˜ ê·¼ê±°ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ìˆ˜ì¤€ì˜ ë³€ê²½ì´ ì¸í”„ë¼ë¥¼ ì†ìƒì‹œí‚¬ ìˆ˜ ì—†ìœ¼ë©°, ì´ ì¼ì€ ê²©ë¦¬ëœ ì‚¬ê±´ì´ì—ˆìŠµë‹ˆë‹¤.\n\nê·¸ëŸ¬ë‚˜ ë¦´ë¦¬ìŠ¤ê°€ í”„ë¡œë•ì…˜ìœ¼ë¡œ ìŠ¹ê¸‰ë˜ìë§ˆì í”„ë¡œë•ì…˜ ë¡œë“œ ë°¸ëŸ°ì„œë„ ì‘ë‹µì„ ì¤‘ë‹¨í–ˆìŠµë‹ˆë‹¤. SRE íŒ€ì€ ì‹ ì†í•˜ê²Œ ë³€ê²½ ì‚¬í•­ì„ ë¡¤ë°±í•˜ì—¬ í”„ë¡œë•ì…˜ì—ì„œ ë¬¸ì œë¥¼ í•´ê²°í–ˆìŠµë‹ˆë‹¤. ë†€ëê²Œë„ ìŠ¤í…Œì´ì§• í´ëŸ¬ìŠ¤í„°ì—ì„œ ë³€ê²½ ì‚¬í•­ì„ ë¡¤ë°±í•´ë„ ë¬¸ì œê°€ í•´ê²°ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.\n\n## ì¬ì•™ì´ ê³„ì†ë©ë‹ˆë‹¤\n\nìŠ¤í…Œì´ì§•ì—ì„œì˜ ë¬¸ì œê°€ ì—¬ì „íˆ í•´ê²°ë˜ì§€ ì•Šì•„ ì „ë¬¸ ë„¤íŠ¸ì›Œí¬ ì „ë¬¸ê°€ì™€ í•¨ê»˜ ì „íˆ¬ì‹¤ì— í˜¸ì¶œë˜ì—ˆìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì§€ê¸ˆì¯¤ SRE íŒ€ì€ ê´‘ë²”ìœ„í•œ ì‹¤í—˜ì„ í†µí•´ ë§ì€ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í–ˆìŠµë‹ˆë‹¤. ìš°ë¦¬ VPC ë‚´ì˜ ë‹¤ë¥¸ ì„œë¸Œë„·ì— VMì„ ë°°í¬í•˜ëŠ” ì‹¤í—˜ì„ í•´ë³´ì•˜ëŠ”ë°, ë¡œì»¬ ë…¸ë“œ í’€ ì„œë¸Œë„·ë¶€í„° ë‹¤ë¥¸ í´ëŸ¬ìŠ¤í„°ì— ì†í•œ ì›ê²© ì„œë¸Œë„·, ë¡œë“œ ë°¸ëŸ°ì„œ ì„œë¸Œë„·ê¹Œì§€ ë‹¤ì–‘í•œ ê³³ì— ì‹œë„í•´ë´¤ìŠµë‹ˆë‹¤. ëª¨ë“  ê²ƒì´ ì˜ˆìƒëŒ€ë¡œ ì‘ë™ë˜ì—ˆëŠ”ë°, ë°©í™”ë²½ì„ í†µí•´ í†µê³¼í•˜ëŠ” íŠ¸ë˜í”½ì—ì„œ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\n\nì œê°€ ë…¸ë ¥ì— í•©ë¥˜í•˜ë©´ì„œ, ê·¸ë“¤ì´ ìˆ˜ì§‘í•œ ëª¨ë“  ë°ì´í„°ë¥¼ ì² ì €íˆ ê²€í† í–ˆê³ , ì—¬ëŸ¬ ì¢…ë¥˜ì˜ ì›Œí¬ë¡œë“œë¥¼ ë°°í¬í•˜ê³  Hubbleê³¼ Wireshark ë¡œê·¸ë¥¼ ë¶„ì„í•˜ë©° ë” ë§ì€ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í–ˆìŠµë‹ˆë‹¤. ë£¨íŠ¸ ì›ì¸ì„ ë°í ìˆ˜ ìˆëŠ” ë‹¨ì„œë‚˜ ëˆ„ë½ëœ ë¶€ë¶„ì„ ì°¾ê¸° ìœ„í•´ ë…¸ë ¥í–ˆìŠµë‹ˆë‹¤.\n\nAzure ë„¤íŠ¸ì›Œí¬ ì—”ì§€ë‹ˆì–´ê°€ í•©ë¥˜í•˜ë©´ì„œ, SRE íŒ€ì€ ê·¸ë“¤ì´ ì§€ê¸ˆê¹Œì§€ í•œ ëª¨ë“  ë‹¨ê³„ì— ëŒ€í•´ ì„¤ëª…í–ˆìŠµë‹ˆë‹¤. ìˆ˜ì§‘í•œ ë°ì´í„°ë¥¼ ë¶„ì„í•œ í›„, ì—”ì§€ë‹ˆì–´ëŠ” ë°©í™”ë²½ ì„œë¸Œë„· ë‚´ì— VMì„ ë°°í¬í•˜ê³  ë¬¸ì œê°€ ìˆëŠ” Kubernetes í´ëŸ¬ìŠ¤í„°ë¡œ TCP ì—°ê²°ì„ ì‹œë„í•˜ë¼ëŠ” ì œì•ˆì„ í–ˆìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì €í¬ SRE íŒ€ì€ ë°©í™”ë²½ ì„œë¸Œë„· ë‚´ì— ì„ì‹œ VMì„ ë¹ ë¥´ê²Œ ì„¤ì •í•˜ê³  ë¡œë“œ ë°¸ëŸ°ì„œ IPë¡œ telnetì„ ì‹œë„í•´ ë³´ì•˜ì–´ìš”. ì´ í…ŒìŠ¤íŠ¸ ì¤‘ì— ìš°ë¦¬ê°€ ì§ë©´í•œ ë™ì¼í•œ ë¬¸ì œë¥¼ ê´€ì°°í–ˆëŠ”ë°, telnet ì—°ê²°ì´ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ì–´ìš”. ê·¸ë˜ì„œ ê·¸ë“¤ì€ ë°©í™”ë²½ ì„œë¸Œë„·ê³¼ ë¡œë“œ ë°¸ëŸ°ì„œ ì„œë¸Œë„· ë˜ëŠ” ë…¸ë“œ í’€ ì„œë¸Œë„· ê°„ ë„¤íŠ¸ì›Œí¬ í”¼ì–´ë§ì— ë¬¸ì œê°€ ìˆëŠ”ì§€ ì¡°ì‚¬í•˜ê¸°ë¡œ ê²°ì •í–ˆì–´ìš”.\n\ní˜¸ê¸°ì‹¬ì— ì €ëŠ” ë‹¤ë¥¸ SRE ë©¤ë²„ì—ê²Œ ì„œë²„ì— ë‹¤ì‹œ pingì„ ì‹œë„í•˜ë„ë¡ ìš”ì²­í•˜ê³  Hubble ë¡œê·¸ë¥¼ ëª¨ë‹ˆí„°ë§í–ˆì–´ìš”. ë†€ëê²Œë„, telnetì´ ì‹œì‘ëœ ìˆœê°„ì— SYN íŒ¨í‚·ì´ ìˆ˜ì‹ ë˜ì—ˆì§€ë§Œ \"ACK\"ì€ ì „ë‹¬ë˜ì§€ ì•Šì•˜ì–´ìš”.\n\nì´ í–‰ë™ì€ ì´ìƒí•˜ê²Œ ë³´ì˜€ê¸° ë•Œë¬¸ì— ì„ì‹œ VMì—ì„œ í¬íŠ¸ë¥¼ ì—´ë„ë¡ ìš”ì²­í•˜ê³  ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì—ì„œ í•´ë‹¹ VMìœ¼ë¡œ pingì„ ì‹œë„í•´ ë³´ì•˜ì–´ìš”. í•˜ì§€ë§Œ ì‘ë‹µì´ ì—†ì—ˆê³ , ì„ì‹œ VMì— Wiresharkë¥¼ ì„¤ì¹˜í•œ í›„ì—ë„ ë“¤ì–´ì˜¤ëŠ” SYN íŒ¨í‚·ì„ ë³¼ ìˆ˜ ì—†ì—ˆì–´ìš”. í¥ë¯¸ë¡œìš´ ì ì€ ë°©í™”ë²½ ì„œë¸Œë„·ì„ ì œì™¸í•œ ë‹¤ë¥¸ ëª©ì ì§€ë¡œ pingì„ ì‹œë„í•˜ë©´ ë¬¸ì œê°€ ì—†ì—ˆë‹¤ëŠ” ì ì´ì—ˆì–´ìš”.\n\nì˜ì•„í•´í•˜ë©°, ê·¸ë“¤ì—ê²Œ ë…¸ë“œ í’€ ì„œë¸Œë„·ì— ìƒì„±í•œ ì„ì‹œ VMì„ ì‚¬ìš©í•˜ì—¬ ë™ì¼í•œ í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•´ ë³´ë¼ê³  ìš”ì²­í–ˆë”ë‹ˆ, ë“œë””ì–´ ì‘ë™í–ˆì–´ìš”.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# ë£¨íŠ¸ ì›ì¸\n\nì´ëŸ¬í•œ ë™ì‘ì´ ì´ìƒí•˜ë‹¤ê³  ìƒê°í•´, ì£¼ìš” ì‚¬ê³  ëŒ€ì‘ íŒ€ êµ¬ì„±ì›ë“¤ì˜ ì‘ì—…ì„ ë°©í•´í•˜ê³  ìˆëŠ” í”¼ì–´ë§ì„ ì ê²€ ì¤‘ì´ì—ˆë˜ ë©¤ë²„ë“¤ì—ê²Œ ì–˜ê¸°í–ˆì–´ìš”. ë¬¸ì œê°€ ì¸ê·¸ë ˆìŠ¤ê°€ ì•„ë‹ˆë¼ ì´ê·¸ë ˆìŠ¤ì— ë¬¸ì œê°€ ìˆì„ ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ì•Œë ¤ì¤¬ì£ . ì´ë¡œì¨ AKS-ê´€ë¦¬ ë…¸ë“œ ë‚´ì˜ ë¼ìš°íŒ… í…Œì´ë¸” ë¬¸ì œì¼ ìˆ˜ë„ ìˆë‹¤ëŠ” ëŠë‚Œì„ ë°›ì•˜ì–´ìš”.\n\nê·¸ë˜ì„œ ì €í¬ SRE íŒ€ì€ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì—ì„œ ë…¸ë“œ ì¤‘ í•˜ë‚˜ë¡œ SSHë¥¼ í†µí•´ ì—°ê²°í•˜ê³  `ip route` ëª…ë ¹ì„ ì‹¤í–‰í–ˆì–´ìš”. ì´ ëª…ë ¹ì„ ì‹¤í–‰í•˜ë©´ Ciliumì´ êµì°¨ ë…¸ë“œ í†µì‹ ì„ ê°€ëŠ¥í•˜ê²Œí•˜ê¸° ìœ„í•´ ì¶”ê°€í•œ ëª‡ ê°€ì§€ ë¼ìš°íŒ… ê·œì¹™ì´ í‘œì‹œëì–´ìš”.\n\n![Image](/assets/img/2024-06-19-LearneditthehardwayDontuseCiliumsdefaultPodCIDR_3.png)\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n## Cilium ë…¸ë“œ ë¼ìš°íŒ…\n\nê³ ìˆ˜ì¤€ ê°œìš”ì—ì„œ Ciliumì„ í´ëŸ¬ìŠ¤í„° ë²”ìœ„ IPAM ëª¨ë“œì—ì„œ ì‹¤í–‰í•  ë•Œ, Ciliumì—ê²Œ ê°€ìƒ IPë¥¼ íŒŒë“œì— í• ë‹¹í•˜ë„ë¡ ì§€ì‹œí•˜ê¸° ìœ„í•´ CIDR ë²”ìœ„ë¥¼ ì œê³µí•´ì•¼ í•©ë‹ˆë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ ì´ CIDR ë²”ìœ„ëŠ” 10.0.0.0/8ì…ë‹ˆë‹¤.\n\nìƒˆ ë…¸ë“œê°€ í´ëŸ¬ìŠ¤í„°ì— ê°€ì…í•˜ë©´, Ciliumì€ í•´ë‹¹ ë…¸ë“œì—ê²Œ ì£¼ì–´ì§„ CIDR ë¸”ë¡ì—ì„œ ê³ ìœ í•œ ì„œë¸Œë„·ì„ í• ë‹¹í•©ë‹ˆë‹¤. ë…¸ë“œì˜ ëª¨ë“  íŒŒë“œëŠ” ì´ í• ë‹¹ëœ ì„œë¸Œë„· ë²”ìœ„ì—ì„œ IP ì£¼ì†Œë¥¼ ë°›ìŠµë‹ˆë‹¤.\n\nì˜ˆë¥¼ ë“¤ì–´, CIDR ë²”ìœ„ì¸ 10.0.0.0/8ì„ ì‚¬ìš©í•œë‹¤ë©´:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n- ë…¸ë“œ AëŠ” ì„œë¸Œë„· 10.1.0.0/16ì„ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n- ë…¸ë“œ BëŠ” ì„œë¸Œë„· 10.4.0.0/16ì„ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\në…¸ë“œ ê°„ í†µì‹ ì„ ì›í™œí•˜ê²Œ í•˜ê¸° ìœ„í•´ Ciliumì€ IP ê²½ë¡œë¥¼ ì„¤ì •í•˜ì—¬ íŠ¸ë˜í”½ì´ ë…¸ë“œ ê°„ì— ì˜¬ë°”ë¥´ê²Œ ì „ë‹¬ë˜ë„ë¡ í•©ë‹ˆë‹¤. ë…¸ë“œ Aì— ìˆëŠ” IPê°€ 10.1.5.13ì¸ íŒŸì´ ë…¸ë“œ Bì— ìˆëŠ” IPê°€ 10.4.63.38ì¸ íŒŸê³¼ í†µì‹ í•˜ë ¤ê³  í•  ë•Œ, ë°ì´í„° íŒ¨í‚·ì€ ë…¸ë“œ Aì˜ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ë¡œ ì „ì†¡ë©ë‹ˆë‹¤. ê·¸ í›„ IP ë¼ìš°íŒ… í…Œì´ë¸”ì„ ê¸°ë°˜ìœ¼ë¡œ íŒ¨í‚·ì€ ë…¸ë“œ Bë¡œ ë¼ìš°íŒ…ë˜ë©°, ì´ëŠ” ë…¸ë“œ Bê°€ 10.4.0.0/16 ì„œë¸Œë„·ì„ ì†Œìœ í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.\n\n## ì ìëŠ” ìš©\n\në³´í†µì€ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ìœ ê°ìŠ¤ëŸ½ê²Œë„, ë…¸ë“œì— í• ë‹¹ëœ ì„œë¸Œë„· ì¤‘ í•˜ë‚˜ê°€ ë°©í™”ë²½ì˜ ì„œë¸Œë„· ë²”ìœ„ì™€ ê²¹ì¹˜ëŠ” ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì´ë¡œ ì¸í•´ SYN íŒ¨í‚·ì´ íŒŸì— ì„±ê³µì ìœ¼ë¡œ ë„ë‹¬í•˜ì§€ë§Œ, íŒŸì´ ì‘ë‹µì„ ì‹œë„í•  ë•Œ ìš”ì²­ì´ ë…¸ë“œì˜ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ë¡œ ì „ë‹¬ë˜ëŠ” ìƒí™©ì´ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nê·¸ ë•Œ, ë…¸ë“œì˜ IP ë¼ìš°íŒ… ê·œì¹™ ë•Œë¬¸ì— íŒ¨í‚·ì´ ë‹¤ë¥¸ ë…¸ë“œë¡œ ë¼ìš°íŒ…ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ëŠ” ë°©í™”ë²½ì˜ VM IP ì£¼ì†Œê°€ ë‘ ë²ˆì§¸ ë…¸ë“œì˜ ì„œë¸Œë„· ë²”ìœ„ ë‚´ì— ì†í–ˆê¸° ë•Œë¬¸ì— ë°œìƒí–ˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ë‘ ë²ˆì§¸ ë…¸ë“œì—ëŠ” ë°©í™”ë²½ì˜ VMê³¼ ì •í™•íˆ ì¼ì¹˜í•˜ëŠ” IP ì£¼ì†Œë¥¼ ê°€ì§„ podê°€ ì—†ì—ˆê¸° ë•Œë¬¸ì— íŒ¨í‚·ì´ ì†Œë©¸í•˜ì—¬ ì‚¬ë¼ì¡ŒìŠµë‹ˆë‹¤.\n\nì´ ê°€ì„¤ì„ í™•ì¸í•˜ê¸° ìœ„í•´ SRE íŒ€ì€ ì¶©ëŒí•˜ëŠ” ë…¸ë“œì— ëŒ€í•´ `kubectl delete node`ì„ ì‹¤í–‰í–ˆê³ , ê·¸ ë…¸ë“œê°€ ì œê±°ë˜ìë§ˆì ë°©í™”ë²½ì„ í†µí•œ ì™¸ë¶€ ì—°ê²°ì´ ë‹¤ì‹œ ì‘ë™í•˜ê¸° ì‹œì‘í–ˆìŠµë‹ˆë‹¤.\n\ní•˜ì§€ë§Œ ì™œ Ciliumì„ ë°°í¬í•œ í›„ ê±°ì˜ 8ê°œì›”ì´ ì§€ë‚œ í›„ì— ì´ ë¬¸ì œê°€ ë°œìƒí–ˆì„ê¹Œìš”? ì´ ëª¨ë“  ê²ƒì€ ìë™ ìŠ¤ì¼€ì¼ë§ìœ¼ë¡œ ê·€ê²°ë˜ì—ˆìŠµë‹ˆë‹¤. ê´€ì°°í•œ ë°”ì— ë”°ë¥´ë©´, íŠ¹ì • CIDR ë²”ìœ„ê°€ ë…¸ë“œì— í• ë‹¹ë˜ë©´ í•´ë‹¹ ë…¸ë“œê°€ ì œê±°ë˜ë”ë¼ë„ ì¬ì‚¬ìš©ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ Cilium ìš´ì˜ìëŠ” ìš°ë¦¬ê°€ í• ë‹¹í•œ ëŒ€ê·œëª¨ CIDR ë²”ìœ„ë¥¼ í•˜ë‚˜ì”© ì†Œë¹„í•˜ë©´ì„œ ì ì§„ì ìœ¼ë¡œ ì´ë™í•˜ê³  ìˆì—ˆê³ , ë§ˆì¹¨ë‚´ ë°©í™”ë²½ì˜ CIDR ë²”ìœ„ì— ë‹¤ë‹¤ëìŠµë‹ˆë‹¤.\n\nê·¸ íŒëª…ë‚ ì¸ ì²« ì›”ìš”ì¼ ì•„ì¹¨, SRE íŒ€ì´ ê°œë°œ í™˜ê²½ì—ì„œ ìŠ¤í…Œì´ì§•ìœ¼ë¡œ ë¦´ë¦¬ìŠ¤ë¥¼ ìŠ¹ê²©ì‹œí‚¤ìë§ˆì ë…¸ë“œ ìŠ¤ì¼€ì¼ì—…ì„ íŠ¸ë¦¬ê±°í•˜ì—¬ ì¶©ëŒí•˜ëŠ” CIDR ë²”ìœ„ê°€ ìˆëŠ” ë…¸ë“œê°€ ìƒì„±ë˜ì—ˆê³ , ì´ë¡œ ì¸í•´ ì „ì²´ í†µì‹  ê²½ë¡œê°€ ë‹¤ìš´ë˜ì—ˆìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# ë¬¸ì œ ìˆ˜ì •\n\nìŠ¤í…Œì´ì§•ì—ì„œ ë°œìƒí•œ ì´ìŠˆë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´, ìš°ë¦¬ëŠ” clusterPoolIPv4PodCIDRListë¥¼ ê¸°ì¡´ ë‚´ë¶€ ì„œë¸Œë„·ê³¼ ì¶©ëŒí•˜ì§€ ì•ŠëŠ” CIDR ë²”ìœ„ë¡œ ì—…ë°ì´íŠ¸í•´ ë³´ì•˜ìŠµë‹ˆë‹¤. í—¬ë¦„ ì—…ê·¸ë ˆì´ë“œë¥¼ ì‹¤í–‰í•œ í›„ì—ë„ ì•„ë¬´ ë³€í™”ê°€ ì—†ì—ˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ë…¸ë“œ ìŠ¤ì¼€ì¼ ì—…ì„ íŠ¸ë¦¬ê±°í•˜ê³  ë‹¤í–‰íˆë„ - ìƒˆë¡œ ìƒì„±ëœ ë…¸ë“œê°€ ìƒˆë¡œìš´ CIDR ë²”ìœ„ì˜ ì„œë¸Œë„·ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.\n\nì €ëŠ” ë‘ ê°œì˜ DaemonSetì„ ì‚¬ìš©í•˜ì—¬ êµì°¨ ë…¸ë“œ í†µì‹ ì„ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ ë§Œë“  ë¹ ë¥¸ ì›Œí¬ë¡œë“œë¥¼ ì‹¤í–‰í•˜ì—¬ ë‘ ê°œì˜ CIDR ë²”ìœ„ê°€ ì•„ë¬´ ë¬¸ì œì—†ì´ ì‘ë™í•˜ëŠ” ê²ƒì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤. ê·¸ í›„, SRE íŒ€ì€ ê¸°ì¡´ ë…¸ë“œë¥¼ ì•ˆì „í•˜ê²Œ ë¹„ìš°ê³  ì œê±°í•˜ê³  ë‚˜ìœ CIDR ë²”ìœ„ë¥¼ ê°€ì§„ ëª¨ë“  ë…¸ë“œê°€ ì™„ì „íˆ ì œê±°ë  ë•Œê¹Œì§€ ìƒˆë¡œìš´ ë…¸ë“œ í’€ì„ í™•ì¥í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹ ì†í•˜ê²Œ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. ê·¸ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ì—¬ ìŠ¤í…Œì´ì§• í´ëŸ¬ìŠ¤í„°ë¥¼ ì™„ì „íˆ ë³µêµ¬í–ˆìŠµë‹ˆë‹¤.\n\nì¶”ê°€ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•œ í›„ì— ìš°ë¦¬ì˜ í”„ë¡œë•ì…˜ í´ëŸ¬ìŠ¤í„°ë„ ë™ì¼í•œ ë¬¸ì œë¥¼ ê²ªì—ˆê¸° ë•Œë¬¸ì—, Cilium ë¬¸ì„œì—ì„œ ë°˜ëŒ€í•˜ê³  ìˆë˜ ê²ƒì—ë„ ë¶ˆêµ¬í•˜ê³  clusterPoolIPv4PodCIDRListë¥¼ ì—…ë°ì´íŠ¸í•˜ì—¬ ë¬¸ì œë¥¼ ì˜êµ¬ì ìœ¼ë¡œ í•´ê²°í•˜ê¸°ë¡œ ê²°ì •í–ˆìŠµë‹ˆë‹¤. ì´ì— ì´í•´ ê´€ê³„ìë“¤ë¡œë¶€í„° ë™ì˜ë¥¼ ë°›ê³  ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ì‹¤í–‰í–ˆìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# ê²°ë¡ \n\në‹¤ì–‘í•œ í…ŒìŠ¤íŠ¸ë¥¼ ê±°ì¹œ í›„ì—ë„, ê±°ì˜ 2000ê°œì˜ êµ¬ì„± ê°€ëŠ¥í•œ ê°’ì´ ìˆëŠ” Ciliumê³¼ ê°™ì€ ë³µì¡í•œ ì‹œìŠ¤í…œì€ ì—¬ì „íˆ ì˜ëª»ëœ êµ¬ì„±ì„ ë¹ ëœ¨ë¦´ ìˆ˜ ìˆì–´ ì˜ˆìƒì¹˜ ëª»í•œ ì‹¤íŒ¨ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nì´ ì‚¬ê±´ì„ í†µí•´, ë„¤íŠ¸ì›Œí¬ ë¬¸ì œë¥¼ ì²´ê³„ì ìœ¼ë¡œ í•´ê²°í•˜ê³  í´ë¼ìš°ë“œ ì¶”ìƒí™”ì— ì˜í•´ ì œê³µëœ ë‚®ì€ ìˆ˜ì¤€ì˜ ë„¤íŠ¸ì›Œí‚¹ ì¸í”„ë¼ì™€ ê¸°ìˆ ì„ ì´í•´í•˜ëŠ” ì¤‘ìš”ì„±ì„ ê¹¨ë‹¬ì•˜ìŠµë‹ˆë‹¤. ì´ ë¬¸ì œì— ëŒ€í•´ í˜‘ì—…í•œ í›„, ë§¤ìš° ì–´ë ¤ìš´ ê²½í—˜ì´ì—ˆì§€ë§Œ ì†Œì¤‘í•œ í•™ìŠµ ê¸°íšŒë¥¼ ì œê³µí–ˆë‹¤ëŠ” ê²ƒì— ëŒ€í•´ ëª¨ë‘ ë™ì˜í–ˆìŠµë‹ˆë‹¤.","ogImage":{"url":"/assets/img/2024-06-19-LearneditthehardwayDontuseCiliumsdefaultPodCIDR_0.png"},"coverImage":"/assets/img/2024-06-19-LearneditthehardwayDontuseCiliumsdefaultPodCIDR_0.png","tag":["Tech"],"readingTime":7},{"title":"ë‚˜ì˜ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— MongoDB No-SQL ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì¶”ê°€í•œ ê²½í—˜","description":"","date":"2024-06-19 13:00","slug":"2024-06-19-MyexperienceaddingaMongoDBNo-SQLdatabasetomyKubernetescluster","content":"\n\n## SQLê³¼ No-SQL ë°ì´í„°ë² ì´ìŠ¤ ì‚¬ì´ë¥¼ ì„ íƒí•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì½ì—ˆë‹¤ë©´, Kubernetes í´ëŸ¬ìŠ¤í„°ì— No-SQL MongoDB ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆëŠ”ì§€ ê¶ê¸ˆí•  ê²ƒì…ë‹ˆë‹¤. ì´ ê¸€ì—ì„œëŠ” ê·¸ê²ƒì„ ì–´ë–»ê²Œ ìˆ˜í–‰í–ˆëŠ”ì§€ ì„¤ëª…í•˜ê³  Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ í•¨ê»˜ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì•Œë ¤ë“œë¦¬ê² ìŠµë‹ˆë‹¤.\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-19-MyexperienceaddingaMongoDBNo-SQLdatabasetomyKubernetescluster_0.png)\n\n# ì‹œì‘í•˜ê¸°\n\nì¼ë°˜ì ìœ¼ë¡œ Kubernetes ì„œë¹„ìŠ¤ë¥¼ ê°œë°œí•  ë•ŒëŠ”, ê°œë°œì„ ìœ„í•´ ë¡œì»¬ Kind Kubernetes í´ëŸ¬ìŠ¤í„°ì—ì„œ ì‹œì‘í•©ë‹ˆë‹¤. Kindë¥¼ ì„¤ì •í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì´ì „ì— ì¼ì—ˆê³ , ì´ ê¸€ì— ê´€ë ¨ëœ GitHub ì €ì¥ì†Œì—ëŠ” ì´ë¥¼ ìˆ˜í–‰í•˜ëŠ” ë° í•„ìš”í•œ êµ¬ì„± íŒŒì¼ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\ní´ë¡ í•˜ê¸° ìœ„í•´ ì €ì¥ì†Œë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ë³µì œí•  ìˆ˜ ìˆì–´ìš”:\n\n```js\ngit clone git@github.com:MartinHodges/aquarium-with-mongo-db.git\n```\n\n# ì™œ MongoDBë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ë‚˜ìš”?\n\nì´ì „ ê¸°ì‚¬ì—ì„œ SQL ëŒ€ No-SQL ê²°ì •ì— ëŒ€í•´ ë‹¤ë¤„ ë³´ì•˜ì–´ìš”. ì—¬ëŸ¬ë¶„ì´ ì´ ê¸€ì„ ì½ê³  ê³„ì‹ ë‹¤ë©´ No-SQLì„ ì„ íƒí•˜ê² ë‹¤ê³  ê²°ì •í•˜ì‹  ê±°ê² ì£ .\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì¼ë‹¨ ê·¸ ê²°ì •ì´ ë‚´ë ¸ë‹¤ë©´, ì´ì œ No-SQL ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì–´ë–¤ ê²ƒì„ ì„ íƒí• ì§€ê°€ ë¬¸ì œê°€ ë©ë‹ˆë‹¤. MongoDBëŠ” ê°€ì¥ ê°€ê¹Œìš´ ê²½ìŸìƒëŒ€ë³´ë‹¤ 2ë°° ë” ë†’ì€ ì‹œì¥ ì ìœ ìœ¨ì„ ë³´ìœ í•˜ê³  ìˆìŠµë‹ˆë‹¤. ê·¸ê²ƒì€ ë§¤ìš° ì •êµí•˜ë©° ì»¤ë®¤ë‹ˆí‹° ë²„ì „ê³¼ ì—”í„°í”„ë¼ì´ì¦ˆ ë²„ì „ ë‘˜ ë‹¤ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ì „í˜•ì ìœ¼ë¡œ ê°€ì¥ ë§ì´ ì‚¬ìš©ë˜ëŠ” No-SQL ë°ì´í„°ë² ì´ìŠ¤ì…ë‹ˆë‹¤.\n\në‹¤ë¥¸ ë°ì´í„°ë² ì´ìŠ¤ì™€ì˜ ê¸°ìˆ ì ì¸ ë¹„êµëŠ” ì´ ê¸°ì‚¬ì˜ ë²”ìœ„ë¥¼ ë²—ì–´ë‚˜ì§€ë§Œ, MongoDBê°€ ì¸ê¸° ìˆëŠ” ì´ìœ ì™€ ì¼í•˜ë„ë¡ ì¶©ë¶„íˆ í•  ìˆ˜ ìˆëŠ” ì‚¬ì‹¤ì— ê¸°ë°˜í•˜ì—¬ ì´ ê¸°ì‚¬ì—ì„œëŠ” MongoDBë¥¼ ì„ íƒí–ˆìŠµë‹ˆë‹¤!\n\n# MongoDB ì„¤ì¹˜\n\nKubernetes í´ëŸ¬ìŠ¤í„°ì— MongoDBë¥¼ ì„¤ì¹˜í•˜ëŠ” ë°©ë²•ì€ ë‹¤ë¥¸ ì‘ìš©í”„ë¡œê·¸ë¨ê³¼ ìœ ì‚¬í•˜ê²Œ operatorë¥¼ ì‚¬ìš©í•˜ì—¬ ìˆ˜í–‰ë©ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n\u003cimg src=\"/assets/img/2024-06-19-MyexperienceaddingaMongoDBNo-SQLdatabasetomyKubernetescluster_1.png\" /\u003e\n\nì¿ ë²„ë„¤í‹°ìŠ¤ ì˜¤í¼ë ˆì´í„°ëŠ” ë‹¹ì‹ ì„ ëŒ€ì‹ í•˜ì—¬ ì‘ìš© í”„ë¡œê·¸ë¨ì„ ê´€ë¦¬í•©ë‹ˆë‹¤. ì‘ìš© í”„ë¡œê·¸ë¨ì˜ ë¼ì´í”„ì‚¬ì´í´ì„ ì„¤ì¹˜í•˜ê³  ê´€ë¦¬í•˜ë©° ëª¨ë‹ˆí„°ë§í•˜ê³  í•„ìš”í•œ ì¡°ì¹˜ë¥¼ ì·¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\në°ì´í„°ë² ì´ìŠ¤ì˜ ê²½ìš° ë°ì´í„°ë² ì´ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ ìƒì„±í•˜ê±°ë‚˜ í™•ì¥í•˜ê±°ë‚˜ ë°±ì—…í•˜ëŠ” ë“±ì˜ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ì˜¤í¼ë ˆì´í„°ëŠ” ê·¸ ìì²´ì˜ 'ì¿ ë²„ë„¤í‹°ìŠ¤ êµ¬ì„± ì–¸ì–´'ë¥¼ ì œê³µí•˜ëŠ” ì‚¬ìš©ì ì •ì˜ ë¦¬ì†ŒìŠ¤ ì •ì˜ (CRD)ë¥¼ ì„¤ì¹˜í•˜ê¸°ì— ì˜ì¡´í•©ë‹ˆë‹¤. ì´ëŠ” í´ëŸ¬ìŠ¤í„°ì— ì‚¬ìš©ì ì •ì˜ ë¦¬ì†ŒìŠ¤ë¥¼ ì¶”ê°€í•˜ê¸° ìœ„í•œ ìš”ì²­ì„ ê°ì§€í•˜ê³  ë‹¹ì‹ ì„ ëŒ€ì‹ í•˜ì—¬ ì‘ë™í•©ë‹ˆë‹¤.\n\n## ê°œë°œìš© ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ìƒì„±\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nKindë¥¼ ì„¤ì¹˜í–ˆë‹¤ê³  ê°€ì •í•˜ë©´, ë‹¤ìŒ êµ¬ì„±ì„ ì‚¬ìš©í•˜ì—¬ Kind í´ëŸ¬ìŠ¤í„°ë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\nkind/kind-config.yml\n\n```js\napiVersion: kind.x-k8s.io/v1alpha4\nkind: Cluster\nnodes:\n- role: control-plane\n  extraPortMappings:\n  # apis\n  - containerPort: 30080\n    hostPort: 30080\n- role: worker\n- role: worker\n- role: worker\n```\n\nì´ë ‡ê²Œ í•˜ë©´ 1ê°œì˜ ì»¨íŠ¸ë¡¤ëŸ¬ ë° 3ê°œì˜ ì›Œì»¤ë¡œ êµ¬ì„±ëœ 4ê°œ ë…¸ë“œ í´ëŸ¬ìŠ¤í„°ê°€ ìƒì„±ë©ë‹ˆë‹¤. ë˜í•œ ê°œë°œ ë¨¸ì‹ ì˜ í¬íŠ¸ 30080ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¡œì»¬ Kubernetes í´ëŸ¬ìŠ¤í„°ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```shell\nkind create cluster --config kind/kind-config.yml\n```\n\n## ì˜¤í¼ë ˆì´í„° ì„¤ì¹˜\n\nHelmì„ ì‚¬ìš©í•˜ì—¬ ì»¤ë®¤ë‹ˆí‹° ì§€ì› ì˜¤í¼ë ˆì´í„°ë¥¼ ì„¤ì¹˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\në¨¼ì € ë‹¤ìŒê³¼ ê°™ì´ ë¡œì»¬ ë¦¬í¬ì§€í† ë¦¬ì— Helm ë§í¬ë¥¼ ì¶”ê°€í•˜ì„¸ìš”:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\nhelm repo add mongodb https://mongodb.github.io/helm-charts\n```\n\nì•„ë˜ ëª…ë ¹ì–´ë¡œ ì´ ë¦¬í¬ì§€í† ë¦¬ê°€ ì¶”ê°€í•œ ì°¨íŠ¸ë¥¼ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”:\n\n```js\nhelm search repo mongo\n```\n\në¦¬ìŠ¤íŠ¸ì—ì„œ ì»¤ë®¤ë‹ˆí‹° ì˜¤í¼ë ˆì´í„°ë¥¼ í™•ì¸í•  ìˆ˜ ìˆì„ ê±°ì—ìš”. ì´ê²ƒì„ ì‚¬ìš©í•  ê±°ì—ìš”.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì €í¬ëŠ” ì˜¤í¼ë ˆì´í„°ì™€ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ë³„ë„ì˜ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¡œ mongoë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ë¶„ë¦¬í•´ì„œ ë°°ì¹˜í•  ê²ë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì´ ìƒì„±í•´ë³´ê² ìŠµë‹ˆë‹¤:\n\n```js\nkubectl create namespace mongo\n```\n\nì´ì œ ë‹¤ìŒ ëª…ë ¹ìœ¼ë¡œ ì˜¤í¼ë ˆì´í„°ë¥¼ ì„¤ì¹˜í•  ìˆ˜ ìˆì–´ìš”:\n\n```js\nhelm install community-operator mongodb/community-operator -n mongo\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\në‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¤€ë¹„ ìƒíƒœê°€ 1/1ë¡œ Runningì¸ì§€ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”:\n\n```sh\nkubectl get pods -n mongo\n```\n\nì´ì œ ìš´ì˜ìê°€ ì‘ë™ ì¤‘ì¸ ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì„¤ì¹˜ëœ CRDëŠ” ë‹¤ìŒì„ í†µí•´ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”:\n\n```sh\nkubectl get crds\nkubectl describe crd mongodbcommunity.mongodbcommunity.mongodb.com \n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì´ì œ MongoDB í´ëŸ¬ìŠ¤í„°ë¥¼ ìƒì„±í•  ì¤€ë¹„ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.\n\n## í´ëŸ¬ìŠ¤í„° ìƒì„±\n\nì˜¤í¼ë ˆì´í„°ê°€ ì„¤ì¹˜ë˜ì—ˆìœ¼ë¯€ë¡œ MongoDB ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ìƒì„±í•˜ëŠ” ìš”ì²­ì„ ëŒ€ê¸° ì¤‘ì…ë‹ˆë‹¤. ìš°ë¦¬ëŠ” ì˜¤í¼ë ˆì´í„°ì— ì˜í•´ ë¡œë“œëœ CRDë¥¼ ì‚¬ìš©í•˜ì—¬ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— MongoDB ë§¤ë‹ˆí˜ìŠ¤íŠ¸ë¥¼ ì ìš©í•˜ì—¬ ìš”ì²­ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nì´ë¥¼ í•˜ê¸° ì „ì— ë°ì´í„°ë² ì´ìŠ¤ ì‚¬ìš©ìì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì¿ ë²„ë„¤í‹°ìŠ¤ ì‹œí¬ë¦¿ìœ¼ë¡œ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\në‹¤ìŒê³¼ ê°™ì´ ë¹„ë°€ì„ ìƒì„±í•˜ì„¸ìš” (â€˜â€¦â€™ë¥¼ ì„ íƒí•œ ë¹„ë°€ë²ˆí˜¸ë¡œ êµì²´í•˜ì„¸ìš”):\n\n```js\nkubectl create secret generic my-user-password -n mongo --from-literal=\"password=\u003cë‹¹ì‹ ì˜ ë¹„ë°€ë²ˆí˜¸\u003e\"\n```\n\në‹¤ìŒ ëª…ë ¹ì–´ë¡œ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”:\n\n```js\nkubectl get secrets -n mongo my-user-password -o jsonpath={.data.password} | base64 -d; echo\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nëª¨ë“  ì¿ ë²„ë„¤í‹°ìŠ¤ ì‹œí¬ë¦¿ì€ base64ë¡œ ì¸ì½”ë“œë˜ì–´ ìˆê¸° ë•Œë¬¸ì— ë¹„ë°€ë²ˆí˜¸ë¥¼ ë””ì½”ë”©í•˜ëŠ” ë° base64 -dë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìš°ë¦¬ê°€ --from-literalì„ ì‚¬ìš©í•˜ì˜€ê¸° ë•Œë¬¸ì— create secret ëª…ë ¹ì–´ì— ì˜í•´ ë¹„ë°€ë²ˆí˜¸ê°€ ìë™ìœ¼ë¡œ base64ë¡œ ì¸ì½”ë“œë˜ì—ˆìŠµë‹ˆë‹¤.\n\nì´ì œ ë¹„ë°€ë²ˆí˜¸ê°€ ì¤€ë¹„ë˜ì—ˆìœ¼ë‹ˆ, ì´ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì‚¬ìš©í•˜ëŠ” ê´€ë¦¬ì ì‚¬ìš©ìê°€ ìˆëŠ” MonogoDB í´ëŸ¬ìŠ¤í„°ì™€ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\në§¤ë‹ˆí˜ìŠ¤íŠ¸ íŒŒì¼ì„ ìƒì„±í•´ ë³´ì„¸ìš”:\n\nk8s/my-mongo-db.yml\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```yaml\napiVersion: mongodbcommunity.mongodb.com/v1\nkind: MongoDBCommunity\nmetadata:\n  name: my-mongo-db\n  namespace: mongo\nspec:\n  members: 3\n  type: ReplicaSet\n  version: \"7.0.11\"\n  security:\n    authentication:\n      modes: [\"SCRAM\"]\n  users:\n    - name: my-user\n      db: admin\n      passwordSecretRef: # a reference to the secret that will be used to generate the user's password\n        name: my-user-password\n        key: password\n      roles:\n        - name: clusterAdmin\n          db: admin\n        - name: userAdminAnyDatabase\n          db: admin\n      scramCredentialsSecretName: my-user-scram\n  additionalMongodConfig:\n    storage.wiredTiger.engineConfig.journalCompressor: zlib\n```\n\nì´ì œ ë‹¤ìŒê³¼ ê°™ì´ ì ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n```bash\nkubectl apply -f k8s/my-mongo-db.yml \n```\n\nê·¸ë¦¬ê³  ì§„í–‰ ìƒí™©ì„ ë‹¤ìŒê³¼ ê°™ì´ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\nkubectl get pods -n mongo\n```\n\n3ê°œì˜ ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒì„±ë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ê³  ìˆì–´ìš”. ì œ MacBook Pro(M2 Max Apple ì‹¤ë¦¬ì½˜)ì—ì„œ 4ë…¸ë“œ Kind í´ëŸ¬ìŠ¤í„°ë¥¼ ì‚¬ìš©í•˜ë©´, ëª¨ë“  3ê°œì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‹œì‘í•˜ëŠ” ë° ì•½ 5ë¶„ ì •ë„ ê±¸ë ¸ì–´ìš”.\n\nì‹œì‘ë˜ê³  ë‚˜ë©´, ë‹¤ìŒ ëª…ë ¹ì–´ë¡œ ì„œë¹„ìŠ¤ê°€ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”:\n\n```js\nkubectl get svc -n mongo\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì´ë ‡ê²Œ í•˜ë©´:\n\n```js\nNAME              TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)     AGE\nmy-mongo-db-svc   ClusterIP   None         \u003cnone\u003e        27017/TCP   6m\n```\n\n## ë°ì´í„°ë² ì´ìŠ¤ í…ŒìŠ¤íŠ¸\n\nìš°ë¦¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ ë‚´ë¶€ì—ì„œ ì§ì ‘ ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°í•  ê²ƒì…ë‹ˆë‹¤. ë°ì´í„°ë² ì´ìŠ¤ì˜ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•´ DNS ì´ë¦„ìœ¼ë¡œ ì—°ê²°í•˜ë ¤ê³  í•˜ì§€ë§Œ, í…ŒìŠ¤íŠ¸ ëª©ì ìœ¼ë¡œëŠ” ë¡œì»¬ ê°œë°œ ë¨¸ì‹ ì—ì„œ ì—°ê²°í•˜ê³  ì‹¶ìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì²˜ìŒìœ¼ë¡œ ì´ë¥¼ ì‹œë„í•  ë•Œ ë¡œì»¬ ê°œë°œ ë¨¸ì‹ ìœ¼ë¡œ MonogoDB íŒŒë“œ ì¤‘ í•˜ë‚˜ë¥¼ í¬ì›Œë”©í•˜ê¸° ìœ„í•´ í¬íŠ¸ í¬ì›Œë”©ì„ ì‚¬ìš©í–ˆê³ , ì–´ë–¤ ë³€ê²½ì„ ì‹œë„í–ˆì„ ë•Œ ë‹¤ìŒê³¼ ê°™ì€ ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ ë°›ì•˜ìŠµë‹ˆë‹¤:\n\n```js\nMongoServerError[NotWriteablePrimary]: not primary\n```\n\nì´ê²ƒì€ í¬íŠ¸ í¬ì›Œë”©í•œ íŒŒë“œê°€ í´ëŸ¬ìŠ¤í„°ì˜ ì£¼ íŒŒë“œê°€ ì•„ë‹ˆê¸° ë•Œë¬¸ì— ë°œìƒí•œ ë¬¸ì œì…ë‹ˆë‹¤. ë³´ì¡° íŒŒë“œëŠ” ì½ê¸° ì „ìš© ë³µì‚¬ë³¸ì´ê¸° ë•Œë¬¸ì— ëª¨ë“  ì“°ê¸° ì‘ì—…ì€ ì£¼ íŒŒë“œë¥¼ í†µí•´ ì´ë£¨ì–´ì ¸ì•¼ í•©ë‹ˆë‹¤.\n\nì´ ë¬¸ì œë¥¼ í”¼í•˜ë ¤ë©´ ì£¼ íŒŒë“œì— ì—°ê²°í•´ì•¼ í•©ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì–´ë–¤ ë…¸ë“œê°€ ê¸°ë³¸ ë…¸ë“œì¸ì§€ ì•Œê³  ì‹¶ë‹¤ë©´ ë‹¤ìŒ ë…¸ë“œ ì¤‘ í•˜ë‚˜ì˜ ë¡œê·¸ë¥¼ ì¡°ì‚¬í•˜ë©´ ë©ë‹ˆë‹¤:\n\n```js\nkubectl logs my-mongo-db-0 -n mongo -c mongod | grep \"\\\"primary\\\":\"\n```\n\në§Œì•½ ê²°ê³¼ê°€ ì—†ë‹¤ë©´, ê¸°ë³¸ ë…¸ë“œì— ë„ë‹¬í•œ ê²ƒì…ë‹ˆë‹¤.\n\në§Œì•½ ê²°ê³¼ë¥¼ ì–»ëŠ”ë‹¤ë©´, ëª‡ ì¤„ë§Œ ì¶œë ¥ë  ìˆ˜ ìˆì§€ë§Œ, ê·¸ê²ƒë“¤ì€ ë§¤ìš° ê¸¸ê³  ì½ê¸° ì–´ë ¤ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤. JSON pretty printer ê°™ì€ ê²ƒ(jqì™€ ê°™ì€)ì„ ê°€ì§€ê³  ìˆë‹¤ë©´ ë‹¤ìŒì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\nkubectl logs my-mongo-db-0 -n mongo -c mongod | grep \"\\\"primary\\\":\" | jq\n```\n\nê·¸ëŸ¬ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì¤„ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n```js\n...\n\"primary\": \"my-mongo-db-1.my-mongo-db-svc.mongo.svc.cluster.local:27017\",\n...\n```\n\nì—¬ê¸°ì— ì—°ê²°í•´ì•¼ í•˜ëŠ” podì˜ ì´ë¦„ì´ ë‚˜ì˜µë‹ˆë‹¤ (ì œ ê²½ìš°: my-mongo-db-1). ì´ì œ í•´ë‹¹ podë¥¼ í¬íŠ¸ í¬ì›Œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\nkubectl port-forward my-mongo-db-1 -n mongo 27017:27017\n```\n\nì´ í¬íŠ¸ í¬ì›Œë”©ì´ ì„¤ì •ë˜ë©´ ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°í•´ì•¼ í•©ë‹ˆë‹¤. MongoDB Compass í´ë¼ì´ì–¸íŠ¸ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•´ë‹¹ í´ë¼ì´ì–¸íŠ¸ëŠ” https://www.mongodb.com/try/download/compass ì—ì„œ ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nì„¤ì¹˜ í›„ ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°í•  ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤. ì—°ê²° ë¬¸ìì—´(mongodb://localhost:27017)ì´ ì œì•ˆë©ë‹ˆë‹¤ë§Œ, ëª‡ ê°€ì§€ ì„¤ì •ì„ ë³€ê²½í•´ì•¼í•©ë‹ˆë‹¤.\n\nê³ ê¸‰ ì—°ê²° ì˜µì…˜ì„ í´ë¦­í•˜ê³  ì§ì ‘ ì—°ê²°ì„ í´ë¦­í•˜ì‹­ì‹œì˜¤ (ì´ ì„¤ì •ì„ ë³€ê²½í•˜ì§€ ì•Šìœ¼ë©´ ë‚´ë¶€ ì¿ ë²„ë„¤í‹°ìŠ¤ ì£¼ì†Œë¥¼ ì‚¬ìš©í•˜ë ¤ê³  ì‹œë„í•˜ì—¬ ì°¾ì„ ìˆ˜ ì—†ëŠ” ì£¼ì†Œê°€ ë°œìƒí•©ë‹ˆë‹¤).\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì¸ì¦ íƒ­ì„ í´ë¦­í•´ì£¼ì„¸ìš”. ì‚¬ìš©ì ì´ë¦„/ë¹„ë°€ë²ˆí˜¸ë¥¼ ì„ íƒí•˜ê³  ì´ì „ì— ì„ íƒí•œ ì‚¬ìš©ì ì´ë¦„(my-user)ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”. Adminì„ ë°ì´í„°ë² ì´ìŠ¤ë¡œ ì¶”ê°€í•˜ê³  SCRAM-SHA-256 ì¸ì¦ ë©”ì»¤ë‹ˆì¦˜ì„ ì„ íƒí•´ì£¼ì„¸ìš” (í•„ìš”í•˜ë‹¤ë©´ ì•„ë˜ë¡œ ìŠ¤í¬ë¡¤).\n\nì €ì¥ ë° ì—°ê²°ì„ í´ë¦­í•˜ê³  ì—°ê²° ì´ë¦„ì„ ì§€ì •í•œ í›„, ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°ëœ Compass ì½˜ì†”ì´ í‘œì‹œë©ë‹ˆë‹¤.\n\ní´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ admin, config ë° local ë°ì´í„°ë² ì´ìŠ¤ê°€ ìƒì„±ëœ ê²ƒì„ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nì—¬ê¸°ê¹Œì§€ ì˜¤ì…¨ë‹¤ë©´, MongoDB í´ëŸ¬ìŠ¤í„°ê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ ì¤‘ì„ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# ì• í”Œë¦¬ì¼€ì´ì…˜ ì‚¬ìš©ì ìƒì„±\n\nìš°ë¦¬ì˜ MongoDBì— ì—°ê²°í•  ëª¨ë“  ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ìš°ë¦¬ê°€ ìƒì„±í•œ my-userë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆì„ ê²ƒì´ë¼ê³  ìƒê°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ, ì´ ì‚¬ìš©ìëŠ” ì‹¤ì œë¡œ ë°ì´í„°ë² ì´ìŠ¤ ìœ ì§€ ê´€ë¦¬ë¥¼ ìœ„í•œ ê²ƒì´ê¸° ë•Œë¬¸ì— ê·¸ë ‡ì§€ ì•ŠìŠµë‹ˆë‹¤.\n\nì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë°ì´í„°ë² ì´ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡í•˜ë ¤ë©´ ë°ì´í„°ë² ì´ìŠ¤ì™€ í•´ë‹¹ ë°ì´í„°ì— ì•¡ì„¸ìŠ¤í•  ì‚¬ìš©ìë¥¼ ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤.\n\nCompass ì°½ì˜ ë§¨ ì•„ë˜ì— `_MONGOSH` í”„ë¡¬í”„íŠ¸ê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤. ì´ë¥¼ í´ë¦­í•˜ì—¬ ëª…ë ¹ì¤„ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì´ì œ ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©ìë¥¼ ìƒì„±í•  ê²ƒì…ë‹ˆë‹¤:\n\n```js\nuse aquarium\ndb.createUser( { user: \"my-app-user\",\n              pwd: \"\u003cpassword\u003e\",\n              roles: [ {db: \"aquarium\", role: \"dbOwner\"} ] } )\n```\n\nì•Œì•„ë‘¬ì•¼ í•  ëª‡ ê°€ì§€ ì‚¬í•­ì´ ìˆìŠµë‹ˆë‹¤. ì²«ë²ˆì§¸ë¡œ, ìƒì„±ë˜ê¸° ì „ì— ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ë°ì´í„°ë² ì´ìŠ¤(aquarium)ë¡œ ì „í™˜í•©ë‹ˆë‹¤. ì´ëŠ” ì‚¬ìš©í•˜ê¸° ì „ì— ì•„ë¬´ ê²ƒë„ ì •ì˜í•  í•„ìš”ê°€ ì—†ë‹¤ëŠ” ì›ì¹™ì— ë¶€í•©í•©ë‹ˆë‹¤. ë°ì´í„°ë² ì´ìŠ¤ ë° ëª¨ë“  ì»¬ë ‰ì…˜ì€ ë¬¸ì„œë¥¼ ì¶”ê°€í•  ë•Œ ì²˜ìŒ ìƒì„±ë©ë‹ˆë‹¤.\n\në‘ë²ˆì§¸ëŠ” ìƒˆ ë°ì´í„°ë² ì´ìŠ¤ì— í• ë‹¹ëœ ì—­í• ì…ë‹ˆë‹¤. MongoDBì—ëŠ” ì‚¬ìš©ìì—ê²Œ ë¶€ì—¬í•  ìˆ˜ ìˆëŠ” ì†Œìˆ˜ì˜ ê¸°ë³¸ ì—­í• ì´ ìˆìŠµë‹ˆë‹¤. ì´ ê²½ìš° dbOwner ì—­í• ì€ ì‚¬ìš©ìê°€ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì½ê³  ì“°ê³  ê´€ë¦¬í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤. ì‹¤ì œ ìš´ì˜ì—ì„œëŠ” ì‚¬ìš©ì ê¶Œí•œì„ ì ì ˆíˆ ì œí•œí•´ì•¼ í•©ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\n...\nok: 1,\n...\n```\n\nì‚¬ìš©ìë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ ìƒˆ Compass ì—°ê²°ì„ ì—´ì–´ë³´ì„¸ìš”. ì´ëŠ” ë©”ë‰´ë¥¼ í†µí•´ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í˜¹ì€ MacOSì—ì„œëŠ” Cmd Nì„ ëˆ„ë¥´ì„¸ìš”. ì°½ì´ ì—´ë¦´ ë•Œê¹Œì§€ ëª‡ ì´ˆê°€ ê±¸ë¦´ ìˆ˜ ìˆëŠ”ë°, ì•„ë¬´ëŸ° í‘œì‹œê°€ ì—†ìœ¼ë¯€ë¡œ í•œ ë²ˆë§Œ ëˆ„ë¥´ì„¸ìš”!\n\nìƒˆ ì—°ê²° ì°½ì´ ë‚˜íƒ€ë‚˜ë©´, ì´ì „ì— ì €ì¥í•œ ì—°ê²°ì„ ë³µì œí•˜ëŠ” ê²ƒì´ ë” ì‰½ë‹¤ê³  ìƒê°í•©ë‹ˆë‹¤(ì—°ê²° ì˜†ì˜ ... ë©”ë‰´ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”).\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì‚¬ìš©ì ì´ë¦„ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í•´ì£¼ì„¸ìš”. ë˜í•œ Authentication Databaseë¥¼ aquariumìœ¼ë¡œ ë³€ê²½í•´ì£¼ì„¸ìš”. ê·¸ëŸ° ë‹¤ìŒ ì—°ê²°í•˜ì„¸ìš”.\n\nì´ì œ ìƒˆë¡œìš´ aquarium ë°ì´í„°ë² ì´ìŠ¤ë¥¼ í™•ì¸í•  ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤. \"fishes\"ë¼ëŠ” collectionì„ ìƒì„±í•´ë³´ë©´ì„œ í…ŒìŠ¤íŠ¸í•´ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë°ì´í„°ë² ì´ìŠ¤ì— ë¬¸ì„œ í˜•íƒœë¡œ ë°ì´í„°ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n```js\n{\n  \"_id\": 123,\n  \"fish\": \"Guppy\"\n}\n```\n\nì´ ì‹œì ì—ì„œ Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ í•¨ê»˜ ì‚¬ìš©í•  ì¤€ë¹„ê°€ ëœ MongoDBê°€ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# ìŠ¤í”„ë§ ë¶€íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ë§Œë“¤ê¸°\n\nê°„ë‹¨í•œ ë°ì´í„°ë² ì´ìŠ¤ ì§€ì› ì˜ˆì œë¥¼ ë§Œë“¤ ë•ŒëŠ” ì œê°€ ì œì¼ ë¨¼ì € ìˆ˜ì¡±ê´€ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. REST APIë¥¼ ì‚¬ìš©í•˜ì—¬ ë¬¼ê³ ê¸°ì™€ ìˆ˜ì¡±ê´€ì„ ë§Œë“¤ê³  ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ ë¬¼ê³ ê¸°ë¥¼ ì—¬ëŸ¬ë¶„ì˜ ìˆ˜ì¡±ê´€ ì¤‘ í•˜ë‚˜ì— ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n## ì½”ë“œ\n\nì €ëŠ” ì½”ë“œë¥¼ ì—¬ê¸°ì— í¬í•¨í•˜ë ¤ëŠ” ì˜ë„ëŠ” ì—†ì§€ë§Œ ê´€ë ¨ëœ GitHub ì €ì¥ì†Œì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n## ì¢…ì†ì„±\n\nSpring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹œì‘í•˜ëŠ” ê²ƒì€ í•­ìƒ https://start.spring.io/ì—ì„œ Spring Initializrë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ë” ì‰½ìŠµë‹ˆë‹¤. ì‚¬ìš© ë°©ë²•ì„ ì•Œê³  ìˆë‹¤ê³  ê°€ì •í•©ë‹ˆë‹¤.\n\nì´ í”„ë¡œì íŠ¸ì—ì„œ Spring Webê³¼ Spring Data MongoDBë¥¼ ì¢…ì†ì„±ìœ¼ë¡œ ì¶”ê°€í•˜ê³  í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.\n\n## íŒ¨í‚¤ì§€ êµ¬ì¡°\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\në‚´ê°€ ë§Œë“œëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì— ë”°ë¼, íŒ¨í‚¤ì§€ êµ¬ì¡°ë¥¼ êµ¬ì„±í•˜ëŠ” ë° ì»´í¬ë„ŒíŠ¸ ìœ í˜•(ì˜ˆ: ì»¨íŠ¸ë¡¤ëŸ¬, ì„œë¹„ìŠ¤ ë° ë¦¬í¬ì§€í† ë¦¬)ì— ê¸°ë°˜ì„ ë‘˜ ìˆ˜ë„ ìˆê³ , ë¹„ì¦ˆë‹ˆìŠ¤ ë„ë©”ì¸ì— ê¸°ë°˜ì„ ë‘˜ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.\n\në¬¼ê³ ê¸°ì™€ ìˆ˜ì¡° ë‘ ê°€ì§€ ë¹„ì¦ˆë‹ˆìŠ¤ ë„ë©”ì¸ë§Œ ìˆëŠ” ì‘ì€ ì• í”Œë¦¬ì¼€ì´ì…˜ì¸ ê²½ìš°, ì´ í”„ë¡œì íŠ¸ë¥¼ ì´ëŸ¬í•œ ë„ë©”ì¸ì„ ê¸°ë°˜ìœ¼ë¡œ í•´ì„œ ë‹¤ìŒê³¼ ê°™ì´ ë§Œë“¤ ê²ƒì…ë‹ˆë‹¤:\n\n```js\nfishes\n  FishController\n  FishService\n  FishRepository\nfishtanks\n  FishTankController\n  FishTankService\n  FishTankRepository\n```\n\në³´ì‹œë‹¤ì‹œí”¼, ì»¨íŠ¸ë¡¤ëŸ¬, ì„œë¹„ìŠ¤ ë° ë¦¬í¬ì§€í† ë¦¬ ë ˆì´ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ í‘œì¤€ ê³„ì¸µ êµ¬ì¡°ë¥¼ ë”°ë¥´ê³  ìˆìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n## API ì—”ë“œí¬ì¸íŠ¸\n\nì´ ì»¨íŠ¸ë¡¤ëŸ¬ë“¤ì€ ê°ê°ì˜ APIì— ëŒ€í•´ ìƒì„±, ì¡°íšŒ, ì—…ë°ì´íŠ¸ ë° ì‚­ì œ (CRUD) ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì œê³µí•©ë‹ˆë‹¤.\n\n## ì—”í‹°í‹° ë° ë¬¸ì„œ\n\në§Œì•½ JPAì™€ Postgresì™€ ê°™ì€ SQL ë°ì´í„°ë² ì´ìŠ¤ì— ìµìˆ™í•˜ë‹¤ë©´, ì—”í‹°í‹°ì™€ ë¦¬í¬ì§€í† ë¦¬ë¡œ ìµìˆ™í•  ê²ƒì…ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nNo-SQL ë°ì´í„°ë² ì´ìŠ¤ì—ì„œëŠ” í…Œì´ë¸”ì´ ì»¬ë ‰ì…˜ìœ¼ë¡œ ëŒ€ì²´ë˜ê³ , í…Œì´ë¸” ë‚´ì˜ í–‰ì€ ë¬¸ì„œë¡œ ëŒ€ì²´ë©ë‹ˆë‹¤.\n\nì´ëŠ” No-SQL ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ìœ„í•œ ë¦¬í¬ì§€í† ë¦¬ê°€ SQL ë°ì´í„°ë² ì´ìŠ¤ì™€ëŠ” ì¡°ê¸ˆ ë‹¤ë¥´ë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.\n\nNo-SQL ë°ì´í„°ë² ì´ìŠ¤ëŠ” ì–´ë–¤ êµ¬ì¡°ë“  ë‹¤ë£° ìˆ˜ ìˆê¸° ë•Œë¬¸ì—, ì—”í‹°í‹°(ë˜ëŠ” ë¬¸ì„œ)ëŠ” ê°„ë‹¨í•œ Plain Old Java Objects (POJOs)ê°€ ë©ë‹ˆë‹¤. ì´ëŠ” ìš°ë¦¬ ì˜ˆì‹œ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ë‹¤ìŒê³¼ ê°™ì´ ì—”í‹°í‹°ë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤:\n\naquarium/fishes/Fish.java\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\r\n...\n\n@Setter\n@Getter\n@Document(\"fishes\")\n@NoArgsConstructor\npublic class Fish {\n\n  @Id\n  public UUID id;\n\n  public String type;\n\n  public Fish(String type) {\n      this.id = UUID.randomUUID();\n      this.type = type;\n  }\n  ...\n}\n```\n\nì¹œêµ¬ì•¼, ì—¬ê¸° ëª‡ ê°€ì§€ ì£¼ì˜í•  ì ì´ ìˆì–´ìš”:\n\n- @Entityë¥¼ ì •ì˜í•˜ëŠ” ëŒ€ì‹  ì»¬ë ‰ì…˜ì˜ ì´ë¦„ì„ ì‚¬ìš©í•˜ëŠ” @Documentë¥¼ ì •ì˜í•˜ê³  ìˆì–´ìš”.\n- ìì²´ UUID Idë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆë„ë¡ @mongoId ëŒ€ì‹ ì— (í•„ìˆ˜ëŠ” ì•„ë‹ˆì§€ë§Œ MongoDBê°€ ì œê³µí•˜ì§€ ì•Šì€ ê²½ìš° MongoDBë¡œ ì œê³µí•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì—) @Idë¥¼ ì‚¬ìš©í•˜ê³  ìˆì–´ìš”.\n- Lombok(ì˜ˆ: @Getter)ì„ ì‚¬ìš©í•˜ì—¬ ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ ì½”ë“œ ì¼ë¶€ë¥¼ ì œê±°í•˜ëŠ” ê²ƒì„ ì¢‹ì•„í•´ìš”.\n\nì´ì œ ë¹„ìŠ·í•œ ë°©ì‹ìœ¼ë¡œ ë¬¼ê³ ê¸° ìˆ˜ì¡°ë¥¼ ë§Œë“¤ ìˆ˜ ìˆì–´ìš”:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nìˆ˜ì¡±ê´€/fishtanks/FishTank.java\n\n```java\n@Setter\n@Getter\n@Document(\"fish tanks\")\n@NoArgsConstructor\npublic class FishTank {\n\n    @Id\n    public UUID id;\n\n    public String name;\n\n    public FishTank(String name) {\n        this.id = UUID.randomUUID();\n        this.name = name;\n    }\n\n    @Override\n    public String toString() {\n        return String.format(\n                \"FishTank[id=%s, type='%s']\",\n                id.toString(), name);\n    }\n}\n```\n\n## Repositories\n\nì, ì´ì œ ìš°ë¦¬ì˜ ë¬¸ì„œë“¤ì´ ì¤€ë¹„ë˜ì—ˆì–´ìš”. ì´ì œ ì´ë“¤ì— ì–´ë–»ê²Œ ì ‘ê·¼í• ê¹Œìš”?\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì œê°€ ë³´ì—¬ë“œë¦´ ê²ƒì€ ìš°ë¦¬ ì €ì¥ì†Œì˜ ë³€ê²½ ì‚¬í•­ì…ë‹ˆë‹¤. ë¬¼ê³ ê¸° ì €ì¥ì†Œë¥¼ ì˜ˆë¡œ ë“¤ì–´ë³´ê² ìŠµë‹ˆë‹¤:\n\n```js\n...\npublic interface FishRepository extends MongoRepository\u003cFish, UUID\u003e {\n\n    public List\u003cFish\u003e findAll();\n\n    public Optional\u003cFish\u003e findFirstById(UUID id);\n\n    public Optional\u003cFish\u003e findFirstByType(String type);\n}\n...\n```\n\nì´ê²ƒì´ SQL ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì°¾ì„ ìˆ˜ ìˆëŠ” Repository ìœ í˜•ê³¼ ê±°ì˜ ë™ì¼í•˜ë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìœ ì¼í•œ ì°¨ì´ì ì€ ì¸í„°í˜ì´ìŠ¤ê°€ CrudRepositoryê°€ ì•„ë‹Œ MongoRespositoryë¥¼ í™•ì¥í•œë‹¤ëŠ” ê²ƒë¿ì…ë‹ˆë‹¤.\n\ní•œ ëŒ€ ë‹¤ ë° ë‹¤ë¥¸ ë§¤í•‘ ì£¼ì œëŠ” ë‹¤ë¥¸ ê¸°ì‚¬ë¡œ ë¯¸ë£¨ê² ìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ í˜„ì¬ë¡œì„œëŠ” ë¬¼ê³ ê¸°ì™€ ì–´í•­ì„ ìƒì„±í•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n## ì–´í”Œë¦¬ì¼€ì´ì…˜ ì†ì„±\n\në°ì´í„°ë² ì´ìŠ¤ì™€ ì‘ì—…í•  ë•ŒëŠ” ì–´í”Œë¦¬ì¼€ì´ì…˜ì´ ì–´ë–»ê²Œ ì—°ê²°í•´ì•¼ í•˜ëŠ”ì§€ë¥¼ ì•Œë ¤ì¤˜ì•¼ í•©ë‹ˆë‹¤. ìš°ë¦¬ëŠ” SQL ë°ì´í„°ë² ì´ìŠ¤ì™€ ë§ˆì°¬ê°€ì§€ë¡œ ì–´í”Œë¦¬ì¼€ì´ì…˜ ì†ì„±ì„ í†µí•´ ì´ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.\n\në‚˜ëŠ” Spring Boot ì†ì„± íŒŒì¼ì— YAML íŒŒì¼ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ì„ í˜¸í•˜ë©°, ë‚´ êµ¬ì„±ì€ ë‹¤ìŒê³¼ ê°™ì´ ë³´ì…ë‹ˆë‹¤ (ë‚˜ì˜ ê°’ìœ¼ë¡œ ` ` í•„ë“œë¥¼ êµì²´í•´ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤):\n\nresources/application.yml\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```yaml\nspring:\n  application:\n    name: aquarium-with-mongo-db\n\n  data:\n    mongodb:\n      host: localhost\n      port: 27017\n      database: aquarium\n      username: my-app-user\n      password: \u003cpassword\u003e\r\n```\n\në‚˜ì¤‘ì— í”„ë¡œí•„ì— ëŒ€í•´ ì´ì•¼ê¸°í•  ë•Œ ë‹¤ì‹œ ëŒì•„ì˜¬ê²Œìš”.\n\n## ì»¨íŠ¸ë¡¤ëŸ¬ ë° ì„œë¹„ìŠ¤\n\nì´ì œ SQL ë°ì´í„°ë² ì´ìŠ¤ì™€ ë§ˆì°¬ê°€ì§€ë¡œ ì»¨íŠ¸ë¡¤ëŸ¬ì™€ ì„œë¹„ìŠ¤ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. GitHub ì €ì¥ì†Œì—ì„œ ì´ìš© ê°€ëŠ¥í•˜ë¯€ë¡œ ë³„ë„ë¡œ ì œì‹œí•˜ì§€ ì•Šê² ìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n## ì• í”Œë¦¬ì¼€ì´ì…˜ í…ŒìŠ¤íŠ¸\n\nì½”ë“œë¥¼ ì™„ì„±í•˜ê±°ë‚˜(ë˜ëŠ” ì œ ì €ì¥ì†Œë¥¼ ë³µì œ)í•˜ì—¬ IDE ë‚´ì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•˜ì‹­ì‹œì˜¤. ì—¬ì „íˆ ì£¼ ì„œë²„ë¡œ í¬íŠ¸ í¬ì›Œë”© ì¤‘ì¸ ê²½ìš°, ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹œì‘ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.\n\nê·¸ëŸ° ë‹¤ìŒ ë‹¤ìŒ curl ëª…ë ¹ì„ ì‚¬ìš©í•˜ì—¬ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n```js\ncurl localhost:8080/api/v1/fishes -H \"Content-Type: application/json\" -d '{\"type\": \"guppy2\"}' \ncurl localhost:8080/api/v1/fish-tanks -H \"Content-Type: application/json\" -d '{\"name\": \"big one\"}' \ncurl localhost:8080/api/v1/fishes\ncurl localhost:8080/api/v1/fish-tanks\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì´ì œ ì»´í¼ìŠ¤ í´ë¼ì´ì–¸íŠ¸ë¡œ ì´ë™í•˜ì—¬ ì•„ì¿ ì•„ë¦¬ì›€ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ìƒˆë¡œ ê³ ì¹¨í•˜ë©´ fishes ë° fish tanks ë‘ ê°œì˜ ì»¬ë ‰ì…˜ì´ í‘œì‹œë©ë‹ˆë‹¤. ì´ëŸ¬í•œ ì»¬ë ‰ì…˜ ë‚´ì—ëŠ” ë§Œë“  fishes ë° fish tanksê°€ í‘œì‹œë©ë‹ˆë‹¤.\n\n# ìµœì¢… ë‹¨ê³„\n\nì´ ì‹œì ì—ì„œ ì €í¬ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì—ì„œ ì‹¤í–‰ ì¤‘ì¸ MongoDBì— ì—°ê²°ëœ Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê°–ì¶”ì—ˆìŠµë‹ˆë‹¤. ì´ì œ í•´ì•¼ í•  ë§ˆì§€ë§‰ ë‹¨ê³„, ì¦‰ Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— ë¡œë“œí•˜ëŠ” ê²ƒì´ ë‚¨ì•˜ìŠµë‹ˆë‹¤.\n\nì´ë¥¼ ìœ„í•´ ë‹¤ìŒì„ ìˆ˜í–‰í•´ì•¼ í•©ë‹ˆë‹¤:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n- íŒ» JAR íŒŒì¼ì„ ìƒì„±í•©ë‹ˆë‹¤ (ëª¨ë“  ì¢…ì†ì„±ì´ í¬í•¨ë¨)\n- í•´ë‹¹ JARì—ì„œ Docker ì´ë¯¸ì§€ë¥¼ ìƒì„±í•©ë‹ˆë‹¤\n- ì´ë¯¸ì§€ë¥¼ Docker ì €ì¥ì†Œì— ì—…ë¡œë“œí•©ë‹ˆë‹¤\n- ë°°í¬ ë§¤ë‹ˆí˜ìŠ¤íŠ¸ íŒŒì¼ì„ ìƒì„±í•©ë‹ˆë‹¤\n- ë°°í¬ ë§¤ë‹ˆí˜ìŠ¤íŠ¸ë¥¼ Kubernetes í´ëŸ¬ìŠ¤í„°ì— ì ìš©í•©ë‹ˆë‹¤\n\nì œê°€ Kindë¥¼ ì‚¬ìš©í•˜ê³  ìˆê¸° ë•Œë¬¸ì—, 3ë‹¨ê³„ë¥¼ ê°„ë‹¨í•œ ë¡œë“œ ë‹¨ê³„ë¡œ ëŒ€ì²´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ Docker ì €ì¥ì†Œë¥¼ ì‚¬ìš©í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.\n\n## í”„ë¡œí•„\n\nJAR íŒŒì¼ì„ ìƒì„±í•˜ê¸° ì „ì— Spring Boot í”„ë¡œí•„ ë‘ ê°œë¥¼ ìƒì„±í•˜ëŠ” ê²ƒì´ ìœ ìš©í•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì—°ê²°ëœ ëª¨ë“œ (ì§€ê¸ˆê¹Œì§€ í•œ ê²ƒì²˜ëŸ¼) ë° Kubernetes í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Spring Boot í”„ë¡œí•„ ë‘ ê°œë¥¼ ìƒì„±í•˜ê² ìŠµë‹ˆë‹¤:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n- `connected` ... í´ëŸ¬ìŠ¤í„° ì™¸ë¶€ì—ì„œ ì‹¤í–‰ ì¤‘ì¼ ë•Œ ì‚¬ìš©ë˜ëŠ” ëª¨ë“œ\n- `local-cluster` ... í´ëŸ¬ìŠ¤í„° ë‚´ë¶€ì—ì„œ ì‹¤í–‰ ì¤‘ì¼ ë•Œ ì‚¬ìš©ë˜ëŠ” ëª¨ë“œ\n\ní˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ ëª¨ë“œëŠ” ì²« ë²ˆì§¸ì…ë‹ˆë‹¤. ì´ëŠ” ìš°ë¦¬ê°€ ê°„ë‹¨íˆ application.yml(ë˜ëŠ” application.properties) íŒŒì¼ì„ application-connected.ymlë¡œ ë³µì‚¬í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ JVM ëª…ë ¹ì¤„ì— ë‹¤ìŒ JVM ì¸ìˆ˜ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n```js\n-Dspring.profiles.active=connected\n```\n\në¡œì»¬ í´ëŸ¬ìŠ¤í„° íŒŒì¼ì— ëŒ€í•´ì„œë„ ë™ì¼í•œ ì‘ì—…ì„ ìˆ˜í–‰í•˜ì§€ë§Œ ì´ë²ˆì—ëŠ” ë³€ê²½ì´ í•„ìš”í•©ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\r\n...\n  data:\n    mongodb:\n      host: my-mongo-db-svc.mongo.svc.cluster.local\n      port: 27017\n...\r\n```\n\nDNS ì´ë¦„ì„ ì‚¬ìš©í•˜ì—¬ ì˜¬ë°”ë¥¸ íŒŸì— ì—°ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. íŒŸì—ì„œ DNS ê²€ìƒ‰ ê·œì¹™ì´ ì„¤ì •ë˜ì–´ ìˆì–´ my-mongo-db-svc.mongo.svcì™€ ê°™ì€ ì´ë¦„ ì¼ë¶€ë¥¼ ìƒëµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ë‹¤ë¥¸ í´ëŸ¬ìŠ¤í„°ë¡œ ë°°í¬í•˜ê³ ë„ ì‘ìš© í”„ë¡œê·¸ë¨ì´ ì‘ë™í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n## ì´ë¯¸ì§€ ìƒì„±\n\nì´ì œ ì´ë¯¸ì§€ë¥¼ ë§Œë“œëŠ” ë°©ë²•ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. GitHubì— ìˆëŠ” í”„ë¡œì íŠ¸ê°€ Gradle í”„ë¡œì íŠ¸ì´ë¯€ë¡œ ë£¨íŠ¸ í”„ë¡œì íŠ¸ í´ë”ì—ì„œ ë‹¤ìŒê³¼ ê°™ì´ JAR íŒŒì¼ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\ngradle build \n```\n\ngradle.buildì— ì•„ë˜ ë‚´ìš©ì´ ì¶”ê°€ë˜ì—ˆìŒì„ ìœ ì˜í•´ì£¼ì„¸ìš”. ì´ëŠ” manifestê°€ ì£¼ ì• í”Œë¦¬ì¼€ì´ì…˜ íŒŒì¼ì„ ê°€ë¦¬í‚¤ë„ë¡ í•©ë‹ˆë‹¤:\n\ngradle.build\n\n```js\njar {\n    manifest {\n        attributes \"Main-Class\": \"com.requillion_solutions.aquarium.AquariumWithMongoDbApplication\"\n    }\n}\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì´ë ‡ê²Œ í•˜ë©´ jar íŒŒì¼ì´ ìƒì„±ë©ë‹ˆë‹¤: build/libs/aquarium-with-mongo-db-0.0.1-SNAPSHOT.jar.\n\në„ì»¤ ì´ë¯¸ì§€ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ì„œëŠ” ë„ì»¤ íŒŒì¼ì´ í•„ìš”í•©ë‹ˆë‹¤. ì•„ë˜ ë‚´ìš©ëŒ€ë¡œ ë§Œë“¤ì–´ë³´ì„¸ìš”:\n\nDockerfile\n\n```js\nFROM openjdk:17.0.2-slim-buster\nRUN addgroup --system spring \u0026\u0026 useradd --system spring -g spring\nUSER spring:spring\nARG JAR_FILE=build/libs/*.jar\nCOPY ${JAR_FILE} app.jar\nENTRYPOINT [\"java\",\"-jar\",\"/app.jar\"]\nEXPOSE 8080\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì´ëŠ” Java 17 ê¸°ë°˜ ì´ë¯¸ì§€ë¥¼ ì‹œì‘ìœ¼ë¡œ í•©ë‹ˆë‹¤ (ì´ê²ƒì€ ë¡¬ë³µê³¼ì˜ ë¬¸ì œë¥¼ í”¼í•˜ê¸° ìœ„í•´ í•„ìš”í•©ë‹ˆë‹¤) ê·¸ë¦¬ê³  ìƒˆ ì‚¬ìš©ì (spring)ë¥¼ ì¶”ê°€í•˜ì—¬ ë£¨íŠ¸ë¡œ ì‹¤í–‰í•˜ì§€ ì•Šë„ë¡ í•©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ JAR íŒŒì¼ì´ ì´ë¯¸ì§€ë¡œ ë³µì‚¬ë˜ê³  ì‘ìš© í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•˜ëŠ” ì—”íŠ¸ë¦¬í¬ì¸íŠ¸ê°€ ìƒì„±ë©ë‹ˆë‹¤.\n\në‹¤ìŒ ëª…ë ¹ì–´ë¡œ ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•˜ì„¸ìš”:\n\n```bash\ndocker build -t aquarium .\n```\n\nê·¸ë¦¬ê³  ë§Œì•½ Kindë¥¼ ì‚¬ìš© ì¤‘ì´ë¼ë©´, ë‹¤ìŒ ëª…ë ¹ì–´ë¡œ ì§ì ‘ Kubernetes í´ëŸ¬ìŠ¤í„°ì— ë¡œë“œí•˜ì„¸ìš”:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\nkind load docker-image aquarium\n```\n\nì´ ì‘ì—…ì´ ì™„ë£Œë˜ë©´ í´ëŸ¬ìŠ¤í„°ì—ì„œ ì‹¤í–‰í•˜ê¸° ìœ„í•œ ë°°í¬ ë§¤ë‹ˆí˜ìŠ¤íŠ¸ë¥¼ ìƒì„±í•  ì¤€ë¹„ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.\n\n## ë°°í¬ ë§¤ë‹ˆí˜ìŠ¤íŠ¸\n\nì´ì œ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ë¡œë“œí–ˆìœ¼ë¯€ë¡œ ë°°í¬ ë§¤ë‹ˆí˜ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°°í¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒ íŒŒì¼ì„ ë§Œë“¤ì–´ì£¼ì„¸ìš”:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nk8s/deployment.yml\n\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: aquarium\n  namespace: default\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: aquarium\n  template:\n    metadata:\n      labels:\n        app: aquarium\n    spec:\n      containers:\n      - name: aquarium\n        image: aquarium\n        imagePullPolicy: IfNotPresent\n        ports:\n          - containerPort: 8080\n        env:\n          - name: SPRING_PROFILES_ACTIVE\n            value: local-cluster\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: aquarium\n  namespace: default\nspec:\n  selector:\n    app: aquarium\n  type: NodePort\n  ports:\n    - port: 8080\n      targetPort: 8080\n      nodePort: 30080\n```\n\nì•Œì•„ë‘ì–´ì•¼ í•  ì‚¬í•­ì´ ëª‡ ê°€ì§€ ìˆì–´ìš”:\n\n- ì–´í”Œë¦¬ì¼€ì´ì…˜ì´ default ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ë°°í¬ë˜ì—ˆì–´ìš” (ë„¤ì„ìŠ¤í˜ì´ìŠ¤ê°€ ì§€ì •ë˜ì§€ ì•Šìœ¼ë©´ ì‚¬ìš©ë˜ëŠ” ê³³ì´ì£ )\n- ë ˆí”Œë¦¬ì¹´ëŠ” 1ê°œë¿ì´ì—ìš”\n- ì´ë¯¸ì§€ëŠ” ì´ì „ì— ë¶ˆëŸ¬ì™”ìœ¼ë¯€ë¡œ, ì´ë¯¸ì§€ê°€ ì—†ì„ ë•Œë§Œ ë¶ˆëŸ¬ì™€ìš”\n- í”„ë¡œí•„ì€ local-clusterë¡œ ì„¤ì •ë¼ìš”\n- ì„œë¹„ìŠ¤ê°€ ìƒì„±ë˜ì–´ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ í¬íŠ¸ 8080ì„ ê°œë°œ ë¨¸ì‹ ì˜ í¬íŠ¸ 30080ìœ¼ë¡œ ë§¤í•‘ë¼ìš”\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì´ì œ ë‹¤ìŒê³¼ ê°™ì´ ë°°í¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n```js\nkubectl apply -f k8s/deployment.yml\n```\n\nì‹œì‘ì´ ì„±ê³µì ìœ¼ë¡œ ì´ë£¨ì–´ì¡ŒëŠ”ì§€ í™•ì¸í•´ë³´ì„¸ìš”:\n\n```js\nkubectl get pods\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\ní•œ ë²ˆì´ ë°°í¬ë˜ë©´ APIëŠ” ì´ì „ì— ì‚¬ìš©í•œ ê²ƒê³¼ ë™ì¼í•œ curl ëª…ë ¹ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¨, í¬íŠ¸ë¥¼ 30080ìœ¼ë¡œ ë³€ê²½í•´ ì£¼ì„¸ìš”.\n\n```js\ncurl localhost:30080/api/v1/fishes -H \"Content-Type: application/json\" -d '{\"type\": \"guppy2\"}' \ncurl localhost:30080/api/v1/fish-tanks -H \"Content-Type: application/json\" -d '{\"name\": \"big one\"}' \ncurl localhost:30080/api/v1/fishes\ncurl localhost:30080/api/v1/fish-tanks\n```\n\nCompass UIì—ì„œ ìƒˆ ë¬¸ì„œë¥¼ í™•ì¸í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤ (í¬íŠ¸ í¬ì›Œë“œê°€ ì—¬ì „íˆ ìœ ì§€ë˜ëŠ”ì§€ í™•ì¸í•´ ì£¼ì„¸ìš”).\n\n# ìš”ì•½\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì´ ê¸°ì‚¬ëŠ” Kind Kubernetes í´ëŸ¬ìŠ¤í„°ë¡œ MongoDBë¥¼ ì„¤ì¹˜í•˜ê³  Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ í†µí•©í•˜ëŠ” ê³¼ì •ì— ëŒ€í•´ ë‹¤ë£¨ì—ˆìŠµë‹ˆë‹¤.\n\nì´ ì—°ìŠµì€ ê½¤ ê°„ë‹¨í•˜ì§€ë§Œ ê·¸ëƒ¥ ì–´ë–»ê²Œ í•˜ëŠ”ì§€ ë³´ì—¬ì£¼ëŠ” ê²ƒë¿ì…ë‹ˆë‹¤. ì‹¤ì œë¡œëŠ” ë³´ì•ˆ, ë°±ì—… ë° ì¥ì•  ì¡°ì¹˜ì— ì‘ì—…ì´ í•„ìš”í•  ê²ƒì…ë‹ˆë‹¤.\n\në‹¤ë¥¸ ê¸°ì‚¬ì—ì„œëŠ” ë¬¸ì„œê°„ì˜ ê´€ê³„ë¥¼ ì–´ë–»ê²Œ ê´€ë¦¬í•  ìˆ˜ ìˆëŠ”ì§€ë„ ë³´ì—¬ë“œë¦´ ì˜ˆì •ì…ë‹ˆë‹¤.\n\nì´ ì—°ìŠµì„ í†µí•´ No-SQL ë°ì´í„°ë² ì´ìŠ¤ê°€ Kubernetesì™€ Spring Bootì™€ ê°„ë‹¨í•˜ê²Œ ì‚¬ìš©ë  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ë³´ì—¬ì¤¬ìœ¼ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì´ ê¸€ì„ ì¦ê²ê²Œ ì½ìœ¼ì…¨ê¸°ë¥¼ ë°”ë¼ë©°, ìƒˆë¡œìš´ ê²ƒì„ ë°°ìš°ë©° ê¸°ìˆ ì„ í–¥ìƒì‹œì¼°ê¸°ë¥¼ ë°”ëë‹ˆë‹¤. ì‘ì€ ê±°ë¼ë„ ìƒˆë¡œìš´ ì§€ì‹ì„ ì–»ì—ˆë‹¤ë©´ ì¢‹ê² ë„¤ìš”.\n\nì´ ê¸€ì´ ìœ ìµí•˜ê²Œ ëŠê»´ì§„ë‹¤ë©´, ë°•ìˆ˜ í•œ ë²ˆ ë¶€íƒë“œë¦½ë‹ˆë‹¤. ê·¸ë ‡ê²Œ í•˜ë©´ ë¯¸ë˜ì— ì–´ë–¤ ê¸€ì„ ì¨ì•¼ í•˜ëŠ”ì§€ íŒŒì•…í•  ìˆ˜ ìˆê³ , ë‹¤ìŒ ê¸€ì„ ê²°ì •í•˜ëŠ” ë° ë„ì›€ì´ ë©ë‹ˆë‹¤. ê°œì„  ì‚¬í•­ì´ë‚˜ ì œì•ˆ ì‚¬í•­ì´ ìˆë‹¤ë©´ ë©”ëª¨ë‚˜ ë‹µê¸€ë¡œ ì¶”ê°€í•´ ì£¼ì„¸ìš”.","ogImage":{"url":"/assets/img/2024-06-19-MyexperienceaddingaMongoDBNo-SQLdatabasetomyKubernetescluster_0.png"},"coverImage":"/assets/img/2024-06-19-MyexperienceaddingaMongoDBNo-SQLdatabasetomyKubernetescluster_0.png","tag":["Tech"],"readingTime":18},{"title":"Argo CD v212 ë¦´ë¦¬ìŠ¤ í›„ë³´íŒ","description":"","date":"2024-06-19 12:59","slug":"2024-06-19-ArgoCDv212ReleaseCandidate","content":"\n\nì €í¬ê°€ ê¸°ìœ ë§ˆìŒìœ¼ë¡œ Argo CD v2.12 ë¦´ë¦¬ìŠ¤ í›„ë³´íŒì´ ê³µê°œë˜ì—ˆë‹¤ëŠ” ì†Œì‹ì„ ì „í•´ë“œë¦½ë‹ˆë‹¤! ì´ë²ˆ ë¦´ë¦¬ìŠ¤ì—ëŠ” 30ê°œ ì´ìƒì˜ ìƒˆë¡œìš´ ê¸°ëŠ¥, 70ì—¬ ê°œì˜ ë²„ê·¸ ìˆ˜ì •, ê·¸ë¦¬ê³  60ê°œì˜ ë¬¸ì„œ ì—…ë°ì´íŠ¸ê°€ í¬í•¨ë˜ì–´ ìˆì–´ìš”.\n\nê³§ë°”ë¡œ ë¦´ë¦¬ìŠ¤ í›„ë³´íŒì„ í…ŒìŠ¤íŠ¸í•˜ê³  ë§ˆì£¼í•œ ì–´ë–¤ ë²„ê·¸ë‚˜ ë¬¸ì œì— ëŒ€í•œ í”¼ë“œë°±ì„ ë³´ë‚´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤. ì´ëŠ” ì—¬ëŸ¬ë¶„ì´ ì˜ê²¬ì„ ì „í•  ìˆ˜ ìˆê³  Argo CDê°€ ë” ë‚˜ì•„ì§€ë„ë¡ ë„ì™€ì¤„ ìˆ˜ ìˆëŠ” í° ê¸°íšŒì…ë‹ˆë‹¤.\n\n# Multi-source application advancements\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì—¬ëŸ¬ ì†ŒìŠ¤ì—ì„œ Argo CD ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìƒì„±í•˜ëŠ” ê²ƒì€ ì˜¤ëœ ì‹œê°„ ë™ì•ˆ ê°€ì¥ ìš”ì²­ì´ ë§ì•˜ë˜ Argo CD ê¸°ëŠ¥ ì¤‘ í•˜ë‚˜ì˜€ìŠµë‹ˆë‹¤. ì´ ê¸°ëŠ¥ì„ í†µí•´ ì—¬ëŸ¬ ìœ„ì¹˜(ì˜ˆ: ê³µê°œ Helm ì°¨íŠ¸ ë° ë¡œì»¬ ê°’ íŒŒì¼)ì—ì„œ ì •ë³´ë¥¼ ê·¸ë£¹í™”í•˜ì—¬ ë‹¨ì¼ Argo CD ì• í”Œë¦¬ì¼€ì´ì…˜ì„ í˜•ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—¬ëŸ¬ ì†ŒìŠ¤ë¥¼ ì •ì˜í•˜ëŠ” ì´ˆê¸° ì§€ì›ì€ ì´ë¯¸ Argo CD ë²„ì „ 2.6ì— ì¶”ê°€ë˜ì—ˆê³ , CLIë¥¼ ìœ„í•œ ì§€ì›ì€ 2.11ì— ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤. UIëŠ” ì—¬ì „íˆ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë‹¨ì¼ ì†ŒìŠ¤ë¥¼ ê°€ì§€ê³  ìˆë‹¤ê³  ê°€ì •í•˜ê³  ë¡¤ë°±ê³¼ ê°™ì€ íŠ¹ì • CLI ê¸°ëŠ¥ì€ ì—¬ëŸ¬ ì†ŒìŠ¤ë¥¼ ê°€ì§„ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ëŒ€í•´ ì•„ì§ ì§€ì›ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.\n\nArgo CD ë²„ì „ 2.12ì—ì„œëŠ” ì—¬ëŸ¬ ì†ŒìŠ¤ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë¡¤ë°±ì´ ì´ì œ Argo CD UI ë° CLIì—ì„œ ëª¨ë‘ ê°€ëŠ¥í•©ë‹ˆë‹¤.\n\në¡¤ë°± ê¸°ëŠ¥ ì™¸ì—ë„, ì• í”Œë¦¬ì¼€ì´ì…˜ ì„¸ë¶€ ì •ë³´ í˜ì´ì§€ì— ìƒˆë¡œìš´ \"ì†ŒìŠ¤\" íƒ­ì´ ì¶”ê°€ë˜ì–´ ì‚¬ìš©ìê°€ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì†ŒìŠ¤ë¥¼ ê´€ë¦¬(ë³´ê¸° ë° í¸ì§‘)í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n\u003cimg src=\"/assets/img/2024-06-19-ArgoCDv212ReleaseCandidate_1.png\" /\u003e\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nKeith Chong (Red Hat)ê³¼ Jorge Turradoì—ê²Œ ì´ëŸ¬í•œ ê¸°ëŠ¥ë“¤ì„ êµ¬í˜„í•´ ì¤˜ì„œ ê°ì‚¬í•©ë‹ˆë‹¤.\n\n# í”„ë¡œì íŠ¸ë³„ ì €ì¥ì†Œ ìê²©ì¦ëª… ê°œì„ ì‚¬í•­\n\ní˜„ì¬ Argo CD APIì—ì„œëŠ” ë™ì¼í•œ URLì„ ê³µìœ í•˜ëŠ” ì—¬ëŸ¬ ì €ì¥ì†Œ ìê²©ì¦ëª…ì„ í—ˆìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì €ì¥ì†Œ ìê²©ì¦ëª…ì´ argocd ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ì§ì ‘ ì¶”ê°€ëœ ê²½ìš°, argocd-serverëŠ” ì˜¤ë¥˜ë¥¼ ë°˜í™˜í•˜ì§€ ì•Šì§€ë§Œ ì´ ì‘ì—…ì€ ì‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. URLê³¼ ì¼ì¹˜í•˜ëŠ” ì²« ë²ˆì§¸ ì‹œí¬ë¦¿ì´ ë°˜í™˜ë˜ë©° ìˆœì„œë„ ì •ì˜ë˜ì–´ ìˆì§€ ì•Šê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. \n\nArgo CD ë²„ì „ 2.12ë¶€í„°ëŠ” ì—¬ëŸ¬ ì•± í”„ë¡œì íŠ¸ê°€ ë™ì¼í•œ URLì„ ê°€ì§„ ë³„ë„ì˜ ì €ì¥ì†Œ ìê²©ì¦ëª…ì„ ê°€ì§ˆ ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì•ˆë…•í•˜ì„¸ìš” Blake Petterssonë‹˜(Akuity)! \n\n# Kubernetes ì´ë²¤íŠ¸ì— ë ˆì´ë¸” ì¶”ê°€í•˜ê¸°\n\nArgo CD ë²„ì „ 2.12ì—ì„œ ì‚¬ìš©ìë“¤ì€ Argo CDì—ì„œ ìƒì„±ëœ k8s ì´ë²¤íŠ¸ì— ì• í”Œë¦¬ì¼€ì´ì…˜ ë ˆì´ë¸”ì„ ë…¸ì¶œí•  ìˆ˜ ìˆê²Œ ë  ê²ƒì…ë‹ˆë‹¤. `resource.includeEventLabelKeys`ì—ì„œ ì •ì˜ëœ íŠ¹ì • ë ˆì´ë¸” í‚¤ë¥¼ ê°€ì§„ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ëŒ€í•´ ìƒì„±ëœ ì´ë²¤íŠ¸ì— ëŒ€ì‘í•˜ëŠ” ë ˆì´ë¸”ì´ ì´ë²¤íŠ¸ì— ì²¨ë¶€ë  ê²ƒì…ë‹ˆë‹¤. ì´ ì—°ê²°ì€ ì´ëŸ¬í•œ ë ˆì´ë¸”ì„ ì‚¬ìš©í•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê¸°ë°˜ìœ¼ë¡œ ì´ë²¤íŠ¸ë¥¼ í•„í„°ë§í•˜ê±°ë‚˜ ì²˜ë¦¬í•˜ëŠ” ê²ƒì„ ë” ê°„ë‹¨í•˜ê²Œ ë§Œë“¤ì–´ ì¤ë‹ˆë‹¤.\n\nì´ ê¸°ëŠ¥ì„ êµ¬í˜„í•´ì¤€ Siddhesh Ghadi(Red Hat)ë‹˜ì—ê²Œ ê°ì‚¬ë“œë¦½ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# ì¼ê´€ì„±ìˆëŠ” ìƒ¤ë”© ì•Œê³ ë¦¬ì¦˜\n\nArgo CDëŠ” ë‹¤ë¥¸ Argo CD ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨íŠ¸ë¡¤ëŸ¬ì— ëŒ€í•œ ìƒ¤ë”© ì ìš© ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ íŠ¹ì • í´ëŸ¬ìŠ¤í„°ë¥¼ íŠ¹ì • ì»¨íŠ¸ë¡¤ëŸ¬ì— í• ë‹¹í•˜ì—¬ ë¶€í•˜ë¥¼ ë‹¤ì–‘í•œ ìƒ¤ë“œë¡œ ë¶„ì‚°ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nê¸°ì¡´ì˜ ìƒ¤ë”© ì•Œê³ ë¦¬ì¦˜ì¸ ë ˆê±°ì‹œ ë°©ë²•ê³¼ ë¼ìš´ë“œ ë¡œë¹ˆ ì•Œê³ ë¦¬ì¦˜ì„ í¬í•¨í•œ ê¸°ì¡´ ë°©ì‹ì€ ìµœì ì˜ ë¶€í•˜ ë¶„ì‚° ìœ ì§€ì™€ ë¶ˆí•„ìš”í•œ í´ëŸ¬ìŠ¤í„°-ìƒ¤ë“œ í• ë‹¹ ë³€ê²½ì„ ìµœì†Œí™”í•˜ëŠ” ë° ì œí•œ ì‚¬í•­ì´ ìˆì—ˆìŠµë‹ˆë‹¤.\n\nArgo CD ë²„ì „ 2.12ë¶€í„° ìƒˆë¡œìš´ ìƒ¤ë”© ì•Œê³ ë¦¬ì¦˜ì¸ \"ì¼ê´€ì  í•´ì‹±(consistent-hashing)\"ì´ ì†Œê°œë˜ì—ˆìœ¼ë©°, ì´ëŠ” í´ëŸ¬ìŠ¤í„°-ìƒ¤ë“œ í• ë‹¹ ë³€ê²½ì„ ì¤„ì´ê³  ë¦¬ì†ŒìŠ¤ ì´ìš©ë¥ ì„ ìµœì í™”í•©ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì´ë²ˆ íŠ¹ì§•ì„ êµ¬í˜„í•œ Akram Ben Aissi (Red Hat)ì—ê²Œ ê°ì‚¬ë“œë¦½ë‹ˆë‹¤.\n\n# ê¸°íƒ€ ì£¼ëª©í• ë§Œí•œ ë³€ê²½ ì‚¬í•­\n\në¦´ë¦¬ìŠ¤ì— ì¶”ê°€ëœ ëª‡ ê°€ì§€ ìƒˆë¡œìš´ ë³€ê²½ ì‚¬í•­ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\n\n- ì‹œë©˜í‹± ë²„ì „ íƒœê·¸ í•´ê²°ì„ ìœ„í•œ git í´ë¼ì´ì–¸íŠ¸ ì—…ë°ì´íŠ¸ (Stone Paymentsì˜ Pablo Aguilarê°€ ìˆ˜í–‰)\n- Application Set Git Generatorê°€ ì´ì œ GPG ì„œëª… í™•ì¸ì„ ì§€ì›í•©ë‹ˆë‹¤ (Red Hatì˜ Ishita Sequeiraê°€ ìˆ˜í–‰)\n- ls-remote ìš”ì²­ ì‹¤íŒ¨ ì§€í‘œ ì¶”ê°€ (Jack-R-lanternì´ ìˆ˜í–‰)\n- ìƒˆë¡œìš´ ì£¼ì„ argocd.argoproj.io/sync-options: Force=true ì¶”ê°€ (CyberAgent, Inc.ì˜ Kota Kimuraê°€ ìˆ˜í–‰)\n- gRPC ë©”ì‹œì§€ í¬ê¸°ë¥¼ í™˜ê²½ ë³€ìˆ˜ë¡œ ì„¤ì •í•˜ëŠ” ì§€ì› ì¶”ê°€ (Codefreshì˜ Pavel Kostohrysê°€ ìˆ˜í–‰)\n- ì‚­ì œ íŒì—…ì—ì„œ ì¢…ì† ë¦¬ì†ŒìŠ¤ ëª©ë¡ í‘œì‹œ (Intuitì˜ Alexandre Gaudreaultê°€ ìˆ˜í–‰)\n- old tracking label applications.argoproj.io/app-nameì— ëŒ€í•œ ì§€ì› ì œê±° (Akuityì˜ Soumya Ghosh Dastidarê°€ ìˆ˜í–‰)\n- Argo CD CLIì— ëŒ€í•œ fish ì‰˜ ì™„ì„± ì§€ì› ì¶”ê°€ (Sn0rtê°€ ìˆ˜í–‰)\n- ë¡œì»¬ë¡œ ì¡´ì¬í•˜ëŠ” ì²´í¬ì•„ì›ƒí•  ì»¤ë°‹ì´ ìˆëŠ” ê²½ìš° git fetch í˜¸ì¶œ ê±´ë„ˆë›°ê¸° (Shady Rafehiê°€ ìˆ˜í–‰)\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# ìƒˆ ë¦´ë¦¬ìŠ¤ëŠ” ì–´ë””ì—ì„œ ë°›ì„ ìˆ˜ ìˆë‚˜ìš”?\n\në” ìì„¸í•œ ë‚´ìš©ê³¼ ì„¤ì¹˜ ì§€ì¹¨ì€ ë¦´ë¦¬ìŠ¤ ë…¸íŠ¸ì™€ ì—…ê·¸ë ˆì´ë“œ ì§€ì¹¨ì„ í™•ì¸í•´ì£¼ì„¸ìš”. ë¦´ë¦¬ìŠ¤ í›„ë³´ë¥¼ ì‹œë„í•˜ê³  í”¼ë“œë°±ì„ ê³µìœ í•´ì£¼ì„¸ìš”. Argo ì»¤ë®¤ë‹ˆí‹°ì˜ ëª¨ë“  ê¸°ì—¬ìì™€ ì‚¬ìš©ìë“¤ê»˜ ê¸°ì—¬, í”¼ë“œë°± ë° ë¦´ë¦¬ìŠ¤ í…ŒìŠ¤íŠ¸ì—ì„œ ë„ì™€ì¤€ ì ì— í¬ê²Œ ê°ì‚¬ë“œë¦½ë‹ˆë‹¤!","ogImage":{"url":"/assets/img/2024-06-19-ArgoCDv212ReleaseCandidate_0.png"},"coverImage":"/assets/img/2024-06-19-ArgoCDv212ReleaseCandidate_0.png","tag":["Tech"],"readingTime":3},{"title":"ë„ì»¤ì—ì„œ ìì²´ ì„œëª… ì¸ì¦ì„œë¥¼ ì‚¬ìš©í•œ NGINX","description":"","date":"2024-06-19 12:57","slug":"2024-06-19-NGINXwithSelf-SignedCertificateonDocker","content":"\n\n\u003cimg src=\"/assets/img/2024-06-19-NGINXwithSelf-SignedCertificateonDocker_0.png\" /\u003e\n\nì €í¬ ì½”ë“œë¥¼ ì‘ì—…í•˜ëŠ” ë™ì•ˆ HTTPSì—ì„œ ì‘ì—…ì´ ì˜ë˜ëŠ”ì§€ ë˜ëŠ” ë” ì¤‘ìš”í•œ ê²ƒì€ HTTPSì—ì„œ ì‘ë™í•˜ëŠ” ë°©ì‹ì„ ë¹ ë¥´ê²Œ í™•ì¸í•´ì•¼í•  ë•Œê°€ ë§ìŠµë‹ˆë‹¤. ì˜¨ë¼ì¸ì—ì„œëŠ” CSR(Certificate Sign Request)ë¥¼ ìƒì„±í•˜ê³  í•´ë‹¹ CSRì„ ìì²´ë¡œ ì„œëª…í•˜ê³  ì›¹ ì„œë²„ì˜ êµ¬ì„±ì„ ìˆ˜ë™ìœ¼ë¡œ ìˆ˜ì •í•˜ì—¬ í•´ë‹¹ ì¸ì¦ì„œë¥¼ ì‚¬ìš©í•˜ë„ë¡ ë§Œë“œëŠ” ë°©ë²•ì„ ë³´ì—¬ì£¼ëŠ” ê°€ì´ë“œê°€ ë§ì´ ìˆìŠµë‹ˆë‹¤.\n\nì´ ê¸°ì‚¬ì—ì„œëŠ” ì–´ë–¤ ê²ƒë„ ìƒì„±í•˜ê±°ë‚˜ ìˆ˜ë™ìœ¼ë¡œ í¸ì§‘í•˜ì§€ ì•Šê³ ë„ ë„ì»¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ìì²´ ì„œëª…ëœ ì¸ì¦ì„œê°€ ìˆëŠ” NGINX ì»¨í…Œì´ë„ˆë¥¼ ë¹ ë¥´ê²Œ ì‹¤í–‰í•˜ëŠ” ì™„ì „ ìë™í™”ëœ í”„ë¡œì„¸ìŠ¤ë¥¼ ì œì‹œí•˜ê² ìŠµë‹ˆë‹¤!\n\n# ë³´ì•ˆ ì£¼ì˜ì‚¬í•­ê³¼ ê²½ê³ \n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n- ìì²´ ì„œëª…ëœ ì¸ì¦ì„œëŠ”... ë‹¹ì‹ ë§Œ ì‹ ë¢°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìƒì‚° í™˜ê²½ì—ì„œ ë°ì´í„°ë¥¼ ì œê³µí•˜ëŠ” ìˆ˜ë‹¨ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ê·¸ëŸ° ê²½ìš°ì—ëŠ” ì ì ˆí•œ ì¸ì¦ì„œë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.\n- ì´ ê¸€ì—ì„œ ì œì‹œëœ HTTPSë¡œ ì½˜í…ì¸ ë¥¼ ì œê³µí•˜ê²Œë” NGINX êµ¬ì„±ì€ ì‘ì—…ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•œ ìµœì†Œí•œì˜ ê²ƒì…ë‹ˆë‹¤. ë³¸ê²©ì ì¸ TLSê°€ ì ìš©ëœ í”„ë¡œë•ì…˜ NGINXë¥¼ ìˆ˜ì •í•˜ë ¤ë©´ ê³µì‹ ê°€ì´ë“œë¥¼ ì°¸ê³ í•˜ì„¸ìš”.\n\nê³µê°œ í‚¤ ì•”í˜¸í™”ë¥¼ ì²˜ìŒ ì‹œì‘í•˜ëŠ” ê²½ìš°, ë„ì›€ì´ ë  ìˆ˜ ìˆëŠ” ì†Œê°œ ê¸°ì‚¬ë¥¼ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\n\n# ì„¤ê³„ ë””ìì¸\n\në¹Œë“œëŠ” 2ë‹¨ê³„ Docker ë¹Œë“œë¡œ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n\n\u003cimg src=\"/assets/img/2024-06-19-NGINXwithSelf-SignedCertificateonDocker_1.png\" /\u003e\n\nì²« ë²ˆì§¸ ë‹¨ê³„ì—ì„œ Alpine Linux ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. Alpineì˜ íŒ¨í‚¤ì§€ ê´€ë¦¬ìì¸ APKë¥¼ ì‚¬ìš©í•˜ì—¬ OpenSSLì„ ì„¤ì¹˜í•©ë‹ˆë‹¤. ë‹¤ìŒ ë‹¨ê³„ì—ì„œ OpenSSLì„ ì‚¬ìš©í•˜ì—¬ ì…€í”„ ì„œëª… ì¸ì¦ì„œì™€ ê´€ë ¨ ê°œì¸ í‚¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.\n\në‘ ë²ˆì§¸ ë‹¨ê³„ì—ì„œ NGINX ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ë¹Œë“œëŠ” ì´ì „ ë‹¨ê³„ì—ì„œ ìƒì„±ëœ ì¸ì¦ì„œì™€ ê°œì¸ í‚¤ë¥¼ í¬í•¨í•˜ë„ë¡ ì´ë¯¸ì§€ë¥¼ ìˆ˜ì •í•˜ê³  HTTPSë¥¼ í™œì„±í™”í•˜ê¸° ìœ„í•œ ê°„ë‹¨í•œ NGINX êµ¬ì„±ì„ ì‘ì„±í•©ë‹ˆë‹¤.\n\n# Dockerfile\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```dockerfile\n# syntax=docker/dockerfile:1\n# ì´ Dockerfileì„ ë¹Œë“œí•˜ë ¤ë©´ Docker BuildKitê°€ í™œì„±í™”ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.\n\n# ì‚¬ìš©í•  Alpine ë° NGINX ë²„ì „ì„ ì •ì˜í•©ë‹ˆë‹¤.\nARG ALPINE_VERSION=3.17.3\nARG NGINX_VERSION=1.23.4\n\n# OpenSSLì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ Alpine ê¸°ë°˜ ì´ë¯¸ì§€ë¥¼ ì¤€ë¹„í•©ë‹ˆë‹¤.\nFROM alpine:${ALPINE_VERSION} as alpine\nARG DOMAIN_NAME=localhost\nARG DAYS_VALID=30\n\nRUN apk add --no-cache openssl\nRUN echo \"${DAYS_VALID}ì¼ ë™ì•ˆ ìœ íš¨í•œ ${DOMAIN_NAME} ë„ë©”ì¸ì„ ìœ„í•œ ìì²´ ì„œëª… ì¸ì¦ì„œë¥¼ ìƒì„±í•©ë‹ˆë‹¤.\" \u0026\u0026 \\\n    openssl \\\n    req -x509 \\\n    -nodes \\\n    -subj \"/CN=${DOMAIN_NAME}\" \\\n    -addext \"subjectAltName=DNS:${DOMAIN_NAME}\" \\\n    -days ${DAYS_VALID} \\\n    -newkey rsa:2048 -keyout /tmp/self-signed.key \\\n    -out /tmp/self-signed.crt\n\n# ìœ„ì—ì„œ ìƒì„±í•œ ì¸ì¦ì„œë¥¼ ì‚¬ìš©í•˜ì—¬ NGINX ê¸°ë°˜ ì´ë¯¸ì§€ë¥¼ ì¤€ë¹„í•©ë‹ˆë‹¤.\nFROM nginx:${NGINX_VERSION} as nginx\nCOPY --from=alpine /tmp/self-signed.key /etc/ssl/private\nCOPY --from=alpine /tmp/self-signed.crt /etc/ssl/certs\nCOPY \u003c\u003cEOF /etc/nginx/conf.d/default.conf\nserver {\n    listen 80;\n    listen [::]:80;\n    listen 443 ssl;\n    listen [::]:443 ssl;\n    ssl_certificate /etc/ssl/certs/self-signed.crt;\n    ssl_certificate_key /etc/ssl/private/self-signed.key;\n    location / {\n        root   /usr/share/nginx/html;\n        index  index.html index.htm;\n    }\n    error_page   500 502 503 504  /50x.html;\n    location = /50x.html {\n        root   /usr/share/nginx/html;\n    }\n}\nEOF\n```\n\nğŸ‘‰ ìœ„ì˜ Dockerfileì„ ì‹œë„í•˜ê¸° ì „ì— Docker BuildKitê°€ í™œì„±í™”ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”. BuildKitëŠ” ë ˆê±°ì‹œ ë¹Œë”ë¥¼ ëŒ€ì²´í•˜ëŠ” ê°œì„ ëœ ë°±ì—”ë“œë¡œ, Docker ë°ìŠ¤í¬í†± ë° Docker Engine ë²„ì „ 23.0ë¶€í„° ì‚¬ìš©ìë“¤ì—ê²Œ ê¸°ë³¸ ë¹Œë”ë¡œ ì œê³µë©ë‹ˆë‹¤.\n\n## Stage 1: ì¸ì¦ì„œ ìƒì„±\n\nì¸ì¦ì„œ ë° ê°œì¸ í‚¤ë¥¼ ìƒì„±í•˜ê¸° ìœ„í•´ OpenSSLì„ ì‚¬ìš©í•˜ë©° í•„ìš”í•œ ëª¨ë“  ì •ë³´ë¥¼ ì¸ìˆ˜ë¡œ ì „ë‹¬í•˜ì—¬ ëŒ€í™”í˜• ëª¨ë“œê°€ ì•„ë‹Œ ëª¨ë“œì—ì„œ ëª…ë ¹ì„ ì‹¤í–‰í•©ë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì€ Docker ARGë¥¼ ì§€ì •í•˜ì—¬ ì´ ë‹¨ê³„ë¥¼ ìì‹ ì˜ ìš”êµ¬ì— ë§ê²Œ ì¡°ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n- DOMAIN_NAME: ì´ëŠ” ì¸ì¦ì„œê°€ ìœ íš¨í•œ ë„ë©”ì¸ì…ë‹ˆë‹¤. ì´ëŠ” ìì²´ ì„œëª…ëœ ì¸ì¦ì„œì´ë¯€ë¡œ ì—¬ê¸°ì— ì§€ì •í•œ ë„ë©”ì¸ ì´ë¦„ì€ ì¤‘ìš”í•œ ì—­í• ì„ í•˜ì§€ ì•Šì§€ë§Œ, í•´ë‹¹ ì¸ì¦ì„œë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ì‘ìš© í”„ë¡œê·¸ë¨ì´ ìˆëŠ” ê²½ìš°, ì•¡ì„¸ìŠ¤í•  ë¦¬ì†ŒìŠ¤ì˜ ë„ë©”ì¸ ì´ë¦„ê³¼ ì¼ì¹˜í•˜ë„ë¡ ë³€ê²½í•´ì•¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¹Œë“œì— ì‚¬ìš©ëœ ê¸°ë³¸ ë„ë©”ì¸ì€ localhostì…ë‹ˆë‹¤.\r\n- DAYS_VALID: ì¸ì¦ì„œê°€ ìœ íš¨í•œ ì¼ìˆ˜ì…ë‹ˆë‹¤. í…ŒìŠ¤íŠ¸ë¥¼ ì™„ë£Œí•  ìˆ˜ ìˆë„ë¡ ì¶©ë¶„íˆ í° ìˆ«ìë¥¼ ì‚¬ìš©í•˜ì‹­ì‹œì˜¤. ë¹Œë“œì— ì‚¬ìš©ëœ ê¸°ë³¸ ìœ íš¨ ê¸°ê°„ì€ 30ì¼ì…ë‹ˆë‹¤.\r\n\r\n## ë‹¨ê³„ 2: ìˆ˜ì •ëœ NGINX ì´ë¯¸ì§€ ìƒì„±\r\n\r\nì´ ë‹¨ê³„ì—ì„œëŠ” ì´ì „ ë‹¨ê³„ì—ì„œ ìƒì„±ëœ ì¸ì¦ì„œì™€ ê°œì¸ í‚¤ë¥¼ ê°€ì ¸ì™€ ìƒˆë¡œ ìƒì„±ëœ ì´ë¯¸ì§€ë¡œ ë³µì‚¬í•©ë‹ˆë‹¤. ë˜í•œ HTTPSë¥¼ í™œì„±í™”í•˜ê¸° ìœ„í•´ ê°„ë‹¨í•œ NGINX êµ¬ì„±ì„ ìƒì„±í•˜ê¸° ìœ„í•´ heredocë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.\r\n\r\nì§ì ‘ ì´ë¯¸ì§€ ìƒì— ë‹¤ë¥¸ êµ¬ì„±ì„ ì‚¬ìš©í•˜ë ¤ëŠ” ê²½ìš°, heredocë¥¼ ìì²´ ì½˜í…ì¸ ë¡œ ëŒ€ì²´í•˜ê±°ë‚˜ ê²°ê³¼ ì´ë¯¸ì§€ë¥¼ í™•ì¥í•˜ì—¬ ìì²´ ì´ë¯¸ì§€ì— ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¯¸ì§€ë¥¼ ìì²´ êµ¬ì„± íŒŒì¼ë¡œ í™•ì¥í•˜ëŠ” ê²½ìš°, í•´ë‹¹ íŒŒì¼ì€ ë‹¤ìŒ ìœ„ì¹˜ì— ë°°ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.\n/etc/nginx/conf.d/default.conf.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# ì´ë¯¸ì§€ ë¹Œë“œí•˜ê¸°\n\nì•ŒíŒŒì¸ ì´ë¯¸ì§€ì™€ NGINX ì´ë¯¸ì§€ëŠ” ë§¤ìš° ì‘ê¸° ë•Œë¬¸ì— ë¹Œë“œ ì†ë„ê°€ ì •ë§ ë¹ ë¦…ë‹ˆë‹¤. ë‹¤ìŒìœ¼ë¡œ ë¹Œë“œë¥¼ ì‹œì‘í•˜ì„¸ìš”:\n\n```bash\ndocker build . -t nginx-self-signed\n```\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-19-NGINXwithSelf-SignedCertificateonDocker_2.png)\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# ì´ë¯¸ì§€ ì‹¤í–‰í•˜ê¸°\n\nì´ë¯¸ì§€ë¥¼ ì‹¤í–‰í•  ë•Œ, Docker Engineì´ ì‹¤í–‰ ì¤‘ì¸ ì»´í“¨í„°ì—ì„œ 80ë²ˆ í¬íŠ¸ë¥¼ HTTPìš©, ê·¸ë¦¬ê³  443ë²ˆ í¬íŠ¸ë¥¼ HTTPSìš©ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í•´ ì£¼ì„¸ìš”. ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¨í…Œì´ë„ˆë¥¼ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n\ndocker run -p 80:80 -p 443:443 nginx-self-signed\n\n\n![NGINXwithSelf-SignedCertificateonDocker_3](/assets/img/2024-06-19-NGINXwithSelf-SignedCertificateonDocker_3.png)\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# ì´ë¯¸ì§€ í…ŒìŠ¤íŠ¸ ì¤‘\n\nì‹ ë¢°í•  ìˆ˜ ìˆëŠ” curlì„ ì‚¬ìš©í•´ì„œ ëª‡ ê°€ì§€ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë´…ì‹œë‹¤. ë§Œì•½ ë„ì»¤ ì—”ì§„ì´ ë¡œì»¬ í˜¸ìŠ¤íŠ¸ì—ì„œ ì‹¤í–‰ë˜ì§€ ì•ŠëŠ”ë‹¤ë©´ localhostë¥¼ ì ì ˆí•œ ì£¼ì†Œë¡œ ë°”ê¿”ì£¼ì…”ì•¼ í•©ë‹ˆë‹¤.\n\n## HTTP ì ‘ê·¼\n\ncurl localhost\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n\n![Screenshot](/assets/img/2024-06-19-NGINXwithSelf-SignedCertificateonDocker_4.png)\n\nì—¬ê¸°ì— ë³¼ ê±´ ë³„ê±° ì—†ì–´ìš”. HTTP ì ‘ê·¼ì€ ì˜ˆìƒëŒ€ë¡œ ì‘ë™í•©ë‹ˆë‹¤.\n\n## HTTPS ì ‘ê·¼\n\ncurl https://localhost\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n\u003cimg src=\"/assets/img/2024-06-19-NGINXwithSelf-SignedCertificateonDocker_5.png\" /\u003e\n\nì—¬ê¸°ì„œ NGINXê°€ HTTPS ìš”ì²­ì— ì‘ë‹µí–ˆì§€ë§Œ curlì€ ë‹¤ìŒê³¼ ê°™ì€ ì˜¤ë¥˜ë¡œ ì²˜ë¦¬ë¥¼ ê±°ë¶€í–ˆìŠµë‹ˆë‹¤:\n\ncurl: (60) SSL certificate problem: self signed certificate\n\nì´ê²ƒì€ HTTPSë¥¼ ìœ„í•œ ê¸°ë³¸ TLSë¥¼ ì„¤ì •í•˜ëŠ” ë° ì‚¬ìš©ëœ ìì²´ ì„œëª…ëœ ì¸ì¦ì„œê°€ ì»´í“¨í„°ì— ì˜í•´ ì‹ ë¢°ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ê·¸ë ‡ë‹¤ë©´ ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œìš”? ì—¬ê¸°ì—ëŠ” ëª‡ ê°€ì§€ ë‹¤ë¥¸ ì˜µì…˜ì´ ìˆìŠµë‹ˆë‹¤:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n- ìì²´ ì„œëª…ëœ ì¸ì¦ì„œë¥¼ OSì˜ ì‹ ë¢°/ì¸ì¦ì„œ ì €ì¥ì†Œì— ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n- curlì— ë³´ì•ˆ ì¸ì¦ì„œë¥¼ ìˆ˜ë½í•˜ë„ë¡ ì§€ì‹œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\në³´ì•ˆ ì¸ì¦ì„œë¥¼ ìˆ˜ë½í•˜ë„ë¡ curlì— ìš”ì²­í•´ ë´…ì‹œë‹¤:\n\ncurl https://localhost --insecure\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-19-NGINXwithSelf-SignedCertificateonDocker_6.png)\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\ncurlì€ ì´ì œ ê¸°ì´ˆ ë¦¬ì†ŒìŠ¤ì˜ ë‚´ìš©ì„ ì¦ê²ê²Œ ì¶œë ¥í•©ë‹ˆë‹¤.\n\në§ˆì°¬ê°€ì§€ë¡œ, HTTPS URLì„ ì¸í„°ë„· ë¸Œë¼ìš°ì €ë¡œ ì—´ì–´ë³´ë ¤ê³  í•˜ë©´ ë³´ì•ˆ ê²½ê³ ê°€ í‘œì‹œë©ë‹ˆë‹¤. ì‹¤ì œ ê²½ê³  ë©”ì‹œì§€ì™€ ì§„í–‰ ë°©ë²•ì€ ê°ê° ë‹¤ë¥¸ ì¸í„°ë„· ë¸Œë¼ìš°ì €ë§ˆë‹¤ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. Chromeì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì´ í‘œì‹œë©ë‹ˆë‹¤:\n\n![Chromeì—ì„œì˜ ë³´ì•ˆ ê²½ê³ ](/assets/img/2024-06-19-NGINXwithSelf-SignedCertificateonDocker_7.png)\n\nChromeì—ì„œ 'ê³ ê¸‰' ë²„íŠ¼ì„ í´ë¦­í•œ ë‹¤ìŒ 'localhostë¡œ ì§„í–‰(ì•ˆì „í•˜ì§€ ì•ŠìŒ)' ì˜µì…˜ì„ í´ë¦­í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n\u003cimg src=\"/assets/img/2024-06-19-NGINXwithSelf-SignedCertificateonDocker_8.png\" /\u003e\n\n# ì¶”ê°€ ì½˜í…ì¸ \n\nê°€ê¸° ì „ì—, ì—¬ê¸°ì„œ ìƒì„±í•œ ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ë¶„ ìì‹ ì˜ ì½˜í…ì¸ ì™€ í•¨ê»˜ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ëª‡ ê°€ì§€ ì¶”ê°€ íŒì´ ìˆìŠµë‹ˆë‹¤.\n\n## 1. ì—¬ëŸ¬ë¶„ ìì‹ ì˜ ì½˜í…ì¸  ì œê³µ\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nê¸°ë³¸ NGINX í™˜ì˜ í˜ì´ì§€ë¥¼ ì œê³µí•˜ëŠ” ê²ƒì€ ëˆ„êµ¬ì—ê²Œë‚˜ í° ê°€ì¹˜ê°€ ì—†ì„ ê²ƒ ê°™ì•„ìš”. ìì‹ ì˜ ì½˜í…ì¸ ë¡œ ì‚¬ìš©ì ì •ì˜ NGINX ì´ë¯¸ì§€ë¥¼ ê°€ë¦¬í‚¬ ìˆ˜ ìˆë„ë¡ ë¡œì»¬ í´ë”ë¥¼ ì»¨í…Œì´ë„ˆì— ë§ˆìš´íŠ¸í•˜ë©´ ë©ë‹ˆë‹¤:\n\n```js\ndocker run \\\n  -p 80:80 -p 443:443 \\\n  -v {YOUR-PATH}:/usr/share/nginx/html \\\nnginx-self-signed\n```\n\n## 2. ìì‹ ì˜ ì½˜í…ì¸ ì— ëŒ€í•œ ì—­ë°©í–¥ í”„ë¡ì‹œ êµ¬ì„±\n\nì»¨í…Œì´ë„ˆ ë‚´ë¶€ì— ì½˜í…ì¸ ë¥¼ ë§ˆìš´íŠ¸í•˜ê³  ì‹¶ì§€ ì•Šì„ ê²½ìš°, NGINXë¥¼ êµ¬ì„±í•˜ì—¬ ì´ë¯¸ ì‹¤í–‰ ì¤‘ì¸ ë‹¤ë¥¸ ì„œë²„ì— ëŒ€í•œ ì—­ë°©í–¥ í”„ë¡ì‹œë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ì½”ë“œ ì¡°ê°ì€ ì´ëŸ¬í•œ êµ¬ì„±ì„ ì„¤ì •í•˜ëŠ” ë° ë„ì›€ì´ ë˜ë‚˜ìš”. ê·¸ëŸ¬ë‚˜ ì—­ë°©í–¥ í”„ë¡ì‹œëŠ” ì•„ë˜ì˜ ê°„ë‹¨í•œ ì˜ˆì œë³´ë‹¤ ë” ë³µì¡í•œë°, ì‹¤ì œë¡œ í”„ë¡ì‹œí•˜ëŠ” ë‚´ìš©ì— ë”°ë¼ ë‹¤ì–‘í•œ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nNGINX ì„¤ì • íŒŒì¼ì˜ ìƒë‹¨ì— upstream ì„œë²„ë¥¼ ì •ì˜í•´ì£¼ì„¸ìš”:\n\n```js\nupstream api-gateway {\n  server http://some-server:80;\n}\n```\n\nNGINX ì„¤ì • íŒŒì¼ì˜ server ë¸”ë¡ì„ ë‹¤ìŒê³¼ ê°™ì´ ì—…ê·¸ë ˆì´ë“œí•´ì£¼ì„¸ìš”:\n\n```js\nlocation /api/ {\n    proxy_pass                http://api-gateway;\n    proxy_redirect            off;\n    proxy_set_header          X-Real-IP $remote_addr;\n    proxy_set_header          X-Forwarded-For $proxy_add_x_forwarded_for;\n    proxy_set_header          X-NginX-Proxy true;\n    proxy_ssl_session_reuse   off;\n    proxy_set_header Host     $http_host;\n    proxy_cache_bypass        $http_upgrade;\n}\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# ê²°ë¡ \n\nì´ ê¸€ì—ì„œëŠ” ìì²´ ì„œëª… ì¸ì¦ì„œë¥¼ ì‚¬ìš©í•˜ëŠ” NGINX ë„ì»¤ ì»¨í…Œì´ë„ˆë¥¼ ë¹ ë¥´ê²Œ ì„¤ì •í•˜ëŠ” ë°©ë²•ì„ ì†Œê°œí–ˆìŠµë‹ˆë‹¤. ì»´í“¨í„°ì— OpenSSLì„ ì„¤ì¹˜í•  í•„ìš”ê°€ ì—†ìœ¼ë©° ì¸ì¦ì„œë¥¼ ìƒì„±í•˜ê¸° ìœ„í•´ openssl ëª…ë ¹ì„ ì‹¤í–‰í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤. ëª¨ë“  ì‘ì—…ì´ Docker ë¹Œë“œì˜ ì¼ë¶€ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤.\n\në˜í•œ ê²°ê³¼ë¬¼ì¸ NGINX ì´ë¯¸ì§€ì— ìì‹ ì˜ ì½˜í…ì¸ ë¥¼ í†µí•©í•˜ëŠ” ë‘ ê°€ì§€ ì˜ˆì œë¥¼ ì œê³µí–ˆìŠµë‹ˆë‹¤. ì»¨í…Œì´ë„ˆ ë‚´ì—ì„œ ì½˜í…ì¸ ë¥¼ ë§ˆìš´íŠ¸í•˜ê±°ë‚˜ ì´ë¯¸ ì‹¤í–‰ ì¤‘ì¸ ë‹¤ë¥¸ ì„œë²„ë¡œ ì—­ë°©í–¥ í”„ë¡ì‹œí•˜ëŠ” ë°©ë²• ë“±ì´ ìˆìŠµë‹ˆë‹¤.\n\nì´ ê¸€ì„ ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤. ë‹¤ìŒ ê¸€ì—ì„œ ë‹¤ì‹œ ëµ™ê¸°ë¥¼ ê¸°ëŒ€í•©ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nğŸ”” ìƒˆ ì´ì•¼ê¸°ë¥¼ ë°œí–‰í•  ë•Œë§ˆë‹¤ ì•Œë¦¼ì„ ë°›ê³  ì‹¶ìœ¼ì„¸ìš”? ì œ ì½˜í…ì¸ ëŠ” í•­ìƒ ì œê°€ ë³¸ ê²ƒì´ë‚˜ ì¼í–ˆë˜ ê²ƒì„ ë°”íƒ•ìœ¼ë¡œ í•œ ì‹¤ìš©ì ì¸ ê¸°ìˆ  íŒê³¼ ì†Œí”„íŠ¸ì›¨ì–´ ì—”ì§€ë‹ˆì–´ë§ ì¡°ì–¸ì„ ì œê³µí•©ë‹ˆë‹¤:\nhttps://nmichas.medium.com/subscribe\n\nğŸš€ ì•„ì§ Medium íšŒì›ì´ ì•„ë‹ˆì‹ ê°€ìš”? ì»¤í”¼ í•œ ì” ê°€ê²©ìœ¼ë¡œ ë§¤ì›” ì œ ì´ì•¼ê¸°ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ (ê·¸ë¦¬ê³  Mediumì˜ ìˆ˜ì²œ ëª…ì˜ ë‹¤ë¥¸ ì‘ê°€ë“¤ì˜ ì´ì•¼ê¸°ì—ë„):\nhttps://medium.com/@nmichas/membership","ogImage":{"url":"/assets/img/2024-06-19-NGINXwithSelf-SignedCertificateonDocker_0.png"},"coverImage":"/assets/img/2024-06-19-NGINXwithSelf-SignedCertificateonDocker_0.png","tag":["Tech"],"readingTime":8}],"page":"19","totalPageCount":98,"totalPageGroupCount":5,"lastPageGroup":20,"currentPageGroup":0},"__N_SSG":true},"page":"/posts/[page]","query":{"page":"19"},"buildId":"o1YmnmSuZvAX2O4TI9r41","isFallback":false,"gsp":true,"scriptLoader":[{"async":true,"src":"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4877378276818686","strategy":"lazyOnload","crossOrigin":"anonymous"}]}</script></body></html>